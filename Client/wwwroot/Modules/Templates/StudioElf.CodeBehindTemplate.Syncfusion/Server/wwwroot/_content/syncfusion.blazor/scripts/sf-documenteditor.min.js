/*!*  filename: sf-documenteditor.min.js 
*     version : 25.1.40 
*     Copyright Syncfusion Inc. 2001 - 2024. All rights reserved. 
*     Use of this code is subject to the terms of our license.
*     A copy of the current license can be obtained at any time by e-mailing 
*     licensing@syncfusion.com. Any infringement will be prosecuted under 
*     applicable laws. 
*/
(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{"./bundles/sf-documenteditor.js":function(e,t,i){"use strict";i.r(t);i("./modules/sf-documenteditor.js")},"./modules/sf-documenteditor.js":function(e,t){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}window.sfBlazor=window.sfBlazor||{},window.sfBlazor.DocumentEditor=function(){"use strict";!function(){function e(e,t,i,r,n){this.isDestroyed=!1,window.sfBlazor=window.sfBlazor,this.enableChunkMessages=!1,this.previousContext="",this.showHeaderProperties=!0,this.element=t,sf.base.isNullOrUndefined(t)||(this.dotNetRef=n,this.element=t,this.dataId=e,window.sfBlazor.setCompInstance(this),this.options=i,this.editorOptions=r,this.updateOptions(i))}Object.defineProperty(e.prototype,"documentEditor",{get:function(){return this.documentEditorInternal},enumerable:!0,configurable:!0}),e.prototype.updateOptions=function(e){this.showPropertiesPane=e.showPropertiesPane,this.currentUser=e.currentUser,this.enableComment=e.enableComment,this.enableLocalPaste=e.enableLocalPaste,this.enableSpellCheck=e.enableSpellCheck,this.enableTrackChanges=e.enableTrackChanges,this.height=e.height,this.enableAutoFocus=e.enableAutoFocus,this.serviceUrl=e.serviceUrl,this.userColor=e.userColor,this.width=e.width,this.zIndex=e.zIndex,this.enableChunkMessages=e.enableChunkMessages,this.documentEditorSettings=e.documentEditorSettings,this.requiredModules()},e.prototype.setOptions=function(e,t){for(var i=0,r=Object.keys(e);i<r.length;i++){var n=r[i],o=e[n];if(!sf.base.isNullOrUndefined(o))switch(n){case"zoomFactor":this.documentEditor.zoomFactor=o,this.documentEditor.onPropertyChanged({zoomFactor:o},null);break;case"layoutType":this.documentEditor.layoutType=o,this.documentEditor.onPropertyChanged({layoutType:o},null);break;case"enableTrackChanges":this.enableTrackChanges=o,this.documentEditor.enableTrackChanges=o,this.documentEditor.showRevisions=o,this.documentEditor.onPropertyChanged({enableTrackChanges:o},null),this.documentEditor.onPropertyChanged({showRevisions:o},null);break;case"restrictEditing":this.restrictEditing=o,this.documentEditor.isReadOnly=o,this.documentEditor.onPropertyChanged({isReadOnly:o},null);break;case"enableLocalPaste":this.enableLocalPaste=o,this.documentEditor.enableLocalPaste=o,this.documentEditor.onPropertyChanged({enableLocalPaste:o},null);break;case"documentEditorSettings":this.documentEditorSettings=o,this.customizeDocumentEditorSettings(),sf.base.isNullOrUndefined(this.documentEditorSettings.fontFamilies)||this.dotNetRef.invokeMethodAsync("RefreshFontFamilies")}}},e.prototype.getModuleName=function(){return"DocumentEditorContainer"},e.prototype.onPropertyChanged=function(e,t){for(var i=0,r=Object.keys(e);i<r.length;i++){switch(r[i]){case"restrictEditing":this.documentEditor.isReadOnly=e.restrictEditing,sf.base.isNullOrUndefined(this.documentEditor.trackChangesPane)||this.documentEditor.trackChangesPane.enableDisableButton(!e.restrictEditing&&!this.documentEditor.documentHelper.isDocumentProtected);break;case"showPropertiesPane":this.showHidePropertiesPane(e.showPropertiesPane);break;case"enableTrackChanges":this.documentEditor&&(this.documentEditor.enableTrackChanges=e.enableTrackChanges,this.documentEditor.showRevisions=e.enableTrackChanges,this.documentEditor.resize());break;case"enableLocalPaste":this.documentEditor&&(this.documentEditor.enableLocalPaste=e.enableLocalPaste);break;case"serviceUrl":this.documentEditor&&(this.documentEditor.serviceUrl=e.serviceUrl);break;case"serverActionSettings":this.documentEditor&&this.setserverActionSettings();break;case"zIndex":this.documentEditor&&(this.documentEditor.zIndex=e.zIndex);break;case"headers":this.documentEditor&&(this.documentEditor.headers=e.headers);break;case"locale":case"enableRtl":break;case"enableComment":this.documentEditor&&(this.documentEditor.enableComment=e.enableComment);break;case"enableSpellCheck":this.documentEditor&&(this.documentEditor.enableSpellCheck=e.enableSpellCheck);break;case"documentEditorSettings":this.documentEditor&&this.customizeDocumentEditorSettings();break;case"toolbarItems":break;case"currentUser":this.documentEditor&&(this.documentEditor.currentUser=e.currentUser);break;case"userColor":this.documentEditor&&(this.documentEditor.userColor=e.userColor);break;case"layoutType":this.documentEditor&&(this.documentEditor.layoutType=e.layoutType);break;case"enableToolbar":this.documentEditor&&this.documentEditor.resize();break;case"height":var n="";n=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height),this.element.style.height=n,this.documentEditor&&this.documentEditor.resize();break;case"width":this.element.style.width=sf.base.formatUnit(this.width),this.documentEditor&&this.documentEditor.resize()}}},e.prototype.preRender=function(e){var t="";t=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height),this.element.style.height=t,""!==this.width&&(this.element.style.width=sf.base.formatUnit(this.width)),this.element.style.minHeight="320px"},e.prototype.render=function(e,t){this.initializeDocumentEditor(e,t),this.setserverActionSettings(),this.customizeDocumentEditorSettings()},e.prototype.setFormat=function(){},e.prototype.setserverActionSettings=function(){},e.prototype.setShowHiddenMarks=function(e){var t=this;this.documentEditorSettings.showHiddenMarks=e,this.documentEditor.documentEditorSettings.showHiddenMarks=e,this.documentEditor.viewer.updateScrollBars(),setTimeout((function(){t.documentEditor.viewer&&t.documentEditor.focusIn()}),30)},e.prototype.customizeDocumentEditorSettings=function(){if(this.documentEditorSettings.formFieldSettings){var e=this.documentEditorSettings.formFieldSettings,t=this.documentEditor;sf.base.isNullOrUndefined(e.applyShading)||(t.documentEditorSettings.formFieldSettings.applyShading=e.applyShading),sf.base.isNullOrUndefined(e.formFillingMode)||(t.documentEditorSettings.formFieldSettings.formFillingMode=e.formFillingMode),sf.base.isNullOrUndefined(e.formattingExceptions)||(t.documentEditorSettings.formFieldSettings.formattingExceptions=e.formattingExceptions),sf.base.isNullOrUndefined(e.selectionColor)||(t.documentEditorSettings.formFieldSettings.selectionColor=e.selectionColor),sf.base.isNullOrUndefined(e.shadingColor)||(t.documentEditorSettings.formFieldSettings.shadingColor=e.shadingColor)}this.documentEditorSettings.searchHighlightColor&&(this.documentEditor.documentEditorSettings.searchHighlightColor=this.documentEditorSettings.searchHighlightColor),this.documentEditorSettings.fontFamilies&&(this.documentEditor.documentEditorSettings.fontFamilies=this.documentEditorSettings.fontFamilies),this.documentEditorSettings.printDevicePixelRatio&&(this.documentEditor.documentEditorSettings.printDevicePixelRatio=this.documentEditorSettings.printDevicePixelRatio),sf.base.isNullOrUndefined(this.documentEditorSettings.enableOptimizedTextMeasuring)||(this.documentEditor.documentEditorSettings.enableOptimizedTextMeasuring=this.documentEditorSettings.enableOptimizedTextMeasuring),sf.base.isNullOrUndefined(this.documentEditorSettings.maximumRows)||(this.documentEditor.documentEditorSettings.maximumRows=this.documentEditorSettings.maximumRows),sf.base.isNullOrUndefined(this.documentEditorSettings.maximumColumns)||(this.documentEditor.documentEditorSettings.maximumColumns=this.documentEditorSettings.maximumColumns),sf.base.isNullOrUndefined(this.documentEditorSettings.showHiddenMarks)||(this.documentEditor.documentEditorSettings.showHiddenMarks=this.documentEditorSettings.showHiddenMarks),sf.base.isNullOrUndefined(this.documentEditorSettings.showBookmarks)||(this.documentEditor.documentEditorSettings.showBookmarks=this.documentEditorSettings.showBookmarks),sf.base.isNullOrUndefined(this.documentEditorSettings.highlightEditableRanges)||(this.documentEditor.documentEditorSettings.highlightEditableRanges=this.documentEditorSettings.highlightEditableRanges),sf.base.isNullOrUndefined(this.documentEditorSettings.optimizeSfdt)||(this.documentEditor.documentEditorSettings.optimizeSfdt=this.documentEditorSettings.optimizeSfdt),sf.base.isNullOrUndefined(this.documentEditorSettings.showRuler)||(this.documentEditor.documentEditorSettings.showRuler=this.documentEditorSettings.showRuler)},e.prototype.getPersistData=function(){return"documenteditor-container"},e.prototype.requiredModules=function(){var e=[];return this.enableToolbar&&e.push({member:"toolbar",args:[this]}),e},e.prototype.initializeDocumentEditor=function(e,t){var i=t,r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(this.documentEditorInternal=r,sf.base.EventHandler.add(i,"selectionChange",this.onSelectionChange,this),this.documentEditor.enableAllModules(),this.documentEditor.enableComment=this.enableComment,this.setFormat(),this.documentEditor.resize())},e.prototype.showHidePropertiesPane=function(e){this.showPropertiesPane&&this.showPropertiesPaneOnSelection(),this.documentEditor.resize()},e.prototype.resize=function(e,t){this.element&&(sf.base.isNullOrUndefined(t)&&this.element&&this.element.parentElement.parentElement&&(t=this.element.parentElement.parentElement.clientHeight),sf.base.isNullOrUndefined(e)&&this.element&&this.element.parentElement.parentElement&&(e=this.element.parentElement.parentElement.clientWidth),!sf.base.isNullOrUndefined(e)&&e>200&&(this.width=e.toString(),this.element.style.width=e+"px"),!sf.base.isNullOrUndefined(t)&&t>200&&(this.height=t.toString(),this.element.style.height=t+"px"),this.documentEditor&&this.documentEditor.resize())},e.prototype.onContentChange=function(){},e.prototype.onDocumentChange=function(){this.enableTrackChanges=this.documentEditor.enableTrackChanges},e.prototype.onSelectionChange=function(){this.showPropertiesPaneOnSelection()},e.prototype.showPropertiesPaneOnSelection=function(){var e=this.documentEditor.selection.contextType,t=e.indexOf("Header")>=0||e.indexOf("Footer")>=0;t||(this.showHeaderProperties=!0,this.documentEditor.fireBeforePaneSwitch("PropertiesPane")),this.showPropertiesPane?t&&this.showHeaderProperties?this.showProperties("headerfooter"):e.indexOf("List")>=0||e.indexOf("Text")>=0&&e.indexOf("Table")<0?this.showProperties("text"):e.indexOf("Image")>=0?this.showProperties("image"):e.indexOf("TableOfContents")>=0?this.showProperties("toc"):e.indexOf("Table")>=0&&this.showProperties("table"):this.showHidePropertiesPane(!1),this.previousContext=this.documentEditor.selection.contextType},e.prototype.showProperties=function(e){this.tableProperties.showTableProperties("text"===e||"table"===e),this.imageProperties.showImageProperties("image"===e),this.headerFooterProperties.showHeaderFooterPane("headerfooter"===e),this.tocProperties.showTocPane("toc"===e)},e.prototype.destroy=function(){this.propertiesPaneContainer&&this.editorContainer.parentElement&&(this.propertiesPaneContainer.innerHTML="",this.propertiesPaneContainer.parentElement.removeChild(this.propertiesPaneContainer)),this.propertiesPaneContainer=void 0,this.editorContainer&&this.editorContainer.parentElement&&(this.editorContainer.innerHTML="",this.editorContainer.parentElement.removeChild(this.editorContainer)),this.statusBarElement&&this.statusBarElement.parentElement&&(this.statusBarElement.innerHTML="",this.statusBarElement.parentElement.removeChild(this.statusBarElement)),this.containerTarget&&this.containerTarget.parentElement&&(this.containerTarget.innerHTML="",this.containerTarget.parentElement.removeChild(this.containerTarget)),this.containerTarget=void 0,this.statusBarElement=void 0,this.editorContainer=void 0}}();var e,t,r,n,o,s=function(){function e(){var e=this;this.windowPrint=void 0,this.closePrintWindow=function(){e.windowPrint&&!e.windowPrint.closed&&e.windowPrint.close()}}return e.prototype.getModuleName=function(){return"Print"},e.prototype.print=function(e,t){this.printWindow(e,void 0!==navigator?navigator.userAgent:"",t)},e.prototype.printWindow=function(e,t,i){var r=this.getPageHeight(e.pages),n=this.getPageWidth(e.pages),o=document.createElement("div");o.style.width="100%",o.style.height="100%",o.style.overflow="scroll",this.generatePrintContent(e,o),sf.base.isNullOrUndefined(i)&&(i=window.open("","print","height=452,width=1024,tabbar=no")),this.windowPrint=i;var s=n.toString()+"px "+r.toString()+"px";n>r&&(s="landscape"),-1!==t.indexOf("Chrome")?(i.document.write("<!DOCTYPE html>"),i.document.write("<html><head><title>"+e.owner.documentName+"</title><style>img { height: 100%; width: 100%; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:"+s+"; }</style></head> <body><center>")):-1!==t.indexOf("Firefox")?(i.document.write("<!DOCTYPE html>"),i.document.write("<html moznomarginboxes mozdisallowselectionprint><head><title>"+e.owner.documentName+"</title><style>html, body { height: 100%; } img { height: 100%; width: 100%; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:"+s+"; }@media print{ body { margin: 0cm; size:"+s+"; }}</style></head> <body><center>")):i.document.write("<html><head><title>"+e.owner.documentName+"</title><style>@page{margin:0;size:"+s+";}</style></head><body><center>"),i.document.write(o.innerHTML+"</center><script> (function() { window.ready = true; })(); <\/script></body></html>"),o=void 0,i.document.close(),i.focus(),window.addEventListener("beforeunload",this.closePrintWindow);var a=setInterval((function(){i.ready&&(i.print(),i.close(),clearInterval(a))}),500)},e.prototype.exportAsImage=function(e,t,i){var r;if(!sf.base.isNullOrUndefined(t)&&t<=e.pages.length&&t>=1){var n=e.pages[t-1];n.boundingRectangle.height,n.boundingRectangle.width;e.render.isPrinting=!0,e.render.renderWidgets(n,0,0,0,0);var o=e.render.pageCanvas.toDataURL(i,1);e.render.isPrinting=!1,r=o}return r},e.prototype.generatePrintContent=function(e,t){for(var i="",r=0;r<e.pages.length;r++){var n=e.pages[r],o=n.boundingRectangle.height,s=n.boundingRectangle.width;e.render.isPrinting=!0,e.render.renderWidgets(n,0,0,s,0);var a=e.render.pageCanvas.toDataURL();e.render.isPrinting=!1;var l=r==e.pages.length-1?"":"<br/>";i+="<div><img src="+a+' style="margin:0px;display:block;width: '+s.toString()+"px; height:"+o.toString()+'px; "/></div>'+l}t.innerHTML=i},e.prototype.getPageWidth=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.width&&(t=e[i].boundingRectangle.width);return t},e.prototype.getPageHeight=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.height&&(t=e[i].boundingRectangle.height);return t},e.prototype.destroy=function(){window.removeEventListener("beforeunload",this.closePrintWindow),this.windowPrint=void 0},e}(),a=function(){function e(){this.keysInternal=[],this.valuesInternal=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.keysInternal.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return this.keysInternal},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t){if(sf.base.isNullOrUndefined(e))throw new ReferenceError("Provided key or value is not valid.");return this.keysInternal.indexOf(e)<0&&(this.keysInternal.push(e),this.valuesInternal.push(t)),1},e.prototype.get=function(e){if(sf.base.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);return t<0||t>this.keysInternal.length-1?void 0:this.valuesInternal[t]},e.prototype.set=function(e,t){if(sf.base.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");var i=this.keysInternal.indexOf(e);if(i<0||i>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");this.valuesInternal[i]=t},e.prototype.remove=function(e){if(sf.base.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);if(t<0||t>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");return this.keysInternal.splice(t,1),this.valuesInternal.splice(t,1),!0},e.prototype.containsKey=function(e){if(sf.base.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");var t=this.keysInternal.indexOf(e);return!(t<0||t>this.keysInternal.length-1)},e.prototype.clear=function(){this.keysInternal=[],this.valuesInternal=[]},e.prototype.destroy=function(){this.clear(),this.keysInternal=void 0,this.valuesInternal=void 0},e}(),l=function(){function e(e){this.referenceCount=0,this.uniqueFormatType=e,this.propertiesHash=new a}return e.prototype.isEqual=function(e,t,i){var r=!1;switch(this.uniqueFormatType){case 1:r=this.isBorderEqual(e,t,i);break;case 2:r=this.isCharacterFormatEqual(e,t,i);break;case 3:r=this.isParagraphFormatEqual(e,t,i);break;case 4:r=this.isCellFormatEqual(e,t,i);break;case 5:r=this.isShadingEqual(e,t,i);break;case 6:r=this.isRowFormatEqual(e,t,i);break;case 7:r=this.isListFormatEqual(e,t,i);break;case 8:r=this.isTableFormatEqual(e,t,i);break;case 9:r=this.isListLevelEqual(e,t,i);break;case 10:r=this.isSectionFormatEqual(e,t,i);break;case 11:r=this.isColumnFormatEqual(e,t,i)}return r},e.prototype.isNotEqual=function(t,i,r,n,o){var s=void 0,a=e.getPropertyType(o,t);this.propertiesHash.containsKey(a)&&(s=this.propertiesHash.get(a));var l=void 0;return t===r?l=n:i.containsKey(a)&&(l=i.get(a)),!(s===l||!sf.base.isNullOrUndefined(s)&&!sf.base.isNullOrUndefined(l)&&s===l)},e.getPropertyType=function(e,t){var i=0;switch(e){case 1:i=this.getBorderPropertyType(t);break;case 2:i=this.getCharacterFormatPropertyType(t);break;case 3:i=this.getParaFormatPropertyType(t);break;case 4:i=this.getCellFormatPropertyType(t);break;case 5:i=this.getShadingPropertyType(t);break;case 6:i=this.getRowFormatType(t);break;case 7:i=this.getListFormatType(t);break;case 8:i=this.getTableFormatType(t);break;case 9:i=this.getListLevelType(t);break;case 10:i=this.getSectionFormatType(t);break;case 11:i=this.getColumnFormatType(t)}return i},e.getRowFormatType=function(e){return"allowBreakAcrossPages"===e?1:"isHeader"===e?2:"height"===e?3:"heightType"===e?4:"gridBefore"===e?5:"gridBeforeWidth"===e?6:"gridBeforeWidthType"===e?7:"gridAfter"===e?8:"gridAfterWidth"===e?9:"gridAfterWidthType"===e?10:"leftMargin"===e?11:"topMargin"===e?12:"bottomMargin"===e?13:"rightMargin"===e?14:"leftIndent"===e?15:0},e.getListFormatType=function(e){return"listId"===e?1:"listLevelNumber"===e?2:0},e.getTableFormatType=function(e){return"leftMargin"===e?1:"rightMargin"===e?2:"topMargin"===e?3:"bottomMargin"===e?4:"cellSpacing"===e?5:"leftIndent"===e?6:"tableAlignment"===e?7:"preferredWidth"===e?8:"preferredWidthType"===e?9:"bidi"===e?10:"allowAutoFit"===e?11:"horizontalPositionAbs"===e?12:"horizontalPosition"===e?13:0},e.getListLevelType=function(e){return"listLevelPattern"===e?1:"startAt"===e?2:"followCharacter"===e?3:"numberFormat"===e?4:"restartLevel"===e?5:"isLegalStyleNumbering"===e?6:"paraStyleName"===e?7:0},e.getShadingPropertyType=function(e){return"backgroundColor"===e?1:"foregroundColor"===e?2:"textureStyle"===e?3:0},e.getCellFormatPropertyType=function(e){return"leftMargin"===e?1:"rightMargin"===e?2:"topMargin"===e?3:"bottomMargin"===e?4:"columnSpan"===e?5:"rowSpan"===e?6:"verticalAlignment"===e?7:"preferredWidthType"===e?8:"preferredWidth"===e?9:"cellWidth"===e?10:0},e.getBorderPropertyType=function(e){return"color"===e?1:"lineStyle"===e?2:"lineWidth"===e?3:"shadow"===e?4:"space"===e?5:"hasNoneStyle"===e?6:0},e.getCharacterFormatPropertyType=function(e){return"fontColor"===e?1:"fontFamily"===e?2:"fontSize"===e?3:"bold"===e?4:"italic"===e?5:"underline"===e?6:"strikethrough"===e?7:"baselineAlignment"===e?8:"highlightColor"===e?9:"bidi"===e?10:"bdo"===e?11:"boldBidi"===e?12:"italicBidi"===e?13:"fontFamilyBidi"===e?14:"fontSizeBidi"===e?15:"allCaps"===e?16:"localeIdBidi"===e?17:"complexScript"===e?18:"fontFamilyFarEast"===e?19:"fontFamilyAscii"===e?20:"fontFamilyNonFarEast"===e?21:"localeIdAscii"===e?22:"localeIdFarEast"===e?23:"characterSpacing"===e?24:"scaling"===e?25:0},e.getParaFormatPropertyType=function(e){return"leftIndent"===e?1:"rightIndent"===e?2:"firstLineIndent"===e?3:"textAlignment"===e?4:"beforeSpacing"===e?5:"afterSpacing"===e?6:"lineSpacing"===e?7:"lineSpacingType"===e?8:"outlineLevel"===e?9:"bidi"===e?10:"contextualSpacing"===e?11:"keepWithNext"===e?12:"keepLinesTogether"===e?13:"widowControl"===e?14:"spaceBeforeAuto"===e?15:"spaceAfterAuto"===e?16:0},e.getColumnFormatType=function(e){return"width"===e?1:"space"===e?2:0},e.getSectionFormatType=function(e){return"headerDistance"===e?1:"footerDistance"===e?2:"differentFirstPage"===e?3:"differentOddAndEvenPages"===e?4:"pageWidth"===e?5:"pageHeight"===e?6:"leftMargin"===e?7:"topMargin"===e?8:"rightMargin"===e?9:"bottomMargin"===e?10:"bidi"===e?11:"restartPageNumbering"===e?12:"pageStartingNumber"===e?13:"endnoteNumberFormat"===e?14:"endnotePosition"===e?15:"footNoteNumberFormat"===e?16:"footnotePosition"===e?17:"restartIndexForEndnotes"===e?18:"restartIndexForFootnotes"===e?19:"initialFootNoteNumber"===e?20:"initialEndNoteNumber"===e?21:"pageNumberStyle"===e?22:"numberOfColumns"===e?23:"equalWidth"===e?24:"lineBetweenColumns"===e?25:"columns"===e?26:"breakCode"===e?27:0},e.prototype.isBorderEqual=function(e,t,i){return!this.isNotEqual("color",e,t,i,1)&&(!this.isNotEqual("lineStyle",e,t,i,1)&&(!this.isNotEqual("lineWidth",e,t,i,1)&&(!this.isNotEqual("shadow",e,t,i,1)&&(!this.isNotEqual("space",e,t,i,1)&&!this.isNotEqual("hasNoneStyle",e,t,i,1)))))},e.prototype.isCharacterFormatEqual=function(e,t,i){return!this.isNotEqual("fontColor",e,t,i,2)&&(!this.isNotEqual("fontFamily",e,t,i,2)&&(!this.isNotEqual("fontSize",e,t,i,2)&&(!this.isNotEqual("bold",e,t,i,2)&&(!this.isNotEqual("italic",e,t,i,2)&&(!this.isNotEqual("underline",e,t,i,2)&&(!this.isNotEqual("strikethrough",e,t,i,2)&&(!this.isNotEqual("baselineAlignment",e,t,i,2)&&(!this.isNotEqual("highlightColor",e,t,i,2)&&(!this.isNotEqual("bidi",e,t,i,2)&&(!this.isNotEqual("bdo",e,t,i,2)&&(!this.isNotEqual("fontColor",e,t,i,2)&&(!this.isNotEqual("fontFamilyBidi",e,t,i,2)&&(!this.isNotEqual("fontSizeBidi",e,t,i,2)&&(!this.isNotEqual("boldBidi",e,t,i,2)&&(!this.isNotEqual("italicBidi",e,t,i,2)&&(!this.isNotEqual("allCaps",e,t,i,2)&&(!this.isNotEqual("localeIdBidi",e,t,i,2)&&(!this.isNotEqual("localeIdAscii",e,t,i,2)&&(!this.isNotEqual("complexScript",e,t,i,2)&&(!this.isNotEqual("fontFamilyFarEast",e,t,i,2)&&(!this.isNotEqual("fontFamilyAscii",e,t,i,2)&&(!this.isNotEqual("fontFamilyNonFarEast",e,t,i,2)&&(!this.isNotEqual("characterSpacing",e,t,i,2)&&!this.isNotEqual("scaling",e,t,i,2))))))))))))))))))))))))},e.prototype.isParagraphFormatEqual=function(e,t,i){return!this.isNotEqual("leftIndent",e,t,i,3)&&(!this.isNotEqual("rightIndent",e,t,i,3)&&(!this.isNotEqual("firstLineIndent",e,t,i,3)&&(!this.isNotEqual("textAlignment",e,t,i,3)&&(!this.isNotEqual("beforeSpacing",e,t,i,3)&&(!this.isNotEqual("afterSpacing",e,t,i,3)&&(!this.isNotEqual("spaceBeforeAuto",e,t,i,3)&&(!this.isNotEqual("spaceAfterAuto",e,t,i,3)&&(!this.isNotEqual("lineSpacing",e,t,i,3)&&(!this.isNotEqual("lineSpacingType",e,t,i,3)&&(!this.isNotEqual("outlineLevel",e,t,i,3)&&(!this.isNotEqual("bidi",e,t,i,3)&&(!this.isNotEqual("contextualSpacing",e,t,i,3)&&(!this.isNotEqual("keepWithNext",e,t,i,3)&&(!this.isNotEqual("keepLinesTogether",e,t,i,3)&&!this.isNotEqual("widowControl",e,t,i,3)))))))))))))))},e.prototype.isCellFormatEqual=function(e,t,i){return!this.isNotEqual("leftMargin",e,t,i,4)&&(!this.isNotEqual("rightMargin",e,t,i,4)&&(!this.isNotEqual("topMargin",e,t,i,4)&&(!this.isNotEqual("bottomMargin",e,t,i,4)&&(!this.isNotEqual("columnSpan",e,t,i,4)&&(!this.isNotEqual("rowSpan",e,t,i,4)&&(!this.isNotEqual("verticalAlignment",e,t,i,4)&&(!this.isNotEqual("preferredWidthType",e,t,i,4)&&(!this.isNotEqual("preferredWidth",e,t,i,4)&&!this.isNotEqual("cellWidth",e,t,i,4)))))))))},e.prototype.isShadingEqual=function(e,t,i){return!this.isNotEqual("backgroundColor",e,t,i,5)&&(!this.isNotEqual("foregroundColor",e,t,i,5)&&!this.isNotEqual("textureStyle",e,t,i,5))},e.prototype.isRowFormatEqual=function(e,t,i){return!this.isNotEqual("allowBreakAcrossPages",e,t,i,6)&&(!this.isNotEqual("isHeader",e,t,i,6)&&(!this.isNotEqual("height",e,t,i,6)&&(!this.isNotEqual("heightType",e,t,i,6)&&(!this.isNotEqual("gridBefore",e,t,i,6)&&(!this.isNotEqual("gridBeforeWidth",e,t,i,6)&&(!this.isNotEqual("gridBeforeWidthType",e,t,i,6)&&(!this.isNotEqual("gridAfter",e,t,i,6)&&(!this.isNotEqual("gridAfterWidth",e,t,i,6)&&(!this.isNotEqual("gridAfterWidthType",e,t,i,6)&&(!this.isNotEqual("leftMargin",e,t,i,6)&&(!this.isNotEqual("topMargin",e,t,i,6)&&(!this.isNotEqual("bottomMargin",e,t,i,6)&&(!this.isNotEqual("rightMargin",e,t,i,6)&&!this.isNotEqual("leftIndent",e,t,i,6))))))))))))))},e.prototype.isListFormatEqual=function(e,t,i){return!this.isNotEqual("listId",e,t,i,7)&&!this.isNotEqual("listLevelNumber",e,t,i,7)},e.prototype.isTableFormatEqual=function(e,t,i){return!this.isNotEqual("leftMargin",e,t,i,8)&&(!this.isNotEqual("rightMargin",e,t,i,8)&&(!this.isNotEqual("topMargin",e,t,i,8)&&(!this.isNotEqual("bottomMargin",e,t,i,8)&&(!this.isNotEqual("cellSpacing",e,t,i,8)&&(!this.isNotEqual("leftIndent",e,t,i,8)&&(!this.isNotEqual("tableAlignment",e,t,i,8)&&(!this.isNotEqual("preferredWidth",e,t,i,8)&&(!this.isNotEqual("preferredWidthType",e,t,i,8)&&(!this.isNotEqual("bidi",e,t,i,8)&&(!this.isNotEqual("allowAutoFit",e,t,i,8)&&(!this.isNotEqual("horizontalPositionAbs",e,t,i,8)&&!this.isNotEqual("horizontalPosition",e,t,i,8))))))))))))},e.prototype.isListLevelEqual=function(e,t,i){return!this.isNotEqual("listLevelPattern",e,t,i,9)&&(!this.isNotEqual("startAt",e,t,i,9)&&(!this.isNotEqual("followCharacter",e,t,i,9)&&(!this.isNotEqual("numberFormat",e,t,i,9)&&(!this.isNotEqual("paraStyleName",e,t,i,9)&&(!this.isNotEqual("restartLevel",e,t,i,9)&&!this.isNotEqual("isLegalStyleNumbering",e,t,i,9))))))},e.prototype.isSectionFormatEqual=function(e,t,i){return!this.isNotEqual("headerDistance",e,t,i,10)&&(!this.isNotEqual("footerDistance",e,t,i,10)&&(!this.isNotEqual("differentFirstPage",e,t,i,10)&&(!this.isNotEqual("differentOddAndEvenPages",e,t,i,10)&&(!this.isNotEqual("pageWidth",e,t,i,10)&&(!this.isNotEqual("pageHeight",e,t,i,10)&&(!this.isNotEqual("leftMargin",e,t,i,10)&&(!this.isNotEqual("topMargin",e,t,i,10)&&(!this.isNotEqual("rightMargin",e,t,i,10)&&(!this.isNotEqual("bottomMargin",e,t,i,10)&&(!this.isNotEqual("bidi",e,t,i,10)&&(!this.isNotEqual("restartPageNumbering",e,t,i,10)&&(!this.isNotEqual("pageStartingNumber",e,t,i,10)&&(!this.isNotEqual("endnoteNumberFormat",e,t,i,10)&&(!this.isNotEqual("endnotePosition",e,t,i,10)&&(!this.isNotEqual("footNoteNumberFormat",e,t,i,10)&&(!this.isNotEqual("footnotePosition",e,t,i,10)&&(!this.isNotEqual("restartIndexForEndnotes",e,t,i,10)&&(!this.isNotEqual("restartIndexForFootnotes",e,t,i,10)&&(!this.isNotEqual("initialFootNoteNumber",e,t,i,10)&&(!this.isNotEqual("initialEndNoteNumber",e,t,i,10)&&(!this.isNotEqual("pageNumberStyle",e,t,i,10)&&(!this.isNotEqual("numberOfColumns",e,t,i,10)&&(!this.isNotEqual("equalWidth",e,t,i,10)&&(!this.isNotEqual("lineBetweenColumns",e,t,i,10)&&!this.isNotEqual("breakCode",e,t,i,10)))))))))))))))))))))))))},e.prototype.isColumnFormatEqual=function(e,t,i){return!this.isNotEqual("width",e,t,i,11)&&!this.isNotEqual("space",e,t,i,11)},e.prototype.cloneItems=function(t,i,r,n){for(var o=e.getPropertyType(n,i),s=t.propertiesHash.keys,a=0;a<s.length;a++)s[a]===o?this.propertiesHash.add(o,r):this.propertiesHash.add(s[a],t.propertiesHash.get(s[a]));t.propertiesHash.containsKey(o)||this.propertiesHash.add(o,r)},e.prototype.mergeProperties=function(e){for(var t=e.cloneProperties(),i=this.propertiesHash.keys,r=0;r<i.length;r++)t.containsKey(i[r])||t.add(i[r],this.propertiesHash.get(i[r]));return t},e.prototype.cloneProperties=function(){for(var e=new a,t=this.propertiesHash.keys,i=0;i<t.length;i++)e.add(t[i],this.propertiesHash.get(t[i]));return e},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.propertiesHash)||this.propertiesHash.destroy(),this.propertiesHash=void 0,this.referenceCount=void 0,this.uniqueFormatType=void 0},e}(),d=function(){function e(){this.items=[]}return e.prototype.addUniqueFormat=function(e,t){for(var i=void 0,r=0;r<this.items.length;r++)if(this.items[r].isEqual(e,void 0,void 0)){i=this.items[r];break}return sf.base.isNullOrUndefined(i)?((i=new l(t)).propertiesHash=e,i.referenceCount=1,this.items.push(i)):i.referenceCount++,i},e.prototype.updateUniqueFormat=function(e,t,i){for(var r=void 0,n=0;n<this.items.length;n++)if(this.items[n].isEqual(e.propertiesHash,t,i)){r=this.items[n];break}return sf.base.isNullOrUndefined(r)?((r=new l(e.uniqueFormatType)).cloneItems(e,t,i,e.uniqueFormatType),r.referenceCount=1,this.items.push(r)):r.referenceCount++,this.remove(e),r},e.prototype.remove=function(e){e.referenceCount--,e.referenceCount<=0&&(this.items.splice(this.items.indexOf(e),1),e.destroy(),e=void 0)},e.prototype.clear=function(){if(sf.base.isNullOrUndefined(this.items))for(var e=0;e<this.items.length;e++)this.items[e].destroy();this.items=[]},e.prototype.destroy=function(){this.clear(),this.items=void 0},e}(),h=function(){function e(e){this.uniqueSectionFormat=void 0,this.columns=[],this.ownerBase=e,this.columns=[],this.removedHeaderFooters=[]}return Object.defineProperty(e.prototype,"headerDistance",{get:function(){return this.getPropertyValue("headerDistance")},set:function(e){this.setPropertyValue("headerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerDistance",{get:function(){return this.getPropertyValue("footerDistance")},set:function(e){this.setPropertyValue("footerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentFirstPage",{get:function(){return this.getPropertyValue("differentFirstPage")},set:function(e){this.setPropertyValue("differentFirstPage",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentOddAndEvenPages",{get:function(){return this.getPropertyValue("differentOddAndEvenPages")},set:function(e){this.setPropertyValue("differentOddAndEvenPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.getPropertyValue("pageHeight")},set:function(e){this.setPropertyValue("pageHeight",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.getPropertyValue("pageWidth")},set:function(e){this.setPropertyValue("pageWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartPageNumbering",{get:function(){return this.getPropertyValue("restartPageNumbering")},set:function(e){this.setPropertyValue("restartPageNumbering",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageStartingNumber",{get:function(){return this.getPropertyValue("pageStartingNumber")},set:function(e){this.setPropertyValue("pageStartingNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endnoteNumberFormat",{get:function(){return this.getPropertyValue("endnoteNumberFormat")},set:function(e){this.setPropertyValue("endnoteNumberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForEndnotes",{get:function(){return this.getPropertyValue("restartIndexForEndnotes")},set:function(e){this.setPropertyValue("restartIndexForEndnotes",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForFootnotes",{get:function(){return this.getPropertyValue("restartIndexForFootnotes")},set:function(e){this.setPropertyValue("restartIndexForFootnotes",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footNoteNumberFormat",{get:function(){return this.getPropertyValue("footNoteNumberFormat")},set:function(e){this.setPropertyValue("footNoteNumberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialFootNoteNumber",{get:function(){return this.getPropertyValue("initialFootNoteNumber")},set:function(e){this.setPropertyValue("initialFootNoteNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialEndNoteNumber",{get:function(){return this.getPropertyValue("initialEndNoteNumber")},set:function(e){this.setPropertyValue("initialEndNoteNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageNumberStyle",{get:function(){return this.getPropertyValue("pageNumberStyle")},set:function(e){this.setPropertyValue("pageNumberStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfColumns",{get:function(){return this.getPropertyValue("numberOfColumns")},set:function(e){this.setPropertyValue("numberOfColumns",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"equalWidth",{get:function(){return this.getPropertyValue("equalWidth")},set:function(e){this.setPropertyValue("equalWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineBetweenColumns",{get:function(){return this.getPropertyValue("lineBetweenColumns")},set:function(e){this.setPropertyValue("lineBetweenColumns",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"breakCode",{get:function(){return this.getPropertyValue("breakCode")},set:function(e){this.setPropertyValue("breakCode",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPageHeader",{get:function(){return this.getPropertyValue("firstPageHeader")},set:function(e){this.setPropertyValue("firstPageHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPageFooter",{get:function(){return this.getPropertyValue("firstPageFooter")},set:function(e){this.setPropertyValue("firstPageFooter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oddPageHeader",{get:function(){return this.getPropertyValue("oddPageHeader")},set:function(e){this.setPropertyValue("oddPageHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oddPageFooter",{get:function(){return this.getPropertyValue("oddPageFooter")},set:function(e){this.setPropertyValue("oddPageFooter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evenPageHeader",{get:function(){return this.getPropertyValue("evenPageHeader")},set:function(e){this.setPropertyValue("evenPageHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evenPageFooter",{get:function(){return this.getPropertyValue("evenPageFooter")},set:function(e){this.setPropertyValue("evenPageFooter",e)},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.uniqueSectionFormat)||e.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0,this.columns=void 0,this.removedHeaderFooters=void 0},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueSectionFormat)){var t=l.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,e);return this.uniqueSectionFormat.propertiesHash.containsKey(t)}return!1},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"headerDistance":case"footerDistance":t=36;break;case"differentFirstPage":case"differentOddAndEvenPages":t=!1;break;case"pageWidth":t=612;break;case"pageHeight":t=792;break;case"leftMargin":case"topMargin":case"rightMargin":case"bottomMargin":t=72;break;case"bidi":case"restartPageNumbering":t=!1;break;case"pageStartingNumber":t=1;break;case"footnotePosition":t="PrintAtBottomOfPage";break;case"endnoteNumberFormat":t="LowerCaseRoman";break;case"endnotePosition":t="DisplayEndOfDocument";break;case"restartIndexForEndnotes":case"restartIndexForFootnotes":t="DoNotRestart";break;case"footNoteNumberFormat":t="Arabic";break;case"initialFootNoteNumber":case"initialEndNoteNumber":t=1;break;case"pageNumberStyle":t="Arabic";break;case"numberOfColumns":t=1;break;case"equalWidth":t=!0;break;case"lineBetweenColumns":t=!1;break;case"breakCode":t="NewPage";break;case"firstPageHeader":case"firstPageFooter":case"oddPageHeader":case"oddPageFooter":case"evenPageHeader":case"evenPageFooter":t=void 0}return t},e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueSectionFormat)&&this.uniqueSectionFormat.propertiesHash.containsKey(i))return this.uniqueSectionFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueSectionFormat))this.initializeUniqueSectionFormat(t,i);else{var r=l.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,t);if(this.uniqueSectionFormat.propertiesHash.containsKey(r)&&this.uniqueSectionFormat.propertiesHash.get(r)===i)return;this.uniqueSectionFormat=e.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat,t,i)}},e.prototype.initializeUniqueSectionFormat=function(t,i){var r=new a;this.addUniqueSectionFormat("headerDistance",t,i,r),this.addUniqueSectionFormat("footerDistance",t,i,r),this.addUniqueSectionFormat("differentFirstPage",t,i,r),this.addUniqueSectionFormat("differentOddAndEvenPages",t,i,r),this.addUniqueSectionFormat("pageWidth",t,i,r),this.addUniqueSectionFormat("pageHeight",t,i,r),this.addUniqueSectionFormat("leftMargin",t,i,r),this.addUniqueSectionFormat("topMargin",t,i,r),this.addUniqueSectionFormat("rightMargin",t,i,r),this.addUniqueSectionFormat("bottomMargin",t,i,r),this.addUniqueSectionFormat("bidi",t,i,r),this.addUniqueSectionFormat("restartPageNumbering",t,i,r),this.addUniqueSectionFormat("pageStartingNumber",t,i,r),this.addUniqueSectionFormat("endnoteNumberFormat",t,i,r),this.addUniqueSectionFormat("endnotePosition",t,i,r),this.addUniqueSectionFormat("footNoteNumberFormat",t,i,r),this.addUniqueSectionFormat("footnotePosition",t,i,r),this.addUniqueSectionFormat("restartIndexForEndnotes",t,i,r),this.addUniqueSectionFormat("restartIndexForFootnotes",t,i,r),this.addUniqueSectionFormat("initialFootNoteNumber",t,i,r),this.addUniqueSectionFormat("initialEndNoteNumber",t,i,r),this.addUniqueSectionFormat("pageNumberStyle",t,i,r),this.addUniqueSectionFormat("numberOfColumns",t,i,r),this.addUniqueSectionFormat("equalWidth",t,i,r),this.addUniqueSectionFormat("lineBetweenColumns",t,i,r),this.addUniqueSectionFormat("breakCode",t,i,r),this.uniqueSectionFormat=e.uniqueSectionFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueSectionFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i?n.add(o,r):n.add(o,e.getPropertyDefaultValue(t))},e.prototype.copyFormat=function(e,t){t&&(t.isUndoing||t.isRedoing)?(this.uniqueSectionFormat=e.uniqueSectionFormat,this.columns=e.columns,this.removedHeaderFooters=e.removedHeaderFooters):sf.base.isNullOrUndefined(e)||(this.removedHeaderFooters=e.removedHeaderFooters,!sf.base.isNullOrUndefined(e.uniqueSectionFormat)&&e.uniqueSectionFormat.propertiesHash&&(this.updateUniqueSectionFormat(e),this.columns=e.columns))},e.prototype.updateUniqueSectionFormat=function(t){var i=void 0;this.uniqueSectionFormat&&(i=this.uniqueSectionFormat.mergeProperties(t.uniqueSectionFormat),0===this.uniqueSectionFormat.referenceCount&&(e.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0)),this.uniqueSectionFormat=new l(e.uniqueFormatType),sf.base.isNullOrUndefined(i)&&(i=this.uniqueSectionFormat.mergeProperties(t.uniqueSectionFormat)),this.uniqueSectionFormat=e.uniqueSectionFormats.addUniqueFormat(i,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e;return t.uniqueSectionFormat=this.uniqueSectionFormat,t.columns=this.columns,t},e.clear=function(){this.uniqueSectionFormats.clear()},e.uniqueSectionFormats=new d,e.uniqueFormatType=10,e}(),c=function(){function e(e){this.uniqueColumnFormat=void 0,this.ownerBase=e}return e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.uniqueColumnFormat)||e.uniqueColumnFormats.remove(this.uniqueColumnFormat),this.uniqueColumnFormat=void 0,this.ownerBase=void 0},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueColumnFormat)){var t=l.getPropertyType(this.uniqueColumnFormat.uniqueFormatType,e);return this.uniqueColumnFormat.propertiesHash.containsKey(t)}return!1},Object.defineProperty(e.prototype,"index",{get:function(){return this.indexIn},set:function(e){this.indexIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.getPropertyValue("width")},set:function(e){this.setPropertyValue("width",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(e){this.setPropertyValue("space",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueColumnFormat)&&this.uniqueColumnFormat.propertiesHash.containsKey(i))return this.uniqueColumnFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"width":t=36;break;case"space":t=0}return t},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueColumnFormat))this.initializeUniqueColumnFormat(t,i);else{var r=l.getPropertyType(this.uniqueColumnFormat.uniqueFormatType,t);if(this.uniqueColumnFormat.propertiesHash.containsKey(r)&&this.uniqueColumnFormat.propertiesHash.get(r)===i)return;this.uniqueColumnFormat=e.uniqueColumnFormats.updateUniqueFormat(this.uniqueColumnFormat,t,i)}},e.prototype.initializeUniqueColumnFormat=function(t,i){var r=new a;this.addUniqueColumnFormat("width",t,i,r),this.addUniqueColumnFormat("space",t,i,r),this.uniqueColumnFormat=e.uniqueColumnFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueColumnFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i?n.add(o,r):n.add(o,e.getPropertyDefaultValue(t))},e.prototype.updateUniqueColumnFormat=function(t){var i=void 0;this.uniqueColumnFormat&&(i=this.uniqueColumnFormat.mergeProperties(t.uniqueColumnFormat),0===this.uniqueColumnFormat.referenceCount&&(e.uniqueColumnFormats.remove(this.uniqueColumnFormat),this.uniqueColumnFormat=void 0)),this.uniqueColumnFormat=new l(e.uniqueFormatType),sf.base.isNullOrUndefined(i)&&(i=this.uniqueColumnFormat.mergeProperties(t.uniqueColumnFormat)),this.uniqueColumnFormat=e.uniqueColumnFormats.addUniqueFormat(i,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.width=this.width,t.space=this.space,t},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.uniqueColumnFormat)||(this.width=e.width,this.space=e.space)},e.clear=function(){this.uniqueColumnFormats.clear()},e.uniqueColumnFormats=new d,e.uniqueFormatType=11,e}(),p=function(){function e(e){this.uniqueBorderFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"color",{get:function(){return this.getPropertyValue("color")},set:function(e){this.setPropertyValue("color",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return this.getPropertyValue("lineStyle")},set:function(e){this.setPropertyValue("lineStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this.getPropertyValue("lineWidth")},set:function(e){this.setPropertyValue("lineWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadow",{get:function(){return this.getPropertyValue("shadow")},set:function(e){this.setPropertyValue("shadow",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(e){this.setPropertyValue("space",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasNoneStyle",{get:function(){return this.getPropertyValue("hasNoneStyle")},set:function(e){this.setPropertyValue("hasNoneStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBorderDefined",{get:function(){return"None"!==this.lineStyle||this.hasNoneStyle&&this.hasValue("hasNoneStyle")},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueBorderFormat)){var r=this.uniqueBorderFormat.propertiesHash.get(i);if(!sf.base.isNullOrUndefined(r))return r}}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueBorderFormat))this.initializeUniqueBorder(t,i);else{var r=l.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,t);if(this.uniqueBorderFormat.propertiesHash.containsKey(r)&&this.uniqueBorderFormat.propertiesHash.get(r)===i)return;this.uniqueBorderFormat=e.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat,t,i)}},e.prototype.initializeUniqueBorder=function(t,i){var r=new a;this.addUniqueBorderFormat("color",t,i,r),this.addUniqueBorderFormat("lineStyle",t,i,r),this.addUniqueBorderFormat("lineWidth",t,i,r),this.addUniqueBorderFormat("shadow",t,i,r),this.addUniqueBorderFormat("space",t,i,r),this.addUniqueBorderFormat("hasNoneStyle",t,i,r),this.uniqueBorderFormat=e.uniqueBorderFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueBorderFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i&&n.add(o,r)},e.prototype.isEqualFormat=function(e){var t=!1;return this.color===e.color&&this.lineStyle===e.lineStyle&&this.lineWidth===e.lineWidth&&this.shadow==e.shadow&&this.space===e.space&&(t=!0),t},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"color":t="#000000";break;case"lineStyle":t="None";break;case"lineWidth":t=0;break;case"shadow":t=!1;break;case"space":t=0;break;case"hasNoneStyle":t=!1}return t},e.prototype.getLineWidth=function(){switch(this.lineStyle){case"None":case"Cleared":return 0;case"Triple":case"Double":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"Emboss3D":case"Engrave3D":for(var e=this.getBorderLineWidthArray(this.lineStyle,this.lineWidth),t=0,i=0;i<e.length;i++)t+=e[i];return t;case"Single":case"DashLargeGap":case"DashSmallGap":case"Dot":case"DashDot":case"DashDotDot":case"Thick":return this.lineWidth>=.5?this.lineWidth:.5;case"SingleWavy":return 1.5===this.lineWidth?3:2.5;case"DoubleWavy":return 6.75;case"DashDotStroked":case"Outset":return this.lineWidth>=.5?this.lineWidth:.5}return this.lineWidth>=.5?this.lineWidth:.5},e.prototype.getBorderLineWidthArray=function(e,t){var i=[t];switch(e){case"Double":i=[1,1,1];break;case"ThinThickSmallGap":i=[1,-.75,-.75];break;case"ThickThinSmallGap":i=[-.75,-.75,1];break;case"ThinThickMediumGap":i=[1,.5,.5];break;case"ThickThinMediumGap":i=[.5,.5,1];break;case"ThinThickLargeGap":i=[-1.5,1,-.75];break;case"ThickThinLargeGap":i=[-.75,1,-1.5];break;case"Triple":i=[1,1,1,1,1];break;case"ThinThickThinSmallGap":i=[-.75,-.75,1,-.75,-.75];break;case"ThinThickThinMediumGap":i=[.5,.5,1,.5,.5];break;case"ThinThickThinLargeGap":i=[-.75,1,-1.5,1,-.75];break;case"Emboss3D":case"Engrave3D":i=[.25,0,1,0,.25]}if(1===i.length)return[t];for(var r=0;r<i.length;r++)i[parseInt(r.toString(),10)]>=0?i[parseInt(r.toString(),10)]=i[parseInt(r.toString(),10)]*t:i[parseInt(r.toString(),10)]=Math.abs(i[parseInt(r.toString(),10)]);return i},e.prototype.getBorderWeight=function(){var e=0,t=(this.getNumberOfLines(),this.getBorderNumber());switch(this.lineStyle){case"Single":case"DashSmallGap":case"DashDot":case"DashDotDot":case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"SingleWavy":case"DoubleWavy":case"DashDotStroked":case"Emboss3D":case"Engrave3D":case"Outset":case"Inset":case"Thick":e=this.lineWidth*t;break;case"Dot":case"DashLargeGap":e=1}return e},e.prototype.getBorderNumber=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},e.prototype.getNumberOfLines=function(){var e=0;switch(this.lineStyle){case"Single":case"Dot":case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":e=1;break;case"Double":e=3;break;case"Triple":e=5;break;case"ThinThickSmallGap":case"ThickThinSmallGap":e=3;break;case"ThinThickThinSmallGap":e=5;break;case"ThinThickMediumGap":case"ThickThinMediumGap":e=3;break;case"ThinThickThinMediumGap":e=5;break;case"ThinThickLargeGap":case"ThickThinLargeGap":e=3;break;case"ThinThickThinLargeGap":e=5;break;case"SingleWavy":e=1;break;case"DoubleWavy":e=2;break;case"DashDotStroked":e=1;break;case"Emboss3D":case"Engrave3D":e=3;break;case"Outset":case"Inset":case"Thick":e=1}return e},e.prototype.getPrecedence=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},e.prototype.hasValues=function(){return this.hasValue("color")||this.hasValue("lineStyle")||this.hasValue("lineWidth")||this.hasValue("shadow")||this.hasValue("space")||this.hasValue("hasNoneStyle")},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueBorderFormat)){var t=l.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,e);return this.uniqueBorderFormat.propertiesHash.containsKey(t)}return!1},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.color=this.color,t.lineStyle=this.lineStyle,t.lineWidth=this.lineWidth,t.shadow=this.shadow,t.space=this.space,t},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.uniqueBorderFormat)||e.uniqueBorderFormats.remove(this.uniqueBorderFormat),this.uniqueBorderFormat=void 0},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.uniqueBorderFormat)||(e.hasValue("color")&&(this.color=e.color),e.hasValue("lineStyle")&&(this.lineStyle=e.lineStyle),e.hasValue("lineWidth")&&(this.lineWidth=e.lineWidth),e.hasValue("shadow")&&(this.shadow=e.shadow),e.hasValue("space")&&(this.space=e.space),e.hasValue("hasNoneStyle")&&(this.hasNoneStyle=e.hasNoneStyle))},e.clear=function(){this.uniqueBorderFormats.clear()},e.uniqueBorderFormats=new d,e.uniqueFormatType=1,e}(),g=function(){function e(e){this.leftIn=new p(this),this.rightIn=new p(this),this.topIn=new p(this),this.bottomIn=new p(this),this.horizontalIn=new p(this),this.verticalIn=new p(this),this.diagonalUpIn=new p(this),this.diagonalDownIn=new p(this),this.isParsing=!1,this.ownerBase=e}return Object.defineProperty(e.prototype,"left",{get:function(){return this.ownerBase instanceof ul?this.getPropertyValue("left"):this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.ownerBase instanceof ul?this.getPropertyValue("right"):this.rightIn},set:function(e){this.rightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.ownerBase instanceof ul?this.getPropertyValue("top"):this.topIn},set:function(e){this.topIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.ownerBase instanceof ul?this.getPropertyValue("bottom"):this.bottomIn},set:function(e){this.bottomIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontal",{get:function(){return this.ownerBase instanceof ul?this.getPropertyValue("horizontal"):this.horizontalIn},set:function(e){this.horizontalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertical",{get:function(){return this.ownerBase instanceof ul?this.getPropertyValue("vertical"):this.verticalIn},set:function(e){this.verticalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diagonalUp",{get:function(){return this.diagonalUpIn},set:function(e){this.diagonalUpIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diagonalDown",{get:function(){return this.diagonalDownIn},set:function(e){this.diagonalDownIn=e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){var t=this.getBorder(e);if(this.isParsing)return t;if(t.hasValues())return t;var i=this.ownerBase.baseStyle;if(!sf.base.isNullOrUndefined(i)){for(var r=this;!sf.base.isNullOrUndefined(i);){var n=void 0;if(this.ownerBase.listFormat.hasValue("listId")||(n=i.paragraphFormat.getListPargaraphFormat(e)),i.paragraphFormat.borders.getBorder(e).hasValues()){r=i.paragraphFormat.borders;break}if(!sf.base.isNullOrUndefined(n)&&n.borders.getBorder(e).hasValues()){r=n.borders;break}i=i.basedOn}if(!sf.base.isNullOrUndefined(i))return r.getBorder(e)}return this.getDefaultValue(e)},e.prototype.getDefaultValue=function(e){var t,i=this.documentParagraphFormat();return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.borders)||(t=i.borders.getBorder(e)),t},e.prototype.documentParagraphFormat=function(){var e;return this.ownerBase instanceof ul&&(e=this.ownerBase.getDocumentParagraphFormat()),e},e.prototype.getBorder=function(e){switch(e){case"left":return this.leftIn;case"right":return this.rightIn;case"top":return this.topIn;case"bottom":return this.bottomIn;case"vertical":return this.verticalIn;case"horizontal":return this.horizontalIn}},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.leftIn)||this.leftIn.destroy(),sf.base.isNullOrUndefined(this.topIn)||this.topIn.destroy(),sf.base.isNullOrUndefined(this.bottomIn)||this.bottomIn.destroy(),sf.base.isNullOrUndefined(this.rightIn)||this.rightIn.destroy(),sf.base.isNullOrUndefined(this.horizontalIn)||this.horizontalIn.destroy(),sf.base.isNullOrUndefined(this.verticalIn)||this.verticalIn.destroy(),sf.base.isNullOrUndefined(this.diagonalDown)||this.diagonalDown.destroy(),sf.base.isNullOrUndefined(this.diagonalUp)||this.diagonalUp.destroy(),this.topIn=void 0,this.bottomIn=void 0,this.leftIn=void 0,this.rightIn=void 0,this.horizontalIn=void 0,this.verticalIn=void 0,this.diagonalDownIn=void 0,this.diagonalUpIn=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.top=sf.base.isNullOrUndefined(this.topIn)?void 0:this.topIn.cloneFormat(),t.bottom=sf.base.isNullOrUndefined(this.bottomIn)?void 0:this.bottomIn.cloneFormat(),t.left=sf.base.isNullOrUndefined(this.leftIn)?void 0:this.leftIn.cloneFormat(),t.right=sf.base.isNullOrUndefined(this.rightIn)?void 0:this.rightIn.cloneFormat(),t.horizontal=sf.base.isNullOrUndefined(this.horizontalIn)?void 0:this.horizontalIn.cloneFormat(),t.vertical=sf.base.isNullOrUndefined(this.verticalIn)?void 0:this.verticalIn.cloneFormat(),t.diagonalUp=sf.base.isNullOrUndefined(this.diagonalUp)?void 0:this.diagonalUp.cloneFormat(),t.diagonalDown=sf.base.isNullOrUndefined(this.diagonalDown)?void 0:this.diagonalDown.cloneFormat(),t},e.prototype.copyFormat=function(e){if(!sf.base.isNullOrUndefined(e.getBorder("left"))&&e.getBorder("left")instanceof p){var t=new p(this);t.copyFormat(e.getBorder("left")),this.left=t}if(!sf.base.isNullOrUndefined(e.getBorder("right"))&&e.getBorder("right")instanceof p){var i=new p(this);i.copyFormat(e.getBorder("right")),this.right=i}if(!sf.base.isNullOrUndefined(e.getBorder("top"))&&e.getBorder("top")instanceof p){var r=new p(this);r.copyFormat(e.getBorder("top")),this.top=r}if(!sf.base.isNullOrUndefined(e.getBorder("bottom"))&&e.getBorder("bottom")instanceof p){var n=new p(this);n.copyFormat(e.getBorder("bottom")),this.bottom=n}if(!sf.base.isNullOrUndefined(e.getBorder("horizontal"))&&e.getBorder("horizontal")instanceof p){var o=new p(this);o.copyFormat(e.getBorder("horizontal")),this.horizontal=o}if(!sf.base.isNullOrUndefined(e.getBorder("vertical"))&&e.getBorder("vertical")instanceof p){var s=new p(this);s.copyFormat(e.getBorder("vertical")),this.vertical=s}!sf.base.isNullOrUndefined(e.diagonalDown)&&e.diagonalDown instanceof p&&(this.diagonalDown=new p(this),this.diagonalDown.copyFormat(e.diagonalDown)),!sf.base.isNullOrUndefined(e.diagonalUp)&&e.diagonalUp instanceof p&&(this.diagonalUp=new p(this),this.diagonalUp.copyFormat(e.diagonalUp))},e}(),f=function(){function e(){}return e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.overrideListLevel)||this.overrideListLevel.destroy(),this.levelNumber=void 0,this.startAt=void 0,this.overrideListLevel=void 0},e.prototype.clone=function(){var t=new e;return t.startAt=this.startAt,t.levelNumber=this.levelNumber,sf.base.isNullOrUndefined(this.overrideListLevel)||(t.overrideListLevel=this.overrideListLevel.clone(t)),t},e}(),u=function(){function e(){this.listId=-1,this.sourceListId=-1,this.abstractListId=-1,this.abstractList=void 0,this.levelOverrides=[]}return e.prototype.getListLevel=function(e){var t=this.getLevelOverride(e);return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.overrideListLevel)?this.abstractList.levels[parseInt(e.toString(),10)]:t.overrideListLevel},e.prototype.getLevelOverride=function(e){for(var t=0;t<this.levelOverrides.length;t++)if(this.levelOverrides[parseInt(t.toString(),10)]instanceof f){var i=this.levelOverrides[parseInt(t.toString(),10)];if(i.levelNumber===e)return i}},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.levelOverrides)||(this.levelOverrides=[]),this.abstractListId=void 0,this.listId=void 0,this.sourceListId=void 0,this.levelOverrides=void 0},e.prototype.mergeList=function(e){sf.base.isNullOrUndefined(this.abstractListId)||-1===this.abstractListId||(this.abstractListId=e.abstractListId),sf.base.isNullOrUndefined(this.listId)||-1===this.listId||(this.listId=e.listId),sf.base.isNullOrUndefined(this.sourceListId)||-1===this.sourceListId||(this.sourceListId=e.sourceListId),sf.base.isNullOrUndefined(this.levelOverrides)||0===this.levelOverrides.length||(this.levelOverrides=e.levelOverrides)},e.prototype.clone=function(){for(var t=new e,i=0;i<this.levelOverrides.length;i++)t.levelOverrides.push(this.levelOverrides[parseInt(i.toString(),10)].clone());return t},e}(),m=function(){function e(e){this.uniqueListFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.list=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"listId",{get:function(){return this.getPropertyValue("listId")},set:function(e){if(e>=0){if(!sf.base.isNullOrUndefined(this.ownerBase)){var t=this.ownerBase.getDocumentHelperObject();sf.base.isNullOrUndefined(t)||(this.list=t.getListById(e))}}else!sf.base.isNullOrUndefined(this.list)&&e<0&&(this.list=void 0);this.setPropertyValue("listId",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelNumber",{get:function(){return this.getPropertyValue("listLevelNumber")},set:function(e){this.setPropertyValue("listLevelNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevel",{get:function(){var e=void 0;if(sf.base.isNullOrUndefined(this.list))for(var t=this.baseStyle;!sf.base.isNullOrUndefined(t)&&t instanceof vl;){if(t.paragraphFormat.listFormat.list){e=t.paragraphFormat.listFormat.list;break}t=t.basedOn}else e=this.list;return sf.base.isNullOrUndefined(e)?void 0:e.getListLevel(this.listLevelNumber)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){r=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueListFormat)&&this.uniqueListFormat.propertiesHash.containsKey(r))return this.uniqueListFormat.propertiesHash.get(r)}else if(this.baseStyle instanceof vl){for(var i=this.baseStyle;!sf.base.isNullOrUndefined(i)&&!i.paragraphFormat.listFormat.hasValue(t);)i=i.basedOn;if(!sf.base.isNullOrUndefined(i)){var r=l.getPropertyType(e.uniqueFormatType,t);return i.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(r)}}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueListFormat))this.initializeUniqueListFormat(t,i);else{var r=l.getPropertyType(this.uniqueListFormat.uniqueFormatType,t);if(this.uniqueListFormat.propertiesHash.containsKey(r)&&this.uniqueListFormat.propertiesHash.get(r)===i)return;this.uniqueListFormat=e.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat,t,i)}},e.prototype.initializeUniqueListFormat=function(t,i){var r=new a;this.addUniqueListFormat("listId",t,i,r),this.addUniqueListFormat("listLevelNumber",t,i,r),this.uniqueListFormat=e.uniqueListFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueListFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listId":t=-1;break;case"listLevelNumber":t=0}return t},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.uniqueListFormat)||(this.listId=e.listId,this.listLevelNumber=e.listLevelNumber),sf.base.isNullOrUndefined(e.baseStyle)||(this.baseStyle=e.baseStyle),sf.base.isNullOrUndefined(e.list)||(this.list=e.list))},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueListFormat)){var t=l.getPropertyType(this.uniqueListFormat.uniqueFormatType,e);return this.uniqueListFormat.propertiesHash.containsKey(t)}return!1},e.prototype.clearFormat=function(){sf.base.isNullOrUndefined(this.uniqueListFormat)||0!==this.uniqueListFormat.referenceCount||e.uniqueListFormats.remove(this.uniqueListFormat),this.uniqueListFormat=void 0,this.list=void 0},e.prototype.destroy=function(){this.clearFormat()},e.clear=function(){this.uniqueListFormats.clear()},e.prototype.applyStyle=function(e){this.baseStyle=e},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e){sf.base.isNullOrUndefined(this.getValue("listId"))&&(this.listId=e.getValue("listId")),sf.base.isNullOrUndefined(this.getValue("listLevelNumber"))&&(this.listLevelNumber=e.getValue("listLevelNumber")),sf.base.isNullOrUndefined(e.list)||(sf.base.isNullOrUndefined(this.list)&&(this.list=new u),this.list.mergeList(e.list))},e.prototype.cloneListFormat=function(){var t=new e(void 0);return t.list=this.list,t.listId=this.listId,t.baseStyle=this.baseStyle,t.listLevelNumber=this.listLevelNumber,t.uniqueListFormat=this.uniqueListFormat,t},e.uniqueListFormats=new d,e.uniqueFormatType=7,e}();!function(e){e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft",e[e.WordSplit=2]="WordSplit",e[e.Number=4]="Number",e[e.Tab=6]="Tab"}(e||(e={})),function(e){e[e.English=0]="English",e[e.Hindi=1]="Hindi",e[e.Korean=2]="Korean",e[e.Chinese=3]="Chinese",e[e.Arabic=4]="Arabic",e[e.Hebrew=5]="Hebrew",e[e.Japanese=6]="Japanese",e[e.Thai=7]="Thai"}(t||(t={})),function(e){e[e.Default=0]="Default",e[e.EastAsia=1]="EastAsia",e[e.CS=2]="CS"}(r||(r={})),function(e){e[e.af_ZA=1078]="af_ZA",e[e.sq_AL=1052]="sq_AL",e[e.am_ET=1118]="am_ET",e[e.gsw_FR=1156]="gsw_FR",e[e.ar_DZ=5121]="ar_DZ",e[e.ar_BH=15361]="ar_BH",e[e.ar_EG=3073]="ar_EG",e[e.ar_IQ=2049]="ar_IQ",e[e.ar_JO=11265]="ar_JO",e[e.ar_KW=13313]="ar_KW",e[e.ar_LB=12289]="ar_LB",e[e.ar_LY=4097]="ar_LY",e[e.ar_MA=6145]="ar_MA",e[e.ar_OM=8193]="ar_OM",e[e.ar_QA=16385]="ar_QA",e[e.ar_SA=1025]="ar_SA",e[e.ar_SY=10241]="ar_SY",e[e.ar_TN=7169]="ar_TN",e[e.ar_AE=14337]="ar_AE",e[e.ar_YE=9217]="ar_YE",e[e.hy_AM=1067]="hy_AM",e[e.as_IN=1101]="as_IN",e[e.az_Cyrl_AZ=2092]="az_Cyrl_AZ",e[e.az_Latn_AZ=1068]="az_Latn_AZ",e[e.ba_RU=1133]="ba_RU",e[e.eu_ES=1069]="eu_ES",e[e.be_BY=1059]="be_BY",e[e.bn_BD=2117]="bn_BD",e[e.bn_IN=1093]="bn_IN",e[e.bs_Cyrl_BA=8218]="bs_Cyrl_BA",e[e.bs_Latn_BA=5146]="bs_Latn_BA",e[e.bg_BG=1026]="bg_BG",e[e.br_FR=1150]="br_FR",e[e.my_MM=1109]="my_MM",e[e.ca_ES=1027]="ca_ES",e[e.chr_US=1116]="chr_US",e[e.zh_HK=3076]="zh_HK",e[e.zh_MO=5124]="zh_MO",e[e.zh_CN=2052]="zh_CN",e[e.zh_SG=4100]="zh_SG",e[e.zh_TW=1028]="zh_TW",e[e.co_FR=1155]="co_FR",e[e.hr_BA=4122]="hr_BA",e[e.hr_HR=1050]="hr_HR",e[e.cs_CZ=1029]="cs_CZ",e[e.da_DK=1030]="da_DK",e[e.prs_AF=1164]="prs_AF",e[e.dv_MV=1125]="dv_MV",e[e.nl_BE=2067]="nl_BE",e[e.nl_NL=1043]="nl_NL",e[e.bin_NG=1126]="bin_NG",e[e.et_EE=1061]="et_EE",e[e.en_AU=3081]="en_AU",e[e.en_BZ=10249]="en_BZ",e[e.en_CA=4105]="en_CA",e[e.en_029=9225]="en_029",e[e.en_HK=15369]="en_HK",e[e.en_IN=16393]="en_IN",e[e.en_ID=14345]="en_ID",e[e.en_IE=6153]="en_IE",e[e.en_JM=8201]="en_JM",e[e.en_MY=17417]="en_MY",e[e.en_NZ=5129]="en_NZ",e[e.en_PH=13321]="en_PH",e[e.en_SG=18441]="en_SG",e[e.en_ZA=7177]="en_ZA",e[e.en_TT=11273]="en_TT",e[e.en_GB=2057]="en_GB",e[e.en_US=1033]="en_US",e[e.en_ZW=12297]="en_ZW",e[e.fo_FO=1080]="fo_FO",e[e.fil_PH=1124]="fil_PH",e[e.fi_FI=1035]="fi_FI",e[e.fr_BE=2060]="fr_BE",e[e.fr_CM=11276]="fr_CM",e[e.fr_CA=3084]="fr_CA",e[e.fr_CD=9228]="fr_CD",e[e.fr_CI=12300]="fr_CI",e[e.fr_FR=1036]="fr_FR",e[e.fr_HT=15372]="fr_HT",e[e.fr_LU=5132]="fr_LU",e[e.fr_ML=13324]="fr_ML",e[e.fr_MC=6156]="fr_MC",e[e.fr_MA=14348]="fr_MA",e[e.fr_RE=8204]="fr_RE",e[e.fr_SN=10252]="fr_SN",e[e.fr_CH=4108]="fr_CH",e[e.fy_NL=1122]="fy_NL",e[e.ff_NG=1127]="ff_NG",e[e.gd_GB=1084]="gd_GB",e[e.gl_ES=1110]="gl_ES",e[e.ka_GE=1079]="ka_GE",e[e.de_AT=3079]="de_AT",e[e.de_DE=1031]="de_DE",e[e.de_LI=5127]="de_LI",e[e.de_LU=4103]="de_LU",e[e.de_CH=2055]="de_CH",e[e.el_GR=1032]="el_GR",e[e.gn_PY=1140]="gn_PY",e[e.gu_IN=1095]="gu_IN",e[e.kl_GL=1135]="kl_GL",e[e.ha_Latn_NG=1128]="ha_Latn_NG",e[e.haw_US=1141]="haw_US",e[e.he_IL=1037]="he_IL",e[e.hi_IN=1081]="hi_IN",e[e.hu_HU=1038]="hu_HU",e[e.ibb_NG=1129]="ibb_NG",e[e.is_IS=1039]="is_IS",e[e.ig_NG=1136]="ig_NG",e[e.id_ID=1057]="id_ID",e[e.iu_Latn_CA=2141]="iu_Latn_CA",e[e.iu_Cans_CA=1117]="iu_Cans_CA",e[e.it_IT=1040]="it_IT",e[e.it_CH=2064]="it_CH",e[e.ga_IE=2108]="ga_IE",e[e.xh_ZA=1076]="xh_ZA",e[e.zu_ZA=1077]="zu_ZA",e[e.kn_IN=1099]="kn_IN",e[e.kr_NG=1137]="kr_NG",e[e.ks_Deva=2144]="ks_Deva",e[e.ks_Arab=1120]="ks_Arab",e[e.kk_KZ=1087]="kk_KZ",e[e.km_KH=1107]="km_KH",e[e.kok_IN=1111]="kok_IN",e[e.ko_KR=1042]="ko_KR",e[e.ky_KG=1088]="ky_KG",e[e.qut_GT=1158]="qut_GT",e[e.rw_RW=1159]="rw_RW",e[e.lo_LA=1108]="lo_LA",e[e.la_Latn=1142]="la_Latn",e[e.lv_LV=1062]="lv_LV",e[e.lt_LT=1063]="lt_LT",e[e.dsb_DE=2094]="dsb_DE",e[e.lb_LU=1134]="lb_LU",e[e.mk_MK=1071]="mk_MK",e[e.ms_BN=2110]="ms_BN",e[e.ms_MY=1086]="ms_MY",e[e.ml_IN=1100]="ml_IN",e[e.mt_MT=1082]="mt_MT",e[e.mni_IN=1112]="mni_IN",e[e.mi_NZ=1153]="mi_NZ",e[e.mr_IN=1102]="mr_IN",e[e.arn_CL=1146]="arn_CL",e[e.mn_MN=1104]="mn_MN",e[e.mn_Mong_CN=2128]="mn_Mong_CN",e[e.ne_NP=1121]="ne_NP",e[e.ne_IN=2145]="ne_IN",e[e.nb_NO=1044]="nb_NO",e[e.nn_NO=2068]="nn_NO",e[e.oc_FR=1154]="oc_FR",e[e.or_IN=1096]="or_IN",e[e.om_Ethi_ET=1138]="om_Ethi_ET",e[e.pap_AN=1145]="pap_AN",e[e.ps_AF=1123]="ps_AF",e[e.fa_IR=1065]="fa_IR",e[e.pl_PL=1045]="pl_PL",e[e.pt_BR=1046]="pt_BR",e[e.pt_PT=2070]="pt_PT",e[e.pa_IN=1094]="pa_IN",e[e.pa_PK=2118]="pa_PK",e[e.quz_BO=1131]="quz_BO",e[e.guz_EC=2155]="guz_EC",e[e.guz_PE=3179]="guz_PE",e[e.ro_RO=1048]="ro_RO",e[e.ro_MO=2072]="ro_MO",e[e.rm_CH=1047]="rm_CH",e[e.ru_RU=1049]="ru_RU",e[e.ru_MO=2073]="ru_MO",e[e.smn_FI=9275]="smn_FI",e[e.smj_NO=4155]="smj_NO",e[e.smj_SE=5179]="smj_SE",e[e.se_FI=3131]="se_FI",e[e.se_NO=1083]="se_NO",e[e.se_SE=2107]="se_SE",e[e.sms_FI=8251]="sms_FI",e[e.sma_NO=6203]="sma_NO",e[e.sma_SE=7227]="sma_SE",e[e.sa_IN=1103]="sa_IN",e[e.sr_Cyrl_BA=7194]="sr_Cyrl_BA",e[e.sr_Cyrl_CS=3098]="sr_Cyrl_CS",e[e.sr_Latn_BA=6170]="sr_Latn_BA",e[e.sr_Latn_CS=2074]="sr_Latn_CS",e[e.nso_ZA=1132]="nso_ZA",e[e.tn_ZA=1074]="tn_ZA",e[e.sd_Arab_PK=2137]="sd_Arab_PK",e[e.sd_Deva_IN=1113]="sd_Deva_IN",e[e.si_LK=1115]="si_LK",e[e.sk_SK=1051]="sk_SK",e[e.sl_SI=1060]="sl_SI",e[e.so_SO=1143]="so_SO",e[e.es_AR=11274]="es_AR",e[e.es_BO=16394]="es_BO",e[e.es_CL=13322]="es_CL",e[e.es_CO=9226]="es_CO",e[e.es_CR=5130]="es_CR",e[e.es_DO=7178]="es_DO",e[e.es_EC=12298]="es_EC",e[e.es_SV=17418]="es_SV",e[e.es_GT=4106]="es_GT",e[e.es_HN=18442]="es_HN",e[e.es_MX=2058]="es_MX",e[e.es_NI=19466]="es_NI",e[e.es_PA=6154]="es_PA",e[e.es_PY=15370]="es_PY",e[e.es_PE=10250]="es_PE",e[e.es_PR=20490]="es_PR",e[e.es_ES=3082]="es_ES",e[e.es_ES_tradnl=1034]="es_ES_tradnl",e[e.es_US=21514]="es_US",e[e.es_UY=14346]="es_UY",e[e.es_VE=8202]="es_VE",e[e.st_ZA=1072]="st_ZA",e[e.sw_KE=1089]="sw_KE",e[e.sv_FI=2077]="sv_FI",e[e.sv_SE=1053]="sv_SE",e[e.syr_SY=1114]="syr_SY",e[e.tg_Cyrl_TJ=1064]="tg_Cyrl_TJ",e[e.tzm_Arab_MA=1119]="tzm_Arab_MA",e[e.tzm_Latn_DZ=2143]="tzm_Latn_DZ",e[e.ta_IN=1097]="ta_IN",e[e.tt_RU=1092]="tt_RU",e[e.te_IN=1098]="te_IN",e[e.th_TH=1054]="th_TH",e[e.bo_CN=1105]="bo_CN",e[e.ti_ER=2163]="ti_ER",e[e.ti_ET=1139]="ti_ET",e[e.ts_ZA=1073]="ts_ZA",e[e.tr_TR=1055]="tr_TR",e[e.tk_TM=1090]="tk_TM",e[e.ug_CN=1152]="ug_CN",e[e.uk_UA=1058]="uk_UA",e[e.hsb_DE=1070]="hsb_DE",e[e.ur_PK=1056]="ur_PK",e[e.uz_Cyrl_UZ=2115]="uz_Cyrl_UZ",e[e.uz_Latn_UZ=1091]="uz_Latn_UZ",e[e.ve_ZA=1075]="ve_ZA",e[e.vi_VN=1066]="vi_VN",e[e.cy_GB=1106]="cy_GB",e[e.wo_SN=1160]="wo_SN",e[e.sah_RU=1157]="sah_RU",e[e.ii_CN=1144]="ii_CN",e[e.yi_Hebr=1085]="yi_Hebr",e[e.yo_NG=1130]="yo_NG",e[e.ja_JP=1041]="ja_JP"}(n||(n={})),function(e){e.EvenPage="EvenPage",e.NewPage="NewPage",e.Continuous="NoBreak",e.OddPage="OddPage"}(o||(o={}));var y,v,w,b,x=function(){function e(){}return e.replaceSpecialChars=function(e){return e=(e=(e=e.replace("^[\\s]*","")).replace("^[#@!~\\$%^&\\*\\(\\)\\-_\\+\\.=\\{\\}\\[\\]:;,<>\\?'\\\\\"\\“\\”\\//0123456789]+","")).replace("[#@!~\\$%^&\\*\\(\\)\\-_\\+\\.=\\{\\}\\[\\]:;,<>\\?'\\\\\"\\“\\”\\//0123456789]+$","")},e.getSpellCheckData=function(e){for(var t=[],i=0,r=(e=(e=(e=(e=(e=(e=e.replace("\r\n"," ")).replace("\n"," ")).replace("\r"," ")).replace("\v"," ")).replace("\t"," ")).replace("/"," ")).split(" ");i<r.length;i++){var n=r[i],o={};o.Text=this.replaceSpecialChars(n),o.HasSpellError=!1,t.push(o)}return t},e.insert=function(e,t,i){return t>=0?[e.slice(0,t)+i+e.slice(t)].join(""):i+this},e.getSfdtDocument=function(e){if(e=e instanceof Object?e:JSON.parse(e),!sf.base.isNullOrUndefined(e.sfdt)){var t=new sf.compression.ZipArchive;t.open(JSON.stringify(e.sfdt));var i=t.items[0],r=new Uint8Array(i.data),n=new TextDecoder("utf-8").decode(r);e=JSON.parse(n)}return e},e.checkTextFormat=function(e){return!(!/^(M{0,3})(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/i.test(e)&&!/^[0-9]+$/.test(e))},e.remove=function(e,t){return 0===t?e.substring(t+1,e.length):e.substring(0,t)+e.substring(t+1,e.length)},e.indexOfAny=function(e,t){for(var i=void 0,r=0;r<t.length;r++){var n=e.indexOf(t[parseInt(r.toString(),10)]);(-1!==n&&sf.base.isNullOrUndefined(i)||-1!==n&&n<i)&&(i=n)}return sf.base.isNullOrUndefined(i)?-1:i},e.lastIndexOfAny=function(e,t){for(var i=e.length-1;i>=0;i--)for(var r=0;r<=t.length-1;r++)if(e[parseInt(i.toString(),10)]===t[parseInt(r.toString(),10)])return i;return-1},e.convertArgbToRgb=function(e){return e.length>=8?e.substr(0,6):e},e.convertRgbToHex=function(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t},e.getTabStopFromObject=function(e){var t=new fl;return t.position=e.positionIn,t.deletePosition=e.deletePositionIn,t.tabLeader=e.leader,t.tabJustification=e.justification,t},e.convertHexToRgb=function(e){var t,i,r;if(e){e=e.replace(/[^0-9A-â€Œâ€‹F]/gi,"");var n=parseInt(e,16);return 8==e.length?(t=n>>32&255,i=n>>16&255,r=n>>8&255):6==e.length&&(t=n>>16&255,i=n>>8&255,r=255&n),{r:t,g:i,b:r}}},e.addCssStyle=function(e){var t=document.createElement("style");t.style.cssText?t.style.cssText=e:t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t)},e.getHighlightColorCode=function(e){var t="#ffffff";switch(e){case"Yellow":t="#ffff00";break;case"BrightGreen":t="#00ff00";break;case"Turquoise":t="#00ffff";break;case"Pink":t="#ff00ff";break;case"Blue":t="#0000ff";break;case"Red":t="#ff0000";break;case"DarkBlue":t="#000080";break;case"Teal":t="#008080";break;case"Green":t="#008000";break;case"Violet":t="#800080";break;case"DarkRed":t="#800000";break;case"DarkYellow":t="#808000";break;case"Gray50":t="#808080";break;case"Gray25":t="#c0c0c0";break;case"Black":t="#000000"}return t},e.isVeryDark=function(e){var t=e.substring(1);return(299*parseInt(t.substr(0,2),16)+587*parseInt(t.substr(2,2),16)+114*parseInt(t.substr(4,2),16))/1e3<=60},e.getColor=function(e){return e.length>0&&"#"===e[0]&&e.length>7?e.substr(0,7):e},e.getTextVerticalAlignment=function(e){switch(e){case 0:return"Top";case 1:return"Center";case 2:return"Bottom";default:return e}},e.convertPointToPixel=function(t){return t=e.round(t,5),e.round(96*t/72,5)},e.convertPixelToPoint=function(t){return e.round(72*t/96,5)},e.getNumberFromString=function(e){for(var t=[],i="",r=0,n=e;r<n.length;r++){var o=n[r];/\d|\./.test(o)?i+=o:i&&(t.push(parseFloat(i)),i="")}return i&&t.push(parseFloat(i)),parseFloat(t.join(""))},e.convertNodeListToArray=function(e){var t=[];if(!sf.base.isNullOrUndefined(e))for(var i=0;i<e.length;i++)t.push(e[i]);return t},e.isLinkedFieldCharacter=function(e){return e instanceof va&&0===e.fieldType?!sf.base.isNullOrUndefined(e.fieldEnd):e instanceof va&&2===e.fieldType?!sf.base.isNullOrUndefined(e.fieldBegin)&&!sf.base.isNullOrUndefined(e.fieldEnd):!sf.base.isNullOrUndefined(e.fieldBegin)},e.removeSpace=function(e){if(!sf.base.isNullOrUndefined(e)&&0!==e.length)for(var t=0;t<e.length;t++)" "===e.charAt(t)&&(e=e.replace(" ",""));return e},e.trimStart=function(e){for(var t=0;t<e.length&&" "===e[parseInt(t.toString(),10)];t++);return e.substring(t,e.length)},e.trimEnd=function(e){for(var t=e.length-1;t>=0&&" "===e[parseInt(t.toString(),10)];t--);return e.substring(0,t+1)},e.endsWith=function(e){return!sf.base.isNullOrUndefined(e)&&0!==e.length&&" "===e[e.length-1]},e.addSpace=function(e){var t="";if(e>0)for(var i=0;i<e;i++)t+=" ";return t},e.getBoolValue=function(e){return e?1:0},e.parseBoolValue=function(e){return e instanceof String?!sf.base.isNullOrUndefined(e)&&"f"!=e&&"0"!=e&&"off"!=e&&"false"!=e:1==e},e.getBoolInfo=function(e,t){return 1==t?this.getBoolValue(e):e},e.getBaselineAlignmentEnumValue=function(e){switch(e){case"Normal":return 0;case"Superscript":return 1;case"Subscript":return 2}},e.getUnderlineEnumValue=function(e){switch(e){case"None":return 0;case"Single":return 1;case"Words":return 2;case"Double":return 3;case"Dotted":return 4;case"Thick":return 5;case"Dash":return 6;case"DashLong":return 7;case"DotDash":return 8;case"DotDotDash":return 9;case"Wavy":return 10;case"DottedHeavy":return 11;case"DashHeavy":return 12;case"DashLongHeavy":return 13;case"DotDashHeavy":return 14;case"DotDotDashHeavy":return 15;case"WavyHeavy":return 16;case"WavyDouble":return 17}},e.getStrikeThroughEnumValue=function(e){switch(e){case"None":return 0;case"SingleStrike":return 1;case"DoubleStrike":return 2}},e.getHighlightColorEnumValue=function(e){switch(e){case"NoColor":return 0;case"Yellow":return 1;case"BrightGreen":return 2;case"Turquoise":return 3;case"Pink":return 4;case"Blue":return 5;case"Red":return 6;case"DarkBlue":return 7;case"Teal":return 8;case"Green":return 9;case"Violet":return 10;case"DarkRed":return 11;case"DarkYellow":return 12;case"Gray50":return 13;case"Gray25":return 14;case"Black":return 15}},e.getBiDirectionalOverride=function(e){switch(e){case"None":return 0;case"LTR":return 1;case"RTL":return 2}},e.getBreakClearType=function(e){switch(e){case"None":return 0;case"Left":return 1;case"Right":return 2;case"All":return 3}},e.getOutlineLevelEnumValue=function(e){switch(e){case"BodyText":return 0;case"Level1":return 1;case"Level2":return 2;case"Level3":return 3;case"Level4":return 4;case"Level5":return 5;case"Level6":return 6;case"Level7":return 7;case"Level8":return 8;case"Level9":return 9}},e.getTextAlignmentEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Right":return 2;case"Justify":return 3}},e.getLineStyleEnumValue=function(e){switch(e){case"Single":return 0;case"None":return 1;case"Dot":return 2;case"DashSmallGap":return 3;case"DashLargeGap":return 4;case"DashDot":return 5;case"DashDotDot":return 6;case"Double":return 7;case"Triple":return 8;case"ThinThickSmallGap":return 9;case"ThickThinSmallGap":return 10;case"ThinThickThinSmallGap":return 11;case"ThinThickMediumGap":return 12;case"ThickThinMediumGap":return 13;case"ThinThickThinMediumGap":return 14;case"ThinThickLargeGap":return 15;case"ThickThinLargeGap":return 16;case"ThinThickThinLargeGap":return 17;case"SingleWavy":return 18;case"DoubleWavy":return 19;case"DashDotStroked":return 20;case"Emboss3D":return 21;case"Engrave3D":return 22;case"Outset":return 23;case"Inset":return 24;case"Thick":return 25;case"Cleared":return 26}},e.getLineSpacingTypeEnumValue=function(e){switch(e){case"Multiple":return 0;case"AtLeast":return 1;case"Exactly":return 2}},e.writeBorder=function(t,i){var r={};return r[Br[i]]=t.hasValue("color")?t.color:void 0,r[ai[i]]=t.hasValue("hasNoneStyle")?e.getBoolInfo(t.hasNoneStyle,i):void 0,r[pi[i]]=t.hasValue("lineStyle")?1==i?this.getLineStyleEnumValue(t.lineStyle):t.lineStyle:void 0,r[gi[i]]=t.hasValue("lineWidth")?t.lineWidth:void 0,r[si[i]]=t.hasValue("shadow")?e.getBoolInfo(t.shadow,i):void 0,r[ts[i]]=t.hasValue("space")?t.space:void 0,r},e.writeParagraphBorders=function(e,t){var i={};return i[qr[t]]=this.writeBorder(e.getBorder("top"),t),i[Gr[t]]=this.writeBorder(e.getBorder("left"),t),i[jr[t]]=this.writeBorder(e.getBorder("right"),t),i[_r[t]]=this.writeBorder(e.getBorder("bottom"),t),i[di[t]]=this.writeBorder(e.getBorder("horizontal"),t),i[li[t]]=this.writeBorder(e.getBorder("vertical"),t),i},e.writeParagraphFormat=function(t,i,r,n){n=sf.base.isNullOrUndefined(n)?0:n,t[ct[n]]=this.writeParagraphBorders(r.borders,n),t[Je[n]]=i?r.leftIndent:r.getValue("leftIndent"),t[Ye[n]]=i?r.rightIndent:r.getValue("rightIndent"),t[Ze[n]]=i?r.firstLineIndent:r.getValue("firstLineIndent"),t[Qe[n]]=i?1==n?this.getTextAlignmentEnumValue(r.textAlignment):r.textAlignment:1==n?this.getTextAlignmentEnumValue(r.getValue("textAlignment")):r.getValue("textAlignment"),t[et[n]]=i?r.beforeSpacing:r.getValue("beforeSpacing"),t[$e[n]]=i?r.afterSpacing:r.getValue("afterSpacing"),t[it[n]]=i?e.getBoolInfo(r.spaceBeforeAuto,n):r.getValue("spaceBeforeAuto"),t[tt[n]]=i?e.getBoolInfo(r.spaceAfterAuto,n):r.getValue("spaceAfterAuto"),t[rt[n]]=i?r.lineSpacing:r.getValue("lineSpacing"),t[nt[n]]=i?1==n?this.getLineSpacingTypeEnumValue(r.lineSpacingType):r.lineSpacingType:1==n?this.getLineSpacingTypeEnumValue(r.getValue("lineSpacingType")):r.getValue("lineSpacingType"),t[Ee[n]]=sf.base.isNullOrUndefined(r.baseStyle)?void 0:r.baseStyle.name,t[dt[n]]=i?1==n?this.getOutlineLevelEnumValue(r.outlineLevel):r.outlineLevel:1==n?this.getOutlineLevelEnumValue(r.getValue("outlineLevel")):r.getValue("outlineLevel"),t[Re[n]]=i?e.getBoolInfo(r.bidi,n):r.getValue("bidi"),t[lt[n]]=i?e.getBoolInfo(r.keepLinesTogether,n):r.getValue("keepLinesTogether"),t[st[n]]=i?e.getBoolInfo(r.keepWithNext,n):r.getValue("keepWithNext"),t[ht[n]]=i?e.getBoolInfo(r.contextualSpacing,n):r.getValue("contextualSpacing"),t[at[n]]=i?e.getBoolInfo(r.widowControl,n):r.getValue("widowControl")},e.writeCharacterFormat=function(t,i,r,n){n=sf.base.isNullOrUndefined(n)?0:n,t[Ce[n]]=i?e.getBoolInfo(r.bold,n):r.getValue("bold"),t[We[n]]=i?e.getBoolInfo(r.italic,n):r.getValue("italic"),t[Oe[n]]=i?this.toWriteInline(r,"fontSize"):r.getValue("fontSize"),t[He[n]]=i?this.toWriteInline(r,"fontFamily"):r.getValue("fontFamily"),t[ke[n]]=i?1==n?e.getUnderlineEnumValue(r.underline):r.underline:1==n?e.getUnderlineEnumValue(r.getValue("underline")):r.getValue("underline"),t[Pe[n]]=i?1==n?e.getStrikeThroughEnumValue(r.strikethrough):r.strikethrough:1==n?e.getStrikeThroughEnumValue(r.getValue("strikethrough")):r.getValue("strikethrough"),t[Se[n]]=i?1==n?e.getBaselineAlignmentEnumValue(r.baselineAlignment):r.baselineAlignment:1==n?e.getBaselineAlignmentEnumValue(r.getValue("baselineAlignment")):r.getValue("baselineAlignment"),t[Ne[n]]=i?e.getHighlightColorEnumValue(r.highlightColor):1==n?e.getHighlightColorEnumValue(r.getValue("highlightColor")):r.getValue("highlightColor"),t[Te[n]]=i?this.toWriteInline(r,"fontColor"):r.getValue("fontColor"),t[Ee[n]]=sf.base.isNullOrUndefined(r.baseCharStyle)?void 0:r.baseCharStyle.name,t[Re[n]]=i?e.getBoolInfo(r.bidi,n):r.getValue("bidi"),t[Ue[n]]=i?e.getBiDirectionalOverride(r.bdo):e.getBiDirectionalOverride(r.getValue("bdo")),t[Me[n]]=i?e.getBoolInfo(r.boldBidi,n):r.getValue("boldBidi"),t[ze[n]]=i?e.getBoolInfo(r.italicBidi,n):r.getValue("italicBidi"),t[Le[n]]=i?r.fontSizeBidi:r.getValue("fontSizeBidi"),t[Ae[n]]=i?r.fontFamilyBidi:r.getValue("fontFamilyBidi"),t[De[n]]=i?e.getBoolInfo(r.allCaps,n):r.getValue("allCaps"),t[Fe[n]]=i?r.localeIdBidi:r.getValue("localeIdBidi"),t[xe[n]]=i?r.localeIdAscii:r.getValue("localeIdAscii"),t[Ve[n]]=i?e.getBoolInfo(r.complexScript,n):r.getValue("complexScript"),t[qe[n]]=i?this.toWriteInline(r,"fontFamilyAscii"):r.getValue("fontFamilyAscii"),t[je[n]]=i?this.toWriteInline(r,"fontFamilyNonFarEast"):r.getValue("fontFamilyNonFarEast"),t[_e[n]]=i?this.toWriteInline(r,"fontFamilyFarEast"):r.getValue("fontFamilyFarEast"),t[Bs[n]]=i?this.toWriteInline(r,"characterSpacing"):r.getValue("characterSpacing"),t[Ls[n]]=i?this.toWriteInline(r,"scaling"):r.getValue("scaling"),r.hasValue("fontFamily")&&(sf.base.isNullOrUndefined(t[qe[n]])&&(t[qe[n]]=r.fontFamily),sf.base.isNullOrUndefined(t[je[n]])&&(t[je[n]]=r.fontFamily),sf.base.isNullOrUndefined(t[_e[n]])&&(t[_e[n]]=r.fontFamily))},e.isThemeFont=function(e){return"majorAscii"==e||"majorBidi"==e||"majorEastAsia"==e||"majorHAnsi"==e||"minorAscii"==e||"minorBidi"==e||"minorEastAsia"==e||"minorHAnsi"==e},e.toWriteInline=function(e,t){return!sf.base.isNullOrUndefined(e.ownerBase)&&e.ownerBase instanceof ya?e.hasValue(t)?e[t]:e.getValue(t):e[t]},e.round=function(e,t){for(var i=e,r=0;r<t;r++)i*=10;i=Math.round(i);for(r=0;r<t;r++)i/=10;return i},e.removeInvalidXmlChars=function(e){return e.replace(/(?:[\0-\x08\x0F-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,"")},e.reverseString=function(e){if(!sf.base.isNullOrUndefined(e)&&""!==e){var t=e.split("");e=t.reverse().join("")}return e},e.formatClippedString=function(e){var t="",i="";return this.startsWith(e,"data:image/svg+xml;base64,")?(t=".svg",i=e.replace("data:image/svg+xml;base64,","")):this.startsWith(e,"data:image/svg+xml;utf8,")?(t=".svg",i=e.replace("data:image/svg+xml;utf8,","")):this.startsWith(e,"data:image/bmp;base64,")?(t=".bmp",i=e.replace("data:image/bmp;base64,","")):this.startsWith(e,"data:image/x-emf;base64,")?(t=".emf",i=e.replace("data:image/x-emf;base64,","")):this.startsWith(e,"data:image/exif;base64,")?(t=".exif",i=e.replace("data:image/exif;base64,","")):this.startsWith(e,"data:image/gif;base64,")?(t=".gif",i=e.replace("data:image/gif;base64,","")):this.startsWith(e,"data:image/icon;base64,")?(t=".ico",i=e.replace("data:image/icon;base64,","")):this.startsWith(e,"data:image/jpeg;base64,")?(t=".jpeg",i=e.replace("data:image/jpeg;base64,","")):this.startsWith(e,"data:image/jpg;base64,")?(t=".jpg",i=e.replace("data:image/jpg;base64,","")):this.startsWith(e,"data:image/png;base64,")?(t=".png",i=e.replace("data:image/png;base64,","")):this.startsWith(e,"data:image/tiff;base64,")?(t=".tif",i=e.replace("data:image/tiff;base64,","")):this.startsWith(e,"data:image/x-wmf;base64,")?(t=".wmf",i=e.replace("data:image/x-wmf;base64,","")):t=".jpeg",{extension:t,formatClippedString:i}},e.startsWith=function(e,t){return t.length>0&&e.substring(0,t.length)===t},e.formatText=function(e,t){var i=t;switch(e.toLowerCase()){case"uppercase":i=t.toUpperCase();break;case"lowercase":i=t.toLowerCase();break;case"firstlower":i=this.lowerFirstChar(t);break;case"firstcapital":i=this.capitaliseFirst(t,"FirstCapital");break;case"titlecase":i=this.capitaliseFirst(t,"Titlecase")}return i},e.formatNumber=function(e,t){var i=new sf.base.Internationalization,r=t.split(".");t=r[0];var n=i.parseNumber(t);if("NaN"===t.toString())return"";""===e&&(e="0");var o={format:e};return i.formatNumber(n,o)},e.formatDate=function(e,t){var i=new sf.base.Internationalization,r=new Date(t);if(isNaN(r.getDate()))return"";if(""===e)return t;-1!==e.indexOf("am/pm")&&(e=e.replace(/am\/pm/gi,"a"));var n={format:e};return i.formatDate(r,n)},e.capitaliseFirst=function(e,t,i){var r="";if("Titlecase"===t){for(var n=i?e.split(i):e.split(" "),o=0;o<n.length;o++)r+=i?n[parseInt(o.toString(),10)].charAt(0).toUpperCase()+n[parseInt(o.toString(),10)].slice(1,n[parseInt(o.toString(),10)].length):this.capitaliseFirstInternal(n[parseInt(o.toString(),10)]),n.length>=0&&!i&&(r+=" ");i||(r=this.capitaliseFirst(r,"Titlecase","\r"))}else"FirstCapital"===t&&(r=this.capitaliseFirstInternal(e));return r},e.lowerFirstChar=function(e){return e.charAt(0).toLowerCase()+e.slice(1,e.length)},e.capitaliseFirstInternal=function(e){return e.charAt(0).toUpperCase()+e.slice(1,e.length).toLowerCase()},e.getModifiedDate=function(t){var i=e.getLocaleDate(t);return i.toLocaleDateString([],{year:"numeric",month:"long",day:"numeric"})+" "+i.toLocaleTimeString([],{hour:"numeric",minute:"numeric"})},e.getUtcDate=function(){var e=new Date;return new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString()},e.getLocaleDate=function(e){var t=new Date(e);return new Date(t.getTime()+6e4*t.getTimezoneOffset())},e.getCompatibilityModeValue=function(e){var t;switch(e){case 1:t="11";break;case 2:t="12";break;case 3:t="14";break;default:t="15"}return t},e.splitSpaceInTextElementBox=function(t,i){var r=t.text,n="";if(i)for(;e.startsWith(r," ");)n+=" ",r=r.substring(1);else for(;e.endsWith(r);)n+=" ",r=r.slice(0,-1);if(""!=n){var o=new Fa;if(o.characterFormat.copyFormat(t.characterFormat),t.revisions.length>0){for(var s=0;s<t.revisions.length;s++){var a=t.revisions[s];o.revisions.push(a);var l=a.range.indexOf(t);l<0?a.range.push(o):a.range.splice(l+1,0,o)}o.isMarkedForRevision=t.isMarkedForRevision}o.line=t.line;var d=o.line.children;i?(t.text=n,o.text=r):(t.text=r,o.text=n),d.splice(d.indexOf(t)+1,0,o)}},e.getTextIndexAfterWhitespace=function(e,t){var i=e.length,r=e.indexOf(" ",t)+1;if(0===r||r===i)return r;for(;" "===e[r]&&++r!==i;);return r},e.splitWordByMaxLength=function(t,i,r){for(var n=t.text,o=0,s=n.length,a="",l=t.characterFormat,d=t.revisions,h=i.children.indexOf(t);o<s;){var c=o+90;c>s&&(c=s);var p=e.getTextIndexAfterWhitespace(n,c);if((0===p||p>s)&&(p=c),a=n.substring(o,p),0===o)t.text=a;else{var g=new Fa;if(g.text=a,g.line=i,g.characterFormat.copyFormat(l),d.length>0)for(var f=0;f<d.length;f++){var u=d[f];g.revisions.push(u);var m=u.range.indexOf(t);r||m<0?u.range.push(g):u.range.splice(m+1,0,g)}r?i.children.push(g):(i.children.splice(h+1,0,g),h++)}o=p}},e.wordBefore="\\b",e.wordAfter="\\b",e.wordSplitCharacters=[" ",",",".",":",";","<",">","=","+","-","_","{","}","[","]","`","~","!","@","#","$","%","^","&","*","(",")",'"',"?","/","|","\\","”","　","،","؟","؛","’","‘"],e}(),I=function(){function e(e,t){this.xIn=0,this.yIn=0,this.xIn=e,this.yIn=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this.xIn},set:function(e){this.xIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.yIn},set:function(e){this.yIn=e},enumerable:!0,configurable:!0}),e.prototype.copy=function(e){this.xIn=e.xIn,this.yIn=e.yIn},e.prototype.destroy=function(){this.xIn=void 0,this.yIn=void 0},e}(),F=function(){function e(){this.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}return e.prototype.encodeString=function(e){var t,i,r,n,o,s,a,l="",d=0;for(e=this.unicodeEncode(e);d<e.length;)n=(t=e.charCodeAt(d++))>>2,o=(3&t)<<4|(i=e.charCodeAt(d++))>>4,s=(15&i)<<2|(r=e.charCodeAt(d++))>>6,a=63&r,isNaN(i)?s=a=64:isNaN(r)&&(a=64),l=l+this.keyStr.charAt(n)+this.keyStr.charAt(o)+this.keyStr.charAt(s)+this.keyStr.charAt(a);return l},e.prototype.unicodeEncode=function(e){for(var t=e.replace(/\r\n/g,"\n"),i="",r=0;r<t.length;r++){var n=t.charCodeAt(r);n<128?i+=String.fromCharCode(n):n>127&&n<2048?(i+=String.fromCharCode(n>>6|192),i+=String.fromCharCode(63&n|128)):(i+=String.fromCharCode(n>>12|224),i+=String.fromCharCode(n>>6&63|128),i+=String.fromCharCode(63&n|128))}return i},e.prototype.decodeString=function(e){var t,i,r,n,o,s,a=0,l=0,d=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===this.keyStr.charAt(64)&&d--,e.charAt(e.length-2)===this.keyStr.charAt(64)&&d--,d%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var h=new Uint8Array(0|d);a<e.length;)t=this.keyStr.indexOf(e.charAt(a++))<<2|(n=this.keyStr.indexOf(e.charAt(a++)))>>4,i=(15&n)<<4|(o=this.keyStr.indexOf(e.charAt(a++)))>>2,r=(3&o)<<6|(s=this.keyStr.indexOf(e.charAt(a++))),h[l++]=t,64!==o&&(h[l++]=i),64!==s&&(h[l++]=r);return h},e}(),C=function(){function e(e,t){this.x=0,this.width=0,this.x=e,this.width=t}return Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),e}(),W=function(){function e(){this.abstractListIdIn=-1,this.levels=[]}return Object.defineProperty(e.prototype,"abstractListId",{get:function(){return this.abstractListIdIn},set:function(e){this.abstractListIdIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.levels)){for(var e=0;e<this.levels.length;e++){var t=this.levels[parseInt(e.toString(),10)];t.destroy(),this.levels.splice(this.levels.indexOf(t),1),e--}this.levels=[]}this.levels=void 0},e.prototype.clone=function(){for(var t=new e,i=0;i<this.levels.length;i++)t.levels.push(this.levels[parseInt(i.toString(),10)].clone(t));return t},e}(),k=function(){function e(e){this.uniqueRowFormat=void 0,this.borders=new g(this),this.ownerBase=void 0,this.beforeWidth=0,this.afterWidth=0,this.revisions=[],this.removedIds=[],this.ownerBase=e}return Object.defineProperty(e.prototype,"gridBefore",{get:function(){return this.getPropertyValue("gridBefore")},set:function(e){this.setPropertyValue("gridBefore",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridBeforeWidth",{get:function(){return this.getPropertyValue("gridBeforeWidth")},set:function(e){this.setPropertyValue("gridBeforeWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridBeforeWidthType",{get:function(){return this.getPropertyValue("gridBeforeWidthType")},set:function(e){this.setPropertyValue("gridBeforeWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfter",{get:function(){return this.getPropertyValue("gridAfter")},set:function(e){this.setPropertyValue("gridAfter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfterWidth",{get:function(){return this.getPropertyValue("gridAfterWidth")},set:function(e){this.setPropertyValue("gridAfterWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfterWidthType",{get:function(){return this.getPropertyValue("gridAfterWidthType")},set:function(e){this.setPropertyValue("gridAfterWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowBreakAcrossPages",{get:function(){return this.getPropertyValue("allowBreakAcrossPages")},set:function(e){this.setPropertyValue("allowBreakAcrossPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHeader",{get:function(){return this.getPropertyValue("isHeader")},set:function(e){this.setPropertyValue("isHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.getPropertyValue("height")},set:function(e){0!==e||"AtLeast"!==this.heightType&&"Exactly"!==this.heightType?"Auto"===this.heightType&&(e=0):e=1,this.setPropertyValue("height",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightType",{get:function(){return this.getPropertyValue("heightType")},set:function(e){this.height="AtLeast"===e||"Exactly"===e?1:0,this.setPropertyValue("heightType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueRowFormat)&&this.uniqueRowFormat.propertiesHash.containsKey(i))return this.uniqueRowFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueRowFormat))this.initializeUniqueRowFormat(t,i);else{var r=l.getPropertyType(this.uniqueRowFormat.uniqueFormatType,t);if(this.uniqueRowFormat.propertiesHash.containsKey(r)&&this.uniqueRowFormat.propertiesHash.get(r)===i)return;this.uniqueRowFormat=e.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat,t,i)}},e.prototype.initializeUniqueRowFormat=function(t,i){var r=new a;this.addUniqueRowFormat("allowBreakAcrossPages",t,i,r),this.addUniqueRowFormat("isHeader",t,i,r),this.addUniqueRowFormat("height",t,i,r),this.addUniqueRowFormat("heightType",t,i,r),this.addUniqueRowFormat("gridBefore",t,i,r),this.addUniqueRowFormat("gridBeforeWidth",t,i,r),this.addUniqueRowFormat("gridBeforeWidthType",t,i,r),this.addUniqueRowFormat("gridAfter",t,i,r),this.addUniqueRowFormat("gridAfterWidth",t,i,r),this.addUniqueRowFormat("gridgridAfterWidth",t,i,r),this.addUniqueRowFormat("gridBeforeWidthType",t,i,r),this.addUniqueRowFormat("leftMargin",t,i,r),this.addUniqueRowFormat("rightMargin",t,i,r),this.addUniqueRowFormat("topMargin",t,i,r),this.addUniqueRowFormat("bottomMargin",t,i,r),this.addUniqueRowFormat("leftIndent",t,i,r),this.uniqueRowFormat=e.uniqueRowFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueRowFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowBreakAcrossPages":t=!0;break;case"isHeader":t=!1;break;case"height":t=0;break;case"heightType":t="Auto";break;case"gridBefore":case"gridBeforeWidth":t=0;break;case"gridBeforeWidthType":t="Point";break;case"gridAfter":case"gridAfterWidth":t=0;break;case"gridAfterWidthType":t="Point";break;case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"leftIndent":t=0}return t},e.prototype.containsMargins=function(){return!(sf.base.isNullOrUndefined(this.leftMargin)&&sf.base.isNullOrUndefined(this.rightMargin)&&sf.base.isNullOrUndefined(this.bottomMargin)&&sf.base.isNullOrUndefined(this.topMargin))},e.prototype.cloneFormat=function(){var t=new e;return t.allowBreakAcrossPages=this.allowBreakAcrossPages,t.heightType=this.heightType,t.height=this.height,t.isHeader=this.isHeader,t.gridBefore=this.gridBefore,t.gridBeforeWidth=this.gridBeforeWidth,t.gridBeforeWidthType=this.gridBeforeWidthType,t.gridAfter=this.gridAfter,t.gridAfterWidth=this.gridAfterWidth,t.gridAfterWidthType=this.gridAfterWidthType,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.leftIndent=this.leftIndent,this.revisions.length>0?t.removedIds=N.cloneRevisions(this.revisions):t.removedIds=this.removedIds.slice(),t},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueRowFormat)){var t=l.getPropertyType(this.uniqueRowFormat.uniqueFormatType,e);return this.uniqueRowFormat.propertiesHash.containsKey(t)}return!1},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.uniqueRowFormat)||(this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader,this.heightType=e.heightType,this.height=e.height,this.gridBefore=e.gridBefore,this.gridBeforeWidth=e.gridBeforeWidth,this.gridBeforeWidthType=e.gridBeforeWidthType,this.gridAfter=e.gridAfter,this.gridAfterWidth=e.gridAfterWidth,this.gridAfterWidthType=e.gridAfterWidthType,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.revisions=e.revisions),sf.base.isNullOrUndefined(e.borders)||(this.borders=new g(this),this.borders.ownerBase=e,this.borders.copyFormat(e.borders)),e.revisions.length>0?this.removedIds=N.cloneRevisions(e.revisions):this.removedIds=e.removedIds.slice())},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.borders)||this.borders.destroy(),sf.base.isNullOrUndefined(this.uniqueRowFormat)||e.uniqueRowFormats.remove(this.uniqueRowFormat),this.beforeWidth=void 0,this.afterWidth=void 0,this.borders=void 0,this.uniqueRowFormat=void 0},e.clear=function(){this.uniqueRowFormats.clear()},e.uniqueRowFormats=new d,e.uniqueFormatType=6,e}(),S=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new i((function(t){t(e.value)})).then(s,a)}l((r=r.apply(e,t||[])).next())}))},P=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},N=function(){function e(e,t,i){this.author=null,this.date=null,this.range=[],this.revisionID="",this.isContentRemoved=!1,this.isTableRevision=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,this.author=t,sf.base.isNullOrUndefined(this.author)&&(this.author="Unknown"),this.date=i,this.owner=e}return e.prototype.handleAcceptReject=function(e){this.owner.selection.selectRevision(this);var t=this.owner.selection,i=t.start,r=t.end;t.start.isExistBefore(t.end)||(i=t.end,r=t.start);var n=t.getParagraphInfo(i);if(this.owner.editor.initHistory(e?"Accept Change":"Reject Change"),"Deletion"===this.revisionType?(n=t.getParagraphInfo(this.owner.selection.start),t.editPosition=this.owner.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())):t.editPosition=this.owner.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),this.owner.editor.updateInsertPosition(),this.isContentRemoved=!1,this.canSkipTableItems=!1,this.skipUnLinkElement=!1,"Insertion"===this.revisionType||"Deletion"===this.revisionType||"MoveFrom"===this.revisionType||"MoveTo"===this.revisionType){this.owner.isShiftingEnabled=!0;for(var o=0;this.range.length>0&&(this.range[o]instanceof ya||this.range[o]instanceof T||this.range[o]instanceof k);){if(this.range[o]instanceof Na&&e&&"Deletion"===this.revisionType){var s=this.range[o];this.owner.documentHelper.bookmarks.containsKey(s.name)&&this.owner.documentHelper.bookmarks.remove(s.name)}this.unlinkRangeItem(this.range[o],this,e,i,r)?o++:o=0}}if(this.isTableRevision=!1,this.isContentRemoved){var a=t.getTextPosBasedOnLogicalIndex(t.editPosition);this.owner.selection.selectContent(a,!0),this.owner.editor.updateEndPosition()}else t.selectRange(i,r),this.owner.editor.updateHistoryPosition(r,!1);if(this.owner.editorHistory&&this.owner.editorHistory.currentBaseHistoryInfo&&"BackSpace"!==this.owner.editorHistory.currentBaseHistoryInfo.action&&this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.reverse(),this.owner.editorHistory){this.owner.trackChangesPane.isTrackingPageBreak&&(this.owner.editorHistory.currentBaseHistoryInfo.action="TrackingPageBreak");var l=this.owner.editorHistory;!l.currentHistoryInfo||"Accept All"!==l.currentHistoryInfo.action&&"Reject All"!==l.currentHistoryInfo.action||this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),l.updateHistory()}this.owner.editor.reLayout(this.owner.selection),n.paragraph.isInHeaderFooter&&this.owner.editor.updateHeaderFooterWidget()},e.prototype.handleGroupAcceptReject=function(e){if(this.owner.trackChangesPane.tableRevisions.containsKey(this)){this.owner.editor.initComplexHistory(e?"Accept All":"Reject All");for(var t=this.owner.trackChangesPane.tableRevisions.get(this),i=0;i<t.length;i++)e?t[i].handleAcceptReject(!0):t[i].handleAcceptReject(!1);if(this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory(),this.owner.selectionModule.start.paragraph.isInsideTable){var r=this.owner.selectionModule.start.paragraph.containerWidget.ownerTable;this.owner.documentHelper.layout.reLayoutTable(r)}}},e.prototype.accept=function(){return S(this,void 0,void 0,(function(){var e;return P(this,(function(t){switch(t.label){case 0:return e={author:this.author,cancel:!1,revisionType:this.revisionType,actionType:"Accept"},[4,this.owner.fireBeforeAcceptReject(e)];case 1:return t.sent().cancel||(this.owner.documentHelper.isTrackedOnlyMode||(!this.owner.revisions.skipGroupAcceptReject&&this.range[0]instanceof k&&this.owner.trackChangesPane.tableRevisions.containsKey(this)?this.handleGroupAcceptReject(!0):this.handleAcceptReject(!0))),[2]}}))}))},e.prototype.reject=function(){return S(this,void 0,void 0,(function(){var e;return P(this,(function(t){switch(t.label){case 0:return e={author:this.author,cancel:!1,revisionType:this.revisionType,actionType:"Reject"},[4,this.owner.fireBeforeAcceptReject(e)];case 1:return t.sent().cancel||(this.owner.documentHelper.isTrackedOnlyMode||(!this.owner.revisions.skipGroupAcceptReject&&this.range[0]instanceof k&&this.owner.trackChangesPane.tableRevisions.containsKey(this)?this.handleGroupAcceptReject(!1):this.handleAcceptReject(!1))),[2]}}))}))},e.prototype.unlinkRangeItem=function(e,t,i,r,n){if(this.isTableRevision)return this.removeRangeRevisionForItem(e),0===t.range.length&&this.owner.revisions.remove(t),!1;var o=!sf.base.isNullOrUndefined(i)&&("MoveFrom"===t.revisionType||"Deletion"===t.revisionType)&&i||("Insertion"===t.revisionType||"MoveTo"===t.revisionType)&&!i;if(this.owner.selection.isTOC()){if(o)this.owner.editor.deleteSelectedContents(this.owner.selection,!0),0===t.range.length&&this.owner.revisions.remove(t),this.isContentRemoved=!0,this.owner.editorHistory.currentBaseHistoryInfo.action="BackSpace";else{for(;this.range.length>0;){var s=this.range[0];this.removeRangeRevisionForItem(s),0===t.range.length&&this.owner.revisions.remove(t)}this.owner.editor.addRemovedNodes(this.revisionID),this.owner.editorHistory.currentBaseHistoryInfo.action="AcceptTOC"}return!1}if(e instanceof ya&&!this.canSkipTableItems)if(o){if(this.skipeElementRemoval(e))return this.skipUnLinkElement=!0,!0;this.owner.editor.addRemovedNodes(e.clone())}else{var a=this.owner.selectionModule.getHyperlinkField();if(i||sf.base.isNullOrUndefined(a)||a!=e||sf.base.isNullOrUndefined(a.fieldEnd))this.owner.editorHistoryModule.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID(),this.removeRevisionFromPara(r,n);else{if(this.owner.editorModule.initComplexHistory("ClearRevisions"),this.owner.editorHistoryModule.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID(),this.removeRevisionFromPara(r,n),!sf.base.isNullOrUndefined(this.owner.editorHistoryModule)){var l=this.owner.selectionModule.getParagraphInfo(n),d=this.owner.selectionModule.getHierarchicalIndex(l.paragraph,l.offset.toString());this.owner.editorHistoryModule.currentBaseHistoryInfo.endPosition=d,this.owner.editorHistoryModule.currentBaseHistoryInfo.selectionEnd=d,this.owner.editorHistoryModule.updateHistory()}this.owner.enableTrackChanges?(this.owner.enableTrackChanges=!1,this.owner.editorModule.updateHyperlinkFormat(this.owner.selectionModule),this.owner.enableTrackChanges=!0):this.owner.editorModule.updateHyperlinkFormat(this.owner.selectionModule),this.owner.editorHistoryModule&&!sf.base.isNullOrUndefined(this.owner.editorHistoryModule.currentHistoryInfo)&&this.owner.editorHistoryModule.updateComplexHistory()}this.owner.trackChangesPane.isTrackingPageBreak=!1}else if(!this.canSkipTableItems&&e instanceof T&&!o)this.owner.editorHistory.currentBaseHistoryInfo.action="ClearRevisions",this.updateRevisionID(),this.removeRevisionFromPara(r,n);else if(e instanceof k&&!o){this.isTableRevision=!0;var h=e.ownerBase.ownerTable,c=e.ownerBase;this.owner.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack",this.owner.editor.cloneTableToHistoryInfo(h.combineWidget(this.owner.viewer))}if(o=o&&!this.canSkipTableItems,e instanceof ya&&o){var p=e.line.paragraph;if(this.removeRevisionItemsFromRange(e),e instanceof Wa&&"Footnote"===e.footnoteType&&this.owner.editor.removeFootnote(e),this.removeItem(e),this.isContentRemoved=!0,this.owner.documentHelper.layout.reLayoutParagraph(p,0,0),sf.base.isNullOrUndefined(p.childWidgets)){var g=this.owner.selection.getTextPosBasedOnLogicalIndex(this.owner.selection.editPosition);this.owner.selection.selectContent(g,!0)}}else if(e instanceof T&&o){if(this.isContentRemoved=!0,this.skipUnLinkElement=!1,this.removeRevisionItemsFromRange(e),1===t.range.length)this.owner.editor.deleteSelectedContents(this.owner.selection,!0);else{this.owner.editor.deleteSelectedContents(this.owner.selection,!0),this.removeRevisionFromPara(r,n);var f=t.range.indexOf(e);for(t.range.splice(f,1),this.owner.trackChangesPane.updateCurrentTrackChanges(t);this.range.length>0;)this.removeRangeRevisionForItem(this.range[0])}this.owner.editorHistory.currentBaseHistoryInfo.action="BackSpace",this.owner.editorHistoryModule.currentBaseHistoryInfo.isAcceptOrReject=i?"Accept":"Reject"}else if(e instanceof k&&o){h=(h=e.ownerBase.ownerTable).combineWidget(this.owner.viewer);c=e.ownerBase;this.removeRevisionItemsFromRange(e),this.owner.editorHistory.currentBaseHistoryInfo.action="DeleteCells",this.owner.editor.cloneTableToHistoryInfo(h),this.owner.editor.removeDeletedCellRevision(c),this.isContentRemoved=!0,h.removeChild(h.childWidgets.indexOf(c)),this.canSkipTableItems=!0,this.owner.editor.removeFieldInBlock(c),this.owner.editor.removeFieldInBlock(c,!0),this.owner.editor.removeFieldInBlock(c,void 0,!0),c.destroy(),0===h.childWidgets.length?(this.owner.selection.editPosition=this.owner.selection.getHierarchicalIndex(h,"0"),this.owner.editor.removeBlock(h),h.destroy()):this.owner.editor.updateTable(h,!0)}return e instanceof k&&o||this.skipUnLinkElement||this.removeRangeRevisionForItem(e),0===t.range.length&&this.owner.revisions.remove(t),!1},e.prototype.removeRevisionFromPara=function(e,t){for(var i=this.owner.selection.getParagraphInfo(e),r=this.owner.selection.getParagraphInfo(t),n=i.paragraph;n instanceof ca;){if(n.characterFormat.revisions.length>0)for(var o=0;o<n.characterFormat.revisions.length;o++)if(0===n.characterFormat.revisions[o].range.length){var s=n.characterFormat.revisions.indexOf(n.characterFormat.revisions[o]);n.characterFormat.revisions.splice(s,1),o--}n=r.paragraph===n?void 0:n.nextWidget}},e.prototype.updateRevisionID=function(){for(this.owner.editor.addRemovedNodes(this.revisionID);this.range.length>0;)this.removeRangeRevisionForItem(this.range[0])},e.prototype.removeRevisionItemsFromRange=function(e){if(e.revisions.length>0)for(var t=0;t<e.revisions.length;t++){var i=e.revisions[t];if(this.revisionID!==i.revisionID){var r=i.range.indexOf(e);e.revisions[t].range.splice(r,1),this.owner.trackChangesPane.updateCurrentTrackChanges(e.revisions[t])}0===i.range.length&&this.owner.revisions.remove(i)}},e.prototype.removeRangeRevisionForItem=function(e){var t=e.revisions.indexOf(this);if(t>=0){e.revisions.splice(t,1);var i=this.range.indexOf(e);this.range.splice(i,1),this.owner.trackChangesPane.updateCurrentTrackChanges(this)}},e.prototype.skipeElementRemoval=function(e){var t=e.paragraph;if(t.characterFormat.revisions.length>0)for(var i=0;i<t.characterFormat.revisions.length;i++){if(t.characterFormat.revisions[i].range.indexOf(e)>=0)return!0}return!1},e.prototype.removeRevisionFromRow=function(e){this.owner.editor.unlinkRangeFromRevision(e.rowFormat);for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];this.owner.editor.removeRevisionForCell(i,!1)}},e.prototype.removeItem=function(e){var t=e.line.paragraph;this.owner.editor.unLinkFieldCharacter(e);var i=e.line.children.indexOf(e);e.line.children.splice(i,1);var r=e.line.paragraph.floatingElements.indexOf(e);e.line.paragraph.floatingElements.splice(r,1);var n=e.line.paragraph.bodyWidget.floatingElements.indexOf(e);n>-1&&e.line.paragraph.bodyWidget.floatingElements.splice(n,1),this.owner.editor.removeEmptyLine(t)},e.prototype.canSkipCloning=function(){if(!sf.base.isNullOrUndefined(this.owner)&&this.owner.editorHistory&&this.owner.editorHistory.currentBaseHistoryInfo&&"DeleteCells"===this.owner.editorHistory.currentBaseHistoryInfo.action)return!0;return!1},e.prototype.clone=function(){if(this.canSkipCloning())return this;var t=new e(void 0,this.author,this.date);return t.revisionID=this.revisionID,t.revisionType=this.revisionType,t},e.cloneRevisions=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].revisionID);return t},e}(),O=function(){function e(e){this.changes=[],this.skipGroupAcceptReject=!1,this.owner=e}return e.prototype.get=function(e){if(e>=this.changes.length||e<0)throw new ReferenceError("Provided index is not within the range");return this.changes[e]},Object.defineProperty(e.prototype,"length",{get:function(){return this.changes.length},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){if(!(sf.base.isNullOrUndefined(e)||this.changes.indexOf(e)<0)&&(this.changes.splice(this.changes.indexOf(e),1),-1!==this.owner.trackChangesPane.revisions.indexOf(e))){var t=this.owner.trackChangesPane.revisions.indexOf(e);if(!(this.owner.trackChangesPane.tableRevisions.containsKey(e)&&this.owner.trackChangesPane.tableRevisions.get(e)[this.owner.trackChangesPane.tableRevisions.get(e).length-1]!==e)&&!sf.base.isNullOrUndefined(this.owner.trackChangesPane.changesInfoDiv)&&!sf.base.isNullOrUndefined(this.owner.trackChangesPane.changes)){var i=this.owner.trackChangesPane.changes.get(e);this.owner.trackChangesPane.changesInfoDiv.removeChild(i.outerSingleDiv),this.owner.trackChangesPane.changes.remove(e)}this.owner.trackChangesPane.revisions.splice(t,1),this.owner.trackChangesPane.renderedChanges.containsKey(e)&&this.owner.trackChangesPane.renderedChanges.remove(e),this.owner.trackChangesPane.tableRevisions.containsKey(e)&&this.owner.trackChangesPane.tableRevisions.remove(e)}},e.prototype.acceptAll=function(){this.owner.isReadOnly||this.handleRevisionCollection(!0)},e.prototype.rejectAll=function(){this.owner.isReadOnly||this.handleRevisionCollection(!1)},e.prototype.handleRevisionCollection=function(e,t){return S(this,void 0,void 0,(function(){var i,r,n,o,s;return P(this,(function(a){switch(a.label){case 0:if(this.skipGroupAcceptReject=!0,i=this.owner.selection,r=i.start,n=i.end,(o=t||this.changes).length<=0)return[2];i.start.isExistBefore(i.end)||(r=i.end,n=i.start),r=r.clone(),n=n.clone(),e?this.owner.editor.initComplexHistory("Accept All"):this.owner.editor.initComplexHistory("Reject All"),a.label=1;case 1:return o.length>0?e?[4,o[0].accept()]:[3,3]:[3,6];case 2:return a.sent(),[3,5];case 3:return[4,o[0].reject()];case 4:a.sent(),a.label=5;case 5:return t&&o.splice(0,1),this.owner.enableHeaderAndFooter&&this.owner.editor.updateHeaderFooterWidget(),[3,1];case 6:return sf.base.isNullOrUndefined(i.editPosition)||(s=i.getTextPosBasedOnLogicalIndex(i.editPosition),this.owner.selection.selectContent(s,!0)),this.owner.editorHistory&&(this.owner.editorHistory.updateComplexHistory(),sf.base.isNullOrUndefined(i.editPosition)&&this.owner.editorHistory.undoStack.pop()),this.owner.editor.reLayout(this.owner.selection,!1),this.skipGroupAcceptReject=!1,[2]}}))}))},e.prototype.destroy=function(){this.changes=[]},e}(),T=function(){function e(e){this.uniqueCharacterFormat=void 0,this.ownerBase=void 0,this.baseCharStyle=void 0,this.removedIds=[],this.revisions=[],this.ownerBase=e}return Object.defineProperty(e.prototype,"bold",{get:function(){return this.getPropertyValue("bold")},set:function(e){this.setPropertyValue("bold",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this.getPropertyValue("italic")},set:function(e){this.setPropertyValue("italic",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.getPropertyValue("fontSize")},set:function(e){this.setPropertyValue("fontSize",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"characterSpacing",{get:function(){return this.getPropertyValue("characterSpacing")},set:function(e){this.setPropertyValue("characterSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaling",{get:function(){return this.getPropertyValue("scaling")},set:function(e){this.setPropertyValue("scaling",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.getPropertyValue("fontFamily")},set:function(e){this.setPropertyValue("fontFamily",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this.getPropertyValue("underline")},set:function(e){this.setPropertyValue("underline",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikethrough",{get:function(){return this.getPropertyValue("strikethrough")},set:function(e){this.setPropertyValue("strikethrough",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineAlignment",{get:function(){return this.getPropertyValue("baselineAlignment")},set:function(e){this.setPropertyValue("baselineAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this.getPropertyValue("highlightColor")},set:function(e){this.setPropertyValue("highlightColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.getPropertyValue("fontColor")},set:function(e){this.setPropertyValue("fontColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeIdBidi",{get:function(){return this.getPropertyValue("localeIdBidi")},set:function(e){this.setPropertyValue("localeIdBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeIdFarEast",{get:function(){return this.getPropertyValue("localeIdFarEast")},set:function(e){this.setPropertyValue("localeIdFarEast",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localeIdAscii",{get:function(){return this.getPropertyValue("localeIdAscii")},set:function(e){this.setPropertyValue("localeIdAscii",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bdo",{get:function(){return this.getPropertyValue("bdo")},set:function(e){this.setPropertyValue("bdo",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"boldBidi",{get:function(){return this.getPropertyValue("boldBidi")},set:function(e){this.setPropertyValue("boldBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italicBidi",{get:function(){return this.getPropertyValue("italicBidi")},set:function(e){this.setPropertyValue("italicBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSizeBidi",{get:function(){return this.getPropertyValue("fontSizeBidi")},set:function(e){this.setPropertyValue("fontSizeBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyBidi",{get:function(){return this.getPropertyValue("fontFamilyBidi")},set:function(e){this.setPropertyValue("fontFamilyBidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allCaps",{get:function(){return this.getPropertyValue("allCaps")},set:function(e){this.setPropertyValue("allCaps",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"complexScript",{get:function(){return this.getPropertyValue("complexScript")},set:function(e){this.setPropertyValue("complexScript",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyFarEast",{get:function(){return this.getPropertyValue("fontFamilyFarEast")},set:function(e){this.setPropertyValue("fontFamilyFarEast",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyAscii",{get:function(){return this.getPropertyValue("fontFamilyAscii")},set:function(e){this.setPropertyValue("fontFamilyAscii",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamilyNonFarEast",{get:function(){return this.getPropertyValue("fontFamilyNonFarEast")},set:function(e){this.setPropertyValue("fontFamilyNonFarEast",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueCharacterFormat)&&this.uniqueCharacterFormat.propertiesHash.containsKey(i))return this.uniqueCharacterFormat.propertiesHash.get(i)}else{var r=this.checkCharacterStyle(t);if(!sf.base.isNullOrUndefined(r))return r;if(!sf.base.isNullOrUndefined(this.baseCharStyle)){var n=this.ownerBase.paragraph,o=this.ownerBase.line;if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(o))for(var s=o.children.length,a=0;a<s;a++){var d=this.ownerBase.line.children[a];if(d instanceof Fa){var h=d.text;if(h.startsWith("HYPERLINK"))-1!==h.indexOf("_Toc")&&(this.baseCharStyle=this.ownerBase.paragraph.paragraphFormat.baseStyle)}}}var c=this.checkBaseStyle(t);if(!sf.base.isNullOrUndefined(c))return c}return this.getDefaultValue(t)},e.prototype.getDefaultValue=function(t){var i=l.getPropertyType(e.uniqueFormatType,t),r=this.documentCharacterFormat();return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.uniqueCharacterFormat)||!r.uniqueCharacterFormat.propertiesHash.containsKey(i)?e.getPropertyDefaultValue(t):r.uniqueCharacterFormat.propertiesHash.get(i)},e.prototype.documentCharacterFormat=function(){var e;return sf.base.isNullOrUndefined(this.ownerBase)||(sf.base.isNullOrUndefined(this.ownerBase.paragraph)||sf.base.isNullOrUndefined(this.ownerBase.paragraph.bodyWidget)||sf.base.isNullOrUndefined(this.ownerBase.paragraph.bodyWidget.page)?sf.base.isNullOrUndefined(this.ownerBase.bodyWidget)||(e=this.ownerBase.bodyWidget.page.documentHelper.characterFormat):e=this.ownerBase.paragraph.bodyWidget.page.documentHelper.characterFormat),e},e.prototype.checkBaseStyle=function(t){var i;for(sf.base.isNullOrUndefined(this.ownerBase)||(sf.base.isNullOrUndefined(this.ownerBase.paragraph)?this.ownerBase instanceof ca&&!sf.base.isNullOrUndefined(this.ownerBase.paragraphFormat)?i=this.ownerBase.paragraphFormat.baseStyle:sf.base.isNullOrUndefined(this.ownerBase instanceof vl)||(i=this.ownerBase.basedOn):i=this.ownerBase.paragraph.paragraphFormat.baseStyle);!sf.base.isNullOrUndefined(i)&&!i.characterFormat.hasValue(t);)i=i.basedOn;if(!sf.base.isNullOrUndefined(i)){var r=l.getPropertyType(e.uniqueFormatType,t);return i.characterFormat.uniqueCharacterFormat.propertiesHash.get(r)}},e.prototype.checkCharacterStyle=function(t){var i=this.baseCharStyle;if(!sf.base.isNullOrUndefined(i))for(;!sf.base.isNullOrUndefined(i)&&"Default Paragraph Font"!==i.name;){if(i.characterFormat.hasValue(t)){var r=l.getPropertyType(e.uniqueFormatType,t);return i.characterFormat.uniqueCharacterFormat.propertiesHash.get(r)}i=i.basedOn}},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueCharacterFormat))this.initializeUniqueCharacterFormat(t,i);else{var r=l.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,t);if(this.uniqueCharacterFormat.propertiesHash.containsKey(r)&&this.uniqueCharacterFormat.propertiesHash.get(r)===i)return;this.uniqueCharacterFormat=e.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat,t,i)}},e.prototype.initializeUniqueCharacterFormat=function(t,i){var r=new a;this.addUniqueCharacterFormat("fontColor",t,i,r),this.addUniqueCharacterFormat("fontFamily",t,i,r),this.addUniqueCharacterFormat("fontSize",t,i,r),this.addUniqueCharacterFormat("bold",t,i,r),this.addUniqueCharacterFormat("italic",t,i,r),this.addUniqueCharacterFormat("underline",t,i,r),this.addUniqueCharacterFormat("strikethrough",t,i,r),this.addUniqueCharacterFormat("baselineAlignment",t,i,r),this.addUniqueCharacterFormat("highlightColor",t,i,r),this.addUniqueCharacterFormat("styleName",t,i,r),this.addUniqueCharacterFormat("bidi",t,i,r),this.addUniqueCharacterFormat("bdo",t,i,r),this.addUniqueCharacterFormat("fontFamilyBidi",t,i,r),this.addUniqueCharacterFormat("fontSizeBidi",t,i,r),this.addUniqueCharacterFormat("boldBidi",t,i,r),this.addUniqueCharacterFormat("italicBidi",t,i,r),this.addUniqueCharacterFormat("allCaps",t,i,r),this.addUniqueCharacterFormat("localeIdAscii",t,i,r),this.addUniqueCharacterFormat("localeIdFarEast",t,i,r),this.addUniqueCharacterFormat("localeIdBidi",t,i,r),this.addUniqueCharacterFormat("fontFamilyFarEast",t,i,r),this.addUniqueCharacterFormat("fontFamilyAscii",t,i,r),this.addUniqueCharacterFormat("fontFamilyNonFarEast",t,i,r),this.addUniqueCharacterFormat("complexScript",t,i,r),this.addUniqueCharacterFormat("characterSpacing",t,i,r),this.addUniqueCharacterFormat("scaling",t,i,r),this.uniqueCharacterFormat=e.uniqueCharacterFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueCharacterFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"bold":case"italic":t=!1;break;case"fontSize":t=11;break;case"underline":case"strikethrough":t="None";break;case"baselineAlignment":t="Normal";break;case"highlightColor":t="NoColor";break;case"fontColor":t="#00000000";break;case"fontFamily":t="Calibri";break;case"styleName":t="Default Paragraph Font";break;case"bidi":t=!1;break;case"bdo":t="None";break;case"boldBidi":case"italicBidi":t=!1;break;case"fontSizeBidi":t=11;break;case"fontFamilyBidi":t="Calibri";break;case"allCaps":t=!1;break;case"localeIdAscii":case"localeIdFarEast":case"localeIdBidi":t=0;break;case"complexScript":t=!1;break;case"fontFamilyFarEast":case"fontFamilyAscii":case"fontFamilyNonFarEast":t=void 0;break;case"characterSpacing":t=0;break;case"scaling":t=100}return t},e.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.fontFamily===e.fontFamily&&this.bold===e.bold&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.underline===e.underline&&this.fontColor===e.fontColor&&this.strikethrough===e.strikethrough&&this.highlightColor===e.highlightColor&&this.bidi===e.bidi&&this.bdo===e.bdo&&this.allCaps===e.allCaps&&this.localeIdBidi===e.localeIdBidi&&this.localeIdAscii===e.localeIdAscii&&this.localeIdFarEast===e.localeIdFarEast&&this.complexScript===e.complexScript&&this.fontFamilyAscii===e.fontFamilyAscii&&this.fontFamilyBidi===e.fontFamilyBidi&&this.fontFamilyFarEast===e.fontFamilyFarEast&&this.characterSpacing===e.characterSpacing&&this.scaling===e.scaling&&this.fontFamilyNonFarEast===e.fontFamilyNonFarEast},e.prototype.isSameFormat=function(e){return this.baseCharStyle===e.baseCharStyle&&this.uniqueCharacterFormat===e.uniqueCharacterFormat},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.uniqueCharacterFormat=this.uniqueCharacterFormat,t.baseCharStyle=this.baseCharStyle,this.revisions.length>0?t.removedIds=N.cloneRevisions(this.revisions):t.removedIds=this.removedIds.slice(),t},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueCharacterFormat)&&!sf.base.isNullOrUndefined(this.uniqueCharacterFormat.propertiesHash)){var t=l.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,e);return this.uniqueCharacterFormat.propertiesHash.containsKey(t)}return!1},e.prototype.clearFormat=function(){sf.base.isNullOrUndefined(this.uniqueCharacterFormat)||0!==this.uniqueCharacterFormat.referenceCount||e.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0,this.baseCharStyle=void 0},e.prototype.destroy=function(){this.clearFormat()},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(!sf.base.isNullOrUndefined(e.uniqueCharacterFormat)&&e.uniqueCharacterFormat.propertiesHash&&this.updateUniqueCharacterFormat(e),sf.base.isNullOrUndefined(e.baseCharStyle)||(this.baseCharStyle=e.baseCharStyle),e.revisions.length>0?this.removedIds=N.cloneRevisions(e.revisions):this.removedIds=e.removedIds.slice())},e.prototype.isEqualTocFormat=function(e){return this.fontFamily===e.fontFamily&&this.bold===e.bold&&this.italic===e.italic&&this.strikethrough===e.strikethrough&&this.highlightColor===e.highlightColor&&this.fontFamilyAscii===e.fontFamilyAscii&&this.fontFamilyFarEast===e.fontFamilyFarEast&&this.fontFamilyNonFarEast===e.fontFamilyNonFarEast},e.prototype.copyTocFormat=function(e){sf.base.isNullOrUndefined(e.bold)||(this.bold=e.bold),sf.base.isNullOrUndefined(e.italic)||(this.italic=e.italic),sf.base.isNullOrUndefined(e.strikethrough)||(this.strikethrough=e.strikethrough),sf.base.isNullOrUndefined(e.highlightColor)||(this.highlightColor=e.highlightColor),sf.base.isNullOrUndefined(e.fontFamily)||(this.fontFamily=e.fontFamily,this.fontFamilyAscii=e.fontFamily,this.fontFamilyFarEast=e.fontFamily,this.fontFamilyNonFarEast=e.fontFamily)},e.prototype.updateUniqueCharacterFormat=function(t){var i=void 0;this.uniqueCharacterFormat&&(i=this.uniqueCharacterFormat.mergeProperties(t.uniqueCharacterFormat),0===this.uniqueCharacterFormat.referenceCount&&(e.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0)),this.uniqueCharacterFormat=new l(e.uniqueFormatType),sf.base.isNullOrUndefined(i)&&(i=this.uniqueCharacterFormat.mergeProperties(t.uniqueCharacterFormat)),this.uniqueCharacterFormat=e.uniqueCharacterFormats.addUniqueFormat(i,e.uniqueFormatType)},e.clear=function(){this.uniqueCharacterFormats.clear()},e.prototype.applyStyle=function(e){this.baseCharStyle=e},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e){sf.base.isNullOrUndefined(this.getValue("bold"))&&(this.bold=e.getValue("bold")),sf.base.isNullOrUndefined(this.getValue("italic"))&&(this.italic=e.getValue("italic")),sf.base.isNullOrUndefined(this.getValue("fontSize"))&&(this.fontSize=e.getValue("fontSize")),sf.base.isNullOrUndefined(this.getValue("characterSpacing"))&&(this.characterSpacing=e.getValue("characterSpacing")),sf.base.isNullOrUndefined(this.getValue("scaling"))&&(this.scaling=e.getValue("scaling")),sf.base.isNullOrUndefined(this.getValue("fontFamily"))?this.fontFamily=e.getValue("fontFamily"):(sf.base.isNullOrUndefined(this.getValue("fontFamilyAscii"))&&(this.fontFamilyAscii=e.getValue("fontFamily")),sf.base.isNullOrUndefined(this.getValue("fontFamilyFarEast"))&&(this.fontFamilyFarEast=e.getValue("fontFamily")),sf.base.isNullOrUndefined(this.getValue("fontFamilyNonFarEast"))&&(this.fontFamilyNonFarEast=e.getValue("fontFamily"))),sf.base.isNullOrUndefined(this.getValue("underline"))&&(this.underline=e.getValue("underline")),sf.base.isNullOrUndefined(this.getValue("strikethrough"))&&(this.strikethrough=e.getValue("strikethrough")),sf.base.isNullOrUndefined(this.getValue("baselineAlignment"))&&(this.baselineAlignment=e.getValue("baselineAlignment")),sf.base.isNullOrUndefined(this.getValue("highlightColor"))&&(this.highlightColor=e.getValue("highlightColor")),sf.base.isNullOrUndefined(this.getValue("fontColor"))&&(this.fontColor=e.getValue("fontColor")),sf.base.isNullOrUndefined(this.getValue("bidi"))&&(this.bidi=e.getValue("bidi")),sf.base.isNullOrUndefined(this.getValue("bdo"))&&(this.bdo=e.getValue("bdo")),sf.base.isNullOrUndefined(this.getValue("allCaps"))&&(this.allCaps=e.getValue("allCaps")),sf.base.isNullOrUndefined(this.getValue("localeIdBidi"))&&(this.localeIdBidi=e.getValue("localeIdBidi")),sf.base.isNullOrUndefined(this.getValue("localeIdAscii"))&&(this.localeIdAscii=e.getValue("localeIdAscii")),sf.base.isNullOrUndefined(this.getValue("localeIdFarEast"))&&(this.localeIdFarEast=e.getValue("localeIdFarEast")),sf.base.isNullOrUndefined(this.getValue("complexScript"))&&(this.complexScript=e.getValue("complexScript")),sf.base.isNullOrUndefined(this.getValue("fontFamilyAscii"))&&(this.fontFamilyAscii=e.getValue("fontFamilyAscii")),sf.base.isNullOrUndefined(this.getValue("fontFamilyBidi"))&&(this.fontFamilyBidi=e.getValue("fontFamilyBidi")),sf.base.isNullOrUndefined(this.getValue("fontFamilyFarEast"))&&(this.fontFamilyFarEast=e.getValue("fontFamilyFarEast")),sf.base.isNullOrUndefined(this.getValue("fontFamilyNonFarEast"))&&(this.fontFamilyNonFarEast=e.getValue("fontFamilyNonFarEast"))},e.prototype.hasValueWithParent=function(e){var t=this.hasValue(e);!t&&!sf.base.isNullOrUndefined(this.baseCharStyle)&&this.baseCharStyle instanceof wl&&(t=this.baseCharStyle.characterFormat.hasValue(e));var i=this.documentCharacterFormat();return t||sf.base.isNullOrUndefined(i)||(t=i.hasValue(e)),t},e.uniqueCharacterFormats=new d,e.uniqueFormatType=2,e}(),H=function(){function e(e){this.uniqueListLevel=void 0,this.paragraphFormat=void 0,this.characterFormat=void 0,this.ownerBase=e,this.characterFormat=new T(void 0),this.paragraphFormat=new ul(void 0)}return Object.defineProperty(e.prototype,"listLevelPattern",{get:function(){return this.getPropertyValue("listLevelPattern")},set:function(e){this.setPropertyValue("listLevelPattern",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followCharacter",{get:function(){return this.getPropertyValue("followCharacter")},set:function(e){this.setPropertyValue("followCharacter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startAt",{get:function(){return this.getPropertyValue("startAt")},set:function(e){this.setPropertyValue("startAt",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberFormat",{get:function(){return this.getPropertyValue("numberFormat")},set:function(e){this.setPropertyValue("numberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paraStyleName",{get:function(){return this.getPropertyValue("paraStyleName")},set:function(e){this.setPropertyValue("paraStyleName",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartLevel",{get:function(){return this.getPropertyValue("restartLevel")},set:function(e){this.setPropertyValue("restartLevel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLegalStyleNumbering",{get:function(){return this.getPropertyValue("isLegalStyleNumbering")},set:function(e){this.setPropertyValue("isLegalStyleNumbering",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){var i=l.getPropertyType(e.uniqueFormatType,t);return!sf.base.isNullOrUndefined(this.uniqueListLevel)&&this.uniqueListLevel.propertiesHash.containsKey(i)?this.uniqueListLevel.propertiesHash.get(i):e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueListLevel))this.initializeUniqueWListLevel(t,i);else{var r=l.getPropertyType(this.uniqueListLevel.uniqueFormatType,t);if(this.uniqueListLevel.propertiesHash.containsKey(r)&&this.uniqueListLevel.propertiesHash.get(r)===i)return;this.uniqueListLevel=e.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel,t,i)}},e.prototype.initializeUniqueWListLevel=function(t,i){var r=new a;this.addUniqueWListLevel("listLevelPattern",t,i,r),this.addUniqueWListLevel("startAt",t,i,r),this.addUniqueWListLevel("followCharacter",t,i,r),this.addUniqueWListLevel("numberFormat",t,i,r),this.addUniqueWListLevel("paraStyleName",t,i,r),this.addUniqueWListLevel("restartLevel",t,i,r),this.addUniqueWListLevel("isLegalStyleNumbering",t,i,r),this.uniqueListLevel=e.uniqueListLevels.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueWListLevel=function(t,i,r,n){var o;o=l.getPropertyType(e.uniqueFormatType,t),t===i?n.add(o,r):n.add(o,e.getPropertyDefaultValue(t))},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listLevelPattern":t="Arabic";break;case"startAt":t=0;break;case"followCharacter":t="Tab";break;case"paraStyleName":case"numberFormat":t="";break;case"restartLevel":t=0;break;case"isLegalStyleNumbering":t=!1}return t},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.characterFormat)||this.characterFormat.destroy(),sf.base.isNullOrUndefined(this.paragraphFormat)||this.paragraphFormat.destroy(),sf.base.isNullOrUndefined(this.uniqueListLevel)||e.uniqueListLevels.remove(this.uniqueListLevel),this.uniqueListLevel=void 0,this.characterFormat=void 0,this.paragraphFormat=void 0},e.clear=function(){this.uniqueListLevels.clear()},e.prototype.clone=function(t){var i=new e(t);return i.paragraphFormat=this.paragraphFormat.cloneFormat(),i.characterFormat=this.characterFormat.cloneFormat(),this.uniqueListLevel&&(i.uniqueListLevel=this.uniqueListLevel,i.uniqueListLevel.referenceCount++),i},e.dotBullet=String.fromCharCode(61623),e.squareBullet=String.fromCharCode(61607),e.arrowBullet=String.fromCharCode(10148),e.circleBullet=String.fromCharCode(61551)+String.fromCharCode(32),e.uniqueListLevels=new d,e.uniqueFormatType=9,e}(),E=function(){function i(e){this.islayoutFootnote=!1,this.isMultiColumnDoc=!1,this.allowLayout=!0,this.isReplaceAll=!1,this.isTextFormat=!1,this.isSectionBreakCont=!1,this.isReplacingAll=!1,this.footHeight=0,this.existFootnoteHeight=0,this.isfootMove=!1,this.footnoteHeight=0,this.endNoteHeight=0,this.isTableFootNote=!1,this.isRelayout=!1,this.isRelayoutneed=!1,this.isOverlapFloatTable=!1,this.isInitialLoad=!0,this.isInsertFormField=!1,this.fieldBegin=void 0,this.maxTextHeight=0,this.maxBaseline=0,this.maxTextBaseline=0,this.isFieldCode=!1,this.isRtlFieldCode=!1,this.isRTLLayout=!1,this.currentCell=void 0,this.isFootnoteContentChanged=!1,this.isEndnoteContentChanged=!1,this.keepWithNext=!1,this.is2013Justification=!1,this.nextElementToLayout=void 0,this.isMultiColumnSplit=!1,this.skipUpdateContainerWidget=!1,this.isIFfield=!1,this.isLayoutWhole=!1,this.isBidiReLayout=!1,this.defaultTabWidthPixel=48,this.isRelayoutFootnote=!1,this.isRelayoutOverlap=!1,this.skipRelayoutOverlap=!1,this.isWrapText=!1,this.isYPositionUpdated=!1,this.isXPositionUpdated=!1,this.hasFloatingElement=!1,this.isFootNoteLayoutStart=!1,this.wrapPosition=[],this.shiftedFloatingItemsFromTable=[],this.isDocumentContainsRtl=!1,this.layoutedFootnoteElement=[],this.documentHelper=e}return i.prototype.isSameStyle=function(e,t){var i=void 0;if(t?e.nextWidget instanceof ca&&(i=e.nextWidget):e.previousWidget instanceof ca&&(i=e.previousWidget),sf.base.isNullOrUndefined(i)){if(e.paragraphFormat.contextualSpacing&&e.isInsideTable&&(!this.documentHelper.allowSpaceOfSameStyleInTable||"Word2013"===this.documentHelper.compatibilityMode))if(0===e.index)i=this.updateFirstParagraphSpacingBasedOnContextualSpacing(e,t);else if(e.index===e.associatedCell.childWidgets.length-1&&(i=this.updateLastParagraphSpacingBasedOnContextualSpacing(e))===e)return!0;if(sf.base.isNullOrUndefined(i))return!1}if(i instanceof ca&&e.paragraphFormat.baseStyle===i.paragraphFormat.baseStyle&&(!e.isInsideTable||!this.documentHelper.allowSpaceOfSameStyleInTable)){if(e.paragraphFormat.listFormat.listId>=0&&i.paragraphFormat.listFormat.listId>=0&&!e.paragraphFormat.contextualSpacing){if(t&&e.paragraphFormat.spaceAfterAuto)return!0;if(!t&&e.paragraphFormat.spaceBeforeAuto)return!0}return e.paragraphFormat.contextualSpacing}return!1},i.prototype.updateFirstParagraphSpacingBasedOnContextualSpacing=function(e,t){var i,r=e.associatedCell,n=r.ownerRow,o=n.ownerTable;if(i=t?sf.base.isNullOrUndefined(e.nextRenderedWidget)?sf.base.isNullOrUndefined(r.nextRenderedWidget)?void 0:r.nextRenderedWidget.firstChild:e.nextRenderedWidget:sf.base.isNullOrUndefined(e.previousRenderedWidget)?sf.base.isNullOrUndefined(r.previousRenderedWidget)?void 0:r.previousRenderedWidget.firstChild:e.previousRenderedWidget,0===r.index&&0===e.index){if(0!==n.index)return i;if(!o.isInsideTable||0!=o.index)return o.previousRenderedWidget;i=this.checkOwnerTablePrevItem(o,e)}else if(0===e.index&&!t){var s=n.childWidgets[r.index-1];if(s.childWidgets[s.childWidgets.length-1]instanceof ga&&"Normal"===e.paragraphFormat.baseStyle.name&&e.paragraphFormat.listFormat.listId<0)return e}return i},i.prototype.updateLastParagraphSpacingBasedOnContextualSpacing=function(e){var t,i=e.associatedCell,r=i.ownerRow;if(i.index===r.childWidgets.length-1&&e.index===i.childWidgets.length-1){if("Normal"===e.paragraphFormat.baseStyle.name&&e.paragraphFormat.listFormat.listId<0)return e}else if(e.index===i.childWidgets.length-1){for(t=r.childWidgets[i.index+1].firstChild;t instanceof ga;)t=t.childWidgets[0].childWidgets[0].childWidgets[0]}return t},i.prototype.checkOwnerTablePrevItem=function(e,t){var i=e.associatedCell.ownerRow;if(i.index>0){if("Normal"===t.paragraphFormat.baseStyle.name&&t.paragraphFormat.listFormat.listId<0)return t}else{if(!i.ownerTable.isInsideTable||0!==i.ownerTable.index)return i.ownerTable.previousRenderedWidget;this.checkOwnerTablePrevItem(i.ownerTable,t)}},Object.defineProperty(i.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),i.prototype.layout=function(){},i.prototype.destroy=function(){this.documentHelper=void 0,this.value=void 0,this.allowLayout=void 0,this.isInitialLoad=void 0,this.fieldBegin=void 0,this.maxTextHeight=void 0,this.maxBaseline=void 0,this.maxTextBaseline=void 0,this.isFieldCode=void 0,this.footnoteHeight=void 0,this.isMultiColumnDoc=void 0,this.isIFfield=void 0},i.prototype.layoutItems=function(e,t,i){for(var r,n=this,o=0,s=0,a=0;a<e.length;a++){var l=e[a];l.sectionFormat.numberOfColumns>1&&(this.isMultiColumnDoc=!0);var d=e[a+1];this.viewer.columnLayoutArea.setColumns(l.sectionFormat);var h=this.documentHelper.pages[this.documentHelper.pages.length-1],c=void 0;if(sf.base.isNullOrUndefined(h)||sf.base.isNullOrUndefined(h.bodyWidgets[h.bodyWidgets.length-1])||0!==h.bodyWidgets[h.bodyWidgets.length-1].childWidgets.length||sf.base.isNullOrUndefined(h.bodyWidgets[h.bodyWidgets.length-1].previousSplitWidget)||(c=h.bodyWidgets[h.bodyWidgets.length-1].previousSplitWidget),a>0&&!sf.base.isNullOrUndefined(c)&&!sf.base.isNullOrUndefined(c.lastChild)&&!(c.lastChild instanceof ga)&&("Word2013"===this.documentHelper.compatibilityMode&&c.lastChild.isEndsWithPageBreak||c.lastChild.isEndsWithColumnBreak)&&0===h.bodyWidgets[0].childWidgets.length)this.documentHelper.pages.splice(this.documentHelper.pages.length-1,1)[0].destroy(),h=this.documentHelper.pages[this.documentHelper.pages.length-1];if(0===a&&!i||0!==a&&(sf.base.isNullOrUndefined(l.sectionFormat.breakCode)||"NewPage"===l.sectionFormat.breakCode||o!==l.sectionFormat.pageHeight||s!==l.sectionFormat.pageWidth||!sf.base.isNullOrUndefined(h.bodyWidgets[h.bodyWidgets.length-1].lastChild)&&h.bodyWidgets[h.bodyWidgets.length-1].lastChild.isEndsWithPageBreak))r=this.viewer.createNewPage(l);else{var p=this.documentHelper.viewer.clientActiveArea.y,g=this.documentHelper.viewer.clientActiveArea.height;if(i){var f=this.getBodyWidget(h.bodyWidgets[h.bodyWidgets.length-1],!0),u=this.getNextWidgetHeight(f);this.viewer.updateClientArea(f,f.page),g=this.viewer.clientActiveArea.height-(u-this.viewer.clientActiveArea.y),p=u,i=!1}(r=h).bodyWidgets.push(l),r.bodyWidgets[r.bodyWidgets.length-1].page=r,this.documentHelper.viewer.updateClientArea(l,r),this.documentHelper.viewer.clientActiveArea.y=p,this.documentHelper.viewer.clientActiveArea.height=g}if(o=l.sectionFormat.pageHeight,s=l.sectionFormat.pageWidth,this.addBodyWidget(this.viewer.clientActiveArea,l),this.documentHelper.pages.length>1){for(var m=0,y=0;y<this.documentHelper.pages.length;y++){var v=this.documentHelper.pages[y];if(v.sectionIndex>l.index||v===r)break;m++}m<this.documentHelper.pages.length-1&&this.documentHelper.insertPage(m,r)}this.layoutSection(l,0,d)}t||this.layoutComments(this.documentHelper.comments),this.updateFieldElements(),"Pages"===this.documentHelper.owner.layoutType&&this.layoutEndNoteElement(),setTimeout((function(){n.documentHelper&&(n.documentHelper.isScrollHandler=!0,n.documentHelper.clearContent(),n.viewer.updateScrollBars(),sf.base.isNullOrUndefined(n.documentHelper.owner.selection)||n.documentHelper.owner.selection.updateCaretPosition(),n.documentHelper.isScrollHandler=!1,n.isInitialLoad=!1)}),50)},i.prototype.layoutComments=function(e){sf.base.isNullOrUndefined(e)},i.prototype.layoutSection=function(e,t,i){var r,n,o=e.firstChild;do{if(o instanceof ga&&"Auto"===o.tableFormat.preferredWidthType&&!o.tableFormat.allowAutoFit&&o.calculateGrid(),!sf.base.isNullOrUndefined(o)){this.viewer.updateClientAreaForBlock(o,!0,void 0,!0,!0);o.containerWidget.indexInOwner;r=this.layoutBlock(o,t),t=0,this.viewer.updateClientAreaForBlock(o,!1),o=r}}while(o);if(o=e.firstChild,this.viewer instanceof Qs&&e.sectionFormat.numberOfColumns>1&&!sf.base.isNullOrUndefined(i)&&"NoBreak"===i.sectionFormat.breakCode&&("NoBreak"===e.sectionFormat.breakCode||e.sectionIndex===e.page.bodyWidgets[0].sectionIndex))if(this.getColumnBreak(e)){var s=e.getSplitWidgets(),a=s[s.length-1];if(sf.base.isNullOrUndefined(e.page.nextPage)){var l=this.getBodyWidget(a,!0);this.viewer.updateClientArea(l,l.page);var d=this.getNextWidgetHeight(l);this.viewer.clientActiveArea.height-=d-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=d}else this.splitBodyWidgetBasedOnColumn(a)}else sf.base.isNullOrUndefined(e.page.nextPage)||(e=this.documentHelper.pages[this.documentHelper.pages.length-1].bodyWidgets[0]),this.splitBodyWidgetBasedOnColumn(e);for(o&&o.bodyWidget&&o.bodyWidget.page&&(n=o.bodyWidget.page);n;)n.footnoteWidget?(this.layoutfootNote(n.footnoteWidget),n=n.nextPage):n=n.nextPage;n=void 0,o=void 0},i.prototype.reLayoutMultiColumn=function(e,t){this.isInitialLoad=!0,e=e.getSplitWidgets()[0],this.combineMultiColumnForRelayout(e),e.sectionFormat.numberOfColumns>1&&(this.isMultiColumnDoc=!0),this.isMultiColumnSplit=!1;var i=e.previousRenderedWidget,r=e.nextRenderedWidget,n=!1;if(!t&&!sf.base.isNullOrUndefined(e.firstChild)&&e.firstChild instanceof ca&&e.y!==e.firstChild.y&&(e.y=e.firstChild.y),t&&r&&e.page!==r.page&&e.firstChild instanceof ca){var o=0;if((d=e.firstChild).isEmpty())o=this.documentHelper.textHelper.getParagraphMarkSize(d.characterFormat).Height;else{var s=d.childWidgets[0];o=this.getMaxElementHeight(s)}var a=d.previousRenderedWidget;e.y===this.viewer.clientActiveArea.y&&o>this.viewer.clientActiveArea.height&&(a=sf.base.isNullOrUndefined(a)?d:a,this.moveBlocksToNextPage(a),this.viewer.columnLayoutArea.setColumns(e.sectionFormat),this.viewer.updateClientArea(e,e.page),n=!0)}else if(!sf.base.isNullOrUndefined(i)&&i.page!==e.page&&e.firstChild instanceof ca&&i.lastChild instanceof ca){var l=i.lastChild,d=e.firstChild;if(e instanceof aa&&i.lastChild&&l instanceof ca&&"NoBreak"===i.sectionFormat.breakCode&&e.page.index!==i.page.index&&e.index!==i.index){var h=i;h.sectionFormat.columns.length>1&&(h=this.getBodyWidget(h,!0));var c=x.round(this.getNextWidgetHeight(h)+d.height,2);if(!i.lastChild.isEndsWithPageBreak&&!i.lastChild.isEndsWithColumnBreak&&c<=x.round(this.viewer.clientActiveArea.bottom,2)){for(var p=i.page,g=e.page,f=0;f<g.bodyWidgets.length;f++){var u=g.bodyWidgets[f];g.bodyWidgets.splice(g.bodyWidgets.indexOf(u),1),p.bodyWidgets.splice(p.bodyWidgets.length,0,u),u.page=p,f--}e.y=this.viewer.clientActiveArea.y,this.documentHelper.removeEmptyPages()}}}n||(this.viewer.columnLayoutArea.setColumns(e.sectionFormat),this.viewer.updateClientArea(e,e.page),this.viewer.clientActiveArea.height-=e.y-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=e.y),this.addBodyWidget(this.viewer.clientActiveArea,e),this.clearBlockWidget(e.childWidgets,!0,!0,!0),this.reLayoutMultiColumBlock(e,r),this.isInitialLoad=!1;var m=e.getSplitWidgets(),y=m[m.length-1],v=this.getBodyWidget(y,!0);this.viewer.updateClientArea(v,v.page);var w=this.getNextWidgetHeight(v);if(this.viewer.clientActiveArea.height-=w-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=w,!sf.base.isNullOrUndefined(y)&&!sf.base.isNullOrUndefined(y.nextRenderedWidget)){r=y.nextRenderedWidget;var b=this.documentHelper.viewer.clientActiveArea.y,I=this.documentHelper.viewer.clientActiveArea.height;this.documentHelper.viewer.updateClientArea(r,r.page),this.documentHelper.viewer.clientActiveArea.y=b,this.documentHelper.viewer.clientActiveArea.height=I,this.documentHelper.blockToShift=r.firstChild}(sf.base.isNullOrUndefined(y.nextRenderedWidget)||!sf.base.isNullOrUndefined(y.nextRenderedWidget)&&"NoBreak"!==y.sectionFormat.breakCode&&y.nextRenderedWidget.sectionFormat.pageHeight!==y.sectionFormat.pageHeight&&y.nextRenderedWidget.sectionFormat.pageWidth!==y.sectionFormat.pageWidth)&&(this.documentHelper.blockToShift=void 0)},i.prototype.combineMultiColumnForRelayout=function(e){var t=e.getSplitWidgets(),i=t[0];for(e=t[t.length-1];e!==i;){for(var r=e.previousRenderedWidget,n=!1,o=0;o<e.childWidgets.length;o++)e.childWidgets[o]instanceof da&&!sf.base.isNullOrUndefined(e.childWidgets[o].previousSplitWidget)&&!sf.base.isNullOrUndefined(e.childWidgets[o].previousSplitWidget.previousSplitWidget)&&e.childWidgets[o].previousSplitWidget.bodyWidget.page!==e.childWidgets[o].previousSplitWidget.previousSplitWidget.bodyWidget.page&&(n=!0),e.childWidgets[o]instanceof da&&!sf.base.isNullOrUndefined(e.childWidgets[o].previousSplitWidget)&&e.childWidgets[o].previousSplitWidget.bodyWidget.page===e.childWidgets[o].bodyWidget.page&&!n?(e.childWidgets[o].combineWidget(this.viewer),r.lastChild instanceof ga&&this.updateCellHeightInCombinedTable(r.lastChild),o--):(r.childWidgets.push(e.childWidgets[o]),e.childWidgets[o].containerWidget=r,e.childWidgets[o].containerWidget.page=r.page,e.childWidgets.splice(0,1),o--);e=e.previousRenderedWidget}this.documentHelper.removeEmptyPages()},i.prototype.reLayoutMultiColumBlock=function(e,t){var i,r=e.firstChild;do{r instanceof ga&&"Auto"===r.tableFormat.preferredWidthType&&!r.tableFormat.allowAutoFit&&r.calculateGrid(),sf.base.isNullOrUndefined(r)||(this.viewer.updateClientAreaForBlock(r,!0,void 0,!0),i=this.layoutBlock(r,0),this.viewer.updateClientAreaForBlock(r,!1),r=i)}while(r&&-1!==e.getSplitWidgets().indexOf(r.bodyWidget));if(r=e.firstChild,this.viewer instanceof Qs&&e.sectionFormat.numberOfColumns>1&&!sf.base.isNullOrUndefined(t)&&"NoBreak"===t.sectionFormat.breakCode&&("NoBreak"===e.sectionFormat.breakCode||e.sectionIndex===e.page.bodyWidgets[0].sectionIndex)){var n=e.getSplitWidgets(),o=n[n.length-1];if(this.getColumnBreak(e))if(e.page!==o.page)this.splitBodyWidgetBasedOnColumn(o);else{var s=this.getBodyWidget(o,!0);this.viewer.updateClientArea(s,s.page);var a=this.getNextWidgetHeight(s);this.viewer.clientActiveArea.height-=a-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=a}else sf.base.isNullOrUndefined(e.page.nextPage)||this.splitBodyWidgetBasedOnColumn(o)}},i.prototype.splitBodyWidgetBasedOnColumn=function(e){var t=e=this.getBodyWidget(e,!0);if(this.isMultiColumnSplit=!0,!this.isInitialLoad&&e.sectionFormat.equalWidth){var i=this.documentHelper.selection.startOffset,r=this.documentHelper.selection.endOffset;this.combineMultiColumn(e),this.layoutMultiColumnBody(e,!1),i!==this.documentHelper.selection.startOffset&&this.documentHelper.selection.select(i,r)}this.combineMultiColumn(e);for(var n=this.getCountOrLine(e,void 0,void 0,!0).lineCount,o=Math.round(n/e.sectionFormat.numberOfColumns);e;){var s=this.getCountOrLine(e,o,!0,!1),a=s.lineWidget,l=s.lineCount;if(!sf.base.isNullOrUndefined(a)){if(a.paragraph.containerWidget instanceof aa)this.moveToNextLine(a,!0,a.indexInOwner);else if(a.paragraph.containerWidget instanceof ua){var d=[a.paragraph.containerWidget.ownerTable],h=[a.paragraph.containerWidget.ownerRow],c=a.paragraph.containerWidget.index;d[d.length-1].isInsideTable&&(d[d.length-1]=this.getParentTable(d[d.length-1]),h[h.length-1]=this.getParentRow(h[h.length-1])),this.updateWidgetsToTable(d,h,h[h.length-1],!1,l,c,!0);for(var p=d[d.length-1],g=h[h.length-1].nextRenderedWidget;g;)this.clearRowWidget(g,!0,!0,!1),g=(g=this.layoutRow(d,g)).nextRenderedWidget;!sf.base.isNullOrUndefined(p.nextRenderedWidget)&&e.sectionFormat.equalWidth&&(this.documentHelper.blockToShift=p.nextRenderedWidget,this.documentHelper.layout.shiftLayoutedItems(!1))}var f=this.getBodyWidget(a.paragraph.bodyWidget,!0),u=this.getBodyWidget(f,!1);if(!f.sectionFormat.equalWidth&&u.sectionFormat.numberOfColumns-1===u.columnIndex){var m=f,y=this.getCountOrLine(f).lineCount;this.layoutMultiColumnBody(m,!0),y!==this.getCountOrLine(f).lineCount&&this.splitBodyWidgetBasedOnColumn(f)}this.viewer.updateClientArea(f,f.page);var v=this.getNextWidgetHeight(f);this.viewer.clientActiveArea.height-=v-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=v,this.viewer.clientArea.y=this.viewer.clientActiveArea.y,this.viewer.clientArea.height=this.viewer.clientActiveArea.height}if(e=e.nextRenderedWidget,!sf.base.isNullOrUndefined(e)&&e.columnIndex===e.sectionFormat.numberOfColumns-1)break}this.isMultiColumnSplit=!1,this.isInitialLoad||(e=this.getBodyWidget(t,!1),sf.base.isNullOrUndefined(e.nextRenderedWidget)||(this.documentHelper.blockToShift=e.nextRenderedWidget.firstChild))},i.prototype.getColumnBreak=function(e){var t=this.getBodyWidget(e,!0);if(t.sectionFormat.numberOfColumns<=1)return!1;for(;t;){if(t.lastChild instanceof ca&&t.lastChild.isEndsWithColumnBreak)return!0;if(sf.base.isNullOrUndefined(t.nextRenderedWidget)||t.index!==t.nextRenderedWidget.index)break;t=t.nextRenderedWidget}return!1},i.prototype.layoutMultiColumnBody=function(e,t){for(var i=!1;e;){i||(this.viewer.updateClientArea(e,e.page),this.viewer.clientActiveArea.height-=e.y-this.viewer.clientActiveArea.y,e instanceof ha?(this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY):this.viewer.clientActiveArea.y=e.y),i=!t;for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];n instanceof ga&&this.clearTableWidget(n,!0,!0,!0),this.viewer.updateClientAreaForBlock(n,!0),this.layoutBlock(n,0),this.viewer.updateClientAreaForBlock(n,!1)}if(e.columnIndex===e.sectionFormat.numberOfColumns-1||!sf.base.isNullOrUndefined(e.nextRenderedWidget)&&e.sectionIndex!==e.nextRenderedWidget.sectionIndex)break;e=e.nextRenderedWidget}},i.prototype.getNextWidgetHeight=function(e){for(var t=0,i=0;e&&e.childWidgets.length>0&&(t=e.lastChild.height,e.lastChild instanceof ga&&(t=this.getHeight(e.lastChild)),(t+=e.lastChild.y)>i&&(i=t),(sf.base.isNullOrUndefined(e)||e.columnIndex!==e.sectionFormat.numberOfColumns-1)&&0!==e.sectionFormat.numberOfColumns&&(sf.base.isNullOrUndefined(e.nextRenderedWidget)||e.sectionIndex===e.nextRenderedWidget.sectionIndex));)e=e.nextRenderedWidget;return i},i.prototype.getHeight=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;return t},i.prototype.getCountOrLine=function(e,t,i,r){for(var n,o,s=0,a=!1,l=0,d=0,h=0;e;){for(var c=0;c<e.childWidgets.length;c++){var p=e.childWidgets[c];if(p instanceof ca)for(var g=0;g<p.childWidgets.length;g++){var f=p.childWidgets[g];if(h=0,sf.base.isNullOrUndefined(f.margin)||(h=f.margin.top+f.margin.bottom),i){if(l+=f.height-h,Math.round(t)<Math.round(l)){n=p.childWidgets[g],a=!0;break}}else s++,l+=f.height-h}else p instanceof ga&&(o=this.getCountOrLineTable(p,t,i,l,!1,r),r?l+=o.lineCount:i?sf.base.isNullOrUndefined(o.lineWidget)?l=o.lineCount:(n=o.lineWidget,d=o.lineCount,a=!0):s+=o.lineCount);if(a&&i)break}if(a&&i)break;if(!sf.base.isNullOrUndefined(e.nextRenderedWidget)&&e.index!==e.nextRenderedWidget.index)break;e=e.nextRenderedWidget}return r?{lineWidget:void 0,lineCount:l}:i?{lineWidget:n,lineCount:d}:{lineWidget:void 0,lineCount:s}},i.prototype.getCountOrLineTable=function(e,t,i,r,n,o){for(var s,a,l=0,d=!1,h=0,c=0,p=0,g=0,f=0,u=0,m=0;m<e.childWidgets.length;m++){var y=e.childWidgets[m],v=void 0,w=void 0;p=0,g=0,f=0,u=0;for(var b=0;b<y.childWidgets.length;b++){for(var x=y.childWidgets[b],I=0;I<x.childWidgets.length;I++){if((k=x.childWidgets[I])instanceof ca&&k.childWidgets.length>0)for(var F=0;F<k.childWidgets.length;F++)p++,v=x,f+=k.childWidgets[F].height;else p+=(a=this.getCountOrLineTable(k,t,i,r,!0,o)).lineCount,f+=a.lineCount}g<p&&(g=p),u<f&&(u=f,w=v),p=0,f=0}if(!i||n)h+=g,c+=u;else for(var C=0,W=0;W<w.childWidgets.length;W++){var k;if((k=w.childWidgets[W])instanceof ca)for(b=0;b<k.childWidgets.length;b++){if(r+=k.childWidgets[b].height,Math.round(t)<Math.round(r)){s=k.childWidgets[b],d=!0,r=0,l=C;break}if(C++,d&&i)break}else{if(a=this.getCountOrLineTable(k,t,i,r,!1,o),!sf.base.isNullOrUndefined(a.lineWidget)){d=!0,r=0,s=a.lineWidget,l=C+=a.lineCount;break}C+=a.lineCount,r+=k.height}if(d&&i)break}if(g=0,d&&i)break}return o?{lineWidget:void 0,lineCount:c}:i?i&&sf.base.isNullOrUndefined(s)&&n?{lineWidget:void 0,lineCount:h}:i&&sf.base.isNullOrUndefined(s)&&!n?{lineWidget:void 0,lineCount:r}:{lineWidget:s,lineCount:l}:{lineWidget:void 0,lineCount:h}},i.prototype.combineMultiColumn=function(e){for(e=this.getBodyWidget(e,!1);e&&0!==e.columnIndex;){var t=e.previousRenderedWidget;if(t.lastChild instanceof ca&&t.lastChild.isEndsWithColumnBreak)break;for(var i=!1,r=0;r<e.childWidgets.length;r++)e.childWidgets[r]instanceof da&&!sf.base.isNullOrUndefined(e.childWidgets[r].previousSplitWidget)&&!sf.base.isNullOrUndefined(e.childWidgets[r].previousSplitWidget.previousSplitWidget)&&e.childWidgets[r].previousSplitWidget.bodyWidget.page!==e.childWidgets[r].previousSplitWidget.previousSplitWidget.bodyWidget.page&&(i=!0),e.childWidgets[r]instanceof da&&!sf.base.isNullOrUndefined(e.childWidgets[r].previousSplitWidget)&&e.childWidgets[r].previousSplitWidget.bodyWidget.page===e.childWidgets[r].bodyWidget.page&&!i?(e.childWidgets[r].combineWidget(this.viewer),t.lastChild instanceof ga&&this.updateCellHeightInCombinedTable(t.lastChild),r--):(t.childWidgets.push(e.childWidgets[r]),e.childWidgets[r].containerWidget=t,e.childWidgets[r].containerWidget.page=t.page,e.childWidgets.splice(0,1),r--);e=e.previousRenderedWidget}this.documentHelper.removeEmptyPages()},i.prototype.updateCellHeightInCombinedTable=function(e){for(var t=0,i=0,r=0;r<e.childWidgets.length;r++){for(var n=e.childWidgets[r],o=0;o<n.childWidgets.length;o++){for(var s=n.childWidgets[o],a=0;a<s.childWidgets.length;a++)i+=s.childWidgets[a].height;i>t&&(t=i),i=0;for(var l=0;l<n.childWidgets.length;l++)n.childWidgets[l].height=t}t=0}},i.prototype.layoutHeaderFooter=function(e,t,i){var r=t.getCurrentPageHeaderFooter(e,!0);if(r){var n=r;sf.base.isNullOrUndefined(r.page)&&(r.page=i,r.height=0,this.clearBlockWidget(r.childWidgets,!0,!0,!0),t.updateHFClientArea(e.sectionFormat,!0),this.layoutHeaderFooterItems(t,r)),(r=n.clone()).parentHeaderFooter=n,this.clearBlockWidget(r.childWidgets,!0,!0,!0);var o=r;o.page=i,o.height=0,this.updateRevisionsToHeaderFooter(o,i),t.updateHFClientArea(e.sectionFormat,!0),i.headerWidget=this.layoutHeaderFooterItems(t,o),e.sectionFormat.topMargin<i.boundingRectangle.bottom&&i.headerWidget.floatingElements.length>0&&"Behind"!==i.headerWidget.floatingElements[0].textWrappingStyle&&(i.headerWidget=this.shiftItemsForVerticalAlignment(o))}if(r=t.getCurrentPageHeaderFooter(e,!1)){n=r;sf.base.isNullOrUndefined(r.page)&&(r.page=i,r.height=0,this.clearBlockWidget(r.childWidgets,!0,!0,!0),t.updateHFClientArea(e.sectionFormat,!1),this.layoutHeaderFooterItems(t,r)),(r=n.clone()).parentHeaderFooter=n,this.clearBlockWidget(r.childWidgets,!0,!0,!0);var s=r;s.page=i,s.height=0,t.updateHFClientArea(e.sectionFormat,!1),this.updateRevisionsToHeaderFooter(s,i),i.footerWidget=this.layoutHeaderFooterItems(t,s)}},i.prototype.shiftItemsForVerticalAlignment=function(e){for(var t=e.floatingElements,i=0;i<t.length;i++){var r=t[i],n=r.verticalOrigin,o=r.paragraph;if("Margin"===n&&!o.isInsideTable){var s=r.verticalPosition;if(0!=s){var a=(s+=this.viewer.clientActiveArea.y)-r.y;if(r.y=s,r instanceof La)for(var l=0;l<r.textFrame.childWidgets.length;l++){var d=r.textFrame.childWidgets[l];d instanceof ca&&(d.y=d.y+a)}}}}return e},i.prototype.updateHeaderFooterToParent=function(e){var t=e.page.sectionIndex,i=this.viewer.getHeaderFooter(e.headerFooterType),r=e.clone();this.documentHelper.headersFooters[t][i]=r;for(var n=0;n<r.childWidgets.length;n++){var o=r.childWidgets[n];o instanceof ga&&this.clearTableWidget(o,!1,!0)}return r},i.prototype.updateRevisionsToHeaderFooter=function(e,t){var i=e.childWidgets;if(e instanceof la&&i.length>0)for(var r=0;r<i.length;r++)if(i[r].childWidgets.length>0)for(var n=i[r].childWidgets,o=0;o<n.length;o++){var s=n[o].children;if(s)for(var a=0;a<s.length;a++)if(s[a].removedIds.length>0)for(var l=s[a].removedIds,d=0;d<l.length;d++){var h=this.documentHelper.revisionsInternal.get(l[d]);s[a].revisions[d]=h,this.updateRevisionRange(h,t)}}},i.prototype.updateRevisionRange=function(e,t){for(var i=0;i<e.range.length;i++){var r=e.range[i];r.line.paragraph.bodyWidget.page||(r.line.paragraph.bodyWidget.page=t)}},i.prototype.linkFieldInHeaderFooter=function(e){var t=e.firstChild;do{t instanceof ca?this.linkFieldInParagraph(t):this.linkFieldInTable(t)}while(t=t.nextWidget)},i.prototype.linkFieldInParagraph=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.children.length;r++){var n=i.children[r];if(n instanceof va&&(0!==n.fieldType||0===n.fieldType&&-1===this.documentHelper.fields.indexOf(n))&&n.linkFieldCharacter(this.documentHelper),n instanceof Sa&&!sf.base.isNullOrUndefined(n.previousElement)&&n.previousElement instanceof va&&n.fieldBegin!==n.previousElement.fieldBegin&&(n.fieldBegin=n.previousElement.fieldBegin),n instanceof La){var o=n.textFrame.firstChild;if(o)do{o instanceof ca?this.linkFieldInParagraph(o):this.linkFieldInTable(o)}while(o=o.nextWidget)}}},i.prototype.linkFieldInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.childWidgets.length;r++)for(var n=i.childWidgets[r],o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];s instanceof ca?this.linkFieldInParagraph(s):this.linkFieldInTable(s)}},i.prototype.layoutHeaderFooterItems=function(e,t){if(this.viewer.updateClientAreaLocation(t,e.clientActiveArea),0===t.childWidgets.length){var i=new ca,r=new ma(i);i.childWidgets.push(r),t.childWidgets.push(i),i.containerWidget=t}this.linkFieldInHeaderFooter(t);for(var n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n];o instanceof ga&&"Auto"===o.tableFormat.preferredWidthType&&!o.tableFormat.allowAutoFit&&!o.isGridUpdated&&o.calculateGrid(),e.updateClientAreaForBlock(o,!0),this.layoutBlock(o,0),e.updateClientAreaForBlock(o,!1)}var s=t.headerFooterType;return"OddFooter"!==s&&"EvenFooter"!==s&&"FirstPageFooter"!==s||this.shiftChildLocation(e.clientArea.y-e.clientActiveArea.y,t),t},i.prototype.shiftChildLocation=function(e,t){var i=t.y+e,r=t.page.boundingRectangle.height-t.page.boundingRectangle.height/100*40;e=(i=Math.max(i,r))-t.y;for(var n=t.y=i,o=0;o<t.childWidgets.length;o++){var s=t.childWidgets[o];if(s instanceof ca){s.x=s.x,s.y=0===o?s.y+e:n,n+=s.height;for(var a=0;a<s.childWidgets.length;a++)for(var l=s.childWidgets[a],d=0;d<l.children.length;d++){var h=l.children[d];if(h instanceof Ba&&"Inline"!==h.textWrappingStyle){if("Paragraph"===h.verticalOrigin||"Line"===h.verticalOrigin)h.y=s.y+h.verticalPosition;else{var c=this.getFloatingItemPoints(h);h.y=c.y}if(h instanceof La){var p=h.textFrame.marginTop;this.updateChildLocationForCellOrShape(h.y+p,h)}}}}else this.shiftChildLocationForTableWidget(s,e),n+=s.height}},i.prototype.shiftChildLocationForTableWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i];r instanceof fa&&this.shiftChildLocationForTableRowWidget(r,t)}},i.prototype.shiftChildLocationForTableRowWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)this.shiftChildLocationForTableCellWidget(e.childWidgets[i],t)},i.prototype.shiftChildLocationForTableCellWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i]instanceof ca?(e.childWidgets[i].x=e.childWidgets[i].x,e.childWidgets[i].y=e.childWidgets[i].y+t):this.shiftChildLocationForTableWidget(e.childWidgets[i],t)},i.prototype.layoutBlock=function(e,t,i){var r;if(e instanceof ca){e.splitTextRangeByScriptType(0),e.splitLtrAndRtlText(0),e.combineconsecutiveRTL(0),r=this.layoutParagraph(e,t,i);var n=this.checkAndRelayoutPreviousOverlappingBlock(e);n&&(r=n)}else r=this.layoutTable(e,t),this.checkAndRelayoutPreviousOverlappingBlock(e),this.updateTableYPositionBasedonTextWrap(r);return r.nextRenderedWidget},i.prototype.updateTableYPositionBasedonTextWrap=function(e){var t=this;if(!(sf.base.isNullOrUndefined(e.bodyWidget)||e.containerWidget instanceof Aa)){var i=e.y,r=new ia(e.x,e.y,e.width,e.height);e.bodyWidget.floatingElements.forEach((function(n){if(n instanceof La&&!n.paragraph.isInsideTable){var o=new ia(n.x,n.y,n.width,n.height);if(("TopAndBottom"===n.textWrappingStyle||"Square"===n.textWrappingStyle)&&r.isIntersecting(o)){e.y=n.y+n.height+n.distanceBottom,t.updateChildLocationForTable(e.y,e);var s=e.y-i;t.viewer.cutFromTop(t.viewer.clientActiveArea.y+s)}}}))}},i.prototype.checkAndRelayoutPreviousOverlappingBlock=function(e){if(!(e.containerWidget instanceof Aa||this.isRelayoutOverlap)){var t=e.previousWidget;if(e instanceof ca)if(e.floatingElements.length>0)for(var i=0,r=0;r<e.floatingElements.length;r++){var n=e.floatingElements[r];if("InFrontOfText"!==n.textWrappingStyle&&"Behind"!==n.textWrappingStyle&&"Inline"!==n.textWrappingStyle){for(var o=new ia(n.x,n.y,n.width,n.height);t;){if(e.isInsideTable&&i>this.viewer.clientArea.height){this.startOverlapWidget=void 0,this.endOverlapWidget=void 0;break}if(t instanceof ca){var s=new ia(t.x,t.y,t.width,t.height);o.isIntersecting(s)&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=e)}i+=t.height,t=t.previousWidget}t=e.previousWidget}}else{var a=e.getSplitWidgets();if(a)return a[a.length-1]}else{var l=e;if(!l.wrapTextAround)return l;for(var d=new ia(l.x,l.y,l.getTableCellWidth(),l.height);t;){if(t instanceof ca){var h=new ia(t.x,t.y,t.width,t.height);d.isIntersecting(h)&&this.startOverlapWidget!==t&&(this.startOverlapWidget=t,this.endOverlapWidget=e)}t=t.previousWidget}t=e.previousWidget}this.startOverlapWidget&&(this.isRelayoutOverlap=!0,this.skipRelayoutOverlap=!0,this.layoutStartEndBlocks(this.startOverlapWidget,e),this.isRelayoutOverlap=!1,this.skipRelayoutOverlap=!1),this.startOverlapWidget=void 0,this.endOverlapWidget=void 0}return e},i.prototype.addParagraphWidget=function(e,t){return t.isEmpty()&&!sf.base.isNullOrUndefined(t.paragraphFormat)&&("Center"===t.paragraphFormat.textAlignment||"Right"===t.paragraphFormat.textAlignment||"Justify"===t.paragraphFormat.textAlignment&&t.paragraphFormat.bidi)&&-1===t.paragraphFormat.listFormat.listId?(this.updateXPositionForEmptyParagraph(e,t),t.y=e.y):(this.viewer.clientActiveArea.width<=0&&this.viewer instanceof $s?t.x=this.previousPara:(t.x=e.x,this.previousPara=t.x),t.width=e.width,t.y=e.y,t.clientX=void 0,t.hasOwnProperty("absoluteXPosition")&&delete t.absoluteXPosition),t},i.prototype.updateXPositionForEmptyParagraph=function(e,t){if(t.isEmpty()&&!sf.base.isNullOrUndefined(t.paragraphFormat)){var i=this.documentHelper.textHelper.getParagraphMarkWidth(t.characterFormat);t.clientX=e.x;var r=e.x;t.absoluteXPosition={width:e.width,x:e.x},"Center"===t.paragraphFormat.textAlignment?r+=(e.width-i)/2:r+=e.width-i,t.width=i,t.x=r}},i.prototype.addLineWidget=function(e){var t=void 0;return(t=new ma(e)).width=e.width,e.childWidgets.push(t),t.paragraph=e,t},i.prototype.isFirstElementWithPageBreak=function(e){var t=!1;if(this.viewer instanceof Qs){var i=e.childWidgets[0];if(i)for(var r=i.children[0];r;){if(!(r instanceof Na&&r.name.indexOf("_")>=0)){r instanceof Fa&&("\f"===r.text||r.text===String.fromCharCode(14))&&(t=!0);break}r=r.nextElement}}return t},i.prototype.layoutfootNote=function(e){if("Pages"===this.documentHelper.owner.layoutType){var t=this.viewer.clientActiveArea.clone(),i=this.viewer.clientArea.clone();"Footnote"===e.footNoteType&&e.sectionFormat.columns.length>1&&!this.isInitialLoad&&(this.updateColumnIndex(e.bodyWidgets[0],!1),this.layoutMultiColumnBody(e.bodyWidgets[0],!0)),"Endnote"===e.footNoteType&&e.bodyWidgets[0].sectionFormat.numberOfColumns>1&&(this.isInitialLoad||this.updateColumnIndex(e.bodyWidgets[0],!1),this.layoutMultiColumnBody(e.bodyWidgets[0],!0),this.viewer.clientActiveArea=t);var r=0;e.sectionFormat.columns.length>1&&"Footnote"===e.footNoteType&&(this.viewer.updateClientArea(e,e.page),r=this.viewer.clientActiveArea.width),"Footnote"===e.footNoteType&&(this.viewer.updateFootnoteClientArea(e.sectionFormat,e),e.sectionFormat.columns.length>1&&(this.viewer.clientActiveArea.width=r,this.viewer.clientArea.width=r)),e.height=0;var n=void 0,o=0;this.isRelayoutFootnote=!1;var s=0;this.viewer instanceof Qs&&e.bodyWidgets.length>0&&("Footnote"===e.footNoteType&&e.sectionFormat.columns.length>1||"Endnote"===e.footNoteType&&e.bodyWidgets[0].sectionFormat.columns.length>1)&&this.splitFootNoteWidgetBasedOnColumn(e.bodyWidgets[0]);for(var a=e.bodyWidgets[0],l=0,d=0;d<e.bodyWidgets.length;d++){if(e.bodyWidgets[d].columnIndex!==a.columnIndex&&("Footnote"===e.footNoteType&&e.sectionFormat.columns.length>1||"Endnote"===e.footNoteType&&e.bodyWidgets[d].sectionFormat.columns.length>1)&&(this.viewer.updateClientArea(e.bodyWidgets[d],e.bodyWidgets[d].page),r=this.viewer.clientActiveArea.width,l=this.viewer.clientActiveArea.x,"Footnote"===e.footNoteType&&this.viewer.updateFootnoteClientArea(e.sectionFormat,e),this.viewer.clientActiveArea.x=l,this.viewer.clientArea.x=l,this.viewer.clientActiveArea.width=r,this.viewer.clientArea.width=r,this.viewer.cutFromTop(e.y+o)),0===d){var h=new ca;h.characterFormat=new T,h.paragraphFormat=new ul,h.index=0;var c=new ma(h);h.childWidgets.push(c),o=this.documentHelper.textHelper.getParagraphMarkSize(h.characterFormat).Height,e.height+=o,e.y=this.viewer.clientActiveArea.y,"Endnote"===e.footNoteType&&this.viewer.updateClientArea(e.bodyWidgets[d],e.bodyWidgets[d].page,!0),this.viewer.cutFromTop(e.y+o),e.margin=new na(0,o,0,0)}for(var p=0;p<e.bodyWidgets[d].childWidgets.length;p++)(n=e.bodyWidgets[d].childWidgets[p]).index=s,s++,n.containerWidget=e.bodyWidgets[d],n.containerWidget.page=e.page,n.containerWidget.containerWidget=e,this.viewer.updateClientAreaForBlock(n,!0),n instanceof ga&&(this.clearTableWidget(n,!0,!0,!0),this.isRelayoutFootnote=!0,this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY),this.layoutBlock(n,0),"Footnote"===e.footNoteType&&e.bodyWidgets[d].columnIndex===a.columnIndex&&(e.height+=n.height),this.viewer.updateClientAreaForBlock(n,!1);a=e.bodyWidgets[d]}if(e.sectionFormat.columns.length>1){var g=this.getFootNoteBodyHeight(e.bodyWidgets[0]);e.height=g+o}if("Footnote"===e.footNoteType&&this.shiftChildWidgetInFootnote(e),"Footnote"===e.footNoteType&&e.sectionFormat.columns.length>1&&e.page.bodyWidgets[e.page.bodyWidgets.length-1].sectionFormat.columns.length>1){var f=this.getBodyWidget(e.page.bodyWidgets[e.page.bodyWidgets.length-1],!0);this.getNextWidgetHeight(f)>e.y&&(this.footnoteHeight=e.height,this.layoutMultiColumnBody(f,!0))}if(this.viewer.clientActiveArea=t,this.viewer.clientArea=i,!this.islayoutFootnote&&this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height>e.y){this.viewer.clientActiveArea.height-=e.height;var u=this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height-e.y;this.viewer.clientActiveArea.height-=u}}return this.footnoteHeight=0,e},i.prototype.getFootNoteBodyHeight=function(e){for(var t=0;e&&0===e.columnIndex;){for(var i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;e=e.nextRenderedWidget}return t},i.prototype.splitFootNoteWidgetBasedOnColumn=function(e){for(var t=this.getCountOrLine(e,void 0,void 0,!0).lineCount,i=Math.round(t/e.sectionFormat.numberOfColumns);e;){var r=this.getCountOrLine(e,i,!0,!1),n=this.viewer.clientActiveArea.clone(),o=this.viewer.clientArea.clone();if(0===r.lineWidget.paragraph.indexInOwner&&0===r.lineWidget.indexInOwner)this.updateColumnIndex(r.lineWidget.paragraph.bodyWidget,!0);else{this.splitParagraph(r.lineWidget.paragraph,r.lineWidget.indexInOwner,void 0);var s=this.moveBlocksToNextPage(r.lineWidget.paragraph.previousRenderedWidget);this.viewer.clientActiveArea=n,this.viewer.clientArea=o,sf.base.isNullOrUndefined(s.nextRenderedWidget)||this.updateColumnIndex(s.nextRenderedWidget,!0)}if(r.lineWidget.paragraph.bodyWidget.columnIndex===r.lineWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns-1)break;e=e.nextRenderedWidget}},i.prototype.updateColumnIndex=function(e,t){for(;e;)t?e.columnIndex++:e.columnIndex=0,e=e.nextRenderedWidget},i.prototype.shiftChildWidgetInFootnote=function(e){var t=e.page,i=e.y-e.height;if(1===t.bodyWidgets[0].childWidgets.length&&t.bodyWidgets[0].firstChild){var r=t.bodyWidgets[0].firstChild.y,n=this.getBodyWidgetHeight(t.bodyWidgets[0]);i<r+n&&(i=r+n)}e.y=i;for(var o=i+=e.margin.top,s=e.bodyWidgets[0],a=0;a<e.bodyWidgets.length;a++){e.bodyWidgets[a].columnIndex!==s.columnIndex&&(i=o),s=e.bodyWidgets[a];for(var l=0;l<e.bodyWidgets[a].childWidgets.length;l++){var d=e.bodyWidgets[a].childWidgets[l];d instanceof ca?(d.y=i,i+=d.height):(this.shiftChildLocationForTableWidget(d,i-d.y),i+=d.height)}}},i.prototype.getBodyWidgetHeight=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height;return t},i.prototype.checkParaHasField=function(e){for(var t=!1,i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.children.length;n++){var o=r.children[n];if(o instanceof va&&(2===o.fieldType||1===o.fieldType)&&this.documentHelper.fieldStacks.length>0&&o.fieldBegin===this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]){t=!0;break}}return t},i.prototype.checkTableHasField=function(e){for(var t=!1,i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(t=a instanceof ca?this.checkParaHasField(a):this.checkTableHasField(a))break}return t},i.prototype.layoutParagraph=function(e,t,i){if(this.isFieldCode&&!this.checkParaHasField(e))return e.isFieldCodeBlock=!0,e;this.addParagraphWidget(this.viewer.clientActiveArea,e);var r=!0;if(this.isFirstElementWithPageBreak(e)||(this.layoutListItems(e,i),r=!1),e.isEmpty())this.layoutEmptyLineWidget(e,!0);else{var n=t<e.childWidgets.length?e.childWidgets[t]:void 0;for(this.isRelayoutOverlap||e.containerWidget instanceof Aa||this.layoutFloatElements(e);n instanceof ma;){if(e!==n.paragraph&&0===n.indexInOwner&&r&&(n.previousLine.isEndsWithColumnBreak?(this.viewer.updateClientAreaForBlock(e,!0),this.layoutListItems(n.paragraph),this.viewer.updateClientAreaForBlock(e,!1)):this.layoutListItems(n.paragraph)),n.isFirstLine()&&sf.base.isNullOrUndefined(this.fieldBegin)&&!sf.base.isNullOrUndefined(e.paragraphFormat)){var o=-x.convertPointToPixel(e.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(o)}n.marginTop=0,e=(n=this.layoutLine(n,0)).paragraph,n=n.nextLine}}return this.updateWidgetToPage(this.viewer,e),e.isLayouted=!0,e.isFieldCodeBlock=!1,e},i.prototype.clearLineMeasures=function(){this.maxBaseline=0,this.maxTextBaseline=0,this.maxTextHeight=0},i.prototype.layoutFloatElements=function(e){var t=this;e.floatingElements.forEach((function(e){e instanceof Ba&&"Inline"!==e.textWrappingStyle&&(t.isRelayoutOverlap||t.layoutShape(e))}))},i.prototype.layoutShape=function(e){if(!(e instanceof La&&e.isHorizontalRule)){if("Inline"!==e.textWrappingStyle){var t=this.getFloatingItemPoints(e);e.x=t.x,e.y=t.y,!e.paragraph.isInsideTable&&0!==e.paragraph.indexInOwner&&e.verticalPosition>=0&&Math.round(e.paragraph.y)>=Math.round(e.y)&&this.viewer.clientArea.bottom<=e.y+e.height&&("Line"==e.verticalOrigin||"Paragraph"==e.verticalOrigin)&&"InFrontOfText"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&(this.moveToNextPage(this.viewer,e.line),this.updateShapeBaseLocation(e.line.paragraph));var i=e.paragraph.bodyWidget;-1===i.floatingElements.indexOf(e)&&(i.floatingElements.push(e),i.floatingElements.sort((function(e,t){return e.y-t.y}))),-1===e.paragraph.floatingElements.indexOf(e)&&e.paragraph.floatingElements.push(e)}else if(0===e.width&&0!==e.widthScale){var r=x.convertPointToPixel(e.line.paragraph.getContainerWidth());e.width=r/100*e.widthScale}var n=this.viewer.clientArea,o=this.viewer.clientActiveArea;if(e instanceof La){var s=e.textFrame.childWidgets;this.viewer.updateClientAreaForTextBoxShape(e,!0);for(var a=0;a<s.length;a++){var l=s[a];this.viewer.updateClientAreaForBlock(l,!0),l instanceof ga&&this.clearTableWidget(l,!0,!0),this.layoutBlock(l,0),this.viewer.updateClientAreaForBlock(l,!1)}}this.viewer.clientActiveArea=o,this.viewer.clientArea=n}},i.prototype.moveElementFromNextLine=function(e){var t=e.nextLine;for(t&&!e.paragraph.bodyWidget.sectionFormat.equalWidth&&e.paragraph.bodyWidget.columnIndex!==t.paragraph.bodyWidget.columnIndex&&(t=void 0);t instanceof ma;){if(t.children.length>0){var i=t.children.splice(0,1)[0];e.children.push(i),i.line=e;break}1===t.paragraph.childWidgets.length?t.paragraph.destroy():t.paragraph.childWidgets.splice(t.paragraph.childWidgets.indexOf(t),1),t=e.nextLine}},i.prototype.layoutLine=function(e,t){var i=e.paragraph;0===e.children.length&&this.moveElementFromNextLine(e);var r=e.children[t],n=!0;if(r instanceof va&&e.children[e.children.length-1]instanceof va){n=!1;for(var o=0;o<e.children.length;o++)if(2==e.children[o].fieldType&&null!=e.children[o].nextElement&&!(e.children[o].nextElement instanceof va)){n=!0;break}}this.clearLineMeasures(),e.marginTop=0;for(i.bodyWidget.indexInOwner,e.indexInOwner;r instanceof ya;){if(r.padding.left=0,n?this.layoutElement(r,i):(this.layoutElement(r,i,!0),n=!0),e=r.line,r instanceof Fa){var s=r;!sf.base.isNullOrUndefined(s.errorCollection)&&s.errorCollection.length>0&&(s.ischangeDetected=!0)}if(this.isRTLLayout)r=void 0,this.isRTLLayout=!1;else{var a=i.childWidgets.indexOf(r.line);if(a>0&&this.hasFloatingElement)this.hasFloatingElement=!1,i.bodyWidget.floatingElements.length>0&&r instanceof Fa&&!(i.containerWidget instanceof ua)&&(r=i.childWidgets[a].children[0]);else{if(this.hasFloatingElement=!1,this.is2013Justification&&!sf.base.isNullOrUndefined(this.nextElementToLayout))r=this.nextElementToLayout;else if((r=r.nextElement)instanceof Fa&&0==r.text.indexOf(" ")&&r.text.length>2&&sf.base.isNullOrUndefined(r.nextElement)&&r.text.trim().length>0){r.text=r.text.substring(1,r.text.length);var l=r.line.children.indexOf(r);if(r.line.children.splice(l,1),(s=new Fa).text=" ",s.line=r.line,s.characterFormat.copyFormat(r.characterFormat),r.revisions.length>0)for(var d=0;d<r.revisions.length;d++){var h=r.revisions[d];s.revisions.push(h);var c=h.range.indexOf(r);c<0?h.range.push(s):h.range.splice(c,0,s)}r.line.children.splice(l,0,s),r.line.children.splice(l+1,0,r),r=s}this.nextElementToLayout=void 0}}}return e},i.prototype.layoutElement=function(e,t,i){if(!(e.isPageBreak&&t.isInHeaderFooter||e instanceof La&&e.isHorizontalRule)){var r=e.line,n="",o=e.indexInOwner;if(this.viewer.owner.editor&&this.viewer.owner.editorHistory&&this.viewer.owner.editorHistory.isRedoing&&!sf.base.isNullOrUndefined(e.paragraph.containerWidget.footNoteReference)&&this.viewer.owner.enableTrackChanges&&e.removedIds.length>0&&this.viewer.owner.editor.constructRevisionFromID(e,!0),e instanceof va){if(0===e.fieldType&&(-1===this.documentHelper.fields.indexOf(e)&&this.documentHelper.fields.push(e),sf.base.isNullOrUndefined(e.formFieldData)||-1!==this.documentHelper.formFields.indexOf(e)||this.isInsertFormField||this.documentHelper.formFields.push(e)),this.layoutFieldCharacters(e),e.line.isLastLine()&&sf.base.isNullOrUndefined(e.nextNode)&&!this.isFieldCode)this.moveToNextLine(r);else if(sf.base.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine())this.moveElementFromNextLine(r),e.line.isLastLine()&&sf.base.isNullOrUndefined(e.nextNode)&&!this.isFieldCode&&(2!==e.fieldType&&sf.base.isNullOrUndefined(e.fieldSeparator)&&this.layoutEmptyLineWidget(t,!1,e.line),this.moveToNextLine(r));else if(sf.base.isNullOrUndefined(e.nextElement)&&0===this.viewer.clientActiveArea.width)this.moveToNextLine(r),r.paragraph.lastChild===r&&!sf.base.isNullOrUndefined(r.nextLine)&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(r);else if(i){var s=this.documentHelper.textHelper.getHeight(t.characterFormat);e.height=s.Height}}else{if(e instanceof Va||this.isFieldCode||e instanceof Na||e instanceof qa||e instanceof _a||e instanceof Oa||e instanceof Ba&&"Inline"!==e.textWrappingStyle){if(e instanceof Na)if(0!==e.bookmarkType||this.documentHelper.bookmarks.containsKey(e.name)){if(1===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)){var a=this.documentHelper.bookmarks.get(e.name);if((sf.base.isNullOrUndefined(a.reference)||sf.base.isNullOrUndefined(a.reference.paragraph)||sf.base.isNullOrUndefined(a.reference.paragraph.bodyWidget))&&(a.reference=e,e.reference=a),sf.base.isNullOrUndefined(a.properties)){if(!sf.base.isNullOrUndefined(this.documentHelper.selection)&&a.reference&&this.documentHelper.selection.isRenderBookmarkAtEnd(a.reference))(f=a.reference.paragraph.associatedCell).isRenderBookmarkEnd=!0}else if(!sf.base.isNullOrUndefined(e.paragraph.associatedCell)){var l=this.documentHelper.selection.getLastParagraph(e.paragraph.associatedCell).lastChild;if(!sf.base.isNullOrUndefined(l))if(l.children[l.children.length-1]==e){for(var d=parseInt(e.reference.properties.columnLast),h=e.paragraph.associatedCell.ownerRow,c=void 0,p=d;sf.base.isNullOrUndefined(c)&&p>-1;)c=h.getCellUsingColumnIndex(h.rowIndex,p),sf.base.isNullOrUndefined(c)&&p--;sf.base.isNullOrUndefined(c)||(h.isRenderBookmarkEnd=!0)}}}else if(0===e.bookmarkType&&this.documentHelper.bookmarks.containsKey(e.name)&&(sf.base.isNullOrUndefined(e.reference)&&this.documentHelper.bookmarks.remove(e.name),!sf.base.isNullOrUndefined(e.properties))){g=parseInt(e.properties.columnFirst);if(e.paragraph.isInsideTable){f=(u=e.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(u.rowIndex,g);sf.base.isNullOrUndefined(f)||(f.isRenderBookmarkStart=!0)}}}else if(this.documentHelper.bookmarks.add(e.name,e),!sf.base.isNullOrUndefined(e.properties)){var g=parseInt(e.properties.columnFirst);if(e.paragraph.isInsideTable){var f=(u=e.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(u.rowIndex,g);sf.base.isNullOrUndefined(f)||(f.isRenderBookmarkStart=!0)}}if(e instanceof _a||e instanceof qa)if(e instanceof _a&&(this.documentHelper.owner.currentUser===e.user||"Everyone"===e.group&&""===e.user)){if(-1!=e.columnFirst&&-1!=e.columnLast){f=(u=e.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(u.rowIndex,e.columnFirst);sf.base.isNullOrUndefined(f)||(f.isRenderEditRangeStart=!0,u.editRangeID.add(e.editRangeId,e))}}else if(e instanceof qa&&(this.documentHelper.owner.currentUser===e.editRangeStart.user||"Everyone"===e.editRangeStart.group&&""===e.editRangeStart.user)){var u;if(-1!=e.editRangeStart.columnFirst&&-1!=e.editRangeStart.columnLast)if((u=e.paragraph.associatedCell.ownerRow).editRangeID.containsKey(e.editRangeStart.editRangeId)){f=u.getCellUsingColumnIndex(u.rowIndex,e.editRangeStart.columnFirst);sf.base.isNullOrUndefined(f)||f.isRenderEditRangeStart&&(f.isRenderEditRangeEnd=!0)}else for(var m=e.paragraph.associatedCell.ownerTable,y=u.rowIndex-1;y>=0;y--){var v=m.childWidgets[y];if(v.editRangeID.containsKey(e.editRangeStart.editRangeId)){var w=v.getCellUsingColumnIndex(v.rowIndex,e.editRangeStart.columnFirst);if(!sf.base.isNullOrUndefined(w)&&w.isRenderEditRangeStart){w.isRenderEditRangeEnd=!0;break}}}}if(e instanceof Ba&&"Inline"!==e.textWrappingStyle&&-1==t.floatingElements.indexOf(e)&&e instanceof La&&(-1===t.floatingElements.indexOf(e)&&t.floatingElements.push(e),-1===t.bodyWidget.floatingElements.indexOf(e)&&t.bodyWidget.floatingElements.push(e)),e instanceof Oa&&-1===this.documentHelper.contentControlCollection.indexOf(e))if(0===e.type)this.documentHelper.contentControlCollection.push(e);else if(1===e.type){var b=e.paragraph.bodyWidget.page;for(y=0;y<this.documentHelper.contentControlCollection.length;y++){var I=this.documentHelper.contentControlCollection[y],F=I.line.paragraph.isInHeaderFooter;F&&e.contentControlProperties===I.contentControlProperties&&b===I.line.paragraph.bodyWidget.page?(e.reference=I,I.reference=e):F||e.contentControlProperties!==I.contentControlProperties||(e.reference=I,I.reference=e)}}return sf.base.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(r),void(e.line.isLastLine()&&sf.base.isNullOrUndefined(e.nextElement)&&(this.hasValidElement(r.paragraph)&&!t.isContainsShapeAlone()?this.moveToNextLine(r):this.isInitialLoad||this.hasValidElement(r.paragraph)||!r.paragraph.paragraphFormat.bidi||-1===r.paragraph.paragraphFormat.listFormat.listId?this.layoutEmptyLineWidget(r.paragraph,!1,r,!1):this.moveToNextLine(r)))}if(e instanceof Fa&&"NoColor"!=e.characterFormat.highlightColor&&""!=e.text.trim()&&e.text!=e.text.trim()){var C=t.firstChild;l=t.lastChild;!sf.base.isNullOrUndefined(C)&&C instanceof ma&&C.children.length>0&&e===C.children[0]&&x.splitSpaceInTextElementBox(e,!0),!sf.base.isNullOrUndefined(l)&&l instanceof ma&&l.children.length>0&&e===l.children[l.children.length-1]&&x.splitSpaceInTextElementBox(e,!1)}var W,k=e.width;if(e instanceof Sa&&!this.isTocField(e.fieldBegin)?""!==(n=this.documentHelper.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page))?e.text=n:n=e.text:e instanceof Wa?""!==(n=this.startAt(e,n))&&(e.text=n):e instanceof Fa&&(sf.base.isNullOrUndefined(e.paragraph.containerWidget.footNoteReference)||!e.line.isFirstLine()||0!==e.paragraph.index||0!==e.indexInOwner||this.documentHelper.owner.editor.handleEnterKey||(e.text=e.paragraph.containerWidget.footNoteReference.text),this.checkAndSplitTabOrLineBreakCharacter(e.text,e),n=e.text),e instanceof Fa&&(k=this.documentHelper.textHelper.getTextSize(e,e.characterFormat),"\t"===e.text?(k=this.getTabWidth(t,this.viewer,o,r,e),e.width=k):e.text!==String.fromCharCode(31)&&e.text!==String.fromCharCode(14)||(e.width=k=0)),sf.base.isNullOrUndefined(t.containerWidget)||!(t.bodyWidget.floatingElements.length>0)||e instanceof La&&"Inline"==e.textWrappingStyle||t.containerWidget instanceof Aa&&!(e instanceof al)||t.containerWidget instanceof ua&&t.containerWidget.ownerTable.containerWidget instanceof Aa||this.adjustPosition(e,e.line.paragraph.bodyWidget),this.viewer instanceof Qs&&(e instanceof La&&"Inline"===e.textWrappingStyle||!(e instanceof La))&&this.viewer.clientActiveArea.height<e.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(!(e instanceof Fa&&("\f"!==e.text&&e.text!==String.fromCharCode(14)||"\f"===e.text&&t.isPageBreak()&&"Word2013"===this.documentHelper.compatibilityMode))&&e instanceof Fa||this.moveToNextPage(this.viewer,r),e instanceof Sa&&this.updateFieldText(e),!e.previousElement||!(e.previousElement instanceof La&&"Inline"===e.previousElement.textWrappingStyle)&&e.previousElement instanceof La||this.cutClientWidth(e.previousElement)),e instanceof La&&"Inline"===e.textWrappingStyle&&(-1===t.floatingElements.indexOf(e)&&t.floatingElements.push(e),e.width>this.viewer.clientActiveArea.width&&(this.splitElementForClientArea(t,e),this.checkLineWidgetWithClientArea(r,e)),this.layoutShape(e)),e instanceof Wa&&(!e.isLayout||this.isLayoutWhole)&&"Pages"===this.documentHelper.owner.layoutType&&this.layoutFootEndNoteElement(e),e instanceof Wa&&(this.isfootMove&&(this.moveToNextPage(this.viewer,e.line),!e.previousElement||!(e.previousElement instanceof La&&"Inline"===e.previousElement.textWrappingStyle)&&e.previousElement instanceof La||this.cutClientWidth(e.previousElement),this.isfootMove=!1),t.paragraphFormat.keepWithNext&&t.paragraphFormat.keepLinesTogether&&e.isLayout&&!this.isLayoutWhole&&!sf.base.isNullOrUndefined(t.bodyWidget.page.footnoteWidget)&&0!==t.bodyWidget.page.footnoteWidget.y&&t.bodyWidget.page.footnoteWidget.y<this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height)){var S=this.viewer.clientActiveArea.y+this.viewer.clientActiveArea.height-t.bodyWidget.page.footnoteWidget.y;this.viewer.clientActiveArea.height-=S}if(parseFloat(k.toFixed(4))<=parseFloat(this.viewer.clientActiveArea.width.toFixed(4))||!this.viewer.textWrap){if(this.addElementToLine(t,e),sf.base.isNullOrUndefined(e.nextElement)&&!e.line.isLastLine()){var P=e.line.nextLine.children[0];P instanceof Fa&&0==P.text.indexOf(" ")&&this.moveElementFromNextLine(r)}sf.base.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()?this.moveElementFromNextLine(r):!e.line.isLastLine()&&sf.base.isNullOrUndefined(e.nextElement)&&0===this.viewer.clientActiveArea.width&&(this.moveToNextLine(r),r.paragraph.lastChild===r&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(r))}else if(e instanceof Fa){if("\t"===e.text){var N=e.line,O=!1;if(0!==e.indexInOwner&&e instanceof Pa?(O=!0,this.addSplittedLineWidget(N,N.children.indexOf(e)-1)):(this.isWrapText&&this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width===this.viewer.clientActiveArea.right&&(this.isWrapText=!1),this.addSplittedLineWidget(N,N.children.indexOf(e))),this.moveToNextLine(N),N.paragraph.bodyWidget.floatingElements.length>0&&O)return this.nextElementToLayout=e,void(this.hasFloatingElement=!0);e.width=this.getTabWidth(t,this.viewer,o,e.line,e),O&&(this.addElementToLine(t,e),sf.base.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(e.line))}else do{if(r=e.line,e.previousElement instanceof va&&2==e.previousElement.fieldType&&!sf.base.isNullOrUndefined(e.previousElement.fieldBeginInternal)&&e.previousElement.fieldBeginInternal.formFieldData instanceof Ia||this.splitTextForClientArea(r,e,e.text,e.width,e.characterFormat),this.checkLineWidgetWithClientArea(r,e),e instanceof Sa&&!this.isInitialLoad&&this.updateFieldText(e),e.line!==r&&!sf.base.isNullOrUndefined(this.nextElementToLayout)&&this.is2013Justification)return}while(e.line!==r&&this.cutClientWidth(e))}else do{r=e.line,this.splitElementForClientArea(t,e),this.checkLineWidgetWithClientArea(r,e),e instanceof Sa&&this.updateFieldText(e)}while(e.line!==r&&this.cutClientWidth(e));if(!sf.base.isNullOrUndefined(e.nextNode)&&e.nextNode instanceof Oa&&(W=e.nextNode),("\v"===n||"\f"===n||"\r"===n||n===String.fromCharCode(14))&&!W){var T=r.children.indexOf(e);T>-1&&this.addSplittedLineWidget(r,T)}if(e.line.isLastLine()&&sf.base.isNullOrUndefined(e.nextElement)||"\v"===n||"\f"===n||"\r"===n||n===String.fromCharCode(14)){if(this.isXPositionUpdated)return void(this.isXPositionUpdated=!1);if(this.moveToNextLine(e.line),"\v"===n&&sf.base.isNullOrUndefined(e.nextNode))this.layoutEmptyLineWidget(t,!0,r,!0);else if(("\f"===n||n===String.fromCharCode(14))&&this.viewer instanceof Qs&&!(e.line.paragraph.containerWidget instanceof ua)){var H=this.isRTLLayout;this.isRTLLayout=!1,sf.base.isNullOrUndefined(e.nextNode)||e.nextNode instanceof Oa?n===String.fromCharCode(14)?(this.moveToNextPage(this.viewer,e.line.nextLine,!1),this.layoutEmptyLineWidget(e.line.nextLine.paragraph,!1,e.line.nextLine,!0)):this.moveToNextPage(this.viewer,e.line,!0):sf.base.isNullOrUndefined(e.line.nextLine)||this.moveToNextPage(this.viewer,e.line.nextLine,!1),this.isRTLLayout=H}}this.isXPositionUpdated=!1}}},i.prototype.adjustPosition=function(e,t){var i=this.viewer.clientActiveArea,r=this.viewer.clientActiveArea.x,n=this.viewer.clientActiveArea.y,o=this.viewer.clientActiveArea.width,s=this.adjustClientAreaBasedOnTextWrap(e,new ia(i.x,i.y,i.width,i.height));this.viewer.clientActiveArea.width=s.width;var a=this.viewer.clientActiveArea.x-r;if(e.line.isFirstLine()&&this.getFirstElement(e.line)===e&&a>0&&(a+=x.convertPointToPixel(e.line.paragraph.paragraphFormat.firstLineIndent)),e.padding.left=a>0?a:0,o!==this.viewer.clientActiveArea.width){var l=new C(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.width);this.updateWrapPosition(l)}if(0===this.viewer.clientActiveArea.width&&(this.isWrapText=!1),this.isYPositionUpdated){if(e.line.isFirstLine()){if(!sf.base.isNullOrUndefined(e.line.paragraph.associatedCell)){var d=e.line.paragraph.previousRenderedWidget;sf.base.isNullOrUndefined(d)?e.line.paragraph.associatedCell.height+=this.viewer.clientActiveArea.y-n:e.line.paragraph.associatedCell.height+=this.viewer.clientActiveArea.y-d.y+d.height}e.line.paragraph.y=this.viewer.clientActiveArea.y}else e.line.children[0]===e&&(e.line.marginTop+=this.viewer.clientActiveArea.y-n);e.line.paragraph.containerWidget instanceof la&&(e.line.paragraph.containerWidget.height+=this.viewer.clientActiveArea.y-n),e instanceof Va||(this.isYPositionUpdated=!1)}},i.prototype.getFirstElement=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(!(i instanceof Ba&&"Inline"!==i.textWrappingStyle))return i}},i.prototype.updateWrapPosition=function(e){for(var t=0;t<this.wrapPosition.length;t++){var i=this.wrapPosition[t];if(!(Math.abs(i.right-e.right)>1))return}this.wrapPosition.push(e)},i.prototype.isFirstitemInPage=function(e,t){return!e.line.paragraph.isInHeaderFooter&&Math.round(t)===this.viewer.clientArea.y},i.prototype.isTextFitBelow=function(e,t,i){return!1},i.prototype.isNeedToWrapForSquareTightAndThrough=function(e,t,i,r,n,o,s,a,l,d,h,c,p){return e.floatingElements.length>0&&i!==a&&r!==a&&"Inline"!==n&&"Behind"!==n&&"TopAndBottom"!==n&&"InFrontOfText"!==n&&(Math.round(h.y+p)>Math.round(o.y)||this.isTextFitBelow(o,h.y+p,l))&&Math.round(h.y)<Math.round(o.y+o.height)&&!(s&&(d||t instanceof Da&&"Inline"!==t.textWrappingStyle&&t.allowOverlap))},i.prototype.isNeedToWrapForTopAndBottom=function(e,t,i,r,n,o,s,a,l,d,h,c,p){if(e.isInsideTable&&"TopAndBottom"===n&&!(l instanceof ga)){var g=l.paragraph;if(!sf.base.isNullOrUndefined(g)&&!sf.base.isNullOrUndefined(g.associatedCell)){var f=g.isInsideTable,u=g.associatedCell,m=e.associatedCell;if(!sf.base.isNullOrUndefined(u)&&!sf.base.isNullOrUndefined(m)&&u!==m||!f&&"Word2013"!==this.documentHelper.compatibilityMode)return!1}}return i!==a&&r!==a&&"TopAndBottom"===n&&(h.y>=o.y&&h.y<o.bottom||(h.y+p>o.y||this.isTextFitBelow(o,h.y+p,l))&&h.y+p<o.bottom||h.y<o.y&&h.y+p>o.bottom&&o.height>0)&&!(s&&(d||t instanceof Da&&"Inline"!==t.textWrappingStyle&&t.allowOverlap))},i.prototype.isNeedToWrapForSquareTightAndThroughForTable=function(e,t,i,r,n,o,s,a,l,d,h,c,p){return e.floatingElements.length>0&&i!==a&&r!==a&&"Inline"!==n&&"Behind"!==n&&"TopAndBottom"!==n&&"InFrontOfText"!==n&&(Math.round(h.y+p)>=Math.round(o.y)&&Math.round(h.y)<Math.round(o.bottom)||Math.round(h.y+p)<=Math.round(o.bottom)&&Math.round(h.y+p)>=Math.round(o.y))&&!(s&&d)},i.prototype.isNeedToWrapLeafWidget=function(e,t){return e.bodyWidget.floatingElements.length>0&&!(t instanceof Ba&&("InFrontOfText"===t.textWrappingStyle||"Behind"===t.textWrappingStyle))},i.prototype.getMinWidth=function(e,t,i,r){var n=e.text,o=n.split(" ");""!==n&&""===n.trim()&&e&&e.line.paragraph&&e.previousNode&&e.nextNode&&e.line.paragraph.isEmpty&&(o=[""]);var s=this.documentHelper.textHelper.measureText(o[0],e.characterFormat,e.scriptType).Width,a=this.getNextSibling(e);if(1===o.length&&a){var l=a.text;s+=this.getNextTextRangeWidth(a,l,t,i,r)}return s},i.prototype.getNextTextRangeWidth=function(e,t,i,r,n){for(var o=e,s=new ia(0,0,0,0),a=this.isNextSibligSizeNeedToBeMeasure(s,e,n,i,r);a&&this.isLeafWidgetNextSiblingIsTextRange(o)&&i+s.width<n.width&&(o=this.getNextSibling(o),this.isNextSibligSizeNeedToBeMeasure(s,o,n,i,r));)o.text;return s.width},i.prototype.isLeafWidgetNextSiblingIsTextRange=function(e){var t=this.getNextSibling(e);return!!(t&&t instanceof Fa)},i.prototype.isNextSibligSizeNeedToBeMeasure=function(e,t,i,r,n){var o=null,s=t;if(s){if(-1!==(o=s.text).indexOf(" ")||-1!==o.indexOf("-")||-1!==o.indexOf("_")&&r+e.width+this.documentHelper.textHelper.measureText(o.split("-")[0],s.characterFormat,s.scriptType).Width<i.width||"\t"===s.text){var a=s.width;return o!==o.split(" ")[0]&&(a=this.documentHelper.textHelper.measureText(o.split(" ")[0],s.characterFormat,s.scriptType).Width),r+e.width+a>i.width&&o.indexOf("-")&&o!==o.split("-")[0]+"-"&&(a=this.documentHelper.textHelper.measureText(o.split("-")[0]+"-",s.characterFormat,s.scriptType).Width),e.width+=a,!1}if(s.text.length>0){var l=this.documentHelper.textHelper.measureText(s.text,s.characterFormat,s.scriptType);e.height+=l.Height,e.width+=l.Width}}return!0},i.prototype.isNeedDoIntermediateWrapping=function(e,t,i,r,n,o,s,a,l){return e>l&&((Math.round(i.width)<=Math.round(a)||i.width<r&&s.paragraph.isInsideTable)&&"Left"!==t&&"Largest"!==t||"Right"===t||i.width<e&&"Largest"===t)||(Math.round(o.x-n.x+n.leftIndent)<l||s instanceof Fa&&this.isFloatingItemOnLeft(i,a,o))&&("Left"!==t||e<l)},i.prototype.isFloatingItemOnLeft=function(e,t,i){return!1},i.prototype.getNextSibling=function(e){for(var t=e.nextNode,i=!1;t;){if(t instanceof va||t instanceof Na||i||t instanceof Va)t instanceof va&&(0===t.fieldType?i=!0:2===t.fieldType&&(i=!1));else if(t instanceof Fa)break;t=t.nextNode}return t},i.prototype.adjustClientAreaBasedOnTextWrap=function(e,t){var i=e.line.paragraph,r=i.bodyWidget,n=this.viewer,o=t.y;this.isFirstitemInPage(e,o);if(sf.base.isNullOrUndefined(i.previousWidget),this.isNeedToWrapLeafWidget(i,e)){var s=n.clientArea;r.floatingElements.sort((function(e,t){return e.y-t.y})),r.floatingElements.sort((function(e,t){return e.x-t.x}));for(var a=0;a<r.floatingElements.length;a++){var l=r.floatingElements[a],d=!1;if(d=l instanceof Ba?l.allowOverlap:l.positioning.allowOverlap,(!(i.isInsideTable&&l instanceof ga)||l.isInsideTable)&&!(this.isRelayout&&!this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(l instanceof ga?l:l.line.paragraph,e.line.paragraph)||this.isRelayout&&this.isRelayoutOverlap&&this.viewer.documentHelper.selection.isExistAfter(l instanceof ga?l:l.line.paragraph,this.endOverlapWidget))){l.x;var h=0,c=0,p=0,g=0,f=0;l instanceof Ba?(h=l.distanceLeft,c=l.distanceTop,p=l.distanceRight,g=l.distanceBottom,f=l.width):(f=l.getTableCellWidth(),h=l.positioning.distanceLeft,c=l.positioning.distanceTop,p=l.positioning.distanceRight,g=l.positioning.distanceBottom);var u=new ia(l.x-h,l.y-c,f+h+p,l.height+c+g),m=l instanceof ga?"Square":l.textWrappingStyle,y=l instanceof ga?"Both":l.textWrappingType,v=24;n.clientArea.y,l.height;if(!(s.x>u.right+v||s.right<u.x-v))if(this.isNeedToWrapForSquareTightAndThrough(r,e,-1,-1,m,u,d,1,l,!1,t,e.width,e.height)){var w=0,b=0,I=0,F=x.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent),C=x.convertPointToPixel(i.paragraphFormat.leftIndent),W=x.convertPointToPixel(i.paragraphFormat.rightIndent);F=0===e.indexInOwner&&e.line.isFirstLine()&&F>0?F:0;var k=e instanceof Fa||e instanceof Va?e:null,S=l instanceof ga?l.containerWidget:l.line.paragraph.containerWidget,P=!1;if(e.line.paragraph){t.x>=u.x&&"Left"!==y&&(w=W),t.x<u.x&&"Right"!==y&&(b=C);var N=i.paragraphFormat.listFormat,O=this.getListLevel(N.list,N.listLevelNumber);t.x===s.x+C&&N&&N.baseStyle&&O&&0!==O.paragraphFormat.leftIndent&&(I=C,P=!0)}var T=0,H=!1,E=void 0,R=0,U=void 0;if(l instanceof ga&&(E=l,U=l.positioning.horizontalAlignment,T=this.getMaximumRightCellBorderWidth(l),H=this.getDefaultBorderSpacingValue(T,H,U),R=l.tableFormat.borders.left.lineWidth/2),t.x+R>=u.x&&t.x<u.right&&"Left"!==y){t.width=t.width-(u.right-t.x)-w,this.isWrapText=!0;if(sf.base.isNullOrUndefined(E)||(v=this.getMinimumWidthRequiredForTable(H,U,T)),Math.round(t.width)<v||t.width<e.width&&"\t"===e.text||u.x<i.x+C){t.width=this.viewer.clientArea.right-u.right-(P?I:0);var B=0;if(B=sf.base.isNullOrUndefined(k)?e.width:this.getMinWidth(e,e.width,e.height,t),Math.round(t.width)<v||t.width<B){if(u.x-(i.x+i.leftIndent)>v&&this.viewer.clientArea.right-u.right>v)t.width=0;else{var L=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=u.bottom+L-t.y,t.y=u.bottom+L}this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else{var A=t.x;if(t.x=u.right+(P?I:0)+F,t.width-=F,"Square"===m&&t.width<0&&e.width>0){L=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=u.bottom+L-t.y,t.y=u.bottom+L,t.x=A}this.viewer.updateClientAreaForTextWrap(t)}}else{A=t.x;if(t.x=u.right+(P?I:0)+F,t.width=this.viewer.clientArea.right-u.right-(P?I:0)-F,"Square"===m&&t.width<0&&e.width>0){L=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=u.bottom+L-t.y,t.y=u.bottom+L,t.x=A}this.isWrapText=!0,this.viewer.updateClientAreaForTextWrap(t)}}else if(u.x>=t.x&&t.right>u.x){t.width=u.x-t.x-w;var M=this.viewer.clientArea.right-u.right;M=M>0?M:0,this.isWrapText=!0;var z=!1;B=0;if(B=sf.base.isNullOrUndefined(k)?e.width:this.getMinWidth(k,e.width,e.height,t),sf.base.isNullOrUndefined(E)||(v=this.getMinimumWidthRequiredForTable(H,U,T)),this.isNeedDoIntermediateWrapping(M,y,t,e.width,e.paragraph,u,e,B,v)){if(t.width=M,this.isWrapText=!0,(t.x+B>u.x||"Right"===y||s.x>u.x-24)&&(t.x=u.right,t.width>B||"Right"===y?this.viewer.updateClientAreaForTextWrap(t):t.width<B&&e.line.children[0]!==e&&"Both"===y&&l instanceof Ba&&(this.viewer.updateClientAreaForTextWrap(t),z=!0)),t.width<v&&!(B<M&&"Tight"===m)||t.width<B&&Math.round(t.right)===Math.round(this.viewer.clientArea.right)&&"Both"===y){var D=u;if(Math.round(t.x)===Math.round(r.sectionFormat.leftMargin+i.paragraphFormat.leftIndent)){L=0;t.y=D.bottom+L,this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height=t.height-(D.height+L),this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else if(!z&&Math.round(t.right)>=Math.round(this.viewer.clientArea.right)&&"Both"===y){L=0;t.y=D.bottom+L,t.width=this.viewer.clientArea.width,t.height=t.height-(D.height+L),t.x=this.viewer.clientArea.x+b,this.viewer.updateClientAreaForTextWrap(t),this.isYPositionUpdated=!0,this.isWrapText=!1}else t.width=0,this.viewer.updateClientAreaForTextWrap(t)}}else(e.line.isFirstLine()&&0===e.indexInOwner||0===M&&e.line.children[0]===e)&&"Square"===m&&Math.round(t.width)<=Math.round(B)&&i.containerWidget===S?(t.x=s.x,t.y=u.bottom,t.width=s.width,t.height-=u.bottom-t.y,this.isYPositionUpdated=!0):Math.round(t.width)<=Math.round(B)&&Math.round(t.x-b)!==Math.round(this.viewer.clientArea.x)&&(t.width=0),this.viewer.updateClientAreaForTextWrap(t)}"Both"!==y&&(this.isWrapText=!1)}else if(this.isNeedToWrapForTopAndBottom(i,e,-1,-1,m,u,d,1,l,!1,t,e.width,e.height)){L=0;var V=t.y;t.y=u.bottom+L,this.isYPositionUpdated=!0,t.height=t.height-(u.bottom-V+L),t.y!==o&&e instanceof Fa&&!(l instanceof ga)&&e.line.isFirstLine()&&(t.y+=e.margin.top,o=t.y),this.viewer.updateClientAreaForTextWrap(t)}}}}return t},i.prototype.adjustClientAreaBasedOnTextWrapForTable=function(e,t){if(sf.base.isNullOrUndefined(e.containerWidget)||sf.base.isNullOrUndefined(e.bodyWidget))return t;var i=e.bodyWidget,r=this.viewer;t.y,sf.base.isNullOrUndefined(e.previousWidget);if(i.floatingElements.length>0){var n=r.clientActiveArea;i.floatingElements.sort((function(e,t){return e.y-t.y})),i.floatingElements.sort((function(e,t){return e.x-t.x}));for(var o=0;o<i.floatingElements.length;o++){var s=i.floatingElements[o],a=!1;if(a=s instanceof Ba?s.allowOverlap:s.positioning.allowOverlap,(!(e.isInsideTable&&s instanceof ga)||s.isInsideTable)&&!(s instanceof ga&&s.wrapTextAround&&s.positioning.allowOverlap&&e.wrapTextAround&&e.positioning.allowOverlap)){var l=e.getTableCellWidth(),d=s instanceof Ba,h=d?s.distanceLeft:s.positioning.distanceLeft,c=d?s.distanceTop:s.positioning.distanceTop,p=d?s.distanceRight:s.positioning.distanceRight,g=d?s.distanceBottom:s.positioning.distanceBottom,f=d?s.width:s.getTableCellWidth(),u=new ia(s.x-h,s.y-c,f+h+p,s.height+c+g),m=s instanceof ga?"Square":s.textWrappingStyle,y=s instanceof ga?"Both":s.textWrappingType,v=e.childWidgets.length>0?e.childWidgets[0].rowFormat.height:0,w=this.getNestedTable(e).firstChild.firstChild.firstChild.characterFormat,b=this.documentHelper.textHelper.measureText(" ",w);if(v<b.Height&&(v=b.Height),!(n.x>u.right+24||n.right<u.x-24)&&this.isNeedToWrapForSquareTightAndThroughForTable(i,e,-1,-1,m,u,a,1,s,!1,t,l,v)&&t.x>=u.x&&t.x<u.right&&"Left"!==y){t.width=t.width-(u.right-t.x),this.isWrapText=!0;if(Math.round(t.width)<24||t.width<l||u.x<e.x){t.width=this.viewer.clientArea.right-u.right;var x=l;if(Math.round(t.width)<24||t.width<x){if(u.x-e.x>24&&this.viewer.clientArea.right-u.right>24)t.width=0;else{var I=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=u.bottom+I-t.y,t.y=u.bottom+I}this.viewer.updateClientAreaForTextWrap(t),this.isWrapText=!1}else{var F=t.x;if(t.x=u.right,"Square"===m&&t.width<0&&l>0){this.isYPositionUpdated=!0,t.height-=u.bottom+0-t.y,t.width=this.viewer.clientArea.width,t.y=u.bottom+0,t.x=F}this.viewer.updateClientAreaForTextWrap(t)}}else{F=t.x;if(t.x=u.right+e.firstChild.firstChild.leftMargin,t.width=this.viewer.clientArea.right-u.right,"Square"===m&&t.width<0&&l>0){I=0;this.isYPositionUpdated=!0,t.width=this.viewer.clientArea.width,t.height-=u.bottom+I-t.y,t.y=u.bottom+I,t.x=F}this.viewer.updateClientAreaForTextWrap(t)}}}}}return t},i.prototype.getNestedTable=function(e){for(var t=e;t.firstChild.firstChild.firstChild instanceof ga;)t=t.firstChild.firstChild.firstChild;return t},i.prototype.startAt=function(e,t){return"Footnote"===e.footnoteType?(this.startat=e.paragraph.bodyWidget.sectionFormat.initialFootNoteNumber,t=this.getFootEndNote(e.paragraph.bodyWidget.sectionFormat.footNoteNumberFormat,this.documentHelper.footnoteCollection.indexOf(e)+this.startat)):(this.startat=e.paragraph.bodyWidget.sectionFormat.initialEndNoteNumber,t=this.getFootEndNote(e.paragraph.bodyWidget.sectionFormat.endnoteNumberFormat,this.documentHelper.endnoteCollection.indexOf(e)+this.startat)),t},i.prototype.layoutFootEndNoteElement=function(e){var t;this.isFootnoteContentChanged=!0;var i,r=!1,n=this.documentHelper.footnoteCollection.indexOf(e),o=1;this.islayoutFootnote=!0;var s=new ia(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),a=new ia(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height),l=e.paragraph.bodyWidget,d=!1,h=0;if(l.page.footnoteWidget)for(var c=0;c<l.page.footnoteWidget.bodyWidgets.length;c++){o=l.page.footnoteWidget.bodyWidgets.length;var p=this.documentHelper.footnoteCollection.indexOf(l.page.footnoteWidget.bodyWidgets[c].footNoteReference);if(p>n&&p-n==1){o=c,r=!0;break}}if(e.isLayout=!0,"Footnote"===e.footnoteType){if(l.page.footnoteWidget&&l.page.footnoteWidget instanceof ha)t=l.page.footnoteWidget;else{d=!0,(t=new ha).footNoteType="Footnote",t.page=l.page;var g=new ca;g.characterFormat=new T,g.paragraphFormat=new ul,g.index=0;var f=new ma(g);g.childWidgets.push(f),h=this.documentHelper.textHelper.getParagraphMarkSize(g.characterFormat).Height,t.margin=new na(0,h,0,0)}this.isFootNoteLayoutStart=!0,d&&(l.page.footnoteWidget=t);var u=e.bodyWidget;this.viewer.updateClientArea(t,t.page),this.viewer.clientArea.y=s.y,this.viewer.clientActiveArea.y=a.y;for(var m=0;m<e.bodyWidget.childWidgets.length;m++){var y=e.bodyWidget.childWidgets[m];y.containerWidget=u,u.page=l.page,u.sectionFormat=t.sectionFormat,y.containerWidget.containerWidget=t,this.viewer.updateClientAreaForBlock(y,!0),y instanceof ga&&this.clearTableWidget(y,!0,!0),this.layoutBlock(y,0),h+=y.height,y.y=0,this.viewer.updateClientAreaForBlock(y,!1),u.height+=y.height}if(t.sectionFormat.columns.length>1&&!(0===t.bodyWidgets.length&&u.childWidgets.length<=1&&u.childWidgets[0].childWidgets.length<=1)&&(h/=t.sectionFormat.numberOfColumns),this.isFootNoteLayoutStart=!1,i=!1,h>=a.height&&(this.isfootMove=!0),r?t.bodyWidgets.splice(o,0,u):t.bodyWidgets.push(u),e.line.paragraph.isInsideTable){var v=this.getParentTable(e.line.paragraph.associatedCell.ownerTable);sf.base.isNullOrUndefined(v.footnoteElement)&&(v.footnoteElement=[]),-1==v.footnoteElement.indexOf(e)&&(v.footnoteElement.push(e),this.layoutedFootnoteElement.push(e))}t.height+=h,i=!0,this.viewer.clientActiveArea=a,this.viewer.clientActiveArea.height-=h,this.footnoteHeight+=h,this.viewer.clientArea=s}return i},i.prototype.layoutEndNoteElement=function(){var e=this.documentHelper.pages.length;if(this.documentHelper.endnoteCollection.length>0){var t=void 0,i=void 0,r=void 0,n=this.documentHelper.pages[e-1],o=n.bodyWidgets[0],s=n.bodyWidgets[n.bodyWidgets.length-1];if(this.viewer instanceof Qs&&s.sectionFormat.numberOfColumns>1){var a=this.getBodyWidget(s,!0);this.splitBodyWidgetBasedOnColumn(a)}for(var l=0;l<this.documentHelper.endnoteCollection.length;l++){t=this.documentHelper.endnoteCollection[l],o.page.endnoteWidget instanceof ha&&"Endnote"===o.page.endnoteWidget.footNoteType?i=o.page.endnoteWidget:(r=!0,(i=new ha).footNoteType="Endnote",i.page=o.page);var d=t.bodyWidget;d.page=i.page;for(var h=0;h<t.bodyWidget.childWidgets.length;h++){var c=t.bodyWidget.childWidgets[h];c.containerWidget=d,c.containerWidget.containerWidget=i}-1===i.bodyWidgets.indexOf(d)&&(i.bodyWidgets.push(d),d.sectionFormat=i.page.bodyWidgets[i.page.bodyWidgets.length-1].sectionFormat),r&&(o.page.endnoteWidget=i)}this.layoutfootNote(i)}},i.prototype.hasValidElement=function(e){var t=e.firstChild;if(t&&!sf.base.isNullOrUndefined(this.documentHelper.selection))for(var i=t.children[0];i;){if(i instanceof va&&(i=this.documentHelper.selection.getNextValidElementForField(i),!sf.base.isNullOrUndefined(i)&&!i.line.paragraph.equals(e)))return!1;if(i instanceof Fa||i instanceof Da)return!0;sf.base.isNullOrUndefined(i)||(i=i.nextNode)}return!1},i.prototype.updateFieldText=function(e){var t=this.documentHelper.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page);""!==t&&(e.text=t,this.documentHelper.textHelper.getTextSize(e,e.characterFormat))},i.prototype.checkLineWidgetWithClientArea=function(e,t){if(e!==t.line||t.line===e&&sf.base.isNullOrUndefined(t.nextElement)&&!t.line.isLastLine()){if(this.moveToNextLine(e),"Word2013"!==this.documentHelper.compatibilityMode&&this.isOverlapFloatTable){var i=void 0;t.line.paragraph.previousRenderedWidget instanceof ga&&t.line.paragraph.previousRenderedWidget.wrapTextAround&&(i=t.line.paragraph.previousRenderedWidget,this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-x.convertPointToPixel(i.firstChild.firstChild.leftMargin)),this.viewer.clientActiveArea.x+=e.paragraph.leftIndent,this.isOverlapFloatTable=!1}e!==t.line&&(this.isRTLLayout=!1)}t.line!==e&&this.viewer instanceof Qs&&this.viewer.clientActiveArea.height<t.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?this.moveToNextPage(this.viewer,t.line):t.line===e&&sf.base.isNullOrUndefined(t.nextElement)&&e.paragraph.lastChild===e&&!e.isLastLine()&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(e)},i.prototype.checkAndSplitTabOrLineBreakCharacter=function(e,t){var i=x.indexOfAny(e,["\t","\v","\f"]);if(i>-1){var r=e[i];("\t"===r&&"\t"!==e||"\v"===r&&"\v"!==e||"\f"===r&&"\f"!==e)&&this.splitByLineBreakOrTab(this.viewer,t,i,r)}},i.prototype.moveFromNextPage=function(e){var t=e.nextLine;if(t&&-1===e.paragraph.childWidgets.indexOf(t)){var i=t.paragraph;t.paragraph.childWidgets.splice(t.indexInOwner,1),e.paragraph.childWidgets.push(t),t.paragraph=e.paragraph,0===i.childWidgets.length&&i.destroy()}},i.prototype.cutClientWidth=function(e){if(this.is2013Justification)return!1;this.clearLineMeasures();var t=e.line;t.marginTop=0;for(var i=0,r=0;r<t.children.length;r++){var n=t.children[r];if(i+=n.width,e===n)break}var o=this.viewer.clientActiveArea.width-i<0,s=e.line.paragraph.bodyWidget;return s&&s.floatingElements.length>0?(this.hasFloatingElement=!0,this.isXPositionUpdated=!0,!1):(o?e.previousElement&&this.cutClientWidth(e.previousElement):(this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+i),"Justify"===e.line.paragraph.paragraphFormat.textAlignment&&e instanceof Fa&&this.splitTextElementWordByWord(e),sf.base.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(t)),o)},i.prototype.layoutFieldCharacters=function(e){if(0===e.fieldType){if(!sf.base.isNullOrUndefined(e.formFieldData)&&this.isInitialLoad&&this.checkAndUpdateFieldData(e),!this.isFieldCode&&(!sf.base.isNullOrUndefined(e.fieldEnd)||e.hasFieldEnd)){if(-1===this.documentHelper.fieldStacks.indexOf(e)&&this.documentHelper.fieldStacks.push(e),this.isRelayout){var t=x.trimEnd(this.documentHelper.selection.getFieldCode(e));this.isIFfield=x.startsWith(t,"IF")}this.isFieldCode=!0,e.hasFieldEnd=!0}}else if(this.documentHelper.fieldStacks.length>0){var i;if(2===e.fieldType)(i=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]).fieldSeparator!==e||sf.base.isNullOrUndefined(i.fieldEnd)&&!i.hasFieldEnd||(this.isFieldCode=!1);else e===(i=this.documentHelper.fieldStacks[this.documentHelper.fieldStacks.length-1]).fieldEnd&&(this.documentHelper.fieldStacks.pop(),this.isFieldCode=!1,this.isIFfield=!1)}},i.prototype.checkAndUpdateFieldData=function(e){if(e.hasFieldEnd&&!sf.base.isNullOrUndefined(e.fieldEnd)){if(sf.base.isNullOrUndefined(e.fieldSeparator)){var t=new va(2);t.fieldBegin=e,t.fieldEnd=e.fieldEnd,t.line=e.line,e.line.children.splice(e.fieldEnd.indexInOwner,0,t),e.fieldSeparator=t,e.fieldEnd.fieldSeparator=t}var i=e.fieldEnd.previousNode;if(i instanceof va&&2===i.fieldType){var r=e.formFieldData;if(r instanceof xa){var n=new Fa;n.line=e.line;var o=e.line.children.indexOf(e.fieldEnd);e.line.children.splice(o,0,n),n.characterFormat.copyFormat(e.characterFormat),r.checked?n.text=String.fromCharCode(9745):n.text=String.fromCharCode(9744),"Auto"!==r.sizeType?n.characterFormat.fontSize=1.35*r.size:n.characterFormat.fontSize=1.35*n.characterFormat.fontSize}else if(r instanceof Ia){var s=new Fa;s.characterFormat.copyFormat(e.characterFormat),s.line=e.line,r.dropdownItems.length>0?s.text=r.dropdownItems[r.selectedIndex]:s.text=this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5);o=e.line.children.indexOf(e.fieldEnd);e.line.children.splice(o,0,s)}}}},i.prototype.layoutEmptyLineWidget=function(e,t,i,r){this.clearLineMeasures();var n=e.paragraphFormat,o=0,s=0;r=!sf.base.isNullOrUndefined(r)&&r;var a,l=n.borders,d=this.documentHelper.canRenderBorder(e),h=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat).Height,c=this.getBeforeSpacing(e);if(e.childWidgets.length>0&&!r){if(this.isUpdateMarginForCurrentLine(i),(a=e.childWidgets[0]).children.length>0){(n.bidi||this.isContainsRtl(a))&&this.shiftElementsForRTLLayouting(a,n.bidi);var p=a.isFirstLine(),g=a.isLastLine(),f=0;if(p&&(c=this.getBeforeSpacing(e),f=x.convertPointToPixel(n.firstLineIndent)),"Left"!==(S=n.textAlignment)&&this.viewer.textWrap&&("Justify"!==S||!g||"Justify"===S&&n.bidi)){var u=this.getSubWidth(a,"Justify"===S,s,f,g);o=u[0].subWidth,s=u[0].spaceCount}}}else a=t?this.addLineWidget(e):i;if(!(sf.base.isNullOrUndefined(e.containerWidget)||!(e.bodyWidget.floatingElements.length>0)||e.containerWidget instanceof Aa||e.containerWidget instanceof ua&&e.containerWidget.ownerTable.containerWidget instanceof Aa)){var m=new Fa;m.line=a,a.children.push(m),m.text="¶",m.characterFormat=e.characterFormat,m.width=this.documentHelper.textHelper.getTextSize(m,m.characterFormat),this.adjustPosition(m,e.bodyWidget),e.x+=m.padding.left,t&&this.checkInbetweenShapeOverlap(a),a.children.splice(m.indexInOwner,1)}!(this.viewer instanceof Qs&&this.viewer.clientActiveArea.height<c+h&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y)||a.isFirstLine()&&sf.base.isNullOrUndefined(a.paragraph.previousWidget)||e.isSectionBreak||this.moveToNextPage(this.viewer,a);var y=this.getLineSpacing(e,h);!isNaN(this.maxTextHeight)&&h<this.maxTextHeight&&(h=this.maxTextHeight);var v=0,w=0,b=0,I=h,F=e.paragraphFormat.lineSpacingType;"Multiple"===F?y>h?w+=y-h:v+=y-h:("Exactly"===F||y>v+I+w)&&(v+=y-(v+I+w)),v+=c,w+=x.convertPointToPixel(this.getAfterSpacing(e)),"None"!=l.top.lineStyle&&a.isFirstLine()&&!d.skipTopBorder&&(v+=x.convertPointToPixel(l.top.lineWidth+l.top.space)),"None"!=l.bottom.lineStyle&&a.isLastLine()&&!d.skipBottomBorder&&(w+=x.convertPointToPixel(l.bottom.lineWidth+l.bottom.space));for(var C=a.renderedElements,W=0;W<C.length;W++){var k=C[W];if(0===W&&k instanceof Va||e.paragraphFormat.bidi&&C[C.length-1]instanceof Va){var S;"Right"===(S=e.paragraphFormat.textAlignment)?b=o:"Center"===S&&(b=o/2),k.margin=new na(b,v,0,w),k.line=a,a.height=v+I+w;break}}a.margin=new na(0,v,0,w),a.height=v+I+w,this.adjustPositionBasedOnTopAndBottom(a),sf.base.isNullOrUndefined(e.nextRenderedWidget)&&e.isInsideTable&&e.previousRenderedWidget instanceof ga&&1==e.childWidgets.length&&(a.height=0),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+a.height),this.wrapPosition=[]},i.prototype.isUpdateMarginForCurrentLine=function(e){var t=!0;if(!sf.base.isNullOrUndefined(e)&&!e.isFirstLine()){for(var i=0;i<e.children.length;i++)if(!(e.children[i]instanceof _a||e.children[i]instanceof qa)){t=!1;break}t&&(e.margin=new na(0,0,0,0))}},i.prototype.adjustPositionBasedOnTopAndBottom=function(e){!sf.base.isNullOrUndefined(e.paragraph.bodyWidget)&&!sf.base.isNullOrUndefined(e.paragraph.bodyWidget.page.headerWidget)&&e.paragraph.bodyWidget.page.headerWidget.floatingElements.length>0&&e.paragraph===e.paragraph.bodyWidget.childWidgets[0]&&0===e.indexInOwner&&this.checkInbetweenShapeOverlap(e,e.paragraph.bodyWidget.page.headerWidget.floatingElements)},i.prototype.layoutListItems=function(e,t){this.isFieldCode||(!sf.base.isNullOrUndefined(e.paragraphFormat)&&!sf.base.isNullOrUndefined(e.paragraphFormat.listFormat)&&!sf.base.isNullOrUndefined(this.documentHelper.getListById(e.paragraphFormat.listFormat.listId))&&e.paragraphFormat.listFormat.listLevelNumber>=0&&e.paragraphFormat.listFormat.listLevelNumber<9&&!t?(this.clearListElementBox(e),this.layoutList(e,this.documentHelper)):e.paragraphFormat.listFormat&&-1===e.paragraphFormat.listFormat.listId&&this.clearListElementBox(e))},i.prototype.layoutList=function(e,t){var i=t.getListById(e.paragraphFormat.listFormat.listId),r=e.paragraphFormat.listFormat.listLevelNumber,n=this.getListLevel(i,r);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.numberFormat)){var o=e.childWidgets[0];sf.base.isNullOrUndefined(o)&&(o=new ma(e),e.childWidgets.push(o));var s=new Va(n,!1);if(s.line=o,"Bullet"===n.listLevelPattern?(s.text=n.numberFormat,this.updateListValues(i,r)):s.text=this.getListNumber(e.paragraphFormat.listFormat),""!==n.numberFormat){if(this.viewer.updateClientWidth(-x.convertPointToPixel(e.paragraphFormat.firstLineIndent)),this.documentHelper.isIosDevice){var a=s.text;(a=a===String.fromCharCode(61623)?String.fromCharCode(9679):a===String.fromCharCode(61551)+String.fromCharCode(32)?String.fromCharCode(9675):a)!==s.text&&(s.text=a)}var l;t.textHelper.updateTextSize(s,e),this.viewer instanceof Qs&&this.viewer.clientActiveArea.height<s.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(l=!0),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+s.width);var d=s;if(o.children.splice(0,0,s),"None"!==n.followCharacter){if(s=new Va(n,!0),"Tab"===n.followCharacter){s.text="\t";var h=o.children.indexOf(s),c=this.getTabWidth(e,this.viewer,h,o,s);t.textHelper.updateTextSize(s,e),s.width=c}else s.text=" ",t.textHelper.updateTextSize(s,e);this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+s.width),o.children.splice(1,0,s),s.line=o}if(sf.base.isNullOrUndefined(e.containerWidget)||!(e.bodyWidget.floatingElements.length>0)||d instanceof La||e.containerWidget instanceof Aa||(this.adjustPosition(d,d.line.paragraph.bodyWidget),this.isYPositionUpdated&&(this.viewer.clientActiveArea.width>d.width+s.width&&(this.viewer.clientActiveArea.width-=d.width+s.width),this.isYPositionUpdated=!1)),l)return this.moveToNextPage(this.viewer,o,void 0,!0),this.cutClientWidth(s),this.hasFloatingElement=!1,void(this.isXPositionUpdated=!1);"None"!==n.followCharacter&&this.viewer.updateClientWidth(x.convertPointToPixel(e.paragraphFormat.firstLineIndent))}}},i.prototype.addBodyWidget=function(e,t){var i;return(i=t||new aa).width=e.width,i.x=e.x,i.y=e.y,i},i.prototype.addListLevels=function(e){for(var t=e.levels.length;t<9;t++){var i=new H(e),r=t%3;"Bullet"===e.levels[0].listLevelPattern?(i.listLevelPattern="Bullet",i.numberFormat=0===r?String.fromCharCode(61623):1===r?String.fromCharCode(61551)+String.fromCharCode(32):String.fromCharCode(61607),i.characterFormat.fontFamily=i.numberFormat===String.fromCharCode(61607)?"Wingdings":"Symbol"):(i.listLevelPattern=this.getListLevelPattern(r),i.numberFormat="%"+(t+1).toString()+".",i.startAt=1,i.restartLevel=t),i.paragraphFormat=new ul(void 0),i.paragraphFormat.leftIndent=48*(t+1),i.paragraphFormat.firstLineIndent=-24,e.levels.push(i)}},i.prototype.addSplittedLineWidget=function(e,t,i){var r=t;if(this.isWrapText)sf.base.isNullOrUndefined(i)||(e.children.splice(r+1,0,i),i.line=e);else{var n=!1,o=e.paragraph,s=[],a=o.childWidgets.indexOf(e);sf.base.isNullOrUndefined(i)||s.push(i);var l=void 0,d=e.children[r];d instanceof al&&0===d.commentType&&0!=r?r-=1:d.isColumnBreak&&sf.base.isNullOrUndefined(d.nextNode)&&(n=!0);for(var h=r+1;h<e.children.length;h++)s.push(e.children[h]);if(s.length>0||n){l=a===o.childWidgets.length-1?new ma(o):o.childWidgets[a+1];for(var c=0;c<s.length;c++)s[c].line=l;s.length>0&&(e.children.splice(r+1,e.children.length-1),!sf.base.isNullOrUndefined(e.layoutedElements)&&e.layoutedElements.length>0&&e.layoutedElements.splice(r+1,e.layoutedElements.length-1),l.children=s.concat(l.children)),-1===o.childWidgets.indexOf(l)&&o.childWidgets.splice(a+1,0,l)}}},i.prototype.addElementToLine=function(e,t){t instanceof Ba&&"Inline"!==t.textWrappingStyle||(this.isWrapText&&(this.isWrapText=!1,this.viewer.clientActiveArea.width=this.viewer.clientArea.right-this.viewer.clientActiveArea.x),this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+t.width)),"Justify"===e.paragraphFormat.textAlignment&&t instanceof Fa&&this.splitTextElementWordByWord(t),t instanceof Da&&(t.line.skipClipImage=!t.isInlineImage)},i.prototype.splitElementForClientArea=function(e,t){if(t.line.children.length>0){var i=t.previousElement,r=t.indexInOwner;t.line.children.length>1&&i&&this.viewer.clientActiveArea.x!==this.viewer.clientArea.x&&(r-=1),this.addSplittedLineWidget(t.line,r)}},i.prototype.splitByWord=function(t,i,r,n,o,s){var a=this.getSplitIndexByWord(this.viewer.clientActiveArea.width,n,o,s,r.scriptType);if(a>0&&a<r.length){var l=t.children.indexOf(r),d=new Fa;if(n=n.substring(a),d.text=n," "===n[0])a+=n.length-(n=x.trimStart(n)).length;if(d.characterFormat.copyFormat(r.characterFormat),d.width=this.documentHelper.textHelper.getWidth(d.text,s,d.scriptType),d.trimEndWidth=d.width,d.characterRange=r.characterRange," "!==r.text&&x.endsWith(r.text)&&s.bidi&&r.characterRange===e.RightToLeft&&!this.isWrapText){var h=this.spitTextElementByWhitespace(r,s);l=t.children.indexOf(h)}r.text=r.text.substr(0,a),r.width=this.documentHelper.textHelper.getWidth(r.text,r.characterFormat,r.scriptType),r.trimEndWidth=r.width,r.revisions.length>0&&(this.updateRevisionForSplittedElement(r,d,!0),d.isMarkedForRevision=r.isMarkedForRevision),d.height=r.height,d.baselineOffset=r.baselineOffset,this.splitErrorCollection(r,d),this.addSplittedLineWidget(t,l,d),this.addElementToLine(i,r),0===r.width&&t.children.splice(l,1)}},i.prototype.spitTextElementByWhitespace=function(i,r){var n=i.line,o=n.children.indexOf(i),s=i.text,a=new Fa,l=s.length-1;return i.text=s.substring(0,l),a.text=s.substring(l),a.characterFormat.copyFormat(i.characterFormat),a.line=n,a.characterRange=e.WordSplit,a.scriptType=t.English,a.height=i.height,a.baselineOffset=i.baselineOffset,a.width=this.documentHelper.textHelper.getWidth(a.text,r,a.scriptType),n.children.splice(o+1,0,a),i.revisions.length>0&&(this.updateRevisionForSplittedElement(i,a,l>0,!0),a.isMarkedForRevision=i.isMarkedForRevision),a},i.prototype.splitErrorCollection=function(e,t){if(e.errorCollection.length>0){for(var i=[],r=e.ignoreOnceItems,n=0;n<e.errorCollection.length;n++)i.push(e.errorCollection[n]);for(var o=0;o<e.errorCollection.length;o++){var s=e.text.indexOf(e.errorCollection[o].text),a=e.errorCollection[o];s<0?(i.splice(0,1),t.errorCollection.push(a)):t.text.indexOf(a.text)>0&&t.errorCollection.push(a)}t.ignoreOnceItems=r,e.ignoreOnceItems=[],e.errorCollection=i}},i.prototype.splitByCharacter=function(e,t,i,r,n){var o=e.paragraph,s="AtLeast"===o.paragraphFormat.lineSpacingType?o.paragraphFormat.afterSpacing:0,a=this.getTextSplitIndexByCharacter(this.viewer.clientArea.width,this.viewer.clientActiveArea.width,i,r,n,t.scriptType);if(!(0===a&&t.previousNode instanceof Da&&"Right"===t.previousNode.textWrappingType)){0===a&&!sf.base.isNullOrUndefined(t)&&t.length>0&&Math.max(t.height,s)<=this.viewer.clientArea.height&&0===this.viewer.clientActiveArea.width&&0===e.children.indexOf(t)&&(a=1);var l=0;if(a<t.length&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,a),n,t.scriptType),i=i.substring(a)),l>this.viewer.clientActiveArea.width&&t.indexInOwner>0)this.addSplittedLineWidget(e,t.indexInOwner-1);else{var d=e.children.indexOf(t);if(a<t.length){var h=new Fa;h.text=i,h.errorCollection=t.errorCollection,t.text=t.text.substr(0,a),h.characterFormat.copyFormat(t.characterFormat),h.width=this.documentHelper.textHelper.getWidth(h.text,n,h.scriptType),h.trimEndWidth=h.width,h.characterRange=t.characterRange,t.width=this.documentHelper.textHelper.getWidth(t.text,n,t.scriptType),t.trimEndWidth=t.width,h.height=t.height,h.baselineOffset=t.baselineOffset,e.children.splice(t.indexInOwner+1,0,h),t.revisions.length>0&&(this.updateRevisionForSplittedElement(t,h,a>0),h.isMarkedForRevision=t.isMarkedForRevision),this.addElementToLine(o,t),this.addSplittedLineWidget(e,d),0===t.width&&e.children.splice(d,1)}else this.addSplittedLineWidget(e,d),this.addElementToLine(o,t)}}},i.prototype.updateRevisionForSplittedElement=function(e,t,i,r){if(e.revisions.length>0)for(var n=0;n<e.revisions.length;n++){var o=e.revisions[n];if(i){t.revisions.push(o),(s=o.range.indexOf(e))<0?o.range.push(t):r?o.range.splice(s,0,t):o.range.splice(s+1,0,t)}else{var s=o.range.indexOf(e);o.range.splice(s,1),o.range.splice(s,0,t),t.revisions.push(o)}}},i.prototype.splitTextElementWordByWord=function(t){var i=t.line,r=i.children.indexOf(t),n=r,o=t.padding.left;t.padding.left=0;var s,a=t.text;if(a.trim().indexOf(" ")>=0){i.children.splice(r,1),s=t.characterFormat;for(var l=t.length-x.trimStart(a).length;l<t.length&&0!==(l=this.getTextIndexAfterSpace(a,l))&&l!==t.length;)if(l<t.length){var d=new Fa,h=a.substring(0,l);if(" "===(a=a.substring(l)).substring(0,1)&&(l+=a.length-x.trimStart(a).length),d.text=h,d.characterFormat.copyFormat(t.characterFormat),d.line=i,d.height=t.height,d.baselineOffset=t.baselineOffset,d.characterRange=t.characterRange,i.children.splice(r,0,d),t.revisions.length>0&&(this.updateRevisionForSplittedElement(t,d,l>0,!0),d.isMarkedForRevision=t.isMarkedForRevision)," "!==d.text&&x.endsWith(d.text)&&s.bidi&&d.characterRange===e.RightToLeft){var c=this.spitTextElementByWhitespace(d,s);r=i.children.indexOf(c)}d.width=this.documentHelper.textHelper.getWidth(d.text,s,d.scriptType),d.trimEndWidth=d.width,t.text=a,t.width=this.documentHelper.textHelper.getWidth(t.text,t.characterFormat,t.scriptType),t.trimEndWidth=t.width,0===t.width&&-1!==i.children.indexOf(t)&&i.children.splice(i.children.indexOf(t),1),l=0,r++}t.text=a,i.children.splice(r,0,t)}i.children[n].padding.left=o},i.prototype.isSplitByHyphen=function(e,t){if(!sf.base.isNullOrUndefined(e.previousElement)&&(e.previousElement instanceof Fa||e.previousElement instanceof Va)){var i=e.previousElement.text;return"-"===t.substring(0,1)&&" "!==i.substring(i.length-1,i.length)}return"-"===t.substring(0,1)},i.prototype.splitTextForClientArea=function(e,t,i,r,n){var o=e.paragraph,s=!0,a=-1;if(" "===i.substring(0,1)||this.isSplitByHyphen(t,i))a=1;else{var l=r,d=0;if(0==(d=x.trimEnd(i).indexOf(" ")+1)&&(d=x.trimEnd(i).indexOf("-")+1),(a=d)>0&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.slice(0,a),n,t.scriptType)),this.viewer.clientActiveArea.width<l&&!this.documentHelper.textHelper.isUnicodeText(i,t.scriptType)&&!this.isWordFittedByJustification(t,l)&&(s=this.checkPreviousElement(e,e.children.indexOf(t))))return}r<=this.viewer.clientActiveArea.width?this.addElementToLine(o,t):s&&(a>0||-1!==i.indexOf(" ")||-1!==i.indexOf("-"))?this.splitByWord(e,o,t,i,r,n):this.splitByCharacter(e,t,i,r,n)},i.prototype.splitByLineBreakOrTab=function(e,t,i,r){var n=t.line.children.indexOf(t),o=t.text,s=o.substring(i),a="\t"===r?new Pa:new Fa;if(a.line=t.line,this.updateRevisionForSplittedElement(t,a,!0),a.characterFormat.copyFormat(t.characterFormat),a.characterRange=t.characterRange,t.line.children.splice(n+1,0,a),i>0&&1===s.length)a.text=o.substring(i),t.text=o.substring(0,i);else if(i>0){a.text=r;var l=new Fa;l.line=t.line,l.text=o.substring(i+1),this.updateRevisionForSplittedElement(t,l,!0),l.characterFormat.copyFormat(t.characterFormat),l.characterRange=t.characterRange,t.line.children.splice(n+2,0,l),t.text=o.substring(0,i)}else""!==s&&(a.text=o.substring(i+1),t.text=r)},i.prototype.moveToNextLine=function(e,t,i){var r=e.paragraph,n=r.paragraphFormat,o=e.isFirstLine(),s=e.isLastLine(),a=0,l=0,d=0,h=0,c=0,p=0,g=n.borders;this.updateLineWidget(e),l=(a=this.maxTextHeight)-this.maxTextBaseline;var f=0,u=!1,m=this.documentHelper.canRenderBorder(r);if(!r.bodyWidget||r.bodyWidget instanceof la||(f=this.documentHelper.pages.indexOf(r.bodyWidget.page)),o&&(h=this.getBeforeSpacing(r,f),p=x.convertPointToPixel(n.firstLineIndent)),s&&(d=x.convertPointToPixel(this.getAfterSpacing(r))),(n.bidi||this.isContainsRtl(e))&&(this.shiftElementsForRTLLayouting(e,n.bidi),this.isRTLLayout=!0),isNaN(this.maxTextHeight)){var y=this.documentHelper.textHelper.measureText("a",r.characterFormat);l=(a=y.Height)-y.BaselineOffset}else l=(a=this.maxTextHeight)-this.maxTextBaseline;c=this.getLineSpacing(r,a),(e.skipClipImage||r.paragraphFormat.lineSpacing>=14||c<0)&&"Exactly"===n.lineSpacingType&&c<l+this.maxBaseline&&(c=l+this.maxBaseline);var v,w=0,b=0,I=n.textAlignment,F=0,C=0;if("Left"!==I&&this.viewer.textWrap&&("Justify"!==I||!s||"Justify"===I&&n.bidi||this.is2013Justification&&s)&&(w=(v=this.getSubWidth(e,"Justify"===I,b,p,s))[0].subWidth,b=v[0].spaceCount,F=v[0].totalSpaceCount,C=v[0].trimmedSpaceWidth,u=e.isEndsWithPageBreak||e.isEndsWithColumnBreak||e.isEndsWithLineBreak||e.paragraph.bidi||this.isRTLLayout),!u&&v&&1===v.length&&this.viewer.clientActiveArea.width>0&&!s&&!this.is2013Justification&&"Justify"===I&&"Word2013"===this.documentHelper.compatibilityMode){var W=this.viewer.clientActiveArea.width,k=this.getTotalSpaceWidth(e),S=0;return S=W/F/(k/F)*100<=33?k/8:k/4,this.viewer.clientActiveArea.x-=S,this.viewer.clientActiveArea.width+=S,this.is2013Justification=!0,void(t?this.splitParagraphForMultiColumn(e,i):(this.moveElementFromNextLine(e),this.nextElementToLayout=e.children[e.children.length-1]))}this.is2013Justification&&s&&w>0&&(w=0,b=0),this.is2013Justification=!1,this.nextElementToLayout=void 0;for(var P=!1,N=0,O=n.lineSpacingType,T=!1,H=e.renderedElements,E=0,R=0,U=0,B=this.viewer.clientArea.x,L=0;L<H.length;L++){var A=0,M=0,z=0,D=H[L];if(!sf.base.isNullOrUndefined(v)&&T&&D.padding.left>0&&v.length>N+1){var V=w;"Justify"===I?V=w*v[N].spaceCount:"Center"===I&&(V=w/2),D.padding.left=D.padding.left-V;var q=v[++N];w=q.subWidth,b=q.spaceCount}if(!(D instanceof Ba&&"Inline"!==D.textWrappingStyle)){T=!0;var _=this.alignLineElements(D,A,M,l,P,w,I,b,L===H.length-1);if("Justify"===I&&D instanceof Ba&&"Inline"===D.textWrappingStyle&&0!==w&&(D.x=B,D instanceof La))for(var j=0;j<D.textFrame.childWidgets.length;j++){var G=(Y=D.textFrame.childWidgets[j]).bidi?Y.rightIndent:Y.leftIndent;Y.x=B+x.convertPointToPixel(G+D.textFrame.marginLeft)}B+=D.width,e.maxBaseLine=this.maxBaseline,A=_.topMargin,M=_.bottomMargin,P=_.addSubWidth,b=_.whiteSpaceCount,"Multiple"===O?c>a?M+=c-a:A+=c-a:("Exactly"===O||c>A+D.height+M)&&(A+=c-(A+D.height+M)),f>0&&r===r.bodyWidget.childWidgets[0]&&this.documentHelper.pages[f].sectionIndex===this.documentHelper.pages[f-1].sectionIndex?A+=0:A+=h,"None"!=g.top.lineStyle&&e.isFirstLine()&&!m.skipTopBorder&&(A+=x.convertPointToPixel(g.top.lineWidth+g.top.space)),"None"!=g.bottom.lineStyle&&e.isLastLine()&&!m.skipBottomBorder&&(M+=x.convertPointToPixel(g.bottom.lineWidth+g.bottom.space)),M+=d;var K=L>0?H[L-1]:void 0;if((0===L||!(D instanceof Ba&&"Inline"!==D.textWrappingStyle)&&K instanceof Ba&&"Inline"!==K.textWrappingStyle&&K.indexInOwner<D.indexInOwner||D.padding.left>0)&&(e.height=A+D.height+M,"Right"===I||"Justify"===I&&n.bidi&&(s||C<0)?z=C<0?C:w:"Center"===I&&(z=w<0?w:w/2)),D.margin=new na(z,A,0,M),D.line=e,E<D.height&&(E=D.height,R=D.margin.bottom,U=D.margin.top),D instanceof La&&"Inline"===D.textWrappingStyle){if(0!==L||D.margin.left>0){var X=H[0].margin.left;D.x+=X;for(var J=0;J<D.textFrame.childWidgets.length;J++){var Y;(Y=D.textFrame.childWidgets[J])instanceof ga?Y.updateChildWidgetLeft(Y.x+X,!0):Y.x+=X}}this.updateShapeYPosition(D)}}}if(e.margin=new na(0,U,0,R),this.adjustPositionBasedOnTopAndBottom(e),this.checkInbetweenShapeOverlap(e),!t&&e.isLastLine()&&0===e.indexInOwner&&e.paragraph.paragraphFormat.widowControl){var Z=e.paragraph.previousSplitWidget;if(!sf.base.isNullOrUndefined(Z)&&!Z.isEndsWithPageBreak&&!Z.isEndsWithColumnBreak&&0!==Z.indexInOwner){var Q=Z.childWidgets.length-1;2===Z.childWidgets.length&&(Q=0),this.splitParagraph(Z,Q,e.paragraph),this.updateClientAreaForNextBlock(e,e.paragraph)}}else t&&this.splitParagraphForMultiColumn(e,i);t||this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height),this.wrapPosition=[]},i.prototype.updateShapeYPosition=function(e){if(e.margin.top>0){e.y+=e.margin.top;for(var t=0;t<e.textFrame.childWidgets.length;t++)e.textFrame.childWidgets[t].y+=e.margin.top}},i.prototype.splitParagraphForMultiColumn=function(e,t){if(this.splitParagraph(e.paragraph,t,void 0),sf.base.isNullOrUndefined(e.paragraph.previousRenderedWidget)&&0==t||!sf.base.isNullOrUndefined(e.paragraph.previousRenderedWidget)&&e.paragraph.previousRenderedWidget.bodyWidget.sectionIndex!==e.paragraph.bodyWidget.sectionIndex?this.moveBlocksToNextPage(e.paragraph):this.moveBlocksToNextPage(e.paragraph.previousRenderedWidget),this.viewer.updateClientArea(e.paragraph.bodyWidget,e.paragraph.bodyWidget.page),this.viewer.clientActiveArea.y=e.paragraph.bodyWidget.y,e.paragraph.bodyWidget.sectionFormat.equalWidth){var i=e.paragraph;this.documentHelper.blockToShift=i,this.shiftLayoutedItems(!1)}},i.prototype.getBodyWidget=function(e,t){if(t)for(;e&&0!==e.columnIndex;)e=e.previousRenderedWidget;else for(;e&&!sf.base.isNullOrUndefined(e.nextRenderedWidget)&&e.columnIndex!==e.sectionFormat.numberOfColumns-1&&e.index===e.nextRenderedWidget.index;)e=e.nextRenderedWidget;return e},i.prototype.checkInbetweenShapeOverlap=function(e,t){var i=this;if(!(e.paragraph.containerWidget instanceof Aa)&&e.paragraph.bodyWidget){var r,n=this.getLineY(e),o=e.paragraph.isInsideTable,s=e.paragraph.y,a=!0;sf.base.isNullOrUndefined(t)&&(a=!1,t=e.paragraph.bodyWidget.floatingElements),t.sort((function(e,t){return e.y-t.y})),t.forEach((function(t){if(!(o&&t.line&&!t.line.paragraph.isInsideTable||sf.base.isNullOrUndefined(t.line))){var l;l="TopAndBottom"===t.textWrappingStyle&&t instanceof Da&&!e.paragraph.isEmpty()?new ia(e.paragraph.x,i.viewer.clientActiveArea.y,e.paragraph.width,e.children[0].height):new ia(e.paragraph.x,i.viewer.clientActiveArea.y,e.paragraph.width,e.height);var d=new ia(t.x,t.y-t.distanceTop,t.width,t.height);if(!(t.line&&i.isRelayout&&!i.isRelayoutOverlap&&i.viewer.documentHelper.selection.isExistAfter(t.line.paragraph,e.paragraph)||i.isRelayout&&i.isRelayoutOverlap&&i.viewer.documentHelper.selection.isExistAfter(t.line.paragraph,i.endOverlapWidget))){var h="TopAndBottom"===t.textWrappingStyle,c=t.y+t.height+t.distanceBottom-n;r&&h&&r.y+r.height+r.distanceBottom+e.height>t.y-t.distanceTop&&r.y-r.distanceTop<t.y-t.distanceTop&&t.y+t.height+t.distanceBottom>r.y+r.height+r.distanceBottom?(r=t,e.paragraph.isEmpty()&&a?(e.paragraph.y=s,e.paragraph.y+=c):e.marginTop=c):h&&!r&&l.isIntersecting(d)&&(r=t,e.paragraph.isEmpty()&&a?e.paragraph.y+=c:e.marginTop=c)}}})),r?this.viewer.cutFromTop(r.y+r.height+r.distanceBottom):this.isRelayoutOverlap&&(e.marginTop=0)}},i.prototype.getLineY=function(e){var t=e.paragraph,i=t.y;if(!t.isEmpty())for(var r=t.firstChild;r!==e;)i=i+r.height+r.marginTop,r=r.nextLine;return i},i.prototype.updateLineWidget=function(e){for(var t=0,i=0,r=!1,n=!1,o=0;o<e.children.length;o++){var s=e.children[o];if(s instanceof va&&2===s.fieldType&&(n=!1),!(n||(s instanceof va&&0===s.fieldType&&(n=!0),s instanceof Ba&&"Inline"!==s.textWrappingStyle)))if(s instanceof Fa&&0===s.text.replace(/\s+/g,"").length&&s.text!==String.fromCharCode(160))t<s.height&&(t=s.height,i=s.baselineOffset);else if(s instanceof Fa||s instanceof Va){var a=s.height,l=s.baselineOffset,d=!1;s instanceof Fa&&s.isCheckBoxElement&&!sf.base.isNullOrUndefined(s.previousNode)&&s.previousNode instanceof Oa&&("Cell"===s.previousNode.contentControlWidgetType||"Inline"===s.previousNode.contentControlWidgetType)&&(d=!0),s instanceof Fa&&s.isCheckBoxElement&&!d&&(a/=1.35,l/=1.35),this.maxTextHeight<a&&(this.maxTextHeight=a,this.maxTextBaseline=l),this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)}else this.maxBaseline<s.height&&(this.maxBaseline=s.height,s instanceof Da&&(r=!0))}if(0===this.maxTextHeight&&0!==t)if(r)this.maxTextHeight=0,this.maxTextBaseline=0;else{if(e.isLastLine()&&this.documentHelper.selection){var h=this.documentHelper.selection.getParagraphMarkSize(e.paragraph,0,0);this.maxTextHeight=h.height,this.maxTextBaseline=i}else this.maxTextHeight=t,this.maxTextBaseline=i;this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)}},i.prototype.moveToNextPage=function(e,t,i,r){if(!this.isFootNoteLayoutStart){var n,o=t.paragraph,s=!1,a=!1;if(o&&(sf.base.isNullOrUndefined(o.containerWidget)||sf.base.isNullOrUndefined(o.containerWidget.containerWidget)||!(o.containerWidget.containerWidget instanceof ha))){var l=0;if(o instanceof ha)return;if(!sf.base.isNullOrUndefined(t)&&(0!==(l=o.childWidgets.indexOf(t))&&((!o.paragraphFormat.keepLinesTogether||sf.base.isNullOrUndefined(o.previousWidget)||t.previousLine.isEndsWithColumnBreak)&&(1!=l||t.previousLine.isEndsWithPageBreak||t.previousLine.isEndsWithColumnBreak||!o.paragraphFormat.widowControl||sf.base.isNullOrUndefined(o.previousWidget))||(l=0,s=!0)),(l>0||i)&&(o.height=e.clientActiveArea.y-o.y),0===l&&!o.isEndsWithPageBreak&&!o.isEndsWithColumnBreak)){var d=this.alignBlockElement(o);sf.base.isNullOrUndefined(d.node)||(l=(n=d.node instanceof fa?this.splitRow(d.node):d.node)instanceof ga?0:parseInt(d.position.index,10),s=!1,a=!0,(o=n)instanceof ca?this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!o.paragraphFormat.keepWithNext&&!r&&this.viewer.owner.editorModule.updateWholeListItems(o):this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!r&&this.viewer.owner.editorModule.updateWholeListItems(o))}if(sf.base.isNullOrUndefined(o.bodyWidget)||sf.base.isNullOrUndefined(o.bodyWidget.containerWidget)||o.bodyWidget.containerWidget instanceof ha||void 0===o.bodyWidget.page.footnoteWidget||this.layoutfootNote(o.bodyWidget.page.footnoteWidget),this.isMultiColumnSplit){var h=this.viewer.columnLayoutArea.getNextColumnByBodyWidget(o.bodyWidget);if(sf.base.isNullOrUndefined(h))return}var c=o.bodyWidget.page;i&&0===l&&!sf.base.isNullOrUndefined(o.bodyWidget.lastChild)&&o===o.bodyWidget.lastChild&&this.endOverlapWidget&&(this.isRelayoutOverlap=!1);var p=this.moveBlocksToNextPage(o,0===l,l);if(c!==p.page&&this.viewer.updateClientArea(p,p.page),this.viewer.updateClientAreaForBlock(o,!0),l>0){if(t.isLastLine()&&i)return;var g=void 0;g=p.firstChild instanceof ca&&p.firstChild.equals(o)?p.firstChild:new ca,(g=this.moveChildsToParagraph(o,l,g)).containerWidget=p;for(var f=0;f<g.floatingElements.length;f++){var u=g.floatingElements[f];u.line.paragraph.bodyWidget!==o.bodyWidget&&"Inline"!==u.textWrappingStyle&&o.bodyWidget.floatingElements.splice(o.bodyWidget.floatingElements.indexOf(u),1)}var m=this.getFootNoteWidgetsOf(g);this.moveFootNotesToPage(m,o.bodyWidget,p),o=g,this.viewer.clientActiveArea.height-=this.getFootNoteHeight(m)}else i||(o.containerWidget.removeChild(o.indexInOwner),o instanceof ca&&o.floatingElements.length>0&&this.addRemoveFloatElementsFromBody(o,o.containerWidget,!1));if(!i){if(-1===p.childWidgets.indexOf(o)&&(p.childWidgets.splice(0,0,o),o instanceof ca&&o.floatingElements.length>0&&this.addRemoveFloatElementsFromBody(o,p,!0)),o.containerWidget=p,this.viewer.updateClientAreaLocation(o,this.viewer.clientActiveArea),s||a){o.bodyWidget.page.footnoteWidget&&this.layoutfootNote(o.bodyWidget.page.footnoteWidget),(t.paragraph!==o||o.paragraphFormat.widowControl&&this.isImagePresent(o))&&(o instanceof ga&&this.clearTableWidget(o,!0,!0,!1),this.layoutBlock(o,0,!0),e.updateClientAreaForBlock(o,!1));var y=t.paragraph;if(a){var v=o.nextWidget;if(!sf.base.isNullOrUndefined(v))do{if(e.updateClientAreaForBlock(v,!0),v===y){this.viewer.updateClientAreaLocation(v,this.viewer.clientActiveArea);break}v instanceof ga&&this.clearTableWidget(v,!0,!0,!1),this.layoutBlock(v,0,!0),e.updateClientAreaForBlock(v,!1),v=v.nextWidget}while(v)}this.updateClientAreaForNextBlock(t,y)}if(t.isFirstLine()&&0===t.indexInOwner&&!(t.children[0]instanceof Va)){var w=-x.convertPointToPixel(t.paragraph.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(w)}}}if(i||this.updateShapeBaseLocation(o),this.isRelayoutOverlap&&this.endOverlapWidget&&(!this.skipRelayoutOverlap||this.endOverlapWidget instanceof ga&&this.endOverlapWidget.wrapTextAround)){var b=this.endOverlapWidget.previousRenderedWidget,I=t.paragraph;for(this.startOverlapWidget=I,I=(t=this.endOverlapWidget.childWidgets[0]).paragraph;I;)I.floatingElements.forEach((function(e){-1!==b.bodyWidget.floatingElements.indexOf(e)&&"Inline"!==e.textWrappingStyle&&(b.bodyWidget.floatingElements.splice(b.bodyWidget.floatingElements.indexOf(e),1),t.paragraph.bodyWidget.floatingElements.push(e))})),I=I!==this.endOverlapWidget?I.nextWidget:void 0;this.layoutStartEndBlocks(this.startOverlapWidget,this.endOverlapWidget),this.startOverlapWidget=void 0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-this.endOverlapWidget.y,this.viewer.clientActiveArea.y=this.endOverlapWidget.y}}},i.prototype.isImagePresent=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.children.length;r++)if(i.children[r]instanceof Da)return!0;return!1},i.prototype.updateShapeBaseLocation=function(e){if(e instanceof ca&&e.floatingElements.length>0)for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],r=this.getFloatingItemPoints(i);i.y=r.y,i.x=r.x,i instanceof La&&this.updateChildLocationForCellOrShape(i.y,i)}},i.prototype.moveChildsToParagraph=function(e,t,i){i=this.addParagraphWidget(this.viewer.clientActiveArea,i);for(var r=0,n=t;n<e.childWidgets.length;n++){var o=e.childWidgets[n];o.paragraph=i,i.childWidgets.splice(r,0,o),o.paragraph=i,r++}i.paragraphFormat=e.paragraphFormat,i.characterFormat=e.characterFormat,i.index=e.index,e.childWidgets.splice(t);for(n=0;n<e.floatingElements.length;n++){var s=e.floatingElements[n];s.line.paragraph!==e&&(i.floatingElements.push(s),e.floatingElements.splice(e.floatingElements.indexOf(s),1),n--)}return i},i.prototype.addRemoveFloatElementsFromBody=function(e,t,i){if(e.floatingElements.length>0)for(var r=0;r<e.floatingElements.length;r++)i?-1===t.floatingElements.indexOf(e.floatingElements[r])&&"Inline"!==e.floatingElements[r].textWrappingStyle&&t.floatingElements.push(e.floatingElements[r]):-1!==t.floatingElements.indexOf(e.floatingElements[r])&&t.floatingElements.splice(t.floatingElements.indexOf(e.floatingElements[r]),1)},i.prototype.alignBlockElement=function(e){if(e instanceof ca&&(e.isEndsWithPageBreak||e.isEndsWithColumnBreak))return{node:void 0,position:{index:""}};for(var t,i=0,r=this.getPreviousBlock(e);r;){if(r instanceof ca){if(!r.paragraphFormat.keepWithNext||r.isEndsWithPageBreak||r.isEndsWithColumnBreak)break;if(t=r,r.paragraphFormat.keepLinesTogether)sf.base.isNullOrUndefined(this.getPreviousBlock(r))?t=void 0:i=0;else if(sf.base.isNullOrUndefined(this.getPreviousBlock(r))&&1===r.childWidgets.length)t=void 0;else if(r.paragraphFormat.widowControl){if((1===(i=r.lastChild.indexInOwner-1)||i<0)&&(i=0),0!==i)break}else i=r.lastChild.indexInOwner}else if(r instanceof fa){var n=r.childWidgets[0];if(!(n.childWidgets.length>0))break;var o=this.documentHelper.getFirstParagraphInCell(n);if(!o.paragraphFormat.keepWithNext)break;o.paragraphFormat.keepWithNext&&(sf.base.isNullOrUndefined(this.getPreviousBlock(r))?t=void 0:i=(t=r).indexInOwner)}r=this.getPreviousBlock(r)}return!sf.base.isNullOrUndefined(t)&&t instanceof ca&&0===t.indexInOwner&&t.paragraphFormat.keepWithNext&&t.paragraphFormat.widowControl&&(t=e),{node:t,position:{index:i.toString()}}},i.prototype.getPreviousBlock=function(e){var t;return e instanceof ca?(t=e.previousWidget,!this.isInitialLoad&&sf.base.isNullOrUndefined(t)&&e.containerWidget instanceof aa&&!sf.base.isNullOrUndefined(e.containerWidget.previousRenderedWidget)&&e.containerWidget.sectionIndex===e.containerWidget.previousRenderedWidget.sectionIndex&&!sf.base.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof ca&&(t=e.previousRenderedWidget)):e instanceof fa&&(t=e.previousWidget,sf.base.isNullOrUndefined(t)&&(t=e.ownerTable.previousWidget)),t instanceof ga&&(t=t.lastChild),t},i.prototype.splitRow=function(e){var t=e.ownerTable;if(0===e.indexInOwner)return t;for(var i=this.createTableWidget(t),r=e.indexInOwner;r<t.childWidgets.length;){var n=t.childWidgets.splice(r,1)[0];i.childWidgets.push(n),n.containerWidget=i,t.height-=n.height,i.height+=n.height}return t.containerWidget.childWidgets.splice(t.indexInOwner+1,0,i),i.containerWidget=t.containerWidget,i},i.prototype.splitParagraph=function(e,t,i){if(0===t&&sf.base.isNullOrUndefined(i))return e;var r=!1;if(sf.base.isNullOrUndefined(i))(i=new ca).containerWidget=e.containerWidget,e.containerWidget.childWidgets.splice(e.indexInOwner+1,0,i),i.paragraphFormat=e.paragraphFormat,i.characterFormat=e.characterFormat,i.index=e.index;else if(0===t){r=!0;var n=e;e=i,i=n}for(var o=0,s=t;s<e.childWidgets.length;s++){var a=e.childWidgets[s];a.paragraph=i,r?i.childWidgets.push(a):i.childWidgets.splice(o,0,a),i.height+=a.height,e.height-=a.height,a.paragraph=i,o++}return i.width=e.width,r?(i.containerWidget.childWidgets.splice(i.indexInOwner,1),i.y=e.y,i.x=e.x,i.containerWidget=e.containerWidget,e.containerWidget.childWidgets.unshift(i)):e.childWidgets.splice(t),(0===e.childWidgets.length||r)&&e.containerWidget.childWidgets.splice(e.indexInOwner,1),i},i.prototype.updateClientPositionForBlock=function(e,t){var i=e instanceof fa?e.ownerTable:e,r=!1;do{if(this.viewer.updateClientAreaForBlock(i,!0),i instanceof ca){if(t instanceof ca&&t.equals(i)){r=!0;break}this.addParagraphWidget(this.viewer.clientActiveArea,i),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+i.height),this.viewer.updateClientAreaForBlock(i,!1)}else if(i instanceof ga){"Word2013"===this.documentHelper.compatibilityMode||i.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-x.convertPointToPixel(i.firstChild.firstChild.leftMargin)),this.addTableWidget(this.viewer.clientActiveArea,[i]);var n=i.firstChild;if(t instanceof fa&&i.equals(t.ownerTable)&&!sf.base.isNullOrUndefined(n))do{if(n.equals(t)){r=!0;break}this.addTableRowWidget(this.viewer.clientActiveArea,[n]),this.updateChildLocationForRow(this.viewer.clientActiveArea.y,n),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+n.height),i.height+=n.height,n=n.nextWidget}while(n);else this.updateChildLocationForTable(i.y,i),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+i.height),this.viewer.updateClientAreaForBlock(i,!1)}i=i.nextWidget}while(i&&!r)},i.prototype.updateClientAreaForNextBlock=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];if(e===r)break;this.updateShapeBaseLocation(t),this.checkInbetweenShapeOverlap(r),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r.height)}},i.prototype.layoutStartEndBlocks=function(e,t){var i,r=e;for(this.isOverlapFloatTable=!0,this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-e.y,this.viewer.clientActiveArea.y=e.y,i=e instanceof ga?this.documentHelper.getFirstParagraphInFirstCell(e):e,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(i);r;){this.viewer.updateClientAreaForBlock(r,!0),r instanceof ca?this.layoutParagraph(r,0):(this.clearTableWidget(r,!0,!0,!0),this.layoutTable(r,0)),this.viewer.updateClientAreaForBlock(r,!1);var n=!sf.base.isNullOrUndefined(r.nextWidget)&&r.nextWidget instanceof ga&&r.nextWidget===t&&"Paragraph"===r.nextWidget.positioning.verticalOrigin;r=r===t||n?void 0:r.nextWidget}},i.prototype.alignLineElements=function(e,t,i,r,n,o,s,a,l){if(e.width>0&&(e instanceof Fa||e instanceof Va)){var d=e instanceof Fa?e:void 0,h=e instanceof Fa?d.baselineOffset:e.baselineOffset;if(t+=this.maxBaseline-h,i+=r-(e.height-h),!sf.base.isNullOrUndefined(d)&&"Justify"===s&&a>0){var c=d.width,p=d.text;if(n||(n=(p=x.trimStart(p)).length>0),n){var g=p.length-x.removeSpace(p).length;l&&(g-=p.length-x.trimEnd(p).length),a<g&&(c=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(p,d.characterFormat,d.scriptType),g=a),g>0&&(d.width=c+o*g,a-=g)}}}else n=!0,t+=this.maxBaseline-e.height,i+=r;return{topMargin:t,bottomMargin:i,addSubWidth:n,whiteSpaceCount:a}},i.prototype.updateWidgetToPage=function(e,t){if(t.isInsideTable){var i=t.associatedCell;if(t.height=e.clientActiveArea.y-t.y,sf.base.isNullOrUndefined(t.associatedCell)||sf.base.isNullOrUndefined(t.associatedCell.ownerRow)||sf.base.isNullOrUndefined(t.associatedCell.ownerRow.rowFormat))return;"Exactly"===t.associatedCell.ownerRow.rowFormat.heightType?i.height=x.convertPointToPixel(t.associatedCell.ownerRow.rowFormat.height):[i].length<=1&&"AtLeast"===t.associatedCell.ownerRow.rowFormat.heightType?i.height=Math.max(x.convertPointToPixel(t.associatedCell.ownerRow.rowFormat.height),this.getCellContentHeight(i)):i.height=i.height+t.height,t.containerWidget=i}else(!t.isEndsWithPageBreak&&!t.isEndsWithColumnBreak||e instanceof $s)&&(t.height=e.clientActiveArea.y-t.y);this.isRelayoutFootnote&&t.bodyWidget instanceof ha&&(t.isInsideTable||(t.containerWidget.height+=t.height),this.shiftFootnoteChildLocation(t.bodyWidget,this.viewer)),t.bodyWidget instanceof la&&(t.isInsideTable||(t.containerWidget.height+=t.height),this.viewer.owner.enableHeaderAndFooter&&-1!==t.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(t.bodyWidget,this.viewer)),e instanceof $s&&t.containerWidget instanceof aa&&(t.containerWidget.height+=t.height)},i.prototype.shiftFooterChildLocation=function(e,t){var i=e.page.bodyWidgets[0].sectionFormat.pageHeight;if(-1!==e.headerFooterType.indexOf("Footer")){var r,n=e.page.bodyWidgets[0].sectionFormat.footerDistance,o=x.convertPointToPixel(i-n);e.y+e.height>o?r=o-(e.y+e.height):e.y+e.height<o&&(r=e.y+e.height-o),sf.base.isNullOrUndefined(r)||(r=o-(e.y+e.height),this.shiftChildLocation(r,e),t.clientActiveArea.y+=r)}},i.prototype.shiftFootnoteChildLocation=function(e,t){var i,r=e.page.bodyWidgets[0].sectionFormat.pageHeight,n=(e.page.bodyWidgets[0].sectionFormat.footerDistance,e.page.bodyWidgets[0].sectionFormat.bottomMargin),o=x.convertPointToPixel(r-n);e.y+e.height>o?i=o-(e.y+e.height):e.y+e.height<o&&(i=e.y+e.height-o),sf.base.isNullOrUndefined(i)||(i=o-(e.y+e.height),this.shiftChildLocation(i,e),t.clientActiveArea.y+=i)},i.prototype.checkPreviousElement=function(e,t){for(var i=e.paragraph,r=!1,n=0,o=t-1;o>=0;o--){var s=e.children[o];if(s instanceof Fa&&s.width>0){var a=s.text;if(n=o,a.length>0&&(" "===a[a.length-1]||"-"===a[a.length-1])){if(o===t-1)return this.addSplittedLineWidget(e,t-1),!0;r=!0;break}if("\t"===a||this.documentHelper.textHelper.isUnicodeText(a,s.scriptType))return!1;if(a.indexOf(" ")>=0){r=!0;var l=a.lastIndexOf(" ")+1,d=new Fa;d.text=a.substr(l),d.characterFormat.copyFormat(s.characterFormat),d.characterRange=s.characterRange,s.revisions.length>0&&(this.updateRevisionForSplittedElement(s,d,l>0),d.isMarkedForRevision=s.isMarkedForRevision),s.text=a.substr(0,l),this.documentHelper.textHelper.getTextSize(d,s.characterFormat),s.width-=d.width,s.trimEndWidth=s.width,s.height=d.height,0===s.width&&(e.children.splice(o,1),!sf.base.isNullOrUndefined(e.layoutedElements)&&e.layoutedElements.length>0&&e.layoutedElements.splice(o,1)),e.children.splice(o+1,0,d),sf.base.isNullOrUndefined(e.layoutedElements)||e.layoutedElements.splice(o+1,0,d);break}}else if(!(s instanceof Va||s instanceof va||s instanceof Fa&&0===s.width||s instanceof al||s instanceof Oa)){n=o,r=!0;break}}if(r&&++n<e.children.length){var h=0;for(o=n;o<e.children.length;o++)h+=e.children[o].width,this.addSplittedLineWidget(e,o-1),o--;"Justify"===i.paragraphFormat.textAlignment&&"Word2013"===this.documentHelper.compatibilityMode||this.viewer.updateClientWidth(h)}return r},i.prototype.clearListElementBox=function(e){if(0!==e.childWidgets.length){var t=e.childWidgets[0];if(!sf.base.isNullOrUndefined(t.children)){for(var i=t.children.length-1;i>0&&t.children[i]instanceof Va;i--)t.children.splice(i,1);for(i=0;i<t.children.length&&t.children[i]instanceof Va;i++)t.children.splice(i,1),i--}}},i.prototype.getListNumber=function(e,t){var i=this.documentHelper.getListById(e.listId),r=e.listLevelNumber,n=this.getListLevel(i,e.listLevelNumber),o=sf.base.isNullOrUndefined(i.levelOverrides)?void 0:i.levelOverrides[r];if(!sf.base.isNullOrUndefined(o)&&-1===this.documentHelper.renderedLevelOverrides.indexOf(o)&&sf.base.isNullOrUndefined(o.overrideListLevel)){this.documentHelper.renderedLevelOverrides.push(o);var s=this.documentHelper.getAbstractListById(i.abstractListId);if(this.documentHelper.renderedLists.containsKey(s)){var a=this.documentHelper.renderedLists.get(s);a.containsKey(r)&&(a.remove(r),this.ClearSubListLevelValues(i,s,r))}}return sf.base.isNullOrUndefined(t)&&this.updateListValues(i,r),this.getListText(i,r,n)},i.prototype.ClearSubListLevelValues=function(e,t,i){for(var r=this.documentHelper.renderedLists.get(t),n=i+1;n<t.levels.length;){var o=this.getListLevel(e,n);r.containsKey(n)&&o.restartLevel>i&&r.remove(n),n++}},i.prototype.getListStartValue=function(e,t){var i=sf.base.isNullOrUndefined(t.levelOverrides)?void 0:t.levelOverrides[e];if(!sf.base.isNullOrUndefined(i)&&sf.base.isNullOrUndefined(i.overrideListLevel))return i.startAt;var r=this.getListLevel(t,e);return sf.base.isNullOrUndefined(r)?0:r.startAt},i.prototype.updateListValues=function(e,t){var i=this.documentHelper.getAbstractListById(e.abstractListId),r=this.getListLevel(e,t);if(this.documentHelper.renderedLists.containsKey(i)){var n=this.documentHelper.renderedLists.get(i);if(n.containsKey(t)){var o=n.get(t);n.set(t,o+1);for(var s=t+1;s<this.documentHelper.getAbstractListById(e.abstractListId).levels.length;){d=this.getListLevel(e,s);n.containsKey(s)&&(d.restartLevel>t||"Bullet"===r.listLevelPattern)&&n.remove(s),s++}}else{for(s=t;!n.containsKey(s-1)&&s>0;){d=this.getListLevel(e,s-1);n.add(s-1,this.getListStartValue(s-1,e)),s--}o=this.getListStartValue(t,e);n.add(t,o)}}else{var l=new a;this.documentHelper.renderedLists.add(i,l);for(var d=this.getListLevel(e,t),h=0;h<=t;h++)l.add(h,this.getListStartValue(h,e))}},i.prototype.getListText=function(e,t,i){var r=i.numberFormat;if(this.documentHelper.renderedLists.containsKey(this.documentHelper.getAbstractListById(e.abstractListId)))for(var n=this.documentHelper.renderedLists.get(this.documentHelper.getAbstractListById(e.abstractListId)),o=n.keys,s=0;s<o.length;s++){var a=o[s],l="%"+(a+1).toString(),d=this.getListLevel(e,a),h=s<t?"LeadingZero"!==d.listLevelPattern?"Arabic":d.listLevelPattern:void 0;if(r.match(l)){if(a>t)return"";r=n.containsKey(a)&&!sf.base.isNullOrUndefined(d)?r.replace(l,this.getListTextListLevel(d,n.get(a),i.isLegalStyleNumbering?h:void 0)):r.replace(l,"0")}}return r},i.prototype.getAsLetter=function(e){var t=e/26,i=e%26;0===i&&(i=26,t--);for(var r=String.fromCharCode(64+i),n="";t>=0;)n+=r.toString(),t--;return n},i.prototype.getListTextListLevel=function(e,t,i){switch(sf.base.isNullOrUndefined(i)?e.listLevelPattern:i){case"UpRoman":return this.getAsRoman(t).toUpperCase();case"LowRoman":return this.getAsRoman(t).toLowerCase();case"UpLetter":return this.getAsLetter(t).toUpperCase();case"LowLetter":return this.getAsLetter(t).toLowerCase();case"Arabic":return t.toString();case"LeadingZero":return this.getAsLeadingZero(t);case"Number":return t.toString();case"OrdinalText":return 3082===e.characterFormat.localeIdAscii||3082===this.documentHelper.characterFormat.localeIdAscii?this.getOrdinalTextInSpanish(!0,t.toString()).toUpperCase():this.getOrdinalText(!0,t.toString()).toUpperCase();case"Ordinal":return this.getAsOrdinal(t,e.characterFormat).toString();case"FarEast":case"Special":return t.toString();default:return""}},i.prototype.getFootEndNote=function(e,t){switch(e){case"UpperCaseRoman":return this.getAsRoman(t).toUpperCase();case"LowerCaseRoman":return this.getAsRoman(t).toLowerCase();case"UpperCaseLetter":return this.getAsLetter(t).toUpperCase();case"LowerCaseLetter":return this.getAsLetter(t).toLowerCase();default:return t.toString()}},i.prototype.generateNumber=function(e,t,i){for(var r="";e>=t;)e-=t,r+=i,this.value=e;return r.toString()},i.prototype.getAsLeadingZero=function(e){return e<10?"0"+e.toString():e.toString()},i.prototype.getAsRoman=function(e){var t="";return this.value=e,t+=this.generateNumber(this.value,1e3,"M"),t+=this.generateNumber(this.value,900,"CM"),t+=this.generateNumber(this.value,500,"D"),t+=this.generateNumber(this.value,400,"CD"),t+=this.generateNumber(this.value,100,"C"),t+=this.generateNumber(this.value,90,"XC"),t+=this.generateNumber(this.value,50,"L"),t+=this.generateNumber(this.value,40,"XL"),t+=this.generateNumber(this.value,10,"X"),t+=this.generateNumber(this.value,9,"IX"),t+=this.generateNumber(this.value,5,"V"),t+=this.generateNumber(this.value,4,"IV"),(t+=this.generateNumber(this.value,1,"I")).toString()},i.prototype.getOrdinalText=function(e,t){if(e){t=t.trim();for(var i=0;i<t.length;i++)if(/[a-zA-Z]/.test(t.charAt(i))){e=!1;break}e&&(t=this.numberToWords(parseInt(t),!1))}return t},i.prototype.numberToWords=function(e,t){if(0===e)return"zero";var i="";if(Math.floor(e/1e6)>0&&(i+=this.numberToWords(Math.floor(e/1e6),t)+" million ",t||e%10!=0||(i+="th "),e%=1e6),Math.floor(e/1e3)>0&&(i+=this.numberToWords(Math.floor(e/1e3),t)+" thousand ",t||e%10!=0||(i+="th "),e%=1e3),Math.floor(e/100)>0&&(i+=this.numberToWords(Math.floor(e/100),t)+" hundred ",t||e%10!=0||(i+="th "),e%=100),e>0){""!==i&&t&&(i+="and ");var r=null;r=t?["","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen","seventeen","eighteen","nineteen"]:["","first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth","eleventh","twelfth","thirteenth","fourteenth","fifteenth","sixteenth","seventeenth","eighteenth","nineteenth"];e<20?i+=r[e]:((t||e%10>0)&&(i+=["","ten","twenty","thirty","forty","fifty","sixty","seventy","eighty","ninety"][Math.floor(e/10)]),e%10!=0||t?e%10>0&&(i+="-"+r[e%10]):i+=["","tenth","twentieth","thirtieth","fortieth","fiftieth","sixtieth","seventieth","eightieth","ninetieth"][Math.floor(e/10)])}return i},i.prototype.getOrdinalTextInSpanish=function(e,t){if(e){t=t.trim();for(var i=0;i<t.length;i++)if(/[a-zA-Z]/.test(t.charAt(i))){e=!1;break}e&&(t=this.numberToSpanishWords(parseInt(t),!1))}return t},i.prototype.numberToSpanishWords=function(e,t){if(0===e&&t)return"cero";var i="";if(Math.floor(e/1e3)>0&&e<=1e4){i+=t?["","mil","dos mil","tres mil","cuatro mil","cinco mil","seis mil","siete mil","ocho mil","nueve mil","diez mil"][Math.floor(e/1e3)]:["","milésimo","dosmilésimo","tresmilésimo","cuatromilésimo","cincomilésimo","seismilésimo","sietemilésimo","ochomilésimo","nuevemilésimo","diezmilésimo"][Math.floor(e/1e3)],e%=1e3}if(Math.floor(e/100)>0){""!==i&&(i+=" ");i+=t?["","ciento","doscientos","trescientos","cuatrocientos","quinientos","seiscientos","setecientos","ochocientos","novecientos"][Math.floor(e/100)]:["","centésimo","ducentésimo","tricentésimo","cuadringentésimo","quingentésimo","sexcentésimo","septingentésimo","octingentésimo","noningentésimo"][Math.floor(e/100)],e%=100}if(e>0&&e<100){""!==i&&(i+=" ");var r=null;r=t?["","uno","dos","tres","cuatro","cinco","seis","siete","ocho","nueve","diez","once","doce","trece","catorce","quince","dieciséis","diecisiete","dieciocho","diecinueve"]:["","primero","segundo","tercero","cuarto","quinto","sexto","séptimo","octavo","noveno","décimo","undécimo","duodécimo","decimotercero","decimocuarto","decimoquinto","decimosexto","decimoséptimo","decimoctavo","decimonoveno"];var n=["","diez","veinte","treinta","cuarenta","cincuenta","sesenta","setenta","ochenta","noventa"],o=["","décimo","vigésimo","trigésimo","cuadragésimo","quincuagésimo","sexagésimo","septuagésimo","octogésimo","nonagésimo"];e<20?i+=r[e]:e>20&&e<30&&t?i+=["","veintiuno","veintidós","veintitrés","veinticuatro","veinticinco","veintiséis","veintisiete","veintiocho","veintinueve"][e%10]:((t&&e%10>0||t&&e%10==0)&&(i+=n[Math.floor(e/10)]),e%10>0&&!t&&(i+=o[Math.floor(e/10)]),e%10!=0||t?e%10>0&&(i+=t?" y "+r[e%10]:" "+r[e%10]):i+=o[Math.floor(e/10)])}return i},i.prototype.getAsOrdinal=function(e,t){switch(t.localeIdAscii){case 1069:case 8218:case 5146:case 4122:case 1050:case 1029:case 1061:case 1035:case 3079:case 1031:case 5127:case 4103:case 2055:case 1038:case 1060:case 1055:case 1044:case 2068:case 1045:case 6170:case 2074:return e.toString()+".";case 2060:case 11276:case 3084:case 9228:case 12300:case 1036:case 15372:case 5132:case 13324:case 6156:case 14348:case 8204:case 10252:case 4108:return 1==e?e.toString()+"er":e.toString()+"e";case 2067:case 1043:return e.toString()+"e";case 1032:return e.toString()+"o";case 1040:case 2064:return e.toString()+String.fromCharCode(176);case 5130:case 7178:case 12298:case 17418:case 4106:case 1046:case 2070:case 11274:case 16394:case 13322:case 9226:case 18442:case 2058:case 19466:case 6154:case 15370:case 10250:case 20490:case 3082:case 1034:case 21514:case 14346:case 8202:return e.toString()+String.fromCharCode(186);case 1049:case 2073:return e.toString()+"-"+String.fromCharCode(1081);case 2077:case 1053:return this.getOrdinalInSwedish(e);case 1027:return this.getOrdinalInCatalan(e);case 1030:return this.getOrdinalInDanish(e);default:return this.getOrdinalInEnglish(e)}},i.prototype.getOrdinalInEnglish=function(e){switch(e%100){case 11:case 12:case 13:return e.toString()+"th"}switch(e%10){case 1:return e.toString()+"st";case 2:return e.toString()+"nd";case 3:return e.toString()+"rd";default:return e.toString()+"th"}},i.prototype.getOrdinalInSwedish=function(e){return 11==e||12==e?e.toString()+":e":e%10==1||e%10==2?e.toString()+":a":e.toString()+":e"},i.prototype.getOrdinalInCatalan=function(e){switch(e){case 1:return e.toString()+".";case 2:return e.toString()+"n";case 3:return e.toString()+"r";case 4:return e.toString()+"t";case 14:return e.toString()+String.fromCharCode(232)+"h";default:return e.toString()+String.fromCharCode(232)}},i.prototype.getOrdinalInDanish=function(e){if(0==e)return e.toString()+"te";switch(e%100){case 0:return e.toString()+"ende";case 1:return e.toString()+"ste";case 2:return e.toString()+"nden";case 3:return e.toString()+"dje";case 4:return e.toString()+"rde";case 5:case 6:case 11:case 12:case 30:return e.toString()+"te";default:return e.toString()+"nde"}},i.prototype.getListLevel=function(e,t){if(!sf.base.isNullOrUndefined(e)){var i=this.documentHelper.getAbstractListById(e.abstractListId);!sf.base.isNullOrUndefined(e)&&i.levels.length<=t&&t>=0&&t<9&&this.addListLevels(i);var r=void 0;if(!sf.base.isNullOrUndefined(e.levelOverrides)&&!sf.base.isNullOrUndefined(r=this.getOverrideListLevel(e.levelOverrides,t))&&!sf.base.isNullOrUndefined(r.overrideListLevel))return sf.base.isNullOrUndefined(r.startAt)&&(r.overrideListLevel.startAt=i.levels[t].startAt),r.overrideListLevel;if(!sf.base.isNullOrUndefined(i)&&t>=0&&t<i.levels.length)return i.levels[t]}},i.prototype.getOverrideListLevel=function(e,t){for(var i=0;i<e.length;i++)if(e[i].levelNumber==t)return e[i]},i.prototype.getTabWidth=function(e,t,i,r,n){var o=0,s=!1,a=e.paragraphFormat.getUpdatedTabs(),l=!1,d=e.bodyWidget.sectionFormat,h=(x.convertPointToPixel(d.leftMargin),!1);if(!sf.base.isNullOrUndefined(e.paragraphFormat.listFormat.listLevel)&&!sf.base.isNullOrUndefined(e.paragraphFormat.listFormat.listLevel.paragraphFormat)){var c=e.paragraphFormat.listFormat.listLevel.paragraphFormat;e.paragraphFormat.leftIndent!==c.leftIndent&&(l=!0)}var p=0,g=t.clientActiveArea.x,f=x.convertPointToPixel(e.paragraphFormat.firstLineIndent),u=x.convertPointToPixel(e.paragraphFormat.leftIndent);if(!sf.base.isNullOrUndefined(n)&&r.isFirstLine()?(p=this.viewer.clientArea.x+f,l&&(g+=f)):p=this.viewer.clientArea.x,g<p&&("Word2003"!==this.documentHelper.compatibilityMode||0===a.length))return t.clientArea.x-t.clientActiveArea.x;for(var m=t.clientActiveArea.x-(t.clientArea.x-x.convertPointToPixel(e.paragraphFormat.leftIndent)),y=0;y<a.length;y++){var v=a[y],w=x.convertPointToPixel(v.position);w<u&&(h=parseFloat(m.toFixed(2))<parseFloat(w.toFixed(2)))}if(r.isFirstLine()&&u>0&&f<0&&(n instanceof Va||!h)){if(t.clientArea.x-t.clientActiveArea.x>0)return t.clientArea.x-t.clientActiveArea.x;0===a.length&&e.paragraphFormat.listFormat&&e.paragraphFormat.listFormat.listLevel&&(a=e.paragraphFormat.listFormat.listLevel.paragraphFormat.tabs)}var b=x.convertPointToPixel(this.documentHelper.defaultTabWidth);if(0===a.length&&(m>0&&b>Math.round(m)&&l||b===this.defaultTabWidthPixel&&b>Math.round(m)))return b-m;var I=!1;if(a.length>0){for(y=a.length-1;y>-1;y--){v=a[y];var F=x.convertPointToPixel(v.position);if(!(parseFloat(F.toFixed(2))>parseFloat(m.toFixed(2)))){if(y>0&&x.convertPointToPixel(a[y-1].position)>parseFloat(m.toFixed(2)))continue;if(y!=a.length-1){var C=this.getJustificationTabWidth(a[y+1],n,r,e,b,m,o);b=C.defaultTabWidth,o=C.fPosition,m=C.position,s=!0}I=!0;break}}if(!I){var W=this.getJustificationTabWidth(a[0],n,r,e,b,m,o);b=W.defaultTabWidth,o=W.fPosition,m=W.position,s=!0}}return s||(o=((m-parseFloat((100*m%(100*b)/100).toFixed(2)))/b+1)*b),parseFloat(o.toFixed(1))===parseFloat(m.toFixed(1))?b:o-m>0?o-m:b},i.prototype.getJustificationTabWidth=function(e,t,i,r,n,o,s){var a=t?this.documentHelper.textHelper.getTextSize(t,t.characterFormat):0;if("Left"===e.tabJustification||"List"===e.tabJustification)s=x.convertPointToPixel(e.position),t instanceof Pa&&(t.tabLeader=e.tabLeader,t.tabText="");else{var l=x.convertPointToPixel(e.position)-o,d=this.getRightTabWidth(t.indexInOwner+1,i,r);if(d<l&&"Decimal"!=e.tabJustification)if("Right"===e.tabJustification){n=l-d;var h=x.convertPointToPixel(r.rightIndent),c=this.viewer.clientActiveArea.width+h-n;this.viewer.clientActiveArea.width+=h,c<0?n+=c-d:d>c&&(n-=d-c)}else n=l-d/2;else if("Center"===e.tabJustification&&d/2<l)n=l-d/2;else if("Decimal"===e.tabJustification)if(!sf.base.isNullOrUndefined(t.nextElement)&&t.nextElement instanceof Fa){var p=t.nextElement;if(-1!=p.text.indexOf(".")){var g=p.text.indexOf("."),f=p.text.substring(0,g);n=l-this.documentHelper.textHelper.getWidth(f,p.characterFormat,p.scriptType)}else n=d<l?l-d:l}else n=l;else n="Right"===e.tabJustification?0:a;s=o,t instanceof Pa&&(t.tabLeader=e.tabLeader,t.tabText="")}return{defaultTabWidth:n,fPosition:s,position:o}},i.prototype.getRightTabWidth=function(e,t,i){for(var r=0,n=!1,o=t.children[e];o;){if(o instanceof va||o instanceof Na||n)o instanceof va&&(0===o.fieldType?n=!0:2===o.fieldType&&(n=!1)),o.width=0;else{if(o instanceof Sa&&!this.isTocField(o.fieldBegin)){var s=this.documentHelper.getFieldResult(o.fieldBegin,o.paragraph.bodyWidget.page);""!==s&&(o.text=s)}o instanceof Fa&&this.documentHelper.textHelper.getTextSize(o,o.characterFormat)}if(o instanceof Fa&&"\t"===o.text)return r;r+=o.width,o=o.nextNode}return r},i.prototype.getSplitIndexByWord=function(e,t,i,r,n){for(var o=0,s=t.length;o<s;){var a=this.getTextIndexAfterSpace(t,o);0!==a&&a!==s||(a=s-1);var l=i;if((a<s-1||a===s-1&&" "===t[a-1])&&o!==a&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(t.slice(0,a),r,n)),!(l<=e)){0===o&&" "===t[0]&&(o=this.getTextIndexAfterSpace(t,0));break}o=a}return o},i.prototype.getTextSplitIndexByCharacter=function(e,t,i,r,n,o){for(var s=i.length,a=0;a<s;a++){var l=r;if(a+1<s&&(l=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,a+1),n,o)),l>t)return 0===a&&l>e?s>1&&" "===i[1]?this.getTextIndexAfterSpace(i,1):1:" "===i[a]?this.getTextIndexAfterSpace(i,a):a}return 0},i.prototype.getSubWidth=function(e,t,i,r,n){var o=0,s=!0,a="",l=0,d=e.paragraph.paragraphFormat.bidi;if(this.wrapPosition.length>0){var h=this.getSubWidthBasedOnTextWrap(e,t,i,r,n);if(h.length>0)return h}for(var c=e.renderedElements,p=c.length-1;p>=0;p--){var g=c[p];if(g.width>0&&g instanceof Fa){var f=g.text;if(a=f+a,t&&d&&(s=" "===f&&p-1>=0&&" "===c[p-1].text),!s||""===f.trim()&&"\t"!==f)s?l+=g.width:o+=g.width;else{if(x.endsWith(f)){var u=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(f,g.characterFormat,g.scriptType);o+=u,l+=g.width-u}else o+=g.width;s=!1}}else{if(a="a"+a,s=!1,g instanceof Ba&&"Inline"!==g.textWrappingStyle)continue;o+=g.width}o=t?o:Math.round(o)}var m=a.length-x.removeSpace(a).length;i=(a=a.trim()).length-x.removeSpace(a).length;var y=this.viewer.clientArea.width-r-o,v=this.viewer.clientArea.width-r-(o+l);return d&&t&&(v<0?l=-l:y=v),y<=0&&!this.is2013Justification||0===i&&t&&!d?(i=0,y=0):t?!n&&i>0||n&&this.is2013Justification&&i>0?y/=i:i=0:l>0&&d&&n&&(y-=l),[{trimmedSpaceWidth:l,subWidth:y,spaceCount:i,totalSpaceCount:m}]},i.prototype.getSubWidthBasedOnTextWrap=function(e,t,i,r,n){for(var o=[],s=0,a="",l=this.wrapPosition.length-1,d=!0,h=e.children.length-1;h>=0;h--){var c=e.children[h];if(c.width>0&&c instanceof Fa){var p=c.text;a=p+a,!d||""===p.trim()&&"\t"!==p?d||(s+=c.width):(x.endsWith(p)?s+=this.documentHelper.textHelper.measureTextExcludingSpaceAtEnd(p,c.characterFormat,c.scriptType):s+=c.width,d=!1)}else a="a"+a,d=!1,c instanceof Ba&&"Inline"!==c.textWrappingStyle||(s+=c.width);if((c.padding.left>0||0===h)&&l>=0){for(var g=this.wrapPosition[l--];g.width<=0&&l>=0;)g=this.wrapPosition[l--];var f=this.getSubWidthInfo(e,g.width,s,a,i,t,n);sf.base.isNullOrUndefined(f)||(s=0,a="",o.unshift(f))}}return o},i.prototype.isWordFittedByJustification=function(e,t){var i=e.line,r=i.paragraph.paragraphFormat,n=r.textAlignment,o=i.isLastLine(),s=0;i.isFirstLine()&&(s=x.convertPointToPixel(r.firstLineIndent));var a=this.viewer.clientActiveArea.width;if(0!=t&&a>=t/2){var l=0,d=void 0,h=0;if("Left"!==n&&this.viewer.textWrap&&("Justify"!==n||!o||"Justify"===n&&r.bidi||this.is2013Justification&&o)&&(l=(d=this.getSubWidth(i,"Justify"===n,l,s,o))[0].spaceCount,h=d[0].totalSpaceCount),!sf.base.isNullOrUndefined(d)&&1==d.length&&a>0&&"Justify"===n&&"Word2013"===this.documentHelper.compatibilityMode&&!this.is2013Justification&&0===r.rightIndent&&0===r.leftIndent){var c=0,p=this.getTotalSpaceWidth(i,h),g=p/h;if(a+(c=((a+p)/h-g)/g*100<=33?p/8:p/4)>=t)return this.viewer.clientActiveArea.x-=c,this.viewer.clientActiveArea.width+=c,this.is2013Justification=!0,!0}}return!1},i.prototype.getTotalSpaceWidth=function(e,t){var i=0,r=0;if(e)for(var n=0;n<e.children.length;n++){var o=e.children[n];if(o instanceof Fa){var s=o.text.length-x.removeSpace(o.text).length;if(s>0)i+=s*this.documentHelper.textHelper.getWidth(" ",o.characterFormat,o.scriptType),r+=s}if(!sf.base.isNullOrUndefined(t)&&r>=t)break}return i},i.prototype.getSubWidthInfo=function(e,t,i,r,n,o,s){if(t>0){var a=t-i;n=(r=r.trim()).length-x.removeSpace(r).length;var l=a;return l<=0||0===n&&o&&!e.paragraph.paragraphFormat.bidi?(n=0,l=0):o&&(!s&&n>0?l/=n:n=0),{trimmedSpaceWidth:0,subWidth:l,spaceCount:n,totalSpaceCount:n}}},i.prototype.getBeforeSpacing=function(e,t){var i=0;if(this.documentHelper.dontUseHtmlParagraphAutoSpacing)i=e.paragraphFormat.beforeSpacing;else{var r=e.previousWidget;if(r instanceof ca){var n=this.getAfterSpacing(r),o=e.paragraphFormat.beforeSpacing;e.paragraphFormat.spaceBeforeAuto&&(o=14),n<o&&(i=o-n)}else r instanceof ga?i=e.paragraphFormat.spaceBeforeAuto?14:e.paragraphFormat.beforeSpacing:t>0&&e===e.bodyWidget.childWidgets[0]?this.documentHelper.pages[t].sectionIndex!==this.documentHelper.pages[t-1].sectionIndex&&(i=e.paragraphFormat.spaceBeforeAuto?14:e.paragraphFormat.beforeSpacing):i=e.paragraphFormat.spaceBeforeAuto?0:e.paragraphFormat.beforeSpacing}return this.isSameStyle(e,!1)?0:x.convertPointToPixel(i)},i.prototype.getAfterSpacing=function(e){var t=e.paragraphFormat.afterSpacing;return!this.documentHelper.dontUseHtmlParagraphAutoSpacing&&e.paragraphFormat.spaceAfterAuto&&(t=sf.base.isNullOrUndefined(e.nextWidget)&&e.isInsideTable?0:14),this.isSameStyle(e,!0)?0:t},i.prototype.getLineSpacing=function(e,t,i){if(sf.base.isNullOrUndefined(e.paragraphFormat))return 0;var r=0;switch(e.paragraphFormat.lineSpacingType){case"AtLeast":case"Exactly":r=x.convertPointToPixel(e.paragraphFormat.lineSpacing);break;default:r=e.paragraphFormat.lineSpacing,i&&(r-=1),r*=t}return r},i.prototype.isParagraphFirstLine=function(e,t){var i=e;return!(!sf.base.isNullOrUndefined(i.childWidgets)&&0!==i.childWidgets.indexOf(t))&&(!(t.children.length>0&&!sf.base.isNullOrUndefined(e.previousWidget)&&e.previousWidget instanceof ca)||t.paragraph.index!==e.previousWidget.index)},i.prototype.isParagraphLastLine=function(e){var t=e.line.paragraph,i=t.childWidgets[t.childWidgets.length-1],r=i.children[i.children.length-1];return e===r&&(r instanceof va||!(r instanceof Fa&&"\v"===r.text))},i.prototype.getTextIndexAfterSpace=function(e,t){var i=e.length,r=0,n=0;r=e.indexOf(" ",t)+1,1==(n=e.indexOf("-",t)+1)&&(n=e.indexOf("-",n+1)+1),n>0&&r>0?r=Math.min(r,n):n>0&&0==r&&(r=n);var o=r;if(0===o||o===i)return o;for(;" "===e[o]&&++o!==i;);return o},i.prototype.moveNextWidgetsToTable=function(e,t,i){var r=t.indexInOwner,n=e[e.length-1];i&&(r+=1);for(var o=t.containerWidget.childWidgets.splice(r),s=0;s<o.length;s++)n.childWidgets.push(o[s]),o[s].containerWidget=n},i.prototype.addTableCellWidget=function(e,t,i,r){var n,o=0,s=0,a=i,l=0,d=r;sf.base.isNullOrUndefined(e.cellFormat)||(e.cellFormat.containsMargins()?(s=sf.base.isNullOrUndefined(e.cellFormat.leftMargin)?x.convertPointToPixel(e.ownerTable.tableFormat.leftMargin):x.convertPointToPixel(e.cellFormat.leftMargin),l=sf.base.isNullOrUndefined(e.cellFormat.rightMargin)?x.convertPointToPixel(e.ownerTable.tableFormat.rightMargin):x.convertPointToPixel(e.cellFormat.rightMargin)):(s=0===e.columnIndex&&e.ownerRow.rowFormat.hasValue("leftMargin")?x.convertPointToPixel(e.ownerRow.rowFormat.leftMargin):x.convertPointToPixel(e.ownerTable.tableFormat.leftMargin),l=e.columnIndex===e.ownerTable.tableHolder.columns.length-1&&e.ownerRow.rowFormat.hasValue("rightMargin")?x.convertPointToPixel(e.ownerRow.rowFormat.rightMargin):x.convertPointToPixel(e.ownerTable.tableFormat.rightMargin))),e.margin=new na(s,a,l,d);e.ownerTable.tableFormat.allowAutoFit;var h=e.cellFormat.cellWidth;if("Percent"===e.cellFormat.preferredWidthType&&0!==e.cellFormat.preferredWidth&&h<=0){var c=x.convertPointToPixel(e.ownerTable.getTableClientWidth(e.ownerTable.getContainerWidth()));h=e.ownerTable.getCellWidth(e.cellFormat.preferredWidth,e.cellFormat.preferredWidthType,c,e)}e.width=x.convertPointToPixel(h),sf.base.isNullOrUndefined(e.previousWidget)||(o=e.previousWidget.columnIndex+e.previousWidget.cellFormat.columnSpan),n=sf.base.isNullOrUndefined(e.ownerTable)||sf.base.isNullOrUndefined(e.ownerTable.tableFormat)?0:x.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing);var p=0;o<e.columnIndex&&(p=x.convertPointToPixel(e.ownerTable.tableHolder.getPreviousSpannedCellWidth(o,e.columnIndex)),0===o&&(p-=n/2)),e.x=t.x+p+e.margin.left,e.y=t.y+e.margin.top+n,e.width=e.width-e.margin.left-e.margin.right,n>0&&(e.x+=n,1===e.ownerTable.tableHolder.columns.length?e.width-=2*n:0===e.columnIndex||e.columnIndex===e.ownerTable.tableHolder.columns.length-1?e.width-=2*n-n/2:e.width-=n);var g=x.convertPointToPixel(ua.getCellLeftBorder(e).getLineWidth()),f=x.convertPointToPixel(ua.getCellRightBorder(e).getLineWidth()),u=!1;e.leftBorderWidth=e.ownerTable.isBidiTable?f:g;var m="None"===e.cellFormat.borders.left.lineStyle,y="None"===e.cellFormat.borders.right.lineStyle;e.x+=m?e.leftBorderWidth>0?0:e.leftBorderWidth:0,e.width-=m?e.leftBorderWidth>0?0:e.leftBorderWidth:0;e.ownerTable.isBidiTable?e.cellIndex:(e.cellIndex,e.ownerRow.childWidgets.length);return(n>0||e.columnIndex===e.ownerTable.tableHolder.columns.length-1||e.index===e.containerWidget.childWidgets.length-1)&&(e.rightBorderWidth=e.ownerTable.isBidiTable?g:f,e.ownerTable.tableFormat.allowAutoFit||(e.width-=e.rightBorderWidth),this.isInsertTable()||(u=this.checkPreviousMargins(e.ownerTable))),e.margin.right+=y&&!u?0:e.rightBorderWidth,e.width<e.sizeInfo.minimumWidth/2&&!this.isInitialLoad&&(e.width=e.sizeInfo.minimumWidth/2),e},i.prototype.isInsertTable=function(){return!(!this.documentHelper.owner.editorHistory||!this.documentHelper.owner.editorHistory.currentBaseHistoryInfo||"InsertTable"!==this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.action)},i.prototype.checkPreviousMargins=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.childWidgets.length;r++){if("None"!==i.childWidgets[i.childWidgets.length-1].cellFormat.borders.right.lineStyle)return!0}return!1},i.prototype.addWidgetToTable=function(e,t,i,r,n,o,s,a,l){var d=t[0],h=d.childWidgets.length,c=void 0,p=i.indexOf(r),g=[];if(p>0?c=i[p-1]:r.previousRenderedWidget instanceof fa&&r.previousRenderedWidget.ownerTable.equals(r.ownerTable)&&(c=r.previousRenderedWidget),!sf.base.isNullOrUndefined(c)){if(h=(d=c.containerWidget).childWidgets.indexOf(c)+1,Math.round(r.y)!==Math.round(c.y+c.height)){var f=t.indexOf(d);f+1>=t.length&&this.addTableWidget(e.clientActiveArea,t,!0),h=(d=t[f+1]).childWidgets.length}p>0&&(h=0)}if(this.updateRowHeightBySpannedCell(d,r,h),this.updateRowHeightByCellSpacing(t,r,e),r.containerWidget&&r.containerWidget!==d&&-1!==r.containerWidget.childWidgets.indexOf(r)&&r.containerWidget.childWidgets.splice(r.containerWidget.childWidgets.indexOf(r),1),-1===d.childWidgets.indexOf(r)&&(d.childWidgets.splice(h,0,r),l&&(d.bodyWidget.page.repeatHeaderRowTableWidget=!0)),r.containerWidget=d,!r.ownerTable.isInsideTable){if(n.length>0)sf.base.isNullOrUndefined(n)||(g=this.getFootnoteBody(n));else if(!sf.base.isNullOrUndefined(r))for(var u=0;u<r.childWidgets.length;u++)for(var m=r.childWidgets[u],y=0;y<m.childWidgets.length;y++)for(var v=this.getFootNoteWidgetsOf(m.childWidgets[y],!0),w=0;w<v.length;w++)g.splice(g.length,0,v[w]);g.length>0&&sf.base.isNullOrUndefined(g[0].containerWidget)?this.layoutFootnoteInSplittedRow(r,g):!sf.base.isNullOrUndefined(g)&&g.length>0&&void 0!==r.bodyWidget.previousRenderedWidget&&a!==r.bodyWidget.page.index&&g[0].containerWidget.page.index!==r.bodyWidget.page.index?this.moveFootNotesToPage(g,g[0].containerWidget.page.bodyWidgets[0],r.bodyWidget):this.isInitialLoad||sf.base.isNullOrUndefined(r.bodyWidget.page.footnoteWidget)||this.layoutfootNote(r.bodyWidget.page.footnoteWidget),n.length=0}d.height=d.height+r.height,this.viewer instanceof Qs&&(sf.base.isNullOrUndefined(d.containerWidget)||!(d.containerWidget.childWidgets.indexOf(d)>=0)||d.containerWidget instanceof la||(d.containerWidget.height+=r.height)),this.updateHeightForRowWidget(e,!1,t,i,r,!1,o,s),e.cutFromTop(r.y+r.height),this.viewer.clientActiveArea.height-=this.getFootNoteHeight(g),this.existFootnoteHeight=0},i.prototype.layoutFootnoteInSplittedRow=function(e,t){if(t&&t.length>0){sf.base.isNullOrUndefined(e.ownerTable.bodyWidget.page.footnoteWidget)&&this.addEmptyFootNoteToBody(e.ownerTable.bodyWidget);var i=e.ownerTable.bodyWidget.page.footnoteWidget;if(i){for(var r=0;r<t.length;r++)i.bodyWidgets.push(t[r]),t[r].containerWidget=i;this.layoutfootNote(i)}}},i.prototype.getFootNoteHeight=function(e){var t=0;if(Array.isArray(e))for(var i=0;i<e.length;i++)t+=this.getFootnoteHeightInternal(e[i]);else t=this.getFootnoteHeightInternal(e);return t},i.prototype.getFootnoteHeightInternal=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].height,0===e.indexInOwner&&0===i&&(t+=e.containerWidget.margin.top);return t},i.prototype.updateRowHeightBySpannedCell=function(e,t,i){var r=1;if(0!==e.childWidgets.length&&0!==i){for(var n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n];r=sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.cellFormat)?r:o.cellFormat.rowSpan,this.updateSpannedRowCollection(r,t,o)}if(!sf.base.isNullOrUndefined(t.ownerTable))for(n=0;n<t.ownerTable.spannedRowCollection.length;n++)if(t.ownerTable.spannedRowCollection.keys[n]===t.index){for(var s=0;s<i;s++){var a=e.childWidgets[s];this.updateRowHeight(a,t)}t.ownerTable.spannedRowCollection.remove(t.ownerTable.spannedRowCollection.keys[n]);break}}else this.updateRowHeight(t,t)},i.prototype.updateRowHeight=function(e,t){for(var i=t.index,r=1,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(r=sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.cellFormat)?r:o.cellFormat.rowSpan,this.updateSpannedRowCollection(r,t,o),i-o.rowIndex==r-1){var s=o.y+o.height+o.margin.bottom-t.y;("Exactly"!==t.rowFormat.heightType||"Exactly"===t.rowFormat.heightType&&t.rowFormat.height>s)&&t.height<s&&(t.height=s)}}},i.prototype.updateSpannedRowCollection=function(e,t,i){e>1&&!sf.base.isNullOrUndefined(t.ownerTable)&&(t.ownerTable.spannedRowCollection.containsKey(t.index+e-1)||t.ownerTable.spannedRowCollection.add(t.index+e-1,t.index))},i.prototype.updateRowHeightByCellSpacing=function(e,t,i){t.ownerTable.tableFormat.cellSpacing>0&&e.length>1&&t.y===i.clientArea.y&&i instanceof Qs&&(t.height=t.height-x.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing)/2)},i.prototype.isRowSpanEnd=function(e,t){for(var i=e.index,r=1,n=0;n<this.documentHelper.splittedCellWidgets.length;n++){var o=this.documentHelper.splittedCellWidgets[n];if(r=sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.cellFormat)?r:o.cellFormat.rowSpan,i-o.rowIndex==r-1)return!0}return!1},i.prototype.isVerticalMergedCellContinue=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i];if(t<r.columnIndex)return!0;t+=r.cellFormat.columnSpan}return t<e.ownerTable.tableHolder.columns.length},i.prototype.splitWidgets=function(e,t,i,r,n,o,s,a,l,d,h){if((!d||0!==a)&&this.isFirstLineFitForRow(t.clientArea.bottom,e)&&e.childWidgets.length>0){if(n=this.getSplittedWidgetForRow(t.clientArea.bottom,i,r,e,s,a,d,void 0,h),this.documentHelper.splittedCellWidgets.length>0||n!==e){if(o)for(var c=0;c<n.childWidgets.length;c++){n.childWidgets[c].rowIndex!==n.index&&(n.childWidgets.splice(c,1),c--)}this.insertSplittedCellWidgets(t,i,n,e.index-1)}}else this.insertSplittedCellWidgets(t,i,n,e.index-1);return n},i.prototype.getSplittedWidgetForRow=function(e,t,i,r,n,o,s,a,l){var d=void 0,h=r.index;this.isRelayoutneed=!1;for(var c=!1,p=r.height,g=p,f=0,u=0;u<r.childWidgets.length;u++){var m=r.childWidgets[u],y=this.getSplittedWidget(e,!0,t,i,m,n,o,s,a);if(s&&!sf.base.isNullOrUndefined(y)&&0!==y.childWidgets.length&&p>m.height&&(p=m.height),n=[],sf.base.isNullOrUndefined(y)&&m===r.childWidgets[r.childWidgets.length-1]&&this.isVerticalMergedCellContinue(r)&&this.isRowSpanEnd(r,this.viewer)&&this.documentHelper.splittedCellWidgets.length>0&&l&&(d=this.getSplittedWidgetForSpannedRow(e,r,t,i,n),y=void 0),!sf.base.isNullOrUndefined(y)){if(y===m)return r;m.height>f&&(f=m.height),-1!==r.childWidgets.indexOf(y)&&r.childWidgets.splice(r.childWidgets.indexOf(y),1),r.height-=y.height,(0===u||r.height<f+m.margin.top+m.margin.bottom)&&(r.height=f+m.margin.top+m.margin.bottom),sf.base.isNullOrUndefined(d)&&((d=new fa).containerWidget=r.containerWidget,d.index=r.index,d.rowFormat=r.rowFormat,d.isRenderBookmarkEnd=r.isRenderBookmarkEnd,this.updateWidgetLocation(r,d),i.push(d));var v=1;v=sf.base.isNullOrUndefined(y)||sf.base.isNullOrUndefined(y.cellFormat)?v:y.cellFormat.rowSpan,h-y.rowIndex==v-1&&d.height<y.height+y.margin.top+y.margin.bottom?d.height=y.height+y.margin.top+y.margin.bottom:("Exactly"===r.rowFormat.heightType||"AtLeast"===r.rowFormat.heightType&&d.height<r.rowFormat.height)&&(d.height=r.rowFormat.height),d.childWidgets.push(y),y.containerWidget=d,this.isRelayoutneed=!0;for(var w=u;w>0&&!c;){var b=r.childWidgets[w-1];y=this.getSplittedWidget(e,!0,t,i,b,n),d.childWidgets.splice(0,0,y),y.containerWidget=d,w--}c=!0}}if(s&&p!==g){for(u=0;u<r.childWidgets.length;u++)r.childWidgets[u].height=p;r.height=p}return d},i.prototype.getSplittedWidgetForSpannedRow=function(e,t,i,r,n){for(var o=void 0,s=void 0,a=!1,l=0;l<this.documentHelper.splittedCellWidgets.length&&(s=this.documentHelper.splittedCellWidgets[l],!(t.childWidgets.length<s.index));l++){sf.base.isNullOrUndefined(o)&&((o=new fa).containerWidget=t.containerWidget,o.index=t.index,o.rowFormat=t.rowFormat,o.isRenderBookmarkEnd=t.isRenderBookmarkEnd,this.updateWidgetLocation(t,o),r.push(o)),o.childWidgets.push(s),s.containerWidget=o,this.isRelayoutneed=!0;for(var d=this.documentHelper.splittedCellWidgets[l].index;d>0&&!a;){var h=t.childWidgets[d-1];s=this.getSplittedWidget(e,!0,i,r,h,n),o.childWidgets.splice(0,0,s),s.containerWidget=o,d--}a=!0}return o},i.prototype.getFootNoteHeightInLine=function(e){for(var t=0,i=0;i<e.children.length;i++){var r=e.children[i];r instanceof Wa&&(t+=this.getFootNoteHeight(r.bodyWidget))}return t},i.prototype.getFootnoteFromLine=function(e,t){for(var i=0;i<e.children.length;i++)e.children[i]instanceof Wa&&t.push(e.children[i])},i.prototype.updateWidgetsToTable=function(e,t,i,r,n,o,s){var a,l=i.bodyWidget.page.index,d=this.getRowHeight(i,[i]),h=this.viewer,c=i.rowFormat.isHeader,p=void 0,g=i.rowFormat.allowBreakAcrossPages,f=i.rowFormat.heightType,u=0,m=i,y=!1,v=this.layoutedFootnoteElement,w=!1;void 0!==m.bodyWidget.page.footnoteWidget?(this.footHeight=m.bodyWidget.page.footnoteWidget.height,0===this.footnoteHeight&&(this.footnoteHeight=this.footHeight)):this.footHeight=0,i.ownerTable.continueHeader&&!c&&(i.ownerTable.continueHeader=!1);var b=i.ownerTable.isInsideTable,I=!1;for(a=sf.base.isNullOrUndefined(i.ownerTable)||sf.base.isNullOrUndefined(i.ownerTable.tableFormat)?0:x.convertPointToPixel(i.ownerTable.tableFormat.cellSpacing);u<t.length;){if(u=t.length,this.isRowSpanEnd(i,h)&&"Exactly"===i.rowFormat.heightType&&1===this.documentHelper.splittedCellWidgets.length&&(this.documentHelper.splittedCellWidgets=[]),!s&&(i.ownerTable.isInsideTable||0===this.documentHelper.splittedCellWidgets.length&&m.y+m.height+a+this.footnoteHeight<=h.clientArea.bottom))!this.isVerticalMergedCellContinue(i)||m.y!==h.clientArea.y&&m.y!==this.viewer.clientArea.y+m.ownerTable.headerHeight||this.insertSplittedCellWidgets(h,e,m,m.index-1),this.addWidgetToTable(h,e,t,m,v,void 0,b,l,w),this.documentHelper.splittedCellWidgets.length>0&&sf.base.isNullOrUndefined(t[t.length-1].nextRow)&&(u--,I=!0),b=!1;else{if(v=[],b=!1,this.documentHelper.splittedCellWidgets.length>0&&m.y+m.height+this.footHeight<=h.clientArea.bottom)if(!this.isRowSpanEnd(i,h)){!this.isVerticalMergedCellContinue(i)||m.y!==h.clientArea.y&&m.y!==this.viewer.clientArea.y+m.ownerTable.headerHeight||this.insertSplittedCellWidgets(h,e,m,m.index-1),this.addWidgetToTable(h,e,t,m,v);continue}var F=m,C=e[e.length-1];if(s||d+m.y+this.footHeight>h.clientArea.bottom)if(!g||c&&i.ownerTable.continueHeader||"AtLeast"===f&&x.convertPointToPixel(i.rowFormat.height)<h.clientArea.bottom){if(("AtLeast"===f&&x.convertPointToPixel(i.rowFormat.height)<h.clientActiveArea.height&&g||"Exactly"!==f&&m.y===h.clientArea.y||"Auto"===f&&g)&&(F=this.splitWidgets(m,h,e,t,F,I,v,n,o,s),sf.base.isNullOrUndefined(F)&&m.y===h.clientArea.y?this.addWidgetToTable(h,e,t,m,v):sf.base.isNullOrUndefined(F)&&"AtLeast"===f&&m.containerWidget.lastChild!==m&&(F=m)),"Exactly"===f&&m.y===h.clientArea.y&&(this.addWidgetToTable(h,e,t,m,v),u++),c&&i.ownerTable.continueHeader){i.ownerTable.header=!1,i.ownerTable.headerHeight=0;var W=void 0;if(h instanceof Qs&&(W=this.documentHelper.pages),!sf.base.isNullOrUndefined(W))for(var k=0;k<W.length;k++)!W[k].repeatHeaderRowTableWidget||sf.base.isNullOrUndefined(W[k].bodyWidgets[0].firstChild)||W[k].bodyWidgets[0].firstChild instanceof ga&&W[k].bodyWidgets[0].firstChild.header||(W[k].repeatHeaderRowTableWidget=!1,i.ownerTable.continueHeader=!1)}}else if("Auto"!==f&&"AtLeast"!==f||!g)"Exactly"===f&&m.y===h.clientArea.y&&(this.addWidgetToTable(h,e,t,m,v),u++);else if(x.convertPointToPixel(i.rowFormat.height)>h.clientArea.bottom&&m.y!==h.clientArea.y){if("AtLeast"===f&&x.convertPointToPixel(i.rowFormat.height)>h.clientArea.bottom&&m.ownerTable.wrapTextAround&&m.y-x.convertPointToPixel(m.ownerTable.positioning.verticalPosition)===h.clientArea.y&&m.bodyWidget.firstChild===m.ownerTable&&(F=this.splitWidgets(m,h,e,t,F,I,v,n,o,s),sf.base.isNullOrUndefined(F))){this.addWidgetToTable(h,e,t,m,v),u++;continue}}else F=this.splitWidgets(m,h,e,t,F,I,v,n,o,s),sf.base.isNullOrUndefined(F)&&m.y===h.clientArea.y&&this.addWidgetToTable(h,e,t,m,v);else{var S=!1,P=0;if(sf.base.isNullOrUndefined(m.ownerTable.headerHeight)||(P=m.ownerTable.headerHeight),this.isVerticalMergedCellContinue(i)&&(g||(S=m.y===h.clientArea.y||m.y===this.viewer.clientArea.y+P))){if(S)this.insertSplittedCellWidgets(h,e,F,m.indexInOwner-1);else if(F=this.splitWidgets(m,h,e,t,F,I,v),sf.base.isNullOrUndefined(F)){if(S=m.y===h.clientArea.y||m.y===this.viewer.clientArea.y+P){this.insertSplittedCellWidgets(h,e,m,m.indexInOwner-1),u--;continue}this.isRowSpanEnd(i,h)&&(F=m)}}else I&&!g?F=this.splitWidgets(m,h,e,t,F,I,v):this.isRowSpanEnd(i,h)&&!g&&("AtLeast"===f&&i.ownerTable.spannedRowCollection.keys.length>0&&(F=this.splitWidgets(m,h,e,t,F,I,v,n,o,s,!0)),sf.base.isNullOrUndefined(F)&&this.addWidgetToTable(h,e,t,m,v))}if(!sf.base.isNullOrUndefined(F)&&(sf.base.isNullOrUndefined(this.documentHelper.owner.editor)||this.documentHelper.owner.editor&&!this.documentHelper.owner.editor.isTableInsert)&&!(F.bodyWidget.containerWidget instanceof ha)){if(F!==m){this.addWidgetToTable(h,e,t,m,v,m.nextRow,void 0,void 0,w),this.updateWidgetsToPage(e,t,i.ownerTable,r,m.nextRow),e.indexOf(m.containerWidget)+1>=e.length&&this.addTableWidget(h.clientActiveArea,e,!0),m=F}else{if(i.index>0)if(this.updateWidgetsToPage(e,t,i.ownerTable,r,i),i.previousRenderedWidget instanceof fa){var N=i.previousRenderedWidget;if(x.round(m.y,2)===x.round(N.y+N.height,2))e.indexOf(N.containerWidget)+1>=e.length&&this.addTableWidget(h.clientActiveArea,e,!0);else this.addTableWidget(h.clientActiveArea,e,!0)}else this.addTableWidget(h.clientActiveArea,e,!0);else if("Exactly"===f&&d+m.y+this.footHeight<h.clientArea.bottom&&m.y>=h.clientArea.y){this.addWidgetToTable(h,e,t,m,v),u++;continue}y=!0,u--}C=e[e.length-1];var O=i,T=!1,H=(i.ownerTable.containerWidget.index,!1),E=void 0,R=void 0;R=y&&1===e.length?e[e.length-1]:e[e.length-2];var U=!0;if(y&&1===t.length){var B=this.alignBlockElement(i);if(!sf.base.isNullOrUndefined(B.node)){var L=B.node;if(L instanceof fa&&0===L.indexInOwner)e.length>1&&0===e[e.length-1].childWidgets.length&&(e.pop(),(C=e[e.length-1]).height=0);else if(B.node instanceof ca){R=this.splitParagraph(B.node,parseInt(B.position.index,10)),e.length>1&&0===e[e.length-1].childWidgets.length&&(e.pop(),C=e[e.length-1]),U=!1}L instanceof fa&&(H=0===L.indexInOwner,(O=L).ownerTable.equals(i.ownerTable)||(R=O.ownerTable,U=!1)),T=!0}}E=this.moveBlocksToNextPage(R instanceof ca?R.previousWidget:T&&H?sf.base.isNullOrUndefined(R.previousWidget)?R:R.previousWidget:R,T);var A=e[e.length-1];if(y&&U&&0===O.index&&A.containerWidget&&-1!==A.containerWidget.childWidgets.indexOf(A)&&A.containerWidget.childWidgets.splice(A.containerWidget.childWidgets.indexOf(A),1),U&&(-1!==E.childWidgets.indexOf(A)&&E.childWidgets.splice(E.childWidgets.indexOf(A),1),E.childWidgets.unshift(A),this.shiftFloatingItemsFromTable(A,E)),A.containerWidget=E,y&&O.index>0||t.length>1){var M=y?t[t.length-1]:t[t.length-2];T&&(M=O),this.moveNextWidgetsToTable(e,M,!y),O=i}T&&this.updateClientPositionForBlock(U?A:R,i),y=!1;var z=!1,D=this.documentHelper.viewer.clientArea.bottom-m.bottomBorderWidth-a;if(O.ownerTable.header&&(F.x=F.x,F.y=this.viewer.clientArea.y+C.headerHeight,this.updateChildLocationForRow(F.y,F),z=this.isFirstLineFitForRow(D,F)),z&&O.ownerTable.header&&!T){h instanceof Qs&&(m.bodyWidget.page.repeatHeaderRowTableWidget=!0,w=!0),h.updateClientAreaForBlock(O.ownerTable,!0,e),F.x=F.x,F.y=C.y+O.ownerTable.headerHeight;var V=a/2;this.updateChildLocationForRow(C.y+O.ownerTable.headerHeight-V,F,C.containerWidget)}else{if(h.updateClientAreaForBlock(O.ownerTable,!0,e),F.bodyWidget.sectionFormat.columns.length>1){var q=new ia(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),_=new ia(this.viewer.clientActiveArea.x,this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.width,this.viewer.clientActiveArea.height);F.x=this.viewer.clientActiveArea.x,F.y=this.viewer.clientActiveArea.y;var j=this.getMaxTopCellMargin(F),G=this.getMaxBottomCellMargin(F);for(k=0;k<F.childWidgets.length;k++){var K=F.childWidgets[k];K.height=0,this.addTableCellWidget(K,this.viewer.clientActiveArea,j+F.topBorderWidth,G+F.bottomBorderWidth),this.viewer.updateClientAreaForCell(K,!0);for(var X=0;X<K.childWidgets.length;X++){var J=K.childWidgets[X];h.updateClientAreaForBlock(J,!0),J.containerWidget=K,this.layoutBlock(J,0),h.updateClientAreaForBlock(J,!1)}this.viewer.updateClientAreaForCell(K,!1)}this.viewer.clientActiveArea=_,this.viewer.clientArea=q}F.x=F.x,F.y=C.y;V=a/2;this.updateChildLocationForRow(C.y-V,F,C.containerWidget,!0)}if(U&&this.shiftedFloatingItemsFromTable.length>0){for(k=0;k<this.shiftedFloatingItemsFromTable.length;k++){var Y=this.shiftedFloatingItemsFromTable[k],Z=this.getFloatingItemPoints(Y);Y.y=Z.y,Y.x=Z.x,Y instanceof La&&this.updateChildLocationForCellOrShape(Y.y,Y)}this.shiftedFloatingItemsFromTable=[]}}I=!1}if(c)if(i.ownerTable.continueHeader&&(i.ownerTable.header=!0,i.ownerTable.headerHeight=d+i.ownerTable.headerHeight),p=this.getHeader(i.ownerTable),!sf.base.isNullOrUndefined(p)&&i.index===p.index)if(((P=this.getHeaderHeight(i.ownerTable,i,t))>i.ownerTable.headerHeight||P>i.ownerTable.headerHeight)&&(i.ownerTable.headerHeight=P),i.ownerTable.headerHeight>h.clientArea.height){i.ownerTable.header=!1,i.ownerTable.continueHeader=!1,i.ownerTable.headerHeight=0;for(W=this.documentHelper.pages,k=0;k<W.length;k++)W[k].repeatHeaderRowTableWidget&&(W[k].repeatHeaderRowTableWidget=!1)}s=!1,e.length>2&&i.ownerTable.header&&m.height<h.clientActiveArea.bottom&&!h.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget&&(h.documentHelper.currentRenderingPage.repeatHeaderRowTableWidget=!0)}},i.prototype.getHeader=function(e){var t=void 0,i=!0;e=e.getSplitWidgets()[0];for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];if(n.rowFormat.isHeader?t=n:i=!1,!i)break}return t},i.prototype.getHeaderHeight=function(e,t,i){var r=0;if(t.ownerTable.childWidgets.length>0&&e.childWidgets[0].rowFormat.isHeader)for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(!o.rowFormat.isHeader)break;r+=o.height}return r},i.prototype.getHeaderHeightForSpannedRow=function(e){for(var t=0,i=1,r=this.getHeader(e),n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(o.rowFormat.isHeader&&(t+=o.height,o==r)){for(var s=0;s<r.childWidgets.length;s++){var a=r.childWidgets[s];i=Math.max(i,a.cellFormat.rowSpan)}if(i>1&&n+i<e.childWidgets.length)for(var l=1;l<i;l++){var d=e.childWidgets[n+l];sf.base.isNullOrUndefined(d)||(t+=d.height)}}}return t},i.prototype.updateWidgetToRow=function(e){var t=e.ownerRow;if(e.containerWidget=t,!sf.base.isNullOrUndefined(e.ownerRow)&&"Exactly"!==e.ownerRow.rowFormat.heightType&&x.convertPointToPixel(e.ownerRow.rowFormat.height)>0&&0===e.cellIndex&&(t.height=t.height+x.convertPointToPixel(e.ownerRow.rowFormat.height)),1===e.cellFormat.rowSpan){var i=void 0;i="Exactly"===t.rowFormat.heightType?e.height+e.margin.bottom:e.height+e.margin.top+e.margin.bottom,t.height-x.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing)<i&&(t.height=i+x.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))}},i.prototype.updateHeightForRowWidget=function(e,t,i,r,n,o,s,a){for(var l=0;l<n.childWidgets.length;l++){var d,h=0,c=void 0;if(d=(c=n.childWidgets[l]).cellFormat.rowSpan,h=x.convertPointToPixel(c.ownerTable.tableFormat.cellSpacing),d>1){var p=n.containerWidget.childWidgets.indexOf(n),g=p+d-1-(n.index-c.rowIndex);!a&&(e.clientArea.bottom<c.y+c.height+c.margin.bottom||g>=p+1)&&(1===r.length||r.length>=1&&n===r[r.length-1])&&this.splitSpannedCellWidget(c,i,r,e);var f=n;if(g>0)if(g<n.containerWidget.childWidgets.length){var u=n.containerWidget.childWidgets[g];u instanceof fa&&(f=u)===s&&(f=n)}else f=n.containerWidget.childWidgets[n.containerWidget.childWidgets.length-1];c.y+c.height+c.margin.bottom<f.y+f.height?c.height=f.y+f.height-c.y-c.margin.bottom:o&&f&&0!==f.y&&0!==f.height&&c.y+c.height+c.margin.bottom>f.y+f.height&&("Exactly"!==f.rowFormat.heightType||"Exactly"===f.rowFormat.heightType&&f.rowFormat.height>c.y+c.height+c.margin.bottom-f.y?f.height=c.y+c.height+c.margin.bottom-f.y:c.height=f.y-c.y+f.height)}else h>0&&i.length>1&&n.y===e.clientArea.y&&e instanceof Qs&&(h/=2),c.height=n.height-c.margin.top-c.margin.bottom-h;this.updateHeightForCellWidget(e,i,r,c);for(var m=n.containerWidget;m.containerWidget instanceof oa;)m=m.containerWidget;var y=void 0;m instanceof aa&&(y=m.page),(e instanceof Qs&&-1!==e.visiblePages.indexOf(y)||t)&&this.updateCellVerticalPosition(c,!1,c.ownerTable.isInsideTable)}},i.prototype.updateHeightForCellWidget=function(e,t,i,r){for(var n=0;n<r.childWidgets.length;n++)r.childWidgets[n]instanceof ga&&this.updateHeightForTableWidget(t,i,r.childWidgets[n])},i.prototype.getRowHeight=function(e,t){var i=0;if("Exactly"===e.rowFormat.heightType)i=e.rowFormat.height;else{for(var r=0;r<t.length;r++)t[r]instanceof fa&&(i=t[r].height+i);i=Math.max(i,e.rowFormat.height)}return i},i.prototype.splitSpannedCellWidget=function(e,t,i,r){var n=this.getSplittedWidget(r.clientArea.bottom,!1,t,i,e,void 0,void 0,void 0,void 0,!0);sf.base.isNullOrUndefined(n)||(this.documentHelper.splittedCellWidgets.push(n),n.isSplittedCell=!0)},i.prototype.insertSplittedCellWidgets=function(e,t,i,r){if(!sf.base.isNullOrUndefined(i)){var n,o=i.x,s=0,a=!1;n=x.convertPointToPixel(i.ownerTable.tableHolder.tableWidth);for(var l=0;l<i.childWidgets.length;l++){var d=i.childWidgets[l],h="None"===d.cellFormat.borders.right.lineStyle;if(s=sf.base.isNullOrUndefined(d.ownerTable)||sf.base.isNullOrUndefined(d.ownerTable.tableFormat)?0:x.convertPointToPixel(d.ownerTable.tableFormat.cellSpacing),Math.round(o)<Math.round(d.x-d.margin.left)){if(this.insertRowSpannedWidget(i,e,o,l)){l--;continue}if(1==t.length)break;var c=i.childWidgets.length;if(this.insertEmptySplittedCellWidget(i,t,o,l,r),c<i.childWidgets.length){if(sf.base.isNullOrUndefined(i.previousRenderedWidget)||!(i.previousRenderedWidget instanceof fa))break;var p=i.previousRenderedWidget;if(p.lastChild.columnIndex===i.lastChild.columnIndex&&(!i.ownerTable.tableFormat.allowAutoFit||1===p.lastChild.cellFormat.columnSpan))break;l--;continue}}if(o+=d.margin.left+d.width+d.margin.right,s>0||d.columnIndex===d.ownerTable.tableHolder.columns.length-1||d.index===d.containerWidget.childWidgets.length-1){if(!d.ownerTable.tableFormat.allowAutoFit){var g=x.convertPointToPixel(ua.getCellLeftBorder(d).getLineWidth()),f=x.convertPointToPixel(ua.getCellRightBorder(d).getLineWidth());d.rightBorderWidth=d.ownerTable.isBidiTable?g:f,o+=d.rightBorderWidth}this.isInsertTable()||(a=this.checkPreviousMargins(d.ownerTable))}if(o-=h&&!a?0:d.rightBorderWidth,l===i.childWidgets.length-1&&Math.round(o)<Math.round(i.x+n)){if(this.insertRowSpannedWidget(i,e,o,l+1))continue;this.insertEmptySplittedCellWidget(i,t,o,l+1,r)}else;}if((sf.base.isNullOrUndefined(i.childWidgets)||0===i.childWidgets.length)&&this.documentHelper.splittedCellWidgets.length>0)for(var u=0;u<this.documentHelper.splittedCellWidgets.length;u++){var m=this.documentHelper.splittedCellWidgets[u];if(Math.round(o)<=Math.round(m.x-m.margin.left)){if(this.insertRowSpannedWidget(i,e,o,u)){u--;continue}var y=i.childWidgets.length;if(this.insertEmptySplittedCellWidget(i,t,o,u,r),y<i.childWidgets.length){u--;continue}}if(o+=m.margin.left+m.width+m.margin.right,u===i.childWidgets.length-1&&Math.round(o)<Math.round(i.x+n)){if(this.insertRowSpannedWidget(i,e,o,u+1))continue;this.insertEmptySplittedCellWidget(i,t,o,u+1,r)}else;}this.documentHelper.splittedCellWidgets.length>0&&(this.documentHelper.splittedCellWidgets=[])}},i.prototype.insertRowSpannedWidget=function(e,t,i,r){var n=0;e.ownerTable.tableFormat.cellSpacing>0&&(n=x.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing));for(var o=0;o<this.documentHelper.splittedCellWidgets.length;o++){var s=this.documentHelper.splittedCellWidgets[o];if(Math.round(i)===Math.round(s.x-s.margin.left))return e.childWidgets.splice(r,0,s),s.containerWidget=e,s.height>e.height&&(e.height=s.height),s.y!==e.y+s.margin.top+n&&this.updateChildLocationForRow(e.y,e),this.documentHelper.splittedCellWidgets.splice(o,1),!0}return!1},i.prototype.insertEmptySplittedCellWidget=function(e,t,i,r,n){for(var o,s=t[t.length-1],a=t.length-1;a>=0;a--)for(var l=t[a],d=l.childWidgets.length-1;d>=0;d--){var h=l.childWidgets[d];if(h.index===n){o=h;break}}o&&(s=o.ownerTable,n=o.indexInOwner);for(var c=n;c>=0;c--){var p=s.childWidgets[c],g=p.x;for(a=0;a<p.childWidgets.length;a++){var f=1,u=p.childWidgets[a];if(Math.round(i)===Math.round(g)&&(f=sf.base.isNullOrUndefined(u)||sf.base.isNullOrUndefined(u.cellFormat)?f:u.cellFormat.rowSpan)>1){var m=this.createCellWidget(u);return e.childWidgets.splice(r,0,m),m.containerWidget=e,void this.updateChildLocationForRow(e.y,e)}g+=u.margin.left+u.width+u.margin.right}}},i.prototype.getSplittedWidget=function(e,t,i,r,n,o,s,a,l,d){var h=void 0,c=0;if(a||n.y+n.height>e-this.footHeight-n.margin.bottom){for(var p=0;p<n.ownerRow.childWidgets.length;p++){var g=n.ownerRow.childWidgets[p];if(g.y+g.height<e-this.footHeight-g.margin.bottom)for(var f=0;f<g.childWidgets.length;f++)if(g.childWidgets[f]instanceof ca)for(var u=g.childWidgets[f],m=0;m<u.childWidgets.length;m++){var y=u.childWidgets[m],v=this.getFootNoteHeightInLine(y);this.existFootnoteHeight+=v,c+=v}}var w=0;n.ownerTable.isInsideTable&&(w=l);var b=!1;for(p=0;p<n.childWidgets.length;p++)if(n.childWidgets[p]instanceof ca){u=n.childWidgets[p];var x=this.getSplittedWidgetForPara(e-n.margin.bottom,u,o,s,a,w,b);if(a&&(w+=u.childWidgets.length),!sf.base.isNullOrUndefined(x)){if(b=!0,0===p&&x===u&&!d)return t&&this.isRelayoutneed?h=this.createCellWidget(n):n;-1!==n.childWidgets.indexOf(x)&&(n.childWidgets.splice(n.childWidgets.indexOf(x),1),p--),n.height-=x.height,sf.base.isNullOrUndefined(h)&&(h=this.createCellWidget(n)),h.height+=x.height,h.childWidgets.push(x),x.containerWidget=h}}else{var I=n.childWidgets[p],F=[I];if(a||e-n.margin.bottom<I.y+I.height){var C=I.height,W=this.getSplittedWidgetForTable(e-n.margin.bottom,F,I,o,s,a,w);if(sf.base.isNullOrUndefined(W)&&!I.childWidgets[0].rowFormat.allowBreakAcrossPages&&(W=I),!sf.base.isNullOrUndefined(W)){if(0===p&&W===I)return n;-1!==n.childWidgets.indexOf(W)?(n.childWidgets.splice(n.childWidgets.indexOf(W),1),p--,n.height-=W.height):n.height-=C-I.height,sf.base.isNullOrUndefined(h)&&(h=this.createCellWidget(n)),h.height+=W.height,h.childWidgets.push(W),W.containerWidget=h}}}}return this.existFootnoteHeight-=c,sf.base.isNullOrUndefined(h)&&t&&this.isRelayoutneed&&(h=this.createCellWidget(n)),h},i.prototype.getListLevelPattern=function(e){switch(e){case 0:return"Arabic";case 1:return"LowLetter";case 2:return"LowRoman";case 3:return"UpLetter";case 4:return"UpRoman";case 5:return"Ordinal";case 6:return"Number";case 7:return"OrdinalText";case 8:return"LeadingZero";case 9:return"Bullet";case 10:return"FarEast";case 11:return"Special";default:return"None"}},i.prototype.createCellWidget=function(e){var t=new ua;return t.cellFormat=e.cellFormat,t.index=e.index,t.rowIndex=e.rowIndex,t.columnIndex=e.columnIndex,t.containerWidget=e.containerWidget,this.updateWidgetLocation(e,t),t.margin=e.margin,t.leftBorderWidth=e.leftBorderWidth,t.rightBorderWidth=e.rightBorderWidth,t},i.prototype.createTableWidget=function(e){var t=new ga;if(e.header){t.header=e.header;var i=this.getHeaderHeightForSpannedRow(e);t.headerHeight=i>e.headerHeight?i:e.headerHeight}return t.index=e.index,t.tableFormat=e.tableFormat,t.tableHolder=e.tableHolder,t.footnoteElement=e.footnoteElement,t.isGridUpdated=e.isGridUpdated,t.wrapTextAround=e.wrapTextAround,t.positioning=e.positioning,t.isContainInsideTable=e.isContainInsideTable,t.isBidiTable=e.isBidiTable,t},i.prototype.getSplittedWidgetForPara=function(e,t,i,r,n,o,s){for(var a=t.y,l=void 0,d=!1,h=0;h<t.childWidgets.length;h++){var c=t.childWidgets[h],p=this.getFootNoteHeightInLine(c);if(p+=this.existFootnoteHeight,!sf.base.isNullOrUndefined(i))for(var g=0;g<i.length;g++)p+=this.getFootNoteHeight(i[g].bodyWidget);var f=0;if(f=c.children[0]instanceof Ba?c.children[0].height:c.height,n&&o>=r||e<a+p+f||s){if((t.paragraphFormat.keepLinesTogether&&(0!==t.index||0===t.index&&!sf.base.isNullOrUndefined(t.associatedCell.ownerRow.previousWidget))||t.paragraphFormat.widowControl&&1===h)&&(d=!0,h=0,c=t.childWidgets[0]),0===h){if(c.paragraph.containerWidget instanceof ua&&!d&&!n&&c.paragraph.containerWidget.y===t.y){a+=c.height;continue}l=t;break}-1!==t.childWidgets.indexOf(c)&&(t.childWidgets.splice(t.childWidgets.indexOf(c),1),h--),t.height-=c.height,sf.base.isNullOrUndefined(l)?((l=new ca).characterFormat=t.characterFormat,l.paragraphFormat=t.paragraphFormat,l.index=t.index,this.updateWidgetLocation(t,l),l.height=c.height):l.height+=c.height,l.childWidgets.push(c),c.paragraph=l}this.getFootnoteFromLine(c,i),a+=c.height,o++}return l},i.prototype.getSplittedWidgetForTable=function(e,t,i,r,n,o,s){for(var a=i.y,l=void 0,d=0;d<i.childWidgets.length;d++){var h,c=(h=i.childWidgets[d]).height;if(o||e<a+c||!sf.base.isNullOrUndefined(l)){var p=void 0,g=!0;if(sf.base.isNullOrUndefined(h)||sf.base.isNullOrUndefined(h.rowFormat)||(g=h.rowFormat.allowBreakAcrossPages),g?p=sf.base.isNullOrUndefined(l)&&this.isFirstLineFitForRow(e,h)?this.getSplittedWidgetForRow(e,t,[h],h,r,n,o,s):h:sf.base.isNullOrUndefined(i.containerWidget.containerWidget.previousWidget)&&this.isFirstLineFitForRow(e,h)||i.isInsideTable&&!i.containerWidget.containerWidget.rowFormat.allowBreakAcrossPages?p=this.getSplittedWidgetForRow(e,t,[h],h,r,n,o,s):sf.base.isNullOrUndefined(i.containerWidget.containerWidget.previousWidget)||(p=h),!sf.base.isNullOrUndefined(p)){if(0===d&&p===h)return i;-1!==i.childWidgets.indexOf(p)?(i.childWidgets.splice(i.childWidgets.indexOf(p),1),d--,i.height-=p.height):i.height-=c-h.height,sf.base.isNullOrUndefined(l)?(l=this.createTableWidget(i),this.updateWidgetLocation(i,l),l.height=p.height):l.height+=p.height,l.childWidgets.push(p),p.containerWidget=l}}a+=h.height}return l},i.prototype.isFirstLineFitForPara=function(e,t){var i=t.childWidgets[0],r=i.height,n=this.getFootNoteHeightInLine(i);r+=n+=this.existFootnoteHeight;var o=i.paragraph.containerWidget;if(t.paragraphFormat.keepLinesTogether&&Math.floor(o.containerWidget.y)!==this.viewer.clientArea.y&&(r=t.height),this.documentHelper.isFirstLineFitInShiftWidgets){if(this.viewer.clientActiveArea.y===this.viewer.clientArea.y&&t.y+r>=e)return!0}else if(!o.ownerTable.isInsideTable&&o.containerWidget.y===this.viewer.clientArea.y&&t.y+r>=e)return!0;return t.y+r<=e},i.prototype.isFirstLineFitForTable=function(e,t){var i,r=!1;return i=t.childWidgets[0],sf.base.isNullOrUndefined(i)||(r=this.isFirstLineFitForRow(e,i)),r},i.prototype.isFirstLineFitForRow=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];if(!this.isFirstLineFitForCell(e,r))return!1}return!0},i.prototype.isFirstLineFitForCell=function(e,t){if(0===t.childWidgets.length)return!0;if(t.childWidgets[0]instanceof ca){var i=t.childWidgets[0];return this.isFirstLineFitForPara(e-t.margin.bottom,i)}var r=t.childWidgets[0];return this.isFirstLineFitForTable(e-t.margin.bottom,r)},i.prototype.updateWidgetLocation=function(e,t){t.x=e.x,t.y=e.y,t.width=e.width},i.prototype.updateChildLocationForTable=function(e,t,i,r){for(var n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n];o.y=e,this.updateChildLocationForRow(e,o,i,r),e+=o.height}},i.prototype.updateChildLocationForRow=function(e,t,i,r){var n=0;t.ownerTable.tableFormat.cellSpacing>0&&(n=x.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing));for(var o=0;o<t.childWidgets.length;o++){var s=t.childWidgets[o];s.index=s.cellIndex,s.y=e+s.margin.top+n,this.updateChildLocationForCellOrShape(s.y,s,i,r)}},i.prototype.updateChildLocationForCellOrShape=function(e,t,i,r,n){var o=t;t instanceof La&&(o=t.textFrame);for(var s=0;s<o.childWidgets.length;s++){var a=!1;if(o.childWidgets[s]instanceof ga&&o.childWidgets[s].wrapTextAround&&!sf.base.isNullOrUndefined(o.childWidgets[s+1])&&o.childWidgets[s+1].y>o.childWidgets[s].y&&o.childWidgets[s+1].y<o.childWidgets[s].y+o.childWidgets[s].height&&(a=!0),!sf.base.isNullOrUndefined(o.childWidgets[s].floatingElements)&&o.childWidgets[s].floatingElements.length>0&&r&&(this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-e,this.viewer.clientActiveArea.y=e),o.childWidgets[s].x=o.childWidgets[s].x,o.childWidgets[s].y=e,t instanceof La&&"Inline"==t.textWrappingStyle&&n&&this.updateShapeYPosition(t),!sf.base.isNullOrUndefined(i)&&t instanceof ua&&o.childWidgets[s]instanceof ca){var l=o.childWidgets[s],d=t.ownerTable.bodyWidget.floatingElements,h=!1;if(t.ownerTable.bodyWidget!==i||sf.base.isNullOrUndefined(t.ownerTable.previousSplitWidget)||(d=t.ownerTable.previousSplitWidget.bodyWidget.floatingElements,h=!0),l.floatingElements.length>0)for(var c=0;c<l.floatingElements.length;c++){var p=l.floatingElements[c],g=this.viewer.clientActiveArea.x;if(this.viewer.clientActiveArea.x=p.x,this.layoutShape(p),this.viewer.clientActiveArea.x=g,!sf.base.isNullOrUndefined(l.firstChild))for(var f=l.childWidgets[0],u=0;u<f.children.length;u++){var m=f.children[u];m instanceof Ba&&"Inline"==m.textWrappingStyle&&(this.adjustPosition(m,t.ownerTable.bodyWidget),e=l.y)}if(d.indexOf(p)>-1&&"Inline"!==p.textWrappingStyle){if(!h){i.floatingElements.push(p);var y=i.previousSplitWidget;sf.base.isNullOrUndefined(y)||-1===y.floatingElements.indexOf(p)||y.floatingElements.splice(y.floatingElements.indexOf(p),1)}-1!==d.indexOf(p)&&d.splice(d.indexOf(p),1)}}}o.childWidgets[s]instanceof ga&&this.updateChildLocationForTable(e,o.childWidgets[s],i,r),a||(e+=o.childWidgets[s].height)}},i.prototype.updateCellVerticalPosition=function(e,t,i){var r=e.ownerTable.containerWidget;if(r instanceof sa||r instanceof Aa||i){var n=this.getDisplacement(e,t);this.updateCellContentVerticalPosition(e,n,t)}},i.prototype.updateCellContentVerticalPosition=function(e,t,i){if(0!==t)for(var r=e.y+t,n=0;n<e.childWidgets.length;n++){if(e.childWidgets[n]instanceof ca){var o=e.childWidgets[n];o.y=r,this.updateShapeInsideCell(o,t)}else this.updateTableWidgetLocation(e.childWidgets[n],r,i);r+=e.childWidgets[n].height}},i.prototype.updateShapeInsideCell=function(e,t){for(var i=0;i<e.floatingElements.length;i++){var r=e.floatingElements[i];r.y+=t,r instanceof La&&this.updateChildLocationForCellOrShape(r.y,r)}},i.prototype.updateTableWidgetLocation=function(e,t,i){e.y=t+=e.topBorderWidth;for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];n.y=t;for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];s.y=t+s.margin.top+0,this.updateCellVerticalPosition(s,i,!0)}t+=n.height}return t},i.prototype.getDisplacement=function(e,t){var i=0,r=e.containerWidget,n=e.margin.top+e.margin.bottom;i=!sf.base.isNullOrUndefined(e.cellFormat)&&e.cellFormat.rowSpan>1?e.height:(sf.base.isNullOrUndefined(r)?0:r.height)-n;var o=this.getCellContentHeight(e,!0),s=0;return i>o&&i<=this.viewer.clientArea.height&&(s=i-o,"Center"===e.cellFormat.verticalAlignment?s/=2:("Top"===e.cellFormat.verticalAlignment||t)&&(s=0)),s},i.prototype.getCellContentHeight=function(e,t){if(sf.base.isNullOrUndefined(e.childWidgets))return 0;for(var i=0,r=e.y,n=0,o=0,s=!1,a=!1,l=0;l<e.childWidgets.length;l++)if(e.childWidgets[l]instanceof ca){var d=e.childWidgets[l];if(i+=e.childWidgets[l].height,!t)i+=this.getFloatingItemsHeight(d,e);for(var h=0;h<d.floatingElements.length;h++){s=!0;var c=d.floatingElements[h],p=c.textWrappingStyle,g=c.y+c.height,f=d.y+d.height;if(r+e.containerWidget.height>g&&g>o)n=Math.abs(r-g),o=g,a=!1;else if(g>f&&d.x+d.width>c.x&&g>o&&"InFrontOfText"!==p&&"Behind"!==p&&("Word2013"===this.documentHelper.compatibilityMode||d.floatingElements[h].layoutInCell)){i+=0===o?g-f:g-o,o=g}else a=!0}}else this.considerPositionTableHeight(e,e.childWidgets[l])&&(i+=e.childWidgets[l].height);return r+i>o&&(s=!1),t&&s?n:t&&a?e.ownerRow.height:i},i.prototype.getFloatingItemsHeight=function(e,t){for(var i=0,r=0,n=0;n<e.floatingElements.length;n++){var o=e.floatingElements[n],s=o.textWrappingStyle,a=o.y+o.height,l=e.y+e.height;if(a<this.viewer.clientArea.bottom&&o.y!==e.y&&l>a&&e.x+e.width>o.x&&a>i&&"InFrontOfText"!==s&&"Behind"!==s&&"Inline"!==s&&("Word2013"===this.documentHelper.compatibilityMode||e.floatingElements[n].layoutInCell))r+=0===i?a-t.y:a-i,i=a}return r},i.prototype.considerPositionTableHeight=function(e,t){if(t.isLayouted&&t.wrapTextAround)for(var i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i];if(t!==r&&(r.y===t.y||r.y+r.height<t.y))return!1}return!0},i.prototype.getTableLeftBorder=function(e){if(sf.base.isNullOrUndefined(e.left)){var t=new p(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.left},i.prototype.getTableRightBorder=function(e){if(sf.base.isNullOrUndefined(e.right)){var t=new p(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.right},i.prototype.getTableTopBorder=function(e){if(sf.base.isNullOrUndefined(e.top)){var t=new p(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.top},i.prototype.getTableBottomBorder=function(e){if(sf.base.isNullOrUndefined(e.bottom)){var t=new p(e);return t.lineStyle="Single",t.lineWidth=.66,t}return e.bottom},i.prototype.getCellDiagonalUpBorder=function(e){return e.cellFormat.borders.diagonalUp},i.prototype.getCellDiagonalDownBorder=function(e){return e.cellFormat.borders.diagonalDown},i.prototype.getTableWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){for(var r=e.childWidgets[i],n=0,o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];n+=x.convertPointToPixel(s.cellFormat.cellWidth)}t<n&&(t=n)}return t},i.prototype.layoutNextItemsBlock=function(e,t,i){var r=e.bodyWidget.sectionIndex,n=e,o=n.getSplitWidgets(),s=o[o.length-1].nextRenderedWidget;(sf.base.isNullOrUndefined(s)||this.documentHelper.blockToShift===n)&&(this.documentHelper.blockToShift=void 0);for(var a=!0;s instanceof da&&(s.bodyWidget.sectionIndex===r||"NoBreak"===s.bodyWidget.sectionFormat.breakCode&&n.bodyWidget.sectionFormat.pageWidth===s.bodyWidget.sectionFormat.pageWidth&&n.bodyWidget.sectionFormat.pageHeight===s.bodyWidget.sectionFormat.pageHeight)&&(sf.base.isNullOrUndefined(i)||!i||s.isLayouted||!this.isInitialLoad);){var l,d=n.getSplitWidgets();l=d[d.length-1],n=s,this.documentHelper.blockToShift===n&&(this.documentHelper.blockToShift=void 0),a=!1;var h=void 0;if(h=n.getSplitWidgets()[0],0===this.documentHelper.fieldStacks.length&&!sf.base.isNullOrUndefined(h)&&l.containerWidget===h.containerWidget&&x.round(h.y,2)===x.round(l.y+l.height,2)){if(!sf.base.isNullOrUndefined(this.documentHelper.blockToShift)||this.documentHelper.owner.editor.isFootnoteElementRemoved)this.documentHelper.blockToShift=n;else if(h.bodyWidget){var c=h.bodyWidget.floatingElements.length;(c>0||0===c&&sf.base.isNullOrUndefined(this.documentHelper.blockToShift)&&h instanceof ca&&h.isEmpty()&&l instanceof ga)&&(this.documentHelper.blockToShift=n)}break}if(a=!0,t.owner.isShiftingEnabled&&0===this.documentHelper.fieldStacks.length||this.isIFfield){this.documentHelper.blockToShift=n;break}!sf.base.isNullOrUndefined(this.viewer.owner.editorModule)&&this.viewer.owner.editorModule.isInsertingTOC||(n=n.combineWidget(this.viewer),l.containerWidget!==n.containerWidget&&(l instanceof ca&&(!(l instanceof ca)||l.isEndsWithPageBreak||l.isEndsWithColumnBreak||l.containerWidget.page===n.containerWidget.page||n.bodyWidget instanceof aa&&"NoBreak"===n.bodyWidget.sectionFormat.breakCode)||this.updateContainerWidget(n,l.containerWidget,l.indexInOwner+1,!1)),n instanceof ga&&(this.clearTableWidget(n,!0,!0),n.isGridUpdated=!1),t.updateClientAreaForBlock(n,!0),(this.viewer instanceof $s||n.bodyWidget instanceof la)&&(n.containerWidget.height-=n.height),this.documentHelper.layout.layoutBlock(n,0),t.updateClientAreaForBlock(n,!1)),o=s.getSplitWidgets(),s=o[o.length-1].nextRenderedWidget}t.owner.isShiftingEnabled&&this.documentHelper.blockToShift===n||this.viewer.owner.editorModule.updateListItemsTillEnd(n,a)},i.prototype.updateClientAreaForLine=function(e){e.marginTop=0;var t=this.documentHelper.selection.getTop(e),i=this.viewer.clientArea.x;this.viewer.cutFromTop(t),this.viewer.cutFromLeft(i)},i.prototype.getParentTable=function(e){for(var t=e;t.containerWidget;){if(t.containerWidget instanceof sa||t.containerWidget instanceof Aa)return t;t=t.containerWidget}},i.prototype.reLayoutParagraph=function(e,t,i,r,n){if(!this.isReplaceAll){if(this.isRelayout=!0,e.containerWidget instanceof Aa&&"Inline"===e.containerWidget.containerShape.textWrappingStyle&&(t=e.containerWidget.containerShape.line.indexInOwner,e=e.containerWidget.containerShape.paragraph),r=!sf.base.isNullOrUndefined(r)&&r,this.isRelayout=!0,this.documentHelper.blockToShift===e?(this.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.isBidiReLayout=!0):this.isBidiReLayout&&(this.isBidiReLayout=!1),e.isInsideTable){if(this.isBidiReLayout=!0,this.reLayoutTable(e),this.isFootnoteContentChanged&&!sf.base.isNullOrUndefined(e.bodyWidget)&&!sf.base.isNullOrUndefined(e.bodyWidget.page.footnoteWidget)){var o=e.bodyWidget.page.footnoteWidget;this.layoutfootNote(o)}this.isBidiReLayout=!1}else this.reLayoutLine(e,t,r,n);e.bodyWidget instanceof la&&-1!==e.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(e.bodyWidget,this.viewer)}},i.prototype.getParentRow=function(e){for(var t=e;null!==t.ownerTable&&t.ownerTable.isInsideTable;)t=t.ownerTable.associatedCell;return t.ownerRow},i.prototype.reLayoutRow=function(e){e instanceof ca&&(e=e.associatedCell);var t=this.getParentRow(e).getSplitWidgets()[0];if(sf.base.isNullOrUndefined(t)||t.ownerTable.tableFormat.allowAutoFit)this.currentCell=e,this.reLayoutTable(e),this.currentCell=void 0;else{for(var i=t.ownerTable.getSplitWidgets()[0].combineWidget(this.viewer),r=t;this.isVerticalMergedCellContinue(r);){var n=r.previousWidget;if(sf.base.isNullOrUndefined(n))break;r=n}var o=i.containerWidget;this.viewer instanceof $s&&(o.height-=i.height),!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||o instanceof Aa?o instanceof Aa?this.viewer.updateClientAreaForTextBoxShape(o.containerShape,!0):this.viewer.updateClientArea(o,o.page):(e.bodyWidget.isEmpty=!1,o.height-=i.height,this.viewer.updateHeaderFooterClientAreaWithTop(i.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(i),o.page));var s=new ia(this.viewer.clientArea.x,this.viewer.clientArea.y,this.viewer.clientArea.width,this.viewer.clientArea.height),a=new ia(s.x,s.y,s.width,s.height);if(this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule){var l=this.documentHelper.getFirstParagraphInFirstCell(i);this.viewer.owner.editorModule.updateWholeListItems(l)}this.viewer.updateClientAreaForBlock(i,!0),this.viewer.cutFromTop(r.y),this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,i.height=0;do{if(this.clearRowWidget(t,!0,!0,!0),this.layoutRow([i],t,!0),r===t)break;r=r.nextRow}while(r&&r!==t);this.updateChildLocationForTable(i.y,i),this.viewer.clientArea=a,this.viewer.clientActiveArea=new ia(a.x,a.y,a.width,a.height),this.viewer.updateClientAreaForBlock(i,!0),i.x-=i.leftBorderWidth,i.y-=i.topBorderWidth,this.viewer.cutFromTop(i.y),this.shiftTableWidget(i,this.viewer,!0),this.layoutNextItemsBlock(i,this.viewer)}},i.prototype.reLayoutTable=function(e,t){var i=this.getParentTable(e);if(i.header)for(var r=i.getSplitWidgets(),n=1;n<r.length;n++)r[n].bodyWidget.page.repeatHeaderRowTableWidget=!1;var o=i.combineWidget(this.viewer),s=o.containerWidget;if(this.viewer instanceof $s&&(s.height-=o.height),!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||s instanceof Aa?s instanceof Aa?this.viewer.updateClientAreaForTextBoxShape(s.containerShape,!0):this.viewer.updateClientArea(s,s.page):(e.bodyWidget.isEmpty=!1,s.height-=o.height,this.viewer.updateHeaderFooterClientAreaWithTop(i.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(i),s.page)),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule){var a=this.documentHelper.getFirstParagraphInFirstCell(o);this.viewer.owner.editorModule.updateWholeListItems(a)}this.viewer.updateClientAreaForBlock(o,!0),o.x-=o.leftBorderWidth,o.y-=o.topBorderWidth;var l=this.getYPosition(o);this.viewer.cutFromTop(l),this.clearTableWidget(o,!0,!0,!0,!0),this.isBidiReLayout=!0,this.layoutBlock(o,0),this.viewer.updateClientAreaForBlock(o,!1),this.layoutNextItemsBlock(o,this.viewer,t)},i.prototype.getYPosition=function(e){if(e.wrapTextAround){for(var t=e.previousWidget;t;){if(t instanceof ca)return t.y+t.height;if(t instanceof ga){if(!t.wrapTextAround)return t.y+t.height;t=t.previousWidget}}return this.viewer.clientActiveArea.y}return e.y},i.prototype.clearFootnoteReference=function(e,t){if(e.footnoteElement&&e.footnoteElement.length>0){for(var i=e.bodyWidget.page,r=e.footnoteElement.length-1;r>=0;r--){var n=e.footnoteElement[r];n.isLayout=!1;var o=n.bodyWidget.containerWidget;if(o&&-1!==o.bodyWidgets.indexOf(n.bodyWidget)){var s=this.getFootNoteHeight(n.bodyWidget);o.height-=s,o.bodyWidgets.splice(n.bodyWidget.indexInOwner,1),t&&o.page===i&&(this.viewer.clientActiveArea.height+=s,this.viewer.clientArea.height+=s)}0===o.bodyWidgets.length&&o.page&&(o.page.footnoteWidget=void 0),n.bodyWidget.containerWidget=void 0}e.footnoteElement=[]}},i.prototype.clearTableWidget=function(e,t,i,r,n){e.height=0,r&&(e.isGridUpdated=!1),t&&(e.y=0,e.x=0,e.footnoteElement&&e.footnoteElement.length>0&&this.clearFootnoteReference(e,n)),e.leftBorderWidth=0,e.rightBorderWidth=0,e.topBorderWidth=0,e.bottomBorderWidth=0;for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];this.clearRowWidget(s,t,i,r)}},i.prototype.clearRowWidget=function(e,t,i,r){e.height=0,t&&(e.y=0,e.x=0),e.topBorderWidth=0,e.bottomBorderWidth=0;for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];this.clearCellWidget(o,t,i,r)}},i.prototype.clearCellWidget=function(e,t,i,r){e.height=0,t&&(e.y=0,e.x=0),e.leftBorderWidth=0,e.rightBorderWidth=0,this.clearBlockWidget(e.childWidgets,t,i,r)},i.prototype.clearBlockWidget=function(e,t,i,r){for(var n=0;n<e.length;n++){var o=e[n];o instanceof ca?(t&&(o.y=0,o.x=0),i&&(o.height=0)):this.clearTableWidget(o,t,i,r)}},i.prototype.layoutBodyWidgetCollection=function(e,t,i,r,n){if(!i.isFieldCodeBlock){if(!sf.base.isNullOrUndefined(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled)if(t instanceof sa||t instanceof Aa){var o=this.checkAndGetBlock(t,e);if(t instanceof aa&&sf.base.isNullOrUndefined(o)&&!sf.base.isNullOrUndefined(t.nextRenderedWidget)&&"NoBreak"===t.nextRenderedWidget.sectionFormat.breakCode&&(o=t.nextRenderedWidget.firstChild,t=t.nextRenderedWidget),sf.base.isNullOrUndefined(o))return;if(this.viewer instanceof $s&&(o.containerWidget.height-=o.height),t instanceof la)t.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(t.sectionFormat,-1!==t.headerFooterType.indexOf("Header"),t.page),o.containerWidget.height-=o.height;else if(t instanceof Aa)this.viewer.updateClientAreaForTextBoxShape(t.containerShape,!0,!r);else if(!sf.base.isNullOrUndefined(t.containerWidget)&&t.containerWidget instanceof ha){if(this.viewer.updateClientArea(t,t.page,!0),"Footnote"!==t.containerWidget.footNoteType)return this.viewer.cutFromTop(t.containerWidget.y),void this.layoutfootNote(t.containerWidget);this.isRelayoutFootnote=!0,this.viewer.clientArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.height=Number.POSITIVE_INFINITY,this.viewer.clientActiveArea.y=o.containerWidget.containerWidget.y}else sf.base.isNullOrUndefined(t.page.footnoteWidget)||t.page.footnoteWidget.footNoteType,this.viewer.updateClientArea(t,t.page,!0);if(e>0||"NoBreak"===o.bodyWidget.sectionFormat.breakCode&&0!==o.bodyWidget.index&&o===t.firstChild){var s=(o=o.combineWidget(this.viewer)).getSplitWidgets()[0].previousRenderedWidget;for(!sf.base.isNullOrUndefined(s)&&s.wrapTextAround&&!sf.base.isNullOrUndefined(s.getSplitWidgets()[0].previousRenderedWidget)&&s.y<s.getSplitWidgets()[0].previousRenderedWidget.y&&(s=s.getSplitWidgets()[0].previousRenderedWidget);s instanceof da&&s.isFieldCodeBlock;)s=s.getSplitWidgets()[0].previousRenderedWidget;if(!(sf.base.isNullOrUndefined(s)||s instanceof ca)||s instanceof ca&&!s.isEndsWithPageBreak&&!s.isEndsWithColumnBreak)if(sf.base.isNullOrUndefined(n)&&o.containerWidget!==s.containerWidget){var a=o.containerWidget,l=s.containerWidget,d=this.getFootNoteWidgetsOf(o);if(this.moveFootNotesToPage(d,a,l),"NoBreak"!==o.bodyWidget.sectionFormat.breakCode||o.bodyWidget.index===s.bodyWidget.index)this.viewer.cutFromTop(s.y+s.height),this.updateContainerWidget(o,l,s.indexInOwner+1,!1);else if(o.bodyWidget.sectionIndex!==s.bodyWidget.sectionIndex&&s.bodyWidget.sectionFormat.numberOfColumns>1&&o.bodyWidget.page===s.bodyWidget.page){var h=this.getBodyWidget(s.bodyWidget,!0),c=this.getNextWidgetHeight(h);this.viewer.clientActiveArea.height-=c-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=c,this.viewer.clientArea.y=this.viewer.clientActiveArea.y,this.viewer.clientArea.height=this.viewer.clientActiveArea.height}else this.viewer.updateClientArea(o.bodyWidget,o.bodyWidget.page,!0),this.viewer.cutFromTop(s.y+s.height)}else{if(s instanceof ca&&s.height<=0&&this.isMultiColumnDoc){var p=s;this.viewer.updateClientAreaForBlock(p,!0),this.layoutParagraph(p,0),this.viewer.updateClientArea(p.bodyWidget,p.bodyWidget.page,!0)}this.viewer.cutFromTop(s.y+s.height)}else s instanceof ca&&(s.isEndsWithPageBreak||s.isEndsWithColumnBreak)&&s.containerWidget===o.containerWidget&&this.moveBlocksToNextPage(s,!1)}var g=void 0;(o=o.combineWidget(this.viewer))instanceof ga?(this.clearTableWidget(o,!0,!0),o.isGridUpdated=!1,g=this.documentHelper.getFirstParagraphInFirstCell(o)):g=o,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(g),this.viewer.updateClientAreaForBlock(o,!0,void 0,!1,!0),this.isRelayout=!0,this.documentHelper.layout.layoutBlock(o,0),this.isRelayout=!1,this.viewer.updateClientAreaForBlock(o,!1),!sf.base.isNullOrUndefined(t.containerWidget)&&t.containerWidget instanceof ha&&"Footnote"===t.containerWidget.footNoteType&&this.layoutfootNote(t.containerWidget),r?this.shiftNextWidgets(o):this.layoutNextItemsBlock(o,this.viewer)}else if(t instanceof ua){var f=this.documentHelper.layout.getParentTable(t.ownerTable).getSplitWidgets()[0];this.reLayoutTable(t.ownerTable),this.layoutNextItemsBlock(f,this.viewer)}this.isRelayoutFootnote=!1}},i.prototype.checkAndGetBlock=function(e,t){if(e instanceof Aa)return e.childWidgets[t];var i=e.indexInOwner;if(e.page.bodyWidgets.length<=1)for(;e&&e.indexInOwner===i;){if(e.childWidgets.length>0&&e.firstChild.index<=t&&e.lastChild.index>=t)for(var r=0;r<e.childWidgets.length;r++){if((n=e.childWidgets[r]).index===t)return n}if(!(e instanceof aa))break;e=e.nextRenderedWidget}else for(;e;){if(e.childWidgets.length>0)for(r=0;r<e.childWidgets.length;r++){var n;if((n=e.childWidgets[r]).index===t)return n}if(!(e instanceof aa))break;e=e.nextRenderedWidget}},i.prototype.layoutTable=function(e,t){if(this.isFieldCode&&!this.checkTableHasField(e))return e.isFieldCodeBlock=!0,e;!sf.base.isNullOrUndefined(e.previousWidget)&&this.viewer.clientActiveArea.height<0&&!e.wrapTextAround&&this.moveBlocksToNextPage(e.previousWidget,!1),e.isBidiTable=e.bidi,e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||sf.base.isNullOrUndefined(e.firstChild.firstChild.leftMargin)||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-x.convertPointToPixel(e.firstChild.firstChild.leftMargin));var i,r,n=[e];this.addTableWidget(this.viewer.clientActiveArea,n),this.viewer.updateClientAreaTopOrLeft(e,!0);var o=0;e.wrapTextAround?(i=this.viewer.clientActiveArea.clone(),r=this.viewer.clientArea.clone(),this.updateClientAreaForWrapTable(n,e,!0,i,r)):e.containerWidget instanceof Aa||(this.adjustClientAreaBasedOnTextWrapForTable(e,this.viewer.clientActiveArea),this.isWrapText&&(o=this.viewer.clientActiveArea.x-this.viewer.clientArea.x,this.isWrapText=!1,e.x=this.viewer.clientActiveArea.x));var s=e.childWidgets[0].rowFormat.isHeader;e.childWidgets.length>0&&(e.header=s,e.continueHeader=s,e.headerHeight=0);for(var a=e.childWidgets[t];a;)a=(a=this.layoutRow(n,a)).nextRow;this.documentHelper.viewer instanceof Qs&&e.wrapTextAround&&("Bottom"===e.positioning.verticalAlignment||"Center"===e.positioning.verticalAlignment||"Outside"===e.positioning.verticalAlignment)&&(this.updateTableFloatPoints(e),this.updateChildLocationForTable(e.y,e)),this.updateWidgetsToPage(n,[],e,!0),o>0&&(this.viewer.clientArea.x=this.viewer.clientArea.x-o);var l=e.getSplitWidgets();return e.wrapTextAround&&e.bodyWidget&&e.bodyWidget.lastChild!==l[l.length-1]&&this.updateClientAreaForWrapTable(n,e,!1,i,r),n[n.length-1].isLayouted=!0,n[n.length-1].isFieldCodeBlock=!1,"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||e.wrapTextAround||sf.base.isNullOrUndefined(e.firstChild.firstChild.leftMargin)||(this.viewer.clientArea.x=this.viewer.clientArea.x+x.convertPointToPixel(e.firstChild.firstChild.leftMargin)),n[n.length-1]},i.prototype.updateClientAreaForWrapTable=function(e,t,i,r,n){if(i){if(t.wrapTextAround){this.updateTableFloatPoints(t);var o=this.viewer.clientActiveArea.clone(),s=this.adjustClientAreaBasedOnTextWrapForTable(t,this.viewer.clientActiveArea);o.x!==s.x&&(t.x=this.viewer.clientActiveArea.x),o.y!==s.y&&(t.y=this.viewer.clientActiveArea.y)}}else if(t.wrapTextAround&&t.bodyWidget)if(1==e.length)!sf.base.isNullOrUndefined(t.previousWidget)||t.isInHeaderFooter||t.isInsideTable?(this.viewer.clientActiveArea=r.clone(),this.viewer.clientArea=n.clone(),!t.isLayouted&&this.viewer.clientActiveArea.height<t.height&&t.width>=this.viewer.clientActiveArea.width&&this.moveBlocksToNextPage(t.previousWidget,!1)):this.viewer.updateClientArea(t.bodyWidget,t.bodyWidget.page),-1===t.bodyWidget.floatingElements.indexOf(t)&&t.bodyWidget.floatingElements.push(t);else{this.documentHelper.tableLefts.pop(),this.viewer.updateClientArea(t.bodyWidget,t.bodyWidget.page);for(var a=0;a<e.length;a++){var l=e[a].bodyWidget;sf.base.isNullOrUndefined(l)||-1!==l.floatingElements.indexOf(e[a])||l.floatingElements.push(e[a])}var d=e[e.length-1];this.viewer.cutFromTop(this.viewer.clientActiveArea.y+d.height+d.tableFormat.borders.bottom.lineWidth)}},i.prototype.addTableWidget=function(e,t,i){var r=t[t.length-1];return i&&(r=this.createTableWidget(r),t.push(r)),r.width=e.width,r.x=e.x,r.y=e.y,r.tableFormat.cellSpacing>0&&(r.height=r.height+x.convertPointToPixel(r.tableFormat.cellSpacing),r.isBidiTable?(r.leftBorderWidth=x.convertPointToPixel(this.getTableRightBorder(r.tableFormat.borders).getLineWidth()),r.rightBorderWidth=x.convertPointToPixel(this.getTableLeftBorder(r.tableFormat.borders).getLineWidth())):(r.leftBorderWidth=x.convertPointToPixel(this.getTableLeftBorder(r.tableFormat.borders).getLineWidth()),r.rightBorderWidth=x.convertPointToPixel(this.getTableRightBorder(r.tableFormat.borders).getLineWidth())),r.topBorderWidth=x.convertPointToPixel(this.getTableTopBorder(r.tableFormat.borders).getLineWidth()),r.bottomBorderWidth=x.convertPointToPixel(this.getTableBottomBorder(r.tableFormat.borders).getLineWidth()),r.x+=r.leftBorderWidth,r.y+=r.topBorderWidth,r.width-=r.leftBorderWidth,r.width-=r.rightBorderWidth,r.height+=r.bottomBorderWidth),r},i.prototype.updateWidgetsToPage=function(e,t,i,r,n){var o=this.viewer,s=e[e.length-1];if(!i.isInsideTable){for(var a=0;a<e.length;a++)this.updateHeightForTableWidget(e,t,e[a],n);s.childWidgets.length>0&&s.y!==s.childWidgets[0].y&&(s.y=s.childWidgets[0].y)}if(i.isBidiTable&&r)for(a=0;a<e.length;a++)for(var l=e[a],d=0;d<l.childWidgets.length;d++){l.childWidgets[d].shiftWidgetForRtlTable()}i.tableFormat.cellSpacing>0&&(s.y+s.height+x.convertPointToPixel(i.tableFormat.cellSpacing)>o.clientArea.bottom&&o instanceof $s&&(s.height=s.height-x.convertPointToPixel(i.tableFormat.cellSpacing)/2),o.cutFromTop(s.y+s.height)),this.viewer instanceof $s&&(i.containerWidget.height+=i.height),i.bodyWidget instanceof la&&!i.wrapTextAround&&(i.containerWidget.height+=i.height,this.viewer.owner.enableHeaderAndFooter&&-1!==i.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(i.bodyWidget,this.viewer))},i.prototype.updateHeightForTableWidget=function(e,t,i,r){for(var n=0;n<i.childWidgets.length;n++){var o=i.childWidgets[n];if(o===r)break;this.updateHeightForRowWidget(this.viewer,!0,e,t,o,!1,r)}},i.prototype.layoutRow=function(e,t,i){var r=t.ownerTable.isInsideTable;r||this.updateExistingFootnoteHeight(t);var n=this.viewer,o=[t];this.addTableRowWidget(n.clientActiveArea,o),n.updateClientAreaForRow(t,!0);for(var s=this.getMaxTopCellMargin(t),a=this.getMaxBottomCellMargin(t),l=0;l<t.childWidgets.length;l++){var d=t.childWidgets[l];this.layoutCell(d,s+t.topBorderWidth,a+t.bottomBorderWidth)}n.updateClientAreaForRow(t,!1);var h=[t];return i||this.updateWidgetsToTable(e,h,t,!1),r||(this.layoutedFootnoteElement=[]),h[h.length-1]},i.prototype.updateExistingFootnoteHeight=function(e){this.layoutedFootnoteElement=[],sf.base.isNullOrUndefined(e.bodyWidget.page.footnoteWidget)||0===e.bodyWidget.page.footnoteWidget.bodyWidgets.length?this.existFootnoteHeight=0:this.existFootnoteHeight=e.bodyWidget.page.footnoteWidget.height},i.prototype.isIntersecting=function(e,t,i,r){return(x.round(i,2)<=x.round(e,2)||x.round(i,2)<x.round(t,2))&&x.round(r,2)>x.round(e,2)},i.prototype.getAdjacentRowCell=function(e,t,i,r){var n=[],o=e.ownerTable.tableHolder.columns.length,s=e.ownerTable.childWidgets[r];if(sf.base.isNullOrUndefined(s))return n;var a=0,l=0,d=e.cellFormat.columnSpan,h=e.columnIndex;if(s.rowFormat.gridBefore>0){if(s.rowFormat.gridBefore>h+d)return n;a=s.rowFormat.beforeWidth,l=s.rowFormat.gridBefore}for(var c=0;c<s.childWidgets.length;c++){var p=s.childWidgets[c],g=p.x-p.margin.left,f=p.x+p.width+p.margin.right,u=p.columnIndex+p.cellFormat.columnSpan;if(c==s.childWidgets.length-1||x.round(g,2)>x.round(a,2)&&x.round(g,2)>x.round(t,2)){if(c==s.childWidgets.length-1&&s.rowFormat.gridAfter>0&&u+s.rowFormat.gridAfter===o)return n;if(this.isIntersecting(t,i,a,g))for(;d>0;){var m=s.getVerticalMergeStartCell(h,d),y=0;if(sf.base.isNullOrUndefined(m))break;var v=m.cellFormat.columnSpan;if(n.push(m),t=y=m.x+m.width+m.margin.right,d-=(l=m.columnIndex+v)-h,h=l,x.round(y,2)>=x.round(i,2))break}}if(this.isIntersecting(t,i,g,f)&&(n.push(p),t=f,d-=u-h,h=u),x.round(f,2)>=x.round(i,2))break;a=f,l=u}return n},i.prototype.addTableRowWidget=function(e,t){var i=t[t.length-1];0===i.rowFormat.beforeWidth&&0===i.rowFormat.gridBeforeWidth||this.documentHelper.alignTablesRowByRow&&"Left"!==i.ownerTable.tableFormat.tableAlignment?i.x=e.x:i.x+=0!==i.rowFormat.beforeWidth?i.rowFormat.beforeWidth:i.rowFormat.gridBeforeWidth,i.y=e.y,i.width=e.width;var r=0;if(!sf.base.isNullOrUndefined(i.ownerTable)&&!sf.base.isNullOrUndefined(i.ownerTable.tableFormat)&&i.ownerTable.tableFormat.cellSpacing>0){i.height=i.height+x.convertPointToPixel(i.ownerTable.tableFormat.cellSpacing);for(var n=0;n<i.childWidgets.length;n++)if(!sf.base.isNullOrUndefined(i.childWidgets[n].cellFormat)&&!sf.base.isNullOrUndefined(i.childWidgets[n].cellFormat.borders)){var o=ua.getCellBottomBorder(i.childWidgets[n]).getLineWidth();o>r&&(r=o)}if(i.bottomBorderWidth=x.convertPointToPixel(r),i.index>0&&!sf.base.isNullOrUndefined(i.previousWidget)){var s=i.previousWidget;r=0;for(var a=0;a<s.childWidgets.length;a++)if(!sf.base.isNullOrUndefined(s.childWidgets[a].cellFormat)&&!sf.base.isNullOrUndefined(s.childWidgets[a].cellFormat.borders)){var l=ua.getCellBottomBorder(s.childWidgets[a]).getLineWidth();l>r&&(r=l)}i.topBorderWidth=x.convertPointToPixel(r)}}if(!sf.base.isNullOrUndefined(i.childWidgets))for(a=0;a<i.childWidgets.length;a++)if(!sf.base.isNullOrUndefined(i.childWidgets[a].cellFormat)&&!sf.base.isNullOrUndefined(i.childWidgets[a].cellFormat.borders)){var d=ua.getCellTopBorder(i.childWidgets[a]).getLineWidth();d>r&&(r=d)}if(i.topBorderWidth=x.convertPointToPixel(r),!sf.base.isNullOrUndefined(i.ownerTable)&&!sf.base.isNullOrUndefined(i.ownerTable.tableFormat)&&i.ownerTable.tableFormat.cellSpacing<=0&&i.rowIndex===i.ownerTable.childWidgets.length-1){for(a=0;a<i.childWidgets.length;a++)if(!sf.base.isNullOrUndefined(i.childWidgets[a].cellFormat)&&!sf.base.isNullOrUndefined(i.childWidgets[a].cellFormat.borders)){var h=ua.getCellBottomBorder(i.childWidgets[a]).getLineWidth();h>r&&(r=h)}i.bottomBorderWidth=x.convertPointToPixel(r)}return i},i.prototype.getMaxTopCellMargin=function(e){if(sf.base.isNullOrUndefined(e.childWidgets))return 0;for(var t=0,i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i],n=0;(n=r.cellFormat.hasValue("topMargin")?x.convertPointToPixel(r.cellFormat.topMargin):e.rowFormat.hasValue("topMargin")?x.convertPointToPixel(e.rowFormat.topMargin):x.convertPointToPixel(e.ownerTable.tableFormat.topMargin))>t&&(t=n)}return t},i.prototype.getMaxBottomCellMargin=function(e){if(sf.base.isNullOrUndefined(e.childWidgets))return 0;for(var t=0,i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i],n=0;(n=r.cellFormat.hasValue("bottomMargin")?x.convertPointToPixel(r.cellFormat.bottomMargin):e.rowFormat.hasValue("bottomMargin")?x.convertPointToPixel(e.rowFormat.bottomMargin):x.convertPointToPixel(e.ownerTable.tableFormat.bottomMargin))>t&&(t=n)}return t},i.prototype.layoutCell=function(e,t,i){var r=this.viewer;if(this.addTableCellWidget(e,r.clientActiveArea,t,i),this.updateTopBorders(e),r.updateClientAreaForCell(e,!0),0===e.childWidgets.length){var n=new ca;n.characterFormat=new T,n.paragraphFormat=new ul,n.index=0;var o=new ma(n);n.childWidgets.push(o),e.childWidgets.push(n),n.paragraphFormat.borders=new g}for(var s=0;s<e.childWidgets.length;s++){var a=e.childWidgets[s];r.updateClientAreaForBlock(a,!0),a.containerWidget=e,this.layoutBlock(a,0),r.updateClientAreaForBlock(a,!1)}this.updateWidgetToRow(e),r.updateClientAreaForCell(e,!1)},i.prototype.updateTopBorders=function(e){if(e.updatedTopBorders=[],0===e.ownerTable.tableFormat.cellSpacing){var t=e.cellFormat.borders.top;(!t.isBorderDefined||t.isBorderDefined&&"None"===t.lineStyle&&0===t.lineWidth&&t.hasValue("color"))&&(t=e.ownerRow.rowFormat.borders.horizontal),t.isBorderDefined||(t=e.ownerRow.ownerTable.tableFormat.borders.horizontal);for(var i=e.x-e.margin.left,r=e.x+e.width+e.margin.right,n=this.getAdjacentRowCell(e,i,r,e.ownerRow.indexInOwner-1),o=0;o<n.length;o++){var s=n[o],a=s.cellFormat.borders.bottom;(!a.isBorderDefined||a.isBorderDefined&&"None"===a.lineStyle&&0===a.lineWidth&&a.hasValue("color"))&&(a=s.ownerRow.rowFormat.borders.horizontal),a.isBorderDefined||(a=s.ownerRow.ownerTable.tableFormat.borders.horizontal);var l=void 0;l="None"===t.lineStyle||"Cleared"===t.lineStyle?a:"Cleared"===a.lineStyle||"None"===a.lineStyle?t:e.getBorderBasedOnPriority(t,a);var d=s.x-s.margin.left,h=s.x+s.width+s.margin.right;if(0===o&&i<d&&e.updatedTopBorders.push({border:t,width:d-i}),l){var c=0;(c=x.round(h,2)===x.round(r,2)&&x.round(d,2)===x.round(i,2)?r-i:x.round(d,2)>=x.round(i,2)&&x.round(h,2)>=x.round(r,2)?r-d:x.round(d,2)>=x.round(i,2)&&x.round(h,2)<=x.round(r,2)?h-d:x.round(d,2)<=x.round(i,2)&&x.round(h,2)<=x.round(r,2)?h-i:(x.round(d,2)<=x.round(i,2)&&(x.round(h,2),x.round(r,2)),r-i))<0&&(c=0),e.updatedTopBorders.push({border:l,width:c})}o===n.length-1&&r>h&&e.updatedTopBorders.push({border:t,width:r-h})}}},i.prototype.shiftLayoutedItems=function(e){if(sf.base.isNullOrUndefined(this.documentHelper.blockToShift)||sf.base.isNullOrUndefined(this.documentHelper.blockToShift.containerWidget))return this.documentHelper.blockToShift=void 0,this.checkAndShiftEndnote(),void this.documentHelper.removeEmptyPages();var t=this.documentHelper.blockToShift,i=this.getColumnBreak(t.bodyWidget);if(!i&&this.viewer instanceof Qs&&!this.isMultiColumnSplit&&t===t.bodyWidget.firstChild&&!sf.base.isNullOrUndefined(t.bodyWidget.previousRenderedWidget)&&t.bodyWidget.sectionIndex!==t.bodyWidget.previousRenderedWidget.sectionIndex&&t.bodyWidget.previousRenderedWidget.sectionFormat.columns.length>1){var r=t.bodyWidget.previousRenderedWidget,n=this.getBodyWidget(r,!1);sf.base.isNullOrUndefined(n.nextRenderedWidget)||n.page!==n.nextRenderedWidget.page||this.splitBodyWidgetBasedOnColumn(r)}var o=!1,s=this.documentHelper.pages[this.documentHelper.pages.length-1];s.bodyWidgets[s.bodyWidgets.length-1];if((!i||e&&this.isSectionEndsWithColumnBreak(t.bodyWidget))&&this.viewer instanceof Qs&&!this.isMultiColumnSplit&&t.bodyWidget.sectionFormat.columns.length>1){if(0!==t.bodyWidget.columnIndex||t!==t.bodyWidget.firstChild||sf.base.isNullOrUndefined(t.previousRenderedWidget)||t.bodyWidget.page!==t.previousRenderedWidget.bodyWidget.page||(t.bodyWidget.y=this.viewer.clientActiveArea.y),o=t===t.bodyWidget.firstChild,this.reLayoutMultiColumn(t.bodyWidget,o),sf.base.isNullOrUndefined(this.documentHelper.blockToShift))return;t=this.documentHelper.blockToShift}var a=t.bodyWidget.index;this.reLayoutOrShiftWidgets(t,this.viewer);for(var l=!0,d=t.getSplitWidgets(),h=d[d.length-1].nextRenderedWidget;h instanceof da&&(h.bodyWidget.index===a||"NoBreak"===h.bodyWidget.sectionFormat.breakCode&&t.bodyWidget.sectionFormat.pageWidth===h.bodyWidget.sectionFormat.pageWidth&&t.bodyWidget.sectionFormat.pageHeight===h.bodyWidget.sectionFormat.pageHeight);){if((!(i=this.getColumnBreak(h.bodyWidget))||e&&this.isSectionEndsWithColumnBreak(h.bodyWidget))&&this.viewer instanceof Qs&&!this.isMultiColumnSplit&&h.bodyWidget.sectionFormat.columns.length>1){if(0!==h.bodyWidget.columnIndex||h!==h.bodyWidget.firstChild||sf.base.isNullOrUndefined(h.previousRenderedWidget)||h.bodyWidget.page!==h.previousRenderedWidget.bodyWidget.page||(h.bodyWidget.y=this.viewer.clientActiveArea.y),o=h===h.bodyWidget.firstChild,this.reLayoutMultiColumn(h.bodyWidget,o),sf.base.isNullOrUndefined(this.documentHelper.blockToShift))return;h=this.documentHelper.blockToShift}var c,p=t.getSplitWidgets();c=p[p.length-1],l=!1;var g=void 0;if(p=(t=h).getSplitWidgets(),(t instanceof ca||t instanceof ga)&&(g=p[0]),!this.documentHelper.owner.editor.isFootnoteElementRemoved&&c.containerWidget===g.containerWidget&&x.round(g.y,2)===x.round(this.viewer.clientActiveArea.y,2)&&sf.base.isNullOrUndefined(g.nextWidget))break;if(sf.base.isNullOrUndefined(c.floatingElements),l=!0,t.isFieldCodeBlock||this.reLayoutOrShiftWidgets(t,this.viewer),this.keepWithNext&&(t=this.documentHelper.blockToShift,this.keepWithNext=!1),!this.isMultiColumnSplit&&i&&t.bodyWidget.sectionFormat.numberOfColumns>1&&t.bodyWidget.nextWidget&&t.nextRenderedWidget&&t.bodyWidget.index!==t.nextRenderedWidget.bodyWidget.index){var f=this.viewer.clientActiveArea.y,u=this.viewer.clientActiveArea.height;this.viewer.updateClientArea(t.bodyWidget.nextWidget,t.bodyWidget.nextWidget.page),this.viewer.clientActiveArea.height=u,this.viewer.clientActiveArea.y=f}if(this.isMultiColumnSplit&&t.bodyWidget.sectionFormat.numberOfColumns>1&&t===t.bodyWidget.lastChild&&!sf.base.isNullOrUndefined(t.bodyWidget.nextRenderedWidget)&&t.bodyWidget.sectionIndex!==t.bodyWidget.nextRenderedWidget.sectionIndex&&t.bodyWidget.page===t.bodyWidget.nextRenderedWidget.page)return;h=(d=t.getSplitWidgets())[d.length-1].nextRenderedWidget}if(this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateListItemsTillEnd(t,l),this.documentHelper.blockToShift=void 0,this.viewer.owner.editor.isFootnoteElementRemoved){var m=this.documentHelper.pages[this.documentHelper.pages.length-1],y=m.bodyWidgets[m.bodyWidgets.length-1],v=m.endnoteWidget;if(!sf.base.isNullOrUndefined(v)){var w=this.viewer.clientArea.clone(),b=this.viewer.clientActiveArea.clone(),I=y.childWidgets[y.childWidgets.length-1],F=I.y+I.height;this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-F,this.viewer.clientActiveArea.x=this.viewer.clientArea.x,this.viewer.clientActiveArea.width=this.viewer.clientArea.width,this.viewer.clientActiveArea.y=F,this.layoutfootNote(v),this.viewer.clientArea=w,this.viewer.clientActiveArea=b}}this.documentHelper.removeEmptyPages(),this.updateFieldElements(e);var C=this.documentHelper.pages[0];if(C.bodyWidgets[0].sectionIndex>0){var W=C;do{this.documentHelper.layout.layoutHeaderFooter(W.bodyWidgets[0],this.viewer,W),W=W.nextPage}while(W);for(;C.bodyWidgets[0].sectionIndex>0;)this.documentHelper.owner.editor.updateSectionIndex(void 0,C.bodyWidgets[0],!1)}this.isMultiColumnSplit||this.viewer.updateScrollBars()},i.prototype.isSectionEndsWithColumnBreak=function(e){return!sf.base.isNullOrUndefined(e)&&e.childWidgets.length>0&&e.lastChild instanceof ca&&e.lastChild.isEndsWithColumnBreak},i.prototype.checkAndShiftEndnote=function(){if(this.documentHelper.owner.selection){var e=this.documentHelper.owner.selection.end.paragraph;e.isInsideTable&&(e=this.getParentTable(e)),e.isInHeaderFooter||e.bodyWidget.containerWidget instanceof ha||!sf.base.isNullOrUndefined(e.nextRenderedWidget)||e.bodyWidget instanceof ha||this.isRelayoutFootnote||!e.bodyWidget.page.endnoteWidget||this.layoutfootNote(e.bodyWidget.page.endnoteWidget)}},i.prototype.updateFieldElements=function(e){for(var t=0;t<this.documentHelper.fields.length;t++){var i=this.documentHelper.fields[t];if((this.viewer instanceof Qs||this.viewer instanceof $s&&!(i.line.paragraph.bodyWidget instanceof la))&&!sf.base.isNullOrUndefined(this.documentHelper.selection)){var r=this.documentHelper.selection.getFieldCode(i),n=/^(?!.*\bhyperlink\b).*\bpage\b.*$/;if(!sf.base.isNullOrUndefined(r)&&(r.toLowerCase().match("numpages")||r.toLowerCase().match("sectionpages")||n.test(r.toLowerCase())&&e)&&!sf.base.isNullOrUndefined(i.fieldSeparator)){var o=i.fieldSeparator.nextNode;if(!sf.base.isNullOrUndefined(o)){var s=o.text,a=i.line.paragraph;if(!sf.base.isNullOrUndefined(a.bodyWidget)&&!sf.base.isNullOrUndefined(a.bodyWidget.page)&&-1!==a.bodyWidget.page.index){if(n.test(r.toLowerCase())){var l=a.bodyWidget.page.index+1;o.text=l.toString()}else o.text=this.documentHelper.pages.length.toString();if(s!==o.text){var d=a.childWidgets.indexOf(i.line),h=i.line.children.indexOf(o);a.isInsideTable?this.reLayoutParagraph(a,d,h):this.reLayoutLine(a,d,!1,!1,!0)}}}}}}},i.prototype.reLayoutOrShiftWidgets=function(e,t){var i=e,r=!1;if(this.isNeedToRelayout(e.bodyWidget)?(this.isMultiColumnSplit||this.updateContainerForTable(i,t),i instanceof ga&&(i=i.combineWidget(this.viewer),this.clearTableWidget(i,!0,!0,!0)),t.updateClientAreaForBlock(i,!0),this.isRelayout=!0,this.layoutBlock(i,0),this.isRelayout=!1,t.updateClientAreaForBlock(i,!1),r=!0):this.shiftWidgetsBlock(i,t),this.documentHelper.pages.indexOf(i.bodyWidget.page)>0&&i===i.bodyWidget.childWidgets[0]&&i instanceof ca)for(var n=i.bodyWidget.childWidgets[0].childWidgets[0].children,o=0;o<n.length;o++){var s=n[o];s.margin.top>0&&s.margin.top===this.getBeforeSpacing(s.paragraph)&&(s.margin.top-=this.getBeforeSpacing(s.paragraph))}this.viewer.owner.editorModule&&!r&&this.viewer.owner.editorModule.updateRenderedListItems(i),!this.isRelayoutFootnote&&i.bodyWidget.page.footnoteWidget&&this.layoutfootNote(i.bodyWidget.page.footnoteWidget)},i.prototype.isNeedToRelayout=function(e){for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t];if(i instanceof ga||i instanceof Ba&&("Square"===i.textWrappingStyle||"TopAndBottom"===i.textWrappingStyle))return!0}return!1},i.prototype.shiftWidgetsBlock=function(e,t){e instanceof ca?this.shiftWidgetsForPara(e,t):e instanceof ga&&this.shiftWidgetsForTable(e,t)},i.prototype.shiftWidgetsForPara=function(e,t){if(!(e.height>t.clientArea.height+t.clientArea.y)||this.documentHelper.owner.enableHeaderAndFooter){e.bodyWidget;for(var i=this.getBodyWidgetOfPreviousBlock(e,0),r=i.bodyWidget,n=i.index,o=void 0,s=!1,a=!0,l=0;l<e.getSplitWidgets().length;l++){var d=e.getSplitWidgets()[l],h=this.getBodyWidget(d.bodyWidget,!0);if(!this.isMultiColumnSplit||d===e){if(a&&!sf.base.isNullOrUndefined(o)){var c=!!o.lastChild&&o.lastChild.isEndsWithPageBreak,p=!!o.lastChild&&o.lastChild.isEndsWithColumnBreak;if(this.shiftToPreviousWidget(d,t,o,c,p),this.updateFloatingElementPosition(o),(sf.base.isNullOrUndefined(d.childWidgets)||0===d.childWidgets.length)&&!c&&!p){l--;continue}o=void 0,r!==d.containerWidget&&(r=d.containerWidget,c&&t.updateClientAreaByWidget(d))}var g=[];if(s||(g=this.getFootNoteWidgetsOf(d)),s=!1,this.isFitInClientArea(d,t,g)||this.isMultiColumnSplit){if(this.keepWithNext&&(this.updateClientPositionForBlock(d.containerWidget.firstChild,d),this.keepWithNext=!1),o=d,t.updateClientAreaForBlock(d,!0,void 0,!1,!0),d.isEmpty()&&!sf.base.isNullOrUndefined(d.paragraphFormat)&&("Center"===d.paragraphFormat.textAlignment||"Right"===d.paragraphFormat.textAlignment||"Justify"===d.paragraphFormat.textAlignment&&d.paragraphFormat.bidi)&&-1===d.paragraphFormat.listFormat.listId?this.updateXPositionForEmptyParagraph(t.clientActiveArea,d):d.x=t.clientActiveArea.x,t.updateClientAreaForBlock(d,!1),d.y=t.clientActiveArea.y,this.updateFloatingElementPosition(d),t.cutFromTop(t.clientActiveArea.y+d.height),sf.base.isNullOrUndefined(r)||r===d.containerWidget||this.isMultiColumnSplit){if(d.containerWidget instanceof aa&&d.containerWidget.firstChild===d&&d.previousRenderedWidget&&d.previousRenderedWidget instanceof ca&&"NoBreak"==d.previousRenderedWidget.containerWidget.sectionFormat.breakCode&&d.containerWidget.page.index!==d.previousRenderedWidget.containerWidget.page.index&&d.containerWidget.index!==d.previousRenderedWidget.containerWidget.index){var f=d.previousRenderedWidget.bodyWidget,u=f.sectionFormat.breakCode;f.sectionFormat.columns.length>1&&(f=this.getBodyWidget(f,!0)),sf.base.isNullOrUndefined(f.previousRenderedWidget)||"NoBreak"!==f.sectionFormat.breakCode||"NewPage"!=f.previousRenderedWidget.sectionFormat.breakCode||f.page.index!==f.previousRenderedWidget.page.index||(u=f.previousRenderedWidget.sectionFormat.breakCode);var m=x.round(this.getNextWidgetHeight(f)+d.height,2);if(!d.previousRenderedWidget.containerWidget.lastChild.isEndsWithPageBreak&&!d.previousRenderedWidget.containerWidget.lastChild.isEndsWithColumnBreak&&m<=x.round(this.viewer.clientActiveArea.bottom,2)&&"NoBreak"===u){for(var y=d.previousRenderedWidget.bodyWidget.page,v=d.containerWidget.page,w=0;w<v.bodyWidgets.length;w++){var b=v.bodyWidgets[w];v.bodyWidgets.splice(v.bodyWidgets.indexOf(b),1),y.bodyWidgets.splice(y.bodyWidgets.length,0,b),b.page=y,w--}d.containerWidget.y=this.viewer.clientActiveArea.y,this.documentHelper.removeEmptyPages()}}}else if(n++,r.lastChild.isEndsWithPageBreak||r.lastChild.isEndsWithColumnBreak||this.updateContainerWidget(d,r,n,!0,g),g.length>0&&r.page.footnoteWidget)for(var I=0;I<g.length;I++)-1===r.page.footnoteWidget.bodyWidgets.indexOf(g[I])&&d.bodyWidget.page.index!=g[I].page.index&&(r.page.footnoteWidget.bodyWidgets.push(g[I]),r.page.footnoteWidget.height+=g[I].height);if(!this.isInitialLoad&&a&&d.bodyWidget.sectionFormat.columns.length>1&&d===d.bodyWidget.firstChild&&!sf.base.isNullOrUndefined(h.previousWidget)&&h.page===h.previousWidget.page){this.viewer.updateClientArea(d.bodyWidget,d.bodyWidget.page),h=this.getBodyWidget(h.previousWidget,!0);var F=this.getNextWidgetHeight(h);d.bodyWidget.y=F,this.viewer.clientActiveArea.height-=F-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=F,a=!1,l--}if((d.isEndsWithPageBreak&&!this.isPageBreakInsideField(d)||d.isEndsWithColumnBreak)&&this.viewer instanceof Qs){b=this.createOrGetNextBodyWidget(r,this.viewer);b=this.moveBlocksToNextPage(d,!0),t.updateClientArea(b,b.page)}}else{var C=d.previousRenderedWidget;c=!1,p=!1;C instanceof ca&&C.isEndsWithPageBreak&&this.viewer instanceof Qs&&(c=!0),C instanceof ca&&C.isEndsWithColumnBreak&&this.viewer instanceof Qs&&(p=!0);var W=this.splitWidget(d,t,r,n+1,c,g,p);this.updateFloatingElementPosition(d),o=void 0,r!==d.containerWidget&&(r=d.containerWidget,l--,g.length>0&&(s=!0)),n=r.childWidgets.indexOf(d),W&&(r=e.getSplitWidgets()[l+1].containerWidget)}}}this.skipUpdateContainerWidget=!1}},i.prototype.updateFloatingElementPosition=function(e){if(e.floatingElements.length>0)for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],r=0;if(i instanceof La&&"Inline"===i.textWrappingStyle){var n=i.line.indexInOwner,o=0;r=x.convertPointToPixel(i.textFrame.marginTop);for(var s=0;s<n;s++)sf.base.isNullOrUndefined(e.childWidgets[s])||(o+=e.childWidgets[s].height);i.y=e.y+o}else{var a=this.getFloatingItemPoints(i);i.y=a.y,i.x=a.x}i instanceof La&&this.updateChildLocationForCellOrShape(i.y+r,i,void 0,!1,!0)}},i.prototype.isPageBreakInsideField=function(e){for(var t=!1,i=!1,r=0,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];r+=o.height;for(var s=0;s<o.children.length;s++){var a=o.children[s];a instanceof va&&(0===a.fieldType?i=!0:2!==a.fieldType&&1!==a.fieldType||(i=!1)),t=!(!i&&"\f"===a.text)}}return t&&0===e.height&&this.viewer.cutFromTop(this.viewer.clientActiveArea.y+r),t},i.prototype.getFootNotesOfBlock=function(e,t){if(sf.base.isNullOrUndefined(t)&&(t=[]),e.childWidgets.length>0)for(var i=0;i<this.documentHelper.footnoteCollection.length;i++)this.documentHelper.footnoteCollection[i].line.paragraph===e&&t.push(this.documentHelper.footnoteCollection[i]);return t},i.prototype.getFootNotesWidgetsInLine=function(e){for(var t=[],i=0;i<e.children.length;i++){var r=e.children[i];r instanceof Wa&&t.push(r)}return this.getFootNoteWidgetsBy(e.paragraph,t)},i.prototype.getFootNoteWidgetsBy=function(e,t){var i=[];if(e.bodyWidget.page.footnoteWidget)for(var r=0;r<e.bodyWidget.page.footnoteWidget.bodyWidgets.length;r++)for(var n=0;n<t.length;n++)e.bodyWidget.page.footnoteWidget.bodyWidgets[r].footNoteReference===t[n]&&i.push(e.bodyWidget.page.footnoteWidget.bodyWidgets[r]);if(0===i.length&&!sf.base.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget.bodyWidget.page.footnoteWidget)for(r=0;r<e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets.length;r++)for(n=0;n<t.length;n++)e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets[r].footNoteReference===t[n]&&i.push(e.previousRenderedWidget.bodyWidget.page.footnoteWidget.bodyWidgets[r]);else if(!sf.base.isNullOrUndefined(e.bodyWidget.previousRenderedWidget)&&e.bodyWidget.previousRenderedWidget.page.footnoteWidget)for(r=0;r<e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets.length;r++)for(n=0;n<t.length;n++)e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets[r].footNoteReference===t[n]&&i.push(e.bodyWidget.previousRenderedWidget.page.footnoteWidget.bodyWidgets[r]);else if(!sf.base.isNullOrUndefined(e.bodyWidget.nextRenderedWidget)&&e.bodyWidget.nextRenderedWidget.page.footnoteWidget)for(r=0;r<e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets.length;r++)for(n=0;n<t.length;n++)e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets[r].footNoteReference===t[n]&&i.push(e.bodyWidget.nextRenderedWidget.page.footnoteWidget.bodyWidgets[r]);return i},i.prototype.getFootNoteWidgetsOf=function(e,t){var i=[],r=[];if(e instanceof ga)for(var n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.childWidgets.length;s++)for(var a=o.childWidgets[s],l=0;l<a.childWidgets.length;l++){var d=a.childWidgets[l];r=this.getFootNotesOfBlock(d,r);for(var h=this.getFootNoteWidgetsBy(d,r),c=0;c<h.length;c++)-1===i.indexOf(h[c])&&i.push(h[c])}else if((r=this.getFootNotesOfBlock(e)).length>0&&(i=this.getFootNoteWidgetsBy(e,r)),t&&0===i.length)for(var p=0;p<r.length;p++)i.push(r[p].bodyWidget);return i},i.prototype.getFootNodeWidgetsToShiftToPage=function(e){for(var t,i=e.getSplitWidgets(),r=[],n=e.containerWidget,o=0;o<i.length;o++)for(var s=this.getFootNoteWidgetsOf(i[o]),a=0;a<s.length;a++)n!==(t=s[a].containerWidget)&&r.push(s[a]);return{footNoteWidgets:r,fromBodyWidget:t,toBodyWidget:n}},i.prototype.shiftTableWidget=function(e,t,i){void 0===i&&(i=!1);var r,n,o=[e];this.addTableWidget(this.viewer.clientActiveArea,o),this.viewer.updateClientAreaTopOrLeft(e,!0),e.wrapTextAround&&(r=this.viewer.clientActiveArea.clone(),n=this.viewer.clientArea.clone(),this.updateClientAreaForWrapTable(o,e,!0,r,n));for(var s=e.childWidgets[0];s;)s=(s=this.shiftRowWidget(o,s,i)).nextRow;return this.updateWidgetsToPage(o,[],e,!0),e.wrapTextAround&&e.bodyWidget&&this.updateClientAreaForWrapTable(o,e,!1,r,n),o[o.length-1]},i.prototype.shiftRowWidget=function(e,t,i){void 0===i&&(i=!1);var r=this.viewer;i&&(t.height=0);var n=t.ownerTable.isInsideTable;n||this.updateExistingFootnoteHeight(t);var o=[t];this.addTableRowWidget(r.clientActiveArea,o),r.updateClientAreaForRow(t,!0);for(var s=0;s<t.childWidgets.length;s++){var a=t.childWidgets[s];i&&(a.height=0),this.shiftCellWidget(a,this.getMaxTopCellMargin(t)+t.topBorderWidth,this.getMaxBottomCellMargin(t)+t.bottomBorderWidth,i)}if(r.updateClientAreaForRow(t,!1),!n){var l=this.footnoteHeight;this.updateFootnoteToBody(t,this.layoutedFootnoteElement),this.footnoteHeight=l}return this.updateWidgetsToTable(e,o,t,!1),n||(this.layoutedFootnoteElement=[]),o[o.length-1]},i.prototype.updateFootnoteToBody=function(e,t){this.layoutFootnoteInSplittedRow(e,this.getFootnoteBody(t)),sf.base.isNullOrUndefined(e.ownerTable.footnoteElement)&&(e.ownerTable.footnoteElement=[]);for(var i=0;i<t.length;i++)e.ownerTable.footnoteElement.push(t[i])},i.prototype.getFootnoteBody=function(e){for(var t=[],i=0;i<e.length;i++)t.push(e[i].bodyWidget);return t},i.prototype.shiftCellWidget=function(e,t,i,r){sf.base.isNullOrUndefined(r)&&(r=!1);var n=this.viewer;this.addTableCellWidget(e,n.clientActiveArea,t,i);var o=this.viewer.clientActiveArea.height;n.updateClientAreaForCell(e,!0);for(var s=0;s<e.childWidgets.length;s++){var a=e.childWidgets[s];n.updateClientAreaForBlock(a,!0),a instanceof ca?this.shiftParagraphWidget(a):this.shiftTableWidget(a,n,r),n.updateClientAreaForBlock(a,!1)}this.updateWidgetToRow(e),n.updateClientAreaForCell(e,!1),e.ownerTable.isInsideTable||(this.viewer.clientActiveArea.height=o)},i.prototype.shiftParagraphWidget=function(e){if(this.addParagraphWidget(this.viewer.clientActiveArea,e),e.floatingElements.length>0)for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],r=0;if(i instanceof La&&"Inline"===i.textWrappingStyle){var n=i.line.indexInOwner,o=0;r=x.convertPointToPixel(i.textFrame.marginTop);for(var s=0;s<n;s++)o+=e.childWidgets[s].height;i.y=e.y+o}else{var a=this.getFloatingItemPoints(i);i.y=a.y,i.x=a.x}i instanceof La&&this.updateChildLocationForCellOrShape(i.y+r,i)}this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height);for(var l=this.getFootNoteWidgetsOf(e,!0),d=0;d<l.length;d++)this.layoutedFootnoteElement.push(l[d].footNoteReference);this.footnoteHeight+=this.getFootNoteHeight(l),this.updateWidgetToPage(this.viewer,e)},i.prototype.updateContainerForTable=function(e,t){var i=this.getBodyWidgetOfPreviousBlock(e,0),r=i.bodyWidget,n=i.index,o=!sf.base.isNullOrUndefined(r.lastChild)&&!sf.base.isNullOrUndefined(r.lastChild.lastChild)&&r.lastChild.lastChild.isEndsWithPageBreak,s=!sf.base.isNullOrUndefined(r.lastChild)&&!sf.base.isNullOrUndefined(r.lastChild.lastChild)&&r.lastChild.lastChild.isEndsWithColumnBreak;r!==e.containerWidget&&(o||s?t.updateClientArea(e.bodyWidget,e.bodyWidget.page):this.updateContainerWidget(e,r,n+1,!0)),(e.isInHeaderFooter||this.viewer instanceof $s)&&(e.containerWidget.height-=e.height)},i.prototype.shiftWidgetsForTable=function(e,t){this.updateContainerForTable(e,t),this.viewer.updateClientAreaForBlock(e,!0,void 0,!1,!0);var i=this.viewer.clientArea.x;"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-x.convertPointToPixel(e.firstChild.firstChild.leftMargin)),this.updateVerticalPositionToTop(e,!0);var r=e.combineWidget(this.viewer);this.documentHelper.layout.updateChildLocationForTable(r.y,r),this.clearTableWidget(r,!0,!1,!1,!0),this.shiftTableWidget(r,this.viewer),this.updateVerticalPositionToTop(e,!1),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientArea.x=i),this.viewer.updateClientAreaForBlock(e,!1)},i.prototype.updateVerticalPositionToTop=function(e,t){for(var i=0;i<e.getSplitWidgets().length;i++)for(var r=e.getSplitWidgets()[i],n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];this.documentHelper.layout.updateCellVerticalPosition(a,t,!1)}},i.prototype.splitWidget=function(e,t,i,r,n,o,s){var a=e.childWidgets[0],l=e.paragraphFormat.keepLinesTogether&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?e.height:this.getMaxElementHeight(a),d=e.getSplitWidgets(),h=e.containerWidget;l=this.getMaximumLineHeightToSplit(e,l,t);var c=this.getFootNotesWidgetsInLine(a);if(sf.base.isNullOrUndefined(e.previousWidget)&&c.length>0)for(var p=0;p<c.length;p++)for(var g=0;g<c[p].childWidgets.length;g++)l+=c[p].childWidgets[g].height;if(t.clientActiveArea.height>=l&&!n&&!s){var f=void 0,u=d.indexOf(e);u<d.length-1?h=(f=d[u+1]).containerWidget:((f=new ca).index=e.index,f.characterFormat=e.characterFormat,f.paragraphFormat=e.paragraphFormat,f.width=e.width,f.x=e.x,f.y=e.y,d.push(f)),i===e.containerWidget||this.skipUpdateContainerWidget||this.updateContainerWidget(e,i,r,!0);for(p=e.childWidgets.length-1;p>0;p--){var m=e.childWidgets[p];if(this.isFitInClientArea(e,t,void 0)){1===f.childWidgets.length&&(this.updateParagraphWidgetInternal(m,f,0),this.skipUpdateContainerWidget=!0);break}var y=e.childWidgets[p];this.updateParagraphWidgetInternal(y,f,0)}if(sf.base.isNullOrUndefined(f.containerWidget)&&f.childWidgets.length>0){var v=t.clientActiveArea.y,w=new ia(t.clientArea.x,t.clientArea.y,t.clientArea.width,t.clientArea.height),b=new ia(t.clientActiveArea.x,t.clientActiveArea.y,t.clientActiveArea.width,t.clientActiveArea.height),x=e.bodyWidget.page;if(h=this.moveBlocksToNextPage(e,!1,-1),f.containerWidget=h,h.childWidgets.splice(0,0,f),x===h.page)return e.x!==e.containerWidget.x&&(e.x=e.containerWidget.x),e.y=v,t.updateClientArea(h,h.page),f=this.addParagraphWidget(this.viewer.clientActiveArea,f),!0;if(h.height+=f.height,h!=i&&this.moveFootNotesToPage(o,i,h),1===h.childWidgets.length&&h.firstChild instanceof ca&&h.firstChild.equals(e))return e.y=v,!0;t.clientArea=w,t.clientActiveArea=b}}else{var I=void 0,F=!1;t.columnLayoutArea.setColumns(i.sectionFormat),h=this.createOrGetNextBodyWidget(i,this.viewer);var C=this.alignBlockElement(e);if(this.isInitialLoad||sf.base.isNullOrUndefined(C.node)||e.isEndsWithPageBreak||e.isEndsWithColumnBreak||(I=C.node instanceof fa?this.splitRow(C.node):C.node).containerWidget instanceof aa&&I.containerWidget.firstChild!==I&&(e=I,F=!0,!sf.base.isNullOrUndefined(e.nextRenderedWidget)&&e.nextRenderedWidget instanceof ca&&(this.keepWithNext=!0,this.documentHelper.blockToShift=e.nextRenderedWidget)),e.containerWidget!==h||F){x=e.bodyWidget.page;if(i!==(h=this.moveBlocksToNextPage(e,!0))&&(t.updateClientArea(h,h.page),this.updateContainerWidget(e,h,0,!0),this.addParagraphWidget(this.viewer.clientActiveArea,e),this.moveFootNotesToPage(o,i,h)),i.page===h.page)return i!==h||(t.updateClientArea(h,h.page),!1)}}return i===e.containerWidget?(e.x!==e.containerWidget.x&&(e.x=e.containerWidget.x),e.y=t.clientActiveArea.y,t.cutFromTop(t.clientActiveArea.y+e.height)):t.updateClientArea(h,h.page),!1},i.prototype.getMaximumLineHeightToSplit=function(e,t,i){if(i.clientActiveArea.height>=t&&!e.paragraphFormat.keepLinesTogether&&e.paragraphFormat.widowControl&&!sf.base.isNullOrUndefined(e.previousWidget)&&sf.base.isNullOrUndefined(e.previousSplitWidget))for(var r=e.height,n=e.childWidgets.length-1;n>=0;n--){var o=e.childWidgets[n],s=this.getMaxElementHeight(o);if(o.height>s&&(r-=o.height-s),i.clientActiveArea.height>=r){0===n&&(t=e.height);break}r-=o.height}return t},i.prototype.moveFootNotesToPage=function(e,t,i){if(e.length>0&&t.page.footnoteWidget&&t.page!==i.page){for(var r=-1,n=void 0,o=0,s=!1,a=0;a<e.length;a++)if(n=e[a],(r=t.page.footnoteWidget.bodyWidgets.indexOf(n))>=0){void 0===i.page.footnoteWidget&&this.addEmptyFootNoteToBody(i);for(var l=0;l<i.page.footnoteWidget.bodyWidgets.length;l++){i.page.footnoteWidget.bodyWidgets[l].footNoteReference===n.footNoteReference&&(s=!0)}if(t.page.footnoteWidget.bodyWidgets.splice(r,1),i.page.footnoteWidget.bodyWidgets.indexOf(n)<0&&!s){i.page.footnoteWidget.bodyWidgets.length;var d=this.documentHelper.pages.indexOf(t.page),h=this.documentHelper.pages.indexOf(i.page);n.containerWidget=i.page.footnoteWidget,n.page=i.page,d>h?(i.page.footnoteWidget.bodyWidgets.push(n),o++):i.page.footnoteWidget.bodyWidgets.splice(o++,0,n),i.page.footnoteWidget.height+=n.height}t.page.footnoteWidget.height-=n.height}t.page.footnoteWidget&&0===t.page.footnoteWidget.bodyWidgets.length&&(t.page.footnoteWidget=void 0),void 0!==t.page.footnoteWidget&&this.layoutfootNote(t.page.footnoteWidget),void 0!==i.page.footnoteWidget&&this.layoutfootNote(i.page.footnoteWidget)}},i.prototype.addEmptyFootNoteToBody=function(e){var t=new ha;t.footNoteType="Footnote",t.page=e.page;var i=new ca;i.characterFormat=new T,i.paragraphFormat=new ul,i.index=0;var r=new ma(i);i.childWidgets.push(r),t.height=this.documentHelper.textHelper.getParagraphMarkSize(i.characterFormat).Height,t.margin=new na(0,t.height,0,0),e.page.footnoteWidget=t},i.prototype.getMaxElementHeight=function(e){var t=0;if(0===e.children.length||1===e.children.length&&e.children[0]instanceof Va||2===e.children.length&&e.children[0]instanceof Va&&e.children[1]instanceof Va){if(t=this.documentHelper.selection.getParagraphMarkSize(e.paragraph,0,0).height,t+=0,e.children.length>0)t<(r=e.children[0]).margin.top+r.height&&(t=r.margin.top+r.height)}else for(var i=0;i<e.children.length;i++){var r;t<(r=e.children[i]).margin.top+r.height&&(t=r.margin.top+r.height)}return t},i.prototype.createOrGetNextBodyWidget=function(e,t){t.columnLayoutArea.setColumns(e.sectionFormat);var i=t.columnLayoutArea.getNextColumnByBodyWidget(e);if(!sf.base.isNullOrUndefined(i))return this.createOrGetNextColumnBody(e);var r,n=void 0;r=this.documentHelper.pages.indexOf(e.page);var o,s=void 0;if(o=e.index,r===this.documentHelper.pages.length-1||this.documentHelper.pages[r+1].sectionIndex!==o){var a=new aa;a.sectionFormat=e.sectionFormat,a.index=e.index,s=t.createNewPage(a),this.documentHelper.pages[r+1].sectionIndex!==o&&this.documentHelper.insertPage(r+1,s),n=s.bodyWidgets[0]}else n=(s=this.documentHelper.pages[r+1]).bodyWidgets[0];return n},i.prototype.isFitInClientArea=function(e,t,i){var r=e.childWidgets[e.childWidgets.length-1],n=e.height,o=this.getMaxElementHeight(r);r.height>o&&(n-=r.height-o);var s=0;if(!sf.base.isNullOrUndefined(i)&&i.length>0){i[0].containerWidget instanceof ha&&(s=i[0].containerWidget.margin.top);for(var a=0;a<i.length;a++)for(var l=0;l<i[a].childWidgets.length;l++)s+=i[a].childWidgets[l].height}return t.clientActiveArea.height>=n+s},i.prototype.isLineInFootNote=function(e,t){for(var i=0;i<t.length;i++)if(t[i].line===e)return!0;return!1},i.prototype.shiftToPreviousWidget=function(e,t,i,r,n){var o=e.containerWidget,s=i.containerWidget,a=[],l=[];s!==o&&(a=this.getFootNotesOfBlock(e));for(var d=0;d<e.childWidgets.length;d++){var h=e.childWidgets[d],c=this.getMaxElementHeight(h);if(this.isLineInFootNote(h,a)){for(var p=this.getFootNoteWidgetsBy(h.paragraph,a),g=0,f=0;f<p.length;f++)for(var u=p[f],m=0;m<u.childWidgets.length;m++)g+=u.childWidgets[m].height;p.length>0&&p[0].containerWidget&&(g+=p[0].containerWidget.margin.top),c+=g}if(!(t.clientActiveArea.height>=c)||r||n){var y=i.containerWidget;t.updateClientArea(y,y.page);var v=this.createOrGetNextBodyWidget(y,t);e.containerWidget!==v&&(v=this.moveBlocksToNextPage(e,!0)),y!==v&&((a=this.getFootNotesOfBlock(e)).length>0&&(l=l.concat(this.getFootNoteWidgetsBy(e,a)),s=v),this.updateContainerWidget(e,v,0,!0)),t.updateClientArea(v,v.page);break}if(a.length>0&&this.isLineInFootNote(h,a)&&(l=l.concat(this.getFootNoteWidgetsBy(h.paragraph,a))),this.updateParagraphWidgetInternal(h,i,i.childWidgets.length),d--,t.cutFromTop(t.clientActiveArea.y+h.height),sf.base.isNullOrUndefined(e.childWidgets))break}!sf.base.isNullOrUndefined(l)&&l.length>0&&o.page.footnoteWidget&&o!=s&&this.moveFootNotesToPage(l,o,s)},i.prototype.updateParagraphWidgetInternal=function(e,t,i){sf.base.isNullOrUndefined(e.paragraph)||(e.paragraph.childWidgets.splice(e.paragraph.childWidgets.indexOf(e),1),e.paragraph.height-=e.height,sf.base.isNullOrUndefined(e.paragraph.containerWidget)||(e.paragraph.containerWidget.height-=e.height),(sf.base.isNullOrUndefined(e.paragraph.childWidgets)||0===e.paragraph.childWidgets.length)&&e.paragraph.destroyInternal(this.viewer)),!sf.base.isNullOrUndefined(e.paragraph)&&e.paragraph.floatingElements.length>0&&this.shiftFloatingElements(e,t),t.childWidgets.splice(i,0,e),e.paragraph=t,t.height+=e.height,sf.base.isNullOrUndefined(t.containerWidget)||(t.containerWidget.height+=e.height)},i.prototype.shiftFloatingElements=function(e,t){for(var i=0;i<e.children.length;i++)if(e.children[i]instanceof La&&"Inline"===e.children[i].textWrappingStyle){var r=e.paragraph.floatingElements.indexOf(e.children[i]);r>=0&&(e.paragraph.floatingElements.splice(r,1),t.floatingElements.splice(r,0,e.children[i]))}},i.prototype.shiftNextWidgets=function(e){for(var t=e;t.nextWidget instanceof da;){if(t=t.nextWidget,this.viewer instanceof Qs&&!this.isMultiColumnSplit&&t.bodyWidget.sectionFormat.columns.length>1){var i=this.getBodyWidget(t.bodyWidget,!1);if(!sf.base.isNullOrUndefined(i.nextRenderedWidget)&&i.page===i.nextRenderedWidget.page){this.splitBodyWidgetBasedOnColumn(t.bodyWidget);break}}this.reLayoutOrShiftWidgets(t,this.viewer)}},i.prototype.updateContainerWidget=function(e,t,i,r,n){if(!(e.containerWidget&&e.containerWidget.containerWidget instanceof ha)){var o=e.containerWidget;if(!sf.base.isNullOrUndefined(e.containerWidget)&&(e.containerWidget.childWidgets.splice(e.containerWidget.childWidgets.indexOf(e),1),e.containerWidget.height-=t.height,(sf.base.isNullOrUndefined(e.containerWidget.childWidgets)||0===e.containerWidget.childWidgets.length)&&e.containerWidget instanceof aa&&e.containerWidget!==t&&r)){var s=e.containerWidget.page;if(this.documentHelper.pages[this.documentHelper.pages.length-1]===s&&-1!==this.viewer.visiblePages.indexOf(s)&&this.documentHelper.scrollToBottom(),sf.base.isNullOrUndefined(s.nextPage)||s.nextPage.bodyWidgets[0].index!==e.containerWidget.index){var a=e.containerWidget;!sf.base.isNullOrUndefined(a.nextRenderedWidget)&&a.nextRenderedWidget.sectionFormat.columns.length>1&&(a.nextRenderedWidget.columnIndex=a.columnIndex),e.containerWidget.destroyInternal(this.viewer)}}if(t.childWidgets.splice(i,0,e),e instanceof ca&&!sf.base.isNullOrUndefined(e.floatingElements))for(var l=0;l<e.floatingElements.length;l++){var d=e.floatingElements[l];"Inline"!==d.textWrappingStyle&&(t.floatingElements.push(d),e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(d),1),t.floatingElements.sort((function(e,t){return e.y-t.y})))}e instanceof ga&&e.wrapTextAround&&-1!==e.bodyWidget.floatingElements.indexOf(e)&&e.bodyWidget.floatingElements.splice(e.bodyWidget.floatingElements.indexOf(e),1),t.height+=t.height,e.containerWidget=t,o&&o.page&&o.page.footnoteWidget&&n&&n.length>0&&this.moveFootNotesToPage(n,o,t)}},i.prototype.getBodyWidgetOfPreviousBlock=function(e,t){var i=void 0,r=e.previousRenderedWidget;return i=r&&r.containerWidget.equals(e.containerWidget)?r.containerWidget:e instanceof ga&&!sf.base.isNullOrUndefined(e.containerWidget.previousRenderedWidget)&&e.containerWidget.index===e.containerWidget.previousRenderedWidget.index?e.containerWidget.previousRenderedWidget:e.containerWidget,t=r&&r.containerWidget.equals(e.containerWidget)?i.childWidgets.indexOf(r):e.containerWidget.childWidgets.indexOf(e),{bodyWidget:i,index:t}},i.prototype.moveBlocksToNextPage=function(e,t,i,r){var n=e.bodyWidget;this.viewer.columnLayoutArea.setColumns(n.sectionFormat);var o=this.viewer.columnLayoutArea.getNextColumnByBodyWidget(e.bodyWidget),s=void 0,a=void 0;if(!(sf.base.isNullOrUndefined(o)||e instanceof ca&&e.isEndsWithPageBreak)&&((a=this.moveToNextColumnByBodyWidget(e,i)).columnIndex=o.index,a.y=e.bodyWidget.y,this.viewer.updateClientArea(a,a.page),this.viewer.clientActiveArea.height-=a.y-this.viewer.clientActiveArea.y,this.viewer.clientActiveArea.y=a.y,e.bodyWidget.sectionFormat.columns.length>1))for(var l=e.bodyWidget.columnIndex,d=e.bodyWidget.x+e.bodyWidget.sectionFormat.columns[l].width+e.bodyWidget.sectionFormat.columns[l].space,h=0;h<e.bodyWidget.floatingElements.length;h++)e.bodyWidget.floatingElements[h]instanceof La&&d<e.bodyWidget.floatingElements[h].x+e.bodyWidget.floatingElements[h].width&&a.floatingElements.push(e.bodyWidget.floatingElements[h]);if(sf.base.isNullOrUndefined(a)){var c=!1,p=n.page.index+1;if(this.documentHelper.pages.length>p&&(s=this.documentHelper.pages[p],sf.base.isNullOrUndefined(s)||0===s.bodyWidgets.length||n.sectionFormat.pageHeight!==s.bodyWidgets[0].sectionFormat.pageHeight||n.sectionFormat.pageWidth!==s.bodyWidgets[0].sectionFormat.pageWidth||"NoBreak"!==n.sectionFormat.breakCode?0===s.bodyWidgets.length||!n.equals(s.bodyWidgets[0])||n.sectionIndex!==s.bodyWidgets[0].sectionIndex&&"NewPage"===n.sectionFormat.breakCode?(s=void 0,c=!0):(a=s.bodyWidgets[0],this.viewer.updateClientArea(a,a.page)):s.bodyWidgets[0].index===n.index?(a=s.bodyWidgets[0],this.viewer.updateClientArea(a,a.page)):(a=this.createSplitBody(n),s.bodyWidgets.splice(0,0,a),a.page=s,this.viewer.updateClientArea(a,a.page),a.y=this.viewer.clientActiveArea.y)),sf.base.isNullOrUndefined(s)&&(a=this.createSplitBody(n),this.documentHelper.owner.editorHistory&&this.documentHelper.owner.editorHistory.isRedoing&&this.documentHelper.owner.editorHistory.currentBaseHistoryInfo&&"SectionBreakContinuous"===this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.action&&"NoBreak"===e.bodyWidget.sectionFormat.breakCode||r||(s=this.viewer.createNewPage(a,p),this.viewer.updateClientArea(a,a.page),a.y=this.viewer.clientActiveArea.y),c&&!sf.base.isNullOrUndefined(s)&&this.documentHelper.insertPage(p,s),this.clearLineMeasures()),s)for(;;){var g=n.page.bodyWidgets[n.page.bodyWidgets.length-1];if(this.isSectionBreakCont||n===g||n.containerWidget instanceof ha)break;n.page.bodyWidgets.splice(n.page.bodyWidgets.indexOf(g),1),s.bodyWidgets.splice(1,0,g),g.page=s}}if(this.isTextFormat){var f=n.childWidgets.indexOf(e),u=n.childWidgets.slice(f);n.childWidgets.splice(f);for(var m=0,y=u;m<y.length;m++){var v=y[m];a.childWidgets.push(v),v.containerWidget=a}}else for(;;){var w=void 0;if(w=n.lastChild instanceof ha?n.lastChild.previousWidget:n.lastChild,t){var b=this.getFootNoteWidgetsOf(w);this.moveFootNotesToPage(b,n,a)}if(e===w)break;if(n.childWidgets.splice(n.childWidgets.indexOf(w),1),a.childWidgets.splice(0,0,w),w instanceof ga&&-1!==n.floatingElements.indexOf(w)&&n.floatingElements.splice(n.floatingElements.indexOf(w),1),w instanceof ca&&w.floatingElements.length>0)for(var x=0;x<w.floatingElements.length;x++)-1!==n.floatingElements.indexOf(w.floatingElements[x])&&"Inline"!==w.floatingElements[x].textWrappingStyle&&(n.floatingElements.splice(n.floatingElements.indexOf(w.floatingElements[x]),1),a.floatingElements.push(w.floatingElements[x]));w.containerWidget=a,a.height+=w.height}return a},i.prototype.createSplitBody=function(e){var t=this.addBodyWidget(this.viewer.clientActiveArea);return t.sectionFormat=e.sectionFormat,t.index=e.index,t},i.prototype.createOrGetNextColumnBody=function(e){var t;return e.nextRenderedWidget&&e.columnIndex+1===e.nextRenderedWidget.columnIndex&&(t=e.nextRenderedWidget),sf.base.isNullOrUndefined(t)&&((t=new aa).sectionFormat=e.sectionFormat,t.index=e.index,t.page=e.page,t.y=e.y,e.containerWidget instanceof ha?(e.containerWidget.bodyWidgets.splice(e.containerWidget.bodyWidgets.indexOf(e)+1,0,t),t.containerWidget=e.containerWidget):e.page.bodyWidgets.splice(e.page.bodyWidgets.indexOf(e)+1,0,t)),t},i.prototype.moveToNextColumnByBodyWidget=function(e,t){var i=e.containerWidget;return this.createOrGetNextColumnBody(i)},i.prototype.reLayoutLine=function(e,t,i,r,n){var o,s;this.documentHelper.owner.editor.isFootnoteElementRemoved||(this.isFootnoteContentChanged=!1),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&!n&&this.viewer.owner.editorModule.updateWholeListItems(e),o=e.paragraphFormat.listFormat&&-1!==e.paragraphFormat.listFormat.listId?e.getSplitWidgets()[0].firstChild:e.childWidgets[t],e.containerWidget instanceof aa&&e.containerWidget.sectionFormat.numberOfColumns>1&&e.containerWidget.sectionFormat.equalWidth&&(s=o.previousLine),sf.base.isNullOrUndefined(s)&&(s=o),this.allowLayout&&(s.paragraph.splitTextRangeByScriptType(s.indexInOwner),s.paragraph.splitLtrAndRtlText(s.indexInOwner),s.paragraph.combineconsecutiveRTL(s.indexInOwner));var a=e.containerWidget;if(a.height-=e.height,!this.viewer.owner.enableHeaderAndFooter&&!e.isInHeaderFooter||a instanceof Aa?a instanceof Aa?this.viewer.updateClientAreaForTextBoxShape(a.containerShape,!0):this.viewer.updateClientArea(a,a.page,!0):(e.bodyWidget.isEmpty=!1,this.viewer.updateHeaderFooterClientAreaWithTop(e.bodyWidget.sectionFormat,this.documentHelper.isBlockInHeader(e),a.page)),this.viewer.updateClientAreaForBlock(e,!0),!sf.base.isNullOrUndefined(e.containerWidget)&&!sf.base.isNullOrUndefined(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof ha){var l=e.bodyWidget.containerWidget.y;return this.viewer.cutFromTop(l),this.documentHelper.owner.editor.isFootNoteInsert=!0,this.layoutfootNote(e.containerWidget.containerWidget),void(this.documentHelper.owner.editor.isFootNoteInsert=!1)}if(s.paragraph.isEmpty())this.viewer.cutFromTop(e.y),this.layoutParagraph(e,0);else{if(this.updateClientAreaForLine(s),this.layoutListItems(s.paragraph),s.isFirstLine()&&!sf.base.isNullOrUndefined(e.paragraphFormat)){var d=-x.convertPointToPixel(e.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(d)}do{e=(s=this.layoutLine(s,0)).paragraph,s=s.nextLine}while(s);this.updateWidgetToPage(this.viewer,e),this.viewer.updateClientAreaForBlock(e,!1)}this.layoutNextItemsBlock(e,this.viewer);var h=e.getSplitWidgets()[0].previousRenderedWidget;if(!(sf.base.isNullOrUndefined(h)||e.isEndsWithPageBreak||e.isEndsWithColumnBreak||h instanceof ca&&(!(h instanceof ca)||h.isEndsWithPageBreak||h.isEndsWithColumnBreak)||(this.viewer.cutFromTop(e.y+e.height),e.containerWidget===h.containerWidget||sf.base.isNullOrUndefined(h.containerWidget)))){var c=e.containerWidget,p=h.containerWidget,g=this.getFootNoteWidgetsOf(e);sf.base.isNullOrUndefined(p.page.footnoteWidget)||this.moveFootNotesToPage(g,p,c)}var f,u=this.documentHelper.pages.length,m=this.documentHelper.pages[u-1],y=m.bodyWidgets[m.bodyWidgets.length-1];if(!this.documentHelper.owner.editor.isFootnoteElementRemoved&&!this.isFootnoteContentChanged||sf.base.isNullOrUndefined(e.bodyWidget.page.footnoteWidget)||(f=e.bodyWidget.page.footnoteWidget,this.layoutfootNote(f)),sf.base.isNullOrUndefined(this.viewer.owner.editorHistory)||!this.viewer.owner.editorHistory.isRedoing||sf.base.isNullOrUndefined(y.page.endnoteWidget)||(this.isEndnoteContentChanged=!0),(this.documentHelper.owner.editor.isEndnoteElementRemoved||this.isEndnoteContentChanged)&&!sf.base.isNullOrUndefined(y.page.endnoteWidget)){f=y.page.endnoteWidget;var v=this.viewer.clientArea.clone(),w=this.viewer.clientActiveArea.clone(),b=y.childWidgets[y.childWidgets.length-1];l=b.y+b.height;this.viewer.clientActiveArea.height=this.viewer.clientActiveArea.bottom-l,this.viewer.clientActiveArea.x=this.viewer.clientArea.x,this.viewer.clientActiveArea.width=this.viewer.clientArea.width,this.viewer.clientActiveArea.y=l,this.layoutfootNote(f),this.viewer.clientArea=v,this.viewer.clientActiveArea=w}!sf.base.isNullOrUndefined(this.viewer.owner.editorHistory)&&this.viewer.owner.editorHistory.isRedoing&&(this.isEndnoteContentChanged=!1)},i.prototype.isContainsRtl=function(e){if(this.viewer.documentHelper.isSelectionChangedOnMouseMoved&&!this.isDocumentContainsRtl)return!1;for(var t=!1,i=0;i<e.children.length;i++)if(e.children[i]instanceof Fa&&(t=e.children[i].characterFormat.bidi||"RTL"===e.children[i].characterFormat.bdo||this.documentHelper.textHelper.isRTLText(e.children[i].text))){this.isDocumentContainsRtl||(this.isDocumentContainsRtl=t);break}return t},i.prototype.shiftElementsForRTLLayouting=function(t,i){var r=this.hasTextRangeBidi(t);if(this.isContainsRTLText(t)||i||r){for(var n=[],o=[],s=0;s<t.children.length;s++){var a=t.children[s];if(a instanceof Fa&&a.height>0&&!a.isPageBreak&&"\v"!==a.text){var l=a;o.push(l.characterFormat.bidi),"\t"==l.text?n.push(e.Tab):n.push(l.characterRange),a.isRightToLeft=n[n.length-1]==e.RightToLeft}else if(a instanceof al||a instanceof Na||a instanceof _a||a instanceof qa||a instanceof Oa||a instanceof va){var d=this.isStartMarker(a),h=this.isEndMarker(a);if(d&&s<t.children.length-1){var c=this.getNextValidWidget(s+1,t);if(!sf.base.isNullOrUndefined(c)&&c instanceof Fa&&c.height>0){l=c;o.push(l.characterFormat.bidi),"\t"===c.text?n.push(e.Tab):n.push(l.characterRange)}else o.push(!1),n.push(e.LeftToRight)}else!h&&s>0?(o.push(o[o.length-1]),n.push(n[n.length-1])):(o.push(!1),n.push(e.LeftToRight))}else a instanceof Va&&i?(o.push(i),n.push(e.RightToLeft)):(o.push(!1),n.push(e.LeftToRight))}var p=-1,g=void 0;for(s=0;s<n.length;s++)if(s+1<o.length&&o[s]!=o[s+1])-1!=p&&(this.updateCharacterRange(t,s,p,o,n),p=-1),g=null;else{if(s>0&&s!=n.length-1&&n[s]==e.WordSplit&&o[s]&&n[s-1]==e.Number&&o[s-1]&&n[s+1]==e.Number&&o[s+1]&&this.isNumberNonReversingCharacter(t.children[s]))n[s]=e.Number;else if(n[s]==e.RightToLeft||n[s]==e.LeftToRight||n[s]==e.Number&&-1!=p||(sf.base.isNullOrUndefined(g)||!g)&&o[s])if(-1==p&&n[s]!=e.LeftToRight)p=s;else{if(-1==p){n[s]==e.LeftToRight?g=!0:n[s]==e.RightToLeft&&(g=!1);continue}n[s]==e.LeftToRight&&(this.updateCharacterRange(t,s,p,o,n),p=n[s]==e.RightToLeft||n[s]==e.Number&&-1!=p?s:-1)}n[s]==e.LeftToRight?g=!0:n[s]==e.RightToLeft&&(g=!1)}if(-1!=p&&p<n.length-1&&(this.updateCharacterRange(t,n.length-1,p,o,n),p=-1),n.length!=t.children.length)throw new Error("Splitted Widget count mismatch while reordering layouted child widgets of a line");var f=this.reorderElements(t,n,o,i);o.length=0,n.length=0,t.children.length>0&&(t.layoutedElements=f)}return i},i.prototype.isNumberNonReversingCharacter=function(e){if(e instanceof Fa){var t=e;if(!t.characterFormat.hasValueWithParent("localeIdBidi"))return L.isNumberNonReversingCharacter(t.text,t.characterFormat.bidi);var i=t.text.charCodeAt(0);if(47==i&&!this.isNumberReverseLangForSlash(t.characterFormat.localeIdBidi)||(35==i||36==i||37==i||43==i||45==i)&&!this.isNumberReverseLangForOthers(t.characterFormat.localeIdBidi)||44==i||46==i||58==i||1548==i)return!0}return!1},i.prototype.isNumberReverseLangForSlash=function(e){return this.isNumberReverseLangForOthers(e)||6145==e||1164==e||1125==e||1120==e||1123==e||1065==e||2137==e||1114==e||1119==e||1152==e||1056==e},i.prototype.isNumberReverseLangForOthers=function(e){return 14337==e||15361==e||5121==e||3073==e||2049==e||11265==e||13313==e||12289==e||4097==e||8193==e||16385==e||1025==e||10241==e||7169==e||9217==e},i.prototype.isStartMarker=function(e){return e instanceof al?0===e.commentType:e instanceof Na?0===e.bookmarkType:e instanceof _a||(e instanceof Oa?0===e.type:e instanceof va&&0===e.fieldType)},i.prototype.isEndMarker=function(e){return e instanceof al?1===e.commentType:e instanceof Na?1===e.bookmarkType:e instanceof _a||(e instanceof Oa?1===e.type:e instanceof va&&1===e.fieldType)},i.prototype.getNextValidWidget=function(e,t){for(var i=e;i<t.children.length;i++){var r=t.children[i];if(!(r instanceof al||r instanceof Na||r instanceof _a||r instanceof qa||r instanceof Oa||r instanceof va))return r[i]}return null},i.prototype.hasTextRangeBidi=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];if(i instanceof Fa)if(i.characterFormat.bidi)return!0}return!1},i.prototype.isContainsRTLText=function(e){for(var t=e.paragraph.bodyWidget.page.documentHelper.textHelper,i=!1,r=0;r<e.children.length&&!(e.children[r]instanceof Fa&&(i=e.children[r].characterFormat.bidi||1==e.children[r].characterFormat.bidi||t.isRTLText(e.children[r].text)));r++);return i},i.prototype.updateCharacterRange=function(t,i,r,n,o){var s=i;if(!n[i]){o[i]===e.LeftToRight&&s--;for(var a=s;a>=r;a--)if(o[a]!=e.WordSplit){s=a;break}}for(a=r;a<=s;a++)if(o[a]==e.WordSplit){o[a]=e.RightToLeft|e.WordSplit;var l=a-1,d=a+1;if(l>=0&&d<o.length&&o[l]==e.RightToLeft&&(o[d]==e.RightToLeft||o[d]==e.Number)&&t.children[a]instanceof Fa){var h=t.children[a];if("Times New Roman"==h.characterFormat.fontFamilyBidi){var c=h.text.split("").reverse().join("");h.text=c}}}},i.prototype.reorderElements=function(t,i,r,n){for(var o=0,s=-1,a=0,l=0,d=[],h=e.LeftToRight,c=!1,p=0;p<t.children.length;p++){var g=t.children[p],f=g;f.characterRange=i[p];var u=(f.characterRange&e.RightToLeft)==e.RightToLeft||f.characterRange==e.Number,m=r[p];if(i[p]==e.Tab){if(n){o=0,s=-1,a=0,h=e.LeftToRight,c=!1,d.splice(o,0,g);continue}m&&(m=!1)}p>0&&c!=m&&(n?(o=0,s=-1,a=0):s=d.length-1,l=0),m||u?u||m&&f.characterRange==e.WordSplit&&(h==e.RightToLeft||this.isInsertWordSplitToLeft(i,r,p))?(a++,o=s+1,f.characterRange==e.Number&&(h==e.Number&&(o+=l),l++),d.splice(o,0,g)):(d.splice(o,0,g),o++,a=0):(n?(a>0&&c==m&&(o+=a),d.splice(o,0,g),o++):(d.push(g),o=p+1),a=0,s=n?o-1:d.length-1),f.characterRange!=e.Number&&(l=0),f.characterRange!=e.WordSplit&&(h=f.characterRange),c=m}return d},i.prototype.isInsertWordSplitToLeft=function(t,i,r){for(var n=r+1;n<t.length;n++){if((t[n]&e.RightToLeft)==e.RightToLeft)return!0;if(t[n]==e.LeftToRight)return!i[n]}return!0},i.prototype.shiftLayoutFloatingItems=function(e){for(var t=0;t<e.floatingElements.length;t++){var i=e.floatingElements[t],r=this.getFloatingItemPoints(i),n=r.y-i.y;if(i.x=r.x,i.y=r.y,i instanceof La)for(var o=0;o<i.textFrame.childWidgets.length;o++){var s=i.textFrame.childWidgets[o];s instanceof ca?s.y=s.y+n:s instanceof ga&&this.shiftChildLocationForTableWidget(s,n)}}},i.prototype.getFloatingItemPoints=function(e){var t=e.line.paragraph,i=t.bodyWidget.sectionFormat,r=0,n=0;if(t){var o=x.convertPointToPixel(i.leftMargin),s=x.convertPointToPixel(i.rightMargin),a=x.convertPointToPixel(i.topMargin),l=i.bottomMargin>0?x.convertPointToPixel(i.bottomMargin):48,d=x.convertPointToPixel(i.headerDistance),h=x.convertPointToPixel(i.footerDistance),c=x.convertPointToPixel(i.pageWidth),p=x.convertPointToPixel(i.pageHeight),g=c-(o+s),f=p-a-l;a=t.isInHeaderFooter&&i.topMargin<=0?Math.abs(a)>0?Math.abs(a):x.convertPointToPixel(i.headerDistance)+t.height:a>0?a:48,!t.isInHeaderFooter&&a<this.viewer.clientArea.y&&(a=this.viewer.clientArea.y);var u="InFrontOfText",m=!1,y=e.verticalOrigin,v=e.horizontalOrigin,w=e.horizontalAlignment,b=e.verticalAlignment,F=e.verticalRelativePercent,C=(e.horizontalRelativePercent,e.height),W=e.width,k=e.verticalPosition,S=e.horizontalPosition,P=e.layoutInCell,N=e.heightRelativePercent,O=e.widthRelativePercent,T=void 0;if(e instanceof La&&(T=e.autoShapeType),t.isInsideTable&&P)m=!0,n=this.getVerticalPosition(e,k,y,u),r=this.getHorizontalPosition(e.width,e,w,v,S,u,t.associatedCell.cellFormat.cellWidth);else if(this.documentHelper.viewer instanceof $s){switch(y){case"Line":n=this.documentHelper.selection.getTop(e.line);break;default:n=this.viewer.clientActiveArea.y}switch(v){case"Character":r=this.viewer.clientActiveArea.x;break;default:switch(w){case"Center":r=this.viewer.clientArea.width/2-e.width/2;break;default:r=this.viewer.clientArea.x}}}else{switch(y){case"Page":case"TopMargin":switch(n=k,b){case"Top":n=k;break;case"Center":"TopMargin"===y?n=(a-C)/2:N>0&&O>0?(n=(p-p*(N/100))/2,e.height=p*(N/100)):n=(p-C)/2;break;case"Outside":case"Bottom":n="Page"===y&&"Bottom"===b?p-C:"TopMargin"===y?a-C:(t.bodyWidget.page.index+1)%2!=0?p-C-h/2:d/2;break;case"Inside":"Page"===y?n=(t.bodyWidget.page.index+1)%2==0?p-C-h/2:d/2:(t.bodyWidget.page.index+1)%2==0&&(n=(a-C)/2-d);break;case"None":n=Math.abs(F)<=1e3?p*(F/100):k}break;case"Line":switch(n=k,b){case"Inside":case"Top":n=this.viewer.clientActiveArea.y;break;case"Center":n=this.viewer.clientActiveArea.y-C/2;break;case"Outside":case"Bottom":n=this.viewer.clientActiveArea.y-C;break;case"None":n=Math.round(t.y)+k}break;case"BottomMargin":switch(n=k,b){case"Inside":case"Top":n=p-l;break;case"Center":n=p-l+(l-C)/2;break;case"Outside":case"Bottom":n=t.bodyWidget.page.index+1!==0&&"Outside"===b?p-l:p-C;break;case"None":n=p-l+k}break;case"InsideMargin":case"OutsideMargin":switch(n=k,b){case"Inside":n="InsideMargin"===y?"InsideMargin"===y&&t.bodyWidget.page.index+1===0?p-C:0:(t.bodyWidget.page.index+1)%2!=0?p-l:a-C;break;case"Top":n="InsideMargin"===y?(t.bodyWidget.page.index+1)%2==0?p-l:0:(t.bodyWidget.page.index+1)%2!=0?p-l:0;break;case"Center":n="OutsideMargin"===y?(t.bodyWidget.page.index+1)%2!=0?p-l+(l-C)/2:(a-C)/2:(t.bodyWidget.page.index+1)%2==0?p-l+(l-C)/2:(a-C)/2;break;case"Outside":n="InsideMargin"===y?(t.bodyWidget.page.index+1)%2==0?p-l:a-C:(t.bodyWidget.page.index+1)%2!=0?a-C:p-l;break;case"Bottom":n="OutsideMargin"===y?t.bodyWidget.page.index+1!==0?p-C:a-C:(t.bodyWidget.page.index+1)%2==0?p-C:a-C}break;case"Paragraph":n=Math.round(t.y)+0+k;break;case"Margin":switch(n=t.isInHeaderFooter&&d>a?d+t.height+k:a+k,b){case"Top":n=a;break;case"Center":n=a+(f-C)/2;break;case"Outside":case"Bottom":n=(t.bodyWidget.page.index+1)%2!=0?a+f-C:a;break;case"Inside":n=(t.bodyWidget.page.index+1)%2==0?a+f-C:a}break;default:n=this.viewer.clientArea.y-k}switch(v){case"Page":switch(r=S,w){case"Center":m?r=(t.associatedCell.cellFormat.cellWidth-W)/2:N>0&&O>0?(r=(c-c*(O/100))/2,e.width=c*(O/100)):r=(c-W)/2;break;case"Left":r=0;break;case"Outside":case"Right":r=m?t.associatedCell.cellFormat.cellWidth-W:c-W;break;case"None":r=m?t.associatedCell.x+S:S}r<0&&m&&(r=t.associatedCell.x);break;case"Column":var H=!1;if(this.viewer.clientActiveArea.x<t.x?r=t.x+S:!e.paragraph.isInsideTable&&("StraightConnector"===T||"Rectangle"===T||e instanceof Da)?(H=!0,r=S+t.bodyWidget.x):r=t.x+S,t.paragraphFormat.leftIndent&&!H)r-=x.convertPointToPixel(t.leftIndent);switch(w){case"Center":r=this.viewer.clientActiveArea.x+(this.viewer.clientActiveArea.width-W)/2;break;case"Left":r=this.viewer.clientActiveArea.x;break;case"Right":r=this.viewer.clientActiveArea.x+this.viewer.clientActiveArea.width-W}break;case"Margin":if(t.bodyWidget)switch(r=o+S,w){case"Center":r=o+(g-W)/2;break;case"Left":r=o;break;case"Outside":(t.bodyWidget.page.index+1)%2!=0&&(r=o+g-W);break;case"Right":r=o+g-W;break;case"Inside":(t.bodyWidget.page.index+1)%2==0&&(r=o+g-W)}else r=this.viewer.clientArea.x+S;break;case"Character":r="Right"===w||"Center"===w?this.getLeftMarginHorizPosition(o,w,S,W,u):this.viewer.clientArea.x+S;break;case"LeftMargin":r=this.getLeftMarginHorizPosition(o,w,S,W,u);break;case"RightMargin":r=this.getRightMarginHorizPosition(c,s,w,S,W,u);break;case"InsideMargin":r=(t.bodyWidget.page.index+1)%2==0?this.getRightMarginHorizPosition(c,s,w,S,W,u):this.getLeftMarginHorizPosition(o,w,S,W,u);break;case"OutsideMargin":r=(t.bodyWidget.page.index+1)%2==0?this.getLeftMarginHorizPosition(o,w,S,W,u):this.getRightMarginHorizPosition(c,s,w,S,W,u);break;default:r=this.viewer.clientArea.x+S}0}!t||"Paragraph"!==y&&"Line"!==y||"InFrontOfText"===e.textWrappingStyle||"Behind"===e.textWrappingStyle||"Word2013"===this.documentHelper.compatibilityMode&&(t.isInHeaderFooter||(n+e.height>this.viewer.clientArea.bottom&&(n=this.viewer.clientArea.bottom-e.height),n<i.topMargin&&(n=i.topMargin)))}return new I(r,n)},i.prototype.getLeftMarginHorizPosition=function(e,t,i,r,n){var o=i;switch(t){case"Center":o=(e-r)/2;break;case"Left":o=0;break;case"Right":o=e-r}return o<0&&"InFrontOfText"!==n&&"Behind"!==n&&(o=0),o},i.prototype.getRightMarginHorizPosition=function(e,t,i,r,n,o){var s=e-t,a=s+r;switch(i){case"Center":a=s+(t-n)/2;break;case"Left":a=s;break;case"Right":a=e-n}return(a<0||a+n>e)&&"InFrontOfText"!==o&&"Behind"!==o&&(a=e-n),a},i.prototype.getVerticalPosition=function(e,t,i,r){var n=e.line.paragraph,o=e,s=0,a=n.associatedCell.y;switch(i){case"Page":case"Margin":case"TopMargin":case"InsideMargin":case"BottomMargin":case"OutsideMargin":s=a+t;break;case"Line":case"Paragraph":s=n.y+t+0,"Square"==o.textWrappingStyle&&(s=s<=n.associatedCell.y?n.associatedCell.y:s);break;default:s=this.viewer.clientActiveArea.y+t}return s},i.prototype.getHorizontalPosition=function(e,t,i,r,n,o,s){var a=0,l=t.line.paragraph.associatedCell,d=s-l.leftMargin-l.rightMargin,h=l.cellFormat.cellWidth,c=l.x,p=c-l.leftMargin;switch(r){case"Page":switch(a=n,i){case"Center":a=p+(d-e)/2;break;case"Left":a=p;break;case"Right":a=p+(d-e);break;case"None":a=p+n}break;case"Column":case"Margin":switch(i){case"Center":a=c+(h-e)/2;break;case"Left":a=c;break;case"Right":a=c+(h-e);break;case"None":a=c+n}break;default:a=c+n}return a},i.prototype.updateTableFloatPoints=function(e){if(e.wrapTextAround){var t=e.getTableCellWidth(),i=e.positioning,r=e.bodyWidget.sectionFormat;if(this.documentHelper.viewer instanceof $s)"Margin"!==i.horizontalOrigin&&"Page"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=this.viewer.clientArea.width-t:this.viewer.clientActiveArea.x=this.viewer.clientArea.x);else if(e.containerWidget instanceof Aa||e.isInsideTable){if(e.isInsideTable){var n=e.containerWidget,o=n.cellFormat;"Page"===i.verticalOrigin?(this.viewer.clientActiveArea.y=n.y,this.viewer.clientActiveArea.y+=x.convertPointToPixel(i.verticalPosition)):"Margin"===i.verticalOrigin?(this.viewer.clientActiveArea.y+=x.convertPointToPixel(i.verticalPosition),(this.viewer.clientActiveArea.y<n.y||"Top"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y=n.y)):this.viewer.clientActiveArea.y+x.convertPointToPixel(i.verticalPosition)<n.y?this.viewer.clientActiveArea.y=n.y:this.viewer.clientActiveArea.y+=x.convertPointToPixel(i.verticalPosition),"Page"===i.horizontalOrigin?"Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=n.x:"Right"!==i.horizontalAlignment&&"Outside"!==i.horizontalAlignment||(this.viewer.clientActiveArea.x=n.x+o.preferredWidth-t):"Margin"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=n.x+n.leftMargin:"Right"!==i.horizontalAlignment&&"Outside"!==i.horizontalAlignment||(this.viewer.clientActiveArea.x=n.x+o.preferredWidth-(t+n.rightMargin))),Math.round(i.horizontalPosition)>0&&(this.viewer.clientActiveArea.x=n.x,"Margin"===i.horizontalOrigin&&(this.viewer.clientActiveArea.x+=n.leftMargin),this.viewer.clientActiveArea.x+=x.convertPointToPixel(i.horizontalPosition)),"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=o.preferredWidth/2-t/2)}}else"Page"===i.verticalOrigin?"Top"===i.verticalAlignment||"Inside"===i.verticalAlignment?this.viewer.clientActiveArea.y=0:(sf.base.isNullOrUndefined(i.verticalAlignment)||"None"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y=x.convertPointToPixel(i.verticalPosition)):"Margin"===i.verticalOrigin?"Top"===i.verticalAlignment||"Inside"===i.verticalAlignment?this.viewer.clientActiveArea.y=x.convertPointToPixel(r.topMargin):0==Math.round(i.verticalPosition)||sf.base.isNullOrUndefined(r.topMargin)?this.viewer.clientActiveArea.y=x.convertPointToPixel(i.verticalPosition):this.viewer.clientActiveArea.y=x.convertPointToPixel(r.topMargin+i.verticalPosition):"Paragraph"===i.verticalOrigin&&(sf.base.isNullOrUndefined(i.verticalAlignment)||"None"===i.verticalAlignment)&&(this.viewer.clientActiveArea.y+=x.convertPointToPixel(i.verticalPosition)),"Page"===i.horizontalOrigin?"Left"===i.horizontalAlignment||"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=0:"Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=x.convertPointToPixel(r.pageWidth)-t:"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=(x.convertPointToPixel(r.pageWidth)-t)/2):"Margin"!==i.horizontalOrigin&&"Column"!==i.horizontalOrigin||("Left"===i.horizontalAlignment?(this.viewer.clientActiveArea.x=x.convertPointToPixel(r.leftMargin),"Word2013"===this.documentHelper.compatibilityMode||e.isInsideTable||(this.viewer.clientActiveArea.x=this.viewer.clientActiveArea.x-x.convertPointToPixel(e.firstChild.firstChild.leftMargin))):"Inside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=x.convertPointToPixel(r.leftMargin):"Right"===i.horizontalAlignment||"Outside"===i.horizontalAlignment?this.viewer.clientActiveArea.x=x.convertPointToPixel(r.pageWidth)-(x.convertPointToPixel(r.rightMargin)+t):"Center"===i.horizontalAlignment&&(this.viewer.clientActiveArea.x=x.convertPointToPixel(r.leftMargin)+(x.convertPointToPixel(r.pageWidth-r.rightMargin-r.leftMargin)-t)/2)),Math.round(i.horizontalPosition)>0&&(this.viewer.clientActiveArea.x+=x.convertPointToPixel(i.horizontalPosition))}e.x=this.viewer.clientActiveArea.x,e.y=this.viewer.clientActiveArea.y},i.prototype.isTocField=function(e){if(e instanceof va){var t=e.nextNode;if(e instanceof va&&0===e.fieldType&&t instanceof Fa&&-1!==t.text.trim().toLowerCase().indexOf("toc"))return!0}return!1},i.prototype.getTotalColumnSpan=function(e){for(var t=e,i=0,r=0;r<t.childWidgets.length;r++)i+=t.childWidgets[r].cellFormat.columnSpan;return i},i.prototype.getMaximumRightCellBorderWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i],n=r.childWidgets[r.childWidgets.length-1].cellFormat.borders.right.lineWidth;t<n&&(t=n)}return t},i.prototype.getDefaultBorderSpacingValue=function(e,t,i){return 0==e?(e="Word2013"!=this.documentHelper.compatibilityMode&&"Center"==i?1.5:.75,!0):t},i.prototype.getMinimumWidthRequiredForTable=function(e,t,i){var r=0;return r="Word2013"==this.documentHelper.compatibilityMode?"Center"==t?e?18.5+Math.round(.375):18.5+Math.round(i/2):e?19.25:18.5+i:"Center"==t?e?19.25:18.5+i/2:.25==i?18.5:19.3,x.convertPointToPixel(r)},i.prototype.shiftFloatingItemsFromTable=function(e,t){if(e.containerWidget instanceof aa)for(var i=0;i<e.containerWidget.floatingElements.length;i++){var r=e.containerWidget.floatingElements[i];!(r instanceof ga)&&r.paragraph.containerWidget instanceof ua&&r.paragraph.containerWidget.ownerTable.containerWidget.ownerTable==e&&(t.floatingElements.push(e.containerWidget.floatingElements[i]),e.containerWidget.floatingElements.splice(e.containerWidget.floatingElements.indexOf(e.containerWidget.floatingElements[i]),1),this.shiftedFloatingItemsFromTable.push(r),i--)}},i}(),R=function(){function e(){this.style={},this.context=new U}return e.prototype.getContext=function(e,t){return this.context},e.prototype.toDataURL=function(e,t){return this.context.renderedPath},e}(),U=function(){function e(){this.renderedPath=""}return Object.defineProperty(e.prototype,"globalAlpha",{set:function(e){this.renderedPath+="GA:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCompositeOperation",{set:function(e){this.renderedPath+="GCP:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fillStyle",{set:function(e){this.renderedPath+="FS:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeStyle",{set:function(e){this.renderedPath+="SS:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"direction",{set:function(e){this.renderedPath+="Dir:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"font",{set:function(e){this.renderedPath+="Fn:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlign",{set:function(e){this.renderedPath+="TA:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textBaseline",{set:function(e){this.renderedPath+="TBL:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{set:function(e){this.renderedPath+="LW:"+e+";"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineCap",{set:function(e){this.renderedPath+="LC:"+e+";"},enumerable:!0,configurable:!0}),e.prototype.drawImage=function(e,t,i,r,n,o,s,a,l){this.renderedPath+="LC:"+e.src+";",this.renderedPath+="sx:"+t+";",this.renderedPath+="sy:"+i+";",this.renderedPath+="sw:"+r+";",this.renderedPath+="sh:"+n+";",o&&(this.renderedPath+="dx:"+o+";"),s&&(this.renderedPath+="dy:"+s+";"),a&&(this.renderedPath+="dw:"+a+";"),l&&(this.renderedPath+="dh:"+l+";")},e.prototype.beginPath=function(){this.renderedPath+="BP;"},e.prototype.clip=function(e){this.renderedPath+="Cl;"},e.prototype.fill=function(e){this.renderedPath+="Fl;"},e.prototype.stroke=function(){this.renderedPath+="Stk;"},e.prototype.closePath=function(){this.renderedPath+="CP;"},e.prototype.lineTo=function(e,t){this.renderedPath+="LT:x:"+e+";y:"+t+";"},e.prototype.moveTo=function(e,t){this.renderedPath+="MT:x:"+e+";y:"+t+";"},e.prototype.rect=function(e,t,i,r){this.renderedPath+="Rt:x:"+e+";y:"+t+";w:"+i+";h:"+r+";"},e.prototype.setLineDash=function(e){this.renderedPath+="Sgm:"+e.toString()+";"},e.prototype.clearRect=function(e,t,i,r){this.renderedPath+="CR:x:"+e+";y:"+t+";w:"+i+";h:"+r+";"},e.prototype.fillRect=function(e,t,i,r){this.renderedPath+="FR:x:"+e+";y:"+t+";w:"+i+";h:"+r+";"},e.prototype.strokeRect=function(e,t,i,r){this.renderedPath+="SR:x:"+e+";y:"+t+";w:"+i+";h:"+r+";"},e.prototype.restore=function(){this.renderedPath+="RES;"},e.prototype.save=function(){this.renderedPath+="S;"},e.prototype.fillText=function(e,t,i,r){this.renderedPath+="FT:"+e+";x:"+t+";y:"+i+";",r&&(this.renderedPath+="MW:"+r+";")},e.prototype.measureText=function(e){return{width:30}},e.prototype.strokeText=function(e,t,i,r){this.renderedPath+="ST:"+e+";x:"+t+";y:"+i+";",r&&(this.renderedPath+="MW:"+r+";")},e.prototype.scale=function(e,t){this.renderedPath+="SC:x:"+e+";y:"+t+";"},e}(),B=function(){function i(e){this.commentMarkDictionary=new a,this.isPrinting=!1,this.isExporting=!1,this.pageLeft=0,this.pageTop=0,this.pageIndex=-1,this.isFieldCode=!1,this.isRenderHeader=!1,this.leftPosition=0,this.topPosition=0,this.height=0,this.fieldStacks=[],this.documentHelper=e}return Object.defineProperty(i.prototype,"pageCanvas",{get:function(){return this.isPrinting?(sf.base.isNullOrUndefined(this.pageCanvasIn)&&(this.pageCanvasIn=document.createElement("canvas"),this.pageCanvasIn.getContext("2d").save()),this.pageCanvasIn):this.isExporting?(sf.base.isNullOrUndefined(this.exportPageCanvas)&&(this.exportPageCanvas=new R),this.exportPageCanvas):sf.base.isNullOrUndefined(this.viewer)?void 0:this.documentHelper.containerCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"spellChecker",{get:function(){return this.documentHelper.owner.spellChecker},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectionCanvas",{get:function(){return sf.base.isNullOrUndefined(this.viewer)?void 0:this.documentHelper.selectionCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"pageContext",{get:function(){return this.pageCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),i.prototype.renderWidgets=function(e,t,i,r,n){if(!sf.base.isNullOrUndefined(this.pageCanvas)&&!sf.base.isNullOrUndefined(e)){if(this.pageContext.fillStyle=x.getColor(this.documentHelper.backgroundColor),this.pageContext.beginPath(),this.viewer instanceof $s){n=n>this.documentHelper.visibleBounds.height?n:this.documentHelper.visibleBounds.height;var o=i;0===e.index&&(o=i-this.viewer.padding.top),this.pageContext.fillRect(t-this.viewer.padding.left,o,r+this.viewer.padding.left,n+this.viewer.padding.top)}else this.pageContext.fillRect(t,i,r,n);this.pageContext.closePath(),this.viewer instanceof Qs&&(this.pageContext.strokeStyle=this.documentHelper.owner.pageOutline,this.pageContext.strokeRect(t,i,r,n)),this.pageLeft=t,this.pageTop=i,this.pageIndex=e.index,this.isPrinting?this.setPageSize(e):(this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(t,i,r,n),this.pageContext.clip()),this.height=n,e.headerWidget&&this.renderHFWidgets(e,e.headerWidgetIn,r,!0),e.footerWidget&&this.renderHFWidgets(e,e.footerWidgetIn,r,!1);for(var s=0;s<e.bodyWidgets.length;s++)this.render(e,e.bodyWidgets[parseInt(s.toString(),10)]),e.footnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(e,e.footnoteWidget,r);e.endnoteWidget&&"Pages"===this.documentHelper.owner.layoutType&&this.renderfootNoteWidget(e,e.endnoteWidget,r),this.documentHelper.owner.enableHeaderAndFooter&&!this.isPrinting&&this.renderHeaderSeparator(e,this.pageLeft,this.pageTop,e.headerWidgetIn),this.pageLeft=0,this.pageTop=0,this.pageContext.restore()}},i.prototype.setPageSize=function(e){this.pageContext.clearRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContext.restore(),this.selectionContext.restore();var t=e.boundingRectangle.width,i=e.boundingRectangle.height,r=Math.max(window.devicePixelRatio,this.documentHelper.owner.documentEditorSettings.printDevicePixelRatio);this.pageCanvas.width===t*r&&this.pageCanvas.height===i*r||(this.pageCanvas.height=i*r,this.pageCanvas.width=t*r,this.pageCanvas.style.height=i+"px",this.pageCanvas.style.width=t+"px",this.pageContext.globalAlpha=1,this.pageContext.scale(r,r)),this.pageContext.fillStyle="#FFFFFF",this.pageContext.fillRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.pageContext.fillStyle="#000000"},i.prototype.renderHFWidgets=function(e,t,i,r){this.isFieldCode&&(this.isFieldCode=!1),this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?1:.65);var n=!1,o=e.boundingRectangle.height/100*40;if(r){var s=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin);Math.max(t.y+t.height,s)>o&&(n=!0,this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.pageTop,i,this.getScaledValue(o)),this.pageContext.clip())}else{var a=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),l=void 0;l=(sf.base.isNullOrUndefined(e.footerWidgetIn.sectionFormat),e.boundingRectangle.height-Math.max(e.footerWidgetIn.height+a,x.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin))),Math.max(e.boundingRectangle.height-o,l),e.boundingRectangle.height-a}this.renderFloatingItems(e,t.floatingElements,"Behind");for(var d=0;d<t.childWidgets.length;d++){var h=t.childWidgets[parseInt(d.toString(),10)];r||h.height,this.renderWidget(e,h)}this.renderFloatingItems(e,t.floatingElements,"InFrontOfText"),n&&this.pageContext.restore(),this.isPrinting||(this.pageContext.globalAlpha=this.documentHelper.owner.enableHeaderAndFooter?.5:1)},i.prototype.renderHeaderSeparator=function(e,t,i,r){var n=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),o=this.getScaledValue(Math.max(r.y+r.height,Math.abs(n))),s=this.getScaledValue(e.boundingRectangle.width),a=this.pageContext;a.save(),a.globalAlpha=.85;var l=this.getScaledValue(e.boundingRectangle.height)/100*40;o=Math.min(o,l),this.renderDashLine(a,t,i+o,s,"#000000",!1);var d=this.getHeaderFooterType(e,!0),h=this.viewer.getHeaderFooter(r.headerFooterType),c=e.sectionIndex;if(this.documentHelper.headersFooters.length>1){var p=c+1;d=d+" -"+this.documentHelper.owner.localeKeys.DocumentEditor_Section+" "+p+"-"}a.font="9pt Arial";var g,f=a.measureText(d).width;if(this.renderHeaderFooterMark(a,t+5,i+o,f+10,20),this.renderHeaderFooterMarkText(a,d,t+10,o+i+15),this.documentHelper.headersFooters[parseInt(c.toString(),10)]&&(g=this.documentHelper.headersFooters[parseInt(c.toString(),10)][parseInt(h.toString(),10)]),0!=c&&!g){var u=this.documentHelper.owner.localeKeys.DocumentEditor_SameAsPrevious,m=a.measureText(u).width,y=this.viewer.containerWidth-m-75+t;this.renderHeaderFooterMark(a,y,i+o,m+10,20),this.renderHeaderFooterMarkText(a,u,y+5,o+i+15)}if(e.footerWidget){var v=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),w=this.getScaledValue(e.boundingRectangle.height)-this.getScaledValue(Math.max(e.footerWidgetIn.height+v,Math.abs(x.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin))));w=Math.max(this.getScaledValue(e.boundingRectangle.height)-l,w),this.renderDashLine(a,t,i+w,s,"#000000",!1);var b=this.getHeaderFooterType(e,!1),I=e.sectionIndex;if(this.documentHelper.headersFooters.length>1){p=I+1;b=b+" -"+this.documentHelper.owner.localeKeys.DocumentEditor_Section+" "+p+"-"}f=a.measureText(b).width,this.renderHeaderFooterMark(a,t+5,i+w-20,f+10,20),this.renderHeaderFooterMarkText(a,b,t+10,i+w-5);var F,C=this.viewer.getHeaderFooter(e.footerWidget.headerFooterType);if(this.documentHelper.headersFooters[parseInt(I.toString(),10)]&&(F=this.documentHelper.headersFooters[parseInt(I.toString(),10)][parseInt(C.toString(),10)]),0!=I&&!F){u=this.documentHelper.owner.localeKeys.DocumentEditor_SameAsPrevious;var W=a.measureText(u).width;y=this.viewer.containerWidth-W-75+t;this.renderHeaderFooterMark(a,y,i+w-20,W+10,20),this.renderHeaderFooterMarkText(a,u,y+5,i+w-5)}a.restore()}},i.prototype.getFooterHeight=function(e){var t=e.boundingRectangle.height/100*40,i=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),r=e.boundingRectangle.height-Math.max(e.footerWidgetIn.height+i,x.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin));return Math.max(e.boundingRectangle.height-t,r)},i.prototype.getHeaderFooterType=function(e,t){var i;return i=t?this.documentHelper.owner.localeKeys.DocumentEditor_Header:this.documentHelper.owner.localeKeys.DocumentEditor_Footer,e.bodyWidgets[0].sectionFormat.differentFirstPage&&(sf.base.isNullOrUndefined(e.previousPage)||e.sectionIndex!==e.previousPage.sectionIndex)?i=t?this.documentHelper.owner.localeKeys.DocumentEditor_FirstPageHeader:this.documentHelper.owner.localeKeys.DocumentEditor_FirstPageFooter:e.bodyWidgets[0].sectionFormat.differentOddAndEvenPages&&(i=(this.documentHelper.pages.indexOf(e)+1)%2==0?t?this.documentHelper.owner.localeKeys.DocumentEditor_EvenPageHeader:this.documentHelper.owner.localeKeys.DocumentEditor_EvenPageFooter:t?this.documentHelper.owner.localeKeys.DocumentEditor_OddPageHeader:this.documentHelper.owner.localeKeys.DocumentEditor_OddPageFooter),i},i.prototype.renderDashLine=function(e,t,i,r,n,o){e.beginPath(),e.strokeStyle=n,e.lineWidth=1,o?e.setLineDash([3,2]):e.setLineDash([6,4]),e.moveTo(t,i),e.lineTo(t+r,i),e.stroke(),e.setLineDash([]),e.closePath()},i.prototype.renderSolidLine=function(e,t,i,r,n){e.beginPath(),e.strokeStyle=n,e.lineWidth=.5,e.moveTo(t,i),e.lineTo(t+r,i),e.stroke(),e.closePath()},i.prototype.renderHeaderFooterMark=function(e,t,i,r,n){e.beginPath(),e.fillStyle="lightgray",e.fillRect(t,i,r,n),e.strokeStyle="black",e.strokeRect(t,i,r,n),e.closePath()},i.prototype.renderHeaderFooterMarkText=function(e,t,i,r){e.beginPath(),e.fillStyle="#000000",e.textBaseline="alphabetic",e.fillText(t,i,r),e.closePath()},i.prototype.render=function(e,t){this.isFieldCode&&(this.isFieldCode=!1);for(var i=0;i<e.bodyWidgets.length;i++)sf.base.isNullOrUndefined(e.bodyWidgets[i].floatingElements)||this.renderFloatingItems(e,e.bodyWidgets[i].floatingElements,"Behind");var r,n=!1;if(sf.base.isNullOrUndefined(t.nextRenderedWidget)||t.columnIndex+1!==t.nextRenderedWidget.columnIndex||(r=t.nextRenderedWidget),!(this.viewer instanceof $s)&&t.sectionFormat.columns.length>1&&!sf.base.isNullOrUndefined(r)){var o=e.bodyWidgets.indexOf(t),s=void 0,a=void 0;0===t.columnIndex?(s=e.bodyWidgets[o].x-x.convertPointToPixel(e.bodyWidgets[o].sectionFormat.leftMargin),a=x.convertPointToPixel(e.bodyWidgets[o].sectionFormat.leftMargin)+t.sectionFormat.columns[t.columnIndex].width+t.sectionFormat.columns[t.columnIndex].space/2):t.columnIndex===t.sectionFormat.columns.length-1?(s=e.bodyWidgets[o].x-t.sectionFormat.columns[t.columnIndex-1].space/2,a=x.convertPointToPixel(e.bodyWidgets[o].sectionFormat.rightMargin)+t.sectionFormat.columns[t.columnIndex].width+t.sectionFormat.columns[t.columnIndex-1].space/2):(s=e.bodyWidgets[o].x-t.sectionFormat.columns[t.columnIndex].space/2,a=t.sectionFormat.columns[t.columnIndex].width+t.sectionFormat.columns[t.columnIndex].space),this.clipRect(s,e.bodyWidgets[o].y,this.getScaledValue(a),this.getScaledValue(e.boundingRectangle.height)),n=!0}for(i=0;i<t.childWidgets.length;i++){var l=t.childWidgets[parseInt(i.toString(),10)];0===i&&t.childWidgets[0]instanceof ga&&t.childWidgets[0].childWidgets.length>0&&e.repeatHeaderRowTableWidget&&this.renderHeader(e,l,this.documentHelper.layout.getHeader(t.childWidgets[0])),this.renderWidget(e,l)}for(i=0;i<e.bodyWidgets.length;i++)sf.base.isNullOrUndefined(e.bodyWidgets[i].floatingElements)||this.renderFloatingItems(e,e.bodyWidgets[i].floatingElements,"InFrontOfText");n&&this.pageContext.restore();for(i=0;i<e.bodyWidgets.length;i++)if(!0===e.bodyWidgets[parseInt(i.toString(),10)].sectionFormat.lineBetweenColumns&&0!==e.bodyWidgets[parseInt(i.toString(),10)].columnIndex&&e.bodyWidgets.length>1){var d=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),h=this.getScaledValue(Math.max(e.headerWidgetIn.y+e.headerWidgetIn.height,d)),c=this.getScaledValue(e.boundingRectangle.height)/100*40,p=x.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),g=this.getScaledValue(e.boundingRectangle.height)-this.getScaledValue(Math.max(e.footerWidgetIn.height+p,x.convertPointToPixel(e.footerWidgetIn.sectionFormat.bottomMargin)));g=Math.max(this.getScaledValue(e.boundingRectangle.height)-c,g);var f=(e.bodyWidgets[parseInt(i.toString(),10)].x-(e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.x+e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.width))/2+(e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.x+e.bodyWidgets[parseInt(i.toString(),10)].previousRenderedWidget.width),u=this.documentHelper.zoomFactor,m=f,y=void 0;y=e.footnoteWidget?(g-e.footerWidgetIn.height/2-e.footnoteWidget.height*this.documentHelper.zoomFactor)/this.documentHelper.zoomFactor:(g-e.footerWidgetIn.height/2)/this.documentHelper.zoomFactor;var v=this.documentHelper.layout.getBodyWidget(e.bodyWidgets[parseInt(i.toString(),10)],!0),w=this.documentHelper.layout.getNextWidgetHeight(v);u=e.bodyWidgets[parseInt(i.toString(),10)].y,y=w;this.renderSingleBorder("#000000",f,u,m,y,.5,"Single")}},i.prototype.renderFloatingItems=function(e,t,i){if(!sf.base.isNullOrUndefined(t)&&t.length>0){var r=new a;t.sort((function(e,t){return e instanceof ga||t instanceof ga?0:e.zOrderPosition-t.zOrderPosition}));for(var n=0;n<t.length;n++)if(!(t[n]instanceof ga)){var o=t[n];if(!("Behind"===i&&"Behind"!==o.textWrappingStyle||"Behind"!==i&&"Behind"===o.textWrappingStyle))if(!this.isOverLappedShapeWidget(o)||r.containsKey(o.zOrderPosition)){if(o instanceof Da)this.renderImageElementBox(o,o.x,o.y,0);else if(o instanceof La){var s=this.getScaledValue(o.x,1),l=this.getScaledValue(o.y,2);this.renderShapeElementBox(o,s,l,e)}}else r.containsKey(o.zOrderPosition)||r.add(o.zOrderPosition,o)}if(r.length>0)for(var d=r.keys.sort(),h=0;h<d.length;h++){if((o=r.get(d[h]))instanceof Da)this.renderImageElementBox(o,o.x,o.y,0);else if(o instanceof La){s=this.getScaledValue(o.x,1),l=this.getScaledValue(o.y,2);this.renderShapeElementBox(o,s,l,e)}}}},i.prototype.isOverLappedShapeWidget=function(e){return e instanceof Da&&"Inline"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&!("Word2013"!==this.documentHelper.compatibilityMode&&e.isBelowText&&"InFrontOfText"!==e.textWrappingStyle)||e instanceof La&&"Inline"!==e.textWrappingStyle&&"Behind"!==e.textWrappingStyle&&!("Word2013"!==this.documentHelper.compatibilityMode&&e.isBelowText&&"InFrontOfText"!==e.textWrappingStyle)},i.prototype.renderShapeElementBox=function(e,t,i,r){if(!e.isHorizontalRule){var n=0===e.height,o=e.autoShapeType,s=e.textFrame.childWidgets;i+=e.margin.top,this.pageContext.beginPath(),e.fillFormat&&e.fillFormat.color&&e.fillFormat.fill&&"StraightConnector"!==o&&(this.pageContext.fillStyle=e.fillFormat.color,this.pageContext.fillRect(t,i,this.getScaledValue(e.width),this.getScaledValue(e.height))),sf.base.isNullOrUndefined(o)||e.lineFormat.line&&"None"!==e.lineFormat.lineFormatType&&(this.pageContext.lineWidth=e.lineFormat.weight,this.pageContext.strokeStyle=x.getColor(e.lineFormat.color),"StraightConnector"!==o?this.pageContext.strokeRect(t,i,this.getScaledValue(e.width),this.getScaledValue(e.height)):(this.pageContext.moveTo(t,i),this.pageContext.lineTo(t+this.getScaledValue(e.width),i+this.getScaledValue(e.height)),this.pageContext.stroke())),this.pageContext.closePath();var a=!1;0!=e.width&&0!=e.height&&(a=!0,this.clipRect(e.x,e.y,this.getScaledValue(e.width),this.getScaledValue(e.height)));for(var l=0;l<s.length;l++)this.renderWidget(r,s[l]),n&&"StraightConnector"!==o&&(e.height=x.round(e.height+s[l].height,5));n&&(n=!1),a&&this.pageContext.restore()}},i.prototype.renderWidget=function(e,t){t instanceof ca?this.renderParagraphWidget(e,t):this.renderTableWidget(e,t)},i.prototype.renderHeader=function(e,t,i){if(!sf.base.isNullOrUndefined(i)){e.viewer.updateClientArea(e.bodyWidgets[0],e);var r=e.viewer.clientArea.y,n=i.ownerTable.getSplitWidgets()[0];if(0!==n.childWidgets.length&&-1===t.childWidgets.indexOf(i)){var o=n.clone();o.childWidgets=[],e.viewer.updateClientAreaLocation(o,new ia(e.viewer.clientArea.x,r,o.width,o.height)),this.updateTableHeaderRows(i,o,e,r),this.isRenderHeader=!0;for(var s=0;s<o.childWidgets.length;s++){for(var a=o.childWidgets[s],l=void 0,d=0;d<a.childWidgets.length;d++)l=a.childWidgets[d],this.renderTableCellWidget(e,l);r+=a.height}this.isRenderHeader=!1,t.y!==r&&e.documentHelper.layout.updateChildLocationForTable(r,t)}}},i.prototype.updateTableHeaderRows=function(e,t,i,r){for(var n=e.ownerTable,o=1,s=0;s<n.childWidgets.length;s++){var a=n.childWidgets[s];if(a.rowFormat.isHeader){var l=a.clone();if(t.childWidgets.push(l),l.containerWidget=t,i.viewer.updateClientAreaLocation(l,new ia(i.viewer.clientArea.x,r,l.width,l.height)),i.documentHelper.layout.updateChildLocationForRow(r,l),r+=l.height,a==e){for(var d=0;d<e.childWidgets.length;d++){var h=e.childWidgets[d];o=Math.max(o,h.cellFormat.rowSpan)}if(o>1&&s+o<n.childWidgets.length)for(var c=1;c<o;c++){var p=n.childWidgets[s+c];if(!sf.base.isNullOrUndefined(p)){var g=p.clone();t.childWidgets.push(g),g.containerWidget=t,i.viewer.updateClientAreaLocation(g,new ia(i.viewer.clientArea.x,r,g.width,g.height)),i.documentHelper.layout.updateChildLocationForRow(r,g),r+=g.height}}}}}},i.prototype.renderParagraphWidget=function(e,t){if(!this.isFieldCode||!t.isFieldCodeBlock){var i=t.y,r=t.x,n=!1,o=t.firstChild,s=0;if(!sf.base.isNullOrUndefined(o))for(var a=0;a<o.children.length;a++){var l=o.children[a];if(l instanceof Fa){s=l.padding.left;break}}s>0&&(this.clipRect(t.x+s,this.getScaledValue(e.boundingRectangle.y),this.getScaledValue(e.boundingRectangle.width),this.getScaledValue(e.boundingRectangle.height)),n=!0),t.containerWidget instanceof la&&t.containerWidget.isEmpty&&!sf.base.isNullOrUndefined(this.documentHelper.selection)&&!sf.base.isNullOrUndefined(this.documentHelper.selection.start.paragraph)&&!this.documentHelper.selection.start.paragraph.isInHeaderFooter||this.renderParagraphBorder(e,t),n&&this.pageContext.restore();for(a=0;a<t.childWidgets.length;a++){var d=t.childWidgets[a];i+=d.marginTop,this.renderLine(d,e,r,i),i+=d.height}}},i.prototype.renderParagraphBorder=function(e,t){var i=t.paragraphFormat.borders.left,r=t.paragraphFormat.borders.top,n=t.paragraphFormat.borders.right,o=t.paragraphFormat.borders.bottom,s=0,a=0,l=0,d=0,h=0,c=t.firstChild,p=t.lastChild,g=this.documentHelper.canRenderBorder(t);sf.base.isNullOrUndefined(i)||"None"===i.lineStyle||(l=s=this.documentHelper.getParagraphLeftPosition(t)-x.convertPointToPixel(i.space),d=a+t.height,d="None"!==r.lineStyle&&c.isFirstLine()&&!g.skipTopBorder?(a=t.y+this.getTopMargin(t)-x.convertPointToPixel(r.lineWidth+r.space))+t.height-(this.getTopMargin(t)-x.convertPointToPixel(r.lineWidth+r.space)):(a=t.y)+t.height,"None"!==o.lineStyle&&p.isLastLine()&&!g.skipBottomBorder&&(d=d+x.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t)),h=x.convertPointToPixel(i.lineWidth),this.renderSingleBorder(i.color,s,a,l,d,h,i.lineStyle)),sf.base.isNullOrUndefined(r)||"None"===r.lineStyle||!c.isFirstLine()||g.skipTopBorder||(l=(s=this.documentHelper.getParagraphLeftPosition(t))+this.getContainerWidth(t,e),d=a=t.y+this.getTopMargin(t)-x.convertPointToPixel(r.lineWidth+r.space),"None"!==i.lineStyle&&(s-=x.convertPointToPixel(i.space)),"None"!==n.lineStyle&&(l+=x.convertPointToPixel(n.space)),h=x.convertPointToPixel(r.lineWidth),this.renderSingleBorder(r.color,s,a,l,d,h,r.lineStyle)),sf.base.isNullOrUndefined(n)||"None"===n.lineStyle||(l=s=this.documentHelper.getParagraphLeftPosition(t)+this.getContainerWidth(t,e)+x.convertPointToPixel(n.space),d=(a=d)+t.height,d="None"!==r.lineStyle&&c.isFirstLine()&&!g.skipTopBorder?(a=t.y+this.getTopMargin(t)-x.convertPointToPixel(r.lineWidth+r.space))+t.height-(this.getTopMargin(t)-x.convertPointToPixel(r.lineWidth+r.space)):(a=t.y)+t.height,"None"!==o.lineStyle&&p.isLastLine()&&!g.skipBottomBorder&&(d=d+x.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t)),h=x.convertPointToPixel(n.lineWidth),this.renderSingleBorder(n.color,s,a,l,d,h,n.lineStyle)),sf.base.isNullOrUndefined(o)||"None"===o.lineStyle||!p.isLastLine()||g.skipBottomBorder||(l=(s=this.documentHelper.getParagraphLeftPosition(t))+this.getContainerWidth(t,e),d=a=t.y+t.height+x.convertPointToPixel(o.lineWidth+o.space)-this.getBottomMargin(t),"None"!==i.lineStyle&&(s-=x.convertPointToPixel(i.space)),"None"!==n.lineStyle&&(l+=x.convertPointToPixel(n.space)),h=x.convertPointToPixel(o.lineWidth),this.renderSingleBorder(o.color,s,a,l,d,h,o.lineStyle))},i.prototype.getContainerWidth=function(e,t){var i=0;if(e.paragraphFormat.firstLineIndent<0&&(i=Math.abs(e.paragraphFormat.firstLineIndent)),e.isInsideTable){var r=e.associatedCell;return r.width+r.margin.left+r.margin.right-r.leftBorderWidth}if(this.viewer instanceof $s){var n=x.convertPointToPixel(e.leftIndent+e.rightIndent);return(this.documentHelper.visibleBounds.width-n-4*this.viewer.padding.right-2*this.viewer.padding.left)/this.documentHelper.zoomFactor}var o=e.bodyWidget;if(o instanceof aa&&o.sectionFormat.columns.length>1){var s=o.columnIndex;return o.sectionFormat.columns[s].width+x.convertPointToPixel(i-(e.rightIndent+e.leftIndent))}var a=o.sectionFormat.pageWidth-o.sectionFormat.leftMargin-o.sectionFormat.rightMargin;return x.convertPointToPixel(a+i-(e.rightIndent+e.leftIndent))},i.prototype.getTopMargin=function(e){if(e.isEmpty())return e.childWidgets[0].margin.top;var t=e.childWidgets[0],i=0;return sf.base.isNullOrUndefined(t.margin)||(i=t.margin.top),i},i.prototype.getBottomMargin=function(e){if(e.isEmpty())return e.childWidgets[e.childWidgets.length-1].margin.bottom;var t=e.childWidgets[e.childWidgets.length-1],i=0;return sf.base.isNullOrUndefined(t.margin)||(i=t.margin.bottom),i},i.prototype.renderfootNoteWidget=function(e,t,i){1===t.page.bodyWidgets.length&&(1===t.page.bodyWidgets[0].childWidgets.length&&null!=t.page.bodyWidgets[0].childWidgets[0].isEmpty&&t.page.bodyWidgets[0].childWidgets[0].isEmpty()||t.page.bodyWidgets[0].childWidgets.length);var r=this.getFooterHeight(e),n=t.y+t.height;n>r&&(n=r-t.y),this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.getScaledValue(t.y,2),this.getScaledValue(i),this.getScaledValue(n)),this.pageContext.clip();for(var o=0;o<t.bodyWidgets.length;o++)for(var s=t.bodyWidgets[o],a=s.footNoteReference,l=0;l<s.childWidgets.length;l++){var d=s.childWidgets[l];if(0===o&&0===l){var h=this.pageContext,c=e.bodyWidgets[0].x;if(e.bodyWidgets.length>1&&!sf.base.isNullOrUndefined(s.nextWidget)&&"NoBreak"!==s.nextWidget.sectionFormat.breakCode){var p=e.bodyWidgets[0].width;this.renderSolidLine(h,this.getScaledValue(c,1),this.getScaledValue(t.y+t.margin.top/2+1,2),p*this.documentHelper.zoomFactor,"#000000")}else this.renderSolidLine(h,this.getScaledValue(c,1),this.getScaledValue(t.y+t.margin.top/2+1,2),210*this.documentHelper.zoomFactor,"#000000")}if(0===l&&!sf.base.isNullOrUndefined(a)&&d.childWidgets[0].children[0]instanceof Fa&&!this.documentHelper.owner.editor.isFootNoteInsert){var g=d.childWidgets[0].children[0];g.text=g.text.replace(g.text,a.text),g.width=a.width}this.renderWidget(e,d)}this.pageContext.restore()},i.prototype.renderTableWidget=function(e,t){if(!this.isFieldCode)for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];if(this.renderTableRowWidget(e,r),t.tableFormat.cellSpacing>0&&this.renderTableOutline(t),r.isRenderBookmarkEnd&&this.documentHelper.owner.documentEditorSettings.showBookmarks){var n=r.lastChild,o=n.ownerTable.isBidiTable?ua.getCellLeftBorder(n):ua.getCellRightBorder(n),s=x.convertPointToPixel(o.getLineWidth()),a=this.documentHelper.selection.getLastParagraph(r.lastChild),l=a.lastChild.height-a.lastChild.margin.bottom;this.renderBookmark(this.getScaledValue(n.x+n.width+n.margin.right-s/2+this.documentHelper.textHelper.getParagraphMarkWidth(a.characterFormat),1),this.getScaledValue(n.y-n.margin.top,2),this.getScaledValue(l),1)}}},i.prototype.renderTableRowWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];if(this.renderTableCellWidget(e,r),r.isRenderBookmarkEnd&&this.documentHelper.owner.documentEditorSettings.showBookmarks){var n=this.documentHelper.selection.getLastParagraph(r),o=n.lastChild,s=this.documentHelper.selection.getEndPosition(n);this.renderBookmark(this.getScaledValue(s.x,1),this.getScaledValue(s.y,2),this.getScaledValue(o.height-o.margin.bottom),1)}}},i.prototype.renderTableCellWidget=function(e,t){if(!this.isPrinting){var i,r;if(i=t.margin.top-t.containerWidget.topBorderWidth,r=t.margin.bottom-t.containerWidget.bottomBorderWidth,this.getScaledValue(t.y,2)+t.height+r*this.documentHelper.zoomFactor<0||this.getScaledValue(t.y,2)-i>this.documentHelper.visibleBounds.height)return}this.renderSelectionHighlightOnTable(e,t),this.renderTableCellOutline(e.documentHelper,t);for(var n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n],s=t.width+t.margin.left+t.margin.right-t.leftBorderWidth;this.isPrinting||this.clipRect(t.x-t.margin.left,t.y,this.getScaledValue(s),this.getScaledValue(this.height)),this.renderWidget(e,o),this.pageContext.restore()}if(t.isRenderEditRangeStart){var a=this.documentHelper.selection.getFirstParagraph(t).firstChild,l=a.paragraph.x,d=a.paragraph.y;if(this.documentHelper.owner.documentEditorSettings.highlightEditableRanges){var h=e.documentHelper.selection.editRegionHighlighters,c=sf.base.isNullOrUndefined(h)?[]:h.get(a),p=sf.base.isNullOrUndefined(c)||sf.base.isNullOrUndefined(c[0])?"ffff00":c[0].color;this.renderBookmark(this.getScaledValue(l,1),this.getScaledValue(d,2),this.getScaledValue(a.height-a.margin.bottom),0,p)}}if(t.isRenderEditRangeEnd){var g=this.documentHelper.selection.getLastParagraph(t),f=g.lastChild,u=this.documentHelper.selection.getEndPosition(g);l=this.documentHelper.textHelper.getWidth(String.fromCharCode(164),f.paragraph.characterFormat)+u.x;if(this.documentHelper.owner.documentEditorSettings.highlightEditableRanges){h=e.documentHelper.selection.editRegionHighlighters,c=sf.base.isNullOrUndefined(h)?[]:h.get(f),p=sf.base.isNullOrUndefined(c)||sf.base.isNullOrUndefined(c[0])?"ffff00":c[0].color;this.renderBookmark(this.getScaledValue(l,1),this.getScaledValue(u.y,2),this.getScaledValue(f.height-f.margin.bottom),0,p)}}},i.prototype.checkHeaderFooterLineWidget=function(e,t){var i;if(e instanceof ma?i=e.paragraph.bodyWidget:e instanceof ua&&(i=e.bodyWidget),!sf.base.isNullOrUndefined(i.parentHeaderFooter)){i=i.parentHeaderFooter;for(var r=0;r<t.length;r++){var n=t[r];if(n instanceof ma&&e instanceof ma){var o=n.getHierarchicalIndex(""),s=e.getHierarchicalIndex("");if(n.paragraph.isInHeaderFooter&&i===n.paragraph.bodyWidget&&o.substring(o.indexOf(";"))===s.substring(s.indexOf(";")))return n}else if(n instanceof ua&&e instanceof ua){o=n.getHierarchicalIndex(""),s=e.getHierarchicalIndex("");if(n.ownerTable.isInHeaderFooter&&i===n.ownerTable.bodyWidget&&o.substring(o.indexOf(";"))===s.substring(s.indexOf(";")))return n}}}},i.prototype.renderEditRegionHighlight=function(e,t,i){if(e.documentHelper.selection&&!sf.base.isNullOrUndefined(e.documentHelper.selection.editRegionHighlighters)){var r=e.documentHelper.selection.editRegionHighlighters.containsKey(t);if(!r&&t.paragraph.isInHeaderFooter){var n=e.documentHelper.selection.editRegionHighlighters.keys;t=this.checkHeaderFooterLineWidget(t,n),sf.base.isNullOrUndefined(t)||(r=!0)}if(r)for(var o=e.documentHelper.selection.editRegionHighlighters.get(t),s=0;s<o.length;s++)this.pageContext.fillStyle=""!==o[s].color?o[s].color:"#add8e6",this.pageContext.fillRect(this.getScaledValue(o[s].left,1),this.getScaledValue(i,2),this.getScaledValue(o[s].width),this.getScaledValue(t.height))}},i.prototype.renderSearchHighlight=function(e,t,i){if(this.documentHelper.owner.searchModule&&!sf.base.isNullOrUndefined(e.documentHelper.owner.searchModule.searchHighlighters)){var r=e.documentHelper.owner.searchModule.searchHighlighters.containsKey(t);if(!r&&t.paragraph.isInHeaderFooter){var n=e.documentHelper.owner.searchModule.searchHighlighters.keys;t=this.checkHeaderFooterLineWidget(t,n),sf.base.isNullOrUndefined(t)||(r=!0)}if(r)for(var o=e.documentHelper.owner.searchModule.searchHighlighters.get(t),s=0;s<o.length;s++)this.pageContext.fillStyle=this.viewer.owner.documentEditorSettings.searchHighlightColor,this.pageContext.fillRect(this.getScaledValue(o[s].left,1),this.getScaledValue(i,2),this.getScaledValue(o[s].width),this.getScaledValue(t.height))}},i.prototype.renderSelectionHighlight=function(e,t,i){if(!this.isPrinting&&e.documentHelper.owner.selection&&!this.documentHelper.isScrollToSpellCheck&&e.documentHelper.owner.selection.selectedWidgets.length>0){var r=e.documentHelper.owner.selection.selectedWidgets.containsKey(t);if(!r&&t.paragraph.isInHeaderFooter){var n=e.documentHelper.owner.selection.selectedWidgets.keys;t=this.checkHeaderFooterLineWidget(t,n),sf.base.isNullOrUndefined(t)||(r=!0)}r&&e.documentHelper.owner.selection.addSelectionHighlight(this.selectionContext,t,i,e)}},i.prototype.renderSelectionHighlightOnTable=function(e,t){if(!this.isPrinting&&e.documentHelper.owner.selection&&e.documentHelper.owner.selection.selectedWidgets.length>0){var i=e.documentHelper.owner.selection.selectedWidgets.containsKey(t);if(!i&&t.ownerTable.isInHeaderFooter){var r=e.documentHelper.owner.selection.selectedWidgets.keys;t=this.checkHeaderFooterLineWidget(t,r),sf.base.isNullOrUndefined(t)||(i=!0)}i&&e.documentHelper.owner.selection.addSelectionHighlightTable(this.selectionContext,t,e)}},i.prototype.renderLine=function(e,i,r,n){this.renderSelectionHighlight(i,e,n);var o=e.paragraph.paragraphFormat,s=r;if(e.isFirstLine()&&!o.bidi&&(r+=x.convertPointToPixel(o.firstLineIndent)),this.documentHelper&&this.documentHelper.selection&&!sf.base.isNullOrUndefined(this.documentHelper.selection.formFieldHighlighters)&&this.documentHelper.selection.formFieldHighlighters.containsKey(e)&&this.documentHelper.owner.documentEditorSettings&&this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading)for(var a=i.documentHelper.selection.formFieldHighlighters.get(e),l=0;l<a.length;l++){this.pageContext.fillStyle=this.documentHelper.owner.documentEditorSettings.formFieldSettings.shadingColor;var d=e.height,h=!1;if(e.isLastLine()&&(d-=x.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(e.paragraph)),e.paragraph.paragraphFormat.lineSpacing>1)){var c=this.getFormfieldInLine(e);if(!sf.base.isNullOrUndefined(c)){var p=this.documentHelper.textHelper.getHeight(c.characterFormat),g=p.Height;"Multiple"===e.paragraph.paragraphFormat.lineSpacingType?d-=x.convertPointToPixel(this.documentHelper.layout.getLineSpacing(e.paragraph,g,!0)):(n+=x.convertPointToPixel(e.paragraph.paragraphFormat.beforeSpacing),d=p.Height,h=!0)}}this.pageContext.fillRect(this.getScaledValue(a[l].left,1),this.getScaledValue(n,2),this.getScaledValue(a[l].width),this.getScaledValue(d)),h&&(h=!1,n-=x.convertPointToPixel(e.paragraph.paragraphFormat.beforeSpacing))}this.renderSearchHighlight(i,e,n),this.renderEditRegionHighlight(i,e,n);var f=[],u=e.renderedElements,m=this.getUnderlineYPosition(e),y=[];!sf.base.isNullOrUndefined(e.paragraph.associatedCell)&&e.paragraph.associatedCell.isRenderBookmarkStart&&(e.paragraph.associatedCell.firstChild.firstChild==e&&y.push({x:r,y:n,height:e.height-e.margin.bottom,type:0}));for(l=0;l<u.length;l++){var v=u[l];if(!(v instanceof Ba&&"Inline"!==v.textWrappingStyle)){if(v instanceof al||v instanceof _a){if(v instanceof _a&&(this.documentHelper.owner.currentUser===v.user||"Everyone"===v.group&&""===v.user)&&this.documentHelper.owner.documentEditorSettings.highlightEditableRanges&&-1==v.columnFirst){var w=v.line.height-v.line.margin.bottom,b=r,I=n,F=i.documentHelper.selection.editRegionHighlighters,C=(a=sf.base.isNullOrUndefined(F)?[]:F.get(e),sf.base.isNullOrUndefined(a)||sf.base.isNullOrUndefined(a[0])?"ffff00":a[0].color);this.renderBookmark(this.getScaledValue(b,1),this.getScaledValue(I,2),this.getScaledValue(e.height-e.margin.bottom),0,C)}var W=0;this.viewer instanceof Qs&&(W=this.viewer.pageGap);var k="display:block;position:absolute;";if(v instanceof al&&0===v.commentType&&this.documentHelper.owner.selectionModule)if(this.documentHelper.owner.enableComment){var S=x.convertPointToPixel(i.bodyWidgets[0].sectionFormat.rightMargin),P=x.convertPointToPixel(i.bodyWidgets[0].sectionFormat.pageWidth),N=i.boundingRectangle.x+this.getScaledValue(P-S+S/4)+"px;";this.viewer instanceof $s&&(N=i.boundingRectangle.width-2*this.viewer.padding.right-2*this.viewer.padding.left+"px;");var O=this.getScaledValue(n+(i.boundingRectangle.y-W*(i.index+1)))+W*(i.index+1)+"px;";k=k+"left:"+N+"top:"+O,-1!==f.indexOf(v.commentId)||sf.base.isNullOrUndefined(v.comment)||v.comment.isReply||(f.push(v.commentId),v.renderCommentMark(O,N),v.commentMark.setAttribute("style",k))}else v.commentMark&&v.commentMark.setAttribute("style","display:none")}if(v instanceof qa&&(this.documentHelper.owner.currentUser===v.editRangeStart.user||"Everyone"===v.editRangeStart.group&&""===v.editRangeStart.user)&&-1==v.editRangeStart.columnFirst&&this.documentHelper.owner.documentEditorSettings.highlightEditableRanges){w=v.line.height-v.line.margin.bottom,b=r,I=n,F=i.documentHelper.selection.editRegionHighlighters,a=sf.base.isNullOrUndefined(F)?[]:F.get(e),C=sf.base.isNullOrUndefined(a)||sf.base.isNullOrUndefined(a[0])?"ffff00":a[0].color;this.renderBookmark(this.getScaledValue(b,1),this.getScaledValue(I,2),this.getScaledValue(e.height-e.margin.bottom),1,C)}if(v instanceof Na&&this.documentHelper.owner.documentEditorSettings.showBookmarks&&-1!==this.documentHelper.getBookmarks().indexOf(v.name)){w=v.line.height-v.line.margin.bottom,b=r,I=n;if(1==v.bookmarkType){if(this.isBookmarkEndAtStart(v)&&sf.base.isNullOrUndefined(v.properties)){for(var T=v.paragraph,H=void 0,E=!1;!E&&!sf.base.isNullOrUndefined(T);){for(var R=T.childWidgets.indexOf(v.line)>=0?T.childWidgets.indexOf(v.line):T.childWidgets.length-1;R>=0;R--){for(var U=T.childWidgets[R],B=U.children.indexOf(v)>=0?U.children.indexOf(v):U.children.length-1;B>=0;B--)if(this.isRenderable(U.children[B])){H=U.children[B],E=!0;break}if(E)break}E||(T=this.documentHelper.selection.getPreviousParagraphBlock(T))}sf.base.isNullOrUndefined(H)||(b+=this.documentHelper.selection.getWidth(H.line,!1)+this.documentHelper.textHelper.getParagraphMarkWidth(v.line.paragraph.characterFormat),I=this.documentHelper.selection.getTop(H.line))}sf.base.isNullOrUndefined(v.properties)||(v.properties.isAfterParagraphMark&&(b+=this.documentHelper.textHelper.getParagraphMarkWidth(v.line.paragraph.characterFormat)),v.properties.isAfterCellMark&&(b+=this.documentHelper.textHelper.getWidth(String.fromCharCode(164),e.paragraph.characterFormat)))}if(1==v.bookmarkType){if(!sf.base.isNullOrUndefined(v.reference))if(sf.base.isNullOrUndefined(v.reference.properties))this.documentHelper.selection.isRenderBookmarkAtEnd(v)||y.push({x:b,y:I,height:w,type:v.bookmarkType});else{var L=v.paragraph.associatedCell;sf.base.isNullOrUndefined(L)?y.push({x:b,y:I,height:w,type:v.bookmarkType}):y.push({x:r,y:n,height:w,type:v.bookmarkType})}}else sf.base.isNullOrUndefined(v.properties)&&y.push({x:b,y:I,height:w,type:v.bookmarkType})}if(v instanceof va||this.isFieldCode||0===v.width&&0===v.height)this.isFieldCode&&(v.width=0),r+=v.width+v.margin.left,this.toSkipFieldCode(v);else if(this.isPrinting||!(this.getScaledValue(n+v.margin.top,2)+v.height*this.documentHelper.zoomFactor<0||this.getScaledValue(n+v.margin.top,2)>this.documentHelper.visibleBounds.height)){if(v instanceof Va)this.renderListTextElementBox(v,r,n,m);else if(v instanceof Da)r+=v.padding.left,this.renderImageElementBox(v,r,n,m);else if(v instanceof La){var A=v.margin.left,M=this.getScaledValue(r+A,1),z=this.getScaledValue(n,2);this.renderShapeElementBox(v,M,z,i)}else v.isVisible=!0,r+=v.padding.left,this.renderTextElementBox(v,r,n,m);r+=v.width+v.margin.left,e.paragraph.bidi?s+=v.margin.left:s=r}else r+=v.width+v.margin.left,v instanceof Fa&&(this.documentHelper.owner.isSpellCheck&&(v.canTrigger=!0),v.isVisible=!1,v.isSpellChecked&&!v.line.paragraph.isChangeDetected||(v.ischangeDetected=!0))}}if(this.documentHelper.owner.documentEditorSettings.showBookmarks&&y.length>0)for(l=0;l<y.length;l++){var D=y[l];this.renderBookmark(this.getScaledValue(D.x,1),this.getScaledValue(D.y,2),this.getScaledValue(D.height),D.type)}if(this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting){var V="",q=e.paragraph.characterFormat,_=0,j=this.retriveCharacterformat(q);if(this.pageContext.fillStyle=x.getColor(q.fontColor),0==u.length&&!e.isEndsWithLineBreak&&!sf.base.isNullOrUndefined(e.paragraph)||1===e.paragraph.childWidgets.length?(_=e.paragraph.y+this.documentHelper.textHelper.getHeight(q).BaselineOffset+this.documentHelper.layout.getBeforeSpacing(e.paragraph),!e.isEndsWithLineBreak&&e.indexInOwner>0&&0==u.length&&(_=n+e.previousLine.maxBaseLine)):_=n+e.maxBaseLine,q.revisions.length>0){C=this.documentHelper.authors.get(q.revisions[0].author);this.pageContext.fillStyle=x.getColor(C)}if(e.isEndsWithColumnBreak)j=this.retriveCharacterformat(q,.7),V="....."+this.documentHelper.owner.localeKeys.DocumentEditorContainer_ColumnBreak+".....";else if(e.isEndsWithPageBreak){j=this.retriveCharacterformat(q,.7),V=e.paragraph.bidi?String.fromCharCode(182)+"....."+this.documentHelper.owner.localeKeys.DocumentEditor_PageBreak+".....":"....."+this.documentHelper.owner.localeKeys.DocumentEditor_PageBreak+"....."+String.fromCharCode(182);var G=this.documentHelper.textHelper.getWidth(V,q,t.English);this.viewer instanceof Qs?e.paragraph.bidi?s<G+this.viewer.clientActiveArea.x&&(V="....."):s>this.viewer.clientActiveArea.width&&(V="....."):e.paragraph.bidi?s-G<this.viewer.clientActiveArea.x&&(V="....."):s+G>this.viewer.clientActiveArea.width+this.viewer.clientActiveArea.x&&(V=".....")}else e.isEndsWithLineBreak?V=e.paragraph.bidi?String.fromCharCode(8627):String.fromCharCode(8629):e.paragraph.isInsideTable&&sf.base.isNullOrUndefined(e.nextLine)&&sf.base.isNullOrUndefined(e.paragraph.nextWidget)?0!=e.height&&(V=String.fromCharCode(164)):sf.base.isNullOrUndefined(e.nextLine)&&(V=String.fromCharCode(182));if(e.paragraph.containerWidget instanceof aa&&!sf.base.isNullOrUndefined(e.paragraph.nextRenderedWidget)&&e.paragraph.containerWidget.sectionIndex!==e.paragraph.nextRenderedWidget.containerWidget.sectionIndex&&e.isLastLine()){V="NoBreak"===e.paragraph.nextRenderedWidget.containerWidget.sectionFormat.breakCode&&e.paragraph.containerWidget.index!==e.paragraph.nextRenderedWidget.containerWidget.index?":::::"+this.documentHelper.owner.localeKeys.DocumentEditor_SectionBreakContinuous+":::::":":::::"+this.documentHelper.owner.localeKeys.DocumentEditor_SectionBreakNextPage+":::::",j=this.retriveCharacterformat(q,.7),e.isEndsWithPageBreak&&(V=e.paragraph.bidi?V+String.fromCharCode(182)+"....."+this.documentHelper.owner.localeKeys.DocumentEditor_PageBreak+".....":"....."+this.documentHelper.owner.localeKeys.DocumentEditor_PageBreak+"....."+String.fromCharCode(182)+V);G=this.documentHelper.textHelper.getWidth(V,q,t.English);this.viewer instanceof Qs?e.paragraph.bidi?s<G+this.viewer.clientActiveArea.x&&(V=":::::",e.isEndsWithPageBreak&&(V=":::::.....")):s+G-this.viewer.clientActiveArea.x>this.viewer.clientActiveArea.width&&(V=":::::",e.isEndsWithPageBreak&&(V=".....:::::")):e.paragraph.bidi?s-G<this.viewer.clientActiveArea.x&&(V=":::::",e.isEndsWithPageBreak&&(V=":::::.....")):s+G-this.documentHelper.pages[0].boundingRectangle.x>this.viewer.clientActiveArea.width&&(V=":::::",e.isEndsWithPageBreak&&(V=".....:::::"))}if(V.length>0){e.paragraph.bidi&&!e.paragraph.isEmpty()&&(s-=this.documentHelper.textHelper.getWidth(V,q,t.English)),this.pageContext.font=j,this.pageContext.letterSpacing=q.characterSpacing*this.documentHelper.zoomFactor+"pt";var K=q.scaling<100?1:q.scaling/100;this.pageContext.save(),this.pageContext.scale(K,1),this.pageContext.fillText(V,this.getScaledValue(s,1)/K,this.getScaledValue(_,2)),this.pageContext.restore()}}},i.prototype.isBookmarkEndAtStart=function(e){for(var t=e.paragraph,i=0,r=t.childWidgets[i],n=!0;-1==r.children.indexOf(e)&&(r=t.childWidgets[++i],i!=t.childWidgets.length););if(e.line!=r)return!1;for(var o=r.children.indexOf(e)>=0?r.children.indexOf(e):-1;o>=0;o--){var s=r.children[o];this.isRenderable(s)&&(n=!1)}return!!n},i.prototype.isRenderable=function(e){return!(e instanceof Na||e instanceof _a||e instanceof qa)},i.prototype.combineHexColors=function(e,t){var i=e.replace("#",""),r=t.replace("#",""),n=parseInt(i.substring(0,2),16),o=parseInt(i.substring(2,4),16),s=parseInt(i.substring(4,6),16),a=parseInt(r.substring(0,2),16),l=parseInt(r.substring(2,4),16),d=parseInt(r.substring(4,6),16),h=Math.round(.35*n+.65*a),c=Math.round(.35*o+.65*l),p=Math.round(.35*s+.65*d);return"#"+h.toString(16)+c.toString(16)+p.toString(16)},i.prototype.renderBookmark=function(e,t,i,r,n){if(!this.isPrinting){this.pageContext.beginPath(),this.pageContext.lineWidth=1.5;if(0==r&&(this.pageContext.moveTo(e+3,t),this.pageContext.lineTo(e,t),this.pageContext.lineTo(e,t+i),this.pageContext.lineTo(e+3,t+i)),1==r&&(this.pageContext.moveTo(e-3,t),this.pageContext.lineTo(e,t),this.pageContext.lineTo(e,t+i),this.pageContext.lineTo(e-3,t+i)),this.pageContext.strokeStyle="#7F7F7F",this.pageContext.stroke(),this.pageContext.closePath(),!sf.base.isNullOrUndefined(n)){var o=this.combineHexColors(n,"#7F7F7F");this.pageContext.fillStyle=o,this.pageContext.fillRect(e,t,1.5,i)}}},i.prototype.retriveCharacterformat=function(e,t){sf.base.isNullOrUndefined(t)&&(t=1);this.pageContext.textBaseline="alphabetic";return(e.bold?"bold":"")+" "+(e.italic?"italic":"")+" "+(0===e.fontSize?.5:e.fontSize/("Normal"===e.baselineAlignment?1:1.5))*this.documentHelper.zoomFactor*t+'pt "'+e.fontFamily+'"'},i.prototype.toSkipFieldCode=function(e){e instanceof va&&(0===e.fieldType?this.isFieldCode||sf.base.isNullOrUndefined(e.fieldEnd)&&!e.hasFieldEnd||(this.fieldStacks.push(e),this.isFieldCode=!0):2!==e.fieldType&&1!==e.fieldType||this.fieldStacks.length>0&&e.fieldBegin===this.fieldStacks[this.fieldStacks.length-1]&&(this.fieldStacks.pop(),this.isFieldCode=!1))},i.prototype.getUnderlineYPosition=function(e){for(var t=0,i=0,r=0;r<e.children.length;r++)e.children[r]instanceof va||0===e.children[r].width&&0===e.children[r].height||e.children[r]instanceof La||t<e.children[r].height+e.children[r].margin.top&&(t=e.children[r].margin.top+e.children[r].height,i=e.children[r]instanceof Da?.9:e.children[r].height/20);return t-2*i},i.prototype.renderListTextElementBox=function(e,t,i,r){var n=e.margin.top,o=e.margin.left,s=e.listLevel.characterFormat,a=e.line.paragraph.characterFormat,l=s.hasValue("fontColor")?s.fontColor:a.fontColor;this.pageContext.textBaseline="alphabetic";var d,h,c=s.hasValue("fontFamily")?s.fontFamily:a.fontFamily;!this.documentHelper.isIosDevice||e.text!==String.fromCharCode(9679)&&e.text!==String.fromCharCode(9675)||(c="");var p=s.hasValue("fontSize")?s.fontSize:a.fontSize,g=s.hasValue("baselineAlignment")?s.baselineAlignment:a.baselineAlignment;d=s.hasValue("bold")?s.bold?"bold":"":a.bold?"bold":"",h=s.hasValue("italic")?s.italic?"italic":"":a.italic?"italic":"",p=0===p?.5:p/("Normal"===g?1:1.5),p=this.isPrinting?p:p*this.documentHelper.zoomFactor;var f=s.hasValue("strikethrough")?s.strikethrough:a.strikethrough,u=s.hasValue("highlightColor")?s.highlightColor:a.highlightColor;"NoColor"!==u&&("#"!==u.substring(0,1)?this.pageContext.fillStyle=x.getHighlightColorCode(u):this.pageContext.fillStyle=x.getColor(u),this.pageContext.fillRect(Math.floor(this.getScaledValue(t+o,1)),Math.floor(this.getScaledValue(i+n,2)-1),Math.ceil(this.getScaledValue(e.width)+1),Math.ceil(this.getScaledValue(e.height)+1))),this.pageContext.font=d+" "+h+" "+p+'pt "'+c+'"',"Subscript"===g&&(n+=e.height-e.height/1.5);var m=e.baselineOffset;n="Normal"===s.baselineAlignment?n+m:n+m/1.5;var y=e.text,v=e.paragraph.paragraphFormat.bidi;if(v&&(this.pageContext.direction="rtl",t+=e.width),"empty"===l||"#00000000"===l){var w=this.getBackgroundColorHeirachy(e);this.pageContext.fillStyle=this.getDefaultFontColor(w)}else this.pageContext.fillStyle=x.getColor(l);var b=s.scaling<100?1:s.scaling/100;this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting?(e instanceof Va&&"\t"===e.text&&this.tabMark(e,s,t,i,o,n),this.pageContext.letterSpacing=s.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(b,1),this.pageContext.fillText(this.replaceSpace(y),this.getScaledValue(t+o,1)/b,this.getScaledValue(i+n,2),this.getScaledValue(e.width)),this.pageContext.restore()):(this.pageContext.letterSpacing=s.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(b,1),this.pageContext.fillText(y,this.getScaledValue(t+o,1)/b,this.getScaledValue(i+n,2),this.getScaledValue(e.width)),this.pageContext.restore()),v&&(this.pageContext.direction="ltr",t-=e.width),"None"===s.underline||sf.base.isNullOrUndefined(s.underline)||this.renderUnderline(e,t,i,r,l,s.underline,g),"None"!==f&&this.renderStrikeThrough(e,t,i,s.strikethrough,l,g)},i.prototype.getDefaultFontColor=function(e){return x.isVeryDark(e)?"#FFFFFF":"#000000"},i.prototype.renderTextElementBox=function(t,i,r,n){var o=!1,s=t.line.paragraph.containerWidget;s instanceof ua&&(o="Exactly"===s.ownerRow.rowFormat.heightType);var a=t.margin.top,l=t.margin.left;if(o&&s instanceof ua){var d=s.width+s.margin.left+s.margin.right-s.leftBorderWidth;this.clipRect(s.x-s.margin.left,s.y,this.getScaledValue(d),this.getScaledValue(s.height))}var h=t.characterFormat,c=!0;if("NoColor"!=h.highlightColor&&""==t.text.trim()){var p=t.line.paragraph.firstChild,g=t.line.paragraph.lastChild;!sf.base.isNullOrUndefined(p)&&p instanceof ma&&p.children.length>0&&t===p.children[0]&&(c=!1),!sf.base.isNullOrUndefined(g)&&g instanceof ma&&g.children.length>0&&t===g.children[g.children.length-1]&&(c=!1)}"NoColor"!==h.highlightColor&&c&&("#"!==h.highlightColor.substring(0,1)?this.pageContext.fillStyle=x.getHighlightColorCode(h.highlightColor):this.pageContext.fillStyle=x.getColor(h.highlightColor),this.pageContext.fillRect(Math.floor(this.getScaledValue(i+l,1)),Math.floor(this.getScaledValue(r+a,2)-1),Math.ceil(this.getScaledValue(t.width)+1),Math.ceil(this.getScaledValue(t.height)+1)));var f=this.checkRevisionType(t),u=f.length>0?this.getRevisionColor(f):h.fontColor;this.pageContext.textBaseline="alphabetic";var m,y,v=11;m=h.bold?"bold":"",y=h.italic?"italic":"",v=0===h.fontSize?.5:h.fontSize/("Normal"===h.baselineAlignment?1:1.5),v=this.isPrinting?v:v*this.documentHelper.zoomFactor;var w=this.documentHelper.textHelper.getFontNameToRender(t.scriptType,h);this.pageContext.font=m+" "+y+" "+v+'pt "'+w+'"',"Subscript"===h.baselineAlignment&&(a+=t.height-t.height/1.5);var b=t.baselineOffset;if(a="Normal"===h.baselineAlignment?a+b:a+b/1.5,"empty"===u||"#00000000"===u){var I=this.getBackgroundColorHeirachy(t);this.pageContext.fillStyle=this.getDefaultFontColor(I)}else this.pageContext.fillStyle=x.getColor(u);var F=this.getScaledValue(t.width),C=t.text;if(t instanceof Pa){var W=t;""!==W.tabText||sf.base.isNullOrUndefined(W.tabLeader)||"None"===W.tabLeader?""!==W.tabText&&(C=W.tabText):(C=this.getTabLeader(t),W.tabText=C)}var k=h.bidi||this.documentHelper.textHelper.isRTLText(t.text);C=this.documentHelper.textHelper.setText(C,k,h.bdo,!0),h.allCaps&&(C=C.toUpperCase());var S=t.characterRange;(S==e.WordSplit||(S&e.WordSplit)==e.WordSplit&&(S&e.RightToLeft)==e.RightToLeft)&&h.bidi&&(C=this.inverseCharacter(C));var P=h.scaling<100?1:h.scaling/100;if(S!==e.RightToLeft||x.startsWith(C," ")||(this.pageContext.direction="rtl",i+=t.width),this.documentHelper.owner.documentEditorSettings.showHiddenMarks&&!this.isPrinting?((t instanceof Pa||t instanceof Fa)&&"\t"===t.text&&this.tabMark(t,h,i,r,l,a),"\r"===C&&(C=String.fromCharCode(182)),this.pageContext.letterSpacing=h.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(P,1),this.pageContext.fillText(this.replaceSpace(C),this.getScaledValue(i+l,1)/P,this.getScaledValue(r+a,2),F),this.pageContext.restore()):(this.pageContext.letterSpacing=h.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save(),this.pageContext.scale(P,1),this.pageContext.fillText(C,this.getScaledValue(i+l,1)/P,this.getScaledValue(r+a,2),F),this.pageContext.restore()),S!==e.RightToLeft||x.startsWith(C," ")||(this.pageContext.direction="ltr",i-=t.width),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.isSpellCheck&&!this.spellChecker.removeUnderline&&(this.documentHelper.triggerSpellCheck||t.canTrigger)&&" "!==t.text&&!this.documentHelper.isScrollHandler&&(sf.base.isNullOrUndefined(t.previousNode)||!(t.previousNode instanceof va))&&(!this.documentHelper.selection.isSelectionInsideElement(t)||this.documentHelper.triggerElementsOnLoading)){t.canTrigger=!0,this.leftPosition=this.pageLeft,this.topPosition=this.pageTop;var N=this.spellChecker.checktextElementHasErrors(t.text,t,i);if(N.errorFound&&!this.isPrinting){u="#FF0000";for(var O=s instanceof ua?s.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor,T=0;T<N.elements.length;T++){var H=N.elements[T];-1===t.ignoreOnceItems.indexOf(this.spellChecker.manageSpecialCharacters(H.text,void 0,!0))&&(k?this.renderWavyLine(H,sf.base.isNullOrUndefined(H.end)?i:H.end.location.x,r,n,u,"Single",h.baselineAlignment,O):this.renderWavyLine(H,sf.base.isNullOrUndefined(H.start)?i:H.start.location.x,r,n,u,"Single",h.baselineAlignment,O))}}else(t.ischangeDetected||this.documentHelper.triggerElementsOnLoading)&&(t.ischangeDetected=!1,this.handleChangeDetectedElements(t,n,i,r,h.baselineAlignment))}var E=this.getRevisionType(f,!0);("None"===h.underline||sf.base.isNullOrUndefined(h.underline))&&(sf.base.isNullOrUndefined(E)||"Insertion"!==E.type&&"MoveTo"!==E.type)||this.renderUnderline(t,i,r,n,u,h.underline,h.baselineAlignment,E),E=this.getRevisionType(f,!1),("None"===h.strikethrough||sf.base.isNullOrUndefined(h.strikethrough))&&(sf.base.isNullOrUndefined(E)||"Deletion"!==E.type&&"MoveFrom"!==E.type)||this.renderStrikeThrough(t,i,r,h.strikethrough,u,h.baselineAlignment,E),o&&this.pageContext.restore()},i.prototype.tabMark=function(e,t,i,r,n,o){var s=e.paragraph.bidi?String.fromCharCode(8592):String.fromCharCode(8594),a=this.documentHelper.textHelper.getWidth(s,t,e.scriptType),l=e.width/2,d=a/2;this.pageContext.font=this.retriveCharacterformat(e.characterFormat),this.pageContext.letterSpacing=t.characterSpacing*this.documentHelper.zoomFactor+"pt",this.pageContext.save();var h=t.scaling<100?1:t.scaling/100;this.pageContext.scale(h,1),l>a?this.pageContext.fillText(s,this.getScaledValue(i+n+l-d,1)/h,this.getScaledValue(r+o,2)):this.pageContext.fillText(s,this.getScaledValue(i+n,1)/h,this.getScaledValue(r+o,2),this.getScaledValue(e.width)),this.pageContext.restore()},i.prototype.replaceSpace=function(e){return e=(e=e.replace(new RegExp(String.fromCharCode(32),"g"),String.fromCharCode(183))).replace(new RegExp(String.fromCharCode(160),"g"),String.fromCharCode(176))},i.prototype.inverseCharacter=function(e){switch(e){case String.fromCharCode(40):return String.fromCharCode(41);case String.fromCharCode(41):return String.fromCharCode(40);case String.fromCharCode(60):return String.fromCharCode(62);case String.fromCharCode(62):return String.fromCharCode(60);case String.fromCharCode(123):return String.fromCharCode(125);case String.fromCharCode(125):return String.fromCharCode(123);case String.fromCharCode(91):return String.fromCharCode(93);case String.fromCharCode(93):return String.fromCharCode(91);default:return e}},i.prototype.getBackgroundColorHeirachy=function(e){var t;if(e.paragraph.isInsideTable){var i=e.paragraph.containerWidget;if("empty"!==(t=i.cellFormat.shading.backgroundColor)&&"#00000000"!==t)return t;if("empty"!==(t=i.ownerTable.tableFormat.shading.backgroundColor)&&"#00000000"!==t)return t}else if(e.paragraph.containerWidget instanceof Aa&&!sf.base.isNullOrUndefined(e.paragraph.containerWidget.containerShape)&&!sf.base.isNullOrUndefined(e.paragraph.containerWidget.containerShape.fillFormat)&&"#000000FF"===e.paragraph.containerWidget.containerShape.fillFormat.color)return e.paragraph.containerWidget.containerShape.fillFormat.color;return this.documentHelper.backgroundColor},i.prototype.handleChangeDetectedElements=function(e,t,i,r,n){var o=this,s=e.text.trim(),a=this.pageIndex;if("\v"!==e.text&&!this.spellChecker.checkElementCanBeCombined(e,t,a,!0)){var l=s.split(/[\s]+/),d=e.line.getOffset(e,0);if(l.length>1)for(var h=0;h<l.length;h++){var c=l[h],p=this.spellChecker.manageSpecialCharacters(c,void 0,!0);-1===this.spellChecker.ignoreAllItems.indexOf(p)&&-1===e.ignoreOnceItems.indexOf(p)&&(this.handleUnorderedElements(p,e,t,h,d,h===l.length-1,a),d+=c.length+1)}else{p=this.spellChecker.manageSpecialCharacters(s,void 0,!0);if(s.length>0&&-1===this.spellChecker.ignoreAllItems.indexOf(p)&&-1===e.ignoreOnceItems.indexOf(p)){var g=e.indexInOwner,f=e.line.paragraph.indexInOwner,u=this.spellChecker.checkSpellingInPageInfo(p);if(u.isElementPresent&&this.spellChecker.enableOptimizedSpellCheck){var m=JSON.parse('{"HasSpellingError":'+u.hasSpellError+"}");this.spellChecker.handleWordByWordSpellCheck(m,e,i,r,t,n,!0)}else if(this.spellChecker.isInUniqueWords(p)){var y=!!this.spellChecker.isErrorWord(p);m=JSON.parse('{"HasSpellingError":'+y+"}");this.spellChecker.handleWordByWordSpellCheck(m,e,i,r,t,n,!0)}else this.documentHelper.owner.editor.triggerPageSpellCheck&&!this.documentHelper.triggerElementsOnLoading||this.spellChecker.callSpellChecker(this.spellChecker.languageID,s,!0,this.spellChecker.allowSpellCheckAndSuggestion).then((function(s){var l=JSON.parse(s),d=(a===o.pageIndex||e.isVisible)&&g===e.indexInOwner&&f===e.line.paragraph.indexInOwner;o.spellChecker.handleWordByWordSpellCheck(l,e,i,r,t,n,d)}))}}}},i.prototype.handleUnorderedElements=function(e,t,i,r,n,o,s){var a=this,l=t.indexInOwner,d=t.line.paragraph.indexInOwner;if(e.length>0){var h=this.spellChecker.checkSpellingInPageInfo(e);if(h.isElementPresent&&this.spellChecker.enableOptimizedSpellCheck){var c=JSON.parse('{"HasSpellingError":'+h.hasSpellError+"}");this.spellChecker.handleSplitWordSpellCheck(c,e,t,!0,i,r,n,o)}else{var p=t.isVisible&&l===t.indexInOwner&&d===t.line.paragraph.indexInOwner;if(this.spellChecker.isInUniqueWords(e)){var g=!!this.spellChecker.isErrorWord(e);c=JSON.parse('{"HasSpellingError":'+g+"}");this.spellChecker.handleSplitWordSpellCheck(c,e,t,p,i,r,n,o)}else this.documentHelper.owner.editor.triggerPageSpellCheck&&!this.documentHelper.triggerElementsOnLoading||this.spellChecker.callSpellChecker(this.spellChecker.languageID,e,!0,this.spellChecker.allowSpellCheckAndSuggestion).then((function(s){var l=JSON.parse(s);a.spellChecker.handleSplitWordSpellCheck(l,e,t,p,i,r,n,o)}))}}},i.prototype.renderWavyLine=function(e,t,i,r,n,o,s,a){if(!this.isPrinting&&e.text.length>1){var l=e.height/("Normal"===s?1:1.5),d=e.margin.top,h=0;"Subscript"===s||e instanceof Va?(h=l-2*(l/20)+i,h+=(d+=e.height-l)>0?d:0):h=r+i;var c=this.spellChecker.getSpecialCharactersInfo(e),p=this.spellChecker.getWhiteSpaceCharacterInfo(e),g=(t+c.beginningWidth+(p.isBeginning?p.width:0)+e.margin.left)*this.documentHelper.zoomFactor+this.leftPosition,f=h*this.documentHelper.zoomFactor+this.topPosition,u=g+this.getScaledValue(e.width-(c.beginningWidth+c.endWidth)-p.width),m=new I(g,f),y=new I(u,f);this.drawWavy(m,y,.5*(u-g),1,.7,n,e.height,a)}},i.prototype.drawWavy=function(e,t,i,r,n,o,s,a,l){this.pageContext.save(),this.pageContext.fillStyle=sf.base.isNullOrUndefined(a)?this.documentHelper.backgroundColor:a,this.pageContext.fillRect(e.x,e.y-r,t.x-e.x,3*r),this.pageContext.restore(),this.pageContext.lineWidth=1,this.pageContext.lineCap="round",this.pageContext.strokeStyle=o,this.pageContext.beginPath();for(var d=0,h=0,c=e.x,p=e.y,g=t.x,f=t.y,u=0,m=0,y=Math.atan2(f-p,g-c),v=Math.sqrt((c-g)*(c-g)+(p-f)*(p-f)),w=1*r,b=Math.PI*i;u<=v;u+=n)m=Math.sin(u/v*b)*w,d=e.x+Math.cos(y)*u+Math.cos(y-Math.PI/2)*m,h=e.y+Math.sin(y)*u+Math.sin(y-Math.PI/2)*m,u>0?this.pageContext.lineTo(d,h):this.pageContext.moveTo(d,h);this.pageContext.stroke(),this.pageContext.restore()},i.prototype.getTabLeader=function(e){var t,i=this.getTabLeaderString(e.tabLeader),r=i;t=this.documentHelper.textHelper.getWidth(r,e.characterFormat,e.scriptType);var n=Math.floor(e.width/t);0==t&&(n=0);for(var o=0;o<=n;o++)r+=i;return r.slice(0,-1)},i.prototype.getTabLeaderString=function(e){var t="";switch(e){case"Dot":t=".";break;case"Hyphen":t="-";break;case"Underscore":case"Single":t="_"}return t},i.prototype.clipRect=function(e,t,i,r){this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.getScaledValue(e,1),this.getScaledValue(t,2),i,r),this.pageContext.clip()},i.prototype.getTrimmedWidth=function(e){var t=e.width;return e instanceof Fa&&!(e instanceof Pa)&&sf.base.isNullOrUndefined(e.nextNode)&&(t=this.documentHelper.textHelper.getWidth(x.trimEnd(e.text),e.characterFormat,e.scriptType)),t},i.prototype.renderUnderline=function(e,t,i,r,n,o,s,a){var l=e.height/("Normal"===s?1:1.5),d=e.margin.top,h=l/20,c=0,p=l/20;"Subscript"===s||e instanceof Va?(c=l-2*h+i,c+=(d+=e.height-l)>0?d:0):c=r+i;var g=0;for(sf.base.isNullOrUndefined(a)||(o="MoveTo"===a.type?"Double":"Single"),"Double"===o&&(c-=p),e instanceof Da&&(h=.9);g<("Double"===o?2:1);){g++;var f=this.getTrimmedWidth(e);this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(c,2),this.getScaledValue(f),this.getScaledValue(h)),c+=2*p}},i.prototype.renderStrikeThrough=function(e,t,i,r,n,o,s){var a=e.height/("Normal"===o?1:1.5),l=e.margin.top;"Subscript"===o&&(l+=e.height-a),i+=l>0?l:0;var d=a/20,h=a/2+.5*d,c=0;for(sf.base.isNullOrUndefined(s)||(r="Deletion"===s.type?"SingleStrike":"DoubleStrike"),e instanceof Da&&(d=.9),"DoubleStrike"===r&&(h-=d);c<("DoubleStrike"===r?2:1);){c++;var p=this.getTrimmedWidth(e);this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(h+i,2),this.getScaledValue(p),this.getScaledValue(d)),h+=2*d}},i.prototype.renderImageElementBox=function(e,t,i,r){var n=e.margin.top,o=e.margin.left,s=this.checkRevisionType(e),a=s.length>0?this.getRevisionColor(s):"black";this.pageContext.textBaseline="top";var l=0,d=!1,h=e.line.paragraph.containerWidget,c=!1;if(h instanceof ua&&(c="Exactly"===h.ownerRow.rowFormat.heightType),"Inline"===e.textWrappingStyle)if(n<0||e.line.paragraph.width<e.width){if(h instanceof ua){var p=0;if(h.childWidgets[0]instanceof ca)p=h.childWidgets[0].paragraphFormat.leftIndent;l=h.width+h.margin.left-h.leftBorderWidth-p,d=!0,this.clipRect(t+o,i+n,this.getScaledValue(l),this.getScaledValue(h.height))}}else if(c){var g=h.width+h.margin.left-h.leftBorderWidth;d=!0,this.clipRect(h.x,h.y,this.getScaledValue(g),this.getScaledValue(h.height))}if(e.isMetaFile&&!sf.base.isNullOrUndefined(e.metaFileImageString))this.pageContext.drawImage(e.element,this.getScaledValue(t+o,1),this.getScaledValue(i+n,2),this.getScaledValue(e.width),this.getScaledValue(e.height));else{var f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC";try{var u=this.getScaledValue(t+o,1),m=this.getScaledValue(i+n,2),y=this.getScaledValue(e.width),v=this.getScaledValue(e.height),w=this;e.element.onload=function(){var t=e.element.getAttribute("lastLoaded");sf.base.isNullOrUndefined(w.documentHelper)||t===e.element.src||(e.isCrop?w.pageContext.drawImage(e.element,e.cropX,e.cropY,e.cropWidth,e.cropHeight,u,m,y,v):w.pageContext.drawImage(e.element,u,m,y,v))},e.element.onerror=function(){e.element.src=f},e.isCrop?this.pageContext.drawImage(e.element,e.cropX,e.cropY,e.cropWidth,e.cropHeight,u,m,y,v):this.pageContext.drawImage(e.element,u,m,y,v)}catch(r){e.imageString=f,this.documentHelper.addBase64StringInCollection(e),e.element.src=this.documentHelper.getImageString(e),this.pageContext.drawImage(e.element,this.getScaledValue(t+o,1),this.getScaledValue(i+n,2),this.getScaledValue(e.width),this.getScaledValue(e.height))}}this.pageContext.fillStyle=x.getColor(a);var b=this.getRevisionType(s,!1);if(sf.base.isNullOrUndefined(b)||"Deletion"!==b.type&&"MoveFrom"!==b.type||this.renderStrikeThrough(e,t,i,"SingleStrike",a,"Normal",b),b=this.getRevisionType(s,!0),!sf.base.isNullOrUndefined(b)&&("Insertion"===b.type||"MoveTo"===b.type)){var I=this.getUnderlineYPosition(e.line);this.renderUnderline(e,t,i,I,a,"Single","Normal")}d&&this.pageContext.restore()},i.prototype.renderTableOutline=function(e){var t=new E(this.documentHelper),i=e;e.width=this.documentHelper.layout.getTableWidth(i);var r=i.isBidiTable?t.getTableRightBorder(i.tableFormat.borders):t.getTableLeftBorder(i.tableFormat.borders),n=0;n=x.convertPointToPixel(r.getLineWidth()),this.renderSingleBorder(r.color,e.x-e.margin.left-n/2,e.y,e.x-e.margin.left-n/2,e.y+e.height,n,r.lineStyle),r=t.getTableTopBorder(i.tableFormat.borders),n=0,n=x.convertPointToPixel(r.getLineWidth()),this.renderSingleBorder(r.color,e.x-e.margin.left-n,e.y-n/2,e.x+e.width+n+e.margin.right,e.y-n/2,n,r.lineStyle),r=i.isBidiTable?t.getTableLeftBorder(i.tableFormat.borders):t.getTableRightBorder(i.tableFormat.borders),n=0,n=x.convertPointToPixel(r.getLineWidth()),this.renderSingleBorder(r.color,e.x+e.width+e.margin.right+n/2,e.y,e.x+e.width+e.margin.right+n/2,e.y+e.height,n,r.lineStyle),r=t.getTableBottomBorder(i.tableFormat.borders),n=0,n=x.convertPointToPixel(r.getLineWidth()),this.renderSingleBorder(r.color,e.x-e.margin.left-n,e.y+e.height-n/2,e.x+e.width+n+e.margin.right,e.y+e.height-n/2,n,r.lineStyle)},i.prototype.renderTableCellOutline=function(e,t){var i,r=e.layout,n=t,o=0,s=0,a=0,l=0,d=t.ownerTable.isBidiTable;n.cellFormat.borders,t.containerWidget instanceof fa&&(s=t.margin.bottom-t.containerWidget.bottomBorderWidth,o=t.margin.top-t.containerWidget.topBorderWidth),a=t.margin.left-t.leftBorderWidth,i=t.margin.right-t.rightBorderWidth,l=sf.base.isNullOrUndefined(n.ownerRow)||"Exactly"!==n.ownerRow.rowFormat.heightType?!sf.base.isNullOrUndefined(n.ownerRow)&&[n.ownerRow].length<=1?Math.max(x.convertPointToPixel(n.ownerRow.rowFormat.height),t.height)+o+s:t.height+o+s:x.convertPointToPixel(n.ownerRow.rowFormat.height)+o+s;var h=d?ua.getCellRightBorder(n):ua.getCellLeftBorder(n),c=0;c=x.convertPointToPixel(h.getLineWidth()),this.renderCellBackground(l,t,a,i,c);var p=c;if(0===n.index||1===n.cellFormat.rowSpan||n.cellFormat.rowSpan>1&&0===n.columnIndex)this.renderSingleBorder(h.color,t.x-a-c,t.y-t.margin.top,t.x-a-c,t.y+t.height+s,c,h.lineStyle);else for(var g=0;g<n.ownerTable.childWidgets.length;g++){for(var f=n.ownerTable.childWidgets[g],u=void 0,m=0;m<f.childWidgets.length;m++){var y=f.childWidgets[m];if(y.columnIndex+y.cellFormat.columnSpan-1==n.columnIndex-1){u=y;break}if(f.childWidgets[m].columnIndex>=n.columnIndex&&f.childWidgets[m].previousWidget){u=f.childWidgets[m].previousWidget;break}}if(u&&u.columnIndex+u.cellFormat.columnSpan-1==n.columnIndex-1){var v=d?ua.getCellLeftBorder(u):ua.getCellRightBorder(u),w=x.convertPointToPixel(v.getLineWidth());if(a=n.margin.left-w,u.y+u.height<n.y)continue;if(u.y<n.y&&u.y+u.height>n.y)this.renderSingleBorder(v.color,n.x-a-w,n.y-o,n.x-a-w,u.y+u.height+u.margin.bottom,w,v.lineStyle);else if(u.y===n.y||u.y>n.y&&u.y+u.height<n.y+n.height)this.renderSingleBorder(v.color,n.x-a-w,u.y-u.margin.top,n.x-a-w,u.y+u.height+u.margin.bottom,w,v.lineStyle);else if(u.y<n.y+n.height&&u.y+u.height>=n.y+n.height)this.renderSingleBorder(v.color,n.x-a-w,u.y-u.margin.top,n.x-a-w,u.y+u.height+s,w,v.lineStyle);else if(u.y>n.y+n.height)break}}if(n.updatedTopBorders&&n.updatedTopBorders.length>1)for(var b=t.x-t.margin.left-p/2,I=t.y-t.margin.top,F=0;F<n.updatedTopBorders.length;F++){var C=n.updatedTopBorders[F];"None"!==(h=C.border).lineStyle&&h.lineWidth<ua.getCellTopBorder(n).lineWidth&&(h.lineWidth=ua.getCellTopBorder(n).lineWidth),sf.base.isNullOrUndefined(h)||(c=x.convertPointToPixel(h.getLineWidth()),this.renderSingleBorder(h.color,b,I+c/2,b+C.width,I+c/2,c,h.lineStyle),b+=C.width)}else{h=ua.getCellTopBorder(n),c=x.convertPointToPixel(h.getLineWidth());this.renderSingleBorder(h.color,t.x-t.margin.left-p/2,t.y-t.margin.top+c/2,t.x+t.width+t.margin.right+0,t.y-t.margin.top+c/2,c,h.lineStyle)}var W=!1;W=d?0===n.columnIndex:n.cellIndex===n.ownerRow.childWidgets.length-1;for(var k=n.containerWidget.getPreviousRowSpannedCells(),S=!1,P=0;P<k.length;P++){var N=k[P];if(n.rowIndex<N.rowIndex+N.cellFormat.rowSpan&&n.columnIndex<N.columnIndex){S=!0;break}}!(n.ownerTable.tableFormat.cellSpacing>0||W)||!d&&n.columnIndex+n.cellFormat.columnSpan!==n.ownerTable.tableHolder.columns.length&&S||(h=d?ua.getCellLeftBorder(n):ua.getCellRightBorder(n),c=x.convertPointToPixel(h.getLineWidth()),this.renderSingleBorder(h.color,t.x+t.width+t.margin.right-c/2,t.y-t.margin.top,t.x+t.width+t.margin.right-c/2,t.y+t.height+s,c,h.lineStyle));var O=n.ownerRow.nextWidget,T=!1,H=void 0;if(!sf.base.isNullOrUndefined(O)){if(O.lastChild){var E=O.lastChild;H=E.columnIndex+E.cellFormat.columnSpan}var R;(R=O)instanceof fa&&t.containerWidget instanceof fa&&t.containerWidget.containerWidget instanceof ga&&(T=-1!==t.containerWidget.containerWidget.childWidgets.indexOf(R))}if(n.ownerTable.tableFormat.cellSpacing>0||n.ownerRow.rowIndex===n.ownerTable.childWidgets.length-1||n.cellFormat.rowSpan>1&&n.ownerRow.rowIndex+n.cellFormat.rowSpan>=n.ownerTable.childWidgets.length||!T||this.isRenderHeader||H&&O.childWidgets.length<n.ownerRow.childWidgets.length&&H<n.columnIndex+n.cellFormat.columnSpan||!sf.base.isNullOrUndefined(n.cellFormat.borders.bottom)&&"Cleared"!==n.cellFormat.borders.bottom.lineStyle&&1===n.cellFormat.rowSpan&&!d&&(!sf.base.isNullOrUndefined(O)&&t.x<O.firstChild.x-O.firstChild.margin.left&&O.rowFormat.gridBefore>0&&(0!==O.rowFormat.beforeWidth||0!==O.rowFormat.gridBeforeWidth)||!sf.base.isNullOrUndefined(O)&&t.x+t.width>O.lastChild.x+O.lastChild.width+O.lastChild.margin.right&&O.rowFormat.gridAfter>0&&(0!==O.rowFormat.afterWidth||0!==O.rowFormat.gridAfterWidth))){var U=n.cellFormat.borders.bottom;h=(sf.base.isNullOrUndefined(U)||"Cleared"!==U.lineStyle)&&n.cellFormat.rowSpan>1&&n.ownerRow.rowIndex+n.cellFormat.rowSpan===n.ownerTable.childWidgets.length?n.getBorderBasedOnPriority(n.getBorderBasedOnPriority(n.cellFormat.borders.bottom,n.ownerRow.rowFormat.borders.bottom),n.ownerTable.tableFormat.borders.bottom):ua.getCellBottomBorder(n);var B=t.x-t.margin.left-p/2,L=t.x+t.width+t.margin.right;H&&O.childWidgets.length<n.ownerRow.childWidgets.length&&H<n.columnIndex+n.cellFormat.columnSpan||sf.base.isNullOrUndefined(O)||d||!(O.rowFormat.gridAfter>0)||0===O.rowFormat.afterWidth&&0===O.rowFormat.gridAfterWidth||sf.base.isNullOrUndefined(O.lastChild)||sf.base.isNullOrUndefined(ua.getCellTopBorder(O.lastChild))||"None"===ua.getCellTopBorder(O.lastChild).lineStyle||!(t.x<O.lastChild.x+O.lastChild.width+O.lastChild.margin.right)||(B=O.lastChild.x+O.lastChild.width+O.lastChild.margin.right),H&&O.childWidgets.length<n.ownerRow.childWidgets.length&&H<n.columnIndex+n.cellFormat.columnSpan||sf.base.isNullOrUndefined(O)||d||!(O.rowFormat.gridBefore>0)||0===O.rowFormat.beforeWidth&&0===O.rowFormat.gridBeforeWidth||sf.base.isNullOrUndefined(O.firstChild)||sf.base.isNullOrUndefined(ua.getCellTopBorder(O.firstChild))||"None"===ua.getCellTopBorder(O.firstChild).lineStyle||!(t.x+t.width>O.firstChild.x-O.firstChild.margin.left)||(L=O.firstChild.x-O.firstChild.margin.left),c=x.convertPointToPixel(h.getLineWidth()),this.renderSingleBorder(h.color,B,t.y+t.height+s+c/2,L,t.y+t.height+s+c/2,c,h.lineStyle)}h=r.getCellDiagonalUpBorder(n),(c=x.convertPointToPixel(h.getLineWidth()))>0&&this.renderSingleBorder(h.color,t.x-a,t.y+t.height+s,t.x+t.width+i,t.y-o,c,h.lineStyle),h=r.getCellDiagonalDownBorder(n),(c=x.convertPointToPixel(h.getLineWidth()))>0&&this.renderSingleBorder(h.color,t.x-a,t.y-o,t.x+t.width+i,t.y+t.height+s,c,h.lineStyle)},i.prototype.renderCellBackground=function(e,t,i,r,n){var o=t.cellFormat,s="#ffffff"===o.shading.backgroundColor?t.ownerTable.tableFormat.shading.backgroundColor:o.shading.backgroundColor,a=t.x-i-n,l=t.margin.top-t.containerWidget.topBorderWidth,d=t.y-l,h=t.width+i+r+n/2;t.ownerRow.rowFormat.revisions.length>0&&(s="Insertion"===t.ownerRow.rowFormat.revisions[t.ownerRow.rowFormat.revisions.length-1].revisionType?"#e1f2fa":"#fce6f4");this.pageContext.beginPath(),"empty"!==s&&(this.pageContext.fillStyle=x.getColor(s),this.pageContext.fillRect(this.getScaledValue(a,1),this.getScaledValue(d,2),this.getScaledValue(h),this.getScaledValue(e)),this.pageContext.closePath()),o.shading.hasValue("foregroundColor")&&"TextureNone"!==o.shading.textureStyle&&(this.pageContext.beginPath(),this.pageContext.fillStyle=this.drawTextureStyle(o.shading.textureStyle,x.getColor(o.shading.foregroundColor),x.getColor(o.shading.backgroundColor),"empty"===o.shading.foregroundColor,"empty"===o.shading.backgroundColor),this.pageContext.fillRect(this.getScaledValue(a,1),this.getScaledValue(d,2),this.getScaledValue(h),this.getScaledValue(e)),this.pageContext.closePath())},i.prototype.drawTextureStyle=function(e,t,i,r,n){if(n&&(i="#ffffff"),r&&(t="#000000"),e.indexOf("Percent")>-1){var o=e.replace("Texture","").replace("Percent","").replace("Pt","."),s=parseInt(o);return this.getForeColor(t,i,s,r,n)}return"TextureSolid"===e?t:"#FFFFFF"},i.prototype.getForeColor=function(e,t,i,r,n){var o,s,a,l=x.convertHexToRgb(e),d=x.convertHexToRgb(t);return o=this.getColorValue(l.r,d.r,i,r,n),s=this.getColorValue(l.g,d.g,i,r,n),a=this.getColorValue(l.b,d.b,i,r,n),"#"+x.convertRgbToHex(o)+x.convertRgbToHex(s)+x.convertRgbToHex(a)},i.prototype.getColorValue=function(e,t,i,r,n){return 100==i?e:r?n?Math.round(255*(1-i/100)):Math.round(t*(1-i/100)):n?Math.round(e*(i/100)):t+Math.round(e*(i/100))-Math.round(t*(i/100))},i.prototype.renderSingleBorder=function(e,t,i,r,n,o,s){this.pageContext.beginPath(),this.pageContext.moveTo(this.getScaledValue(t,1),this.getScaledValue(i,2)),this.pageContext.lineTo(this.getScaledValue(r,1),this.getScaledValue(n,2)),this.pageContext.lineWidth=this.getScaledValue(o),this.pageContext.strokeStyle=x.getColor(e),"None"!==s&&"Cleared"!==s&&this.pageContext.stroke(),this.pageContext.closePath()},i.prototype.getScaledValue=function(e,t){return this.isPrinting?e:(sf.base.isNullOrUndefined(t)&&(t=0),e*this.documentHelper.zoomFactor+(1===t?this.pageLeft:2===t?this.pageTop:0))},i.prototype.checkRevisionType=function(e){for(var t=[],i=e.revisions.length,r=0;r<i;r++){var n=e.revisions[r],o=this.documentHelper.authors.get(n.author);t.push({type:n.revisionType,color:o})}return t},i.prototype.getRevisionColor=function(e){if(1===e.length)return e[0].color;for(var t=0;t<e.length;t++)if("Deletion"===e[t].type||"MoveFrom"===e[t].type)return e[t].color;return e.length>0?e[0].color:void 0},i.prototype.getRevisionType=function(e,t){if(0!==e.length)for(var i=0;i<e.length;i++){var r=void 0;if(t&&("Insertion"===e[i].type||"MoveTo"===e[i].type))return r=e[i],this.pageContext.fillStyle=x.getColor(r.color),e.splice(i,1),r;if(!t&&("Deletion"===e[i].type||"MoveFrom"===e[i].type))return r=e[i],this.pageContext.fillStyle=x.getColor(r.color),e.splice(i,1),r}},i.prototype.getFormfieldInLine=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t]instanceof va&&!sf.base.isNullOrUndefined(e.children[t].formFieldData))return e.children[t]},i.prototype.destroy=function(){this.documentHelper=void 0,sf.base.isNullOrUndefined(this.pageCanvasIn)||(this.pageCanvasIn.innerHTML=""),this.pageCanvasIn=void 0},i}(),L=function(){function i(e){this.paragraphMarkInfo={},this.documentHelper=e,sf.base.isNullOrUndefined(e)||(this.context=e.containerContext)}return Object.defineProperty(i.prototype,"paragraphMark",{get:function(){return"¶"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lineBreakMark",{get:function(){return"↲"},enumerable:!0,configurable:!0}),i.prototype.getEnSpaceCharacter=function(){return String.fromCharCode(8194)},i.prototype.repeatChar=function(e,t){for(var i="",r=0;r<t;r++)i+=e;return i},i.prototype.getParagraphMarkWidth=function(e){return this.getParagraphMarkSize(e).Width},i.prototype.getParagraphMarkSize=function(e){var t=this.getFormatText(e);if(this.paragraphMarkInfo[""+t])return this.paragraphMarkInfo[""+t];var i=this.getWidth(this.paragraphMark,e),r=this.getHeight(e),n={Width:i,Height:r.Height,BaselineOffset:r.BaselineOffset};return this.paragraphMarkInfo[""+t]=n},i.prototype.getTextSize=function(e,t){var i=0,r=t.bidi||this.isRTLText(e.text),n=this.setText(e.text,r,t.bdo);"\r"===n&&(n=String.fromCharCode(182)),i=this.getWidth(n,t,e.scriptType),e.width=i;var o=this.getHeight(t,e.scriptType);return"Word2003"===this.documentHelper.compatibilityMode&&e.isColumnBreak||(e.height=o.Height),e.baselineOffset=o.BaselineOffset," "===e.text[e.text.length-1]&&(i=this.getWidth(x.trimEnd(e.text),t,e.scriptType)),e.trimEndWidth=i,i},i.prototype.getHeight=function(e,t){var i=this.getFontNameToRender(t,e),r=this.getFormatText(e,i);if(!sf.base.isNullOrUndefined(this.documentHelper.heightInfoCollection[""+r]))return this.documentHelper.heightInfoCollection[""+r];var n=this.documentHelper.owner.textMeasureHelper.getHeightInternal(e,i);return this.documentHelper.heightInfoCollection[""+r]=n,n},i.prototype.getFormatText=function(e,t){var i="";return i=sf.base.isNullOrUndefined(t)?e.fontFamily.toLocaleLowerCase():t.toLocaleLowerCase(),i+=";"+e.fontSize,e.bold&&(i+=";bold"),e.italic&&(i+=";italic"),i},i.prototype.getHeightInternal=function(e){var t,i,r=document.createElement("span");r.innerText="m",this.applyStyle(r,e);var n=document.createElement("div");n.setAttribute("style","display:inline-block;position:absolute;");var o=document.createElement("div");o.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),n.appendChild(r),n.appendChild(o),document.body.appendChild(n),t=r.offsetHeight;var s=r.offsetTop;return i=o.offsetTop-s,document.body.removeChild(n),{Height:t,BaselineOffset:i}},i.prototype.measureTextExcludingSpaceAtEnd=function(e,t,i){return this.getWidth(x.trimEnd(e),t,i)},i.prototype.getWidth=function(e,t,i){e.match("\v")&&e.replace("\v",this.lineBreakMark);var r,n,o,s=t.fontSize;r=t.bold?"bold":"",n=t.italic?"italic":"",o=this.getFontNameToRender(i,t),s=0===s?.5:s/("Normal"===t.baselineAlignment?1:1.5),this.context.font=r+" "+n+" "+s+'pt "'+o+'"',this.context.letterSpacing=t.characterSpacing+"pt";var a=t.scaling/100;return t.allCaps&&(e=e.toUpperCase()),"̶"==e&&(e+="A"),Math.abs(this.context.measureText(e).width*a)},i.prototype.setText=function(e,t,i,r){if(sf.base.isNullOrUndefined(r)&&(r=!1),0===e.length)return"";var n=t;if(!n&&"RTL"===i||n&&"LTR"===i)e=x.reverseString(e);else if(r&&n&&x.endsWith(e)){var o=e.length-x.trimEnd(e).length;e=x.addSpace(o)+x.trimEnd(e)}return e},i.prototype.applyStyle=function(e,t){if(!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)){var i="white-space:nowrap;";""!==t.fontFamily&&(i+="font-family:"+t.fontFamily+";");var r=t.fontSize;r<=.5&&(r=.5),i+="font-size:"+r.toString()+"pt;",t.bold&&(i+="font-weight:bold;"),t.italic&&(i+="font-style:italic;"),e.setAttribute("style",i)}},i.prototype.measureText=function(e,t,i){var r=this.getWidth(e,t,i),n=this.getHeight(t,i);return{Width:r,Height:n.Height,BaselineOffset:n.BaselineOffset}},i.prototype.updateTextSize=function(e,t){var i=new T(void 0),r=e.listLevel.characterFormat,n=t.characterFormat;i.fontSize=r.hasValue("fontSize")?r.fontSize:n.fontSize,i.fontFamily=r.hasValue("fontFamily")?r.fontFamily:n.fontFamily;var o,s,a="Normal"===r.baselineAlignment?n.baselineAlignment:r.baselineAlignment;o=r.hasValue("bold")?r.bold?"bold":"":n.bold?"bold":"",s=r.hasValue("italic")?r.italic?"italic":"":n.italic?"italic":"",i.baselineAlignment=a,o&&(i.bold=!0),s&&(i.italic=!0);var l=i.bidi||this.isRTLText(e.text),d=this.setText(e.text,l,i.bdo);e.width=this.getWidth(d,i);var h=this.getHeight(i);e.height=h.Height,e.baselineOffset=h.BaselineOffset},i.prototype.containsSpecialCharAlone=function(e){for(var t="*|.:[]{}-`;()@&$#%!~?, '",i=0;i<e.length;i++)if(-1===t.indexOf(e.charAt(i)))return!1;return!0},i.prototype.containsNumberAlone=function(e){if(""===e)return!1;for(var t=0;t<e.length;t++)if(-1==="0123456789".indexOf(e.charAt(t)))return!1;return!0},i.prototype.containsCombinationText=function(e){return!(!e.text.match(/^[0-9]+$/)||!e.paragraph.bidi)},i.prototype.inverseCharacter=function(e){switch(e){case"(":return")";case")":return"(";case"<":return">";case">":return"<";case"{":return"}";case"}":return"{";case"[":return"]";case"]":return"[";default:return e}},i.prototype.containsSpecialChar=function(e){for(var t="*|.:[]{}-`;()@&$#%!~? ",i=0;i<e.length;i++)if(-1!==t.indexOf(e.charAt(i)))return!0;return!1},i.prototype.isRTLText=function(e){var t=!1;if(!sf.base.isNullOrUndefined(e))for(var i=0;i<e.length;i++){var r=e[i];if(r>=String.fromCharCode(1424)&&r<=String.fromCharCode(1535)||r>=String.fromCharCode(64285)&&r<=String.fromCharCode(64335)||r>=String.fromCharCode(1536)&&r<=String.fromCharCode(1791)||r>=String.fromCharCode(1872)&&r<=String.fromCharCode(1919)||r>=String.fromCharCode(2208)&&r<=String.fromCharCode(2303)||r>=String.fromCharCode(64336)&&r<=String.fromCharCode(65023)||r>=String.fromCharCode(65136)&&r<=String.fromCharCode(65279)||r>=String.fromCharCode(43392)&&r<=String.fromCharCode(43487)||r>=String.fromCharCode(1792)&&r<=String.fromCharCode(1871)||r>=String.fromCharCode(1920)&&r<=String.fromCharCode(1983)||r>=String.fromCharCode(2112)&&r<=String.fromCharCode(2143)||r>=String.fromCharCode(1984)&&r<=String.fromCharCode(2047)||r>=String.fromCharCode(2048)&&r<=String.fromCharCode(2111)||r>=String.fromCharCode(11568)&&r<=String.fromCharCode(11647)){t=!0;break}}return t},i.prototype.isUnicodeText=function(e,t){var i=!1;if(!sf.base.isNullOrUndefined(e))for(var r=0;r<e.length;r++){var n=e[r];if((n>="　"&&n<="ヿ"||n>="＀"&&n<="￯"||n>="一"&&n<="龯"||n>="㐀"&&n<="䶿"||n>="가"&&n<="￯"||n>="඀"&&n<="෿")&&0!==t){i=!0;break}}return i},i.prototype.getRtlLanguage=function(e){return sf.base.isNullOrUndefined(e)||""===e?{isRtl:!1,id:0}:e>=String.fromCharCode(1424)&&e<=String.fromCharCode(1535)?{isRtl:!0,id:1}:e>=String.fromCharCode(1536)&&e<=String.fromCharCode(1791)||e>=String.fromCharCode(1872)&&e<=String.fromCharCode(1919)||e>=String.fromCharCode(2208)&&e<=String.fromCharCode(2303)||e>=String.fromCharCode(64336)&&e<=String.fromCharCode(65023)||e>=String.fromCharCode(65136)&&e<=String.fromCharCode(65279)?{isRtl:!0,id:2}:e>=String.fromCharCode(43392)&&e<=String.fromCharCode(43487)?{isRtl:!0,id:3}:e>=String.fromCharCode(1792)&&e<=String.fromCharCode(1871)?{isRtl:!0,id:4}:e>=String.fromCharCode(1920)&&e<=String.fromCharCode(1983)?{isRtl:!0,id:5}:e>=String.fromCharCode(2112)&&e<=String.fromCharCode(2143)?{isRtl:!0,id:6}:e>=String.fromCharCode(1984)&&e<=String.fromCharCode(2047)?{isRtl:!0,id:7}:e>=String.fromCharCode(2048)&&e<=String.fromCharCode(2111)?{isRtl:!0,id:8}:e>=String.fromCharCode(11568)&&e<=String.fromCharCode(11647)?{isRtl:!0,id:9}:{isRtl:!1,id:0}},i.prototype.splitTextByConsecutiveLtrAndRtl=function(t,r,n,o,s,a){var l=o.length,d=[];if(sf.base.isNullOrUndefined(t)||""===t)return d;for(var h=-1,c="",p="",g="",f="",u=0;u<t.length;u++){var m=0,y=!1;(sf.base.isNullOrUndefined(s.value)?r:!s.value)&&this.isNumber(t[u])?(f+=t[u],m=4):this.isWordSplitChar(t[u])?(m=2,y=r||32==t.charCodeAt(u)&&""==g,g+=t[u]):this.isRTLText(t[u])&&!this.isNumber(t[u])?(s.value=!1,a.value=!0,p+=t[u],m=1):(s.value=!0,c+=t[u]),""!=f&&4!=m&&(d.push(f),o.push(e.Number),f=""),""!=p&&1!=m&&(d.push(p),o.push(e.RightToLeft),p=""),""!=c&&0!=m&&(d.push(c),h=d.length-1,o.push(e.LeftToRight),c=""),""==g||2==m&&!y||(d.push(g),o.push(e.WordSplit),g="")}if(""!=f?(d.push(f),o.push(e.Number)):""!=p?(d.push(p),o.push(e.RightToLeft)):""!=c?(d.push(c),h=d.length-1,o.push(e.LeftToRight)):""!=g&&(d.push(g),o.push(e.WordSplit)),a.value||!sf.base.isNullOrUndefined(s.value)&&!s.value)for(u=1;u<d.length;u++){(w=o[u+l])==e.WordSplit&&1==d[u].length&&u+l+1<o.length&&o[u+l-1]!=e.WordSplit&&(o[u+l-1]!=e.Number||i.isNumberNonReversingCharacter(d[u],r))&&o[u+l-1]==o[u+l+1]&&(d[u-1]=d[u-1]+d[u]+d[u+1],d.splice(u,1),d.splice(u,1),o.splice(u+l,1),o.splice(u+l,1),u--)}else if(-1!=h)if(r)for(u=1;u<h;u++){if((w=o[u+l])==e.WordSplit&&u<h&&o[u+l-1]==e.LeftToRight){c="";for(var v=u+1;v<=h;v++)c+=d[v],d.splice(v,1),o.splice(v+l,1),v--,h--;d[u-1]=d[u-1]+d[u]+c,d.splice(u,1),o.splice(u+l,1),u--,h--}}else d.length=0,d.push(t);else r||(d.length=0,d.push(t));if(r)for(u=1;u<d.length;u++){var w;(w=o[u+l])==e.WordSplit&&1==d[u].length&&u+l+1<o.length&&o[u+l-1]!=e.WordSplit&&(o[u+l-1]!=e.Number||i.isNumberNonReversingCharacter(d[u],r)||!n)&&o[u+l-1]==o[u+l+1]?(d[u-1]=d[u-1]+d[u]+d[u+1],d.splice(u,1),d.splice(u,1),o.splice(u+l,1),o.splice(u+l,1),u--):w==e.WordSplit&&o[u+l-1]==e.Number&&this.isNonWordSplitCharacter(d[u])&&!n?(d[u-1]=d[u-1]+d[u],d.splice(u,1),o.splice(u+l,1),u--):w!=e.LeftToRight||o[u+l-1]!=e.Number&&o[u+l-1]!=e.LeftToRight||(d[u-1]=d[u-1]+d[u],o[u+l-1]=e.LeftToRight,d.splice(u,1),o.splice(u+l,1),u--)}return d},i.prototype.isRightToLeftLanguage=function(e){return 14337==e||15361==e||5121==e||3073==e||2049==e||11265==e||13313==e||12289==e||4097==e||8193==e||16385==e||1025==e||10241==e||7169==e||9217==e||10655==e},i.prototype.isNumber=function(e){return!isNaN(parseInt(e,10))||(e>=String.fromCharCode(1632)&&e<=String.fromCharCode(1641)||e>=String.fromCharCode(1776)&&e<=String.fromCharCode(1785))},i.prototype.isWordSplitChar=function(e){for(var t=0;t<i.wordSplitCharacters.length;t++)if(i.wordSplitCharacters[t]===e)return!0;return!1},i.isNumberNonReversingCharacter=function(e,t){for(var r=0;r<i.numberNonReversingCharacters.length;r++){var n=i.numberNonReversingCharacters[r];if(e[0]==n&&(47!=n.charCodeAt(0)||!t))return!0}return!1},i.prototype.isNonWordSplitCharacter=function(e){for(var t=!1,i=0;i<e.length;i++){var r=e.charCodeAt(i);if(35!=r&&36!=r&&37!=r){t=!1;break}t=!0}return t},i.prototype.getFontNameToRender=function(e,t){return sf.base.isNullOrUndefined(e)?t.fontFamily:t.bidi||t.complexScript?this.getFontNameBidiToRender(e,t):this.isEastAsiaScript(e)&&!sf.base.isNullOrUndefined(t.fontFamilyFarEast)?this.getFontNameEAToRender(e,t):this.getFontNameAsciiToRender(e,t)},i.prototype.isEastAsiaScript=function(e){return e==t.Japanese||e==t.Korean||e==t.Chinese},i.prototype.getFontNameEAToRender=function(e,t){var i=t.fontFamilyFarEast;return sf.base.isNullOrUndefined(i)||x.isThemeFont(i)?this.getFontNameFromTheme(t,i,e,r.EastAsia):i},i.prototype.getFontNameAsciiToRender=function(e,t){var i=t.fontFamilyAscii;return x.isThemeFont(i)?this.getFontNameFromTheme(t,i,e,r.Default):t.fontFamily},i.prototype.getFontNameBidiToRender=function(e,t){var i=t.fontFamilyBidi;return!sf.base.isNullOrUndefined(i)||x.isThemeFont(i)?this.getFontNameFromTheme(t,i,e,r.CS):i},i.prototype.getFontNameFromTheme=function(e,t,i,r){var n;if(!this.documentHelper.hasThemes||sf.base.isNullOrUndefined(this.documentHelper.themes)||sf.base.isUndefined(this.documentHelper.themes.fontScheme)||(n=this.documentHelper.themes.fontScheme),"majorAscii"==t||"majorBidi"==t||"majorEastAsia"==t||"majorHAnsi"==t){var o=void 0;null!=n&&null!=n.majorFontScheme&&(o=n.majorFontScheme),t=this.updateFontNameFromTheme(e,o,i,t,r)}else if("minorAscii"==t||"minorBidi"==t||"minorEastAsia"==t||"minorHAnsi"==t){var s=void 0;null!=n&&null!=n.majorFontScheme&&(s=n.minorFontScheme),t=this.updateFontNameFromTheme(e,s,i,t,r)}return(sf.base.isNullOrUndefined(t)||x.isThemeFont(t))&&(t=z),t},i.prototype.updateFontNameFromTheme=function(e,t,i,n,o){var s="";if(null!=t&&null!=t.fontSchemeList&&t.fontSchemeList.length>0&&t.fontSchemeList.forEach((function(e){("cs"!=e.name||"majorBidi"!=n&&"minorBidi"!=n)&&("ea"!=e.name||"majorEastAsia"!=n&&"minorEastAsia"!=n)&&("latin"!=e.name||"majorAscii"!=n&&"majorHAnsi"!=n&&"minorAscii"!=n&&"minorHAnsi"!=n)||(s=e.typeface)})),null!=t&&null!=t.fontTypeface)if(o==r.CS)t.fontTypeface.containsKey("Arab")&&(s=t.fontTypeface.get("Arab"));else if(o==r.EastAsia);else if(sf.base.isNullOrUndefined(s)&&null!=this.documentHelper.themeFontLanguage&&("minorBidi"===n||"majorBidi"===n))return n=this.getFontNameWithFontScript(t,this.documentHelper.themeFontLanguage.localeIdBidi,o);return sf.base.isNullOrUndefined(s)&&(s=z),n=s},i.prototype.getFontNameWithFontScript=function(e,t,i){var n=null,o=t.toString(),s=e.fontTypeface;return("gu_IN"!=o&&1095!=t||!s.containsKey("Gujr"))&&("hi_IN"!=o&&"mr_IN"!=o&&1081!=t&&1102!=t||!s.containsKey("Deva"))&&!(("ko_KR"==o||1042==t)&&s.containsKey("Hang")||("zh_CN"==o||"zh_SG"==o||2052==t)&&s.containsKey("Hans")||("zh_TW"==o||"zh_HK"==o||"zh_MO"==o)&&s.containsKey("Hant")||("ja_JP"==o||1041==t)&&s.containsKey("Jpan")||("ta_IN"==o||1097==t)&&s.containsKey("Taml")||("te_IN"==o||1098==t)&&s.containsKey("Telu")||("he_IL"==o||"yi_Hebr"==o||1037==t)&&s.containsKey("Hebr"))?"th_TH"!=o&&1054!=t||!s.containsKey("Thai")?i==r.CS&&s.containsKey("Arab")&&(n=s.get("Arab")):n=s.get("Thai"):n=s.get("Arab"),n},i.prototype.destroy=function(){this.documentHelper=void 0,this.context=void 0,this.paragraphMarkInfo={},this.paragraphMarkInfo=void 0},i.wordSplitCharacters=[String.fromCharCode(32),String.fromCharCode(33),String.fromCharCode(34),String.fromCharCode(35),String.fromCharCode(36),String.fromCharCode(37),String.fromCharCode(38),String.fromCharCode(39),String.fromCharCode(40),String.fromCharCode(41),String.fromCharCode(42),String.fromCharCode(43),String.fromCharCode(44),String.fromCharCode(45),String.fromCharCode(46),String.fromCharCode(47),String.fromCharCode(58),String.fromCharCode(59),String.fromCharCode(60),String.fromCharCode(61),String.fromCharCode(62),String.fromCharCode(63),String.fromCharCode(64),String.fromCharCode(91),String.fromCharCode(92),String.fromCharCode(93),String.fromCharCode(94),String.fromCharCode(95),String.fromCharCode(96),String.fromCharCode(123),String.fromCharCode(124),String.fromCharCode(125),String.fromCharCode(126),String.fromCharCode(1548),String.fromCharCode(1563),String.fromCharCode(8211),String.fromCharCode(8212),String.fromCharCode(8216),String.fromCharCode(8217),String.fromCharCode(8221),String.fromCharCode(12288),String.fromCharCode(8207)],i.numberNonReversingCharacters=[String.fromCharCode(44),String.fromCharCode(46),String.fromCharCode(47),String.fromCharCode(58),String.fromCharCode(1548)],i}(),A=function(){function e(e){var t=this;this.onMouseWheelInternal=function(e){if(!0===e.ctrlKey&&(e.preventDefault(),e.pageX-t.documentHelper.viewerContainer.offsetLeft<t.documentHelper.pageContainer.offsetWidth)){var i=void 0;void 0!==navigator&&(i=navigator.userAgent.match("Firefox"));var r=i?e.detail<0:sf.base.Browser.isIE?e.wheelDelta>0:e.deltaY<0,n=t.documentHelper.zoomFactor;r?n<=4.9?n+=.1:n=5:n>=.2?n-=.1:n=.1,t.documentHelper.zoomFactor=n}},this.documentHelper=e}return e.prototype.setZoomFactor=function(){this.onZoomFactorChanged(),sf.base.isNullOrUndefined(this.documentHelper.selection)||this.documentHelper.selection.updateCaretPosition(),this.documentHelper.updateTouchMarkPosition(),sf.base.isNullOrUndefined(this.documentHelper.owner.imageResizerModule)||this.documentHelper.owner.imageResizerModule.updateImageResizerPosition(),this.documentHelper.owner.rulerHelper&&this.documentHelper.owner.documentEditorSettings&&this.documentHelper.owner.documentEditorSettings.showRuler&&this.documentHelper.owner.rulerHelper.updateRuler(this.documentHelper.owner,!0),this.documentHelper.owner.fireZoomFactorChange()},Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.onZoomFactorChanged=function(){this.documentHelper.zoomFactor>5?this.documentHelper.zoomFactor=5:this.documentHelper.zoomFactor<.1&&(this.documentHelper.zoomFactor=.1),this.zoom()},e.prototype.zoom=function(){var e=this.viewer;this.documentHelper.clearContent(),e.handleZoom(),this.documentHelper.updateFocus()},e}(),M=function(){function e(){this.mode=!0}return e.prototype.send=function(e){var t=this;this.xmlHttpRequest=new XMLHttpRequest,this.xmlHttpRequest.onreadystatechange=function(){t.stateChange(t)},this.xmlHttpRequest.onerror=function(){t.error(t)},this.mode?this.sendRequest(e):setTimeout((function(){t.sendRequest(e)}))},e.prototype.sendRequest=function(e){this.xmlHttpRequest.open("POST",this.url,!0),this.contentType&&this.xmlHttpRequest.setRequestHeader("Content-Type",this.contentType),this.setCustomAjaxHeaders(),this.responseType&&(this.xmlHttpRequest.responseType=this.responseType);var t=e instanceof FormData?e:JSON.stringify(e);this.xmlHttpRequest.send(t)},e.prototype.stateChange=function(e){if(4===e.xmlHttpRequest.readyState&&200===e.xmlHttpRequest.status){var t={name:"onSuccess",data:this.responseType?e.xmlHttpRequest.response:e.xmlHttpRequest.responseText,readyState:e.xmlHttpRequest.readyState,status:e.xmlHttpRequest.status};e.successHandler(t)}else if(4===e.xmlHttpRequest.readyState&&200!==e.xmlHttpRequest.status){t={name:"onFailure",status:e.xmlHttpRequest.status,statusText:e.xmlHttpRequest.statusText,url:e.url};e.failureHandler(t)}},e.prototype.error=function(e){var t={name:"onError",status:this.xmlHttpRequest.status,statusText:this.xmlHttpRequest.statusText};e.errorHandler(t)},e.prototype.successHandler=function(e){return this.onSuccess&&this.onSuccess(e),e},e.prototype.failureHandler=function(e){return this.onFailure&&this.onFailure(e),e},e.prototype.errorHandler=function(e){return this.onError&&this.onError(e),e},e.prototype.setCustomAjaxHeaders=function(){for(var e=0;e<this.customHeaders.length;e++)for(var t=this.customHeaders[e],i=0,r=Object.keys(t);i<r.length;i++){var n=r[i];this.xmlHttpRequest.setRequestHeader(n,t[n])}},e}(),z="Times New Roman",D=["sections","sec"],V=["fontSubstitutionTable","fst"],q=["characterFormat","cf"],_=["paragraphFormat","pf"],j=["lists","li"],G=["abstractLists","al"],K=["background","bg"],X=["styles","sty"],J=["comments","cm"],Y=["paraStyleName","psty"],Z=["revisions","r"],Q=["customXml","cx"],$=["defaultTabWidth","dtw"],ee=["formatting","fmt"],te=["trackChanges","tc"],ie=["protectionType","pt"],re=["enforcement","enf"],ne=["hashValue","hv"],oe=["saltValue","sv"],se=["isCreatedUsingHtmlSpanTag","ishst"],ae=["dontUseHTMLParagraphAutoSpacing","dhtml"],le=["isLegalStyleNumbering","isLgl"],de=["alignTablesRowByRow","atrr"],he=["formFieldShading","ffs"],ce=["lastParagraphMarkCopied","lpmc"],pe=["footnotes","fn"],ge=["endnotes","en"],fe=["compatibilityMode","comp"],ue=["themeFontLanguages","tfl"],me=["themes","thm"],ye=["name","n"],ve=["basedOn","b"],we=["next","nx"],be=["link","l"],xe=["localeId","id"],Ie=["localeIdFarEast","idfe"],Fe=["localeIdBidi","idbi"],Ce=["bold","b"],We=["italic","i"],ke=["underline","u"],Se=["baselineAlignment","ba"],Pe=["strikethrough","st"],Ne=["highlightColor","hc"],Oe=["fontSize","fsz"],Te=["fontColor","fc"],He=["fontFamily","ff"],Ee=["styleName","stn"],Re=["bidi","bi"],Ue=["bdo","bdo"],Be=["breakClearType","bct"],Le=["fontSizeBidi","fszbi"],Ae=["fontFamilyBidi","ffbi"],Me=["boldBidi","bbi"],ze=["italicBidi","ibi"],De=["allCaps","ac"],Ve=["complexScript","cs"],qe=["fontFamilyAscii","ffa"],_e=["fontFamilyFarEast","fffe"],je=["fontFamilyNonFarEast","ffnfe"],Ge=["revisionIds","rids"],Ke=["listId","lid"],Xe=["listLevelNumber","lilno"],Je=["leftIndent","lin"],Ye=["rightIndent","rin"],Ze=["firstLineIndent","fin"],Qe=["textAlignment","ta"],$e=["afterSpacing","as"],et=["beforeSpacing","bs"],tt=["spaceAfterAuto","saa"],it=["spaceBeforeAuto","sba"],rt=["lineSpacing","ls"],nt=["lineSpacingType","lst"],ot=["listFormat","lif"],st=["keepWithNext","kwn"],at=["widowControl","wc"],lt=["keepLinesTogether","klt"],dt=["outlineLevel","ol"],ht=["contextualSpacing","cs"],ct=["borders","bdrs"],pt=["tabs","tb"],gt=["headerDistance","hd"],ft=["footerDistance","fd"],ut=["differentFirstPage","dfp"],mt=["differentOddAndEvenPages","doep"],yt=["pageWidth","pw"],vt=["pageHeight","ph"],wt=["leftMargin","lm"],bt=["rightMargin","rm"],xt=["topMargin","tm"],It=["bottomMargin","bm"],Ft=["restartPageNumbering","rpn"],Ct=["pageStartingNumber","psn"],Wt=["endnoteNumberFormat","enf"],kt=["footNoteNumberFormat","fnf"],St=["restartIndexForFootnotes","rif"],Pt=["restartIndexForEndnotes","rie"],Nt=["initialFootNoteNumber","ifn"],Ot=["initialEndNoteNumber","ien"],Tt=["pageNumberStyle","pgns"],Ht=["columns","cols"],Et=["numberOfColumns","ncols"],Rt=["equalWidth","eqw"],Ut=["lineBetweenColumns","lbtc"],Bt=["breakCode","bc"],Lt=["cellWidth","cw"],At=["columnSpan","colsp"],Mt=["rowSpan","rwsp"],zt=["verticalAlignment","va"],Dt=["allowBreakAcrossPages","abrk"],Vt=["isHeader","hdr"],qt=["heightType","ht"],_t=["gridBefore","gb"],jt=["gridBeforeWidth","gbw"],Gt=["gridBeforeWidthType","gbwt"],Kt=["gridAfter","ga"],Xt=["gridAfterWidth","gaw"],Jt=["gridAfterWidthType","gawt"],Yt=["allowAutoFit","auft"],Zt=["cellSpacing","csp"],Qt=["shading","sd"],$t=["tableAlignment","ta"],ei=["preferredWidth","pw"],ti=["preferredWidthType","pwt"],ii=["horizontalPositionAbs","hpa"],ri=["texture","t"],ni=["backgroundColor","bgc"],oi=["foregroundColor","fgc"],si=["shadow","sh"],ai=["hasNoneStyle","hns"],li=["vertical","v"],di=["horizontal","h"],hi=["diagonalUp","du"],ci=["diagonalDown","dd"],pi=["lineStyle","ls"],gi=["lineWidth","lw"],fi=["layout","l"],ui=["dataFormat","df"],mi=["yValue","y"],yi=["chartData","chd"],vi=["categoryXName","cx"],wi=["line","l"],bi=["foreColor","fc"],xi=["layoutX","x"],Ii=["layoutY","y"],Fi=["direction","dir"],Ci=["endStyle","est"],Wi=["numberValue","no"],ki=["markerStyle","mst"],Si=["markerColor","mc"],Pi=["markerSize","msz"],Ni=["forward","fw"],Oi=["backward","bw"],Ti=["intercept","itr"],Hi=["isDisplayRSquared","idrs"],Ei=["isDisplayEquation","ideq"],Ri=["seriesName","sn"],Ui=["dataLabel","sl"],Bi=["errorBar","eb"],Li=["seriesFormat","sf"],Ai=["trendLines","tl"],Mi=["dataPoints","dp"],zi=["firstSliceAngle","fsa"],Di=["holeSize","hsz"],Vi=["isLegendKey","lk"],qi=["isBubbleSize","bsz"],_i=["isCategoryName","icn"],ji=["isSeriesName","isn"],Gi=["isValue","iv"],Ki=["isPercentage","ip"],Xi=["isLeaderLines","il"],Ji=["showSeriesKeys","sk"],Yi=["hasHorzBorder","hhbdr"],Zi=["hasVertBorder","hvbdr"],Qi=["hasBorders","hbdr"],$i=["categoryType","ct"],er=["chartCategory","c"],tr=["chartSeries","cs"],ir=["chartArea","ca"],rr=["chartTitleArea","cta"],nr=["plotArea","pa"],or=["chartLegend","cl"],sr=["chartPrimaryCategoryAxis","cpca"],ar=["chartPrimaryValueAxis","cpva"],lr=["chartTitle","ctt"],dr=["chartType","ct"],hr=["gapWidth","gw"],cr=["overlap","o"],pr=["chartDataTable","cdt"],gr=["text","tlp"],fr=["shapeId","sid"],ur=["alternativeText","at"],mr=["visible","v"],yr=["belowText","b"],vr=["horizontalRule","ihr"],wr=["width","w"],br=["height","h"],xr=["widthScale","ws"],Ir=["heightScale","hs"],Fr=["lineFormat","lf"],Cr=["fillFormat","ff"],Wr=["textWrappingStyle","tws"],kr=["textWrappingType","twt"],Sr=["verticalRelativePercent","vrp"],Pr=["horizontalRelativePercent","hrp"],Nr=["heightRelativePercent","hrp"],Or=["widthRelativePercent","wrp"],Tr=["zOrderPosition","z"],Hr=["layoutInCell","lc"],Er=["lockAnchor","la"],Rr=["autoShapeType","ast"],Ur=["textFrame","tf"],Br=["color","c"],Lr=["fill","f"],Ar=["textVerticalAlignment","tva"],Mr=["imageString","img"],zr=["metaFileImageString","mtimg"],Dr=["isInlineImage","inimg"],Vr=["isMetaFile","imf"],qr=["top","tp"],_r=["bottom","bt"],jr=["right","rg"],Gr=["left","lt"],Kr=["getimageheight","gih"],Xr=["getimagewidth","giw"],Jr=["hasFieldEnd","hfe"],Yr=["formFieldData","ffd"],Zr=["fieldType","ft"],Qr=["enabled","e"],$r=["helpText","h"],en=["statusText","st"],tn=["textInput","ti"],rn=["checkBox","c"],nn=["dropDownList","ddl"],on=["maxLength","ml"],sn=["defaultValue","dv"],an=["format","f"],ln=["sizeType","szt"],dn=["size","sz"],hn=["checked","chk"],cn=["dropDownItems","ddi"],pn=["selectedIndex","si"],gn=["commentId","cid"],fn=["commentCharacterType","cct"],un=["author","a"],mn=["initial","i"],yn=["date","dt"],vn=["done","dn"],wn=["replyComments","rc"],bn=["revisionType","rt"],xn=["revisionId","rid"],In=["itemID","iid"],Fn=["xml","x"],Cn=["footnoteType","fnt"],Wn=["symbolCode","sc"],kn=["symbolFontName","sfn"],Sn=["customMarker","cm"],Pn=["inlines","i"],Nn=["contentControlProperties","ccp"],On=["lockContentControl","lcc"],Tn=["lockContents","lc"],Hn=["tag","tg"],En=["title","tt"],Rn=["hasPlaceHolderText","hpt"],Un=["multiline","mul"],Bn=["isTemporary","it"],Ln=["dateCalendarType","dtct"],An=["dateStorageFormat","dtsf"],Mn=["dateDisplayLocale","dtdl"],zn=["dateDisplayFormat","dtdf"],Dn=["isChecked","ichk"],Vn=["uncheckedState","uchk"],qn=["checkedState","chks"],_n=["contentControlListItems","ccli"],jn=["xmlMapping","x"],Gn=["font","f"],Kn=["value","v"],Xn=["displayText","dt"],Jn=["isMapped","imap"],Yn=["isWordMl","iwml"],Zn=["prefixMapping","pmap"],Qn=["xPath","xp"],$n=["storeItemId","siid"],eo=["customXmlPart","cxp"],to=["id","i"],io=["cellFormat","tcpr"],ro=["rowFormat","trpr"],no=["cells","c"],oo=["rows","r"],so=["description","desc"],ao=["wrapTextAround","wta"],lo=["positioning","p"],ho=["tableFormat","tblpr"],co=["allowOverlap","ao"],po=["distanceTop","dt"],go=["distanceRight","dr"],fo=["distanceLeft","dl"],uo=["distanceBottom","db"],mo=["verticalOrigin","vo"],yo=["verticalPosition","vp"],vo=["horizontalOrigin","ho"],wo=["horizontalAlignment","ha"],bo=["horizontalPosition","hp"],xo=["blocks","b"],Io=["header","h"],Fo=["footer","f"],Co=["evenHeader","eh"],Wo=["evenFooter","ef"],ko=["firstPageHeader","fph"],So=["firstPageFooter","fpf"],Po=["headersFooters","hf"],No=["sectionFormat","secpr"],Oo=["listLevelPattern","lilp"],To=["followCharacter","fchar"],Ho=["startAt","sa"],Eo=["restartLevel","rl"],Ro=["levelNumber","lvlno"],Uo=["numberFormat","nf"],Bo=["abstractListId","alid"],Lo=["levels","lvl"],Ao=["overrideListLevel","o"],Mo=["levelOverrides","lo"],zo=["separator","s"],Do=["continuationSeparator","cs"],Vo=["continuationNotice","cn"],qo=["bookmarkType","bkt"],_o=["properties","p"],jo=["tabJustification","tj"],Go=["position","p"],Ko=["deletePosition","dp"],Xo=["tabLeader","tl"],Jo=["editRangeId","erid"],Yo=["columnFirst","cft"],Zo=["columnLast","clt"],Qo=["user","u"],$o=["group","g"],es=["editableRangeStart","ers"],ts=["space","sp"],is=["fontScheme","fsc"],rs=["fontSchemeName","fscn"],ns=["majorFontScheme","majfs"],os=["minorFontScheme","minfs"],ss=["fontSchemeList","fsl"],as=["fontTypeface","ft"],ls=["typeface","t"],ds=["panose","p"],hs=["type","t"],cs=["majorUnit","maju"],ps=["isAutoMajor","iam"],gs=["maximumValue","maxv"],fs=["minimumValue","minv"],us=["hasMajorGridLines","hmajgl"],ms=["hasMinorGridLines","hmingl"],ys=["majorTickMark","majtm"],vs=["minorTickMark","mintm"],ws=["tickLabelPosition","tlp"],bs=["rgb","rgb"],xs=["appearance","a"],Is=["lineFormatType","lft"],Fs=["allowSpaceOfSameStyleInTable","stytbl"],Cs=["weight","w"],Ws=["inlineFormat","inf"],ks=["fontName","fn"],Ss=["isCompressed","comp"],Ps=["columnIndex","ci"],Ns=["images","imgs"],Os=["isAfterParagraphMark","apm"],Ts=["isAfterCellMark","acm"],Hs=["isAfterRowMark","arm"],Es=["grid","grd"],Rs=["columnCount","colc"],Us=["isAfterTableMark","atm"],Bs=["characterSpacing","csp"],Ls=["scaling","sc"],As=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new i((function(t){t(e.value)})).then(s,a)}l((r=r.apply(e,t||[])).next())}))},Ms=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},zs=function(){function e(e){this.users=[],this.enableButtons=!0,this.revisions=[],this.sortedRevisions=[],this.noChangesVisibleInternal=!0,this.initialLoad=!1,this.isTrackingPageBreak=!1,this.tableRevisions=new a,this.renderedChanges=new a,this.owner=e,this.selectedUser="All",this.selectedType="All"}return Object.defineProperty(e.prototype,"setNoChangesVisibility",{get:function(){return this.noChangesVisibleInternal},set:function(e){this.noChangeDivElement.style.display=e?"block":"none",this.noChangesVisibleInternal=e,this.enableDisableToolbarItem(!e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(e){if(!sf.base.isNullOrUndefined(this.changesInfoDiv)){var t=sf.base.select(".e-de-trckchanges-inner-select",this.changesInfoDiv);if(sf.base.isNullOrUndefined(e))sf.base.isNullOrUndefined(t)||t.classList.remove("e-de-trckchanges-inner-select");else if(e!==this.currentSelectedRevisionInternal||sf.base.isNullOrUndefined(t)){if(t&&t.classList.remove("e-de-trckchanges-inner-select"),!sf.base.isNullOrUndefined(this.changes)&&this.changes.length>0&&this.changes.containsKey(e))this.changes.get(e).singleInnerDiv.classList.add("e-de-trckchanges-inner-select")}this.currentSelectedRevisionInternal=e,t=sf.base.select(".e-de-trckchanges-inner-select",this.changesInfoDiv),sf.base.isNullOrUndefined(t)||t.parentElement.scrollIntoView({block:"nearest"})}},enumerable:!0,configurable:!0}),e.prototype.initTrackChangePane=function(){this.changes=new a,this.changesInfoDiv=this.owner.element.getElementsByClassName("e-de-tc-pane-revision")[0],this.changesInfoDiv||(this.changesInfoDiv=sf.base.createElement("div",{id:"e-de-tc-pane-revision",styles:"overflow:auto"})),this.noChangeDivElement=sf.base.createElement("div",{styles:"display:none;",className:"e-de-tc-no-chng"}),this.noChangeDivElement.textContent=this.owner.localeKeys.DocumentEditor_NoChanges,this.changesInfoDiv.appendChild(this.noChangeDivElement),this.updateTrackChanges()},e.prototype.enableDisableToolbarItem=function(e){},e.prototype.getSpanView=function(e,t){return(0===t?'<span class="e-de-track-span-user">':'<span class="e-de-track-span-view">')+e+"</span>"},e.prototype.onSelection=function(e){this.currentSelectedRevision=e},e.prototype.onUserSelect=function(e){this.selectedUser=e,this.sortCollectionToDisplay()},e.prototype.onMenuSelect=function(e){var t=this;"Accept all"===e?setTimeout((function(){t.owner.revisionsInternal.handleRevisionCollection(!0,t.sortedRevisions)})):"Reject all"===e&&setTimeout((function(){t.owner.revisionsInternal.handleRevisionCollection(!1,t.sortedRevisions)})),this.updateUsers()},e.prototype.onTypeSelect=function(e){this.selectedType=e,this.sortCollectionToDisplay()},e.prototype.updateMenuOptions=function(){"All"!==this.selectedType&&this.selectedType},e.prototype.sortCollectionToDisplay=function(){var e=!1;this.sortedRevisions=[],this.updateMenuOptions();for(var t=0;!sf.base.isNullOrUndefined(this.changes)&&t<this.changes.length;t++){var i=this.changes.get(this.revisions[t]),r=i.outerSingleDiv;"All"===this.selectedUser&&"All"===this.selectedType?r.style.display="block":"All"===this.selectedUser&&"All"!==this.selectedType?i.revisionType===this.selectedType?r.style.display="block":r.style.display="none":"All"!==this.selectedUser&&"All"===this.selectedType?i.user===this.selectedUser?r.style.display="block":r.style.display="none":i.user===this.selectedUser&&i.revisionType===this.selectedType?r.style.display="block":r.style.display="none","block"===r.style.display&&this.sortedRevisions.push(this.revisions[t]),e=!0}this.setNoChangesVisibility=!e},e.prototype.enableDisableButton=function(e){this.enableButtons=e,this.updateTrackChanges()},e.prototype.isUpdateTrackChanges=function(e){var t=!1,i=!1;return sf.base.isNullOrUndefined(this.changesInfoDiv)||(1===this.changesInfoDiv.childNodes.length&&"e-de-tc-no-chng"===this.changesInfoDiv.childNodes[0].className?i=!0:e!==this.changesInfoDiv.childNodes.length&&(t=!0)),(i||e>0)&&(t=!0),t},e.prototype.updateCurrentTrackChanges=function(e){var t;if(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(this.owner.trackChangesPane.changes)||(t=this.owner.trackChangesPane.changes.get(e)),!sf.base.isNullOrUndefined(t)&&e.range.length>0){for(var i=t.singleInnerDiv.querySelector("#textDiv");i.firstChild;)i.removeChild(i.firstChild);t.layoutElementText(e.range,i)}sf.base.isNullOrUndefined(e)||0!==e.range.length||this.owner.revisions.remove(e)},e.prototype.updateTrackChanges=function(e){if(e||sf.base.isNullOrUndefined(e)){if(this.owner.documentHelper.layout.isInitialLoad||this.initialLoad){if(this.tableRevisions.clear(),this.renderedChanges.clear(),sf.base.isNullOrUndefined(this.changesInfoDiv))return void(this.initialLoad=!0);this.removeAllChanges()}else{if(sf.base.isNullOrUndefined(this.changesInfoDiv))return;for(var t=0;t<this.tableRevisions.keys.length;t++){var i=this.tableRevisions.keys[t],r=this.revisions.indexOf(i),n=this.tableRevisions.get(i)[this.tableRevisions.get(i).length-1]===i;if(!sf.base.isNullOrUndefined(this.changes)){var o=this.changes.get(i);n&&!sf.base.isNullOrUndefined(this.changesInfoDiv)&&this.changesInfoDiv.removeChild(o.outerSingleDiv)}this.renderedChanges.containsKey(i)&&this.renderedChanges.remove(i),!sf.base.isNullOrUndefined(this.changes)&&this.changes.containsKey(i)&&this.changes.remove(i),this.revisions.splice(r,1)}this.tableRevisions.clear()}if(this.owner.documentHelper.layout.isInitialLoad||this.initialLoad){this.initialLoad=!1;for(t=0;t<this.owner.revisions.changes.length;t++){i=this.owner.revisions.changes[t];if(!(((g=this.owner.revisions.changes[t].range[0])instanceof Fa||g instanceof va)&&g.paragraph.containerWidget instanceof la&&sf.base.isNullOrUndefined(g.paragraph.containerWidget.sectionFormat))){if(g instanceof Fa&&g.paragraph.containerWidget instanceof la){var s=g.paragraph.containerWidget.headerFooterType,a=this.owner.selection.sectionFormat;if(!("EvenFooter"!==s&&"EvenHeader"!==s&&"OddFooter"!==s&&"OddHeader"!==s||a.differentOddAndEvenPages))continue;if(("FirstPageHeader"===s||"FirstPageFooter"===s)&&!a.differentFirstPage)continue}if(sf.base.isNullOrUndefined(this.changes)||!this.changes.containsKey(i))if(g instanceof k)if((f=this.groupTableRevisions(this.owner.revisions.changes,t)).length>1)for(var l=void 0,d=0;d<f.length;d++){var h=f[d];if(0===d)this.addChanges(h),sf.base.isNullOrUndefined(this.changes)||(l=this.changes.get(i));else{var c=h.range[0];l.appendRowToTable(c,d),this.revisions.push(h),sf.base.isNullOrUndefined(this.changes)||this.changes.add(h,l)}this.tableRevisions.add(h,f)}else this.addChanges(i);else this.addChanges(i)}}for(t=0;t<this.renderedChanges.keys.length;t++){(l=this.renderedChanges.get(this.renderedChanges.keys[t])).updateRevisionIndexAndCount(t+1,this.renderedChanges.keys.length)}}else{var p=0;for(t=0;t<this.owner.revisions.changes.length;t++){i=this.owner.revisions.changes[t];var g=this.owner.revisions.changes[t].range[0];if(sf.base.isNullOrUndefined(this.changes)||!this.changes.containsKey(i)){var f;if(g instanceof k)if((f=this.groupTableRevisions(this.owner.revisions.changes,t)).length>1){0===p&&(p=t);for(l=void 0,d=0;d<f.length;d++){h=f[d];if(0===d){u=new Ds(this.owner,this);sf.base.isNullOrUndefined(this.changesInfoDiv)||this.changesInfoDiv.insertBefore(u.createSingleChangesDiv(h),this.changesInfoDiv.children[p+1]),this.revisions.splice(t,0,h),sf.base.isNullOrUndefined(this.changes)||this.changes.add(h,u),this.renderedChanges.add(h,u),sf.base.isNullOrUndefined(this.changes)||(l=this.changes.get(i))}else{c=h.range[0];l.appendRowToTable(c,d),this.revisions.splice(t+d,0,h),sf.base.isNullOrUndefined(this.changes)||this.changes.add(h,l)}this.tableRevisions.add(h,f)}p++}else{u=new Ds(this.owner,this);sf.base.isNullOrUndefined(this.changesInfoDiv)||this.changesInfoDiv.insertBefore(u.createSingleChangesDiv(i),this.changesInfoDiv.children[t+1]),this.revisions.splice(t,0,i),sf.base.isNullOrUndefined(this.changes)||this.changes.add(i,u),this.renderedChanges.add(i,u)}}else{var u=this.renderedChanges.get(i);if(sf.base.isNullOrUndefined(u))continue;this.enableButtons?u.acceptButtonElement.classList.contains("e-de-overlay")&&!this.owner.documentHelper.isTrackedOnlyMode&&(u.acceptButtonElement.classList.remove("e-de-overlay"),u.rejectButtonElement.classList.remove("e-de-overlay")):u.acceptButtonElement.classList.contains("e-de-overlay")||(u.acceptButtonElement.classList.add("e-de-overlay"),u.rejectButtonElement.classList.add("e-de-overlay")),p++}}var m=document.getElementsByClassName("e-de-track-chngs-count").length;for(t=0;t<m;t++){document.getElementsByClassName("e-de-track-chngs-count")[t].innerHTML=this.owner.localeKeys.DocumentEditor_Changes+" "+(t+1).toString()+" "+this.owner.localeKeys.DocumentEditorContainer_Of+" "+m.toString()}}this.sortCollectionToDisplay(),this.updateUsers(),this.currentSelectedRevision=this.currentSelectedRevisionInternal,this.updateHeight(),this.owner.resize()}else this.currentSelectedRevision=void 0},e.prototype.groupTableRevisions=function(e,t){for(var i=e[t],r=[i],n=i.revisionType,o=i.range[0].ownerBase,s=o.ownerTable,a=o.index,l=this.owner.documentHelper.layout.getParentTable(s),d=t+1;d<e.length;d++){var h=e[d],c=h.revisionType,p=h.range[0];if(!(p instanceof k)){var g=void 0;if(p instanceof T?g=p.ownerBase:p instanceof ya&&(g=p.line.paragraph),g instanceof ca&&g.isInsideTable){m=g.associatedCell.ownerTable;var f=this.owner.documentHelper.layout.getParentTable(m);if(s.equals(m)||!s.equals(m)&&!sf.base.isNullOrUndefined(l)&&l.equals(f))continue}break}var u=p.ownerBase,m=u.ownerTable,y=u.index;if(s.equals(m)||sf.base.isNullOrUndefined(l)||!l.equals(this.owner.documentHelper.layout.getParentTable(m))){if(n!==c||i.author!==h.author||!s.equals(m)||a+1!==y)break;r.push(h),a=y}}return r},e.prototype.updateUsers=function(){this.users.length>0&&(this.users=[]);for(var e=0;e<this.revisions.length;e++)-1===this.users.indexOf(this.revisions[e].author)&&this.users.push(this.revisions[e].author);this.owner.dotNetRef.invokeMethodAsync("UpdateRevisionUsers",this.users)},e.prototype.updateHeight=function(){var e=this.owner.getDocumentEditorElement(),t=0,i=this.owner.element.getElementsByClassName("e-de-review-pane")[0];if(i){var r=e.getBoundingClientRect();t=r.height>0?r.height:200;var n=i.getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height,o=i.getElementsByClassName("e-de-track-toolbar")[0];o&&!sf.base.isNullOrUndefined(this.changesInfoDiv)&&(this.changesInfoDiv.style.height=t-o.clientHeight-n-2+"px")}},e.prototype.removeAllChanges=function(){if(!sf.base.isNullOrUndefined(this.changesInfoDiv)){for(;!sf.base.isNullOrUndefined(this.changesInfoDiv)&&this.changesInfoDiv.childNodes.length>1;)this.changesInfoDiv.removeChild(this.changesInfoDiv.lastChild);if(this.revisions=[],!sf.base.isNullOrUndefined(this.changes)){if(this.changes.length>0)for(var e=0;e<this.changes.length;e++){var t=this.changes.keys[e];this.changes.get(t).clear()}this.changes.clear()}}},e.prototype.clear=function(){this.removeAllChanges(),this.selectedUser="All",this.selectedType="All",this.currentSelectedRevision=void 0},e.prototype.destroy=function(){this.removeAllChanges(),this.users.length>0&&(this.users=[]),this.tableRevisions&&(this.tableRevisions.destroy(),this.tableRevisions=void 0)},e.prototype.addChanges=function(e){if(!sf.base.isNullOrUndefined(this.changesInfoDiv)){var t=new Ds(this.owner,this);this.changesInfoDiv.appendChild(t.createSingleChangesDiv(e)),this.enableButtons?t.acceptButtonElement.classList.contains("e-de-overlay")&&!this.owner.documentHelper.isTrackedOnlyMode&&(t.acceptButtonElement.classList.remove("e-de-overlay"),t.rejectButtonElement.classList.remove("e-de-overlay")):t.acceptButtonElement.classList.contains("e-de-overlay")||(t.acceptButtonElement.classList.add("e-de-overlay"),t.rejectButtonElement.classList.add("e-de-overlay")),this.revisions.push(e),sf.base.isNullOrUndefined(this.changes)||this.changes.add(e,t),this.renderedChanges.add(e,t)}},e.prototype.navigatePreviousChanges=function(){this.revisionNavigateInternal(!1)},e.prototype.navigateNextChanges=function(){this.revisionNavigateInternal(!0)},e.prototype.revisionNavigateInternal=function(e){var t=this.renderedChanges.keys;if(!this.currentSelectedRevisionInternal){if(0===t.length)return;this.currentSelectedRevision=t[0]}if(this.currentSelectedRevision){var i=t,r=this.currentSelectedRevision,n=i.indexOf(r);if(r=e?n===i.length-1?i[0]:i[n+1]:0===n?i[i.length-1]:i[n-1],this.owner.documentHelper.currentSelectedRevision=r,r.range[0]instanceof k){var o=this.groupTableRevisions(this.owner.revisions.changes,this.owner.revisions.changes.indexOf(r));this.owner.selection.selectTableRevision(o)}else this.owner.selection.selectRevision(r)}this.currentSelectedRevision=this.owner.documentHelper.currentSelectedRevision},e}(),Ds=function(){function e(e,t){this.owner=e,this.trackChangesPane=t}return e.prototype.updateRevisionIndexAndCount=function(e,t){this.changesCount.innerHTML=this.owner.localeKeys.DocumentEditor_Changes+" "+e.toString()+" "+this.owner.localeKeys.DocumentEditorContainer_Of+" "+t.toString()},e.prototype.createSingleChangesDiv=function(e){this.revision=e,this.user=e.author,this.outerSingleDiv=sf.base.createElement("div",{className:"e-de-tc-outer"}),this.singleInnerDiv=sf.base.createElement("div",{className:"e-de-trckchanges-inner"}),this.singleInnerDiv.addEventListener("click",this.selectRevision.bind(this)),this.outerSingleDiv.appendChild(this.singleInnerDiv);var t=sf.base.createElement("div",{className:"e-de-track-usernme-div"}),i=sf.base.createElement("div",{innerHTML:e.author,className:"e-de-track-user-nme"});sf.base.isNullOrUndefined(e.author)||(t.style.display="flex",this.owner.documentHelper.getAvatar(t,i,void 0,e));var r=sf.base.createElement("div");"Insertion"===e.revisionType?(this.revisionType="Inserted",r.innerHTML=this.owner.localeKeys.DocumentEditor_Inserted.toUpperCase(),r.classList.add("e-de-track-insert")):"Deletion"===e.revisionType?(this.revisionType="Deleted",r.innerHTML=this.owner.localeKeys.DocumentEditor_Deleted.toUpperCase(),r.classList.add("e-de-track-delete")):"MoveFrom"===e.revisionType?(this.revisionType="MoveFrom",r.innerHTML=this.owner.localeKeys.DocumentEditor_MoveFrom.toUpperCase(),r.classList.add("e-de-track-delete"),r.style.whiteSpace="nowrap"):"MoveTo"===e.revisionType&&(this.revisionType="MoveTo",r.innerHTML=this.owner.localeKeys.DocumentEditor_MoveTo.toUpperCase(),r.classList.add("e-de-track-insert"),r.style.whiteSpace="nowrap"),t.appendChild(r),this.singleInnerDiv.appendChild(t);var n=sf.base.createElement("div",{className:"e-de-track-date",innerHTML:x.getModifiedDate(e.date)});this.singleInnerDiv.appendChild(n);var o=sf.base.createElement("div",{id:"textDiv",className:"e-de-track-chngs-text"});this.layoutElementText(e.range,o),this.singleInnerDiv.appendChild(o);var s=sf.base.createElement("div",{styles:"display:inline-block;width:100%"});this.singleInnerDiv.appendChild(s);var a=sf.base.createElement("div",{styles:"float:left;"});this.acceptButtonElement=sf.base.createElement("button",{className:"e-de-track-accept-button e-btn e-lib e-control e-outline e-success"}),this.acceptButtonElement.textContent=this.owner.localeKeys.DocumentEditor_Accept,this.owner.documentHelper.isTrackedOnlyMode&&this.acceptButtonElement.classList.add("e-de-overlay"),a.appendChild(this.acceptButtonElement),s.appendChild(a),this.acceptButtonElement.addEventListener("click",this.acceptButtonClick.bind(this)),a=sf.base.createElement("div",{styles:"float:left;"}),this.rejectButtonElement=sf.base.createElement("button",{className:"e-de-track-reject-button e-btn e-lib e-control e-outline e-danger"}),this.rejectButtonElement.textContent=this.owner.localeKeys.DocumentEditor_Reject,this.owner.documentHelper.isTrackedOnlyMode&&this.rejectButtonElement.classList.add("e-de-overlay"),a.appendChild(this.rejectButtonElement),s.appendChild(a),this.rejectButtonElement.addEventListener("click",this.rejectButtonClick.bind(this)),this.changesCount=sf.base.createElement("div",{className:"e-de-track-chngs-count",styles:"float:right;"});var l=this.owner.revisions.changes.indexOf(e)+1,d=this.owner.revisions.changes.length;return this.changesCount.innerHTML=this.owner.localeKeys.DocumentEditor_Changes+" "+l.toString()+" "+this.owner.localeKeys.DocumentEditorContainer_Of+" "+d.toString(),s.appendChild(this.changesCount),this.outerSingleDiv},e.prototype.appendRowToTable=function(e,t){this.tableElement.insertRow();for(var i=0;i<e.ownerBase.childWidgets.length;i++)this.tableElement.rows[t].insertCell(),this.tableElement.rows[t].cells[i].classList.add("e-de-tc-tble-cell")},e.prototype.selectRevision=function(){if(this.revision.range[0]instanceof k){var e=this.trackChangesPane.groupTableRevisions(this.owner.revisions.changes,this.owner.revisions.changes.indexOf(this.revision));this.owner.selection.selectTableRevision(e)}else this.owner.selection.selectRevision(this.revision),this.trackChangesPane.onSelection(this.revision)},e.prototype.layoutElementText=function(e,t){t.style.width="100%";for(var i="",r=!1,n=0;n<e.length;n++){var o=e[n];if(o instanceof va&&1===o.fieldType)r=!1;else if(!r)if(o instanceof va&&0===o.fieldType&&(r=!0),o instanceof Fa)i+=o.text;else if(o instanceof va&&0===o.fieldType){var s=this.owner.selection.getFieldCode(o);if(s.match("TOC ")||s.match("Toc"))return i+="<Table of Content>",void t.appendChild(this.addSpan(i));if(s.match("HYPERLINK ")||s.match("MERGEFIELD")||s.match("FORMTEXT")||s.match("PAGE "))i+=this.owner.editor.retrieveFieldResultantText(o.fieldEnd);else if(o.formFieldData){var a=this.owner.documentHelper.textHelper.repeatChar(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),5);""!==i&&(t.appendChild(this.addSpan(i)),i=""),o.formFieldData instanceof ba?t.appendChild(this.addSpan(""===o.formFieldData.defaultValue?a:o.formFieldData.defaultValue,"e-de-tc-field")):o.formFieldData instanceof Ia?t.appendChild(this.addSpan(o.formFieldData.dropdownItems.length>0?o.formFieldData.dropdownItems[0]:a,"e-de-tc-field")):t.appendChild(this.addSpan(o.formFieldData.checked?String.fromCharCode(9745):String.fromCharCode(9744),"e-de-tc-field"))}}else if(o instanceof Da){""!==i&&(t.appendChild(this.addSpan(i)),i="");var l=sf.base.createElement("img");l.setAttribute("src",o.imageString),l.classList.add("e-de-tc-shrink-img"),t.appendChild(l)}else{if(o instanceof k){this.tableElement=sf.base.createElement("table"),this.tableElement.classList.add("e-de-track-chng-table"),this.tableElement.insertRow();for(var d=0;d<o.ownerBase.childWidgets.length;d++)this.tableElement.rows[0].insertCell(),this.tableElement.rows[0].cells[d].classList.add("e-de-tc-tble-cell");return void t.appendChild(this.tableElement)}if(o instanceof T){""!==i&&(t.appendChild(this.addSpan(i)),i="");var h="¶";o.ownerBase instanceof ca&&o.ownerBase.isEndsWithPageBreak&&(h="............Page Break............"+h),t.appendChild(this.addSpan(h,"e-de-tc-pmark")),t.appendChild(sf.base.createElement("br"))}}}t.appendChild(this.addSpan(i))},e.prototype.addSpan=function(e,t){var i=sf.base.createElement("span");return i.textContent=e,t&&i.classList.add(t),i},e.prototype.acceptButtonClick=function(){return As(this,void 0,void 0,(function(){return Ms(this,(function(e){switch(e.label){case 0:return[4,this.revision.accept()];case 1:return e.sent(),this.owner.enableHeaderAndFooter&&this.owner.editor.updateHeaderFooterWidget(),[2]}}))}))},e.prototype.rejectButtonClick=function(){return As(this,void 0,void 0,(function(){return Ms(this,(function(e){switch(e.label){case 0:return[4,this.revision.reject()];case 1:return e.sent(),this.owner.enableHeaderAndFooter&&this.owner.editor.updateHeaderFooterWidget(),[2]}}))}))},e.prototype.removeFromParentCollec=function(){!sf.base.isNullOrUndefined(this.trackChangesPane.changes)&&this.trackChangesPane.changes.containsKey(this.revision)&&this.trackChangesPane.changes.remove(this.revision),-1!==this.trackChangesPane.revisions.indexOf(this.revision)&&this.trackChangesPane.revisions.splice(this.trackChangesPane.revisions.indexOf(this.revision),1),sf.base.isNullOrUndefined(this.trackChangesPane.changes)||0!==this.trackChangesPane.changes.length||(this.trackChangesPane.setNoChangesVisibility=!0),this.trackChangesPane.updateUsers()},e.prototype.clear=function(){this.removeFromParentCollec(),this.acceptButtonElement&&(this.acceptButtonElement.innerHTML="",this.acceptButtonElement.parentElement&&this.acceptButtonElement.parentElement.removeChild(this.acceptButtonElement),this.acceptButtonElement=void 0),this.rejectButtonElement&&(this.rejectButtonElement.innerHTML="",this.rejectButtonElement.parentElement&&this.rejectButtonElement.parentElement.removeChild(this.rejectButtonElement),this.rejectButtonElement=void 0),this.tableElement&&(this.tableElement.innerHTML="",this.tableElement.parentElement&&this.tableElement.parentElement.removeChild(this.tableElement),this.tableElement=void 0),this.singleInnerDiv&&(this.singleInnerDiv.innerHTML="",this.singleInnerDiv.parentElement&&this.singleInnerDiv.parentElement.removeChild(this.singleInnerDiv),this.singleInnerDiv=void 0),this.outerSingleDiv&&(this.outerSingleDiv.innerHTML="",this.outerSingleDiv.parentElement&&this.outerSingleDiv.parentElement.removeChild(this.outerSingleDiv),this.outerSingleDiv=void 0)},e}(),Vs=function(){function e(e){this.langIDInternal=0,this.enableSpellCheckInternal=!0,this.uniqueSpelledWords={},this.spellSuggestionInternal=!0,this.isChangeAll=!1,this.uniqueKey="",this.removeUnderlineInternal=!1,this.uniqueWordsCountInternal=15e3,this.performOptimizedCheck=!0,this.documentHelper=e,this.errorWordCollection=new a,this.uniqueWordsCollection=new a,this.errorSuggestions=new a,this.ignoreAllItems=[],this.uniqueSpelledWords={},this.textSearchResults=new Gl(this.documentHelper.owner),this.uniqueKey=this.documentHelper.owner.element.id+"_"+this.createGuid()}return e.prototype.getModuleName=function(){return"SpellChecker"},Object.defineProperty(e.prototype,"enableOptimizedSpellCheck",{get:function(){return this.performOptimizedCheck},set:function(e){this.performOptimizedCheck=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"uniqueWordsCount",{get:function(){return sf.base.isNullOrUndefined(this.uniqueWordsCountInternal)?0:this.uniqueWordsCountInternal},set:function(e){this.uniqueWordsCountInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"languageID",{get:function(){return sf.base.isNullOrUndefined(this.langIDInternal)?0:this.langIDInternal},set:function(e){this.langIDInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowSpellCheckAndSuggestion",{get:function(){return this.spellSuggestionInternal},set:function(e){this.spellSuggestionInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removeUnderline",{get:function(){return this.removeUnderlineInternal},set:function(e){this.removeUnderlineInternal=e,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableSpellCheck",{get:function(){return this.enableSpellCheckInternal},set:function(e){this.enableSpellCheckInternal=e,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.manageReplace=function(e,t){this.documentHelper.triggerSpellCheck=!0;if(!sf.base.isNullOrUndefined(t)&&t instanceof ka){var i=t.text;if(this.documentHelper.selection.start=t.start.clone(),this.documentHelper.selection.end=t.end.clone(),"Ignore Once"!==e)return e=this.manageSpecialCharacters(i,e),this.documentHelper.owner.editor.insertTextInternal(e,!0),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),void this.documentHelper.clearSelectionHighlight();this.currentContextInfo={text:i,element:t}}if(!sf.base.isNullOrUndefined(this.currentContextInfo)&&this.currentContextInfo.element&&"Ignore Once"!==e){var r=this.currentContextInfo.element;this.currentContextInfo.element.text,this.documentHelper.selection.start=r.start.clone(),this.documentHelper.selection.end=r.end.clone()}else this.handleReplace(e);"Ignore Once"!==e&&(this.documentHelper.owner.editor.insertTextInternal(e,!0),sf.base.isNullOrUndefined(this.currentContextInfo)||this.removeErrorsFromCollection(this.currentContextInfo),this.documentHelper.selection.start.setPositionInternal(this.documentHelper.selection.end),this.documentHelper.clearSelectionHighlight()),this.documentHelper.triggerSpellCheck=!1},e.prototype.handleReplace=function(e){var t=this.documentHelper.selection.start,i=t.offset,r=t.currentWidget.getInline(i,0,!1,!0);r.element.line.getOffset(r.element,0)+r.element.length===i&&this.retrieveExactElementInfo(r);for(var n,o=r.element.text,s=new RegExp("^[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\`\\s]+","g"),a=[];!sf.base.isNullOrUndefined(n=s.exec(o));)a.push(n);if("Ignore Once"!==e){t.offset=i-r.index,!sf.base.isNullOrUndefined(a)&&a.length>0&&(t.offset+=a[0].toString().length),t.location=this.documentHelper.owner.selection.getPhysicalPositionInternal(t.currentWidget,t.offset,!0),(t=this.documentHelper.owner.searchModule.textSearch.getTextPosition(t.currentWidget,t.offset.toString())).setPositionParagraph(t.currentWidget,t.offset);var l=t.offset+r.element.length-t.offset,d=t.currentWidget.getOffset(r.element,l),h=t.currentWidget,c=new RegExp("[#\\@\\!\\~\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"'\\,\\<\\.\\>\\/\\?\\s\\`]+$","g");for(a=[];!sf.base.isNullOrUndefined(n=c.exec(o));)a.push(n);!sf.base.isNullOrUndefined(a)&&a.length>0&&(d-=a[0].toString().length),this.documentHelper.selection.end=this.documentHelper.owner.searchModule.textSearch.getTextPosition(h,d.toString()),this.documentHelper.selection.end.location=this.documentHelper.owner.selection.getPhysicalPositionInternal(t.currentWidget,d,!0),this.documentHelper.selection.end.setPositionParagraph(h,d),this.currentContextInfo={element:r.element,text:r.element.text}}else this.handleIgnoreOnce(r)},e.prototype.retrieveExactElementInfo=function(e){var t=e.element.nextElement;!sf.base.isNullOrUndefined(t)&&t instanceof Fa&&(""!=t.text.trim()&&(e.element=t))},e.prototype.handleIgnoreOnce=function(e){var t=e.element,i="";i=!sf.base.isNullOrUndefined(this.currentContextInfo)&&this.currentContextInfo.element?this.currentContextInfo.element.text:t.text,i=this.manageSpecialCharacters(i,void 0,!0),-1===t.ignoreOnceItems.indexOf(i)&&t.ignoreOnceItems.push(i),this.documentHelper.owner.editor.reLayout(this.documentHelper.selection)},e.prototype.handleIgnoreAllItems=function(e){var t=sf.base.isNullOrUndefined(e)?this.retriveText():e,i=this.manageSpecialCharacters(t.text,void 0,!0);-1===this.ignoreAllItems.indexOf(i)&&(this.ignoreAllItems.push(i),this.removeErrorsFromCollection(t),this.documentHelper.triggerSpellCheck=!0,this.documentHelper.owner.editor.reLayout(this.documentHelper.selection),this.documentHelper.triggerSpellCheck=!1,this.documentHelper.clearSelectionHighlight())},e.prototype.handleAddToDictionary=function(e){var t=this,i=sf.base.isNullOrUndefined(e)?this.retriveText():e,r=this.manageSpecialCharacters(i.text,void 0,!0);this.callSpellChecker(this.languageID,r,!1,!1,!0).then((function(e){t.documentHelper.triggerSpellCheck=!0,t.removeErrorsFromCollection(i),t.ignoreAllItems.push(r),t.documentHelper.owner.editor.reLayout(t.documentHelper.selection,!0),t.documentHelper.triggerSpellCheck=!1}))},e.prototype.manageSpecialCharacters=function(e,t,i){if(!sf.base.isNullOrUndefined(e)){sf.base.isNullOrUndefined(t)&&(t=e);for(var r=new RegExp("^[#\\@\\!\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\”'\\,\\<\\.\\>\\/\\?\\`\\s\\’]+","g"),n=[],o=void 0;!sf.base.isNullOrUndefined(o=r.exec(e));)n.push(o);if(n.length>0)for(var s=0;s<n.length;s++){var a=n[s];t=i?t.replace(a[0],""):a[0]+t}var l=new RegExp("[#\\@\\!\\$\\%\\^\\&\\*\\(\\)\\-\\_\\+\\=\\{\\}\\[\\]\\:\\;\\\"\\”'\\,\\<\\.\\>\\/\\?\\s\\`\\’]+$","g");for(n=[];!sf.base.isNullOrUndefined(o=l.exec(t));)n.push(o);if(n.length>0)for(s=0;s<n.length;s++){a=n[s];t=i?t.slice(0,a.index):t+a[0]}}return t},e.prototype.removeErrorsFromCollection=function(e){if(!sf.base.isNullOrUndefined(e.text)&&this.errorWordCollection.containsKey(e.text)){var t=this.errorWordCollection.get(e.text);t.indexOf(e.element)>=0&&t.splice(0,1),0===t.length&&this.errorWordCollection.remove(e.text)}},e.prototype.retriveText=function(e){var t,i;if(!sf.base.isNullOrUndefined(this.currentContextInfo)&&this.currentContextInfo.element)i=this.currentContextInfo.element,t=this.currentContextInfo.element.text,e||(this.documentHelper.selection.start=i.start.clone(),this.documentHelper.selection.end=i.end.clone());else{var r=this.documentHelper.selection.start,n=r.offset,o=r.currentWidget.getInline(n,0);i=o.element,t=o.element.text}return{text:t,element:i}},e.prototype.handleSuggestions=function(e){this.spellCheckSuggestion=[],0===e.length||(e=e.length>3?this.constructInlineMenu(e):e),this.spellCheckSuggestion.push("Add to Dictionary");var t=[];if(this.spellCheckSuggestion.length>0)for(var i=0,r=this.spellCheckSuggestion;i<r.length;i++){var n=r[i];t.push({text:n,id:this.documentHelper.owner.element.id+"_contextmenu_otherSuggestions_spellcheck_"+n,iconCss:""})}return t},e.prototype.updateErrorSuggestions=function(){var e,t=this,i=this.documentHelper.owner.spellChecker.manageSpecialCharacters(this.currentContextInfo.text,void 0,!0);!sf.base.isNullOrUndefined(i)&&this.errorWordCollection.containsKey(i)&&this.enableOptimizedSpellCheck&&this.callSpellChecker(this.documentHelper.owner.spellChecker.languageID,i,!1,!0,!1,!1).then((function(r){var n=JSON.parse(r);e=n.Suggestions,sf.base.isNullOrUndefined(e)||t.errorSuggestions.add(i,e.slice())}))},e.prototype.checktextElementHasErrors=function(e,t,i){var r=!1,n=[];if(e=e.replace(/[\s]+/g,""),!sf.base.isNullOrUndefined(t.errorCollection)&&t.errorCollection.length>0){if(!this.documentHelper.isScrollHandler&&(t.ischangeDetected||t.paragraph.isChangeDetected))return this.updateStatusForGlobalErrors(t.errorCollection,t),t.errorCollection=[],t.ischangeDetected=!0,{errorFound:r,elements:n};for(var o=0;o<t.errorCollection.length;o++)this.handleErrorCollection(t.errorCollection[o])&&(r=!0,n.push(t.errorCollection[o]))}else!this.documentHelper.isScrollHandler&&t.paragraph.isChangeDetected?t.ischangeDetected=!0:!t.ischangeDetected&&this.handleErrorCollection(t)&&(r=!0,n.push(t));return{errorFound:r,elements:n}},e.prototype.updateStatusForGlobalErrors=function(e,t){if(e.length>0)for(var i=0;i<e.length;i++){var r=this.manageSpecialCharacters(e[i].text,void 0,!0);if(this.errorWordCollection.containsKey(r))for(var n=this.errorWordCollection.get(r),o=0;o<n.length;o++)if(n[o]instanceof ka&&n[o]===e[i]){n[o].ischangeDetected=!0,n[o].start.offset=t.line.getOffset(t.istextCombined?this.getCombinedElement(t):t,0),n[o].line=t.line;break}}},e.prototype.handleErrorCollection=function(e){var t=this.errorWordCollection,i=this.manageSpecialCharacters(e.text,void 0,!0);return!!(t.containsKey(i)&&e.length>1)&&(!(this.ignoreAllItems.indexOf(i)>-1)||(t.containsKey(i)&&t.remove(i),!1))},e.prototype.constructInlineMenu=function(e){for(var t=e.length-1;t>0;t--)e.length>3&&(this.spellCheckSuggestion.push(e[t]),e.pop());return e},e.prototype.findCurretText=function(){var e,t,i=this.documentHelper.selection.start,r=i.currentWidget.getInline(this.documentHelper.selection.start.offset,0);if(!sf.base.isNullOrUndefined(r.element)){if(!sf.base.isNullOrUndefined(r.element.errorCollection)&&r.element.errorCollection.length>0)for(var n=0;n<r.element.errorCollection.length;n++){var o=r.element.errorCollection[n];if(o.start.location.x<=i.location.x&&o.end.location.x>=i.location.x){t=o.text,e=o;break}}else t=r.element.text;" "===t&&(t=(r=i.currentWidget.getInline(this.documentHelper.selection.start.offset+1,0)).element.text)}return{text:t,element:e}},e.prototype.addErrorCollection=function(e,t,i){if(e=this.manageSpecialCharacters(e,void 0,!0),this.errorWordCollection.containsKey(e)){var r=this.errorWordCollection.get(e);t instanceof ka?this.compareErrorTextElement(t,r)||r.push(t):t instanceof Fa&&(this.compareTextElement(t,r)||r.push(t))}else!sf.base.isNullOrUndefined(i)&&i.length>0&&this.errorSuggestions.add(e,i),this.errorWordCollection.add(e,[t]),this.uniqueWordsCollection.containsKey(e)||this.uniqueWordsCollection.add(e,!0)},e.prototype.addCorrectWordCollection=function(e){e=this.manageSpecialCharacters(e,void 0,!0),this.uniqueWordsCollection.containsKey(e)||this.uniqueWordsCollection.add(e,!1)},e.prototype.isInUniqueWords=function(e){return e=e.replace(/[\s]+/g,""),this.uniqueWordsCollection.containsKey(e)},e.prototype.isErrorWord=function(e){return e=e.replace(/[\s]+/g,""),this.uniqueWordsCollection.get(e)},e.prototype.isCorrectWord=function(e){return e=e.replace(/[\s]+/g,""),!this.uniqueWordsCollection.get(e)},e.prototype.compareErrorTextElement=function(e,t){for(var i=[],r=!1,n=0;n<t.length;n++)i.push(t[n]);var o=t.length;for(n=0;n<o;n++)if(i[n]instanceof ka)if(i[n].ischangeDetected){var s=this.manageSpecialCharacters(i[n].text,void 0,!0);r=!0,this.removeErrorsFromCollection({element:i[n],text:s})}else{var a=i[n];if(e.start.offset===a.start.offset&&e.end.offset===a.end.offset)return!0}return r&&this.errorWordCollection.add(this.manageSpecialCharacters(e.text,void 0,!0),[e]),!1},e.prototype.compareTextElement=function(e,t){for(var i=0;i<t.length;i++){if(t[i]instanceof Fa)if(t[i]===e)return!0}return!1},e.prototype.handleWordByWordSpellCheck=function(e,t,i,r,n,o,s){if(e.HasSpellingError&&s){this.addErrorCollection(t.text,t,e.Suggestions);var a=t.line.paragraph.containerWidget instanceof ua?t.line.paragraph.containerWidget.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor;this.documentHelper.render.renderWavyLine(t,i,r,n,"#FF0000","Single",o,a),t.isSpellChecked=!0}else this.addCorrectWordCollection(t.text),t.isSpellChecked=!0},e.prototype.checkElementCanBeCombined=function(e,t,i,r,n,o,s,a){var l=sf.base.isNullOrUndefined(n)?"":n,d=!sf.base.isNullOrUndefined(a)&&a,h=!!sf.base.isNullOrUndefined(s)||s,c=!!sf.base.isNullOrUndefined(o)||o,p=[],g=this.documentHelper.selection.getLineWidget(e,0),f=g.children.indexOf(e),u=e.text;p.push(e);var m=s?0:1,y=!1,v=!1;if("\v"!==e.text){if(h){for(var w=void 0,b=f-m;b>=0;b--)if((w=g.children[b])instanceof Fa&&!v){if(0!==u.indexOf(" ")&&w.text.lastIndexOf(" ")!==w.text.length-1)y=!sf.base.isNullOrUndefined(n),l=w.text+l,u=w.text,v=!1,p.push(w),d=!0;else if(!sf.base.isNullOrUndefined(w)){w=w.nextElement;break}}else w instanceof va&&1!==w.fieldType&&(v=!0);var x=d?w:e;if(this.lookThroughPreviousLine(l,u,x,t,i))return!0}s?l=y?l:e.text+l:l+=e.text,v=!1;var I=e.text;if(c){var F=!1,C=void 0;for(b=f+1;b<g.children.length;b++)if((C=g.children[b])instanceof Fa&&!v){if(I.lastIndexOf(" ")!==I.length-1&&0!==C.text.indexOf(" "))l+=C.text,I=C.text,v=!1,p.push(C),F=!0,d=!0;else if(!sf.base.isNullOrUndefined(C)){C=C.previousElement;break}}else C instanceof va&&2!==C.fieldType&&(v=!0);if("\f"!==(x=F?C:e).text&&x.text!==String.fromCharCode(14)&&this.lookThroughNextLine(l,u,x,t,i))return!0}}return d&&r&&!this.checkCombinedElementsBeIgnored(p,l)&&this.handleCombinedElements(e,l,t,i),d},e.prototype.lookThroughPreviousLine=function(e,t,i,r,n){if(!sf.base.isNullOrUndefined(i)&&0===i.indexInOwner&&!sf.base.isNullOrUndefined(i.line.previousLine)){var o=i.line.previousLine,s=o.children.length-1;if(!sf.base.isNullOrUndefined(o.children[s])&&o.children[s]instanceof Fa){var a=o.children[s];if(!sf.base.isNullOrUndefined(i.text)&&0!==i.text.indexOf(" ")&&a.text.lastIndexOf(" ")!==a.text.length-1)return e=e.length>0?e:t,this.checkElementCanBeCombined(a,r,n,!0,e,!1,!0,!0),!0}}return!1},e.prototype.lookThroughNextLine=function(e,t,i,r,n){if(i instanceof Fa&&!sf.base.isNullOrUndefined(i)&&i.indexInOwner===i.line.children.length-1&&!sf.base.isNullOrUndefined(i.line.nextLine)){var o=i.line.nextLine;if(!sf.base.isNullOrUndefined(o.children[0])&&o.children[0]instanceof Fa){var s=o.children[0];if(i.text.lastIndexOf(" ")!==i.text.length-1&&0!==s.text.indexOf(" "))return e=e.length>0?e:t,this.checkElementCanBeCombined(s,r,n,!0,e,!0,!1,!0),!0}}return!1},e.prototype.handleCombinedElements=function(e,t,i,r){e.istextCombined=!0;var n=t.split(/[\s]+/);if(-1===this.ignoreAllItems.indexOf(t)&&e instanceof Fa&&-1===e.ignoreOnceItems.indexOf(t))if(n.length>1)for(var o=0;o<n.length;o++){var s=n[o];s=this.manageSpecialCharacters(s,void 0,!0),this.documentHelper.render.handleUnorderedElements(s,e,i,o,0,o===n.length-1,r)}else t=this.manageSpecialCharacters(t,void 0,!0),this.documentHelper.render.handleUnorderedElements(t,e,i,0,0,!0,r)},e.prototype.checkArrayHasSameElement=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r.start.location.x===t.start.location.x&&r.start.location.y===t.start.location.y)return!0}return!1},e.prototype.handleSplitWordSpellCheck=function(e,t,i,r,n,o,s,a){if(e.HasSpellingError&&" "!==i.text&&r){var l=this.getMatchedResultsFromElement(i,t);s=i.istextCombined?i.line.getOffset(this.getCombinedElement(i),0):s,this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(l.matches,l.textResults,l.elementInfo,0,i,!1,null,s),this.handleMatchedResults(l.textResults,i,n,o,e.Suggestions,a)}else this.addCorrectWordCollection(t),a&&(i.isSpellChecked=!0);this.updateUniqueWords([{Text:t,HasSpellError:e.HasSpellingError}])},e.prototype.handleMatchedResults=function(e,t,i,r,n,o){if(0===e.length&&o)t.isSpellChecked=!0;else for(var s=0;s<e.length;s++){var a=this.createErrorElementWithInfo(e.innerList[s],t);sf.base.isNullOrUndefined(t.errorCollection)||this.checkArrayHasSameElement(t.errorCollection,a)||t.errorCollection.splice(r,0,a),this.addErrorCollection(a.text,a,n);for(var l=t.line.paragraph.containerWidget instanceof ua?t.paragraph.containerWidget.cellFormat.shading.backgroundColor:this.documentHelper.backgroundColor,d=t.line.paragraph,h=d.y,c=0;c<d.childWidgets.length&&d.childWidgets[c]!=t.line;c++)h+=d.childWidgets[c].height;t.isRightToLeft?this.documentHelper.render.renderWavyLine(a,a.end.location.x,h,i,"#FF0000","Single",t.characterFormat.baselineAlignment,l):this.documentHelper.render.renderWavyLine(a,a.start.location.x,h,i,"#FF0000","Single",t.characterFormat.baselineAlignment,l),o&&(t.isSpellChecked=!0)}},e.prototype.callSpellChecker=function(e,t,i,r,n,o){var s=this,a=this;return new Promise((function(l,d){if(!sf.base.isNullOrUndefined(s)){var h=new XMLHttpRequest,c=s.documentHelper.owner.serviceUrl;c=o?c+s.documentHelper.owner.serverActionSettings.spellCheckByPage:c+s.documentHelper.owner.serverActionSettings.spellCheck,h.open("POST",c,!0),h.setRequestHeader("Content-Type","application/json"),s.setCustomHeaders(h);var p={LanguageID:e,TexttoCheck:t,CheckSpelling:i,CheckSuggestion:r,AddWord:n};h.send(JSON.stringify(p)),h.onreadystatechange=function(){if(4===h.readyState)if(200===h.status||304===h.status)l(h.response);else{var e={status:h.status.toString(),statusText:h.responseText,url:c,name:"onFailure"};sf.base.isNullOrUndefined(a.documentHelper)||a.documentHelper.owner.fireServiceFailure(e),d(h.response)}}}}))},e.prototype.setCustomHeaders=function(e){for(var t=0;t<this.documentHelper.owner.headers.length;t++)for(var i=this.documentHelper.owner.headers[t],r=0,n=Object.keys(i);r<n.length;r++){var o=n[r];e.setRequestHeader(o,i[o])}},e.prototype.checkForNextError=function(){if(!sf.base.isNullOrUndefined(this.viewer)){var e=this.errorWordCollection;if(e.length>0)for(var t=0;t<e.length;t++){for(var i=e.get(e.keys[t]),r=0;r<i.length;r++){if(i[r]instanceof ka&&!i[r].ischangeDetected)this.updateErrorElementTextBox(e.keys[t],i[r]);else if(i[r]instanceof Fa){var n=this.getMatchedResultsFromElement(i[r]),o=n.textResults,s=i[r].ischangeDetected?i[r].start.offset:i[r].line.getOffset(i[r],0);this.documentHelper.owner.searchModule.textSearch.updateMatchedTextLocation(n.matches,o,n.elementInfo,0,i[r],!1,null,s);for(var a=0;a<o.length;a++){var l=this.createErrorElementWithInfo(o.innerList[a],i[r]);this.updateErrorElementTextBox(l.text,l);break}}break}break}else this.documentHelper.clearSelectionHighlight()}},e.prototype.createErrorElementWithInfo=function(e,t){var i=new ka;return i.text=e.text,i.start=e.start,i.end=e.end,i.height=t.height,i.canTrigger=t.canTrigger,i.characterFormat.copyFormat(t.characterFormat),i.width=Math.abs(i.start.location.x-i.end.location.x),i},e.prototype.getMatchedResultsFromElement=function(e,t){var i=e.line,r=this.documentHelper.owner.searchModule.textSearch.stringToRegex(sf.base.isNullOrUndefined(t)?e.text:t,"CaseSensitive");this.textSearchResults.clearResults();for(var n,o=this.textSearchResults,s=this.documentHelper.owner.searchModule.textSearch.getElementInfo(i.children[0],0,!1,r,void 0,void 0,void 0,void 0,!0),a=s.fullText,l=[],d=s.elementsWithOffset;!sf.base.isNullOrUndefined(n=r.exec(a));)this.isChangeAll&&(n.index=d.get(e)),l.push(n);return{matches:l,elementInfo:d,textResults:o}},e.prototype.updateErrorElementTextBox=function(e,t){var i=t;this.documentHelper.clearSelectionHighlight(),this.documentHelper.selection.start=i.start.clone(),this.documentHelper.selection.end=i.end.clone(),this.documentHelper.selection.highlight(t.start.paragraph,t.start,t.end)},e.prototype.getWhiteSpaceCharacterInfo=function(e){var t,i=e.text,r=e.characterFormat,n=0,o=0;if(t=i.match(/[\s]+/),!sf.base.isNullOrUndefined(t)&&t.length>0)for(var s=0;s<t.length;s++)n+=this.documentHelper.textHelper.getWidth(t[s],r,e.scriptType),o+=t[s].length;return{width:n,wordLength:o,isBeginning:!sf.base.isNullOrUndefined(t)&&0===t.index}},e.prototype.getSpecialCharactersInfo=function(e){var t=e.text,i=e.characterFormat,r=[],n=0,o=0,s=0;r=t.match(/^[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*/);for(var a=0;a<r.length;a++)!sf.base.isNullOrUndefined(r[a])&&r[a].length>0&&(n=this.documentHelper.textHelper.getWidth(r[a],i,e.scriptType)),s=r.length;r=t.match(/[\#\@\!\~\$\%\^\&\*\(\)\-\_\+\=\{\}\[\]\:\;\"\'\,\<\.\>\/\?\`]*$/);for(a=0;a<r.length;a++)!sf.base.isNullOrUndefined(r[a])&&r[a].length>0&&(o=this.documentHelper.textHelper.getWidth(r[a],i,e.scriptType)),s=r.length;return{beginningWidth:n,endWidth:o,wordLength:s}},e.prototype.getCombinedElement=function(e){for(var t=e;!sf.base.isNullOrUndefined(e)&&e instanceof Fa&&e.istextCombined;)t=e,e=e.previousElement;return t},e.prototype.checkCombinedElementsBeIgnored=function(e,t){t=this.manageSpecialCharacters(t,void 0,!0);for(var i=0;i<e.length;i++)if(-1!==e[i].ignoreOnceItems.indexOf(t))return!0;return!1},e.prototype.updateSplittedElementError=function(e,t){var i=e.errorCollection.length;if(i>0){for(var r=[],n=0;n<i;n++)r.push(e.errorCollection[n]);for(n=0;n<i;n++)-1===e.text.indexOf(r[n].text)&&(t.ischangeDetected=!0,e.errorCollection.splice(0,1))}},e.prototype.getPageContent=function(e){var t="";if(this.documentHelper.owner.sfdtExportModule){var i=this.documentHelper.owner.sfdtExportModule,r=i.keywordIndex;i.keywordIndex=0,i.Initialize();var n=i.writePage(e);if(i.keywordIndex=r,this.documentHelper.owner.textExportModule){var o=this.documentHelper.owner.textExportModule;o.pageContent="",o.setDocument(n),o.writeInternal(),t=o.pageContent}}return t},e.prototype.updateUniqueWords=function(e){if(sf.base.isNullOrUndefined(localStorage.getItem(this.uniqueKey))||(this.uniqueSpelledWords=JSON.parse(localStorage.getItem(this.uniqueKey))),this.uniqueSpelledWords=this.uniqueSpelledWords||{},e.length+Object.keys(this.uniqueSpelledWords).length<=this.uniqueWordsCount)for(var t=0;t<e.length;t++)this.checkForUniqueWords(e[t]);localStorage.setItem(this.uniqueKey,JSON.stringify(this.uniqueSpelledWords)),this.uniqueSpelledWords={}},e.prototype.checkForUniqueWords=function(e){this.uniqueSpelledWords[e.Text]||(this.uniqueSpelledWords[e.Text]=e.HasSpellError)},e.prototype.clearCache=function(){sf.base.isNullOrUndefined(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey)},e.prototype.createGuid=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?i:3&i|8).toString(16)}))},e.prototype.checkSpellingInPageInfo=function(e){var t=JSON.parse(localStorage.getItem(this.uniqueKey));return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t[e])?{hasSpellError:!1,isElementPresent:!1}:{hasSpellError:t[e],isElementPresent:!0}},e.prototype.destroy=function(){this.errorWordCollection=void 0,this.ignoreAllItems=void 0,this.errorSuggestions=void 0,this.uniqueWordsCollection=void 0,this.uniqueSpelledWords={},this.textSearchResults=void 0,sf.base.isNullOrUndefined(localStorage.getItem(this.uniqueKey))||localStorage.removeItem(this.uniqueKey)},e}(),qs=function(){function e(){this.fntTypeface=new a,this.fntSchemeList=[],this.fntTypeface=new a,this.fntSchemeList=[]}return Object.defineProperty(e.prototype,"fontTypeface",{get:function(){return this.fntTypeface},set:function(e){this.fntTypeface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSchemeList",{get:function(){return this.fntSchemeList},set:function(e){this.fntSchemeList=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(this.fntTypeface=e.fntTypeface,this.fntSchemeList=e.fntSchemeList)},e.prototype.destroy=function(){this.fntTypeface=void 0,this.fntSchemeList=void 0},e}(),_s=function(){function e(){this.majFontScheme=new qs,this.minFontScheme=new qs}return Object.defineProperty(e.prototype,"fontSchemeName",{get:function(){return this.schemeName},set:function(e){this.schemeName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorFontScheme",{get:function(){return this.majFontScheme},set:function(e){this.majFontScheme=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorFontScheme",{get:function(){return this.minFontScheme},set:function(e){this.minFontScheme=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(this.schemeName=e.schemeName,this.majFontScheme.copyFormat(e.majFontScheme),this.minFontScheme.copyFormat(e.minFontScheme))},e.prototype.destroy=function(){this.schemeName=void 0,this.majFontScheme=void 0,this.minFontScheme=void 0},e}(),js=function(){function e(){}return Object.defineProperty(e.prototype,"name",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"typeface",{get:function(){return this.fontTypeface},set:function(e){this.fontTypeface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"panose",{get:function(){return this.pnose},set:function(e){this.pnose=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(this.fontName=e.fontName,this.fontTypeface=e.fontTypeface,this.pnose=e.panose)},e.prototype.destroy=function(){this.fontName=void 0,this.fontTypeface=void 0,this.pnose=void 0},e}(),Gs=function(){function e(){this.fntScheme=new _s}return Object.defineProperty(e.prototype,"fontScheme",{get:function(){return this.fntScheme},set:function(e){this.fntScheme=e},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||this.fntScheme.copyFormat(e.fntScheme)},e.prototype.destroy=function(){this.fntScheme=void 0},e}(),Ks=(y=function(e,t){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}y(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Xs=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new i((function(t){t(e.value)})).then(s,a)}l((r=r.apply(e,t||[])).next())}))},Js=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Ys=function(){function e(e){var t=this;this.isCompleted=!0,this.scrollbarWidth=0,this.isWebPrinting=!1,this.isDragging=!1,this.isHeaderFooter=!1,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.fieldStacks=[],this.showRevision=!1,this.splittedCellWidgets=[],this.tableLefts=[],this.tapCount=0,this.timer=-1,this.isTimerStarted=!1,this.isFirstLineFitInShiftWidgets=!1,this.preZoomFactor=0,this.preDifference=-1,this.fieldEndParagraph=void 0,this.fieldToLayout=void 0,this.backgroundColor="#FFFFFF",this.isMouseDown=!1,this.isMouseEntered=!1,this.scrollMoveTimer=0,this.isSelectionChangedOnMouseMoved=!1,this.isControlPressed=!1,this.isTouchInput=!1,this.isTouchMoved=!1,this.useTouchSelectionMark=!1,this.touchDownOnSelectionMark=0,this.isComposingIME=!1,this.lastComposedText="",this.isCompositionStart=!1,this.isCompositionUpdated=!1,this.isCompositionCanceled=!1,this.isCompositionEnd=!1,this.prefix="",this.suffix="",this.fields=[],this.heightInfoCollection={},this.isRestartNumbering=!1,this.defaultTabWidth=36,this.dontUseHtmlParagraphAutoSpacing=!1,this.allowSpaceOfSameStyleInTable=!1,this.alignTablesRowByRow=!1,this.compatibilityMode="Word2013",this.lists=[],this.comments=[],this.authors=new a,this.revisionsInternal=new a,this.commentUserOptionId=1,this.abstractLists=[],this.styles=new xl,this.preDefinedStyles=void 0,this.isRowOrCellResizing=!1,this.endBookmarksUpdated=[],this.formFields=[],this.isMouseDownInFooterRegion=!1,this.pageFitTypeIn="None",this.fieldCollection=[],this.isPageField=!1,this.mouseDownOffset=new I(0,0),this.zoomFactorInternal=1,this.moveCaretPosition=0,this.isTextInput=!1,this.isTextFormEmpty=!1,this.isScrollHandler=!1,this.triggerElementsOnLoading=!1,this.triggerSpellCheck=!1,this.restrictFormatting=!1,this.protectionType="NoProtection",this.isDocumentProtected=!1,this.hashValue="",this.saltValue="",this.userCollection=[],this.cachedPages=[],this.skipScrollToPosition=!1,this.isIosDevice=!1,this.isMobileDevice=!1,this.isFormFilling=!1,this.fontSubstitutionTable=void 0,this.themes=new Gs,this.hasThemes=!1,this.footnotes=new Ca,this.endnotes=new Ca,this.isFootnoteWidget=!1,this.isDragStarted=!1,this.isMouseDownInSelection=!1,this.onTextInput=function(e){if(!t.isComposingIME){e.preventDefault();var i=e.data;t.owner.editor.handleTextInput(i)}},this.compositionStart=function(){sf.base.Browser.isDevice||t.owner.isReadOnlyMode||(t.isComposingIME=!0,t.positionEditableTarget(),t.owner.editorHistory&&t.owner.editor.initComplexHistory("IMEInput")),t.isCompositionStart=!0},this.compositionUpdated=function(){t.isComposingIME&&!t.owner.isReadOnlyMode&&setTimeout((function(){t.owner.editor.insertIMEText(t.getEditableDivTextContent(),!0)}),0),t.isCompositionUpdated=!0},this.compositionEnd=function(e){if(t.isComposingIME&&!t.owner.isReadOnlyMode){var i=t.getEditableDivTextContent();""!==i&&t.owner.editor.insertIMEText(i,!1),t.isComposingIME=!1,t.lastComposedText="",t.iframe.setAttribute("style","pointer-events:none;position:absolute;left:"+t.owner.viewer.containerLeft+"px;top:"+t.owner.viewer.containerTop+"px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden"),t.editableDiv.innerHTML="",t.owner.editorHistory&&(t.owner.editorHistory.updateComplexHistory(),""===i&&(t.owner.editorHistory.undo(),t.owner.editorHistory.redoStack.pop()))}e.preventDefault(),t.isCompositionUpdated=!1,t.isCompositionEnd=!0},this.onKeyPressInternal=function(e){var i=e.which||e.keyCode;t.triggerElementsOnLoading=!1;var r=!(!e.ctrlKey&&!e.metaKey)||17===i,n=e.altKey?e.altKey:18===i;if(sf.base.Browser.isIE&&n&&r&&(r=!1),r&&"v"===e.key||r&&"a"===e.key||(r||t.isControlPressed&&sf.base.Browser.isIE)&&"p"===e.key)sf.base.Browser.isIE&&(t.isControlPressed=!1);else{if(!t.owner.isReadOnlyMode||t.selection&&t.selection.isInlineFormFillMode()){var o=e.keyCode||e.charCode,s="";o?s=String.fromCharCode(o):e.key&&(s=e.key)," "===s||"\r"===s||"\b"===s||s===String.fromCharCode(27)||r?" "===s&&(t.triggerSpellCheck=!0,t.owner.editorModule.handleTextInput(" "),t.triggerSpellCheck=!1):t.owner.editorModule.handleTextInput(s),e.preventDefault()}t.owner.focusIn()}},this.onTextInputInternal=function(e){t.owner.isReadOnlyMode?t.editableDiv.innerText="":t.owner.editorModule.onTextInputInternal()},this.onPaste=function(e){(!t.owner.isReadOnlyMode&&t.owner.editor.canEditContentControl||t.selection.isInlineFormFillMode())&&t.owner.editorModule.pasteInternal(e),t.editableDiv.innerText="",e.preventDefault()},this.onFocusOut=function(){sf.base.isNullOrUndefined(t.selection)||t.selection.hideCaret()},this.updateFocus=function(){!t.selection||t.isMobileDevice&&t.owner.isReadOnly||(void 0===navigator||sf.base.Browser.isDevice||sf.base.Browser.isIE||navigator.userAgent.match("Edge")||t.iframe.focus(),t.editableDiv.focus(),t.selection.showCaret())},this.scrollHandler=function(){var e;(t.scrollTimer&&clearTimeout(t.scrollTimer),t.clearContent(),t.isScrollHandler=!0,sf.base.Browser.isDevice||t.isComposingIME||(t.iframe.style.top=t.owner.viewer.containerTop+"px",t.iframe.style.left=t.owner.viewer.containerLeft+"px"),t.owner.hRuler)&&(document.getElementById(t.owner.element.id+"_hRulerBottom").style.top=t.viewerContainer.scrollTop+"px",(e=document.getElementById(t.owner.element.id+"_markIndicator"))&&(e.style.top=t.viewerContainer.scrollTop+"px"));t.owner.vRuler&&(document.getElementById(t.owner.element.id+"_vRulerBottom").style.left=t.viewerContainer.scrollLeft+"px",(e=document.getElementById(t.owner.element.id+"_markIndicator"))&&(e.style.left=t.viewerContainer.scrollLeft+"px"));t.owner.rulerHelper&&!sf.base.isNullOrUndefined(t.owner.rulerHelper.vRulerBottom)&&(t.owner.rulerHelper.vRulerBottom.style.height=t.pageContainer.offsetHeight+"px"),t.owner.viewer.updateScrollBars();var i=t.owner.viewer.containerTop+t.visibleBounds.height-(t.owner.viewer.padding.top+t.owner.viewer.padding.bottom);i>t.pageContainer.offsetHeight&&(t.viewerContainer.scrollTop=t.owner.viewer.containerTop-(i-t.pageContainer.offsetHeight)),t.owner.viewer instanceof Qs&&!sf.base.isNullOrUndefined(t.owner)&&t.owner.fireViewChange(),t.isScrollHandler=!1,t.scrollTimer=setTimeout((function(){t.isScrollHandler||sf.base.isNullOrUndefined(t.owner)||!t.owner.isSpellCheck||(t.isScrollToSpellCheck=!0,t.owner.viewer.updateScrollBars())}),200)},this.onWindowResize=function(){t.resizeTimer&&clearTimeout(t.resizeTimer),t.resizeTimer=setTimeout((function(){sf.base.isNullOrUndefined(t.owner)||sf.base.isNullOrUndefined(t.owner.element)||(t.updateViewerSize(),t.owner.rulerHelper&&t.owner.documentEditorSettings&&t.owner.documentEditorSettings.showRuler&&t.owner.rulerHelper.updateRuler(t.owner,!0),t.clearContent(),t.owner.viewer.updateScrollBars(),sf.base.isNullOrUndefined(t.selection)||t.selection.updateCaretPosition(),t.updateTouchMarkPosition(),t.resizeTimer&&clearTimeout(t.resizeTimer))}),200)},this.onContextMenu=function(e){},this.onMouseDownInternal=function(e){var i=e.target;if(!(!sf.base.isNullOrUndefined(i)&&i!==t.viewerContainer||t.owner.isTableMarkerDragging||t.isTouchInput||e.offsetX>t.visibleBounds.width-(t.visibleBounds.width-t.viewerContainer.clientWidth)||e.offsetY>t.visibleBounds.height-(t.visibleBounds.height-t.viewerContainer.clientHeight))){if(t.isFootnoteWidget=!1,!sf.base.isNullOrUndefined(t.selection)){if(t.updateCursor(e),t.owner.hideFormFieldPopup(),t.isLeftButtonPressed(e)&&!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&!sf.base.isNullOrUndefined(t.owner.imageResizerModule.selectedResizeElement)){if(t.selection.isInShape){var r=t.owner.selection.getCurrentTextFrame().containerShape;t.selection.selectShape(r)}t.owner.imageResizerModule.isImageResizing=!0}e.preventDefault(),t.isTouchInput||t.selection.hideCaret();var n=new I(e.offsetX,e.offsetY),o=t.owner.viewer.findFocusedPage(n,!0,!0);if(t.mouseDownOffset.x=o.x,t.mouseDownOffset.y=o.y,t.isMouseDownInFooterRegion=t.selection.isCursorInsidePageRect(n,t.currentPage)&&t.selection.isCursorInFooterRegion(n,t.currentPage),t.isSelectionChangedOnMouseMoved=!1,!t.owner.isReadOnlyMode&&(t.owner.editorModule.tableResize.isInCellResizerArea(o)||t.owner.editorModule.tableResize.isInRowResizerArea(o)))return t.selection.hideCaret(),t.isMouseDown=!0,t.isSelectionChangedOnMouseMoved=!1,void(t.isLeftButtonPressed(e)&&(t.owner.editorModule.tableResize.startingPoint.x=o.x,t.owner.editorModule.tableResize.startingPoint.y=o.y,t.owner.editorModule.tableResize.handleResize(o)));e.ctrlKey&&(t.isControlPressed=!0),t.owner.selection.isEmpty&&(t.useTouchSelectionMark=!1);var s=t.getLineWidget(o);if(3===e.which&&!t.owner.selection.isEmpty&&t.selection.checkCursorIsInSelection(s,o))return void e.preventDefault();t.owner&&t.owner.documentEditorSettings&&t.owner.documentEditorSettings.allowDragAndDrop&&!t.owner.selection.isEmpty&&t.selection.checkCursorIsInSelection(s,o)&&(t.isMouseDownInSelection=!0),t.isTouchInput=!1,t.isMouseDown=!0,t.updateFocus(),t.timer=setTimeout((function(){t.tapCount++,t.tapCount>1&&(t.tapCount=1),t.isScrollHandler||sf.base.isNullOrUndefined(t.owner)||!t.owner.isSpellCheck||(t.isScrollToSpellCheck=!0,t.owner.viewer.updateScrollBars())}),100)}t.owner.focusIn()}},this.onMouseMoveInternal=function(e){if((sf.base.isNullOrUndefined(e.target)||e.target===t.viewerContainer)&&!t.owner.isTableMarkerDragging&&(e.preventDefault(),!sf.base.isNullOrUndefined(t.selection))){if(!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)return void(t.owner.imageResizerModule.isImageMoveToNextPage||t.owner.imageResizerModule.handleImageResizingOnMouse(e));var i=new I(e.offsetX,e.offsetY),r=t.owner.viewer.findFocusedPage(i,!t.owner.enableHeaderAndFooter),n=t.getLineWidget(r);if(t.isMouseDown){if(!sf.base.isNullOrUndefined(t.currentPage)){var o=r.x,s=r.y;if(!t.owner.isReadOnlyMode&&t.isRowOrCellResizing){var a=t.owner.editorModule.tableResize.currentResizingTable,l=t.selection.setPositionForBlock(a,!0),d=t.selection.setPositionForBlock(a,!1);t.owner.documentHelper.isDocumentProtected&&!t.selection.checkSelectionIsAtEditRegion(l,d)||t.owner.editorModule.tableResize.handleResizing(r)}else{if((!t.isDragStarted&&t.isMouseDownInSelection&&t.isLeftButtonPressed(e)&&!t.owner.selection.isEmpty&&t.selection.checkCursorIsInSelection(n,r)||!t.owner.isReadOnlyMode&&t.owner.enableImageResizerMode&&!t.isDragStarted&&t.isLeftButtonPressed(e)&&!t.owner.selection.isEmpty&&!sf.base.isNullOrUndefined(n)&&t.owner.imageResizerModule.selectedImageWidget.containsKey(n)&&!t.owner.imageResizerModule.isImageResizing)&&(t.isDragStarted=!0,t.isMouseDownInSelection=!1,t.selection.isForward?(t.dragStartParaInfo=t.selection.getParagraphInfo(t.selection.start),t.dragEndParaInfo=t.selection.getParagraphInfo(t.selection.end)):(t.dragStartParaInfo=t.selection.getParagraphInfo(t.selection.end),t.dragEndParaInfo=t.selection.getParagraphInfo(t.selection.start)),t.selection.caret.classList.remove("e-de-cursor-animation")),(t.isTouchInput||t.isSelectionChangedOnMouseMoved||t.touchDownOnSelectionMark>0)&&!t.isDragStarted||t.updateTextPositionForSelection(r,1),t.isLeftButtonPressed(e)&&!t.isDragStarted){e.preventDefault();var h=s,c=t.owner.selection.end,p=new I(o,h);t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&!t.owner.imageResizerModule.isShapeResize||(t.isCompleted=!1,t.owner.selection.moveTextPosition(p,c)),t.isSelectionChangedOnMouseMoved=!0}t.isDragStarted&&t.isLeftButtonPressed(e)&&(t.autoScrollOnSelection(i),t.selection.updateTextPosition(n,r))}}t.selection.checkForCursorVisibility()}t.isRowOrCellResizing||t.isSelectionChangedOnMouseMoved||t.updateCursor(e),t.isRowOrCellResizing&&t.selection.hideCaret()}},this.onMouseLeaveInternal=function(e){e.preventDefault();var i=new I(e.offsetX,e.offsetY);if(t.isMouseDown){var r=t.viewerContainer.scrollTop;clearInterval(t.scrollMoveTimer),e.offsetY+r>r?t.scrollMoveTimer=setInterval((function(){t.scrollForwardOnSelection(i)}),100):t.scrollMoveTimer=setInterval((function(){t.scrollBackwardOnSelection(i)}),100),t.isMouseEntered&&(t.isMouseEntered=!1)}t.isDragStarted&&(t.selection.hideCaret(),t.scrollMoveTimer&&(clearInterval(t.scrollMoveTimer),t.scrollMoveTimer=0))},this.onMouseEnterInternal=function(e){t.isMouseEntered||t.owner.viewer.updateScrollBars(),t.isMouseEntered=!0,t.scrollMoveTimer&&clearInterval(t.scrollMoveTimer),!t.isLeftButtonPressed(e)&&t.isDragStarted&&(t.selection.caret.classList.contains("e-de-cursor-animation")||t.selection.caret.classList.add("e-de-cursor-animation"),t.isDragStarted=!1),!t.isLeftButtonPressed(e)&&t.isMouseDown&&t.onMouseUpInternal(e)},this.onDoubleTap=function(e){if((sf.base.isNullOrUndefined(e.target)||e.target===t.viewerContainer)&&(t.updateFocus(),!sf.base.isNullOrUndefined(t.selection))){t.isTouchInput=!1;var i=new I(e.offsetX,e.offsetY),r=t.owner.viewer.findFocusedPage(i,!0);if(t.selection.checkAndEnableHeaderFooter(i,t.owner.viewer.findFocusedPage(i,!0)))return;var n=t.getLineWidget(r),o=t.selection.getHyperLinkFieldInCurrentSelection(n,r,!0);if(sf.base.isNullOrUndefined(o)&&(o=t.selection.getCurrentFormField()),t.isDocumentProtected||!t.owner.enableFormField||t.owner.isReadOnlyMode)t.isDocumentProtected&&o&&o.formFieldData instanceof ba&&"Text"===o.formFieldData.type&&t.selection.selectField();else{var s=t.selection.getFormFieldType(o);s&&(""!==s.toString()&&t.selection.selectField(o),t.owner.showDialog(s))}var a=t.selection.start.clone(),l=t.selection.end.clone(),d=a.currentWidget.getInline(a.offset,0).element;if("Pages"===t.owner.layoutType)if(d instanceof Wa)if("Footnote"===d.footnoteType){var h=t.currentPage.footnoteWidget,c=void 0;for(c=0;c<=h.bodyWidgets.length;c++){var p=h.bodyWidgets[c].footNoteReference;if(d.text===p.text)break}a.setPositionParagraph(h.bodyWidgets[c].childWidgets[0].childWidgets[0],0),l.setPositionParagraph(h.bodyWidgets[c].childWidgets[0].childWidgets[0],0),t.selection.selectRange(a,l)}else{var g=t.pages[t.pages.length-1].endnoteWidget;c=void 0;if(!sf.base.isNullOrUndefined(g))for(c=0;c<=g.childWidgets.length;c++){var f=g.bodyWidgets[c].footNoteReference;if(d.text===f.text)break}a.setPositionParagraph(g.bodyWidgets[c].childWidgets[0].childWidgets[0],0),l.setPositionParagraph(g.bodyWidgets[c].childWidgets[0].childWidgets[0],0),t.selection.selectRange(a,l)}else d instanceof Fa&&(t.selection.isinEndnote||t.selection.isinFootnote)&&t.selection.footnoteReferenceElement(a,l,d);!t.selection.isEmpty||sf.base.isNullOrUndefined(t.currentPage)||sf.base.isNullOrUndefined(t.owner.selection.start)||(t.owner.selection.selectCurrentWord(),t.selection.checkForCursorVisibility(),t.tapCount=2)}},this.onMouseUpInternal=function(e){return Xs(t,void 0,void 0,(function(){var t,i,r,n,o,s,a,l,d,h,c,p,g,f,u,m,y,v,w;return Js(this,(function(b){switch(b.label){case 0:return!sf.base.isNullOrUndefined(e.target)&&e.target!==this.viewerContainer||this.owner.isTableMarkerDragging?[2]:(e.preventDefault(),this.isListTextSelected=!1,t=new I(e.offsetX,e.offsetY),i=this.owner.viewer.findFocusedPage(t,!0),sf.base.isNullOrUndefined(this.selection)?[3,5]:(r=1,sf.base.Browser.isIE?r=this.tapCount:e.detail>2&&(r=e.detail),this.isRowOrCellResizing&&this.owner.editorModule.tableResize.updateResizingHistory(i),!this.isMouseDown||this.isSelectionChangedOnMouseMoved||sf.base.isNullOrUndefined(this.currentPage)||sf.base.isNullOrUndefined(this.owner.selection.start)||this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizing||(0!==this.touchDownOnSelectionMark||this.isRowOrCellResizing||(e.shiftKey?(n=this.owner.selection.end,this.owner.selection.moveTextPosition(i,n)):this.updateTextPositionForSelection(i,r),this.isLeftButtonPressed(e)||this.owner.fireSelectionChangeInternal(),sf.base.Browser.isIE&&2===r&&this.selection.checkAndEnableHeaderFooter(t,i)),this.selection.checkForCursorVisibility(),sf.base.isNullOrUndefined(this.currentSelectedComment)||(this.currentSelectedComment=void 0,this.owner.dotNetRef.invokeMethodAsync("SetSelectedComment",""))),o=this.isIosDevice?e.metaKey:e.ctrlKey,sf.base.isNullOrUndefined(this.currentPage)||sf.base.isNullOrUndefined(this.owner.selection.start)||!this.owner.selection.isEmpty&&!this.owner.selection.isImageSelected||!(o&&this.owner.useCtrlClickToFollowHyperlink||!this.owner.useCtrlClickToFollowHyperlink)||!0!==this.isLeftButtonPressed(e)||this.selection.navigateHyperLinkOnEvent(i,!1),this.isMouseDown&&this.isLeftButtonPressed(e)&&this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType&&this.selection?(s=this.getLineWidget(i),m=this.selection.getHyperLinkFieldInCurrentSelection(s,i,!0),sf.base.isNullOrUndefined(m)&&(m=this.selection.getCurrentFormField(!0)),m&&m.formFieldData&&m.formFieldData.enabled&&!this.selection.isInlineFormFillMode(m)?(a={fieldName:m.formFieldData.name},m.formFieldData instanceof ba?a.value=m.resultText:m.formFieldData instanceof xa?a.value=m.formFieldData.checked:a.value=m.formFieldData.selectedIndex,[4,this.owner.fireBeforeFormFieldFill(a)]):[3,2]):[3,3]));case 1:b.sent().isCanceled||(m.formFieldData instanceof xa?this.owner.editor.toggleCheckBoxFormField(m):(l={},m.formFieldData instanceof Ia?(l.type="DropDown",l.defaultValue=m.formFieldData.dropdownItems,l.value=m.formFieldData.selectedIndex):(d=m.formFieldData)instanceof ba&&(l.type="Text",h=m.resultText,c=new RegExp(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi"),""===h.replace(c,"")&&(h=""),l.maxLength=m.formFieldData.maxLength,l.textFormType=m.formFieldData.type,l.defaultValue=m.formFieldData.defaultValue,l.value=h||"",l.textFormType="Text","Number"==d.type?(l.textFormType="Number",l.format=d.format,l.value=parseFloat(h.replace(/,/gi,""))):"Date"==d.type&&(l.textFormType="Date",-1!==(p=d.format).indexOf("am/pm")&&(p=p.replace(/am\/pm/gi,"a")),l.format=p,l.value=h)),g=this.owner.selection.getLeftInternal(m.line,m,0),f=m.line.height*this.owner.documentHelper.zoomFactor,(u=this.owner.selection.getTooltipPosition(m.line,g,370,100,!0)).y=u.y+f,l.position=u,this.owner.showFormFieldPopup(l))),b.label=2;case 2:return!m&&this.isFormFillProtectedMode&&this.selection.navigateToNextFormField(),[3,4];case 3:this.isMouseDown&&(this.formFields.length>0&&((m=this.selection.getCurrentFormField(!0))&&m.formFieldData instanceof ba?this.selection.selectField():this.isLeftButtonPressed(e)&&m&&m.formFieldData instanceof Ia&&(y=m.line.getOffset(m,0),v=this.selection.getPhysicalPositionInternal(m.line,y,!1),this.selection.selectInternal(m.line,m,0,v))),this.isSelectionChangedOnMouseMoved&&this.selection.fireSelectionChanged(!0)),b.label=4;case 4:!this.owner.isReadOnlyMode&&this.isSelectionInListText(i)&&this.selection.selectListText(),!this.owner.isReadOnlyMode&&this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizing&&(this.owner.imageResizerModule.mouseUpInternal(),this.scrollToPosition(this.owner.selection.start,this.owner.selection.end),this.owner.imageResizerModule.isImageResizing=!1),this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!sf.base.isNullOrUndefined(this.selection.caret)&&(this.selection.caret.style.display="none"),this.isDragStarted&&(this.isDragging=!0,this.moveSelectedContent(),this.isDragging=!1),this.isMouseDown&&this.updateFocus(),this.isMouseDownInSelection=!1,this.isMouseDown=!1,this.isFootnoteWidget=!1,this.isSelectionChangedOnMouseMoved=!1,this.isTouchInput=!1,this.useTouchSelectionMark=!0,this.isControlPressed=!1,this.isListTextSelected&&this.selection.hideCaret(),this.owner.enableImageResizerMode&&((w=this.owner.imageResizerModule).isImageResizing=!1,w.isImageMoveToNextPage=!1,w.leftValue=void 0,w.topValue=void 0),this.isMouseDownInFooterRegion=!1,b.label=5;case 5:return this.selection&&(this.selection.isCellPrevSelected=!1),[2]}}))}))},this.onTouchStartInternal=function(e){if(t.selection){if(t.isTouchMoved=!1,t.isCompositionStart=!1,t.isCompositionEnd=!1,t.isCompositionUpdated=!1,t.isCompositionCanceled=!0,t.isTouchInput=!0,t.isTimerStarted?1===t.tapCount?t.tapCount=2:(t.tapCount=3,t.isTimerStarted=!1):(t.isTimerStarted=!0,t.tapCount=1),1===e.touches.length){t.zoomX=e.touches[0].clientX,t.zoomY=e.touches[0].clientY,t.owner.selection.isEmpty&&(t.useTouchSelectionMark=!1),t.isMouseDown=!0,t.isSelectionChangedOnMouseMoved=!1;var i=void 0;if(t.isMouseDown&&(i=t.getTouchOffsetValue(e)),i=t.owner.viewer.findFocusedPage(i,!0,!0),t.owner.enableImageResizerMode){var r=t.owner.imageResizerModule.getImagePointOnTouch(i);t.owner.imageResizerModule.selectedResizeElement=r.selectedElement}t.owner.enableImageResizerMode&&!sf.base.isNullOrUndefined(t.owner.imageResizerModule.selectedResizeElement)&&(t.owner.imageResizerModule.isImageResizing=!0),sf.base.Browser.isDevice&&(t.editableDiv.contentEditable=t.owner.isReadOnlyMode?"false":"true");var n=t.owner.selection.end.location.x,o=t.selection.getCaretBottom(t.owner.selection.end,t.owner.selection.isEmpty)+9;t.touchDownOnSelectionMark=(i.y<=o&&i.y>=o-20||i.y>=o&&i.y<=o+20)&&(i.x<=n&&i.x>=n-20||i.x>=n&&i.x<=n+20)?1:0,t.owner.selection.isEmpty||0!==t.touchDownOnSelectionMark||(n=t.owner.selection.start.location.x,o=t.selection.getCaretBottom(t.owner.selection.start,!1)+9,t.touchDownOnSelectionMark=(i.y<=o&&i.y>=o-20||i.y>=o&&i.y<=o+20)&&(i.x<=n&&i.x>=n-20||i.x>=n&&i.x<=n+20)?2:0)}(t.touchDownOnSelectionMark||e.touches.length>1)&&e.preventDefault(),t.longTouchTimer=setTimeout(t.onLongTouch,500,e),t.timer=setTimeout((function(){t.isTimerStarted=!1}),200),t.updateFocus()}},this.onLongTouch=function(e){if(!(sf.base.isNullOrUndefined(t.owner)||sf.base.isNullOrUndefined(t.viewerContainer)||t.isTouchMoved||1!==e.touches.length)){var i=t.getTouchOffsetValue(e),r=t.owner.viewer.findFocusedPage(i,!0),n=t.selection.start,o=t.selection.end,s=!1;t.selection.isForward||(n=t.selection.end,o=t.selection.start);var a=n.location,l=o.location;s=n.currentWidget!==o.currentWidget?!(r.x>=a.x&&r.x<=l.x||r.y>=a.y&&r.y<=l.y):!(r.x>=a.x&&r.x<=l.x&&r.y>=a.y&&r.y<=l.y),1===e.changedTouches.length&&s&&(t.updateSelectionOnTouch(i,r),t.isMouseDown=!1,t.touchDownOnSelectionMark=0,t.useTouchSelectionMark=!0,t.isSelectionChangedOnMouseMoved=!1),t.selection.isEmpty&&t.selection.selectCurrentWord()}},this.onTouchMoveInternal=function(e){t.isTouchMoved=!0;var i,r=e.touches;if(!sf.base.isNullOrUndefined(t.selection)){if(t.owner.editorModule&&t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)return e.preventDefault(),void(t.owner.imageResizerModule.isImageMoveToNextPage||(t.owner.imageResizerModule.handleImageResizingOnTouch(e),t.selection.caret.style.display="none"));if(t.isMouseDown){i=t.getTouchOffsetValue(e);var n=t.owner.viewer.findFocusedPage(i,!0);if(t.touchDownOnSelectionMark>0){t.isCompleted=!1,e.preventDefault();var o=n.y,s=t.owner.selection.end;n.y<=26?o-=n.y<0?0:n.y+.5:o-=36.5,s=2===t.touchDownOnSelectionMark?t.selection.start:t.selection.end,n=new I(n.x,o),t.owner.selection.moveTextPosition(n,s),t.isSelectionChangedOnMouseMoved=!0}t.selection.checkForCursorVisibility(),t.updateTouchMarkPosition()}}if(r.length>1){e.preventDefault(),t.isMouseDown=!1,t.zoomX=(r[0].clientX+r[1].clientX)/2,t.zoomY=(r[0].clientY+r[1].clientY)/2;var a=Math.sqrt(Math.pow(r[0].clientX-r[1].clientX,2)+Math.pow(r[0].clientY-r[1].clientY,2));t.preDifference>-1?a>t.preDifference?t.onPinchOutInternal(e):a<t.preDifference&&t.onPinchInInternal(e):t.zoomFactor<2?-1!==t.preDifference&&a>t.preDifference&&t.onPinchInInternal(e):-1===t.preDifference&&t.zoomFactor>2&&a>t.preDifference&&t.onPinchInInternal(e),t.preDifference=a}t.longTouchTimer&&(clearTimeout(t.longTouchTimer),t.longTouchTimer=void 0)},this.onTouchUpInternal=function(e){if(!sf.base.isNullOrUndefined(t.selection)){var i=t.getTouchOffsetValue(e),r=t.owner.viewer.findFocusedPage(i,!0);1===e.changedTouches.length&&((!t.isTouchMoved||t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing)&&(t.updateSelectionOnTouch(i,r),sf.base.isNullOrUndefined(t.currentPage)||sf.base.isNullOrUndefined(t.selection.start)||t.isSelectionChangedOnMouseMoved||!(t.selection.isEmpty||t.selection.isImageField()&&(!t.owner.enableImageResizerMode||t.owner.enableImageResizerMode&&!t.owner.imageResizerModule.isImageResizing))||t.selection.navigateHyperLinkOnEvent(r,!0)),t.isSelectionChangedOnMouseMoved&&t.selection.fireSelectionChanged(!0),t.isMouseDown=!1,t.touchDownOnSelectionMark=0,t.useTouchSelectionMark=!0,t.isSelectionChangedOnMouseMoved=!1),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizing&&(t.owner.imageResizerModule.mouseUpInternal(),t.owner.imageResizerModule.isImageResizing=!1,t.owner.imageResizerModule.isImageMoveToNextPage=!1,t.scrollToPosition(t.owner.selection.start,t.owner.selection.end)),t.owner.enableImageResizerMode&&t.owner.imageResizerModule.isImageResizerVisible&&t.isTouchInput&&(t.touchStart.style.display="none",t.touchEnd.style.display="none"),e.preventDefault()}t.preDifference=-1,t.isTouchInput=!1,t.longTouchTimer&&(clearTimeout(t.longTouchTimer),t.longTouchTimer=void 0),t.isTimerStarted||(t.tapCount=1),t.isListTextSelected&&t.selection.hideCaret(),t.updateFocus()},this.onKeyUpInternal=function(e){sf.base.Browser.isDevice&&e.target===t.editableDiv&&window.getSelection().anchorOffset!==t.prefix.length&&t.selection.setEditableDivCaretPosition(t.editableDiv.innerText.length),(e.ctrlKey||17===e.keyCode||17===e.which)&&(t.isControlPressed=!1)},this.onKeyDownInternal=function(e){return Xs(t,void 0,void 0,(function(){var t,i,r,n,o,s,a=this;return Js(this,(function(l){switch(l.label){case 0:return sf.base.isNullOrUndefined(e.target)||e.target===this.editableDiv?(this.owner.focusIn(),t=!1,i={ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,key:e.key,isHandled:!1},[4,this.owner.fireKeyDownInternal(i)]):[2];case 1:if(l.sent().isHandled)return[2];if(r=e.which||e.keyCode,n=!(!e.ctrlKey&&!e.metaKey)||17===r,o=e.shiftKey?e.shiftKey:16===r,s=e.altKey?e.altKey:18===r,n&&!o&&!s)switch(r){case 80:e.preventDefault(),this.owner.print(),t=!0;break;case 83:e.preventDefault(),this.owner.save(""===this.owner.documentName?"sample":this.owner.documentName,"Sfdt"),t=!0}return t||sf.base.isNullOrUndefined(this.selection)||this.selection.onKeyDownInternal(e,n,o,s),t&&e.preventDefault(),this.updateFocus(),this.timer=setTimeout((function(){a.isScrollHandler||sf.base.isNullOrUndefined(a.owner)||!a.owner.isSpellCheck||(a.isScrollToSpellCheck=!0,a.owner.viewer.updateScrollBars())}),100),[2]}}))}))},this.owner=e,this.pages=[],this.lists=[],this.abstractLists=[],this.render=new B(this),this.characterFormat=new T(this),this.themeFontLanguage=new T(this),this.paragraphFormat=new ul(this),this.renderedLists=new a,this.renderedLevelOverrides=[],this.headersFooters=[],this.styles=new xl,this.preDefinedStyles=new a,this.initalizeStyles(),this.bookmarks=new a,this.editRanges=new a,this.isIosDevice="undefined"!=typeof window&&/Mac|iPad|iPod/i.test(navigator.userAgent),this.isMobileDevice="undefined"!=typeof window&&/Android|Windows Phone|webOS/i.test(navigator.userAgent),this.customXmlData=new a,this.fontSubstitutionTable=new a,this.contentControlCollection=[],this.footnoteCollection=[],this.endnoteCollection=[],this.themes=new Gs,this.images=new a}return Object.defineProperty(e.prototype,"visibleBounds",{get:function(){return this.visibleBoundsIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerCanvas",{get:function(){return sf.base.isNullOrUndefined(this.containerCanvasIn)&&(this.containerCanvasIn=document.createElement("canvas"),this.containerCanvasIn.getContext("2d").save()),sf.base.isNullOrUndefined(this.pageContainer)||this.containerCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.containerCanvasIn),this.containerCanvasIn},enumerable:!0,configurable:!0}),e.prototype.openTextFile=function(e){this.layout.isTextFormat=!0;var t=[];t=(e=e.replace(/\r\n/g,"\n")).split("\n");var i=new aa;i.sectionFormat=new h(i),i.childWidgets=[];for(var r=new ca,n=new ma(r),o=0;o<t.length;o++)if(o!==t.length-1||0!==t[o].length){var s=new ca,a=new ma(s);if(t[o].length>0){if(t[o].length>90)for(var l=0,d=90,c=void 0,p=t[o].length/90+1,g=0;g<p;){var f;p-1!=g||(d=t[o].length%90),c=t[o].substring(l,d),(f=new Fa).text=c,a.children.push(f),f.line=a,g++,d+=90,l+=90}else(f=new Fa).text=t[o],a.children.push(f),f.line=a}s.childWidgets.push(a),s.containerWidget=i,i.childWidgets.push(s)}else r.childWidgets.push(n),r.containerWidget=i,i.childWidgets.push(r);this.onDocumentChanged([i]),this.layout.isTextFormat=!1},Object.defineProperty(e.prototype,"selectionCanvas",{get:function(){return sf.base.isNullOrUndefined(this.selectionCanvasIn)&&(this.selectionCanvasIn=document.createElement("canvas"),this.selectionCanvas.getContext("2d").save()),sf.base.isNullOrUndefined(this.pageContainer)||this.selectionCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.selectionCanvasIn),this.selectionCanvasIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerContext",{get:function(){return this.containerCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentRenderingPage",{get:function(){if(0!==this.pages.length)return this.pages[this.pages.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomFactor",{get:function(){return this.zoomFactorInternal},set:function(e){this.zoomFactorInternal!==e&&(this.preZoomFactor=this.zoomFactor,this.zoomFactorInternal=e,this.zoomModule.setZoomFactor(),this.owner.zoomFactor=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionStartPage",{get:function(){return this.selectionStartPageIn},set:function(e){this.selectionStartPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEndPage",{get:function(){return this.selectionEndPageIn},set:function(e){this.selectionEndPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSelectedComment",{get:function(){return this.currentSelectedCommentInternal},set:function(e){this.selection&&(this.selection.updatePreviousCommentMark(e),this.selection.hightlightCommentSelectionMark()),this.currentSelectedCommentInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSelectedRevision",{get:function(){return this.currentSelectedRevisionInternal},set:function(e){this.currentSelectedRevisionInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInlineFormFillProtectedMode",{get:function(){return this.isFormFillProtectedMode&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFormFillProtectedMode",{get:function(){return this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCommentOnlyMode",{get:function(){return this.isDocumentProtected&&"CommentsOnly"===this.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isTrackedOnlyMode",{get:function(){return this.isDocumentProtected&&"RevisionsOnly"===this.protectionType},enumerable:!0,configurable:!0}),e.prototype.initalizeStyles=function(){this.preDefinedStyles.add("Normal",'{"type":"Paragraph","name":"Normal","next":"Normal"}'),this.preDefinedStyles.add("Heading 1",'{"type":"Paragraph","name":"Heading 1","basedOn":"Normal","next":"Normal","link":"Heading 1 Char","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":12.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level1"}}'),this.preDefinedStyles.add("Heading 2",'{"type":"Paragraph","name":"Heading 2","basedOn":"Normal","next":"Normal","link":"Heading 2 Char","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level2"}}'),this.preDefinedStyles.add("Heading 3",'{"type":"Paragraph","name":"Heading 3","basedOn":"Normal","next":"Normal","link":"Heading 3 Char","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level3"}}'),this.preDefinedStyles.add("Heading 4",'{"type":"Paragraph","name":"Heading 4","basedOn":"Normal","next":"Normal","link":"Heading 4 Char","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level4"}}'),this.preDefinedStyles.add("Heading 5",'{"type":"Paragraph","name":"Heading 5","basedOn":"Normal","next":"Normal","link":"Heading 5 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level5"}}'),this.preDefinedStyles.add("Heading 6",'{"type":"Paragraph","name":"Heading 6","basedOn":"Normal","next":"Normal","link":"Heading 6 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level6"}}'),this.preDefinedStyles.add("Heading 7",'{"type":"Paragraph","name":"Heading 7","basedOn":"Normal","next":"Normal","link":"Heading 7 Char","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level7"}}'),this.preDefinedStyles.add("Heading 8",'{"type":"Paragraph","name":"Heading 8","basedOn":"Normal","next":"Normal","link":"Heading 8 Char","characterFormat":{"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level8"}}'),this.preDefinedStyles.add("Heading 9",'{"type":"Paragraph","name":"Heading 9","basedOn":"Normal","next":"Normal","link":"Heading 9 Char","characterFormat":{"fontSize":10.5,"italic":true,"fontFamily":"Calibri Light","fontColor":"#333333"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level9"}}'),this.preDefinedStyles.add("Default Paragraph Font",'{"type":"Character","name":"Default Paragraph Font"}'),this.preDefinedStyles.add("Heading 1 Char",'{"type":"Character","name":"Heading 1 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 2 Char",'{"type":"Character","name":"Heading 2 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 3 Char",'{"type":"Character","name":"Heading 3 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor": "#1F3763"}}'),this.preDefinedStyles.add("Heading 4 Char",'{"type":"Character","name":"Heading 4 Char","basedOn":"Default Paragraph Font","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 5 Char",'{"type":"Character","name":"Heading 5 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 6 Char",'{"type":"Character","name":"Heading 6 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"}}'),this.preDefinedStyles.add("Heading 7 Char",'{"type":"Character","name":"Heading 7 Char","basedOn":"Default Paragraph Font","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#1F3763"}}'),this.preDefinedStyles.add("Heading 8 Char",'{"type":"Character","name":"Heading 8 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333"}}'),this.preDefinedStyles.add("Heading 9 Char",'{"type":"Character","name":"Heading 9 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":10.5,"italic":true,"fontFamily":"Calibri Light","fontColor":"#333333"}}'),this.preDefinedStyles.add("Hyperlink",'{"type":"Character","name":"Hyperlink","basedOn":"Default Paragraph Font","next":"Normal","characterFormat":{"fontColor":"#0563C1","underline": "Single"}}'),this.preDefinedStyles.add("TOC 1",'{"type":"Paragraph","name":"TOC 1","basedOn":"Normal","next":"Normal","paragraphFormat":{"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 2",'{"type":"Paragraph","name":"TOC 2","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :11.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 3",'{"type":"Paragraph","name":"TOC 3","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :22.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 4",'{"type":"Paragraph","name":"TOC 4","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :33.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 5",'{"type":"Paragraph","name":"TOC 5","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :44.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 6",'{"type":"Paragraph","name":"TOC 6","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :55.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 7",'{"type":"Paragraph","name":"TOC 7","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :66.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 8",'{"type":"Paragraph","name":"TOC 8","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :77.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("TOC 9",'{"type":"Paragraph","name":"TOC 9","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :88.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Header",'{"type":"Paragraph","name":"Header","basedOn":"Normal","next":"Header","paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple"}}'),this.preDefinedStyles.add("Footer",'{"type":"Paragraph","name":"Footer","basedOn":"Normal","next":"Footer","paragraphFormat":{"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple"}}')},e.prototype.clearDocumentItems=function(){this.owner.editor&&this.owner.editor.clear(),this.owner.search&&this.owner.search.clearSearchHighlight(),this.owner.selection&&this.owner.selection.clear(),this.editRanges.clear(),this.headersFooters=[],this.fields=[],this.formFields=[],this.currentSelectedComment=void 0,this.currentSelectedRevision=void 0;for(var e=0;e<this.comments.length;e++){var t=this.comments[e].commentStart;t&&t.destroy()}this.comments=[],this.bookmarks.clear(),this.endBookmarksUpdated=[],this.styles.clear(),this.authors.clear(),this.revisionsInternal.clear(),this.owner.revisions.destroy(),this.characterFormat.clearFormat(),this.themeFontLanguage.clearFormat(),this.paragraphFormat.clearFormat(),this.owner.trackChangesPane&&this.owner.trackChangesPane.clear(),this.setDefaultCharacterValue(this.characterFormat),this.setDefaultParagraphValue(this.paragraphFormat),this.isHeaderFooter=!1,this.defaultTabWidth=36,this.isDocumentProtected=!1,this.protectionType="NoProtection",this.restrictFormatting=!1,this.hashValue="",this.saltValue="",this.userCollection=[],this.customXmlData.clear(),this.fontSubstitutionTable.clear(),this.images.clear(),this.contentControlCollection=[],this.backgroundColor="#FFFFFF",this.endnotes.clear(),this.footnotes.clear(),this.footnoteCollection=[],this.endnoteCollection=[],this.themes=new Gs,this.hasThemes=!1,this.isRestartNumbering=!1},e.prototype.setDefaultDocumentFormat=function(){this.owner.parser.parseCharacterFormat(0,this.owner.characterFormat,this.characterFormat),this.owner.parser.parseParagraphFormat(0,this.owner.paragraphFormat,this.paragraphFormat)},e.prototype.setDefaultCharacterValue=function(e){e.bold=!1,e.italic=!1,e.fontFamily="Calibri",e.fontSize=11,e.underline="None",e.strikethrough="None",e.fontSizeBidi=11,e.fontFamilyBidi="Calibri",e.baselineAlignment="Normal",e.highlightColor="NoColor",e.allCaps=!1},e.prototype.setDefaultParagraphValue=function(e){e.leftIndent=0,e.rightIndent=0,e.firstLineIndent=0,e.textAlignment="Left",e.beforeSpacing=0,e.afterSpacing=0,e.lineSpacing=1,e.lineSpacingType="Multiple",e.bidi=!1,e.keepWithNext=!1,e.keepLinesTogether=!1,e.widowControl=!0,e.outlineLevel="BodyText"},e.prototype.getAbstractListById=function(e){if(!sf.base.isNullOrUndefined(this.abstractLists))for(var t=0;t<this.abstractLists.length;t++){var i=this.abstractLists[t];if(i instanceof W&&i.abstractListId===e)return i}},e.prototype.getListById=function(e){if(!sf.base.isNullOrUndefined(this.lists))for(var t=0;t<this.lists.length;t++)if(!sf.base.isNullOrUndefined(this.lists[t])&&this.lists[t].listId===e)return this.lists[t]},e.getListLevelNumber=function(e){return e.ownerBase instanceof f?e.ownerBase.levelNumber:e.ownerBase instanceof W&&!sf.base.isNullOrUndefined(e.ownerBase.levels)?e.ownerBase.levels.indexOf(e):-1},e.prototype.getImageString=function(e){var t=this.images.get(parseInt(e.imageString));return e.isMetaFile&&".svg"!==x.formatClippedString(t[0]).extension||".tif"===x.formatClippedString(t[0]).extension?t[1]:t[0]},e.prototype.addBase64StringInCollection=function(e){return Xs(this,void 0,void 0,(function(){var t,i,r,n,o;return Js(this,(function(s){for(t=this.images.length,i=!0,r=[],n=0;n<this.images.length;n++){if(o=this.images.get(n),e.isMetaFile&&e.metaFileImageString===o[0]){t=n,i=!1;break}if(e.imageString===o[0]){t=n,i=!1;break}}return i&&(e.isMetaFile?(r.push(e.metaFileImageString),r.push(""===e.imageString?e.metaFileImageString:e.imageString)):r.push(e.imageString),this.images.add(this.images.length,r)),e.isMetaFile&&(e.metaFileImageString=t.toString()),e.imageString=t.toString(),[2]}))}))},e.prototype.getBookmarks=function(e){for(var t=[],i=0;i<this.bookmarks.keys.length;i++){var r=this.bookmarks.keys[i];(e||0!==r.indexOf("_"))&&t.push(r)}return t},e.prototype.selectComment=function(e){var t=this;this.owner.selection&&setTimeout((function(){t.owner&&t.owner.selection&&t.owner.selection.selectComment(e)}))},e.prototype.showComments=function(e){this.owner&&e&&this.owner.enableComment&&this.owner.fireBeforePaneSwitch("Comment")},e.prototype.showRevisions=function(e){this.owner&&e&&this.owner.fireBeforePaneSwitch("Comment"),!e&&this.owner.showComments||(this.showRevision||this.owner.enableTrackChanges||!this.owner.showRevisions?(this.owner.dotNetRef.invokeMethodAsync("ShowRevisions",e),this.owner.enableComment,this.showRevision=!1):(this.owner.dotNetRef.invokeMethodAsync("ShowRevisions",!e),this.owner.showRevisions=!1)),e&&this.owner.trackChangesPane.enableDisableButton(!this.owner.isReadOnly&&!this.isDocumentProtected)},e.prototype.initializeComponents=function(){var e=this.owner.element;sf.base.isNullOrUndefined(e)||(this.optionsPaneContainer=this.owner.element.getElementsByClassName("e-documenteditor-optionspane")[0],sf.base.isNullOrUndefined(this.optionsPaneContainer)&&(this.optionsPaneContainer=sf.base.createElement("div",{className:"e-documenteditor-optionspane"}),this.optionsPaneContainer.contentEditable="false",e.appendChild(this.optionsPaneContainer)),this.restrictEditingElement=this.owner.element.getElementsByClassName("e-de-restrict-pane")[0],this.optionsPaneElement=this.owner.element.getElementsByClassName("e-de-op")[0],this.commentPaneElement=this.owner.element.getElementsByClassName("e-de-review-pane")[0],this.viewerContainer=this.owner.element.getElementsByClassName("e-de-viewercontainer")[0],sf.base.isNullOrUndefined(this.viewerContainer)&&(this.viewerContainer=sf.base.createElement("div",{id:this.owner.containerId+"_viewerContainer"}),this.optionsPaneContainer.appendChild(this.viewerContainer)),this.viewerContainer.style.cssText="position:relative;backgroundColor:#FBFBFB;overflow:auto;direction:ltr;",this.viewerContainer.tabIndex=-1,this.viewerContainer.style.outline="none",this.pageContainer=sf.base.createElement("div",{id:this.owner.containerId+"_pageContainer",className:"e-de-background"}),this.viewerContainer.appendChild(this.pageContainer),this.pageContainer.style.top="0px",this.pageContainer.style.left="0px",this.pageContainer.style.position="relative",this.pageContainer.style.pointerEvents="none",sf.base.Browser.isDevice?this.createEditableDiv(e):this.createEditableIFrame(),this.owner.enableImageResizerMode&&this.owner.imageResizerModule.initializeImageResizer(),this.updateViewerSizeInternal(e),this.layout=new E(this),this.textHelper=new L(this),this.zoomModule=new A(this),this.initTouchEllipse(),this.wireEvent(),this.owner.trackChangesPane=new zs(this.owner),this.owner.spellCheckerModule=new Vs(this.owner.documentHelper))},e.prototype.measureScrollbarWidth=function(e){var t=document.createElement("div");t.setAttribute("style","visibility:hidden;overflow:scroll"),e.appendChild(t);var i=document.createElement("div");t.appendChild(i),this.scrollbarWidth=t.getBoundingClientRect().width-i.getBoundingClientRect().width,t.parentNode.removeChild(t)},e.prototype.createEditableDiv=function(e){this.editableDiv=document.createElement("div"),this.editableDiv.contentEditable=this.owner.isReadOnlyMode?"false":"true",this.editableDiv.style.position="fixed",this.editableDiv.style.left="-150em",this.editableDiv.style.width="100%",this.editableDiv.style.height="100%",this.editableDiv.id=e.id+"_editableDiv",document.body.appendChild(this.editableDiv)},e.prototype.createEditableIFrame=function(){this.iframe=sf.base.createElement("iframe",{attrs:{scrolling:"no",style:"pointer-events:none;position:absolute;left:0px;top:0px;outline:none;background-color:transparent;width:0px;height:0px;overflow:hidden"},className:"e-de-text-target"}),this.viewerContainer.appendChild(this.iframe),this.initIframeContent()},e.prototype.initIframeContent=function(){sf.base.isNullOrUndefined(this.iframe.contentDocument)||(this.iframe.contentDocument.open(),this.iframe.contentDocument.write('<!DOCTYPE html><html><head></head><body spellcheck="false" style=background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px; ><div contenteditable="true" style=background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;></div></body></html>'),this.iframe.contentDocument.close(),this.editableDiv=this.iframe.contentDocument.body.children[0])},e.prototype.wireEvent=function(){sf.base.isNullOrUndefined(this.selection)||this.selection.initCaret(),this.wireInputEvents(),sf.base.isNullOrUndefined(this.iframe)||this.iframe.addEventListener("load",this.onIframeLoad.bind(this)),this.viewerContainer.addEventListener("scroll",this.scrollHandler),this.viewerContainer.addEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.addEventListener("keydown",this.onKeyDownInternal),this.viewerContainer.addEventListener("mousemove",this.onMouseMoveInternal),this.viewerContainer.addEventListener("mouseleave",this.onMouseLeaveInternal),this.viewerContainer.addEventListener("mouseenter",this.onMouseEnterInternal),this.viewerContainer.addEventListener("contextmenu",this.onContextMenu),this.viewerContainer.addEventListener("dblclick",this.onDoubleTap),this.viewerContainer.addEventListener("mouseup",this.onMouseUpInternal),window.addEventListener("resize",this.onWindowResize),window.addEventListener("keyup",this.onKeyUpInternal),window.addEventListener("mouseup",this.onImageResizer.bind(this)),window.addEventListener("touchend",this.onImageResizer.bind(this)),this.viewerContainer.addEventListener("touchstart",this.onTouchStartInternal),this.viewerContainer.addEventListener("touchmove",this.onTouchMoveInternal),this.viewerContainer.addEventListener("touchend",this.onTouchUpInternal),void 0!==navigator&&navigator.userAgent.match("Firefox")&&this.viewerContainer.addEventListener("DOMMouseScroll",this.zoomModule.onMouseWheelInternal.bind(this)),this.viewerContainer.addEventListener("mousewheel",this.zoomModule.onMouseWheelInternal.bind(this)),this.editableDiv.addEventListener("focus",this.updateFocus)},e.prototype.wireInputEvents=function(){sf.base.isNullOrUndefined(this.editableDiv)||(this.editableDiv.addEventListener("paste",this.onPaste),sf.base.Browser.isDevice?this.editableDiv.addEventListener("input",this.onTextInputInternal):(this.editableDiv.addEventListener("keypress",this.onKeyPressInternal),"chrome"===sf.base.Browser.info.name&&this.editableDiv.addEventListener("textInput",this.onTextInput)),this.editableDiv.addEventListener("blur",this.onFocusOut),this.editableDiv.addEventListener("keydown",this.onKeyDownInternal),this.editableDiv.addEventListener("compositionstart",this.compositionStart),this.editableDiv.addEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.addEventListener("compositionend",this.compositionEnd))},e.prototype.onIframeLoad=function(){sf.base.isNullOrUndefined(this.iframe)||0!==this.iframe.contentDocument.body.children.length||(this.initIframeContent(),this.wireInputEvents())},e.prototype.getEditableDivTextContent=function(){return this.editableDiv.textContent},e.prototype.updateAuthorIdentity=function(){for(var e=this.owner.revisions.changes,t=0;t<e.length;t++)this.getAuthorColor(e[t].author)},e.prototype.getAvatar=function(e,t,i,r){var n,o;if(sf.base.isNullOrUndefined(i)?n=r.author:(n=i.author,o=i.initial),!sf.base.isNullOrUndefined(n)){var s=sf.base.createElement("div",{className:"e-de-cmt-avatar"}),a=sf.base.createElement("div",{className:"e-de-ff-cmt-avatar"});if(a.style.backgroundColor=this.owner.documentHelper.getAuthorColor(n),""===o||sf.base.isNullOrUndefined(o)){var l=n.split(" "),d=l[0].charAt(0);l.length>1&&(d+=l[l.length-1][0]),a.innerText=d.toUpperCase()}else o.length>2?a.innerText=o.substring(0,2):a.innerText=o;s.appendChild(a),s.appendChild(t),e.appendChild(s)}},e.prototype.getAuthorColor=function(e){return this.authors.containsKey(e)?this.authors.get(e):(t=0===this.authors.length?"#b5082e":this.generateRandomColor(),this.authors.add(e,t),t);var t},e.prototype.generateRandomColor=function(){return["#b5082e","#2e97d3","#bb00ff","#f37e43","#03a60b","#881824","#e09a2b","#50565e"][this.authors.length%8]},e.prototype.positionEditableTarget=function(){var e=this.selection.getRect(this.selection.start),t=this.selection.getSelectionPage(this.selection.start),i=t.bodyWidgets[0].sectionFormat,r=t.boundingRectangle.x+x.convertPointToPixel(i.leftMargin)*this.zoomFactor,n=e.y,o=i.pageWidth-i.leftMargin-i.rightMargin,s="left:"+r+"px;";s+="top:"+n+"px;",s+="width:"+x.convertPointToPixel(o)*this.zoomFactor+"px;",s+="height:250px;outline-style:none;position:absolute",this.iframe.setAttribute("style",s);var a="background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;";a+="text-indent:"+(e.x-r)+"px;",a+="color:transparent;pointer-events:none;outline-style:none;",a+="font-size:"+x.convertPointToPixel(this.selection.characterFormat.fontSize)*this.zoomFactor+"px;",a+="font-family"+this.selection.characterFormat.fontFamily+";",a+="overflow:hidden;text-decoration:none;white-space:normal;",this.editableDiv.setAttribute("style",a)},e.prototype.onImageResizer=function(e){!sf.base.isNullOrUndefined(this.owner)&&!sf.base.isNullOrUndefined(this.owner.imageResizerModule)&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.isImageResizing&&(e instanceof MouseEvent?this.onMouseUpInternal(e):e instanceof TouchEvent&&this.onTouchUpInternal(e)),this.scrollMoveTimer&&(this.isMouseEntered=!0,clearInterval(this.scrollMoveTimer))},e.prototype.initDialog=function(e){},e.prototype.initDialog3=function(e){},e.prototype.hideDialog=function(){this.updateFocus()},e.prototype.initDialog2=function(e){},e.prototype.getBase64=function(e,t,i){return Xs(this,void 0,void 0,(function(){return Js(this,(function(r){return[2,new Promise((function(r,n){var o="",s=new Image;s.onload=function(){var e=Math.max(1,window.devicePixelRatio||1),n=document.createElement("canvas");n.width=t*e,n.height=i*e;var a=n.getContext("2d");a.scale(e,e),a.drawImage(s,0,0,t,i),o=n.toDataURL("image/png",1),r(o)},e&&(x.startsWith(e,"http://")||x.startsWith(e,"https://"))&&fetch(e).then((function(e){return e.blob()})).then((function(e){return new Promise((function(t,i){var r=new FileReader;r.onloadend=function(){return t(r.result)},r.onerror=i,r.readAsDataURL(e)}))})).then((function(e){s.src=e}))}))]}))}))},e.prototype.clearContent=function(){if(this.containerContext.clearRect(0,0,this.containerCanvas.width,this.containerCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContainer)for(var e=this.pageContainer.getElementsByClassName("e-de-cmt-mark"),t=0;t<e.length;t++)e[t].style.display="none"},e.prototype.onDocumentChanged=function(e){this.clearContent(),this.owner.editorModule&&(this.owner.editorModule.tocStyles={},this.owner.editorModule.tocBookmarkId=0),this.heightInfoCollection={},this.owner.isDocumentLoaded=!1,this.viewer.columnLayoutArea.clear(),this.layout.isDocumentContainsRtl=!1,this.layout.isMultiColumnDoc=!1,this.updateAuthorIdentity();for(var t=0;t<this.pages.length;t++)for(var i=0;i<this.pages[t].bodyWidgets.length;i++)this.pages[t].bodyWidgets[i].destroy();this.pages=[],sf.base.isNullOrUndefined(this.renderedLists)||this.renderedLists.clear(),sf.base.isNullOrUndefined(this.renderedLevelOverrides)||(this.renderedLevelOverrides=[]),sf.base.isNullOrUndefined(this.owner.editorHistory)||this.owner.editorHistory.destroy(),this.owner.isDocumentLoaded=!0,this.layout.isInitialLoad=!0,this.layout.footHeight=0,this.layout.footnoteHeight=0,this.layout.layoutItems(e,!1),this.owner.selection&&(this.selection.previousSelectedFormField=void 0,this.formFields.length>0&&this.owner.selection.highlightFormFields(),this.owner.selection.editRangeCollection=[],this.owner.selection.selectRange(this.owner.documentStart,this.owner.documentStart),this.isDocumentProtected&&(this.owner.selection.isHighlightEditRegion=!0)),this.owner.optionsPaneModule,this.owner.showRevisions&&this.owner.trackChangesPane.updateTrackChanges(!0),!sf.base.isNullOrUndefined(this.owner.selection)&&this.owner.selection.isViewPasteOptions&&(this.owner.selection.isViewPasteOptions=!1,this.owner.selection.showHidePasteOptions(void 0,void 0)),this.owner.fireDocumentChange()},e.prototype.initTouchEllipse=function(){var e="height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5",t=" height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;box-sizing: unset;";this.touchStart=sf.base.createElement("div",{className:"e-touch-ellipse",styles:e});var i=sf.base.createElement("div",{styles:t});this.touchEnd=sf.base.createElement("div",{className:"e-touch-ellipse",styles:e}),this.touchStart.style.display="none";var r=sf.base.createElement("div",{styles:t});this.touchStart.appendChild(i),this.touchEnd.appendChild(r),this.touchEnd.style.display="none",this.viewerContainer.appendChild(this.touchStart),this.viewerContainer.appendChild(this.touchEnd)},e.prototype.updateTouchMarkPosition=function(){if("none"!==this.touchStart.style.display&&!sf.base.isNullOrUndefined(this.selection))if(this.selection.isEmpty)this.selection.updateCaretPosition();else{var e=this.selection.getCaretBottom(this.selection.start,!1),t=this.selection.getPage(this.selection.start.paragraph),i=t.boundingRectangle.y-this.owner.viewer.pageGap*(this.pages.indexOf(t)+1)*this.zoomFactor+this.owner.viewer.pageGap*(this.pages.indexOf(t)+1);this.touchStart.style.left=t.boundingRectangle.x+(Math.round(this.selection.start.location.x)*this.zoomFactor-14)+"px",this.touchStart.style.top=i+e*this.zoomFactor+"px",this.selection.isEmpty||(e=this.selection.getCaretBottom(this.selection.end,!1),t=this.selection.getPage(this.selection.end.paragraph)),this.touchEnd.style.left=t.boundingRectangle.x+(Math.round(this.selection.end.location.x)*this.zoomFactor-14)+"px",this.touchEnd.style.top=i+e*this.zoomFactor+"px"}},e.prototype.autoScrollOnSelection=function(e){var t=this;this.scrollMoveTimer&&(e.y<=0||e.y>50||e.y<this.viewerContainer.offsetHeight-50)?(clearInterval(this.scrollMoveTimer),this.scrollMoveTimer=0):e.y<60?(clearInterval(this.scrollMoveTimer),this.scrollMoveTimer=setInterval((function(){t.viewerContainer.scrollTop-=20,setTimeout((function(){var i=t.owner.viewer.findFocusedPage(e,!t.owner.enableHeaderAndFooter),r=t.getLineWidget(i);t.selection.updateTextPosition(r,i)}),200)}),200)):e.y>this.viewerContainer.offsetHeight-70&&(clearInterval(this.scrollMoveTimer),this.scrollMoveTimer=setInterval((function(){t.viewerContainer.scrollTop+=20,setTimeout((function(){var i=t.owner.viewer.findFocusedPage(e,!t.owner.enableHeaderAndFooter),r=t.getLineWidget(i);t.selection.updateTextPosition(r,i)}),200)}),200))},e.prototype.scrollForwardOnSelection=function(e){if(this.viewerContainer){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop+200;var t=this.owner.viewer.findFocusedPage(e,!this.owner.enableHeaderAndFooter),i=this.owner.selection.end;this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||(this.skipScrollToPosition=!0,this.owner.selection.moveTextPosition(t,i,!0))}},e.prototype.scrollBackwardOnSelection=function(e){this.viewerContainer.scrollTop=this.viewerContainer.scrollTop-200;var t=this.owner.viewer.findFocusedPage(e,!this.owner.enableHeaderAndFooter),i=this.owner.selection.end;this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize||(this.skipScrollToPosition=!0,this.owner.selection.moveTextPosition(t,i,!0))},e.prototype.moveSelectedContent=function(){this.isDragStarted=!1;var e=this.owner.editor.getSelectionInfo(!0);e=this.owner.selection.updateSelectionInfo(e);var t=this.selection.getTextPosBasedOnLogicalIndex(e.start),i=this.selection.getTextPosBasedOnLogicalIndex(e.end),r=this.selection.getParagraphInfo(t),n=this.selection.getParagraphInfo(i),o=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),s=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString()),a=this.selection.getTextPosBasedOnLogicalIndex(o),l=this.selection.getTextPosBasedOnLogicalIndex(s),d=this.selection.getHierarchicalIndex(this.dragStartParaInfo.paragraph,this.dragStartParaInfo.offset.toString()),h=this.selection.getHierarchicalIndex(this.dragEndParaInfo.paragraph,this.dragEndParaInfo.offset.toString()),c=this.selection.getTextPosBasedOnLogicalIndex(d),p=this.selection.getTextPosBasedOnLogicalIndex(h);if(a.isExistBefore(c)||l.isExistAfter(p)){this.owner.editor.initComplexHistory("DragAndDropContent"),this.selection.start=c,this.selection.end=p;var g=this.owner.enableLocalPaste;g||(this.owner.enableLocalPaste=!0);var f=this.dragEndParaInfo.paragraph.getLength(),u=!1;(f<this.dragEndParaInfo.offset||!this.dragStartParaInfo.paragraph.equals(this.dragEndParaInfo.paragraph))&&(u=!0),this.owner.editor.cut(),this.dragEndParaInfo.paragraph.equals(r.paragraph)&&this.dragEndParaInfo.offset<r.offset&&!this.owner.enableTrackChanges&&(f-=this.dragEndParaInfo.paragraph.getLength(),r.offset-=f,n.offset-=f,o=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),s=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())),u&&this.dragEndParaInfo.paragraph.equals(n.paragraph)||(o=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),s=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())),a=this.selection.getTextPosBasedOnLogicalIndex(o),l=this.selection.getTextPosBasedOnLogicalIndex(s),this.selection.start=a,this.selection.end=l,this.owner.editor.copiedTextContent="",this.owner.editor.paste(),g||(this.owner.enableLocalPaste=!1),this.owner.editorHistory.updateComplexHistory()}else this.owner.selection.selectPosition(c,p);this.dragStartParaInfo=void 0,this.dragEndParaInfo=void 0,this.selection.caret.classList.add("e-de-cursor-animation")},e.prototype.isSelectionInListText=function(e){var t=this.getLineWidget(e);if(!sf.base.isNullOrUndefined(t)&&t.children[0]instanceof Va){var i=this.getLeftValue(t),r=t.children[0].width,n=t.children[0].height;if(this.isInsideRect(i,t.paragraph.y,r,n,e))return this.selectionLineWidget=t,!0}return!1},e.prototype.isInShapeBorder=function(e,t){if(!sf.base.isNullOrUndefined(e)){var i=e.width,r=e.height;if(this.isInsideRect(e.x-e.margin.left,e.y-e.margin.top,i,r,t)){if(e instanceof Da)return!0;if(e instanceof La){var n=e.lineFormat.weight;if(!this.isInsideRect(e.x+n,e.y+n+e.textFrame.marginTop,i-2*n,r-(2*n+e.textFrame.marginTop+e.textFrame.marginBottom),t))return!0}}}return!1},e.prototype.isInsideRect=function(e,t,i,r,n){return n.x>e&&n.x<=e+i&&n.y>t&&n.y<=t+r},e.prototype.getLeftValue=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;this.selection.isParagraphFirstLine(e)&&("Right"===i.textAlignment?(t-=x.convertPointToPixel(i.firstLineIndent),t-=x.convertPointToPixel(i.leftIndent)):t+=x.convertPointToPixel(i.firstLineIndent));var r=e.children[0];return r instanceof Va&&(t+=r.margin.left),t},e.prototype.isLeftButtonPressed=function(e){return this.isTouchInput=!1,1===(e.which||e.button)},e.prototype.updateSelectionOnTouch=function(e,t){this.zoomX=void 0,this.zoomY=void 0,!this.isMouseDown||this.isSelectionChangedOnMouseMoved||sf.base.isNullOrUndefined(this.currentPage)||sf.base.isNullOrUndefined(this.owner.selection.start)||(0===this.touchDownOnSelectionMark&&(this.updateTextPositionForSelection(new I(t.x,t.y),this.tapCount),2===this.tapCount&&this.selection.checkAndEnableHeaderFooter(e,t)),this.owner.selection.isEmpty&&this.selection.updateCaretPosition(),this.selection.checkForCursorVisibility())},e.prototype.getTouchOffsetValue=function(e){var t=this.viewerContainer.getBoundingClientRect(),i=e.touches[0];sf.base.isNullOrUndefined(i)&&(i=e.changedTouches[0]);var r=i.clientX-t.left,n=i.clientY-t.top;return new I(r,n)},e.prototype.onPinchInInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor-.01;t<5&&t>2&&(t-=.01),t<.1&&(t=.1),this.zoomFactor=t},e.prototype.onPinchOutInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor+.01;t>2&&(t+=.01),t>5&&(t=5),this.zoomFactor=t},e.prototype.getPageWidth=function(e){return e.boundingRectangle.width},e.prototype.removePage=function(e){this.currentPage===e&&(this.currentPage=void 0),e.headerWidgetIn&&(e.headerWidgetIn.page=void 0),e.footerWidgetIn&&(e.footerWidgetIn.page=void 0);var t=this.pages.indexOf(e);if(t>-1&&this.pages.splice(t,1),!sf.base.isNullOrUndefined(this.owner.viewer.visiblePages)&&this.owner.viewer.visiblePages.indexOf(e)>-1){var i=this.owner.viewer.visiblePages.indexOf(e);this.owner.viewer.visiblePages.splice(i,1)}for(var r=0;r<this.pages.length;r++)this.pages[r].boundingRectangle.height;e.boundingRectangle.height;var n=20;if(t>0&&(n+=this.pages[t-1].boundingRectangle.bottom),-1!==t)for(r=t;r<this.pages.length;r++)(e=this.pages[r]).boundingRectangle=new ia(e.boundingRectangle.x,n,e.boundingRectangle.width,e.boundingRectangle.height),n=e.boundingRectangle.bottom+20,sf.base.isNullOrUndefined(e.bodyWidgets[0].firstChild)||e.bodyWidgets[0].firstChild instanceof ga&&e.bodyWidgets[0].firstChild.header||(e.repeatHeaderRowTableWidget=!1)},e.prototype.updateViewerSize=function(){var e=this,t=this.owner.getDocumentEditorElement();this.updateViewerSizeInternal(t),this.owner.viewer.updateScrollBars(),this.owner.viewer instanceof $s&&!sf.base.isNullOrUndefined(this.owner)&&!sf.base.isNullOrUndefined(t)&&(this.resizerTimer&&clearTimeout(this.resizerTimer),this.resizerTimer=setTimeout((function(){if(!sf.base.isNullOrUndefined(e.owner)){var t=void 0;t=sf.base.isNullOrUndefined(e.visibleBounds)?0:e.visibleBounds.width,sf.base.isNullOrUndefined(e.owner.viewer.preVisibleWidth)&&(e.owner.viewer.preVisibleWidth=0),sf.base.isNullOrUndefined(e.visibleBounds)||t===e.owner.viewer.preVisibleWidth||(e.owner.editorModule.layoutWholeDocument(),e.owner.viewer.preVisibleWidth=t),e.resizerTimer&&clearTimeout(e.resizerTimer)}}),50)),sf.base.isNullOrUndefined(this.selection)||this.selection.updateCaretPosition()},e.prototype.updateViewerSizeInternal=function(e){if(!sf.base.isNullOrUndefined(e)){var t=e.getBoundingClientRect(),i=0,r=0;r=t.height>0?t.height:200;var n=void 0,o=void 0,s=void 0;if(this.restrictEditingElement&&(n="none"!==this.restrictEditingElement.style.display?this.restrictEditingElement.getBoundingClientRect():void 0),this.optionsPaneElement&&(o="none"!==this.optionsPaneElement.style.display?this.optionsPaneElement.getBoundingClientRect():void 0),this.commentPaneElement&&(s="none"!==this.commentPaneElement.style.display?this.commentPaneElement.getBoundingClientRect():void 0),n||o||s){var a=n?n.width:0;a+=o?o.width:0,a+=s?s.width:0,i=t.width-a>0?t.width-a:200}else i=t.width>0?t.width:200;this.viewerContainer.style.height=r.toString()+"px",this.viewerContainer.style.width=Math.ceil(i)+"px",this.visibleBoundsIn=new ia(0,0,i,r),this.containerCanvas.width=i,this.containerCanvas.height=r,this.selectionCanvas.width=i,this.selectionCanvas.height=r,this.measureScrollbarWidth(e)}},e.prototype.insertPage=function(e,t){this.pages.indexOf(t)>-1&&this.pages.splice(this.pages.indexOf(t),1),this.pages.splice(e,0,t);var i=20;e>0&&(i+=this.pages[e-1].boundingRectangle.bottom);for(var r=e;r<this.pages.length;r++)(t=this.pages[r]).boundingRectangle=new ia(t.boundingRectangle.x,i,t.boundingRectangle.width,t.boundingRectangle.height),i=t.boundingRectangle.bottom+20},e.prototype.updateTextPositionForSelection=function(e,t){var i=this.getLineWidget(e);if(sf.base.isNullOrUndefined(i)||this.selection.updateTextPosition(i,e),t>1){if(this.isMouseDown=!1,this.useTouchSelectionMark=!1,0===this.pages.length)return;sf.base.isNullOrUndefined(this.currentPage)||sf.base.isNullOrUndefined(this.owner.selection.start)||(t%2==0?this.owner.selection.selectCurrentWord():this.isDragStarted||this.owner.selection.selectParagraph())}},e.prototype.scrollToPosition=function(e,t,i,r){if(this.skipScrollToPosition||this.isWebPrinting)this.skipScrollToPosition=!1;else if(!(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizing||this.isMouseDownInFooterRegion||this.isRowOrCellResizing)){var n=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!0);if(!sf.base.isNullOrUndefined(n)){this.selection.getTop(n);if(this.isMouseDown){var o=this.selection.getLineWidgetInternal(t.currentWidget,t.offset,!1),s=this.selection.getTop(o);o!==n&&t.location.y>=s&&(n=o)}n.height;var a=this.selection.getPage(n.paragraph);this.currentPage=a;var l=0,d=0;this.owner.viewer,this.owner.viewer;if(!sf.base.isNullOrUndefined(a)){var h=a.boundingRectangle.width;(l=(this.visibleBounds.width-h*this.zoomFactor)/2)<30&&(l=30),d=a.boundingRectangle.y*this.zoomFactor+(this.pages.indexOf(a)+1)*this.owner.viewer.pageGap*(1-this.zoomFactor);var c=this.owner.viewer.containerTop,p=this.owner.viewer.containerLeft,g=this.visibleBounds.height,f=this.selection.updateCaretSize(this.owner.selection.end,!0),u=f.topMargin,m=f.height;l+=t.location.x*this.zoomFactor,d+=(t.location.y+u)*this.zoomFactor,r?this.viewerContainer.scrollTop=d-96:c+20>d?this.viewerContainer.scrollTop=d-10:c+g<d+m&&(this.viewerContainer.scrollTop=d+m-g+10),i||this.selection.updateCaretToPage(e,a);var y=this.viewerContainer.offsetWidth-this.viewerContainer.clientWidth;if(p>l)this.viewerContainer.scrollLeft=l-this.pageContainer.offsetWidth/100*20;else if(p+this.visibleBounds.width<l+y)for(this.viewerContainer.scrollLeft=p+this.pageContainer.offsetWidth/100*15+y;l<this.owner.viewer.containerWidth&&this.viewerContainer.scrollLeft+this.visibleBounds.width<l+y;)this.viewerContainer.scrollLeft=this.viewerContainer.scrollLeft+this.pageContainer.offsetWidth/100*15+y}}}},e.prototype.getLineWidget=function(e){return this.getLineWidgetInternal(e,!1)},e.prototype.getLineWidgetInternal=function(e,t){var i=void 0;if(!sf.base.isNullOrUndefined(this.currentPage)){var r=void 0;if(this.owner.enableHeaderAndFooter){var n=this.currentPage,o=n.boundingRectangle.height,s=Math.max(n.headerWidget.y+n.headerWidget.height,x.convertPointToPixel(n.bodyWidgets[0].sectionFormat.topMargin))*this.zoomFactor,a=x.convertPointToPixel(n.bodyWidgets[0].sectionFormat.footerDistance),l=n.boundingRectangle.height-Math.max(n.footerWidget.height+a,2*a);if(t?r=this.isBlockInHeader(this.selection.start.paragraph)?this.currentPage.headerWidget:this.currentPage.footerWidget:e.y<=o&&e.y>=l?r=this.currentPage.footerWidget:e.y>=0&&e.y<=s&&(r=this.currentPage.headerWidget),sf.base.isNullOrUndefined(r))return;var d=this.checkFloatingItems(r,e,t);return d.isShapeSelected?d.isInShapeBorder?d.element.line:this.selection.getLineWidgetBodyWidget(d.element.textFrame,e):this.selection.getLineWidgetBodyWidget(r,e)}for(var h=void 0,c=void 0,p=0;p<this.currentPage.bodyWidgets.length;p++){var g=this.currentPage.bodyWidgets[p];if(h=this.checkFloatingItems(g,e,t,!1),c=this.checkFloatingItems(g,e,t,!0),h.isShapeSelected||c.isShapeSelected)break}if(h.isShapeSelected&&!this.isEmptyShape(h)){if(h.isInShapeBorder)return h.element.line;h.element instanceof La&&(i=this.selection.getLineWidgetBodyWidget(h.element.textFrame,e))}else if(t&&this.isFootnoteWidget){if(void 0!==this.selection.start.paragraph.bodyWidget.footNoteReference&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof ha&&"Footnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,e);if(void 0!==this.selection.start.paragraph.bodyWidget.footNoteReference&&this.selection.start.paragraph.bodyWidget.containerWidget instanceof ha&&"Endnote"===this.selection.start.paragraph.bodyWidget.containerWidget.footNoteType)return this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,e)}else if(!t&&this.currentPage.footnoteWidget&&this.isInFootnoteWidget(this.currentPage.footnoteWidget,e))(i=this.selection.getLineWidgetBodyWidget(this.currentPage.footnoteWidget,e))&&(this.isFootnoteWidget=!0);else if(!t&&this.currentPage.endnoteWidget&&this.isInFootnoteWidget(this.currentPage.endnoteWidget,e))(i=this.selection.getLineWidgetBodyWidget(this.currentPage.endnoteWidget,e))&&(this.isFootnoteWidget=!0);else for(var f=0;f<this.currentPage.bodyWidgets.length;f++){var u=this.currentPage.bodyWidgets[f];if(f<this.currentPage.bodyWidgets.length-1&&e.x<=u.x+u.width&&(i=this.selection.getLineWidgetBodyWidget(u,e,!0),!sf.base.isNullOrUndefined(i)&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y)){this.isFootnoteWidget=!1;break}if(e.x>u.x+u.width&&this.layout.getNextWidgetHeight(u)>=e.y&&u.y<=e.y&&(sf.base.isNullOrUndefined(u.nextRenderedWidget)||!(this.layout.getNextWidgetHeight(u.nextRenderedWidget)>=e.y&&u.nextRenderedWidget.y<=e.y))&&(i=this.selection.getLineWidgetBodyWidget(u,e,!0),!sf.base.isNullOrUndefined(i)&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y)){this.isFootnoteWidget=!1;break}if(f==this.currentPage.bodyWidgets.length-1&&(i=this.selection.getLineWidgetBodyWidget(u,e,!0),!sf.base.isNullOrUndefined(i)&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y)){this.isFootnoteWidget=!1;break}if(e.x<u.x&&f<this.currentPage.bodyWidgets.length-1){if(i=this.selection.getLineWidgetBodyWidget(u,e,!0),!sf.base.isNullOrUndefined(i)&&i.paragraph.y<=e.y&&i.paragraph.y+i.paragraph.height>=e.y){this.isFootnoteWidget=!1;break}if(!sf.base.isNullOrUndefined(i)&&f===this.currentPage.bodyWidgets.length-1){this.isFootnoteWidget=!1;break}}}var m=this.checkInlineShapeItems(i,e,t);if(m.isShapeSelected){if(m.isInShapeBorder)return m.element.line;m.element instanceof La&&(i=this.selection.getLineWidgetBodyWidget(m.element.textFrame,e))}else if(!this.checkPointIsInLine(i,e)&&c.isShapeSelected){if(c.isInShapeBorder)return c.element.line;c.element instanceof La&&(i=this.selection.getLineWidgetBodyWidget(c.element.textFrame,e))}}return i},e.prototype.checkInlineShapeItems=function(e,t,i){var r,n=!1,o=!1,s=this.selection.isInShape,a=i&&s;if(!sf.base.isNullOrUndefined(e)&&e.children.length>0)if(a){var l=this.owner.selection.getCurrentTextFrame();l&&(r=l.containerShape,n=!0)}else{for(var d=0;d<e.children.length;d++)if(e.children[d]instanceof La&&"Inline"===e.children[d].textWrappingStyle&&(r=e.children[d],t.x<r.x+r.margin.left+r.width&&t.x>r.x&&t.y<r.y+r.margin.top+r.height&&t.y>r.y)){n=!0,this.isInShapeBorder(r,t)&&(o=!0);break}i&&!s&&(n=!1)}return{element:r,caretPosition:t,isShapeSelected:n,isInShapeBorder:o}},e.prototype.checkPointIsInLine=function(e,t){if(!sf.base.isNullOrUndefined(e)&&e.children.length>0)for(var i=void 0,r=e.paragraph.x,n=this.selection.getTop(e),o=e.children.indexOf(e.children[0]);o<e.children.length;o++)if(!((i=e.children[o])instanceof Ba&&"Inline"!==i.textWrappingStyle)){if(t.x<r+i.margin.left+i.width+i.padding.left&&t.x>r&&t.y<n+e.height&&t.y>n)return!0;r+=i.margin.left+i.width+i.padding.left}return!1},e.prototype.isInFootnoteWidget=function(e,t){for(var i=0;i<e.bodyWidgets.length;i++)for(var r=0;r<e.bodyWidgets[i].childWidgets.length;r++){var n=e.bodyWidgets[i].childWidgets[r];if(n instanceof oa&&n.y<=t.y&&n.y+n.height>=t.y)return!0}return!1},e.prototype.checkFloatingItems=function(e,t,i,r){var n,o=!1,s=!1,a=this.selection.isInShape,l=i&&a;if(e.floatingElements.length>0){this.currentPage;if(e.floatingElements.sort((function(e,t){return e instanceof ga||t instanceof ga?0:e.zOrderPosition-t.zOrderPosition})),l){var d=this.owner.selection.getCurrentTextFrame();d&&(n=d.containerShape,o=!0)}else{for(var h=e.floatingElements.length-1;h>=0;h--)if(!(e.floatingElements[h]instanceof ga||(!sf.base.isNullOrUndefined(r)&&r?"Behind"!==e.floatingElements[h].textWrappingStyle:"Behind"===e.floatingElements[h].textWrappingStyle))&&(n=e.floatingElements[h],t.x<n.x+n.margin.left+n.width&&t.x>n.x&&t.y<n.y+n.margin.top+n.height&&t.y>n.y)){o=!0,this.isInShapeBorder(n,t)&&(s=!0);break}i&&!a&&(o=!1)}}return{element:n,caretPosition:t,isShapeSelected:o,isInShapeBorder:s}},e.prototype.isBlockInHeader=function(e){for(;!(e.containerWidget instanceof la);){if(!e.containerWidget)return!1;(e=e.containerWidget)instanceof Aa&&(e=e.containerShape.paragraph)}return-1!==e.containerWidget.headerFooterType.indexOf("Header")},e.prototype.clearSelectionHighlight=function(){!this.isControlPressed||this.isMouseDown,this.owner.selection.clearSelectionHighlightInSelectedWidgets()&&this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height)},e.prototype.removeEmptyPages=function(){for(var e=!1,t=this.selection.startPage-1,i=0;i<this.pages.length;i++){for(var r=this.pages[i],n=0;n<r.bodyWidgets.length;n++)if((0===r.bodyWidgets.length||0===r.bodyWidgets[n].childWidgets.length)&&r.bodyWidgets.length>=1){var o=r.bodyWidgets.indexOf(r.bodyWidgets[n]);r.bodyWidgets.splice(o,1),n--}r.bodyWidgets.length<=0&&(i===this.pages.length-1&&this.owner.viewer instanceof Qs&&-1!==this.owner.viewer.visiblePages.indexOf(this.pages[i])&&(e=!0),this.removePage(this.pages[i]),i--)}sf.base.isNullOrUndefined(this.pages[t])||((r=this.pages[t]).headerWidget&&(r.headerWidget.page=r),r.footerWidget&&(r.footerWidget.page=r));e&&this.scrollToBottom()},e.prototype.scrollToBottom=function(){if(this.selection.start.paragraph&&this.selection.start.paragraph.bodyWidget){var e=this.selection.start.paragraph.bodyWidget.page,t=this.visibleBounds.height;this.viewerContainer.scrollTop=e.boundingRectangle.bottom-t}},e.prototype.getFieldResult=function(e,t){if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(e)){var i=this.selection.getFieldCode(e).split("*"),r=i[0].replace(/[^\w\s]/gi,"").trim().toLowerCase(),n="";switch(i.length>1&&" MERGEFORMAT"!==i[1]&&(n=i[1].replace(/[^\w\s]/gi,"").trim()),""==n&&(n=t.bodyWidgets[0].sectionFormat.pageNumberStyle),-1!==r.indexOf(" ")&&(r=r.split(" ")[0]),r){case"page":if(t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0!==t.sectionIndex){var o=t.sectionIndex,s=t.previousPage;return this.isRestartNumbering=!0,o!==s.sectionIndex&&s.bodyWidgets[s.bodyWidgets.length-1].sectionIndex!==o?(t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber,this.getFieldText(n,t.currentPageNum)):(1===s.currentPageNum&&o!==s.sectionIndex&&(s.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber),t.currentPageNum=s.currentPageNum+1,this.getFieldText(n,t.currentPageNum))}return t.bodyWidgets[0].sectionFormat.restartPageNumbering&&0===t.sectionIndex?(t.currentPageNum=t.bodyWidgets[0].sectionFormat.pageStartingNumber+t.index,this.getFieldText(n,t.currentPageNum)):(!sf.base.isNullOrUndefined(t.previousPage)&&(t.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering&&1===t.previousPage.currentPageNum||this.isRestartNumbering&&1!==t.previousPage.currentPageNum)?(t.previousPage.bodyWidgets[0].sectionFormat.restartPageNumbering&&(this.isRestartNumbering=!0),t.currentPageNum=t.previousPage.currentPageNum+1):t.currentPageNum=t.index+1,this.getFieldText(n,t.currentPageNum));case"numpages":return this.getFieldText(n,t.documentHelper.pages.length);case"sectionpages":for(var a=t.sectionIndex,l=0,d=0;d<t.documentHelper.pages.length;d++)if(t.documentHelper.pages[d].sectionIndex===a)l++;else if(0!==l)break;return this.getFieldText(n,l)}}return""},e.prototype.getFieldText=function(e,t){switch(e){case"ALPHABETIC":return this.layout.getAsLetter(t).toUpperCase();case"alphabetic":return this.layout.getAsLetter(t).toLowerCase();case"roman":return this.layout.getAsRoman(t).toLowerCase();case"ROMAN":case"RomanUpper":return this.layout.getAsRoman(t).toUpperCase();case"RomanLower":return this.layout.getAsRoman(t).toLowerCase();case"LetterUpper":return this.layout.getAsLetter(t).toUpperCase();case"LetterLower":return this.layout.getAsLetter(t).toLowerCase();default:return t.toString()}},e.prototype.isEmptyShape=function(e){return e.element instanceof Da||0===e.element.textFrame.childWidgets.length},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.owner)||this.unWireEvent(),this.pages=[],this.pages=void 0,this.fieldStacks=[],this.fieldStacks=void 0,this.splittedCellWidgets=[],this.splittedCellWidgets=void 0,this.fields=[],this.fields=void 0,this.layout&&this.layout.destroy(),this.layout=void 0,sf.base.isNullOrUndefined(this.render)||this.render.destroy(),this.render=void 0,this.dialogTarget1&&this.dialogTarget1.parentElement&&this.dialogTarget1.parentElement.removeChild(this.dialogTarget1),this.dialogTarget1=void 0,this.dialogTarget2&&this.dialogTarget2.parentElement&&this.dialogTarget2.parentElement.removeChild(this.dialogTarget2),this.dialogTarget2=void 0,this.dialogTarget3&&this.dialogTarget3.parentElement&&this.dialogTarget3.parentElement.removeChild(this.dialogTarget3),this.dialogTarget3=void 0,sf.base.isNullOrUndefined(this.touchStart)||(this.touchStart.innerHTML=""),this.textHelper&&this.textHelper.destroy(),this.textHelper=void 0,this.touchStart=void 0,sf.base.isNullOrUndefined(this.touchEnd)||(this.touchEnd.innerHTML=""),this.touchEnd=void 0,sf.base.isNullOrUndefined(this.containerCanvasIn)||(this.containerCanvasIn.innerHTML=""),this.containerCanvasIn=void 0,sf.base.isNullOrUndefined(this.selectionCanvasIn)||(this.selectionCanvasIn.innerHTML=""),this.selectionCanvasIn=void 0,sf.base.isNullOrUndefined(this.editableDiv)||(this.editableDiv.innerHTML="",sf.base.isNullOrUndefined(this.editableDiv.parentElement)||this.editableDiv.parentElement.removeChild(this.editableDiv)),this.editableDiv=void 0,sf.base.isNullOrUndefined(this.pageContainer)||(this.pageContainer.innerHTML=""),this.pageContainer=void 0,sf.base.isNullOrUndefined(this.viewerContainer)||(this.viewerContainer.innerHTML=""),sf.base.isNullOrUndefined(this.owner)||this.images.destroy(),sf.base.isNullOrUndefined(this.owner)||this.fontSubstitutionTable.destroy(),this.fontSubstitutionTable=void 0,this.viewerContainer=void 0,this.owner=void 0,this.heightInfoCollection=void 0,this.images=void 0,this.isRestartNumbering=!1},e.prototype.unWireEvent=function(){this.viewerContainer.removeEventListener("scroll",this.scrollHandler),this.viewerContainer.removeEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.removeEventListener("mousemove",this.onMouseMoveInternal),sf.base.Browser.isDevice?this.editableDiv.removeEventListener("input",this.onTextInputInternal):(this.editableDiv.removeEventListener("keypress",this.onKeyPressInternal),"chrome"===sf.base.Browser.info.name&&this.editableDiv.removeEventListener("textInput",this.onTextInput)),this.editableDiv.removeEventListener("paste",this.onPaste),this.viewerContainer.removeEventListener("contextmenu",this.onContextMenu),this.editableDiv.removeEventListener("blur",this.onFocusOut),this.editableDiv.removeEventListener("keydown",this.onKeyDownInternal),this.editableDiv.removeEventListener("compositionstart",this.compositionStart),this.editableDiv.removeEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.removeEventListener("compositionend",this.compositionEnd),this.viewerContainer.removeEventListener("mouseup",this.onMouseUpInternal),sf.base.isNullOrUndefined(this.iframe)||this.iframe.removeEventListener("load",this.onIframeLoad),this.viewerContainer.removeEventListener("dblclick",this.onDoubleTap),window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("keyup",this.onKeyUpInternal),window.removeEventListener("mouseup",this.onImageResizer.bind(this)),window.removeEventListener("touchend",this.onImageResizer.bind(this))},e.prototype.updateCursor=function(e){var t,i,r,n=void 0,o=void 0,s=this.viewerContainer,a=new I(e.offsetX,e.offsetY),l=this.owner.viewer.findFocusedPage(a,!0),d=this.getLineWidget(l),h=this.owner.isReadOnlyMode?void 0:this.owner.editorModule,c=!!h&&h.tableResize.isInRowResizerArea(l),p=!!h&&h.tableResize.isInCellResizerArea(l),g=this.selection.checkAllFloatingElements(d,l),f="";if(this.owner.enableImageResizerMode){var u=this.owner.imageResizerModule.getImagePoint(l);this.owner.imageResizerModule.selectedResizeElement=u.selectedElement,f=u.resizePosition}var m=0,y=void 0,v=this.checkPointIsInLine(d,l);if(!sf.base.isNullOrUndefined(d)){if(m=this.selection.getLineStartLeft(d),n=this.selection.getHyperLinkFieldInCurrentSelection(d,l),sf.base.isNullOrUndefined(n)&&(y=this.selection.getHyperLinkFieldInCurrentSelection(d,l,!0)),!sf.base.isNullOrUndefined(n)){var w=this.selection.getFieldCode(n);0!==w.toLowerCase().indexOf("ref ")||w.match("\\h")||(n=void 0)}if(t=this.selection.updateTextPositionIn(d,void 0,0,l,!0),i=this.selection.getLeft(d),r=this.selection.getTop(d),sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(y)&&this.isDocumentProtected&&"FormFieldsOnly"===this.protectionType&&!this.isFormFilling?this.selection.setHyperlinkContentToToolTip(y,d,l.x,!0):this.selection.setHyperlinkContentToToolTip(n,d,l.x,!1),y){var b=y.formFieldData instanceof ba&&"Text"===y.formFieldData.type;"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode&&b&&(y=void 0)}}sf.base.isNullOrUndefined(d)||sf.base.isNullOrUndefined(o)&&"Pages"==this.owner.layoutType&&(o=this.selection.getFootNoteElementInCurrentSelection(d,l))instanceof Wa&&this.selection.setFootnoteContentToToolTip(o,d,l.x);var x=this.isIosDevice?e.metaKey:e.ctrlKey;!sf.base.isNullOrUndefined(n)&&(x&&this.owner.useCtrlClickToFollowHyperlink||!this.owner.useCtrlClickToFollowHyperlink)||y?sf.base.isNullOrUndefined(y)?s.style.cursor="pointer":this.isFormFillProtectedMode&&(s.style.cursor="default"):(l.x>=m&&e.offsetX<this.visibleBounds.width-(this.visibleBounds.width-this.viewerContainer.clientWidth)&&e.offsetY<this.visibleBounds.height-(this.visibleBounds.height-this.viewerContainer.clientHeight)?this.selection.isEmpty?s.style.cursor="text":s.style.cursor=this.selection.checkCursorIsInSelection(d,l)?"default":"text":s.style.cursor="default",sf.base.isNullOrUndefined(f)||""===f?!sf.base.isNullOrUndefined(t)&&t.isImageSelected&&i<l.x&&r<l.y&&i+d.width>l.x&&r+d.height>l.y&&(s.style.cursor="move"):(!this.owner.imageResizerModule.isShapeResize||this.owner.imageResizerModule.isShapeResize&&"move"!==f)&&(s.style.cursor=f),c?s.style.cursor="row-resize":p&&(s.style.cursor="col-resize"),g.isInShapeBorder&&!v&&(s.style.cursor="all-scroll"))},e.prototype.canRenderBorder=function(e){var t,i,r,n,o=!1,s=!1,a=e.previousRenderedWidget,l=e.nextRenderedWidget,d=this.getParagraphLeftPosition(e),h=0,c=0;return!sf.base.isNullOrUndefined(a)&&a instanceof ca&&(h=this.getParagraphLeftPosition(a)),!sf.base.isNullOrUndefined(l)&&l instanceof ca&&(c=this.getParagraphLeftPosition(l)),!sf.base.isNullOrUndefined(a)&&a instanceof ca&&d===h&&(t=this.checkEqualBorder(e.paragraphFormat.borders.top,a.paragraphFormat.borders.top),i=this.checkEqualBorder(e.paragraphFormat.borders.bottom,a.paragraphFormat.borders.bottom),r=this.checkEqualBorder(e.paragraphFormat.borders.left,a.paragraphFormat.borders.left),n=this.checkEqualBorder(e.paragraphFormat.borders.right,a.paragraphFormat.borders.right),t&&i&&r&&n&&!sf.base.isNullOrUndefined(a.paragraphFormat.borders.horizontal)&&"None"===a.paragraphFormat.borders.horizontal.lineStyle&&(o=!0)),!sf.base.isNullOrUndefined(l)&&l instanceof ca&&(d===c||this.owner.documentHelper.layout.isInitialLoad&&this.skipBottomBorder(e,l))&&(t=this.checkEqualBorder(e.paragraphFormat.borders.top,l.paragraphFormat.borders.top),i=this.checkEqualBorder(e.paragraphFormat.borders.bottom,l.paragraphFormat.borders.bottom),r=this.checkEqualBorder(e.paragraphFormat.borders.left,l.paragraphFormat.borders.left),n=this.checkEqualBorder(e.paragraphFormat.borders.right,l.paragraphFormat.borders.right),i&&t&&r&&n&&(s=!0)),{skipTopBorder:o,skipBottomBorder:s}},e.prototype.checkEqualBorder=function(e,t){return sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t)?!(!sf.base.isNullOrUndefined(e)||!sf.base.isNullOrUndefined(t)):e.isEqualFormat(t)},e.prototype.getParagraphLeftPosition=function(e){var t=0;return e.paragraphFormat.firstLineIndent<0&&(t=x.convertPointToPixel(Math.abs(e.paragraphFormat.firstLineIndent)),t=parseFloat(t.toFixed(5))),e.isEmpty()&&("Left"!==e.paragraphFormat.textAlignment&&"Justify"!==e.paragraphFormat.textAlignment||"Justify"===e.paragraphFormat.textAlignment&&e.paragraphFormat.bidi)?e.clientX>t?e.clientX-t:e.clientX:e.x>t?e.x-t:e.x},e.prototype.skipBottomBorder=function(e,t){var i=0,r=0;return e.paragraphFormat.leftIndent===t.paragraphFormat.leftIndent||(i=e.paragraphFormat.firstLineIndent<0?Math.abs(e.paragraphFormat.firstLineIndent):0,r=t.paragraphFormat.firstLineIndent<0?Math.abs(t.paragraphFormat.firstLineIndent):0,(i=e.paragraphFormat.leftIndent>i?e.paragraphFormat.leftIndent-i:0)===(r=t.paragraphFormat.leftIndent>r?t.paragraphFormat.leftIndent-r:0))},e.prototype.isPageInVisibleBound=function(e,t){var i=this.visibleBounds.height,r=this.viewerContainer.scrollTop,n=e.boundingRectangle.height*this.zoomFactor;return t>=r&&t<=r+i||t+n>=r&&t+n<=r+i||t<=r&&t+n>=r+i},e.prototype.getFirstParagraphInCell=function(e){var t=e.childWidgets[0];return t instanceof ca?t:this.getFirstParagraphInFirstCell(t)},e.prototype.getFirstParagraphInFirstCell=function(e){if(!sf.base.isNullOrUndefined(e.childWidgets)&&e.childWidgets.length>0){var t=e.childWidgets[0].childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(t)}},e.prototype.getLastParagraphInLastCell=function(e){if(!sf.base.isNullOrUndefined(e.childWidgets)&&e.childWidgets.length>0){var t=e.lastChild.lastChild.lastChild;return this.getLastParagraphBlock(t)}},e.prototype.getFirstParagraphBlock=function(e){return e instanceof ca?e:e instanceof ga?this.getFirstParagraphInFirstCell(e):void 0},e.prototype.getLastParagraphBlock=function(e){return e instanceof ca?e:e instanceof ga?this.getLastParagraphInLastCell(e):void 0},e.prototype.getLastParagraphInFirstRow=function(e){if(e.childWidgets.length>0){var t=e.firstChild.lastChild.lastChild;return this.getLastParagraphBlock(t)}},e.prototype.getFirstParagraphInLastRow=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[e.childWidgets.length-1].childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(t)}},e}(),Zs=function(){function e(e){this.visiblePages=[],this.padding=new ra(10,10,30,10),this.textWrap=!0,this.pageFitTypeIn="None",this.containerTop=0,this.containerWidth=0,this.containerLeft=0,this.owner=e,this.columnLayoutArea=new ea(this)}return Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageFitType",{get:function(){return this.pageFitTypeIn},set:function(e){this.pageFitTypeIn=e,this.onPageFitTypeChanged(this.pageFitTypeIn)},enumerable:!0,configurable:!0}),e.prototype.updateClientArea=function(e,t,i){var r;sf.base.isNullOrUndefined(e)||(r=e.sectionFormat,this.columnLayoutArea.setColumns(r));var n=0,o=0;if(this instanceof $s){(n=(this.documentHelper.visibleBounds.width-4*this.padding.right-2*this.padding.left)/this.documentHelper.zoomFactor)<0&&(n=0),o=Number.POSITIVE_INFINITY,this.clientArea=new ia(this.padding.left/this.documentHelper.zoomFactor,0,n,o),this.clientActiveArea=new ia(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}else{var s=0,a=48,l=48,d=x.convertPointToPixel(r.pageHeight),h=x.convertPointToPixel(r.bottomMargin);sf.base.isNullOrUndefined(r)||(s=x.convertPointToPixel(r.topMargin),a=x.convertPointToPixel(r.headerDistance),l=x.convertPointToPixel(r.footerDistance));var c=!1;sf.base.isNullOrUndefined(t.headerWidget)||(c=t.headerWidget.isEmpty,s>=0?(!c||c&&this.owner.enableHeaderAndFooter)&&(s=Math.min(Math.max(a+t.headerWidget.height,s),d/100*40)):s=Math.abs(s));var p=.667+h;if(!sf.base.isNullOrUndefined(t.footerWidget)){c=t.footerWidget.isEmpty;var g=sf.base.isNullOrUndefined(t.footnoteWidget)?0:t.footnoteWidget.height;g=Math.min(g,(d-s-p)/100*90),p>=0?(!c||c&&this.owner.enableHeaderAndFooter)&&(p=.667+Math.min(d/100*40,Math.max(l+t.footerWidget.height,h))):p=Math.abs(p),p+=g}sf.base.isNullOrUndefined(r)||(n=x.convertPointToPixel(r.pageWidth-r.leftMargin-r.rightMargin),o=d-s-p),n<0&&(n=0);var f=new ia(x.convertPointToPixel(r.leftMargin),s,n,d-s-p);if(t.footnoteWidget&&!i&&0!==t.footnoteWidget.y&&this.clientArea.y+this.clientArea.height>t.footnoteWidget.y){var u=this.clientArea.y+this.clientArea.height-t.footnoteWidget.y;this.clientArea.height-=u/2}0!==e.page.bodyWidgets[0].columnIndex&&this.owner.editor.updateColumnIndex(e,!1),this.setClientArea(e,f),this.clientActiveArea=new ia(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}},e.prototype.setClientArea=function(e,t){this.clientArea=this.columnLayoutArea.getColumnBoundsByBodyWidget(e,t),e.x=this.clientArea.x,e.width=this.clientArea.width},e.prototype.updateClientAreaTopOrLeft=function(e,t){t&&(this.clientActiveArea.y=this.clientActiveArea.y+e.topBorderWidth,this.clientActiveArea.x=this.clientActiveArea.x+e.leftBorderWidth)},e.prototype.updateClientAreaForTable=function(e){this.clientActiveArea.x=this.clientArea.x=e.x,this.clientActiveArea.width=this.clientArea.width=e.width},e.prototype.updateClientAreaForRow=function(e,t){var i=e.ownerTable;t||(this.clientActiveArea.x=this.clientArea.x=i.x,this.clientActiveArea.width=this.clientArea.width=i.width,this.clientArea=new ia(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new ia(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height))},e.prototype.updateClientAreaForCell=function(e,t){var i=e.ownerRow,r=e;if(t)this.clientActiveArea.x=this.clientArea.x=r.x,this.clientActiveArea.y=r.y,this.clientActiveArea.width=this.clientArea.width=r.width>0?r.width:0,this instanceof Qs&&(this.clientActiveArea.height=Number.POSITIVE_INFINITY),this.clientArea=new ia(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new ia(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height);else{if(this.clientActiveArea.x=this.clientArea.x=r.x+r.width+r.margin.right,i.x+i.width-this.clientArea.x<0?this.clientActiveArea.width=this.clientArea.width=0:this.clientActiveArea.width=this.clientArea.width=i.x+i.width-this.clientArea.x,this.clientActiveArea.y=r.y-r.margin.top-x.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing),!e.ownerTable.isInsideTable&&(this.clientActiveArea.height=this.clientArea.bottom-i.y>0?this.clientArea.bottom-i.y:0,!e.ownerTable.wrapTextAround&&this.documentHelper.layout.existFootnoteHeight>0)){var n=this.clientActiveArea.height-this.documentHelper.layout.existFootnoteHeight;this.clientActiveArea.height=n<0?0:n}this.clientArea=new ia(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new ia(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)}},e.prototype.updateClientAreaForTextBoxShape=function(e,t,i){if("Inline"!==e.textWrappingStyle||i||(e.y=this.clientActiveArea.y,e.x=this.clientActiveArea.x),t){var r=x.convertPointToPixel(e.textFrame.marginLeft),n=x.convertPointToPixel(e.textFrame.marginRight),o=x.convertPointToPixel(e.textFrame.marginTop),s=x.convertPointToPixel(e.textFrame.marginBottom),a=e.width,l=Number.POSITIVE_INFINITY;this.clientArea=new ia(e.x+r,e.y+o,a-r-n,l-o-s),this.clientActiveArea=new ia(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)}},e.prototype.updateClientAreaByWidgetFootNote=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},e.prototype.updateClientAreaForTextWrap=function(e){this.clientActiveArea=new ia(e.x,e.y,e.width,e.height)},e.prototype.updateBoundsBasedOnTextWrap=function(e){var t=e-this.clientActiveArea.y;this.clientActiveArea.y=e,this.clientActiveArea.height=this.clientActiveArea.height-t},e.prototype.updateBoundsBasedOnTextWrapTable=function(e){var t=e-this.clientArea.y;this.clientArea.y=e,this.clientArea.height=this.clientArea.height-t,this.clientActiveArea=new ia(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},e.prototype.updateClientAreaByWidget=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},e.prototype.updateClientAreaLocation=function(e,t){e.x=t.x,e.y=t.y,e.width=t.width},e.prototype.updateClientAreaForBlock=function(e,t,i,r,n){var o=x.convertPointToPixel(e.leftIndent),s=x.convertPointToPixel(e.rightIndent),a=e.bidi,l=0;if(t)if(e instanceof ga&&i){var d=i[0];e.bodyWidget.sectionFormat.columns.length<=1&&(this.clientActiveArea.x=this.clientArea.x=d.x,this.clientActiveArea.width=this.clientArea.width=d.width),(d=i[i.length-1]).x=this.clientActiveArea.x,d.y=this.clientActiveArea.y}else{if(e instanceof ga&&!sf.base.isNullOrUndefined(e.tableFormat))if(e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Left"!==(p=this.tableAlignmentForBidi(e,a))){var h=0;h=0===(h=x.convertPointToPixel(e.tableHolder.getTotalWidth(0)))?0===e.tableHolder.tableWidth?e.getTableClientWidth(e.getOwnerWidth(!1)):e.tableHolder.tableWidth:h,this.owner.editor&&this.owner.editor.tableResize.currentResizingTable===e&&0===this.owner.editor.tableResize.resizerPosition&&(h=x.convertPointToPixel(e.tableHolder.tableWidth)),"Center"===p?(this.documentHelper.isRowOrCellResizing||(h=e.getTableCellWidth()),o=(this.clientArea.width-h)/2):o=this.clientArea.width-h,a&&(s=o-=x.convertPointToPixel(e.leftIndent)),e.isInsideTable,this.documentHelper.tableLefts.push(o)}l=this.clientArea.width-(o+x.convertPointToPixel(e.rightIndent));var c=this.clientArea.x+(a?s:o);l=l>0?l:0,this.clientActiveArea.x=this.clientArea.x=c,this.clientActiveArea.width=this.clientArea.width=l,r&&this.updateParagraphYPositionBasedonTextWrap(e,new ia(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)),n&&(e instanceof ca?this.updateParagraphXPositionBasedOnTextWrap(e):this.updateTableXPositionBasedOnTextWrap(e))}else{if(e instanceof ga&&!sf.base.isNullOrUndefined(e.tableFormat)){var p=this.tableAlignmentForBidi(e,a);e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0),"Left"!==p&&this.documentHelper.tableLefts.length>0&&(o=this.documentHelper.tableLefts.pop(),a&&(s=o))}l=this.clientArea.width+o+x.convertPointToPixel(e.rightIndent);c=this.clientArea.x-(a?s:o);l=l>0?l:0,this.clientActiveArea.x=this.clientArea.x=c,this.clientActiveArea.width=this.clientArea.width=l}this.clientArea=new ia(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new ia(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)},e.prototype.updateParagraphYPositionBasedonTextWrap=function(e,t){var i=e.bodyWidget,r=this.clientActiveArea;if(i&&i.floatingElements.length>0&&e instanceof ca&&!(e.containerWidget instanceof Aa)&&!e.isInsideTable&&!(e.containerWidget instanceof ha)){var n="Word2013"===this.documentHelper.compatibilityMode,o=e,s=o.isEmpty(),a=o.height;if(0===a&&(a=this.documentHelper.textHelper.getParagraphMarkSize(o.characterFormat).Height),!o.isInHeaderFooter||o.isInsideTable||n){var l=t.y,d=!1;i.floatingElements.sort((function(e,t){return e.y-t.y})),i.floatingElements.sort((function(e,t){return e.x-t.x}));var h=o.previousRenderedWidget;h&&h instanceof ga&&h.wrapTextAround&&!s&&!o.isContainsShapeAlone()&&n&&t.y<h.y&&(t.y=h.y);for(var c=0;c<i.floatingElements.length;c++){var p=i.floatingElements[c],g=!1;if(g=p instanceof Ba?p.paragraph.isInHeaderFooter:p.bodyWidget instanceof la,!(o.isInsideTable&&p instanceof ga)||p.isInsideTable){var f=this.getTextWrappingBound(p),u=p instanceof ga?"Square":p.textWrappingStyle,m=p instanceof ga?"Both":p.textWrappingType;if(!(r.x>f.right+24||r.right<f.x-24))if((t.y+(p instanceof ga&&!s&&0===o.floatingElements.length?a:o.height)>f.y||d)&&t.y<f.bottom&&"Inline"!==u&&"TopAndBottom"!==u&&"InFrontOfText"!==u&&"Behind"!==u){var y=0,v=x.convertPointToPixel(o.paragraphFormat.rightIndent),w=x.convertPointToPixel(o.paragraphFormat.firstLineIndent);if(w=!s&&o.childWidgets[0].isFirstLine()&&w>0?w:0,t.x>=f.x&&"Left"!==m&&(y=v),y=y<0?y:0,t.x<f.x&&t.x>f.x&&"Left"!==m)t.right>f.x&&(t.width=t.width-(t.right-f.right)),t.width<24?(!n&&p instanceof ga&&h===p||(this.updateBoundsBasedOnTextWrap(f.bottom),t=this.clientActiveArea),((!s&&o.childWidgets[0].isFirstLine()||s)&&n||!g)&&(o.y=this.clientActiveArea.y)):t.x=f.right;else if(t.x>=f.x&&t.x<f.right)if(t.width=t.width-(f.right-t.x)-y,t.width<24||d){t.width=this.clientActiveArea.right-f.right-y;var b=!1;if(t.width<24||d){if(this.clientActiveArea.x+24<f.x){var I=this.getIntersectingItemBounds(i.floatingElements,p,l);!sf.base.isNullOrUndefined(I)&&I.bottom<=f.bottom&&(this.updateBoundsBasedOnTextWrap(I.bottom),t=this.clientActiveArea,b=!0,o.x=I.x)}n&&!b&&(p instanceof ga&&h===p?this.updateBoundsBasedOnTextWrapTable(f.bottom):this.updateBoundsBasedOnTextWrap(f.bottom),t=this.clientActiveArea),((!s&&o.childWidgets[0].isFirstLine()||s)&&n||!g)&&(o.y=this.clientActiveArea.y)}else t.x=f.right}else t.x=f.right;else f.x>t.x&&t.right>f.x&&(t.width=f.x-t.x,t.width<24&&(t.width=this.clientActiveArea.right-f.right-y,t.width<24?(!n&&p instanceof ga&&h===p||(this.updateBoundsBasedOnTextWrap(f.bottom),t=this.clientActiveArea),((!s&&o.childWidgets[0].isFirstLine()||s)&&n||!g)&&(o.y=this.clientActiveArea.y)):t.x=f.right))}else i.floatingElements.length>0&&(t.y>=f.y&&t.y<f.bottom||t.y+a>=f.y&&t.y+a<f.bottom)&&"TopAndBottom"===u&&(!n&&p instanceof ga&&h===p||(this.updateBoundsBasedOnTextWrap(f.bottom),!n&&(!s&&o.childWidgets[0].isFirstLine()||s)&&(d=!0)),((!s&&o.childWidgets[0].isFirstLine()||s)&&n||!g)&&(o.y=this.clientActiveArea.y))}}}}},e.prototype.updateParagraphXPositionBasedOnTextWrap=function(e){var t="Word2013"===this.documentHelper.compatibilityMode,i=e.containerWidget,r=this.clientActiveArea;if(this instanceof Qs&&!sf.base.isNullOrUndefined(i)&&e instanceof ca&&!sf.base.isNullOrUndefined(i.page)&&!sf.base.isNullOrUndefined(i.page.headerWidget)){var n=i.page.headerWidget.floatingElements;if(n.length>0&&(!e.isInHeaderFooter||e.isInsideTable||t)&&!(e.containerWidget instanceof ha)&&!(e.bodyWidget instanceof Aa))for(var o=e,s=0;s<n.length;s++){var a=n[s];if(!(o.isInsideTable&&a instanceof ga)||a.isInsideTable){var l=this.getTextWrappingBound(a),d=a instanceof ga?"Square":a.textWrappingStyle;a instanceof ga||a.textWrappingType;if(!o.isInsideTable&&!(r.x>l.right+24||r.right<l.x-24)&&n.length>0&&r.y+o.height>l.y&&r.y<l.bottom&&"Inline"!==d&&"TopAndBottom"!==d&&"InFrontOfText"!==d&&"Behind"!==d){var h=x.convertPointToPixel(o.paragraphFormat.rightIndent);if("Left"!=o.paragraphFormat.textAlignment&&r.x<l.x&&r.x+o.width>l.x)o.x=r.x;else if(r.x>=l.x&&r.x<l.right&&!o.paragraphFormat.bidi){if(r.width=r.width-(l.right-r.x)-h,r.width<24)r.width=this.clientActiveArea.right-l.right-h,r.width<24?(o.x=r.x,r.width=r.width,r.height=l.bottom-r.x,r.y=l.bottom):r.x=l.right;else if("Word2007"===this.documentHelper.compatibilityMode||r.y<=l.bottom){x.convertPointToPixel(o.paragraphFormat.leftIndent)+x.convertPointToPixel(o.paragraphFormat.firstLineIndent)+r.x<l.right&&(r.x=l.right)}}else(l.x-24>r.x&&r.right>l.x||r.x>l.x&&r.x>l.right)&&(o.x=r.x)}}}}},e.prototype.updateTableXPositionBasedOnTextWrap=function(e){var t=x.convertPointToPixel(e.childWidgets[0].getFirstRowWidth()),i=e.bodyWidget;if(this instanceof Qs&&!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.page)&&!sf.base.isNullOrUndefined(i.page.headerWidget)){var r=i.page.headerWidget.floatingElements;if(!(!(r.length>0)||e.isInHeaderFooter&&e.isInsideTable&&"Word2013"!==this.documentHelper.compatibilityMode||e.containerWidget instanceof Aa))for(var n=this.clientActiveArea,o=0;o<r.length;o++){var s=r[o],a=this.getTextWrappingBound(s),l=s instanceof ga?"Square":s.textWrappingStyle,d=s instanceof ga?s.positioning.allowOverlap:s.allowOverlap,h=this.documentHelper.getFirstParagraphInFirstCell(e),c=this.documentHelper.textHelper.getParagraphMarkSize(h.characterFormat).Height,p=e.childWidgets[0]instanceof fa?e.childWidgets[0].height:0;p>c&&(c=p);var g=x.convertPointToPixel(e.getTableClientWidth(e.getContainerWidth()));if(!(this.clientArea.x>a.right+24||this.clientArea.right<a.x-24)&&this.isFloatingItemIntersect(e,n,a,l,d,c,g)&&n.x>=a.x&&n.x<a.right)if(n.width=n.width-(a.right-n.x),n.width<24||n.width<t&&t>0)if(n.width=this.clientActiveArea.right-a.right,n.width<24||n.width<t&&t>0&&this.clientArea.right<=t+a.right){var f=a.bottom>n.y?a.bottom-n.y:0;n.y=a.bottom,n.width=this.clientArea.width,n.height=n.height-f,this.updateClientAreaForTextWrap(n)}else n.x=a.right,this.updateClientAreaForTextWrap(n);else n.x=a.right,this.updateClientAreaForTextWrap(n)}}},e.prototype.isFloatingItemIntersect=function(e,t,i,r,n,o,s){return(Math.round(t.y+o)>=Math.round(i.y)&&Math.round(t.y)<Math.round(i.bottom)||Math.round(t.y+o)<=Math.round(i.bottom)&&Math.round(t.y+o)>=Math.round(i.y))&&"Inline"!==r&&"TopAndBottom"!==r&&"InFrontOfText"!==r&&"Behind"!==r&&!(n&&null!==e.tableFormat&&e.wrapTextAround&&e.positioning.allowOverlap)},e.prototype.getIntersectingItemBounds=function(e,t,i){var r=this.getMinBottomFloatingItem(e,this.getIntersectingFloatingItems(e,t,i));if(!sf.base.isNullOrUndefined(r))return this.getTextWrappingBound(r)},e.prototype.getMinBottomFloatingItem=function(e,t){var i=-1,r=Number.MAX_VALUE,n=0;e.sort((function(e,t){return e.x-t.x}));for(var o=0;o<t.length;o++){var s=e[o],a=this.getTextWrappingBound(s);r>a.bottom&&(s&&t.indexOf(s)+1<t.length?n++:(r=a.bottom,i=t.indexOf(s)))}return i-n==0?t[i]:null},e.prototype.getIntersectingFloatingItems=function(e,t,i){for(var r=[],n=0;n<e.length;n++){var o=e[n],s=this.getTextWrappingBound(o),a=this.getTextWrappingBound(t);i<=s.bottom&&a.bottom>=s.bottom&&s.right>this.clientActiveArea.x&&s.x<a.x&&r.push(o)}return r},e.prototype.getTextWrappingBound=function(e){var t=0,i=0,r=0,n=0,o=0;return e instanceof Ba?(t=e.distanceLeft,i=e.distanceTop,r=e.distanceRight,n=e.distanceBottom,o=e.width):(o=e.getTableCellWidth(),t=e.positioning.distanceLeft,i=e.positioning.distanceTop,r=e.positioning.distanceRight,n=e.positioning.distanceBottom),new ia(e.x-t,e.y-i,o+t+r,e.height+i+n)},e.prototype.tableAlignmentForBidi=function(e,t){var i=e.tableFormat.tableAlignment;return t&&("Left"===i?i="Right":"Right"===i&&(i="Left")),i},e.prototype.cutFromLeft=function(e){e<this.clientActiveArea.x&&(e=this.clientActiveArea.x),e>this.clientActiveArea.right&&this.textWrap&&(e=this.clientActiveArea.right),this.clientActiveArea.width=this.clientActiveArea.right>e?this.clientActiveArea.right-e:0,this.clientActiveArea.x=e},e.prototype.cutFromTop=function(e){e<this.clientActiveArea.y&&(e=this.clientActiveArea.y),e>this.clientActiveArea.bottom&&(e=this.clientActiveArea.bottom),this.clientActiveArea.height=this.clientActiveArea.bottom-e,this.clientActiveArea.x=this.clientArea.x,this.clientActiveArea.width=this.clientArea.width,this.clientActiveArea.y=e},e.prototype.updateClientWidth=function(e){this.clientActiveArea.x-=e,this.clientActiveArea.width+e>0?this.clientActiveArea.width+=e:this.clientActiveArea.width=0},e.prototype.findFocusedPage=function(e,t,i){var r=new I(e.x,e.y);r.x+=this.documentHelper.viewerContainer.scrollLeft,r.y+=this.documentHelper.viewerContainer.scrollTop;for(var n=0;n<this.documentHelper.pages.length;n++){var o=this.documentHelper.pages[n],s=(o.boundingRectangle.y-this.pageGap*(n+1))*this.documentHelper.zoomFactor+this.pageGap*(n+1),a=o.boundingRectangle.height*this.documentHelper.zoomFactor+this.pageGap,l=o.boundingRectangle.x,d=void 0;if(d=this instanceof Qs?(o.boundingRectangle.right-l)*this.documentHelper.zoomFactor+l:o.boundingRectangle.right+l,s<=r.y&&s+a>=r.y)return t&&(this.documentHelper.currentPage=o,i&&(sf.base.isNullOrUndefined(o.headerWidget)||(o.headerWidget.page=o),sf.base.isNullOrUndefined(o.footerWidget)||(o.footerWidget.page=o))),r.y=(r.y-s)/this.documentHelper.zoomFactor,r.x>d?r.x=o.boundingRectangle.right:r.x<l?r.x=0:r.x=(r.x-l)/this.documentHelper.zoomFactor,r}return r},e.prototype.getPageHeightAndWidth=function(e,t,i,r){e=0;for(var n=0;n<this.documentHelper.pages.length;n++)e+=this.documentHelper.pages[n].boundingRectangle.height;t=0;for(n=0;n<this.documentHelper.pages.length;n++)t<this.documentHelper.pages[n].boundingRectangle.width&&(t=this.documentHelper.pages[n].boundingRectangle.width);return{height:e,width:t,viewerWidth:this.documentHelper.visibleBounds.width,viewerHeight:this.documentHelper.visibleBounds.height}},e.prototype.renderVisiblePages=function(){if(!(sf.base.isNullOrUndefined(this.visiblePages)||this.visiblePages.length<1)){this.documentHelper.clearContent();for(var e=0;e<this.visiblePages.length;e++){var t=this.visiblePages[e],i=t.boundingRectangle.width*this.documentHelper.zoomFactor,r=t.boundingRectangle.height*this.documentHelper.zoomFactor,n=t.boundingRectangle.x,o=(t.boundingRectangle.y-this.pageGap*(e+1))*this.documentHelper.zoomFactor+this.pageGap*(e+1);this.owner.viewer.renderPage(t,n,o,i,r)}}},e.prototype.handleZoom=function(){var e=this.documentHelper.preZoomFactor,t=null,i=0,r=!1;if(this.documentHelper.selection&&sf.base.isNullOrUndefined(this.documentHelper.zoomX&&sf.base.isNullOrUndefined(this.documentHelper.zoomY))){var n=0,o=0,s=this.documentHelper.selection.getPage(this.documentHelper.selection.end.currentWidget.paragraph);(n=(this.documentHelper.visibleBounds.width-s.boundingRectangle.width*e)/2)<30&&(n=30),o=s.boundingRectangle.y*e+(this.documentHelper.pages.indexOf(s)+1)*this.pageGap*(1-e);var a=this.documentHelper.selection.updateCaretSize(this.owner.selection.end,!0),l=a.topMargin;a.height;n+=this.documentHelper.selection.end.location.x*e,o+=(this.documentHelper.selection.end.location.y+l)*e,n>=this.containerLeft&&n<=this.documentHelper.visibleBounds.width&&o>=this.containerTop&&o<=this.containerTop+this.documentHelper.visibleBounds.height&&(r=!0)}for(var d=0;d<this.documentHelper.pages.length;d++)i+=this.documentHelper.pages[d].boundingRectangle.height;var h=0;for(d=0;d<this.documentHelper.pages.length;d++)h<this.documentHelper.pages[d].boundingRectangle.width&&(h=this.documentHelper.pages[d].boundingRectangle.width);var c=i*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap*(1-this.documentHelper.zoomFactor)-this.documentHelper.visibleBounds.height,p=h*this.documentHelper.zoomFactor-this.documentHelper.visibleBounds.width;if(this.documentHelper.visibleBounds.width-h*this.documentHelper.zoomFactor<60&&(p+=60),c>0){var g=this.containerTop;if(this.visiblePages.length>0){var f=((t=this.visiblePages[0]).boundingRectangle.y-(t.index+1)*this.pageGap)*e+(t.index+1)*this.pageGap,u=this.documentHelper.zoomY;sf.base.isNullOrUndefined&&(u=this.documentHelper.visibleBounds.height/2);for(var m=g+u;m>f+t.boundingRectangle.height*e;){var y=t.index+1;if(y===this.documentHelper.pages.length)break;f=((t=this.documentHelper.pages[y]).boundingRectangle.y-(t.index+1)*this.pageGap)*e+(t.index+1)*this.pageGap}g=(t.boundingRectangle.y-(t.index+1)*this.pageGap)*this.documentHelper.zoomFactor+(t.index+1)*this.pageGap+(m-f<0?m-f:(m-f)*(this.documentHelper.zoomFactor/e))-u,u=this.documentHelper.visibleBounds.height/2}this.documentHelper.viewerContainer.scrollTop=g}else this.documentHelper.viewerContainer.scrollTop=0;if(p>0){g=this.containerLeft;if(this.visiblePages.length>0){null===t&&(t=this.visiblePages[0]);var v=this.documentHelper.zoomX;sf.base.isNullOrUndefined(v)&&(v=this.documentHelper.visibleBounds.width/2);var w=t.boundingRectangle.width*e/t.boundingRectangle.width,b=g+v;g=t.boundingRectangle.x+(b-t.boundingRectangle.x<0?b-t.boundingRectangle.x:(b-t.boundingRectangle.x)*(this.documentHelper.zoomFactor/w))-v,v=this.documentHelper.visibleBounds.width/2}this.documentHelper.viewerContainer.scrollLeft=g}else this.documentHelper.viewerContainer.scrollLeft=0;this.updateScrollBars(),r&&this.documentHelper.scrollToPosition(this.documentHelper.selection.start,this.documentHelper.selection.end),this instanceof $s&&this.owner.editorModule.layoutWholeDocument()},e.prototype.updateCanvasWidthAndHeight=function(e,t,i,r,n,o){this instanceof Qs?this.documentHelper.visibleBounds.width!==this.documentHelper.viewerContainer.clientWidth?e-=this.documentHelper.visibleBounds.width-this.documentHelper.viewerContainer.clientWidth:i>t&&(e-=this.documentHelper.viewerContainer.offsetWidth-this.documentHelper.viewerContainer.clientWidth):i>t&&(e-=this.documentHelper.scrollbarWidth,r-=this.documentHelper.scrollbarWidth),r>e&&(t-=this.documentHelper.scrollbarWidth),n=r>e?r:e,o=i>t?i:t,parseInt(this.documentHelper.pageContainer.style.width.replace("px",""),10)===n&&parseInt(this.documentHelper.pageContainer.style.height.replace("px",""),10)===n||(this.documentHelper.pageContainer.style.width=n.toString()+"px",this.documentHelper.pageContainer.style.height=o.toString()+"px");var s=Math.max(1,window.devicePixelRatio||1);return this.documentHelper.containerCanvas.width===Math.floor(e*s)&&this.documentHelper.containerCanvas.height===Math.floor(t*s)||(this.documentHelper.containerCanvas.width=e*s,this.documentHelper.containerCanvas.height=t*s,this.documentHelper.containerCanvas.style.width=e+"px",this.documentHelper.containerCanvas.style.height=t+"px",this.documentHelper.containerContext.scale(s,s),this.documentHelper.selectionCanvas.width=e*s,this.documentHelper.selectionCanvas.height=t*s,this.documentHelper.selectionCanvas.style.width=e+"px",this.documentHelper.selectionCanvas.style.height=t+"px",this.documentHelper.selectionContext.scale(s,s)),{height:o,width:n,viewerWidth:e,viewerHeight:t,containerHeight:i,containerWidth:r}},e.prototype.updateScrollBarPosition=function(e,t,i,r,n,o){this.owner.viewer.containerTop=this.documentHelper.viewerContainer.scrollTop,this.owner.viewer.containerWidth=e,this.documentHelper.containerCanvas.style.position="absolute",this.documentHelper.containerCanvas.style.top=this.owner.viewer.containerTop.toString()+"px",this.documentHelper.selectionCanvas.style.position="absolute",this.documentHelper.selectionCanvas.style.top=this.owner.viewer.containerTop.toString()+"px",this.owner.viewer.containerLeft=this.documentHelper.viewerContainer.scrollLeft,this.documentHelper.containerCanvas.style.left=this.owner.viewer.containerLeft+"px",this.documentHelper.selectionCanvas.style.left=this.owner.viewer.containerLeft+"px"},e.prototype.destroy=function(){this.clientArea=void 0,this.clientActiveArea=void 0},e}(),Qs=function(e){function t(t){var i=e.call(this,t)||this;return i.pageLeft=30,i.owner=t,i}return Ks(t,e),Object.defineProperty(t.prototype,"pageGap",{get:function(){return this.owner.pageGap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),t.prototype.createNewPage=function(e,t){var i=this.pageGap;this.documentHelper.pages.length>0&&(i=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom+this.pageGap);var r=new dl(this.documentHelper);return this.updatePageBoundingRectangle(e,r,i),sf.base.isNullOrUndefined(t)?this.documentHelper.pages.push(r):this.documentHelper.pages.splice(t,0,r),r.bodyWidgets.push(e),r.bodyWidgets[r.bodyWidgets.length-1].page=r,this.updateClientArea(e,r),this.documentHelper.layout.layoutHeaderFooter(e,this,r),this.updateClientArea(e,r),this.documentHelper.layout.footnoteHeight=0,r},t.prototype.updatePageBoundingRectangle=function(e,t,i){var r=sf.base.isNullOrUndefined(e.sectionFormat)?816:x.convertPointToPixel(e.sectionFormat.pageWidth),n=sf.base.isNullOrUndefined(e.sectionFormat)?1056:x.convertPointToPixel(e.sectionFormat.pageHeight),o=(this.documentHelper.visibleBounds.width-r*this.documentHelper.zoomFactor)/2;o<this.pageLeft&&(o=this.pageLeft),t.boundingRectangle=new ia(o,i,r,n)},t.prototype.onPageFitTypeChanged=function(e){var t=this.documentHelper.visibleBounds.width,i=this.documentHelper.visibleBounds.height,r=this.visiblePages[0].bodyWidgets[0],n=x.convertPointToPixel(r.sectionFormat.pageWidth),o=x.convertPointToPixel(r.sectionFormat.pageHeight);switch(e){case"FitOnePage":if(i>0&&o>0){var s=(this.documentHelper.visibleBounds.height-2*this.pageGap-(this.pageGap-2))/o;s===this.documentHelper.zoomFactor?sf.base.isNullOrUndefined(this.owner.selection)||sf.base.isNullOrUndefined(this.owner.selection.start)||sf.base.isNullOrUndefined(this.owner.selection.end)||this.documentHelper.scrollToPosition(this.owner.selection.start,this.owner.selection.end):this.documentHelper.zoomFactor=s}break;case"FitPageWidth":t>0&&n>0&&(this.documentHelper.zoomFactor=(this.documentHelper.visibleBounds.width-80)/n);break;default:this.documentHelper.zoomFactor=1}},t.prototype.getCurrentPageHeaderFooter=function(e,t){return this.getCurrentHeaderFooter(this.getHeaderFooterType(e,t),e.index)},t.prototype.getHeaderFooterType=function(e,t){var i;i=t?"OddHeader":"OddFooter";var r=e.page;return e.sectionFormat.differentFirstPage&&(sf.base.isNullOrUndefined(r.previousPage)||!sf.base.isNullOrUndefined(r.previousPage)&&r.sectionIndex!==r.previousPage.sectionIndex&&r.previousPage.bodyWidgets[r.previousPage.bodyWidgets.length-1].sectionIndex!==r.bodyWidgets[0].sectionIndex)?i=t?"FirstPageHeader":"FirstPageFooter":e.sectionFormat.differentOddAndEvenPages&&(r.index+1)%2==0&&(i=t?"EvenHeader":"EvenFooter"),i},t.prototype.getCurrentHeaderFooter=function(e,t){if(this.documentHelper.headersFooters[t]){var i=this.getHeaderFooter(e),r=this.documentHelper.headersFooters[t][i];if(!r){for(var n=t>0?t-1:t;!r&&-1!==n;)r=this.documentHelper.headersFooters[n][i],n--;r||((r=this.createHeaderFooterWidget(e)).isEmpty=!0),0==t&&(this.documentHelper.headersFooters[t][i]=r)}return r}if(t>0)return this.getCurrentHeaderFooter(e,t-1)},t.prototype.createHeaderFooterWidget=function(e){var t,i=new la(e),r=new ca;return r.childWidgets.push(new ma(r)),t=-1!==e.indexOf("Header")?this.documentHelper.styles.findByName("Header"):this.documentHelper.styles.findByName("Footer"),r.paragraphFormat.baseStyle=t,r.paragraphFormat.listFormat.baseStyle=t,i.childWidgets.push(r),r.containerWidget=i,i},t.prototype.getHeaderFooter=function(e){switch(e){case"OddHeader":return 0;case"OddFooter":return 1;case"EvenHeader":return 2;case"EvenFooter":return 3;case"FirstPageHeader":return 4;case"FirstPageFooter":return 5}},t.prototype.updateHFClientArea=function(e,t){var i=x.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin);i<0&&(i=0),this.clientArea=new ia(x.convertPointToPixel(e.leftMargin),t?x.convertPointToPixel(e.headerDistance):x.convertPointToPixel(e.pageHeight-e.footerDistance),i,Number.POSITIVE_INFINITY),this.clientActiveArea=new ia(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},t.prototype.updateHeaderFooterClientAreaWithTop=function(e,t,i){this.updateHFClientArea(e,t),t||i.footerWidget.y<this.clientActiveArea.y&&(this.clientActiveArea.y=i.footerWidget.y,this.clientActiveArea.height=Number.POSITIVE_INFINITY)},t.prototype.updateFootnoteClientArea=function(e,t,i,r){var n=x.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),o=x.convertPointToPixel(e.leftMargin),s=x.convertPointToPixel(e.bottomMargin),a=x.convertPointToPixel(e.footerDistance),l=x.convertPointToPixel(e.pageHeight)-Math.max(a+t.page.footerWidget.height,s);this.clientArea=new ia(o,l,n,Number.POSITIVE_INFINITY),this.clientActiveArea=new ia(this.clientArea.x,this.clientArea.y,this.clientArea.width,Number.POSITIVE_INFINITY)},t.prototype.scrollToPage=function(e){for(var t=0,i=0;i<this.documentHelper.pages.length&&(t=this.documentHelper.pages[i].boundingRectangle.y-this.pageGap/2,i!==e);i++);this.documentHelper.viewerContainer.scrollTop=t,this.updateScrollBars()},t.prototype.updateScrollBars=function(){var e,t,i=(e=this.getPageHeightAndWidth(0,0,0,0)).width*this.documentHelper.zoomFactor+2*this.pageLeft,r=e.height*this.documentHelper.zoomFactor+(this.documentHelper.pages.length+1)*this.pageGap;r=(t=this.updateCanvasWidthAndHeight(e.viewerWidth,e.viewerHeight,r,i,e.width,e.height)).containerHeight,i=t.containerWidth,this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4;for(var n=0;n<this.documentHelper.pages.length;n++){var o=(t.width-this.documentHelper.pages[n].boundingRectangle.width*this.documentHelper.zoomFactor)/2;o>this.pageLeft?this.documentHelper.pages[n].boundingRectangle=new ia(o,this.documentHelper.pages[n].boundingRectangle.y,this.documentHelper.pages[n].boundingRectangle.width,this.documentHelper.pages[n].boundingRectangle.height):this.documentHelper.pages[n].boundingRectangle=new ia(this.pageLeft,this.documentHelper.pages[n].boundingRectangle.y,this.documentHelper.pages[n].boundingRectangle.width,this.documentHelper.pages[n].boundingRectangle.height)}this.updateScrollBarPosition(i,r,t.viewerWidth,t.viewerHeight,t.width,t.height),this.updateVisiblePages(),this.documentHelper.isScrollToSpellCheck=!1},t.prototype.updateVisiblePages=function(){this.visiblePages=[];for(var e=0;e<this.documentHelper.pages.length;e++){var t=this.documentHelper.pages[e],i=(t.boundingRectangle.y-this.pageGap*(e+1))*this.documentHelper.zoomFactor+this.pageGap*(e+1),r=t.boundingRectangle.x;this.documentHelper.isPageInVisibleBound(t,i)&&this.addVisiblePage(t,r,i)}},t.prototype.addVisiblePage=function(e,t,i){var r=this,n=e.boundingRectangle.width*this.documentHelper.zoomFactor,o=e.boundingRectangle.height*this.documentHelper.zoomFactor;if(this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===e&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(t,i,n,o),this.visiblePages.push(e),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.spellChecker.enableOptimizedSpellCheck&&(this.owner.documentHelper.triggerElementsOnLoading||this.owner.documentHelper.isScrollHandler)&&(this.documentHelper.cachedPages.indexOf(e.index)<0||this.owner.editor.isPasteContentCheck)){this.owner.documentHelper.cachedPages.push(e.index);var s=void 0;(s=this.owner.editor.isPasteContentCheck?sf.base.isNullOrUndefined(this.owner.editor.copiedTextContent)?"":this.owner.editor.copiedTextContent:this.documentHelper.owner.spellChecker.getPageContent(e)).trim().length>0?(e.allowNextPageRendering=!1,sf.base.isNullOrUndefined(this.owner)||sf.base.isNullOrUndefined(this.owner.spellChecker)||this.owner.spellChecker.updateUniqueWords(x.getSpellCheckData(s)),this.owner.spellChecker.callSpellChecker(this.owner.spellChecker.languageID,s,!0,!1,!1,!0).then((function(s){var a=JSON.parse(s);sf.base.isNullOrUndefined(r.owner)||sf.base.isNullOrUndefined(r.owner.spellChecker)||r.owner.spellChecker.updateUniqueWords(a.SpellCollection),e.allowNextPageRendering=!0,r.documentHelper.triggerSpellCheck=!0,r.documentHelper.triggerElementsOnLoading=!0,r.renderPage(e,t,i,n,o),r.documentHelper.triggerSpellCheck=!1,r.documentHelper.triggerElementsOnLoading=!1}))):this.renderPage(e,t,i,n,o)}else this.renderPage(e,t,i,n,o)},t.prototype.renderPage=function(e,t,i,r,n){this.documentHelper.render.renderWidgets(e,t-this.owner.viewer.containerLeft,i-this.owner.viewer.containerTop,r,n)},t}(Zs),$s=function(e){function t(t){var i=e.call(this,t)||this;return i.visiblePages=[],i.owner=t,i}return Ks(t,e),Object.defineProperty(t.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pageGap",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.createNewPage=function(e,t){var i,r=0;return this.documentHelper.pages.length>0&&(r=this.documentHelper.pages[this.documentHelper.pages.length-1].boundingRectangle.bottom),i=new dl(this.documentHelper),0===this.documentHelper.pages.length?i.boundingRectangle=new ia(10,r,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height):i.boundingRectangle=new ia(10,r-20,this.documentHelper.visibleBounds.width,this.documentHelper.visibleBounds.height),this.documentHelper.pages.push(i),this.updateClientArea(void 0,i),i.bodyWidgets.push(e),i.bodyWidgets[i.bodyWidgets.length-1].page=i,i},t.prototype.onPageFitTypeChanged=function(e){this.documentHelper.zoomFactor=1},t.prototype.scrollToPage=function(e){this.updateScrollBars()},t.prototype.getContentHeight=function(){for(var e=0,t=0;t<this.documentHelper.pages.length;t++){var i=this.documentHelper.pages[t];0===t?(e+=this.padding.top,i.boundingRectangle.y=this.padding.top):i.boundingRectangle.y=this.documentHelper.pages[t-1].boundingRectangle.bottom,i.boundingRectangle.height=i.bodyWidgets[0].height,e+=i.bodyWidgets[0].height,t===this.documentHelper.pages.length-1&&(e+=this.padding.bottom)}return e},t.prototype.getContentWidth=function(){for(var e=this.documentHelper.visibleBounds.width,t=e,i=0;i<this.documentHelper.pages.length;i++){for(var r=this.documentHelper.pages[i],n=0;n<r.bodyWidgets[0].childWidgets.length;n++)if(r.bodyWidgets[0].childWidgets[n]instanceof ga){var o=r.bodyWidgets[0].childWidgets[n],s=x.convertPointToPixel(o.getTableWidth())*this.documentHelper.zoomFactor+4*this.padding.left+4*this.padding.right+r.boundingRectangle.x;t<s&&(e=s,t=s)}r.boundingRectangle.width=e}return e},t.prototype.updateScrollBars=function(){var e;e=this.getPageHeightAndWidth(0,0,0,0);var t,i=this.getContentWidth()*this.documentHelper.zoomFactor+this.padding.left+this.padding.right,r=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom;t=this.updateCanvasWidthAndHeight(e.viewerWidth,e.viewerHeight,r,i,e.width,e.height),this.documentHelper.containerContext.globalAlpha=1,this.documentHelper.selectionContext.globalAlpha=.4,this.updateScrollBarPosition(i,r,t.viewerWidth,t.viewerHeight,t.width,t.height),this.updateVisiblePages(),this.documentHelper.isScrollToSpellCheck=!1},t.prototype.updateVisiblePages=function(){var e,t;this.visiblePages=[];for(var i=this.documentHelper.visibleBounds.height,r=this.documentHelper.viewerContainer.scrollTop,n=0;n<this.documentHelper.pages.length;n++){t=(e=this.documentHelper.pages[n]).boundingRectangle.y*this.documentHelper.zoomFactor;var o=e.boundingRectangle.height*this.documentHelper.zoomFactor;(t>=r&&t<=r+i||t+o>=r&&t+o<=r+i||t<=r&&t+o>=r+i)&&this.addVisiblePage(e,this.padding.left,t)}},t.prototype.addVisiblePage=function(e,t,i){var r=this,n=this.getContentWidth(),o=this.getContentHeight()*this.documentHelper.zoomFactor+this.padding.top+this.padding.bottom;if(this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===e&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(t,i,n,o),this.visiblePages.push(e),this.documentHelper.owner.isSpellCheck&&this.documentHelper.owner.spellChecker.enableOptimizedSpellCheck&&(this.owner.documentHelper.triggerElementsOnLoading||this.owner.documentHelper.isScrollHandler)&&(this.documentHelper.cachedPages.indexOf(e.index)<0||this.owner.editor.isPasteContentCheck)){this.owner.documentHelper.cachedPages.push(e.index);var s=void 0;(s=this.owner.editor.isPasteContentCheck?sf.base.isNullOrUndefined(this.owner.editor.copiedTextContent)?"":this.owner.editor.copiedTextContent:this.documentHelper.owner.spellChecker.getPageContent(e)).trim().length>0?(e.allowNextPageRendering=!1,sf.base.isNullOrUndefined(this.owner)||sf.base.isNullOrUndefined(this.owner.spellChecker)||this.owner.spellChecker.updateUniqueWords(x.getSpellCheckData(s)),this.owner.spellChecker.callSpellChecker(this.owner.spellChecker.languageID,s,!0,!1,!1,!0).then((function(s){var a=JSON.parse(s);sf.base.isNullOrUndefined(r.owner)||sf.base.isNullOrUndefined(r.owner.spellChecker)||r.owner.spellChecker.updateUniqueWords(a.SpellCollection),e.allowNextPageRendering=!0,r.owner.documentHelper.triggerSpellCheck=!0,r.owner.documentHelper.triggerElementsOnLoading=!0,r.renderPage(e,t,i,n,o),r.owner.documentHelper.triggerSpellCheck=!1,r.owner.documentHelper.triggerElementsOnLoading=!1}))):this.renderPage(e,t,i,n,o)}else this.renderPage(e,t,i,n,o)},t.prototype.renderPage=function(e,t,i,r,n){this.documentHelper.render.renderWidgets(e,t-this.owner.viewer.containerLeft,i-this.owner.viewer.containerTop,r,n)},t}(Zs),ea=function(){function e(e){this.viewerIn=e,this.clear()}return Object.defineProperty(e.prototype,"currentIndex",{get:function(){return this.currentIndexIn},set:function(e){e>=0&&(this.currentIndexIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnCount",{get:function(){var e;return sf.base.isNullOrUndefined(this.columnIn)||(e=this.numberOfColumnsIn),e=e>0?e:1},enumerable:!0,configurable:!0}),e.prototype.setColumns=function(e){if(this.pageWidth=x.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin),this.numberOfColumnsIn=e.numberOfColumns,!sf.base.isNullOrUndefined(e.columns)){for(var t=e.columns,i=[],r=0;r<e.numberOfColumns;r++){var n=this.defaultSpaceIn,o=0;!sf.base.isNullOrUndefined(t)&&t.length>0&&(n=t[r].space,o=t[r].width);var s=this.getColumnObj(o,n,e.numberOfColumns,e.equalWidth);s.index=r,i.push(s)}this.columnIn=i}},e.prototype.clear=function(){this.currentIndexIn=0,this.defaultSpaceIn=36,this.columnIn=null,this.pageWidth=0},e.prototype.reset=function(){this.currentIndex=0},e.prototype.getColumnBounds=function(e,t){var i=this.currentIndexIn;return this.getColumnBoundsByIndex(i,t)},e.prototype.getColumnBoundsByBodyWidget=function(e,t){var i=e.columnIndex;return this.getColumnBoundsByIndex(i,t)},e.prototype.getNextColumnByBodyWidget=function(e){var t=e.columnIndex;return this.getColumnByIndex(t+1)},e.prototype.getColumnByIndex=function(e){if(e>=0&&e<this.columnCount&&!sf.base.isNullOrUndefined(this.columnIn)&&this.columnIn.length>0)return this.columnIn[e]},e.prototype.getColumnObj=function(e,t,i,r){var n=(i-1)*t,o=new c;return!r&&0!==e||sf.base.isNullOrUndefined(this.pageWidth)||(e=(this.pageWidth-n)/i),o.width=e,o.space=t,o},e.prototype.getColumnBoundsByIndex=function(e,t){var i=new ia(t.x,t.y,t.width,t.height);if(e>=0&&this.columnIn.length>0){var r=void 0,n=void 0;if(!sf.base.isNullOrUndefined(this.columnIn[e])){r=this.getColumnByIndex(e),i.width=r.width;for(var o=0;o<e;o++)n=this.columnIn[o],i.x+=n.width,i.x+=n.space}}return i},e}(),ta=(v=function(e,t){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ia=function(){function e(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r}return Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),e.prototype.isIntersecting=function(e){return!(e.y>this.bottom||this.y>e.bottom||e.x>this.right||this.x>e.right)},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e}(),ra=function(e,t,i,r){this.right=10,this.left=10,this.top=10,this.bottom=10,this.right=e,this.left=t,this.top=i,this.bottom=r},na=function(){function e(e,t,i,r){this.left=e,this.top=t,this.right=i,this.bottom=r}return e.prototype.clone=function(){return new e(this.left,this.top,this.right,this.bottom)},e.prototype.destroy=function(){this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0},e}(),oa=function(){function e(){this.childWidgets=[],this.x=0,this.y=0,this.width=0,this.height=0,this.index=0}return Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this instanceof aa&&this.page?this.containerWidget instanceof ha?this.containerWidget.bodyWidgets.indexOf(this):this.page.bodyWidgets.indexOf(this):this.containerWidget&&this.containerWidget.childWidgets?this.containerWidget.childWidgets.indexOf(this):this instanceof ha?0:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childWidgets.length>0?this.childWidgets[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){if(this.childWidgets)return this.childWidgets.length>0?this.childWidgets[this.childWidgets.length-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousWidget",{get:function(){var e=this,t=this.indexInOwner;return e=e instanceof aa?t>0?e.page.bodyWidgets[t-1]:void 0:t>0?e.containerWidget.childWidgets[t-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextWidget",{get:function(){var e=this,t=this.indexInOwner;if(-1!==t)return e=e instanceof aa?t<e.page.bodyWidgets.length-1?e.page.bodyWidgets[t+1]:void 0:t<e.containerWidget.childWidgets.length-1?e.containerWidget.childWidgets[t+1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousRenderedWidget",{get:function(){var e=this,t=this.indexInOwner;if(!(t<0)){if(e instanceof aa)if(t>0&&!(e.containerWidget instanceof ha))e=e.page.bodyWidgets[t-1];else if(e.containerWidget instanceof ha&&!e.page.documentHelper.owner.editor.removeEditRange){if(t<=0)return;e=e.containerWidget.bodyWidgets[t-1]}else{e=(i=e.page.previousPage)&&i.bodyWidgets.length>0?i.bodyWidgets[i.bodyWidgets.length-1]:void 0}else if(e instanceof ha)for(var i=e.page;i.previousPage&&(e=(i=i.previousPage).footnoteWidget,sf.base.isNullOrUndefined(e)););else if(t>0)e=e.containerWidget.childWidgets[t-1];else{var r=void 0;for(e.containerWidget instanceof ua?r=e.containerWidget.getPreviousSplitWidget():e.containerWidget&&e.containerWidget.containerWidget instanceof ha&&"Endnote"===e.containerWidget.containerWidget.footNoteType?r=e.containerWidget.previousWidget?e.containerWidget.previousWidget:e.containerWidget.previousRenderedWidget:e.containerWidget instanceof fa||e.containerWidget instanceof la||e.containerWidget&&e.containerWidget.containerWidget instanceof ha||(r=e.containerWidget.previousRenderedWidget);r&&0===r.childWidgets.length&&(r=r.previousRenderedWidget,!sf.base.isNullOrUndefined(r)););e=r&&r.constructor===e.containerWidget.constructor?r.lastChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextRenderedWidget",{get:function(){var e=this,t=this.indexInOwner;if(!(t<0)){if(e instanceof aa)if(t<e.page.bodyWidgets.length-1&&!(e.containerWidget instanceof ha))e=e.page.bodyWidgets[t+1];else if(e.containerWidget instanceof ha){if(t>=e.containerWidget.bodyWidgets.length-1&&!e.page.documentHelper.owner.editor.removeEditRange)return;e=e.containerWidget.bodyWidgets[t+1]}else if(e.page.allowNextPageRendering){e=(i=e.page.nextPage)&&i.bodyWidgets.length>0?i.bodyWidgets[0]:void 0}else e=void 0;else if(e instanceof ha)for(var i=e.page;i.allowNextPageRendering&&i.nextPage&&(e=(i=i.nextPage).footnoteWidget,sf.base.isNullOrUndefined(e)););else if(t<e.containerWidget.childWidgets.length-1)e=e.containerWidget.childWidgets[t+1];else{var r=void 0;for(e.containerWidget instanceof ua?r=e.containerWidget.getNextSplitWidget():e.containerWidget&&e.containerWidget.containerWidget instanceof ha&&"Endnote"===e.containerWidget.containerWidget.footNoteType?r=e.containerWidget.nextWidget?e.containerWidget.nextWidget:e.containerWidget.nextRenderedWidget:e.containerWidget instanceof fa||e.containerWidget instanceof la||e.containerWidget&&e.containerWidget.containerWidget instanceof ha||(r=e.containerWidget.nextRenderedWidget);r&&0===r.childWidgets.length&&!(r instanceof ua)&&(r=r.nextRenderedWidget,!sf.base.isNullOrUndefined(r)););e=r&&r.constructor===e.containerWidget.constructor?r.firstChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousSplitWidget",{get:function(){if(this instanceof ua)return this.getPreviousSplitWidget();var e=this.previousRenderedWidget;return this instanceof aa&&e instanceof aa&&this.equals(e)||e instanceof da&&this.index===e.index&&this.equals(e)?e:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextSplitWidget",{get:function(){if(this instanceof ua)return this.getNextSplitWidget();var e=this.nextRenderedWidget;return this instanceof aa&&e instanceof aa&&this.equals(e)||e instanceof da&&this.index===e.index&&this.equals(e)?e:void 0},enumerable:!0,configurable:!0}),e.prototype.getPreviousSplitWidgets=function(){for(var e=[],t=this.previousSplitWidget;t&&(e.unshift(t),!(t=t.previousSplitWidget)||t!=t.previousSplitWidget););return e},e.prototype.getSplitWidgets=function(){for(var e=this.getPreviousSplitWidgets(),t=this;t;)e.push(t),t=t.nextSplitWidget;return e},e.prototype.combineWidget=function(e){var t=this,i=this.getSplitWidgets();if(i.length>1)for(t=i.shift();i.length>0;){var r=i.shift();t.combine(r,e)}return t instanceof ga&&t.combineRows(e),t},e.prototype.combine=function(t,i){if(t.childWidgets.length>0){var r=this.lastChild;if(r instanceof ga)r.combineWidget(i);else{var n=t.firstChild;!(t instanceof ga)&&r instanceof e&&n instanceof e&&r.index===n.index&&r.combine(t.childWidgets.shift(),i)}this.addWidgets(t.childWidgets),t.childWidgets=[]}t.destroyInternal(i)},e.prototype.addWidgets=function(t){for(;t.length>0;){var i=t.shift();if(i instanceof ma&&this instanceof ca)i.paragraph=this,this.height+=i.height;else if(i instanceof e){var r=this.lastChild;i.containerWidget=this,i.y=r instanceof e?r.y+r.height:this.y,this.height+=i.height}if(i instanceof fa)for(var n=this.childWidgets[this.childWidgets.length-1],o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];if(s.cellFormat.rowSpan>1)for(var a=0;a<i.childWidgets.length;a++){var l=i.childWidgets[a];if(l.columnIndex===s.columnIndex&&l.isSplittedCell&&l.cellFormat.rowSpan===s.cellFormat.rowSpan){for(var d=0;d<l.childWidgets.length;d++){var h=l.childWidgets[d];l.childWidgets.splice(h.indexInOwner,1),s.childWidgets.push(h),h.containerWidget=s,d--}l.ownerRow.childWidgets.splice(l.indexInOwner,1),l.containerWidget=void 0,a--}}}this.childWidgets.push(i)}},e.prototype.removeChild=function(e){e>-1&&e<this.childWidgets.length&&this.childWidgets.splice(e,1)},e.prototype.destroy=function(){if(this.childWidgets)for(;this.childWidgets.length>0;){var t=this.childWidgets.pop();(t instanceof ma||t instanceof e)&&t.destroy()}this.childWidgets=void 0,this.containerWidget&&this.containerWidget.removeChild(this.indexInOwner),this.containerWidget=void 0,this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.index=void 0},e}(),sa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.floatingElements=[],t.footNoteReference=void 0,t.sectionFormatIn=void 0,t.columnIndex=0,t}return ta(t,e),Object.defineProperty(t.prototype,"sectionFormat",{get:function(){return this instanceof aa?this.sectionFormatIn:this.page&&!sf.base.isNullOrUndefined(this.page.bodyWidgets)?this.page.bodyWidgets[0].sectionFormat:void 0},set:function(e){this instanceof aa&&(this.sectionFormatIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sectionIndex",{get:function(){var e=0;return this instanceof aa?e=this.index:this.page&&(e=this.page.bodyWidgets[0].index),e},enumerable:!0,configurable:!0}),t.prototype.getHierarchicalIndex=function(e){return e=this instanceof aa?this.index+";"+e:this instanceof ha?"Footnote"===this.footNoteType?"FN;"+e:"EN;"+e:-1!==this.headerFooterType.indexOf("Header")?"H;"+e:"F;"+e,sf.base.isNullOrUndefined(this.page)?e:this.page.documentHelper.pages.indexOf(this.page)+";"+e},t}(oa),aa=function(e){function t(){return e.call(this)||this}return ta(t,e),t.prototype.equals=function(e){return e instanceof t&&e.sectionFormat===this.sectionFormat},t.prototype.getHierarchicalIndex=function(e){return this.containerWidget instanceof ha?(e=this.containerWidget.bodyWidgets.indexOf(this)+";"+e,e="Footnote"===this.containerWidget.footNoteType?"FN;"+e:"EN;"+e):e=this.page&&-1!==this.page.bodyWidgets.indexOf(this)?this.page.bodyWidgets.indexOf(this)+";"+e:this.index+";"+e,sf.base.isNullOrUndefined(this.page)?e:this.page.documentHelper.pages.indexOf(this.page)+";"+e},t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t]instanceof ga){var i=this.childWidgets[t],r=0;if(i.wrapTextAround&&(r=i.getTableCellWidth()),!i.wrapTextAround&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e);if(i.wrapTextAround&&i.x<=e.x&&i.x+r>=e.x&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e)}var n=void 0;return this.childWidgets.length>0&&(n=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),n},t.prototype.destroyInternal=function(e){this.height;if(!sf.base.isNullOrUndefined(this.childWidgets)){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];if(i.destroyInternal(e),sf.base.isNullOrUndefined(this.childWidgets))break;t--}this.childWidgets=void 0}if(!sf.base.isNullOrUndefined(this.page)){var r=this.indexInOwner;this.indexInOwner>-1&&(this.page.bodyWidgets.splice(r,1),0===this.page.bodyWidgets.length?this.page.destroy():this instanceof la&&this.page.headerWidget===this?this.page.headerWidget=void 0:this instanceof la&&this.page.footerWidget===this&&(this.page.footerWidget=void 0),this.page=void 0)}this.destroy()},t.prototype.destroy=function(){this.sectionFormat=void 0,this.page&&this.page.headerWidgetIn&&(this.page.headerWidgetIn.page=void 0),this.page&&this.page.footerWidgetIn&&(this.page.footerWidgetIn.page=void 0),this.page=void 0,e.prototype.destroy.call(this)},t}(sa),la=function(e){function t(t){var i=e.call(this)||this;return i.isEmpty=!1,i.headerFooterType=t,i}return ta(t,e),t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t]instanceof ga){var i=this.childWidgets[t],r=0;if(i.wrapTextAround&&(r=i.getTableCellWidth()),!i.wrapTextAround&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e);if(i.wrapTextAround&&i.x<=e.x&&i.x+r>=e.x&&i.y<=e.y&&i.y+i.height>=e.y)return i.getTableCellWidget(e)}var n=void 0;return this.childWidgets.length>0&&(n=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),n},t.prototype.equals=function(e){return e instanceof t&&e.containerWidget===this.containerWidget},t.prototype.clone=function(){for(var e=new t(this.headerFooterType),i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.index=i,r.containerWidget=e}return e.isEmpty=this.isEmpty,e.x=this.x,e.y=this.y,e.height=0,e.width=0,e},t.prototype.destroyInternal=function(t){this.page=void 0,e.prototype.destroy.call(this)},t}(sa),da=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isLayouted=!1,t.isFieldCodeBlock=!1,t.locked=!1,t.lockedBy="",t}return ta(t,e),Object.defineProperty(t.prototype,"bodyWidget",{get:function(){for(var e=this;e.containerWidget;){if(e.containerWidget instanceof Aa){var t=e.containerWidget.containerShape.line.paragraph;if(t)return t.bodyWidget}else if(e.containerWidget instanceof sa)return e.containerWidget;e=e.containerWidget}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftIndent",{get:function(){return this instanceof ca&&this.paragraphFormat instanceof ul?this.paragraphFormat.leftIndent:this instanceof ga&&this.tableFormat instanceof Fl?this.tableFormat.leftIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightIndent",{get:function(){return this instanceof ca&&this.paragraphFormat instanceof ul?this.paragraphFormat.rightIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInsideTable",{get:function(){return this.containerWidget instanceof ua},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInHeaderFooter",{get:function(){return this.bodyWidget instanceof la},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"associatedCell",{get:function(){if(this.containerWidget instanceof ua)return this.containerWidget},enumerable:!0,configurable:!0}),t.prototype.isPageBreak=function(){var e=!1;if(this instanceof ca){if(null!=this&&1===this.childWidgets.length&&1===this.firstChild.children.length)e=this.firstChild.children[0].isPageBreak}return e},t.prototype.isColumnBreak=function(){var e=!1;if(this instanceof ca){if(null!=this&&1===this.childWidgets.length&&1===this.firstChild.children.length)e=this.firstChild.children[0].isColumnBreak}return e},t.prototype.getHierarchicalIndex=function(e){if(e=this.containerWidget.childWidgets.indexOf(this)+";"+e,!sf.base.isNullOrUndefined(this.containerWidget)){if(this.containerWidget instanceof Aa)return this.containerWidget.getHierarchicalIndex(e);if(this.containerWidget instanceof t)return this.containerWidget.getHierarchicalIndex(e);this.containerWidget instanceof sa&&(e=this.containerWidget.getHierarchicalIndex(e))}return e},t.prototype.getIndex=function(){return this instanceof ca||this instanceof ga?this.containerWidget.childWidgets.indexOf(this):this instanceof fa?this.ownerTable.childWidgets.indexOf(this):this instanceof ua?this.ownerRow.childWidgets.indexOf(this):0},t.prototype.getContainerWidth=function(){if(this.isInsideTable){if(this instanceof ga&&"Auto"===this.tableFormat.preferredWidthType&&this.associatedCell.ownerTable.isGridUpdated){for(var e=0,t=this.associatedCell.cellFormat.columnSpan,i=this.associatedCell.columnIndex,r=0;r<t;r++)e+=this.associatedCell.ownerTable.tableHolder.columns[i].preferredWidth,i++;if(e>0)return e}return this.associatedCell.getCellWidth(this)}if(this.containerWidget instanceof Aa){var n=this.containerWidget.containerShape;return x.convertPixelToPoint(n.width)-x.convertPixelToPoint(n.textFrame.marginLeft)-x.convertPixelToPoint(n.textFrame.marginRight)}var o=this.bodyWidget,s=o.sectionFormat,a=0;if(!sf.base.isNullOrUndefined(o.page)&&!sf.base.isNullOrUndefined(o.page.documentHelper)&&"Word2013"!==o.page.documentHelper.compatibilityMode&&!this.isInsideTable&&this instanceof ga){var l=this.firstChild;a=l.firstChild.leftMargin+l.lastChild.rightMargin}if(o instanceof aa&&s.columns.length>1){var d=o.columnIndex;return x.convertPixelToPoint(s.columns[d].width)}return s.pageWidth-(s.leftMargin+s.rightMargin)+a},Object.defineProperty(t.prototype,"bidi",{get:function(){return this instanceof ca&&this.paragraphFormat instanceof ul?this.paragraphFormat.bidi:this instanceof ga&&this.tableFormat instanceof Fl&&this.tableFormat.bidi},enumerable:!0,configurable:!0}),t}(oa),ha=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bodyWidgets=[],t}return ta(t,e),t.prototype.getMinimumAndMaximumWordWidth=function(e,t){throw new Error("Method not implemented.")},t.prototype.getTableCellWidget=function(e){},t.prototype.equals=function(e){return e instanceof t&&e.containerWidget===this.containerWidget},t.prototype.clone=function(){for(var e=new t,i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.index=i,r.containerWidget=e}return e.block=this.block,e},t.prototype.destroyInternal=function(t){this.block=void 0,e.prototype.destroy.call(this)},t}(sa),ca=function(i){function r(){var e=i.call(this)||this;return e.isSectionBreak=!1,e.isChangeDetected=!1,e.isCreatedUsingHtmlSpanTag=void 0,e.clientX=void 0,e.floatingElements=[],e.paragraphFormat=new ul(e),e.characterFormat=new T(e),e}return ta(r,i),Object.defineProperty(r.prototype,"isEndsWithPageBreak",{get:function(){return this.childWidgets.length>0&&this.lastChild.isEndsWithPageBreak},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isEndsWithColumnBreak",{get:function(){return this.childWidgets.length>0&&this.lastChild.isEndsWithColumnBreak},enumerable:!0,configurable:!0}),r.prototype.equals=function(e){return e instanceof r&&e.paragraphFormat===this.paragraphFormat},r.prototype.isContainsShapeAlone=function(){for(var e=!1,t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],r=0;r<i.children.length;r++){var n=i.children[r];if(!(n instanceof Ba)||n instanceof Ba&&"Inline"===n.textWrappingStyle)return!1;e=!0}return!!e},r.prototype.isEmpty=function(){if(sf.base.isNullOrUndefined(this.childWidgets)||0===this.childWidgets.length)return!0;for(var e=0;e<this.childWidgets.length;e++)for(var t=this.childWidgets[e],i=0;i<t.children.length;i++){var r=t.children[i];if(0!==r.length&&(r instanceof Fa||r instanceof Da||r instanceof Na||r instanceof qa||r instanceof _a||r instanceof ja||r instanceof La||r instanceof Oa||r instanceof va&&x.isLinkedFieldCharacter(r)))return!1}return!0},r.prototype.getInline=function(e,t){for(var i=void 0,r=0,n=!1,o=this.getSplitWidgets(),s=0;s<o.length;s++)for(var a=o[s],l=0;l<a.childWidgets.length;l++)for(var d=a.childWidgets[l],h=0;h<d.children.length;h++)if(!((i=d.children[h])instanceof Va)){if((!n&&(i instanceof Fa||i instanceof Da||i instanceof La||i instanceof Na||i instanceof va&&x.isLinkedFieldCharacter(i))||i instanceof ja)&&(n=!0),n&&e<=r+i.length)return{element:i,index:t=e-r};r+=i.length}return e>r&&(t=sf.base.isNullOrUndefined(i)?e:i.length),{element:i,index:t}},r.prototype.getLength=function(){for(var e=0,t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],r=0;r<i.children.length;r++){var n=i.children[r];n instanceof Va||(e+=n.length)}return e},r.prototype.getTableCellWidget=function(e){},r.prototype.getMinimumAndMaximumWordWidth=function(e,t){if(e=x.convertPointToPixel(e),t=x.convertPointToPixel(t),this.childWidgets.length>0){for(var i=this.childWidgets[0].children[0],r="",n=new a,o=[];;){if(i instanceof Fa&&""!==i.text)n.add(i,r.length),r+=i.text;else if(i instanceof va&&0===i.fieldType){var s=i;sf.base.isNullOrUndefined(s.fieldEnd)||(i=sf.base.isNullOrUndefined(s.fieldSeparator)?s.fieldEnd:s.fieldSeparator)}else i instanceof Da&&o.push(i.width);if(sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.nextNode))break;i=i.nextNode}for(var l=new RegExp("\\b\\w+\\b","g"),d=[],h=void 0;!sf.base.isNullOrUndefined(h=l.exec(r));)d.push(h);for(var c=0;c<d.length;c++){var p=d[c],g=0;r="";for(var f="",u=0,m=p.index,y=p.index,v=0;v<n.keys.length;v++){var w=n.keys[v],b=n.get(w),I=w.length;if(y<=b+I&&(u=y-b,p.index+p[0].length<=b+I?m=p.index+p[0].length-(b+u):y+=m=I-u,f+=r=w.text.substring(u,u+m)),""!==r&&(g+=this.bodyWidget.page.documentHelper.textHelper.getWidth(r,w.characterFormat,w.scriptType)),f===p[0])break}0!==g&&(0===e||g>e)&&(e=g)}var F=0;o.length>0&&(F=Math.max.apply(null,o)),(0===e||F>e)&&(e=F);var C=this.measureParagraph();(0===t||C>t)&&(t=C)}var W=0;if(!this.isEmpty()&&0==this.floatingElements.length&&!sf.base.isNullOrUndefined(this.paragraphFormat)&&this.paragraphFormat.leftIndent>0&&!sf.base.isNullOrUndefined(this.associatedCell)&&!sf.base.isNullOrUndefined(this.associatedCell.cellFormat)&&"Point"===this.associatedCell.cellFormat.preferredWidthType){var k=this.paragraphFormat.leftIndent+this.paragraphFormat.firstLineIndent;k+e>this.associatedCell.cellFormat.preferredWidth&&(W=k)}return{maximumWordWidth:x.convertPixelToPoint(t),minimumWordWidth:x.convertPixelToPoint(e)+W}},r.prototype.measureParagraph=function(){for(var e=0,t=this.childWidgets[0].children[0];;){if(t instanceof Fa&&""!==t.text)e+=this.bodyWidget.page.documentHelper.textHelper.getWidth(t.text,t.characterFormat,t.scriptType);else if(t instanceof va&&0===t.fieldType){var i=t;null!=i.fieldEnd&&(t=sf.base.isNullOrUndefined(i.fieldSeparator)?i.fieldEnd:i.fieldSeparator)}else t instanceof Da&&(e+=t.width);if(sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.nextNode))break;t=t.nextNode}return this.leftIndent>0&&(e+=this.leftIndent),this.rightIndent>0&&(e+=this.rightIndent),e},r.prototype.isArabicChar=function(e){return e>=String.fromCharCode(1536)&&e<=String.fromCharCode(1791)||e>=String.fromCharCode(1872)&&e<=String.fromCharCode(1919)||e>=String.fromCharCode(2208)&&e<=String.fromCharCode(2303)||e>=String.fromCharCode(64336)&&e<=String.fromCharCode(65023)||e>=String.fromCharCode(65136)&&e<=String.fromCharCode(65279)},r.prototype.isHebrewChar=function(e){return e>=String.fromCharCode(1424)&&e<=String.fromCharCode(1535)||e>=String.fromCharCode(64285)&&e<=String.fromCharCode(64335)},r.prototype.isHindiChar=function(e){return e>=String.fromCharCode(2304)&&e<=String.fromCharCode(2431)||e>=String.fromCharCode(43232)&&e<=String.fromCharCode(43263)||e>=String.fromCharCode(7376)&&e<=String.fromCharCode(7423)},r.prototype.isKoreanChar=function(e){return e>=String.fromCharCode(44032)&&e<=String.fromCharCode(55203)||e>=String.fromCharCode(4352)&&e<=String.fromCharCode(4607)||e>=String.fromCharCode(12592)&&e<=String.fromCharCode(12687)||e>=String.fromCharCode(43360)&&e<=String.fromCharCode(43391)||e>=String.fromCharCode(55216)&&e<=String.fromCharCode(55295)||e>=String.fromCharCode(44032)&&e<=String.fromCharCode(55215)},r.prototype.isJapanese=function(e){return e>=String.fromCharCode(12448)&&e<=String.fromCharCode(12543)||e>=String.fromCharCode(12352)&&e<=String.fromCharCode(12447)},r.prototype.isThaiCharacter=function(e){return e>=String.fromCharCode(3584)&&e<=String.fromCharCode(3711)},r.prototype.isChineseChar=function(e){return e>=String.fromCharCode(19968)&&e<=String.fromCharCode(40959)||e>=String.fromCharCode(13312)&&e<=String.fromCharCode(19903)||e>=String.fromCharCode(55360)&&e<=String.fromCharCode(55401)||e>=String.fromCharCode(56320)&&e<=String.fromCharCode(57055)||e>=String.fromCharCode(43360)&&e<=String.fromCharCode(43391)||e>=String.fromCharCode(65280)&&e<=String.fromCharCode(65519)||e>=String.fromCharCode(12288)&&e<=String.fromCharCode(12351)},r.prototype.getFontScriptType=function(e){return this.isHindiChar(e)?t.Hindi:this.isKoreanChar(e)?t.Korean:this.isJapanese(e)?t.Japanese:this.isChineseChar(e)?t.Chinese:this.isArabicChar(e)?t.Arabic:this.isHebrewChar(e)?t.Hebrew:this.isThaiCharacter(e)?t.Thai:t.English},r.prototype.splitTextByFontScriptType=function(e,i){var r=[];if(sf.base.isNullOrUndefined(e)||!sf.base.isNullOrUndefined(e)&&""===e)return r;for(var n="",o=t.English,s=t.English,a=/[\uD800-\uDFFF]/,l=0;l<e.length;l++)e[l]==String.fromCharCode(32)||a.test(e[l])||(s=this.getFontScriptType(e[l])),""!=n&&s!==o&&(r.push(n),i.push(o),n=""),n+=e[l],o=s;return""!=n&&(r.push(n),i.push(s),n=""),r},r.prototype.splitTextRangeByScriptType=function(e){var t=!1,i=1;if(this.childWidgets.length>0){for(var r=this.childWidgets[e],n=e+1;n<this.childWidgets.length;n++){for(var o=this.childWidgets[n],s=0;s<o.children.length;s++){var a=o.children[s];r.children.push(a),a.line=r}this.childWidgets.splice(n,1),n--}for(n=0;n<r.children.length;n+=i){var l=r.children[n];i=1;var d=void 0;if(l instanceof Fa&&(d=l),l instanceof va&&0==l.fieldType?t=!0:l instanceof va&&2===l.fieldType&&(t=!1),null!=d&&!t){var h=[],c=this.splitTextByFontScriptType(d.text,h);if(c.length>1)for(var p=0;p<c.length;p++){var g=c[p];if(p>0){var f=d.clone();f.text=g,f.scriptType=h[p],r.children.splice(n+p,0,f),f.line=r,i++,d.revisions.length>0&&this.updateTextElementInRevisionRange(d,f)}else d.text=g,d.scriptType=h[p]}else c.length>0&&(d.scriptType=h[0]);h.length=0}}}},r.prototype.splitLtrAndRtlText=function(e){var t={value:null},i=1,r={value:null},n=[],o=!1,s=this.bodyWidget.page.documentHelper.textHelper;if(this.childWidgets.length>0){for(var a=this.childWidgets[e],l=0;l<a.children.length;l+=i){var d=a.children[l];i=1;var h=void 0;if(d instanceof Fa&&(h=d),d instanceof va&&0==d.fieldType?o=!0:d instanceof va&&2===d.fieldType&&(o=!1),null!=h&&!o){var c=h.text,p=h.characterFormat.bidi,g=!1,f=n.length;p&&(g=s.isRightToLeftLanguage(d.characterFormat.localeIdBidi));var u=s.splitTextByConsecutiveLtrAndRtl(c,p,g,n,t,r);if(u.length>1)for(var m=0;m<u.length;m++)if(c=u[m],m>0){var y=h.clone();y.text=c,y.characterRange=n[m+f],a.children.splice(l+m,0,y),y.line=a,i++,h.revisions.length>0&&this.updateTextElementInRevisionRange(h,y)}else h.text=c,h.characterRange=n[f];else u.length>0&&(h.characterRange=n[f])}}n.length=0}},r.prototype.updateTextElementInRevisionRange=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i],n=r.range.indexOf(e);r.range.splice(n+1,0,t),t.revisions.push(r),t.removedIds=[]}},r.prototype.combineconsecutiveRTL=function(i){for(var r=!1,n=this.bodyWidget.page.documentHelper.textHelper,o=i;o<this.childWidgets.length;o++)for(var s=this.childWidgets[o],a=0;a<=s.children.length-2;a++){var l=s.children[a];if(l instanceof va&&0===l.fieldType?r=!0:l instanceof va&&2===l.fieldType&&(r=!1),!r&&l instanceof Fa&&s.children[a+1]instanceof Fa){var d=l,h=s.children[a+1];((d.characterFormat.complexScript&&d.scriptType==h.scriptType||d.characterFormat.bidi&&d.scriptType!==t.Hebrew&&d.characterRange==e.RightToLeft&&h.characterRange==e.RightToLeft)&&d.text.length>0&&h.text.length>0&&!n.isWordSplitChar(d.text[d.text.length-1])&&!n.isWordSplitChar(h.text[0])&&d.characterFormat.isEqualFormat(h.characterFormat)&&this.compareRevisions(d.revisions,h.revisions)||d.characterRange==e.RightToLeft&&h.characterRange==e.RightToLeft&&d.text.length>0&&h.text.length>0&&n.isWordSplitChar(d.text[d.text.length-1])&&n.isWordSplitChar(h.text[0])&&d.characterFormat.isEqualFormat(h.characterFormat)&&this.compareRevisions(d.revisions,h.revisions))&&(d.text=d.text+h.text,s.children.splice(a+1,1),a--)}}},r.prototype.compareRevisions=function(e,t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0},r.prototype.clone=function(){var e=new r;e.paragraphFormat.copyFormat(this.paragraphFormat),e.characterFormat.copyFormat(this.characterFormat);for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t].clone();e.childWidgets.push(i);for(var n=0;n<i.children.length;n++){var o=i.children[n];(o instanceof Da&&"Inline"!==o.textWrappingStyle||o instanceof La)&&e.floatingElements.push(o)}i.paragraph=e}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e.absoluteXPosition=sf.base.isNullOrUndefined(this.absoluteXPosition)?void 0:{width:this.absoluteXPosition.width,x:this.absoluteXPosition.x},this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},r.prototype.destroyInternal=function(e){var t=this.height;if(!sf.base.isNullOrUndefined(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){if(this.childWidgets[i].destroy(),1===this.childWidgets.length&&sf.base.isNullOrUndefined(this.childWidgets[0].children)&&(this.childWidgets=void 0),sf.base.isNullOrUndefined(this.childWidgets))break;i--}this.childWidgets=void 0}sf.base.isNullOrUndefined(this.containerWidget)||sf.base.isNullOrUndefined(this.containerWidget.childWidgets)||-1===this.containerWidget.childWidgets.indexOf(this)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=t,this.containerWidget=void 0),this.hasOwnProperty("absoluteXPosition")&&delete this.absoluteXPosition,this.destroy()},r.prototype.destroy=function(){this.paragraphFormat=void 0,this.characterFormat=void 0,i.prototype.destroy.call(this)},r}(da),pa=function(){function e(){}return e.prototype.clone=function(){var t=new e;return t.allowOverlap=this.allowOverlap,t.distanceTop=this.distanceTop,t.distanceRight=this.distanceRight,t.distanceLeft=this.distanceLeft,t.distanceBottom=this.distanceBottom,t.verticalAlignment=this.verticalAlignment,t.verticalOrigin=this.verticalOrigin,t.verticalPosition=this.verticalPosition,t.horizontalAlignment=this.horizontalAlignment,t.horizontalOrigin=this.horizontalOrigin,t.horizontalPosition=this.horizontalPosition,t},e}(),ga=function(e){function t(){var t=e.call(this)||this;return t.flags=0,t.leftMargin=0,t.topMargin=0,t.rightMargin=0,t.bottomMargin=0,t.isDefaultFormatUpdated=!1,t.isContainInsideTable=!1,t.footnoteElement=[],t.margin=new na(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.topBorderWidth=0,t.bottomBorderWidth=0,t.tableFormat=new Fl(t),t.tableHolder=new hl,t.spannedRowCollection=new a,t}return ta(t,e),Object.defineProperty(t.prototype,"isGridUpdated",{get:function(){return(4&this.flags)>>2!=0},set:function(e){this.flags=251&this.flags|(e?1:0)<<2},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"continueHeader",{get:function(){return(2&this.flags)>>1!=0},set:function(e){this.flags=253&this.flags|(e?1:0)<<1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"header",{get:function(){return 0!=(1&this.flags)},set:function(e){this.flags=254&this.flags|(e?1:0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBidiTable",{get:function(){return(16&this.flags)>>4!=0},set:function(e){this.flags=239&this.flags|(e?1:0)<<4},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.tableFormat===this.tableFormat},t.prototype.combineRows=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];0===i.childWidgets.length?(i.destroy(),t--):i.combineCells(e)}},t.prototype.contains=function(e){if(this.equals(e.ownerTable))return!0;for(;e.ownerTable.isInsideTable;){if(this.equals(e.ownerTable))return!0;e=e.ownerTable.associatedCell}return this.equals(e.ownerTable)},t.prototype.getOwnerWidth=function(e){var t=this.getContainerWidth();return(t=t-this.leftIndent-this.rightIndent)>=0?t:0},t.prototype.getTableWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++){for(var i=0,r=this.childWidgets[t],n=0;n<r.childWidgets.length;n++)i+=r.childWidgets[n].cellFormat.cellWidth;e<i&&(e=i)}return e},t.prototype.getTableCellWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++){for(var i=0,r=this.childWidgets[t],n=0;n<r.childWidgets.length;n++){var o=r.childWidgets[n],s=o.width;0===s&&((s=o.cellFormat.cellWidth)>o.cellFormat.preferredWidth&&0!==o.cellFormat.preferredWidth&&"Percent"!==o.cellFormat.preferredWidthType&&(s=o.cellFormat.preferredWidth),s=x.convertPointToPixel(s-(o.margin.left+o.margin.right))),i+=s+o.margin.left+o.margin.right}e<i&&(e=i)}return e},t.prototype.getTableClientWidth=function(e){var t=e;return"Point"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0?t=this.tableFormat.preferredWidth:"Percent"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0&&(t=t*this.tableFormat.preferredWidth/100),t},t.prototype.getCellWidth=function(e,t,i,r){var n=e;return"Percent"===t?n=e*i/100:"Point"===t?n=e:sf.base.isNullOrUndefined(r)||(n=this.getMinimumPreferredWidth(r)),n},t.prototype.getMinimumPreferredWidth=function(e){return 0===e.cellFormat.preferredWidth&&0!==e.cellFormat.cellWidth?e.cellFormat.cellWidth:e.getMinimumPreferredWidth()},t.prototype.fitCellsToClientArea=function(e){for(var t=e/this.getTableWidth(),i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i];r.rowFormat.gridAfterWidth*=t,r.rowFormat.gridBeforeWidth*=t;for(var n=0;n<r.childWidgets.length;n++)r.childWidgets[n].cellFormat.cellWidth*=t,r.childWidgets[n].cellFormat.preferredWidth*=t}},t.prototype.getTableCellWidget=function(e){for(var t=void 0,i=0;i<this.childWidgets.length;i++)if(this.childWidgets[i].y<=e.y&&this.childWidgets[i].y+this.childWidgets[i].height>=e.y){t=this.childWidgets[i].getTableCellWidget(e);break}return t},t.prototype.calculateGrid=function(e){var t=[],i=[],r=[],n=this.getOwnerWidth(!0),o=this.getTableClientWidth(n);this.tableCellInfo=new a;for(var s=0;s<this.childWidgets.length;s++){var l=this.childWidgets[s],d=new a,h=l.rowFormat,c=l.rowFormat.gridBefore,p=0;t.indexOf(p)<0&&(t.push(p),i.push(p)),p+=this.getCellWidth(h.gridBeforeWidth,h.gridBeforeWidthType,o,null);var g=parseFloat(p.toFixed(2));t.indexOf(g)<0&&(t.push(g),i.push(p));for(var f=0;f<l.childWidgets.length;f++){for(var u=l.childWidgets[f],m=0;m<r.length;m++)if(!(r[m].columnIndex<c)){var y=r[m].cellFormat.rowSpan,v=!0;r[m].columnIndex>c?(v=!1,f===l.childWidgets.length-1&&l.rowFormat.gridAfter>0&&(p+=this.getCellWidth(r[m].cellFormat.preferredWidth,r[m].cellFormat.preferredWidthType,o,null))):(p+=this.getCellWidth(r[m].cellFormat.preferredWidth,r[m].cellFormat.preferredWidthType,o,null),c=r[m].columnIndex+r[m].cellFormat.columnSpan),v||f!==l.childWidgets.length-1||(v=!0),v&&s-r[m].ownerRow.rowIndex==y-1&&(r.splice(m,1),m--)}if(u.cellFormat.rowSpan>1)if(0===r.length||r[r.length-1].columnIndex<=c)r.push(u);else for(var w=r.length;w>0;w--)r[w-1].columnIndex>c&&r.splice(w-1,0,u);d.containsKey(u.cellIndex)||d.add(u.cellIndex,parseFloat((p-g).toFixed(2))),c+=u.cellFormat.columnSpan,p+=this.getCellWidth(u.cellFormat.preferredWidth,u.cellFormat.preferredWidthType,o,null);var b=parseFloat(p.toFixed(2));t.indexOf(b)<0&&(t.push(b),i.push(p)),f===l.childWidgets.length-1&&h.gridAfter>0&&(p+=this.getCellWidth(h.gridAfterWidth,"Point",o,null),t.indexOf(parseFloat(p.toFixed(2)))<0&&(t.push(parseFloat(p.toFixed(2))),i.push(p)),c+=h.gridAfter),this.tableCellInfo.containsKey(l.rowIndex)||this.tableCellInfo.add(l.rowIndex,d)}}t.sort((function(e,t){return e-t})),i.sort((function(e,t){return e-t})),this.tableHolder.columns.length>0&&(t.length-1!==this.tableHolder.columns.length||e)&&this.updateColumnSpans(t,o,i),this.tableCellInfo.clear(),this.tableCellInfo=void 0},t.prototype.updateColumnSpans=function(e,t,i){for(var r=0;r<this.childWidgets.length;r++){var n=this.childWidgets[r];n.rowFormat.gridBeforeWidth>=0&&(n.rowFormat.gridBefore=n.getGridCount(e,void 0,-1,t,i));for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o],a=n.getGridCount(e,s,s.getIndex(),t,i);a>0&&s.cellFormat.columnSpan!==a&&(s.cellFormat.columnSpan=a)}n.rowFormat.gridAfterWidth>=0&&(n.rowFormat.gridAfter=n.getGridCount(e,void 0,n.childWidgets.length,t,i))}},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){this.checkTableColumns();var i=this.tableHolder.isAllColumnHasPointWidthType(),r=i?this.tableHolder.getTotalWidth(0):this.tableHolder.getTotalWidth(1);return r>e&&(e=r),i||(r=this.tableHolder.getTotalWidth(2)),r>t&&(t=r),{minimumWordWidth:e,maximumWordWidth:t}},t.prototype.checkTableColumns=function(){this.isGridUpdated||((this.isAutoFit()||0===this.tableHolder.columns.length)&&this.buildTableColumns(),this.isGridUpdated=!1)},t.prototype.isAutoFit=function(){var e=this.bodyWidget;return!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(e.page)&&e.page.documentHelper.layout.getParentTable(this).tableFormat.allowAutoFit},t.prototype.buildTableColumns=function(){if(!this.isGridUpdated){this.tableHolder.resetColumns();var e,t=0,i=[],r="Auto"===this.tableFormat.preferredWidthType,n=this.tableFormat.allowAutoFit;t=!(!sf.base.isNullOrUndefined(this.bodyWidget.page)&&this.bodyWidget.page.viewer instanceof $s&&n)||this.isInsideTable||this.containerWidget instanceof Aa?this.getOwnerWidth(!0):x.convertPixelToPoint(this.bodyWidget.page.viewer.clientArea.width-3*this.bodyWidget.page.viewer.padding.right),t=this.tableFormat.preferredWidth>t?this.tableFormat.preferredWidth:t;var o=r&&0===this.tableFormat.preferredWidth&&!n;e=this.getTableClientWidth(t);var s=this.getContainerWidth();o&&!this.isDefaultFormatUpdated&&n&&this.splitWidthToTableCells(e,o);for(var a=!1,l=0;l<this.childWidgets.length;l++){var d=this.childWidgets[l],h=d.rowFormat,c=0,p=0,g=new pl,f=0;!(h.gridBefore>0)||0===d.rowFormat.beforeWidth&&0===d.rowFormat.gridBeforeWidth||this.bodyWidget.page.documentHelper.alignTablesRowByRow&&!("Left"===d.ownerTable.tableFormat.tableAlignment||"Word2003"===this.bodyWidget.page.documentHelper.compatibilityMode&&d.ownerTable.firstChild.rowFormat.gridAfter>0)||(p=this.getCellWidth(h.gridBeforeWidth,d.rowFormat.gridAfterWidthType,e,null),g.minimumWidth=p,this.tableHolder.addColumns(c,c=h.gridBefore,p,g,f=p,"Point"));for(var u=0;u<d.childWidgets.length;u++){var m=d.childWidgets[u];(m.cellFormat.rowSpan>1||m.cellFormat.columnSpan>1)&&(a=!0),0===i.length&&(m.columnIndex=c);for(var y=0;y<i.length;y++){var v=i[y];if(v.columnIndex<c)m.columnIndex=c;else{var w,b=!0;w=v.cellFormat.rowSpan,v.columnIndex>c?(m.columnIndex=c,b=!1):(g=v.getCellSizeInfo(n),p=this.getCellWidth(v.cellFormat.preferredWidth,v.cellFormat.preferredWidthType,e,v),this.tableHolder.columns.length>0?(this.tableHolder.addColumns(c,c=this.tableHolder.columns.indexOf(v.ownerColumn)+v.cellFormat.columnSpan,p,g,f+=p,m.cellFormat.preferredWidthType),m.columnIndex=c):(this.tableHolder.addColumns(c,c=v.columnIndex+v.cellFormat.columnSpan,p,g,f+=p,m.cellFormat.preferredWidthType),m.columnIndex=c)),b||u!==d.childWidgets.length-1||(b=!0),b&&l-v.ownerRow.rowIndex==w-1&&(i.splice(y,1),y--)}}if(m.cellFormat.rowSpan>1)if(0===i.length||i[i.length-1].columnIndex<=c)i.push(m);else{for(var I=0,F=i.length;F>0;F--)i[F-1].columnIndex>c&&(I=F-1);i.splice(I,0,m)}g=m.getCellSizeInfo(n),p=this.getCellWidth(m.cellFormat.preferredWidth,m.cellFormat.preferredWidthType,e,m),this.tableHolder.addColumns(c,c+=m.cellFormat.columnSpan,p,g,f+=p,m.cellFormat.preferredWidthType),u===d.childWidgets.length-1&&h.gridAfterWidth>0&&(p=this.getCellWidth(h.gridAfterWidth,"Point",e,null),g.minimumWordWidth=g.maximumWordWidth=g.minimumWidth=p,this.tableHolder.addColumns(c,c+=h.gridAfter,p,g,f+=p,"Point"))}}o&&!this.isDefaultFormatUpdated&&(this.isDefaultFormatUpdated=!0),this.tableHolder.validateColumnWidths(),n?this.tableHolder.autoFitColumn(t,e,r,this.isInsideTable,n,a,this.leftIndent+this.rightIndent,s):this.tableHolder.fitColumns(t,e,r,n,this.leftIndent+this.rightIndent),this.setWidthToCells(e,r)}},t.prototype.setWidthToCells=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i],n=r.rowFormat;n.gridBefore>0&&(n.beforeWidth=this.tableHolder.getCellWidth(0,n.gridBefore,e));for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];s.cellFormat.cellWidth=this.tableHolder.getCellWidth(s.columnIndex,s.cellFormat.columnSpan,e)}n.gridAfter>0&&(n.afterWidth=this.tableHolder.getCellWidth(0,n.gridAfter,e))}},t.prototype.updateProperties=function(e,t,i){if(e&&(this.tableFormat.allowAutoFit="FixedColumnWidth"!==i),this===t)if("FixedColumnWidth"===i){this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto";for(var r=0;r<this.childWidgets.length;r++)for(var n=this.childWidgets[r],o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];s.cellFormat.preferredWidthType="Point",s.cellFormat.preferredWidth=s.cellFormat.cellWidth}}else if("FitToWindow"===i){var a=this.tableHolder.getTotalWidth(0);this.tableFormat.leftIndent=0,this.tableFormat.preferredWidth=100,this.tableFormat.preferredWidthType="Percent";for(r=0;r<this.childWidgets.length;r++)for(var l=this.childWidgets[r],d=0;d<l.childWidgets.length;d++){"Percent"!==(h=l.childWidgets[d]).cellFormat.preferredWidthType&&(h.cellFormat.preferredWidthType="Percent",h.cellFormat.preferredWidth=h.cellFormat.cellWidth/a*100)}}else{this.tableFormat.preferredWidth=0,this.tableFormat.preferredWidthType="Auto";for(r=0;r<this.childWidgets.length;r++){(l=this.childWidgets[r]).rowFormat.beforeWidth=0,l.rowFormat.gridBefore=0,l.rowFormat.gridBeforeWidth=0,l.rowFormat.gridBeforeWidthType="Auto",l.rowFormat.afterWidth=0,l.rowFormat.gridAfter=0,l.rowFormat.gridAfterWidth=0,l.rowFormat.gridAfterWidthType="Auto";for(o=0;o<l.childWidgets.length;o++){var h;(h=l.childWidgets[o]).cellFormat.preferredWidth=0,h.cellFormat.preferredWidthType="Auto"}}}else t.updateProperties(!1,t,i)},t.prototype.getMaxRowWidth=function(e){for(var t=0,i=0;i<this.childWidgets.length;i++){for(var r=this.childWidgets[i],n=0,o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[o];n+=this.getCellWidth(s.cellFormat.preferredWidth,s.cellFormat.preferredWidthType,e,s)}t<n&&(t=n)}return t},t.prototype.updateWidth=function(e){var t=this.tableHolder.getTotalWidth(0),i=this.getOwnerWidth(!0),r=this.getTableClientWidth(i);if(r<=t&&"Auto"===this.tableFormat.preferredWidthType&&(this.tableFormat.preferredWidthType="Point"),"Auto"!==this.tableFormat.preferredWidthType)if("Point"===this.tableFormat.preferredWidthType)this.tableFormat.preferredWidth=this.getMaxRowWidth(r);else{var n=t/i*100;this.tableFormat.preferredWidth=n}},t.prototype.convertPointToPercent=function(e,t){var i=0;return i=e/t*100,(i=Math.round(i))<100?i:100},t.prototype.updateChildWidgetLeft=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i];r.x=e,r.updateChildWidgetLeft(e,t)}},t.prototype.shiftWidgetsForRtlTable=function(e,t){var i=t.x,r=e.right,n=0;t.tableFormat&&t.tableFormat.cellSpacing>0&&(n=t.tableFormat.cellSpacing);for(var o=0;o<t.childWidgets.length;o++)for(var s=t.childWidgets[o],a=r-(s.x-i),l=0;l<s.childWidgets.length;l++){var d=s.childWidgets[l];a-=d.width+d.margin.left+d.margin.right-d.rightBorderWidth+n,d.updateWidgetLeft(a+d.margin.left)}},t.prototype.clone=function(){var e=new t;e.tableHolder=this.tableHolder.clone(),e.tableFormat.copyFormat(this.tableFormat),this.wrapTextAround&&(e.wrapTextAround=this.wrapTextAround,e.positioning=this.positioning.clone());for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.containerWidget=e,r.index=i}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e.isBidiTable=this.isBidiTable,e.containerWidget=this.containerWidget,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.getTableOf=function(e){if(e instanceof g){var i=fa.getRowOf(e);return sf.base.isNullOrUndefined(i)?e.ownerBase instanceof Fl&&e.ownerBase.ownerBase instanceof t?e.ownerBase.ownerBase:void 0:i.ownerTable}},t.prototype.fitChildToClientArea=function(){var e=this.getContainerWidth();Math.round(e)<Math.round(this.getTableWidth())&&this.fitCellsToClientArea(e);for(var i=0;i<this.childWidgets.length;i++)for(var r=this.childWidgets[i],n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=0;s<o.childWidgets.length;s++)o.childWidgets[s]instanceof t&&o.childWidgets[s].fitChildToClientArea()},t.prototype.getColumnCellsForSelection=function(e,t){for(var i=[],r=e.columnIndex,n=t.columnIndex+t.cellFormat.columnSpan,o=0;o<this.childWidgets.length;o++)for(var s=this.childWidgets[o],a=0;a<s.childWidgets.length;a++){var l=s.childWidgets[a],d=l.columnIndex,h=l.cellFormat.columnSpan;d+h>r&&d+h<n||d>r&&d<n||d>r&&d<n&&d+h<n||d<r&&d+h>n?i.indexOf(l)<0&&i.push(l):d!==r&&d+h!==n||i.indexOf(l)<0&&i.push(l)}return i},t.prototype.splitWidthToTableCells=function(e,t){for(var i=0;i<this.childWidgets.length;i++)this.childWidgets[i].splitWidthToRowCells(e,t)},t.prototype.insertTableRowsInternal=function(e,t,i){for(var r=e.length-1;r>=0;r--){var n=e.splice(r,1)[0];n.containerWidget=this,this.childWidgets.splice(t,0,n)}this.updateRowIndex(t),this.isGridUpdated=!1,i&&(this.calculateGrid(!0),this.buildTableColumns()),this.isGridUpdated=!0},t.prototype.updateRowIndex=function(e){for(var t=e;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.index=t;for(var r=0;r<i.childWidgets.length;r++)i.childWidgets[r].index=r,i.childWidgets[r].rowIndex=i.rowIndex;e++}},t.prototype.getCellStartOffset=function(e){var t=0;if(e&&this.tableCellInfo&&this.tableCellInfo.containsKey(e.ownerRow.rowIndex)){var i=this.tableCellInfo.get(e.ownerRow.rowIndex);i.containsKey(e.cellIndex)&&(t=i.get(e.cellIndex))}return t},t.prototype.destroyInternal=function(e){var t=this.height;if(!sf.base.isNullOrUndefined(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){var r=void 0;if(r=this.childWidgets[i],sf.base.isNullOrUndefined(r)||r.destroyInternal(e),sf.base.isNullOrUndefined(this.childWidgets))break;i--}this.childWidgets=void 0}sf.base.isNullOrUndefined(this.containerWidget)||(this.containerWidget instanceof aa&&-1!==this.containerWidget.floatingElements.indexOf(this)&&this.containerWidget.floatingElements.splice(this.containerWidget.floatingElements.indexOf(this),1),sf.base.isNullOrUndefined(this.containerWidget.childWidgets)||(-1!==this.containerWidget.childWidgets.indexOf(this)&&this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=t),this.containerWidget=void 0),this.destroy()},t.prototype.destroy=function(){this.tableFormat=void 0,this.spannedRowCollection&&this.spannedRowCollection.destroy(),this.spannedRowCollection=void 0,this.tableHolder=void 0,this.flags=void 0,this.leftMargin=void 0,this.topMargin=void 0,this.rightMargin=void 0,this.bottomMargin=void 0,this.headerHeight=void 0,this.isDefaultFormatUpdated=void 0,e.prototype.destroy.call(this)},t}(da),fa=function(e){function t(){var t=e.call(this)||this;return t.isRenderBookmarkEnd=!1,t.topBorderWidth=0,t.bottomBorderWidth=0,t.rowFormat=new k(t),t.editRangeID=new a,t}return ta(t,e),Object.defineProperty(t.prototype,"rowIndex",{get:function(){return this.containerWidget?this.containerWidget.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof ga)return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextRow",{get:function(){var e=this.indexInOwner;if(e>-1&&e<this.ownerTable.childWidgets.length-1)return this.ownerTable.childWidgets[e+1]},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.rowFormat===this.rowFormat},t.prototype.combineCells=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];if(i.combineWidget(e),sf.base.isNullOrUndefined(i.cellFormat)||1!==i.cellFormat.rowSpan)sf.base.isNullOrUndefined(i.cellFormat)&&t--;else{i.height,i.margin.top,i.margin.bottom;this.height-this.ownerTable.tableFormat.cellSpacing<i.height&&(this.height=this.ownerTable.tableFormat.cellSpacing+i.height)}}},t.getRowOf=function(e){if(e instanceof g){var i=ua.getCellOf(e);return sf.base.isNullOrUndefined(i)?e.ownerBase instanceof k&&e.ownerBase.ownerBase instanceof t?e.ownerBase.ownerBase:void 0:i.ownerRow}},t.prototype.getCell=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i];if(r.rowIndex===e&&r.index===t)return r}},t.prototype.getCellUsingColumnIndex=function(e,t){for(var i,r=0;r<this.childWidgets.length;r++)if((i=this.childWidgets[r]).rowIndex===e&&i.columnIndex===t)return i;if(i=this.getCell(e,t),!sf.base.isNullOrUndefined(i))return i},t.prototype.splitWidthToRowCells=function(e,t){for(var i=this.childWidgets,r=e/i.length,n=0;n<i.length;n++)if(t&&0===i[n].cellFormat.preferredWidth)i[n].cellFormat.preferredWidth=r,this.ownerTable.isDefaultFormatUpdated=!1;else{if(t){this.ownerTable.isDefaultFormatUpdated=!0;break}i[n].cellFormat.preferredWidth=r}},t.prototype.getGridCount=function(e,t,i,r,n){var o=0,s=0,a=this.ownerTable,l=this.rowFormat;-1===i?s=a.getCellWidth(l.gridBeforeWidth,l.gridBeforeWidthType,r,null):(o+=a.getCellWidth(l.gridBeforeWidth,l.gridBeforeWidthType,r,null),i>=0&&(o+=a.getCellStartOffset(t)),s=i<this.childWidgets.length?a.getCellWidth(t.cellFormat.preferredWidth,t.cellFormat.preferredWidthType,r,null):a.getCellWidth(l.gridAfterWidth,l.gridAfterWidthType,r,null));var d=n[e.indexOf(o)],h=this.getOffsetIndex(e,o),c=parseFloat((s+o).toFixed(2));return(parseFloat((s+d).toFixed(2))===c||sf.base.isNullOrUndefined(d)?this.getOffsetIndex(e,o+s):this.getOffsetIndex(e,d+s))-h},t.prototype.getOffsetIndex=function(e,t){t=parseFloat(t.toFixed(2));var i=0;if(e.indexOf(t)>=0)i=e.indexOf(t);else{for(var r=0;r<e.length;r++)if(e[r]>t)return r;i=e.length-1}return i},t.prototype.getCellOffset=function(e,t){for(var i=0,r=this.ownerTable,n=0;n<this.childWidgets.length;n++){var o=this.childWidgets[n].cellFormat;if(n===e)break;i+=r.getCellWidth(o.preferredWidth,o.preferredWidthType,t,null)}return i},t.prototype.updateRowBySpannedCells=function(){for(var e=this.getPreviousRowSpannedCells(),t=this.rowIndex,i=0;i<e.length;i++){var r=e[i];r.ownerRow.rowIndex+r.cellFormat.rowSpan-1>=t&&(r.cellFormat.rowSpan-=1)}},t.prototype.getPreviousRowSpannedCells=function(e){for(var t=[],i=e?this:this.previousWidget;!sf.base.isNullOrUndefined(i);){for(var r=0;r<i.childWidgets.length;r++){var n=i.childWidgets[r];n.cellFormat.rowSpan>1&&t.splice(0,0,n)}i=i.previousWidget}return t},t.prototype.isCellsHaveSameWidthUnit=function(){if(this.childWidgets.length>0)for(var e=this.childWidgets[0].cellFormat.preferredWidthType,t=1;t<this.childWidgets.length;t++){if(e!=this.childWidgets[t].cellFormat.preferredWidthType)return!1}return!0},t.prototype.updateUniformWidthUnitForCells=function(){for(var e=0;e<this.childWidgets.length;e++){var t=this.childWidgets[e];t.cellFormat.preferredWidthType="Point",t.cellFormat.preferredWidth=t.cellFormat.cellWidth}},t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=Math.round(this.childWidgets[t].x);if(i-this.childWidgets[t].margin.left-1<=e.x&&i+this.childWidgets[t].width>=e.x)return this.childWidgets[t];if(t===this.childWidgets.length-1&&this.childWidgets[t].x+this.childWidgets[t].width+1<=e.x)return this.childWidgets[t]}var r=void 0;return this.childWidgets.length>0&&(r=this.childWidgets[0].x<=e.x?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),r},t.prototype.getFirstRowWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++)e+=this.childWidgets[t].getCellWidth(this.ownerTable);return e},t.prototype.getCellWidget=function(e,t){var i=this.ownerTable.tableHolder.getValidColumnIndex(e);i>e&&(t-=i-e,e=i);var r=0;this.rowFormat.gridBefore>0&&(r+=this.rowFormat.gridBefore);for(var n=0;n<this.childWidgets.length;n++){var o=this.childWidgets[n],s=o.cellFormat.columnSpan;if(r<o.columnIndex&&(r<=e||r<e+t)&&o.columnIndex>e)return null;if((o.columnIndex<=e||o.columnIndex<e+t)&&o.columnIndex+s>e)return o;if(o.columnIndex>e)break;r+=s}return null},t.prototype.getVerticalMergeStartCell=function(e,t){var i=this.ownerTable.tableHolder.columns;if(this.rowFormat.gridBefore>0&&this.rowFormat.gridBefore>e+t)return null;var r,n=this.getCellWidget(e,t);if(!sf.base.isNullOrUndefined(n))return n;if(e+this.rowFormat.gridAfter===i.length)return null;var o=this.previousWidget;return sf.base.isNullOrUndefined(o)||(r=o.getVerticalMergeStartCell(e,t)),!sf.base.isNullOrUndefined(r)&&r.cellFormat.rowSpan>1&&this.index===r.rowIndex+r.cellFormat.rowSpan-1?r:null},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){return{minimumWordWidth:e,maximumWordWidth:t}},t.prototype.destroyInternal=function(e){var t=this.height;if(!sf.base.isNullOrUndefined(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){if(this.childWidgets[i].destroyInternal(e),sf.base.isNullOrUndefined(this.childWidgets))break;i--}this.childWidgets=void 0}sf.base.isNullOrUndefined(this.containerWidget)||sf.base.isNullOrUndefined(this.containerWidget.childWidgets)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),(sf.base.isNullOrUndefined(this.containerWidget.childWidgets)||0===this.containerWidget.childWidgets.length)&&this.containerWidget instanceof ga?this.containerWidget.destroyInternal(e):this.containerWidget.containerWidget instanceof aa&&(this.containerWidget.containerWidget.height-=t),this.containerWidget.height-=t),this.destroy()},t.prototype.clone=function(){var e=new t;e.rowFormat.copyFormat(this.rowFormat),e.topBorderWidth=this.topBorderWidth,e.bottomBorderWidth=this.bottomBorderWidth,e.isRenderBookmarkEnd=this.isRenderBookmarkEnd;for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.containerWidget=e,r.index=i,r.rowIndex=this.rowIndex}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.prototype.updateChildWidgetLeft=function(e,t){var i=0;this.ownerTable.tableFormat.cellSpacing>0&&(i=this.ownerTable.tableFormat.cellSpacing);for(var r=0;r<this.childWidgets.length;r++){var n=this.childWidgets[r];e+=i+n.margin.left,n.x=e,n.updateChildWidgetLeft(n.x,t),e+=n.width+n.margin.right}},t.prototype.shiftWidgetForRtlTable=function(){var e=this.ownerTable,t=e.x,i=0;null!=e.tableFormat&&e.tableFormat.cellSpacing>0&&(i=e.tableFormat.cellSpacing);for(var r=t+x.convertPointToPixel(e.getTableWidth())-(this.x-t),n=0,o=0;o<this.childWidgets.length;o++){var s=this.childWidgets[o],a=0;sf.base.isNullOrUndefined(s.previousWidget)||(a=s.previousWidget.columnIndex+s.previousWidget.cellFormat.columnSpan),a<s.columnIndex&&(n=x.convertPointToPixel(s.ownerTable.tableHolder.getPreviousSpannedCellWidth(a,s.columnIndex)),0===a&&(n-=i/2)),r-=s.width+s.margin.left+s.margin.right+i,s.updateWidgetLeft(r+s.margin.left-n)}},t.prototype.destroy=function(){this.rowFormat=void 0,this.rowFormat=void 0,this.topBorderWidth=void 0,this.bottomBorderWidth=void 0,this.isRenderBookmarkEnd=void 0,e.prototype.destroy.call(this)},t}(da),ua=function(e){function t(){var t=e.call(this)||this;return t.rowIndex=-1,t.sizeInfoInternal=new pl,t.isRenderBookmarkStart=!1,t.isRenderBookmarkEnd=!1,t.isRenderEditRangeStart=!1,t.isRenderEditRangeEnd=!1,t.isSplittedCell=!1,t.updatedTopBorders=[],t.margin=new na(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.cellFormat=new Cl(t),t}return ta(t,e),Object.defineProperty(t.prototype,"ownerColumn",{get:function(){return this.ownerTable.tableHolder.columns[this.columnIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"leftMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.leftMargin:!sf.base.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("leftMargin")?this.ownerRow.rowFormat.leftMargin:sf.base.isNullOrUndefined(this.ownerTable)||sf.base.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.leftMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"topMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.topMargin:!sf.base.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("topMargin")?this.ownerRow.rowFormat.topMargin:sf.base.isNullOrUndefined(this.ownerTable)||sf.base.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.topMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rightMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.rightMargin:!sf.base.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("rightMargin")?this.ownerRow.rowFormat.rightMargin:sf.base.isNullOrUndefined(this.ownerTable)||sf.base.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.rightMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottomMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.bottomMargin:!sf.base.isNullOrUndefined(this.ownerRow)&&this.ownerRow.rowFormat.hasValue("bottomMargin")?this.ownerRow.rowFormat.bottomMargin:sf.base.isNullOrUndefined(this.ownerTable)||sf.base.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.bottomMargin},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellIndex",{get:function(){return this.ownerRow?this.ownerRow.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof fa)return this.containerWidget.ownerTable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerRow",{get:function(){return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sizeInfo",{get:function(){return this.sizeInfoInternal},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return e instanceof t&&e.cellFormat===this.cellFormat},t.prototype.getContainerTable=function(){for(var e=this.ownerTable;e instanceof ga&&e.associatedCell instanceof t;)e=e.associatedCell.getContainerTable();return e},t.prototype.getPreviousSplitWidget=function(){if(this.containerWidget instanceof fa){var e=this.containerWidget;do{if(e=e.previousRenderedWidget,sf.base.isNullOrUndefined(e)||e.index<this.rowIndex)break;var t=e.getCell(this.rowIndex,this.index);if(t&&this.equals(t))return t}while(e)}},t.prototype.getNextSplitWidget=function(){var e=this.cellFormat.rowSpan;if(this.containerWidget instanceof fa){var t=this.containerWidget;do{if(t=t.nextRenderedWidget,sf.base.isNullOrUndefined(t)||t.index>this.rowIndex+e)break;var i=t.getCell(this.rowIndex,this.index);if(i&&this.equals(i))return i}while(t)}},t.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t].y<=e.y&&this.childWidgets[t].y+this.childWidgets[t].height>=e.y)return this.childWidgets[t].getTableCellWidget(e);var i=void 0;return this.childWidgets.length>0&&(i=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),i},t.prototype.updateWidth=function(e){"Point"===this.cellFormat.preferredWidthType?this.cellFormat.preferredWidth=e:"Percent"===this.cellFormat.preferredWidthType&&(this.cellFormat.preferredWidth=this.convertPointToPercent(e)),this.cellFormat.cellWidth=e},t.prototype.getCellWidth=function(e){var t=this.ownerTable,i=t?t.getTableClientWidth(t.getOwnerWidth(!0)):0,r=i,n=sf.base.isNullOrUndefined(this.leftMargin)?0:this.leftMargin,o=sf.base.isNullOrUndefined(this.rightMargin)?0:this.rightMargin;return t&&"Auto"===t.tableFormat.preferredWidthType&&t.tableFormat.allowAutoFit?r=0===this.cellFormat.preferredWidth?i:this.cellFormat.preferredWidth-n-o:"Percent"===this.cellFormat.preferredWidthType?r=this.cellFormat.preferredWidth*i/100-n-o:"Point"===this.cellFormat.preferredWidthType&&(r=e instanceof ga&&"Percent"===e.tableFormat.preferredWidthType?this.cellFormat.cellWidth-n-o:this.cellFormat.preferredWidth-n-o),r},t.prototype.convertPointToPercent=function(e){var t=0,i=this.ownerTable.getOwnerWidth(!0);return t=e/this.ownerTable.getTableClientWidth(i)*100,(t=Math.round(t))<100?t:100},t.getCellLeftBorder=function(e){var t=void 0,i=e.cellFormat.borders,r=sf.base.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,n=sf.base.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(sf.base.isNullOrUndefined(i.left)||(t=i.left),sf.base.isNullOrUndefined(t)&&(t=e.getLeftBorderToRenderByHierarchy(t,r,n)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getLeftBorderToRenderByHierarchy(t,r,n);else{var o=this.getPreviousCell(e);t=e.getPreviousCellLeftBorder(t,o)}return sf.base.isNullOrUndefined(t)&&(t=new p(e.cellFormat.borders)),t},t.getPreviousCell=function(e){var t=void 0;if(!sf.base.isNullOrUndefined(e.previousWidget)){var i=e.previousWidget;i.columnIndex+i.cellFormat.columnSpan===e.columnIndex&&(t=i)}return t},t.prototype.getLeftBorderWidth=function(){var e=0;return null!==this.cellFormat&&null!==this.cellFormat.borders&&(e=t.getCellLeftBorder(this).getLineWidth()),e},t.prototype.getRightBorderWidth=function(){var e=0;this.ownerTable;return null!==this.cellFormat&&null!==this.cellFormat.borders&&(e=t.getCellRightBorder(this).getLineWidth()),e},t.prototype.getCellSpacing=function(){var e=this.ownerTable&&this.ownerTable.tableFormat?this.ownerTable.tableFormat.cellSpacing:0;return 1===this.ownerRow.childWidgets.length?2*e:0===this.cellIndex||this.cellIndex===this.ownerRow.childWidgets.length-1?e+e/2:e},t.prototype.getCellSizeInfo=function(e){var t=!0,i=void 0;if(sf.base.isNullOrUndefined(this.bodyWidget)||sf.base.isNullOrUndefined(this.bodyWidget.page)||sf.base.isNullOrUndefined(this.bodyWidget.page.documentHelper)||(i=this.bodyWidget.page.documentHelper.layout),sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.currentCell)||(t=!1,this===i.currentCell&&(t=!0)),t&&!this.sizeInfo.hasMinimumWidth&&(this.sizeInfo.minimumWidth=this.getMinimumPreferredWidth()),e&&t&&!this.sizeInfo.hasMinimumWordWidth){var r=this.getMinimumAndMaximumWordWidth(0,0);this.sizeInfo.minimumWordWidth=r.minimumWordWidth+this.sizeInfo.minimumWidth,this.sizeInfo.maximumWordWidth=r.maximumWordWidth+this.sizeInfo.minimumWidth}var n=new pl;return n.minimumWidth=this.sizeInfo.minimumWidth,n.minimumWordWidth=this.sizeInfo.minimumWordWidth,n.maximumWordWidth=this.sizeInfo.maximumWordWidth,n},t.prototype.getMinimumPreferredWidth=function(){return this.leftMargin+this.rightMargin+this.getLeftBorderWidth()+this.getRightBorderWidth()+this.getCellSpacing()},t.prototype.getPreviousCellLeftBorder=function(e,t){if((sf.base.isNullOrUndefined(t)||!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&(sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl||(e=this.getLeftBorderToRenderByHierarchy(e,fa.getRowOf(e.ownerBase).rowFormat.borders,ga.getTableOf(e.ownerBase).tableFormat.borders))),sf.base.isNullOrUndefined(t))return e;var i=void 0;return sf.base.isNullOrUndefined(t.cellFormat.borders)||sf.base.isNullOrUndefined(t.cellFormat.borders.right)||"None"===t.cellFormat.borders.right.lineStyle||(i=t.cellFormat.borders.right),sf.base.isNullOrUndefined(i)||"None"===i.lineStyle?sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl?e:this.getLeftBorderToRenderByHierarchy(e,fa.getRowOf(e.ownerBase).rowFormat.borders,ga.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(i,e)},t.prototype.getBorderBasedOnPriority=function(e,t){if(sf.base.isNullOrUndefined(e))return t;if(sf.base.isNullOrUndefined(t))return e;var i=e.getBorderWeight(),r=t.getBorderWeight();if(i===r){var n=e.getPrecedence(),o=t.getPrecedence();if(n===o){var s=x.convertHexToRgb(e.color),a=s.r,l=s.g,d=s.b,h=x.convertHexToRgb(t.color),c=h.r,p=h.g,g=h.b,f=a+d+2*l,u=c+g+2*p;return f===u&&(f=d+2*l)===(u=g+2*p)?l===p?e:l>p?t:e:f>u?t:e}return n>o?e:t}return i>r?e:t},t.prototype.getLeftBorderToRenderByHierarchy=function(e,i,r){var n=t.getCellOf(e.ownerBase);if(!sf.base.isNullOrUndefined(n)){var o=!1;(0===n.columnIndex||0===n.cellIndex&&n.ownerRow.rowFormat.gridBefore>0)&&(o=!0);var s=!sf.base.isNullOrUndefined(i.left)&&"None"!==i.left.lineStyle&&i.left.isBorderDefined;(sf.base.isNullOrUndefined(e)||"None"!==e.lineStyle||e.isBorderDefined&&!s)&&!sf.base.isNullOrUndefined(e)||(o?(e=i.left,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.left)):(e=i.vertical,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.vertical)))}return e},t.getCellRightBorder=function(e){var t=void 0,i=e.cellFormat.borders,r=sf.base.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,n=sf.base.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(sf.base.isNullOrUndefined(i.right)||(t=i.right),sf.base.isNullOrUndefined(t)&&(t=e.getRightBorderToRenderByHierarchy(t,r,n)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getRightBorderToRenderByHierarchy(t,r,n);else{var o=this.getNextCell(e);t=e.getAdjacentCellRightBorder(t,o)}return sf.base.isNullOrUndefined(t)&&(t=new p(e.cellFormat.borders)),t},t.getNextCell=function(e){var t=void 0,i=e.cellFormat.columnSpan;if(!sf.base.isNullOrUndefined(e.nextWidget)){var r=e.nextWidget;e.columnIndex+i===r.columnIndex&&(t=r)}return t},t.prototype.getAdjacentCellRightBorder=function(e,t){if((sf.base.isNullOrUndefined(t)||!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&(sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl||(e=this.getRightBorderToRenderByHierarchy(e,fa.getRowOf(e.ownerBase).rowFormat.borders,ga.getTableOf(e.ownerBase).tableFormat.borders))),sf.base.isNullOrUndefined(t))return e;var i=void 0;return sf.base.isNullOrUndefined(t.cellFormat.borders)||sf.base.isNullOrUndefined(t.cellFormat.borders.left)||"None"===t.cellFormat.borders.left.lineStyle||(i=t.cellFormat.borders.left),sf.base.isNullOrUndefined(i)||"None"===i.lineStyle?sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl?e:this.getRightBorderToRenderByHierarchy(e,fa.getRowOf(e.ownerBase).rowFormat.borders,ga.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,i)},t.prototype.getRightBorderToRenderByHierarchy=function(e,i,r){var n=t.getCellOf(e.ownerBase);if(!sf.base.isNullOrUndefined(n)){var o=!1;n.columnIndex+n.cellFormat.columnSpan!==n.ownerTable.tableHolder.columns.length&&n.cellIndex!==n.ownerRow.childWidgets.length-1||(o=!0);var s=!sf.base.isNullOrUndefined(i.right)&&"None"!==i.right.lineStyle&&i.right.isBorderDefined;(sf.base.isNullOrUndefined(e)||"None"!==e.lineStyle||e.isBorderDefined&&!s)&&!sf.base.isNullOrUndefined(e)||(o?(e=i.right,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.right)):(e=i.vertical,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.vertical)))}return e},t.getCellTopBorder=function(e){var t=void 0,i=e.cellFormat.borders,r=sf.base.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,n=sf.base.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(sf.base.isNullOrUndefined(i.top)||(t=i.top),sf.base.isNullOrUndefined(t)&&(t=e.getTopBorderToRenderByHierarchy(t,r,n)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getTopBorderToRenderByHierarchy(t,r,n);else{var o=e.getTopAdjacentCell();t=e.getPreviousCellTopBorder(t,o)}return sf.base.isNullOrUndefined(t)&&(t=new p(e.cellFormat.borders)),t},t.prototype.getTopAdjacentCell=function(){var e,t=this.ownerRow.previousWidget;return sf.base.isNullOrUndefined(t)||(e=t.getVerticalMergeStartCell(this.columnIndex,this.cellFormat.columnSpan)),e},t.prototype.getPreviousCellTopBorder=function(e,t){if((sf.base.isNullOrUndefined(t)||!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&(sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl||(e=this.getTopBorderToRenderByHierarchy(e,fa.getRowOf(e.ownerBase).rowFormat.borders,ga.getTableOf(e.ownerBase).tableFormat.borders))),sf.base.isNullOrUndefined(t))return e;var i=void 0;return sf.base.isNullOrUndefined(t.cellFormat.borders)||sf.base.isNullOrUndefined(t.cellFormat.borders.bottom)||(i=this.getBottomBorderToRenderByHierarchy(t.cellFormat.borders.bottom,t.ownerRow.rowFormat.borders,t.ownerTable.tableFormat.borders)),sf.base.isNullOrUndefined(i)||"None"===i.lineStyle?sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl?e:this.getTopBorderToRenderByHierarchy(e,fa.getRowOf(e.ownerBase).rowFormat.borders,ga.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,i)},t.prototype.getTopBorderToRenderByHierarchy=function(e,i,r){var n=t.getCellOf(e.ownerBase);if(!sf.base.isNullOrUndefined(n)){var o=sf.base.isNullOrUndefined(n.ownerRow.previousWidget),s=!sf.base.isNullOrUndefined(i.top)&&"None"!==i.top.lineStyle&&i.top.isBorderDefined;(sf.base.isNullOrUndefined(e)||"None"!==e.lineStyle||e.isBorderDefined&&!s)&&!sf.base.isNullOrUndefined(e)||(o?(e=i.top,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.top)):(e=i.horizontal,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.horizontal)))}return e},t.getCellBottomBorder=function(e){var t=void 0,i=e.cellFormat.borders,r=sf.base.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,n=sf.base.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(sf.base.isNullOrUndefined(i.bottom)||(t=i.bottom),sf.base.isNullOrUndefined(t)&&(t=e.getBottomBorderToRenderByHierarchy(t,r,n)),e.ownerTable.tableFormat.cellSpacing>0)t=e.getBottomBorderToRenderByHierarchy(t,r,n);else{var o=void 0,s=void 0,a=e.cellFormat.rowSpan;if(1===a)s=e.ownerRow.nextWidget;else if(a>1){var l=e.containerWidget;do{if(l=l.nextWidget,sf.base.isNullOrUndefined(l))break;if(l.index===e.rowIndex+a){s=l;break}}while(l)}sf.base.isNullOrUndefined(s)||(o=s.getCellWidget(e.columnIndex,e.cellFormat.columnSpan)),t=e.getAdjacentCellBottomBorder(t,o)}return sf.base.isNullOrUndefined(t)&&(t=new p(e.cellFormat.borders)),t},t.prototype.getAdjacentCellBottomBorder=function(e,t){if((sf.base.isNullOrUndefined(t)||!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle&&!e.hasNoneStyle)&&(sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl||(e=this.getBottomBorderToRenderByHierarchy(e,fa.getRowOf(e.ownerBase).rowFormat.borders,ga.getTableOf(e.ownerBase).tableFormat.borders))),sf.base.isNullOrUndefined(t))return e;var i=void 0;return sf.base.isNullOrUndefined(t.cellFormat.borders)||sf.base.isNullOrUndefined(t.cellFormat.borders.top)||"None"===t.cellFormat.borders.top.lineStyle||(i=t.cellFormat.borders.top),sf.base.isNullOrUndefined(i)||"None"===i.lineStyle?sf.base.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof Fl?e:this.getBottomBorderToRenderByHierarchy(e,fa.getRowOf(e.ownerBase).rowFormat.borders,ga.getTableOf(e.ownerBase).tableFormat.borders):this.getBorderBasedOnPriority(e,i)},t.prototype.getBottomBorderToRenderByHierarchy=function(e,i,r){var n=t.getCellOf(e.ownerBase);if(!sf.base.isNullOrUndefined(n)){var o=sf.base.isNullOrUndefined(n.ownerRow.nextWidget),s=!sf.base.isNullOrUndefined(i.bottom)&&"None"!==i.bottom.lineStyle&&i.bottom.isBorderDefined;(sf.base.isNullOrUndefined(e)||"None"!==e.lineStyle||e.isBorderDefined&&!s)&&!sf.base.isNullOrUndefined(e)||(o?(e=i.bottom,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.bottom)):(e=i.horizontal,(!sf.base.isNullOrUndefined(e)&&"None"===e.lineStyle||sf.base.isNullOrUndefined(e))&&(e=r.horizontal)))}return e},t.getCellOf=function(e){if(e instanceof g)return e.ownerBase instanceof Cl&&e.ownerBase.ownerBase instanceof t?e.ownerBase.ownerBase:void 0},t.prototype.updateWidgetLeft=function(e){this.x=e,this.updateChildWidgetLeft(e)},t.prototype.updateChildWidgetLeft=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i];if(r.x=e,t&&r instanceof ca&&(r.x=e+x.convertPointToPixel(r.leftIndent)),r instanceof ga){var n=r;if(n.updateChildWidgetLeft(e,t),n.isBidiTable){var o=new ia(n.x,n.y,n.width,n.height);n.shiftWidgetsForRtlTable(o,n)}}}},t.prototype.getMinimumAndMaximumWordWidth=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].getMinimumAndMaximumWordWidth(e,t);e=r.minimumWordWidth,t=r.maximumWordWidth}return{minimumWordWidth:e,maximumWordWidth:t}},t.prototype.destroyInternal=function(e){if(!sf.base.isNullOrUndefined(this.childWidgets)){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.destroyInternal(e),t--}this.childWidgets=void 0,sf.base.isNullOrUndefined(e.documentHelper.selection)||e.documentHelper.selection.selectedWidgets.containsKey(this)&&e.documentHelper.selection.selectedWidgets.remove(this)}this.destroy()},t.prototype.clone=function(){var e=new t;e.cellFormat.copyFormat(this.cellFormat);for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.containerWidget=e,r.index=i}return e.leftBorderWidth=this.leftBorderWidth,e.rightBorderWidth=this.rightBorderWidth,e.isRenderBookmarkEnd=this.isRenderBookmarkEnd,e.isRenderBookmarkStart=this.isRenderBookmarkStart,this.margin&&(e.margin=this.margin.clone()),e.columnIndex=this.columnIndex,e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t.prototype.destroy=function(){this.cellFormat=void 0,this.rowIndex=void 0,this.columnIndex=void 0,this.isRenderBookmarkStart=void 0,this.isRenderBookmarkEnd=void 0,this.isSplittedCell=void 0,e.prototype.destroy.call(this)},t}(da),ma=function(){function e(e){this.children=[],this.x=0,this.y=0,this.width=0,this.height=0,this.marginTop=0,this.maxBaseLine=0,this.skipClipImage=!1,this.paragraph=e}return Object.defineProperty(e.prototype,"renderedElements",{get:function(){return sf.base.isNullOrUndefined(this.layoutedElements)?this.children:this.layoutedElements},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this.paragraph&&this.paragraph.childWidgets?this.paragraph.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextLine",{get:function(){var t=this.paragraph,i=this.indexInOwner;if(i<=t.childWidgets.length-2)return t.childWidgets[i+1];if(t.nextSplitWidget){var r=t.nextSplitWidget.firstChild;if(r instanceof e&&r.paragraph.equals(this.paragraph))return r}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousLine",{get:function(){var t=this.paragraph,i=this.indexInOwner,r=t.previousSplitWidget;if(i>0)return t.childWidgets[i-1];if(r instanceof ca){var n=r.lastChild;if(n instanceof e&&n.paragraph.equals(this.paragraph))return n}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithPageBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof Fa)return e.isPageBreak}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithColumnBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof Fa)return e.isColumnBreak}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithLineBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof Fa)return"\v"===e.text}return!1},enumerable:!0,configurable:!0}),e.prototype.isFirstLine=function(){var e=this.indexInOwner;return!!(e>-1&&(void 0===this.paragraph.previousSplitWidget||this.paragraph.previousSplitWidget instanceof ca&&(this.paragraph.previousSplitWidget.isEndsWithColumnBreak||this.paragraph.previousSplitWidget.isEndsWithPageBreak)))&&0===e},e.prototype.isLastLine=function(){var e=this.indexInOwner;return e>-1&&void 0===this.paragraph.nextSplitWidget&&e===this.paragraph.childWidgets.length-1},e.prototype.getOffset=function(e,t){if(sf.base.isNullOrUndefined(e))return t;for(var i=t,r=e.line,n=0;n<r.children.length;n++){var o=r.children[n];if(e===o)break;o instanceof Va||(i+=o.length)}return i},e.prototype.getEndOffset=function(){for(var e=0,t=0,i=0;i<this.children.length;i++){var r=this.children[i];0!==r.length&&(r instanceof Va||((r instanceof Fa||r instanceof al||r instanceof _a||r instanceof Da||r instanceof qa||r instanceof Na||r instanceof Oa||r instanceof va&&x.isLinkedFieldCharacter(r))&&(e=t+r.length),t+=r.length))}return e},e.prototype.getInline=function(e,t,i,r,n){i=sf.base.isNullOrUndefined(i)?this.paragraph.bidi:i;var o=void 0,s=0,a=!1;if(0===this.children.length&&this.previousLine){var l=this.previousLine.children[this.previousLine.children.length-1];if(l instanceof Fa&&"\v"===l.text)return{element:o=this.previousLine.children[this.previousLine.children.length-1],index:t=1}}for(var d=0;d<this.children.length;d++)if(!((o=this.children[d])instanceof Va)){if(!a&&(o instanceof Fa||o instanceof Da||o instanceof La||o instanceof Oa||o instanceof Na||o instanceof qa||o instanceof _a||o instanceof al||o instanceof va&&x.isLinkedFieldCharacter(o))&&(a=!0),a&&e<=s+o.length){if(o instanceof Fa&&" "===o.text&&0===o.revisions.length&&r&&!n){var h=this.getNextTextElement(this,d+1);return{element:o=sf.base.isNullOrUndefined(h)?o:h,index:t=sf.base.isNullOrUndefined(h)?e-s:0}}return e===s+o.length&&this.children[d+1]instanceof Wa?{element:this.children[d+1],index:t}:{element:o,index:t=e-s}}s+=o.length}return e>s&&(t=sf.base.isNullOrUndefined(o)?e:o.length),{element:o,index:t}},e.prototype.getNextTextElement=function(e,t){return t<e.children.length-1&&e.children[t]?e.children[t]:null},e.prototype.getHierarchicalIndex=function(e){return e=this.paragraph.childWidgets.indexOf(this)+";"+e,this.paragraph instanceof da?this.paragraph.getHierarchicalIndex(e):e},e.prototype.clone=function(){for(var t=new e(void 0),i=0;i<this.children.length;i++){var r=this.children[i].clone();t.children.push(r),r.line=t}return t.width=this.width,t.height=this.height,sf.base.isNullOrUndefined(this.margin)||(t.margin=this.margin.clone()),t},e.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.children)){for(var e=0;e<this.children.length;e++)this.children[e].destroy();this.children=[]}this.children=void 0,this.paragraph&&this.paragraph.removeChild(this.indexInOwner),this.paragraph=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},e}(),ya=function(){function e(){this.x=0,this.y=0,this.width=0,this.height=0,this.margin=new na(0,0,0,0),this.padding=new na(0,0,0,0),this.characterFormat=void 0,this.isRightToLeft=!1,this.canTrigger=!1,this.ischangeDetected=!1,this.isVisible=!1,this.isSpellChecked=!1,this.revisions=[],this.canTrack=!1,this.removedIds=[],this.isMarkedForRevision=!1,this.characterRange=void 0,this.characterFormat=new T(this),this.margin=new na(0,0,0,0)}return Object.defineProperty(e.prototype,"isPageBreak",{get:function(){return this instanceof Fa&&"\f"===this.text},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isColumnBreak",{get:function(){return this instanceof Fa&&this.text===String.fromCharCode(14)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValidNodeForTracking",{get:function(){return!(this instanceof Na||this instanceof al||this instanceof _a||this instanceof qa||this instanceof Oa)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCheckBoxElement",{get:function(){return this instanceof Fa&&!sf.base.isNullOrUndefined(this.text)&&(this.text===String.fromCharCode(9745)||this.text===String.fromCharCode(9744))},enumerable:!0,configurable:!0}),e.prototype.linkFieldCharacter=function(e){if(this instanceof va)if(0===this.fieldType){sf.base.isNullOrUndefined(this.fieldEnd)&&(this.linkFieldTraversingForward(this.line,this,this),-1===e.fields.indexOf(this)&&e.fields.push(this),sf.base.isNullOrUndefined(this.formFieldData)||-1!==e.formFields.indexOf(this)||e.layout.isInsertFormField||e.formFields.push(this))}else if(2===this.fieldType){if(sf.base.isNullOrUndefined(this.fieldBegin)&&this.linkFieldTraversingBackwardSeparator(this.line,this,this),!sf.base.isNullOrUndefined(this.fieldBegin)){this.fieldBegin.fieldSeparator=this;var t=this.linkFieldTraversingForward(this.line,this.fieldBegin,this);sf.base.isNullOrUndefined(this.fieldEnd)&&t&&(this.fieldEnd=this.fieldBegin.fieldEnd),this.fieldEnd&&(this.fieldEnd.fieldSeparator=this)}}else{sf.base.isNullOrUndefined(this.fieldBegin)&&this.linkFieldTraversingBackward(this.line,this,this)}},e.prototype.linkFieldTraversingBackward=function(e,t,i){var r=e.children.length-1;e.children.indexOf(i)>-1&&(r=e.children.indexOf(i)-1);for(var n=r;n>=0;n--){var o=e.children[n];if(o instanceof va)if(0===o.fieldType){if(sf.base.isNullOrUndefined(o.fieldEnd))return t.fieldBegin=o,sf.base.isNullOrUndefined(o.fieldEnd)&&(o.fieldEnd=t),t.fieldSeparator&&sf.base.isNullOrUndefined(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=o,sf.base.isNullOrUndefined(o.fieldSeparator)&&(o.fieldSeparator=t.fieldSeparator)),!sf.base.isNullOrUndefined(t.fieldBegin)}else 2===o.fieldType&&sf.base.isNullOrUndefined(o.fieldEnd)&&(t.fieldSeparator=o,o.fieldEnd=t,sf.base.isNullOrUndefined(o.fieldBegin)||(t.fieldBegin=o.fieldBegin))}if(e.previousLine)this.linkFieldTraversingBackward(e.previousLine,t,this);else if(e.paragraph.previousRenderedWidget instanceof ca&&e.paragraph.previousRenderedWidget.childWidgets.length>0){var s=e.paragraph.previousRenderedWidget;this.linkFieldTraversingBackward(s.childWidgets[s.childWidgets.length-1],t,this)}return!0},e.prototype.linkFieldTraversingForward=function(e,t,i){var r=0;e.children.indexOf(i)>-1&&(r=e.children.indexOf(i)+1);for(var n=r;n<e.children.length;n++){var o=e.children[n];if(o instanceof va){if(1===o.fieldType)return sf.base.isNullOrUndefined(o.fieldBegin)&&(t.fieldEnd=o),t.fieldEnd&&sf.base.isNullOrUndefined(t.fieldEnd.fieldBegin)&&(t.fieldEnd.fieldBegin=t),!0;if(sf.base.isNullOrUndefined(t.fieldSeparator)){if(2!==o.fieldType||!sf.base.isNullOrUndefined(o.fieldBegin))return!1;if(t.fieldSeparator=o,t.fieldSeparator&&sf.base.isNullOrUndefined(t.fieldSeparator.fieldBegin)&&(t.fieldSeparator.fieldBegin=t),!sf.base.isNullOrUndefined(o.fieldEnd))return t.fieldEnd=o.fieldEnd,t.fieldSeparator.fieldEnd=t.fieldEnd,!0}}}return e.nextLine?this.linkFieldTraversingForward(e.nextLine,t,this):e.paragraph.nextRenderedWidget instanceof ca&&e.paragraph.nextRenderedWidget.childWidgets.length>0&&this.linkFieldTraversingForward(e.paragraph.nextRenderedWidget.childWidgets[0],t,this),!0},e.prototype.linkFieldTraversingBackwardSeparator=function(e,t,i){var r=e.children.length-1;e.children.indexOf(i)>-1&&(r=e.children.indexOf(i)-1);for(var n=r;n>=0;n--){var o=e.children[n];if(o instanceof va&&o instanceof va&&0===o.fieldType)return sf.base.isNullOrUndefined(o.fieldSeparator)&&(t.fieldBegin=o),!sf.base.isNullOrUndefined(t.fieldBegin)}if(e.previousLine)this.linkFieldTraversingBackwardSeparator(e.previousLine,t,this);else{if(!(e.paragraph.previousRenderedWidget instanceof ca&&e.paragraph.previousRenderedWidget.childWidgets.length>0))return!0;e=e.paragraph.previousRenderedWidget.childWidgets[e.paragraph.previousRenderedWidget.childWidgets.length-1],this.linkFieldTraversingBackwardSeparator(e,t,this)}return!0},Object.defineProperty(e.prototype,"length",{get:function(){return this.getLength()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this.line instanceof ma&&this.line.children?this.line.children.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousElement",{get:function(){var e=this.indexInOwner;if(e>0&&e<this.line.children.length)return this.line.children[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextElement",{get:function(){var e=this.indexInOwner;if(e>-1&&e<this.line.children.length-1)return this.line.children[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);return e<this.line.children.length-1?this.line.children[e+1]:t<this.line.paragraph.childWidgets.length-1?this.line.paragraph.childWidgets[t+1].children[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextValidNodeForTracking",{get:function(){for(var e=this;!sf.base.isNullOrUndefined(e)&&(e instanceof Na||e instanceof al||e instanceof _a||e instanceof qa||e instanceof Oa);)e=e.nextNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousValidNodeForTracking",{get:function(){for(var e=this;!sf.base.isNullOrUndefined(e)&&(e instanceof Na||e instanceof al||e instanceof _a||e instanceof qa||e instanceof Oa);)e=e.previousNode;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);if(e>0)return this.line.children[e-1];if(t>0){var i=this.line.paragraph.childWidgets[t-1];return i.children[i.children.length-1]}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paragraph",{get:function(){if(this.line)return this.line.paragraph},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.line)&&this.line.children&&this.line.children.indexOf(this)>-1){var e=this.line.children.indexOf(this);this.line.children.splice(e,1)}this.line=void 0,this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},e.objectCharacter=String.fromCharCode(65532),e}(),va=function(e){function t(t){var i=e.call(this)||this;return i.fieldType=0,i.fieldCodeType="",i.hasFieldEnd=!1,i.fieldBeginInternal=void 0,i.fieldSeparatorInternal=void 0,i.fieldEndInternal=void 0,i.fieldType=t,i}return ta(t,e),Object.defineProperty(t.prototype,"fieldBegin",{get:function(){return this.fieldBeginInternal},set:function(e){this.fieldBeginInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldSeparator",{get:function(){return this.fieldSeparatorInternal},set:function(e){this.fieldSeparatorInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldEnd",{get:function(){return this.fieldEndInternal},set:function(e){this.fieldEndInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resultText",{get:function(){if(!sf.base.isNullOrUndefined(this.formFieldData)&&0===this.fieldType&&!sf.base.isNullOrUndefined(this.fieldSeparator)&&!sf.base.isNullOrUndefined(this.fieldEnd)){var e=this.fieldSeparator.nextElement,t="";do{if(e instanceof Fa&&(t+=e.text),(e=e.nextNode)===this.fieldEnd)break}while(e);return t}},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.fieldType);if(0!==this.fieldType||sf.base.isNullOrUndefined(this.formFieldData)||(e.formFieldData=this.formFieldData.clone()),e.characterFormat.copyFormat(this.characterFormat),this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=N.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.fieldCodeType=this.fieldCodeType,e},t.prototype.destroy=function(){this.fieldType=void 0,this.hasFieldEnd=void 0,this.fieldBeginInternal=void 0,this.fieldEndInternal=void 0,this.fieldSeparatorInternal=void 0,e.prototype.destroy.call(this)},t}(ya),wa=function(){this.name="",this.enabled=!0,this.helpText="",this.statusText=""},ba=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="Text",t.maxLength=0,t.defaultValue="",t.format="",t}return ta(t,e),t.prototype.clone=function(){var e=new t;return e.type=this.type,e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.maxLength=this.maxLength,e.defaultValue=this.defaultValue,e.format=this.format,e},t.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,format:this.format,helpText:this.helpText,maxLength:this.maxLength,type:this.type,name:this.name}},t.prototype.copyFieldInfo=function(e){sf.base.isNullOrUndefined(e.defaultValue)||(this.defaultValue=e.defaultValue),sf.base.isNullOrUndefined(e.enabled)||(this.enabled=e.enabled),sf.base.isNullOrUndefined(e.format)||(this.format=e.format),sf.base.isNullOrUndefined(e.helpText)||(this.helpText=e.helpText),sf.base.isNullOrUndefined(e.maxLength)||(this.maxLength=e.maxLength),sf.base.isNullOrUndefined(e.type)||(this.type=e.type)},t}(wa),xa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sizeType="Auto",t.size=11,t.defaultValue=!1,t.checked=!1,t}return ta(t,e),t.prototype.clone=function(){var e=new t;return e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.sizeType=this.sizeType,e.size=this.size,e.defaultValue=this.defaultValue,e.checked=this.checked,e},t.prototype.getFormFieldInfo=function(){return{defaultValue:this.defaultValue,enabled:this.enabled,helpText:this.helpText,size:this.size,sizeType:this.sizeType,name:this.name}},t.prototype.copyFieldInfo=function(e){sf.base.isNullOrUndefined(e.defaultValue)||(this.defaultValue=e.defaultValue,this.checked=e.defaultValue),sf.base.isNullOrUndefined(e.enabled)||(this.enabled=e.enabled),sf.base.isNullOrUndefined(e.size)||(this.size=e.size),sf.base.isNullOrUndefined(e.helpText)||(this.helpText=e.helpText),sf.base.isNullOrUndefined(e.sizeType)||(this.sizeType=e.sizeType)},t}(wa),Ia=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dropdownItems=[],t.selectedIndex=0,t}return ta(t,e),t.prototype.clone=function(){var e=new t;return e.name=this.name,e.enabled=this.enabled,e.helpText=this.helpText,e.statusText=this.statusText,e.dropdownItems=this.dropdownItems.slice(),e.selectedIndex=this.selectedIndex,e},t.prototype.getFormFieldInfo=function(){return{dropdownItems:this.dropdownItems.slice(),enabled:this.enabled,helpText:this.helpText,name:this.name}},t.prototype.copyFieldInfo=function(e){sf.base.isNullOrUndefined(e.dropdownItems)||(this.dropdownItems=e.dropdownItems),sf.base.isNullOrUndefined(e.enabled)||(this.enabled=e.enabled),sf.base.isNullOrUndefined(e.helpText)||(this.helpText=e.helpText)},t}(wa),Fa=function(e){function i(){var i=e.call(this)||this;return i.baselineOffset=0,i.text="",i.trimEndWidth=0,i.ignoreOnceItems=[],i.istextCombined=!1,i.scriptType=t.English,i.renderedFontFamily=void 0,i.errorCollection=[],i}return ta(i,e),i.prototype.getLength=function(){return this.text?this.text.length:0},i.prototype.clone=function(){var e=new i;if(e.characterFormat.copyFormat(this.characterFormat),e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.baselineOffset=this.baselineOffset,!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var t=0;t<this.revisions.length;t++){var r=this.revisions[t];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=N.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.width=this.width,e.height=this.height,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},i.prototype.destroy=function(){this.text=void 0,e.prototype.destroy.call(this)},i}(ya),Ca=function(){function e(){this.separator=[],this.continuationNotice=[],this.continuationSeparator=[]}return e.prototype.clear=function(){this.separator=[],this.continuationSeparator=[],this.continuationNotice=[]},e.prototype.destroy=function(){this.separator=[],this.continuationSeparator=[],this.continuationNotice=[]},e}(),Wa=function(e){function t(){var t=e.call(this)||this;return t.isLayout=!1,t.bodyWidget=new aa,t.bodyWidget.footNoteReference=t,t}return ta(t,e),t.prototype.clone=function(){var e=new t;return e.text=this.text,e.characterFormat.copyFormat(this.characterFormat),e.height=this.height,e.footnoteType=this.footnoteType,e.width=this.width,e.symbolCode=this.symbolCode,e.bodyWidget.childWidgets=this.bodyWidget.childWidgets,e.bodyWidget.page=this.bodyWidget.page,this.margin&&(e.margin=this.margin.clone()),e},t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.symbolCode="",this.symbolFontName="",this.customMarker="",this.bodyWidget=void 0},t}(Fa),ka=function(e){function t(){var t=e.call(this)||this;return t.startIn=void 0,t.endIn=void 0,t}return ta(t,e),Object.defineProperty(t.prototype,"start",{get:function(){return this.startIn},set:function(e){this.startIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.endIn},set:function(e){this.endIn=e},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.start=void 0,this.end=void 0},t}(Fa),Sa=function(e){function t(){var t=e.call(this)||this;return t.fieldText="",t}return ta(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this.fieldText},set:function(e){this.fieldText=e},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.fieldBegin=this.fieldBegin,e.text=this.text,this.margin&&(e.margin=this.margin.clone()),!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=N.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.width=this.width,e.height=this.height,e},t}(Fa),Pa=function(e){function t(){var t=e.call(this)||this;return t.tabText="",t.tabLeader="None",t}return ta(t,e),t.prototype.destroy=function(){this.tabText=void 0,this.tabLeader=void 0},t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.tabText=this.tabText,e.tabLeader=this.tabLeader,e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=N.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e},t}(Fa),Na=function(e){function t(t){var i=e.call(this)||this;return i.bookmarkTypeIn=0,i.refereneceIn=void 0,i.nameIn="",i.bookmarkTypeIn=t,i}return ta(t,e),Object.defineProperty(t.prototype,"bookmarkType",{get:function(){return this.bookmarkTypeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.nameIn},set:function(e){this.nameIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reference",{get:function(){return this.refereneceIn},set:function(e){this.refereneceIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"properties",{get:function(){return this.propertiesIn},set:function(e){this.propertiesIn=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.name=void 0,this.reference=void 0,this.bookmarkTypeIn=void 0},t.prototype.clone=function(){var e=new t(this.bookmarkType);return e.name=this.name,e.reference=this.reference,e.properties=this.properties,this.margin&&(e.margin=this.margin.clone()),this.revisions.length>0?e.removedIds=N.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice(),e.width=this.width,e.height=this.height,this.contentControlProperties&&(e.contentControlProperties=this.contentControlProperties),e},t}(ya),Oa=function(e){function t(t){var i=e.call(this)||this;return i.contentControlWidgetType=t,i.contentControlProperties=new Ta(t),i}return ta(t,e),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.contentControlWidgetType);if(e.characterFormat.copyFormat(this.characterFormat),e.contentControlProperties=this.contentControlProperties,e.contentControlWidgetType=this.contentControlWidgetType,this.margin&&(e.margin=this.margin.clone()),!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=N.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.type=this.type,e.width=this.width,e.height=this.height,e.reference=this.reference,e},t.prototype.destroy=function(){this.contentControlProperties=void 0,this.contentControlWidgetType=void 0,e.prototype.destroy.call(this)},t}(ya),Ta=function(){function e(e){this.contentControlListItems=[],this.contentControlWidgetType=e,this.characterFormat=new T}return e.prototype.destroy=function(){this.lockContentControl=void 0,this.lockContents=void 0,this.tag=void 0,this.color=void 0,this.title=void 0,this.appearance=void 0,this.type=void 0,this.hasPlaceHolderText=void 0,this.multiline=void 0,this.isTemporary=void 0,this.isChecked=void 0,this.dateCalendarType=void 0,this.dateStorageFormat=void 0,this.dateDisplayLocale=void 0,this.dateDisplayFormat=void 0},e.prototype.clone=function(){var t=new e(this.contentControlWidgetType);if(t.lockContentControl=this.lockContentControl,t.lockContents=this.lockContents,t.tag=this.tag,t.color=this.color,t.title=this.title,t.appearance=this.appearance,t.type=this.type,t.hasPlaceHolderText=this.hasPlaceHolderText,t.multiline=this.multiline,t.isTemporary=this.isTemporary,t.isChecked=this.isChecked,t.dateCalendarType=this.dateCalendarType,t.dateStorageFormat=this.dateStorageFormat,t.dateDisplayLocale=this.dateDisplayLocale,t.dateDisplayFormat=this.dateDisplayFormat,this.contentControlListItems.length>0)for(var i=0;i<this.contentControlListItems.length;i++)t.contentControlListItems.push(this.contentControlListItems[i].clone());return this.checkedState&&(t.checkedState=this.checkedState.clone()),this.uncheckedState&&(t.uncheckedState=this.uncheckedState.clone()),this.xmlMapping&&(t.xmlMapping=this.xmlMapping.clone()),t},e}(),Ha=function(){function e(){}return e.prototype.destroy=function(){this.displayText=void 0,this.value=void 0},e.prototype.clone=function(){var t=new e;return t.displayText=this.displayText,t.value=this.value,t},e}(),Ea=function(){function e(){}return e.prototype.destroy=function(){this.font=void 0,this.value=void 0},e.prototype.clone=function(){var t=new e;return t.font=this.font,t.value=this.value,t},e}(),Ra=function(){function e(){}return e.prototype.destroy=function(){this.isMapped=void 0,this.isWordMl=void 0,this.prefixMapping=void 0,this.xPath=void 0,this.storeItemId=void 0,this.customXmlPart=void 0},e.prototype.clone=function(){var t=new e;return t.isMapped=this.isMapped,t.isWordMl=this.isWordMl,t.prefixMapping=this.prefixMapping,t.xPath=this.xPath,t.storeItemId=this.storeItemId,this.customXmlPart&&(t.customXmlPart=this.customXmlPart.clone()),t},e}(),Ua=function(){function e(){}return e.prototype.destroy=function(){this.id=void 0,this.xml=void 0},e.prototype.clone=function(){var t=new e;return t.id=this.id,t.xml=this.xml,t},e}(),Ba=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.verticalPosition=0,t.horizontalPosition=0,t.textWrappingStyle="Inline",t.distanceBottom=0,t.distanceLeft=0,t.distanceRight=0,t.distanceTop=0,t}return ta(t,e),t}(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.name="",t.alternateText="",t.title="",t}return ta(t,e),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){return new La},t}(ya)),La=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ta(t,e),t.prototype.clone=function(){var e=new t;if(e.characterFormat.copyFormat(this.characterFormat),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e.shapeId=this.shapeId,e.name=this.name,e.alternateText=this.alternateText,e.title=this.title,e.widthScale=this.widthScale,e.heightScale=this.heightScale,e.visible=this.visible,e.verticalPosition=this.verticalPosition,e.verticalAlignment=this.verticalAlignment,e.verticalOrigin=this.verticalOrigin,e.verticalRelativePercent=this.verticalRelativePercent,e.horizontalPosition=this.horizontalPosition,e.horizontalAlignment=this.horizontalAlignment,e.horizontalRelativePercent=this.horizontalRelativePercent,e.heightRelativePercent=this.heightRelativePercent,e.widthRelativePercent=this.widthRelativePercent,e.horizontalOrigin=this.horizontalOrigin,e.zOrderPosition=this.zOrderPosition,e.allowOverlap=this.allowOverlap,e.textWrappingStyle=this.textWrappingStyle,e.textWrappingType=this.textWrappingType,e.distanceBottom=this.distanceBottom,e.distanceLeft=this.distanceLeft,e.distanceRight=this.distanceRight,e.distanceTop=this.distanceTop,e.layoutInCell=this.layoutInCell,e.lockAnchor=this.lockAnchor,e.autoShapeType=this.autoShapeType,this.lineFormat&&(e.lineFormat=this.lineFormat.clone()),this.fillFormat&&(e.fillFormat=this.fillFormat.clone()),this.textFrame&&(e.textFrame=this.textFrame.clone(),e.textFrame.containerShape=e),this.margin&&(e.margin=this.margin.clone()),!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=N.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e},t}(Ba),Aa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.marginLeft=0,t.marginRight=0,t.marginTop=0,t.marginBottom=0,t}return ta(t,e),t.prototype.equals=function(){return!1},t.prototype.destroyInternal=function(){},t.prototype.getHierarchicalIndex=function(e){var t=this.containerShape.line,i=t.getOffset(this.containerShape,0).toString();return t.getHierarchicalIndex(i)},t.prototype.getTableCellWidget=function(){},t.prototype.clone=function(){var e=new t;e.textVerticalAlignment=this.textVerticalAlignment,e.marginBottom=this.marginBottom,e.marginLeft=this.marginLeft,e.marginRight=this.marginRight,e.marginTop=this.marginTop;for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.index=i,r.containerWidget=e}return e},t}(oa),Ma=function(){function e(){}return e.prototype.clone=function(){var t=new e;return t.lineFormatType=this.lineFormatType,t.color=this.color,t.weight=this.weight,t.dashStyle=this.dashStyle,t.line=this.line,t},e}(),za=function(){function e(){}return e.prototype.clone=function(){var t=new e;return t.color=this.color,t.fill=this.fill,t},e}(),Da=function(e){function t(t){var i=e.call(this)||this;return i.imageStr="",i.imgElement=void 0,i.isInlineImageIn=!0,i.crop=!1,i.left=0,i.top=0,i.right=0,i.bottom=0,i.isMetaFile=!1,i.isCompressed=!1,i.isInlineImageIn=t,i}return ta(t,e),Object.defineProperty(t.prototype,"isCrop",{get:function(){return this.crop},set:function(e){if(this.crop=e,e){var t=0,i=0;0!==this.left?this.cropX=this.left*this.cropWidthScale/100:this.cropX=0,0!==this.top?this.cropY=this.top*this.cropHeightScale/100:this.cropY=0,0!==this.right&&(t=this.right*this.cropWidthScale/100),0!==this.bottom&&(i=this.bottom*this.cropHeightScale/100),this.cropWidth=this.cropWidthScale-(this.cropX+t),this.cropHeight=this.cropHeightScale-(this.cropY+i)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInlineImage",{get:function(){return this.isInlineImageIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return sf.base.isNullOrUndefined(this.imgElement)&&(this.imgElement=document.createElement("img")),this.imgElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageString",{get:function(){return this.imageStr},set:function(e){this.imageStr=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.isInlineImage);if(e.characterFormat.copyFormat(this.characterFormat),e.imageString=this.imageString,e.element.src=this.element.src,e.isMetaFile=this.isMetaFile,e.isCompressed=this.isCompressed,e.metaFileImageString=this.metaFileImageString,e.width=this.width,e.height=this.height,e.top=this.top,e.left=this.left,e.bottom=this.bottom,e.right=this.right,e.cropHeightScale=this.cropHeightScale,e.cropWidthScale=this.cropWidthScale,e.cropX=this.cropX,e.cropY=this.cropY,e.isCrop=this.isCrop,e.x=this.x,e.y=this.y,this.margin&&(e.margin=this.margin.clone()),!sf.base.isNullOrUndefined(this.paragraph)&&this.paragraph.isInHeaderFooter){if(this.revisions.length>0)for(var i=0;i<this.revisions.length;i++){var r=this.revisions[i];e.revisions.push(r.clone())}}else this.revisions.length>0?e.removedIds=N.cloneRevisions(this.revisions):e.removedIds=this.removedIds.slice();return e.name=this.name,e.alternateText=this.alternateText,e.title=this.title,e.visible=this.visible,e.widthScale=this.widthScale,e.heightScale=this.heightScale,e.verticalPosition=this.verticalPosition,e.verticalOrigin=this.verticalOrigin,e.verticalAlignment=this.verticalAlignment,e.horizontalPosition=this.horizontalPosition,e.horizontalOrigin=this.horizontalOrigin,e.horizontalAlignment=this.horizontalAlignment,e.allowOverlap=this.allowOverlap,e.textWrappingStyle=this.textWrappingStyle,e.textWrappingType=this.textWrappingType,e.layoutInCell=this.layoutInCell,e.zOrderPosition=this.zOrderPosition,e},t.prototype.destroy=function(){this.imgElement=void 0,this.imageString=void 0,this.isInlineImageIn=void 0,e.prototype.destroy.call(this)},t}(Ba),Va=function(e){function t(t,i){var r=e.call(this)||this;return r.baselineOffset=0,r.trimEndWidth=0,r.isFollowCharacter=!1,r.listLevel=t,r.isFollowCharacter=i,r}return ta(t,e),t.prototype.getLength=function(){return this.text?this.text.length:0},t.prototype.clone=function(){var e=new t(this.listLevel,this.isFollowCharacter);return e.text=this.text,e.baselineOffset=this.baselineOffset,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,e},t.prototype.destroy=function(){this.text=void 0,e.prototype.destroy.call(this)},t}(ya),qa=function(e){function t(){var t=e.call(this)||this;return t.editRangeStart=void 0,t.editRangeId=-1,t}return ta(t,e),t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.editRangeStart=void 0},t.prototype.clone=function(){var e=new t;return e.editRangeStart=this.editRangeStart,e.editRangeId=this.editRangeId,e},t}(ya),_a=function(e){function t(){var t=e.call(this)||this;return t.columnFirst=-1,t.columnLast=-1,t.user="",t.group="",t.editRangeId=-1,t}return ta(t,e),t.prototype.getLength=function(){return 1},t.prototype.renderLockMark=function(e,t){if(sf.base.isNullOrUndefined(this.editRangeMark)){var i=e===this.user?"you":this.user;this.editRangeMark=document.createElement("div"),this.editRangeMark.style.display="none",this.editRangeMark.classList.add("e-de-lock-mark");var r=document.createElement("span");r.className="e-icons e-de-ctnr-lock",this.editRangeMark.appendChild(r),this.editRangeMark.title=t.getConstant("This region is locked by")+" "+i}this.line&&sf.base.isNullOrUndefined(this.editRangeMark.parentElement)&&this.line.paragraph.bodyWidget.page.documentHelper.pageContainer.appendChild(this.editRangeMark)},t.prototype.removeEditRangeMark=function(){this.editRangeMark&&(this.editRangeMark.parentElement.removeChild(this.editRangeMark),this.editRangeMark=void 0)},t.prototype.destroy=function(){this.user=void 0,this.columnFirst=void 0,this.columnLast=void 0},t.prototype.clone=function(){var e=new t;return e.columnFirst=this.columnFirst,e.columnLast=this.columnLast,e.user=this.user,e.group=this.group,e.editRangeEnd=this.editRangeEnd,e.editRangeId=this.editRangeId,e},t}(ya),ja=function(e){function t(){var t=e.call(this)||this;return t.chartTitle="",t.chartType="",t.chartElement=void 0,t.chartCategory=[],t.chartSeries=[],t.chartArea=new Ga,t.chartPlotArea=new Ga,t.chartTitleArea=new tl,t.chartLegend=new Ja,t.chartPrimaryCategoryAxis=new ol,t.chartPrimaryValueAxis=new ol,t.chartDataTable=new sl,t}return ta(t,e),t.prototype.getLength=function(){return 1},Object.defineProperty(t.prototype,"title",{get:function(){return this.chartTitle},set:function(e){this.chartTitle=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.chartType},set:function(e){this.chartType=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chartGapWidth",{get:function(){return this.gapWidth},set:function(e){this.gapWidth=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"chartOverlap",{get:function(){return this.overlap},set:function(e){this.overlap=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"targetElement",{get:function(){return sf.base.isNullOrUndefined(this.div)&&(this.div=sf.base.createElement("div")),this.div},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"officeChart",{get:function(){return this.officeChartInternal},set:function(e){e&&(this.officeChartInternal=e,this.officeChartInternal.chart.loaded=this.onChartLoaded.bind(this))},enumerable:!0,configurable:!0}),t.prototype.onChartLoaded=function(){var e=this;this.officeChart.convertChartToImage(this.officeChart.chart,this.width,this.height).then((function(t){e.imageString=t,e.element.src=t}))},t.prototype.clone=function(){var e=new t;e.chartTitle=this.chartTitle,e.chartType=this.chartType,e.height=this.height,e.width=this.width,e.gapWidth=this.gapWidth,e.overlap=this.overlap;for(var i=0;i<this.chartCategory.length;i++){var r=this.chartCategory[i].clone();e.chartCategory.push(r)}for(i=0;i<this.chartSeries.length;i++){var n=this.chartSeries[i].clone();e.chartSeries.push(n)}return e.chartArea=this.chartArea.clone(),e.chartPlotArea=this.chartPlotArea.clone(),e.chartLegend=this.chartLegend.clone(),e.chartTitleArea=this.chartTitleArea.clone(),e.chartPrimaryCategoryAxis=this.chartPrimaryCategoryAxis.clone(),e.chartPrimaryValueAxis=this.chartPrimaryValueAxis.clone(),e.chartDataTable=this.chartDataTable.clone(),e},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.officeChartInternal&&(this.officeChartInternal.chart.loaded=void 0,this.officeChartInternal.destroy(),this.officeChartInternal=void 0),this.div&&(this.div=void 0),this.chartTitle=void 0,this.chartType=void 0,this.chartArea=void 0,this.chartPlotArea=void 0,this.chartCategory=[],this.chartSeries=[],this.chartTitleArea=void 0,this.chartLegend=void 0,this.chartPrimaryCategoryAxis=void 0,this.chartPrimaryValueAxis=void 0,this.chartDataTable=void 0,this.chartElement=void 0},t}(Da),Ga=function(){function e(){}return Object.defineProperty(e.prototype,"chartForeColor",{get:function(){return this.foreColor},set:function(e){this.foreColor=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.foreColor=this.foreColor,t},e.prototype.destroy=function(){this.foreColor=void 0},e}(),Ka=function(){function e(){this.categoryXName="",this.chartData=[]}return Object.defineProperty(e.prototype,"xName",{get:function(){return this.categoryXName},set:function(e){this.categoryXName=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;t.categoryXName=this.categoryXName;for(var i=0;i<this.chartData.length;i++){var r=this.chartData[i].clone();t.chartData.push(r)}return t},e.prototype.destroy=function(){this.categoryXName=void 0,this.chartData=[]},e}(),Xa=function(){function e(){}return Object.defineProperty(e.prototype,"yAxisValue",{get:function(){return this.yValue},set:function(e){this.yValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"xAxisValue",{get:function(){return this.xValue},set:function(e){this.xValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bubbleSize",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.yValue=this.yValue,t.xValue=this.xValue,t.size=this.size,t},e.prototype.destroy=function(){this.xValue=void 0,this.yValue=void 0,this.size=void 0},e}(),Ja=function(){function e(){this.chartTitleArea=new tl}return Object.defineProperty(e.prototype,"chartLegendPostion",{get:function(){return this.legendPostion},set:function(e){this.legendPostion=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.legendPostion=this.legendPostion,t.chartTitleArea=this.chartTitleArea.clone(),t},e.prototype.destroy=function(){this.legendPostion=void 0,this.chartTitleArea=void 0},e}(),Ya=function(){function e(){this.chartDataFormat=[],this.trendLines=[],this.errorBar=new Za,this.dataLabels=new $a,this.seriesFormat=new Qa}return Object.defineProperty(e.prototype,"seriesName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstSliceAngle",{get:function(){return this.sliceAngle},set:function(e){this.sliceAngle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"doughnutHoleSize",{get:function(){return this.holeSize},set:function(e){this.holeSize=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;t.name=this.name,t.sliceAngle=this.sliceAngle,t.holeSize=this.holeSize,t.errorBar=this.errorBar.clone(),t.dataLabels=this.dataLabels.clone(),t.seriesFormat=this.seriesFormat.clone();for(var i=0;i<this.chartDataFormat.length;i++){var r=this.chartDataFormat[i].clone();t.chartDataFormat.push(r)}for(i=0;i<this.trendLines.length;i++){var n=this.trendLines[i].clone();t.trendLines.push(n)}return t},e.prototype.destroy=function(){this.name=void 0,this.errorBar=void 0,this.trendLines=void 0,this.chartDataFormat=[]},e}(),Za=function(){function e(){}return Object.defineProperty(e.prototype,"errorType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorDirection",{get:function(){return this.direction},set:function(e){this.direction=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorEndStyle",{get:function(){return this.endStyle},set:function(e){this.endStyle=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberValue",{get:function(){return this.errorValue},set:function(e){this.errorValue=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.type=this.type,t.errorDirection=this.errorDirection,t.endStyle=this.endStyle,t.errorValue=this.errorValue,t},e.prototype.destroy=function(){this.type=void 0,this.errorDirection=void 0,this.endStyle=void 0},e}(),Qa=function(){function e(){}return Object.defineProperty(e.prototype,"markerStyle",{get:function(){return this.style},set:function(e){this.style=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"markerColor",{get:function(){return this.color},set:function(e){this.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberValue",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.style=this.style,t.color=this.color,t.size=this.size,t},e.prototype.destroy=function(){this.style=void 0,this.color=void 0,this.size=void 0},e}(),$a=function(){function e(){}return Object.defineProperty(e.prototype,"labelPosition",{get:function(){return this.position},set:function(e){this.position=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.color},set:function(e){this.color=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.size},set:function(e){this.size=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLegendKey",{get:function(){return this.isLegend},set:function(e){this.isLegend=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBubbleSize",{get:function(){return this.isBubble},set:function(e){this.isBubble=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCategoryName",{get:function(){return this.isCategory},set:function(e){this.isCategory=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSeriesName",{get:function(){return this.isSeries},set:function(e){this.isSeries=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isValue",{get:function(){return this.isValueEnabled},set:function(e){this.isValueEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPercentage",{get:function(){return this.isPercentageEnabled},set:function(e){this.isPercentageEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLeaderLines",{get:function(){return this.showLeaderLines},set:function(e){this.showLeaderLines=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.position=this.position,t.name=this.name,t.color=this.color,t.size=this.size,t.isBubble=this.isBubble,t.isLegend=this.isLegend,t.isCategory=this.isCategory,t.isSeries=this.isSeries,t.isValueEnabled=this.isValueEnabled,t.isPercentageEnabled=this.isPercentageEnabled,t.showLeaderLines=this.showLeaderLines,t},e.prototype.destroy=function(){this.position=void 0},e}(),el=function(){function e(){}return Object.defineProperty(e.prototype,"trendLineType",{get:function(){return this.type},set:function(e){this.type=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trendLineName",{get:function(){return this.name},set:function(e){this.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interceptValue",{get:function(){return this.intercept},set:function(e){this.intercept=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"forwardValue",{get:function(){return this.forward},set:function(e){this.forward=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backwardValue",{get:function(){return this.backward},set:function(e){this.backward=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisplayRSquared",{get:function(){return this.displayRSquared},set:function(e){this.displayRSquared=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisplayEquation",{get:function(){return this.displayEquation},set:function(e){this.displayEquation=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.type=this.type,t.name=this.name,t.forward=this.forward,t.backward=this.backward,t.intercept=this.intercept,t.displayEquation=this.displayEquation,t.displayRSquared=this.displayRSquared,t},e.prototype.destroy=function(){this.type=void 0,this.name=void 0,this.forward=void 0,this.backward=void 0},e}(),tl=function(){function e(){this.dataFormat=new il,this.layout=new nl}return Object.defineProperty(e.prototype,"chartfontName",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chartFontSize",{get:function(){return this.fontSize},set:function(e){this.fontSize=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.fontName=this.fontName,t.fontSize=this.fontSize,t.dataFormat=this.dataFormat.clone(),t.layout=this.layout.clone(),t},e.prototype.destroy=function(){this.fontName=void 0,this.fontSize=void 0,this.dataFormat=void 0,this.layout=void 0},e}(),il=function(){function e(){this.fill=new rl,this.line=new rl}return e.prototype.clone=function(){var t=new e;return t.fill=this.fill.clone(),t.line=this.line.clone(),t},e.prototype.destroy=function(){this.fill=void 0,this.line=void 0},e}(),rl=function(){function e(){}return Object.defineProperty(e.prototype,"color",{get:function(){return this.fillColor},set:function(e){this.fillColor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rgb",{get:function(){return this.fillRGB},set:function(e){this.fillRGB=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.fillColor=this.fillColor,t.fillRGB=this.fillRGB,t},e.prototype.destroy=function(){this.fillColor=void 0,this.fillRGB=void 0},e}(),nl=function(){function e(){}return Object.defineProperty(e.prototype,"chartLayoutLeft",{get:function(){return this.layoutX},set:function(e){this.layoutX=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"chartLayoutTop",{get:function(){return this.layoutY},set:function(e){this.layoutY=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.layoutX=this.layoutX,t.layoutY=this.layoutY,t},e.prototype.destroy=function(){this.layoutX=void 0,this.layoutY=void 0},e}(),ol=function(){function e(){this.chartTitleArea=new tl}return Object.defineProperty(e.prototype,"majorTick",{get:function(){return this.majorTickMark},set:function(e){this.majorTickMark=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorTick",{get:function(){return this.minorTickMark},set:function(e){this.minorTickMark=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tickPosition",{get:function(){return this.tickLabelPostion},set:function(e){this.tickLabelPostion=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorGridLines",{get:function(){return this.hasMinorGridLines},set:function(e){this.hasMinorGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorGridLines",{get:function(){return this.hasMajorGridLines},set:function(e){this.hasMajorGridLines=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"interval",{get:function(){return this.majorUnit},set:function(e){this.majorUnit=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAutoInternal",{get:function(){return this.isAutoMajor},set:function(e){this.isAutoMajor=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this.maximumValue},set:function(e){this.maximumValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this.minimumValue},set:function(e){this.minimumValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryAxisTitle",{get:function(){return this.title},set:function(e){this.title=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryAxisType",{get:function(){return this.categoryType},set:function(e){this.categoryType=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"categoryNumberFormat",{get:function(){return this.numberFormat},set:function(e){this.numberFormat=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"axisFontSize",{get:function(){return this.fontSize},set:function(e){this.fontSize=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"axisFontName",{get:function(){return this.fontName},set:function(e){this.fontName=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.title=this.title,t.categoryType=this.categoryType,t.numberFormat=this.numberFormat,t.fontSize=this.fontSize,t.fontName=this.fontName,t.hasMajorGridLines=this.hasMajorGridLines,t.hasMinorGridLines=this.hasMinorGridLines,t.minimumValue=this.minimumValue,t.maximumValue=this.maximumValue,t.majorUnit=this.majorUnit,t.isAutoMajor=this.isAutoMajor,t.majorTickMark=this.majorTickMark,t.minorTickMark=this.minorTickMark,t.tickLabelPostion=this.tickLabelPostion,t.chartTitleArea=this.chartTitleArea.clone(),t},e.prototype.destroy=function(){this.title=void 0,this.categoryType=void 0,this.numberFormat=void 0,this.chartTitleArea=void 0,this.minimumValue=void 0,this.maximumValue=void 0,this.fontSize=void 0,this.fontName=void 0,this.majorUnit=void 0,this.majorTickMark=void 0,this.minorTickMark=void 0,this.tickLabelPostion=void 0},e}(),sl=function(){function e(){}return Object.defineProperty(e.prototype,"showSeriesKeys",{get:function(){return this.isSeriesKeys},set:function(e){this.isSeriesKeys=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasHorzBorder",{get:function(){return this.isHorzBorder},set:function(e){this.isHorzBorder=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasVertBorder",{get:function(){return this.isVertBorder},set:function(e){this.isVertBorder=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasBorders",{get:function(){return this.isBorders},set:function(e){this.isBorders=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.isSeriesKeys=this.isSeriesKeys,t.isHorzBorder=this.isHorzBorder,t.isVertBorder=this.isVertBorder,t.isBorders=this.isBorders,t},e.prototype.destroy=function(){this.isSeriesKeys=void 0,this.isHorzBorder=void 0,this.isVertBorder=void 0,this.isBorders=void 0},e}(),al=function(e){function t(t){var i=e.call(this)||this;return i.commentType=0,i.commentId="",i.commentType=t,i}return ta(t,e),Object.defineProperty(t.prototype,"comment",{get:function(){return this.commentInternal},set:function(e){this.commentInternal=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.commentType);return e.commentId=this.commentId,e.commentType=this.commentType,sf.base.isNullOrUndefined(this.commentInternal)||(e.commentInternal=this.commentInternal.clone()),e},t.prototype.renderCommentMark=function(e,t){var i=this.line.paragraph.bodyWidget.page.documentHelper,r=i.render.commentMarkDictionary;if(0===this.commentType&&sf.base.isNullOrUndefined(this.commentMark)){this.commentMark=document.createElement("div"),this.commentMark.style.display="none",this.commentMark.classList.add("e-de-cmt-mark");var n=document.createElement("span");n.classList.add("e-icons"),n.classList.add("e-de-cmt-mark-icon"),this.commentMark.appendChild(n)}this.line&&sf.base.isNullOrUndefined(this.commentMark.parentElement)&&(i.pageContainer.appendChild(this.commentMark),this.commentMark.addEventListener("click",this.selectComment.bind(this)));for(var o,s=!1,a=0;a<r.length;a++)if(this.elementsOverlap(r.keys[a],e,t)){s=!0,o=r.keys[a];break}if(s){var l=!0;for(a=0;a<r.get(o).length;a++)if(r.get(o)[a]===this){l=!1;break}l&&r.get(o).push(this)}else r.add(this.commentMark,[this]);for(a=0;a<r.length;a++){var d=r.keys[a];if(1==r.get(d).length&&r.get(d)[0].commentMark&&(r.get(d)[0].commentMark.firstElementChild.classList.contains("e-de-multi-cmt-mark")?sf.base.classList(r.get(d)[0].commentMark.firstElementChild,["e-de-cmt-mark-icon"],["e-de-multi-cmt-mark"]):r.get(d)[0].commentInternal.isResolved&&r.get(d)[0].commentMark.firstElementChild.classList.contains("e-de-cmt-mark-icon")?sf.base.classList(r.get(d)[0].commentMark.firstElementChild,["e-de-cmt-resolve-icon"],["e-de-cmt-mark-icon"]):!r.get(d)[0].commentInternal.isResolved&&r.get(d)[0].commentMark.firstElementChild.classList.contains("e-de-cmt-resolve-icon")&&sf.base.classList(r.get(d)[0].commentMark.firstElementChild,["e-de-cmt-mark-icon"],["e-de-cmt-resolve-icon"])),r.get(d).length>1)for(var h=0;h<r.get(d).length;h++){for(var c=!0,p=0;p<r.get(d).length;p++)if(!r.get(d)[p].commentInternal.isResolved){c=!1;break}r.get(d)[h].commentMark&&(r.get(d)[h].commentMark.firstElementChild.classList.contains("e-de-cmt-mark-icon")?sf.base.classList(r.get(d)[h].commentMark.firstElementChild,["e-de-multi-cmt-mark"],["e-de-cmt-mark-icon"]):!c&&r.get(d)[h].commentMark.firstElementChild.classList.contains("e-de-multi-cmt-resolve")?sf.base.classList(r.get(d)[h].commentMark.firstElementChild,["e-de-multi-cmt-mark"],["e-de-multi-cmt-resolve"]):c&&sf.base.classList(r.get(d)[h].commentMark.firstElementChild,["e-de-multi-cmt-resolve"],["e-de-multi-cmt-mark"]))}}},t.prototype.elementsOverlap=function(e,t,i){var r=e.offsetWidth,n=e.offsetHeight,o=parseFloat(e.style.top),s=parseFloat(e.style.left),a=o+n,l=s+r,d=parseFloat(t),h=parseFloat(i);return!(o>d+n||l<h||a<d||s>h+r)},t.prototype.selectComment=function(){for(var e=this.line.paragraph.bodyWidget.page.documentHelper,t=e.render.commentMarkDictionary,i=this.commentMark.style.top,r=this.commentMark.style.left,n=0,o=[],s=0;s<t.keys.length;s++)if(this.elementsOverlap(t.keys[s],i,r)){o=t.get(t.keys[s]);break}if(e.owner.documentHelper.currentSelectedComment){for(s=0;s<o.length;s++)if(o[s].comment===e.owner.documentHelper.currentSelectedComment){n=s;break}n<o.length-1?n+=1:n=0}else n=0;e.owner&&e.selectComment(o[n].comment)},t.prototype.removeCommentMark=function(){this.commentMark&&this.commentMark.parentElement&&(this.commentMark.removeEventListener("click",this.selectComment.bind(this)),this.commentMark.parentElement.removeChild(this.commentMark))},t.prototype.destroy=function(){this.commentMark&&this.removeCommentMark()},t}(ya),ll=function(e){function t(t){var i=e.call(this,0)||this;return i.authorIn="",i.initialIn="",i.done=!1,i.textIn="",i.isReply=!1,i.ownerComment=void 0,i.createdDate=t,i.replyComments=[],i}return ta(t,e),Object.defineProperty(t.prototype,"commentStart",{get:function(){return this.commentStartIn},set:function(e){this.commentStartIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commentEnd",{get:function(){return this.commentEndIn},set:function(e){this.commentEndIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"author",{get:function(){return this.authorIn},set:function(e){this.authorIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initial",{get:function(){return this.initialIn},set:function(e){this.initialIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isResolved",{get:function(){return this.done},set:function(e){this.done=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"date",{get:function(){return this.createdDate},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.textIn},set:function(e){this.textIn=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.date);return e.author=this.author,e.initial=this.initial,e.commentId=this.commentId,e.replyComments=this.replyComments,e.isResolved=this.isResolved,e.text=this.text,e},t.prototype.destroy=function(){this.ownerComment=void 0},t}(al),dl=function(){function e(e){this.boundingRectangle=new ia(96,96,816,1056),this.repeatHeaderRowTableWidget=!1,this.bodyWidgets=[],this.headerWidgetIn=void 0,this.footerWidgetIn=void 0,this.footnoteWidget=void 0,this.endnoteWidget=void 0,this.currentPageNum=1,this.allowNextPageRendering=!0,this.documentHelper=e}return Object.defineProperty(e.prototype,"headerWidget",{get:function(){return!sf.base.isNullOrUndefined(this.headerWidgetIn)&&this.headerWidgetIn.parentHeaderFooter?this.headerWidgetIn.parentHeaderFooter:this.headerWidgetIn},set:function(e){this.headerWidgetIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerWidget",{get:function(){return!sf.base.isNullOrUndefined(this.footerWidgetIn)&&this.footerWidgetIn.parentHeaderFooter?this.footerWidgetIn.parentHeaderFooter:this.footerWidgetIn},set:function(e){this.footerWidgetIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.documentHelper?this.documentHelper.pages.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousPage",{get:function(){var e=this.index;if(e>0)return this.documentHelper.pages[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextPage",{get:function(){var e=this.index;if(e<this.documentHelper.pages.length-1)return this.documentHelper.pages[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sectionIndex",{get:function(){return this.bodyWidgets.length>0?this.bodyWidgets[0].index:-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.headerWidget&&this.headerWidget.page===this&&(this.headerWidget.page=void 0),this.footerWidget&&this.footerWidget.page===this&&(this.footerWidget.page=void 0),this.headerWidgetIn&&!sf.base.isNullOrUndefined(this.headerWidgetIn.parentHeaderFooter)&&(this.viewer&&this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.removeFieldInWidget(this.headerWidgetIn),this.documentHelper.owner.editor.removeFieldInWidget(this.headerWidgetIn,!1,!0)),this.headerWidgetIn.destroy(),this.headerWidget=void 0),this.footerWidgetIn&&!sf.base.isNullOrUndefined(this.footerWidgetIn.parentHeaderFooter)&&(this.viewer&&this.documentHelper.owner.editor&&(this.documentHelper.owner.editor.removeFieldInWidget(this.footerWidgetIn),this.documentHelper.owner.editor.removeFieldInWidget(this.footerWidgetIn,!1,!0)),this.footerWidgetIn.destroy(),this.footerWidgetIn=void 0),this.bodyWidgets=[],this.bodyWidgets=void 0,sf.base.isNullOrUndefined(this.documentHelper)||sf.base.isNullOrUndefined(this.documentHelper.pages)||this.documentHelper.removePage(this),this.documentHelper=void 0},e}(),hl=function(){function e(){this.tableColumns=[],this.tableWidth=0}return Object.defineProperty(e.prototype,"columns",{get:function(){return this.tableColumns},enumerable:!0,configurable:!0}),e.prototype.resetColumns=function(){for(var e=0;e<this.tableColumns.length;e++)this.tableColumns[e].destroy();this.tableColumns=[]},e.prototype.getPreviousSpannedCellWidth=function(e,t){for(var i=0,r=e;r<t;r++)i+=this.tableColumns[r].preferredWidth;return i},e.prototype.addColumns=function(e,t,i,r,n,o){for(var s=this.columns.length;s<t;s++)this.columns.push(new cl);for(var a=0,l=e;l<t;l++)a+=this.columns[l].preferredWidth;!(t-e>1)&&a<i&&(this.columns[t-1].preferredWidth+=i-a),r.minimumWordWidth>this.columns[t-1].minimumWordWidth&&(this.columns[t-1].minimumWordWidth=r.minimumWordWidth),r.maximumWordWidth>this.columns[t-1].maximumWordWidth&&(this.columns[t-1].maximumWordWidth=r.maximumWordWidth),r.minimumWidth>this.columns[t-1].minimumWidth&&(this.columns[t-1].minimumWidth=r.minimumWidth),n>this.columns[t-1].endOffset&&(this.columns[t-1].endOffset=n),this.columns[t-1].widthType=o},e.prototype.getTotalWidth=function(e){for(var t=0,i=0;i<this.columns.length;i++){var r=this.columns[i];t+=0===e?r.preferredWidth:1===e?r.minimumWordWidth:2===e?r.maximumWordWidth:r.minimumWidth}return t},e.prototype.isFitColumns=function(e,t,i){var r=this.getTotalWidth(0);if(this.tableWidth=i&&t>r?r:t,r!==this.tableWidth){var n=this.tableWidth/r;n=isNaN(n)||n===1/0?1:n;for(var o=0;o<this.columns.length;o++){var s=this.columns[o];if(n*s.preferredWidth<s.minWidth)return!1}return!0}return!0},e.prototype.isAllColumnHasPointWidthType=function(){for(var e=!0,t=0;t<this.columns.length;t++)"Point"!=this.columns[t].widthType&&(e=!1);return e},e.prototype.autoFitColumn=function(e,t,i,r,n,o,s,a){for(var l=0,d=0,h=0,c=!0,p=0,g=[],f=0;f<this.columns.length;f++){0===(w=this.columns[f]).minimumWordWidth&&0===w.maximumWordWidth&&0===w.minWidth&&(w.minimumWordWidth=w.preferredWidth,w.maximumWordWidth=w.preferredWidth,w.minWidth=w.preferredWidth),"Point"!==w.widthType&&(c=!1);var u=0;l+=w.preferredWidth>w.maximumWordWidth?w.preferredWidth:w.maximumWordWidth,d+=w.preferredWidth>w.minimumWordWidth?w.preferredWidth:w.minimumWordWidth;var m=0===w.preferredWidth?w.minimumWordWidth:w.preferredWidth>w.minimumWordWidth?w.preferredWidth:w.minimumWordWidth;h+=(u=w.maximumWordWidth-m)>0?u:0,w.preferredWidth<w.minimumWordWidth?p+=w.minimumWordWidth-w.preferredWidth:g.push(f)}if(l<=t){for(f=0;f<this.columns.length;f++){"Point"!==(w=this.columns[f]).widthType?w.preferredWidth<w.maximumWordWidth&&(w.preferredWidth=w.maximumWordWidth):w.preferredWidth<w.minimumWordWidth&&(w.preferredWidth=w.minimumWordWidth)}i||this.fitColumns(e,t,i,n)}else{var y=this.getTotalWidth(0);if(c&&!o&&d>e&&(e>y&&(p-=e-y),g.length>0&&p>0)){var v=p/g.length;for(f=0;f<this.columns.length;f++){var w=this.columns[f];-1===g.indexOf(f)?w.preferredWidth=w.minimumWordWidth:w.preferredWidth=w.preferredWidth-v}y=this.getTotalWidth(0)}if(!i){var b=!1;return t<d&&d+(sf.base.isNullOrUndefined(s)?0:s)<e&&(b=!0),void this.fitColumns(e,b?d:t,i,n)}if(d<=t||d<=e){var x=e>t?e:t;x-=d;for(f=0;f<this.columns.length;f++){if("Point"!==(w=this.columns[f]).widthType){(0===w.preferredWidth||w.preferredWidth<w.minimumWordWidth)&&(w.preferredWidth=w.minimumWordWidth);var I=x*((u=(u=w.maximumWordWidth-w.preferredWidth)>0?u:0)/h);w.preferredWidth+=isNaN(I)?0:I}}}else{var F=this.getTotalWidth(1),C=this.getTotalWidth(3);if(C>2112){var W=2112/this.columns.length;for(f=0;f<this.columns.length;f++)this.columns[f].preferredWidth=W}else{x=0;if(C<e&&e-C>=1&&!c||c&&!o&&F>e){x=e-C;for(f=0;f<this.columns.length;f++){I=x*(w=this.columns[f]).minimumWordWidth/F;I=isNaN(I)?0:I,w.preferredWidth=(0==w.minimumWidth?1:w.minimumWidth)+I}}else if(y>e)for(I=e/y,f=0;f<this.columns.length;f++){(w=this.columns[f]).preferredWidth=w.preferredWidth*I}}}}this.tableWidth=this.getTotalWidth(0)},e.prototype.getValidColumnIndex=function(e){for(var t=0,i=0;i<this.columns.length;i++){var r=this.columns[i];if(i<e)t=r.endOffset;else{if(t!==r.endOffset)break;e++}}return e},e.prototype.fitColumns=function(e,t,i,r,n){sf.base.isNullOrUndefined(n)&&(n=0);var o=this.getTotalWidth(0);if(i&&(o-=n),this.tableWidth=i?o:t,o!==this.tableWidth){var s=this.tableWidth/o;s=isNaN(s)||s===1/0?1:s;for(var a=0;a<this.columns.length;a++){var l=this.columns[a];if("Percent"===l.widthType&&!i&&!r&&o>this.tableWidth){if(0!==a&&l.endOffset>this.tableWidth){var d=this.getCellWidth(0,a+1,t);d>this.tableWidth&&(l.preferredWidth-=d-this.tableWidth,(0===l.preferredWidth||l.preferredWidth<l.minimumWidth)&&(l.preferredWidth=l.minimumWidth>0?l.minimumWidth:1,this.columns[0].preferredWidth-=l.preferredWidth))}}else l.preferredWidth=s*l.preferredWidth}}},e.prototype.getCellWidth=function(e,t,i){for(var r=0,n=0;n<t;n++)r+=this.tableColumns[n+e].preferredWidth;return r},e.prototype.validateColumnWidths=function(){for(var e=0;e<this.columns.length;e++)0===e?this.columns[e].preferredWidth!==this.columns[e].endOffset&&(this.columns[e].preferredWidth=this.columns[e].endOffset):this.columns[e-1].endOffset+this.columns[e].preferredWidth<this.columns[e].endOffset&&(0===this.columns[e-1].endOffset?this.columns[e].preferredWidth=this.columns[e].endOffset-this.getPreviousValidOffset(e-2):this.columns[e].preferredWidth=this.columns[e].endOffset-this.columns[e-1].endOffset)},e.prototype.getPreviousValidOffset=function(e){for(var t=e;t>=0;t--)if(0!==this.columns[t].endOffset)return this.columns[t].endOffset;return 0},e.prototype.clone=function(){var t=new e;t.tableWidth=this.tableWidth;for(var i=0;i<this.columns.length;i++)t.columns.push(this.columns[i].clone());return t},e.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.tableColumns))for(var e=0;e<this.tableColumns.length;e++){this.tableColumns[e].destroy()}this.tableColumns=[],this.tableColumns=void 0,this.tableWidth=void 0},e}(),cl=function(){function e(){this.preferredWidth=0,this.minWidth=0,this.maxWidth=0,this.endOffset=0,this.minimumWordWidth=0,this.maximumWordWidth=0,this.minimumWidth=0}return e.prototype.clone=function(){var t=new e;return t.preferredWidth=this.preferredWidth,t.minWidth=this.minWidth,t.maxWidth=this.maxWidth,t},e.prototype.destroy=function(){this.preferredWidth=void 0,this.minWidth=void 0,this.maxWidth=void 0},e}(),pl=function(){this.minimumWordWidth=0,this.maximumWordWidth=0,this.minimumWidth=0,this.hasMinimumWidth=!1,this.hasMinimumWordWidth=!1,this.hasMaximumWordWidth=!1},gl=function(e){function t(){return e.call(this)||this}return ta(t,e),t.prototype.clone=function(){var t=e.prototype.clone.call(this);return t.breakClearType=this.breakClearType,t},t.prototype.destroy=function(){this.breakClearType=void 0,e.prototype.destroy.call(this)},t}(Fa),fl=function(){function e(){}return Object.defineProperty(e.prototype,"position",{get:function(){return this.positionIn},set:function(e){this.positionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deletePosition",{get:function(){return this.deletePositionIn},set:function(e){this.deletePositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabJustification",{get:function(){return this.justification},set:function(e){this.justification=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabLeader",{get:function(){return this.leader},set:function(e){this.leader=e},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e;return t.deletePosition=this.deletePosition,t.position=this.position,t.tabJustification=this.tabJustification,t.tabLeader=this.tabLeader,t},e.prototype.equals=function(e){return this.position===e.position&&this.deletePosition===e.deletePosition&&this.tabJustification===e.tabJustification&&this.tabLeader===e.tabLeader},e.prototype.destroy=function(){this.position=void 0,this.deletePosition=void 0,this.tabJustification=void 0,this.leader=void 0},e}(),ul=function(){function e(e){this.uniqueParagraphFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.tabs=void 0,this.ownerBase=e,this.listFormat=new m(this),this.borders=new g(this),this.tabs=[]}return e.prototype.getUpdatedTabs=function(){for(var e=[],t=new a,i=0,r=this.getTabStopsFromListFormat();i<r.length;i++){var n=r[i];t.containsKey(n.position)||t.add(n.position,n)}if(!sf.base.isNullOrUndefined(this.baseStyle)&&this.baseStyle instanceof vl){for(var o=this.baseStyle;!sf.base.isNullOrUndefined(o);){for(var s=0,l=o.paragraphFormat.tabs;s<l.length;s++){var d=l[s];t.containsKey(d.position)||t.add(d.position,d)}o=o.basedOn}for(var h=0,c=t.keys;h<c.length;h++){var p=c[h];this.hasTabStop(parseFloat(p.toFixed(4)))||e.push(t.get(p))}}return e=(e=e.concat(this.tabs.filter((function(e){return 0!==e.position&&0===e.deletePosition})))).sort((function(e,t){return e.position-t.position}))},e.prototype.getTabStopsFromListFormat=function(){if(this.listFormat.listId>-1&&this.listFormat.listLevelNumber>-1){var e=this.listFormat.listLevel;if(e&&e.paragraphFormat)return e.paragraphFormat.tabs}return[]},e.prototype.hasTabStop=function(e){for(var t=0;t<this.tabs.length;t++)if(parseFloat(this.tabs[t].position.toFixed(4))===e||parseFloat(this.tabs[t].deletePosition.toFixed(4))===e)return!0;return!1},Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightIndent",{get:function(){return this.getPropertyValue("rightIndent")},set:function(e){this.setPropertyValue("rightIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstLineIndent",{get:function(){return this.getPropertyValue("firstLineIndent")},set:function(e){this.setPropertyValue("firstLineIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beforeSpacing",{get:function(){return this.getPropertyValue("beforeSpacing")},set:function(e){this.setPropertyValue("beforeSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"afterSpacing",{get:function(){return this.getPropertyValue("afterSpacing")},set:function(e){this.setPropertyValue("afterSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceBeforeAuto",{get:function(){return this.getPropertyValue("spaceBeforeAuto")},set:function(e){this.setPropertyValue("spaceBeforeAuto",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceAfterAuto",{get:function(){return this.getPropertyValue("spaceAfterAuto")},set:function(e){this.setPropertyValue("spaceAfterAuto",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this.getPropertyValue("lineSpacing")},set:function(e){this.setPropertyValue("lineSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacingType",{get:function(){return this.getPropertyValue("lineSpacingType")},set:function(e){this.setPropertyValue("lineSpacingType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlignment",{get:function(){var e=this.getPropertyValue("textAlignment");return this.bidi&&("Left"===e?e="Right":"Right"===e&&(e="Left")),e},set:function(e){this.setPropertyValue("textAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepWithNext",{get:function(){return this.getPropertyValue("keepWithNext")},set:function(e){this.setPropertyValue("keepWithNext",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepLinesTogether",{get:function(){return this.getPropertyValue("keepLinesTogether")},set:function(e){this.setPropertyValue("keepLinesTogether",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"widowControl",{get:function(){return this.getPropertyValue("widowControl")},set:function(e){this.setPropertyValue("widowControl",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineLevel",{get:function(){return this.getPropertyValue("outlineLevel")},set:function(e){this.setPropertyValue("outlineLevel",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextualSpacing",{get:function(){return this.getPropertyValue("contextualSpacing")},set:function(e){this.setPropertyValue("contextualSpacing",e)},enumerable:!0,configurable:!0}),e.prototype.getListFormatParagraphFormat=function(t){var i=this.getListPargaraphFormat(t);if(!sf.base.isNullOrUndefined(i))return i.uniqueParagraphFormat.propertiesHash.get(l.getPropertyType(e.uniqueFormatType,t))},e.prototype.getListPargaraphFormat=function(t){if(this.listFormat.listId>-1&&this.listFormat.listLevelNumber>-1){var i=this.listFormat.listLevel,r=l.getPropertyType(e.uniqueFormatType,t);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.paragraphFormat.uniqueParagraphFormat)||!i.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(r)?void 0:i.paragraphFormat}if(this.listFormat.hasValue("listId")&&-1===this.listFormat.listId&&("leftIndent"===t||"firstLineIndent"===t)){var n=new e;return this.hasValue("leftIndent")||(n.leftIndent=0),this.hasValue("firstLineIndent")||(n.firstLineIndent=0),n}},e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){s=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueParagraphFormat)&&this.uniqueParagraphFormat.propertiesHash.containsKey(s))return this.uniqueParagraphFormat.propertiesHash.get(s)}else{var i=this.getListFormatParagraphFormat(t);if(this.baseStyle instanceof vl){for(var r=this,n=this.baseStyle;!sf.base.isNullOrUndefined(n);){var o=void 0;if(this.listFormat.hasValue("listId")||(o=n.paragraphFormat.getListPargaraphFormat(t)),n.paragraphFormat.hasValue(t)){r=n.paragraphFormat;break}if(!sf.base.isNullOrUndefined(o)&&o.hasValue(t)){r=o;break}n=n.basedOn}if(!sf.base.isNullOrUndefined(n)){if(!sf.base.isNullOrUndefined(i)&&this.listFormat.hasValue("listId")&&-1===r.listFormat.listId&&r.listFormat.listLevelNumber<=1||!sf.base.isNullOrUndefined(i)&&this.listFormat.listId!==r.listFormat.listId&&r.listFormat.listLevelNumber<=1)return i;var s=l.getPropertyType(e.uniqueFormatType,t);return r.uniqueParagraphFormat.propertiesHash.get(s)}}if(!sf.base.isNullOrUndefined(i))return i}return this.getDefaultValue(t)},e.prototype.getDefaultValue=function(t){var i=l.getPropertyType(e.uniqueFormatType,t),r=this.getDocumentParagraphFormat(),n=!0;this.ownerBase&&this.ownerBase instanceof ca&&(n=this.ownerBase.containerWidget instanceof sa||this.ownerBase.containerWidget instanceof Aa||this.ownerBase.containerWidget instanceof ua);var o=!sf.base.isNullOrUndefined(this.ownerBase)&&!sf.base.isNullOrUndefined(this.ownerBase.bodyWidget)&&this.ownerBase.bodyWidget.page&&!sf.base.isNullOrUndefined(this.ownerBase.bodyWidget.page.documentHelper)&&this.ownerBase.bodyWidget.page.documentHelper.owner.editor&&this.ownerBase.bodyWidget.page.documentHelper.owner.editor.isPaste;if(n&&!o&&!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.uniqueParagraphFormat)){var s=r.uniqueParagraphFormat.propertiesHash.get(i);if(!sf.base.isNullOrUndefined(s))return s}return e.getPropertyDefaultValue(t)},e.prototype.getDocumentParagraphFormat=function(){var e;if(!sf.base.isNullOrUndefined(this.ownerBase)){var t=this.getDocumentHelperObject();sf.base.isNullOrUndefined(t)||(e=t.paragraphFormat)}return e},e.prototype.getDocumentHelperObject=function(){var e;if(this.ownerBase instanceof ca){var t=this.ownerBase.bodyWidget;sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.page)||sf.base.isNullOrUndefined(t.page.documentHelper)||(e=t.page.documentHelper)}return e},e.prototype.setPropertyValue=function(t,i,r){if((sf.base.isNullOrUndefined(i)||""===i&&!r)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueParagraphFormat))this.initializeUniqueParagraphFormat(t,i);else{var n=l.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,t);if(this.uniqueParagraphFormat.propertiesHash.containsKey(n)&&this.uniqueParagraphFormat.propertiesHash.get(n)===i)return;this.uniqueParagraphFormat=e.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat,t,i)}},e.prototype.initializeUniqueParagraphFormat=function(t,i){var r=new a;this.addUniqueParaFormat("leftIndent",t,i,r),this.addUniqueParaFormat("rightIndent",t,i,r),this.addUniqueParaFormat("firstLineIndent",t,i,r),this.addUniqueParaFormat("textAlignment",t,i,r),this.addUniqueParaFormat("beforeSpacing",t,i,r),this.addUniqueParaFormat("afterSpacing",t,i,r),this.addUniqueParaFormat("spaceBeforeAuto",t,i,r),this.addUniqueParaFormat("spaceAfterAuto",t,i,r),this.addUniqueParaFormat("lineSpacing",t,i,r),this.addUniqueParaFormat("lineSpacingType",t,i,r),this.addUniqueParaFormat("outlineLevel",t,i,r),this.addUniqueParaFormat("bidi",t,i,r),this.addUniqueParaFormat("contextualSpacing",t,i,r),this.addUniqueParaFormat("keepWithNext",t,i,r),this.addUniqueParaFormat("keepLinesTogether",t,i,r),this.addUniqueParaFormat("widowControl",t,i,r),this.uniqueParagraphFormat=e.uniqueParagraphFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueParaFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftIndent":case"rightIndent":case"firstLineIndent":t=0;break;case"textAlignment":t="Left";break;case"beforeSpacing":case"afterSpacing":t=0;break;case"spaceBeforeAuto":case"spaceAfterAuto":t=!1;break;case"lineSpacing":t=1;break;case"lineSpacingType":t="Multiple";break;case"styleName":t="Normal";break;case"outlineLevel":t="BodyText";break;case"bidi":case"contextualSpacing":case"keepWithNext":case"keepLinesTogether":t=!1;break;case"widowControl":t=!0}return t},e.prototype.clearIndent=function(){this.clearPropertyValue("leftIndent"),this.clearPropertyValue("firstLineIndent")},e.prototype.clearPropertyValue=function(e){if(this.setPropertyValue(e,void 0,!0),!sf.base.isNullOrUndefined(this.uniqueParagraphFormat)){var t=l.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e);this.uniqueParagraphFormat.propertiesHash.containsKey(t)&&this.uniqueParagraphFormat.propertiesHash.remove(t)}},e.prototype.clearFormat=function(){sf.base.isNullOrUndefined(this.listFormat)||this.listFormat.clearFormat(),sf.base.isNullOrUndefined(this.uniqueParagraphFormat)||0!==this.uniqueParagraphFormat.referenceCount||e.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0,this.baseStyle=void 0},e.prototype.destroy=function(){if(this.clearFormat(),sf.base.isNullOrUndefined(this.listFormat)||this.listFormat.destroy(),this.listFormat=void 0,void 0!==this.tabs){for(var e=0;e<this.tabs.length;e++)this.tabs[e].destroy();this.tabs=void 0}sf.base.isNullOrUndefined(this.borders)||this.borders.destroy(),this.borders=void 0},e.prototype.copyFormat=function(e){if(!sf.base.isNullOrUndefined(e)&&(sf.base.isNullOrUndefined(e.uniqueParagraphFormat)||this.updateUniqueParagraphFormat(e),sf.base.isNullOrUndefined(e.borders)||this.borders.copyFormat(e.borders),sf.base.isNullOrUndefined(e.listFormat)||this.listFormat.copyFormat(e.listFormat),sf.base.isNullOrUndefined(e.baseStyle)||(this.baseStyle=e.baseStyle),!sf.base.isNullOrUndefined(e.tabs)))for(var t=0;t<e.tabs.length;t++)this.tabs[t]=e.tabs[t]},e.prototype.updateUniqueParagraphFormat=function(t){var i=void 0;this.uniqueParagraphFormat&&(i=this.uniqueParagraphFormat.mergeProperties(t.uniqueParagraphFormat),0===this.uniqueParagraphFormat.referenceCount&&(e.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0)),this.uniqueParagraphFormat=new l(e.uniqueFormatType),sf.base.isNullOrUndefined(i)&&(i=this.uniqueParagraphFormat.mergeProperties(t.uniqueParagraphFormat)),this.uniqueParagraphFormat=e.uniqueParagraphFormats.addUniqueFormat(i,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.uniqueParagraphFormat=this.uniqueParagraphFormat,t.baseStyle=this.baseStyle,sf.base.isNullOrUndefined(this.listFormat)?t.listFormat=void 0:(t.listFormat=this.listFormat.cloneListFormat(),t.listFormat.ownerBase=t),t.borders=sf.base.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),t},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueParagraphFormat)&&!sf.base.isNullOrUndefined(this.uniqueParagraphFormat.propertiesHash)){var t=l.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e);return this.uniqueParagraphFormat.propertiesHash.containsKey(t)}return!1},e.clear=function(){this.uniqueParagraphFormats.clear()},e.prototype.applyStyle=function(e){this.baseStyle=e,this.listFormat.applyStyle(this.baseStyle)},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e,t){t=!sf.base.isNullOrUndefined(t)&&t,sf.base.isNullOrUndefined(this.getValue("leftIndent"))&&(this.leftIndent=e.getValue("leftIndent")),sf.base.isNullOrUndefined(this.getValue("rightIndent"))&&(this.rightIndent=e.getValue("rightIndent")),sf.base.isNullOrUndefined(this.getValue("firstLineIndent"))&&(this.firstLineIndent=e.getValue("firstLineIndent")),sf.base.isNullOrUndefined(this.getValue("beforeSpacing"))&&(this.beforeSpacing=e.getValue("beforeSpacing")),sf.base.isNullOrUndefined(this.getValue("afterSpacing"))&&(this.afterSpacing=e.getValue("afterSpacing")),sf.base.isNullOrUndefined(this.getValue("spaceBeforeAuto"))&&(this.spaceBeforeAuto=e.getValue("spaceBeforeAuto")),sf.base.isNullOrUndefined(this.getValue("spaceAfterAuto"))&&(this.spaceAfterAuto=e.getValue("spaceAfterAuto")),sf.base.isNullOrUndefined(this.getValue("lineSpacing"))&&(this.lineSpacing=e.getValue("lineSpacing")),sf.base.isNullOrUndefined(this.getValue("lineSpacingType"))&&(this.lineSpacingType=e.getValue("lineSpacingType")),sf.base.isNullOrUndefined(this.getValue("textAlignment"))&&(this.textAlignment=e.getValue("textAlignment")),sf.base.isNullOrUndefined(this.getValue("outlineLevel"))&&(this.outlineLevel=e.getValue("outlineLevel")),!t&&sf.base.isNullOrUndefined(this.getValue("bidi"))&&(this.bidi=e.getValue("bidi")),sf.base.isNullOrUndefined(this.getValue("contextualSpacing"))&&(this.contextualSpacing=e.getValue("contextualSpacing")),sf.base.isNullOrUndefined(this.getValue("keepWithNext"))&&(this.keepWithNext=e.getValue("keepWithNext")),sf.base.isNullOrUndefined(this.getValue("keepLinesTogether"))&&(this.keepLinesTogether=e.getValue("keepLinesTogether")),sf.base.isNullOrUndefined(this.getValue("widowControl"))&&(this.widowControl=e.getValue("widowControl")),sf.base.isNullOrUndefined(this.listFormat)&&this.listFormat.mergeFormat(e.listFormat)},e.uniqueParagraphFormats=new d,e.uniqueFormatType=3,e}(),ml=(w=function(e,t){return(w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}w(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),yl=function(){},vl=function(e){function t(t){var i=e.call(this)||this;return i.ownerBase=t,i.paragraphFormat=new ul(i),i.characterFormat=new T(i),i}return ml(t,e),t.prototype.destroy=function(){this.characterFormat.destroy(),this.paragraphFormat.destroy()},t.prototype.copyStyle=function(e){this.name=e.name,this.ownerBase=e.ownerBase,this.type=e.type,this.next=e.next,this.basedOn=e.basedOn,this.link=e.link,this.characterFormat.copyFormat(e.characterFormat),this.paragraphFormat.copyFormat(e.paragraphFormat)},t}(yl),wl=function(e){function t(t){var i=e.call(this)||this;return i.ownerBase=t,i.characterFormat=new T(i),i}return ml(t,e),t.prototype.destroy=function(){this.characterFormat.destroy()},t.prototype.copyStyle=function(e){this.name=e.name,this.ownerBase=e.ownerBase,this.type=e.type,this.next=e.next,this.basedOn=e.basedOn,this.characterFormat.copyFormat(e.characterFormat)},t}(yl),bl=function(e){function t(t){var i=e.call(this)||this;return i.ownerBase=t,i}return ml(t,e),t}(yl),xl=function(){function e(){this.collection=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.collection.length},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){this.collection=this.collection.filter((function(t){return t.name!==e.name}))},e.prototype.push=function(e){return null!=e&&void 0!==e&&this.collection.push(e),1},e.prototype.getItem=function(e){return this.collection.length>e?this.collection[parseInt(e.toString(),10)]:null},e.prototype.indexOf=function(e){return this.collection.indexOf(e)},e.prototype.contains=function(e){var t=this.collection.indexOf(e);return t>-1&&t<this.collection.length},e.prototype.clear=function(){for(;this.collection.length>0;)this.collection.pop()},e.prototype.findByName=function(e,t){for(var i,r=0,n=this.collection;r<n.length;r++){var o=n[r];o.name===e&&(i=o,sf.base.isNullOrUndefined(t)||o.type!==t&&(i=void 0))}return i},e.prototype.getStyleNames=function(e){return this.collection.filter((function(t){return t.type===e})).map((function(e){return e.name}))},e.prototype.getStyles=function(e){for(var t=[],i=0,r=this.collection.filter((function(t){return t.type===e})).map((function(e){return e}));i<r.length;i++){var n=r[i],o={},s={};"Paragraph"==e&&(s.paragraphFormat={},x.writeParagraphFormat(s.paragraphFormat,!0,n.paragraphFormat)),"Table"!==e&&(s.characterFormat={},x.writeCharacterFormat(s.characterFormat,!0,n.characterFormat)),o.name=n.name,o.style=JSON.stringify(s),o.type=n.type,"Paragraph"!=o.type||sf.base.isNullOrUndefined(n.link)||(o.type="Linked"),t.push(o)}return t},e}(),Il=function(){function e(e){this.uniqueShadingFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this.getPropertyValue("backgroundColor")},set:function(e){this.setPropertyValue("backgroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"foregroundColor",{get:function(){return this.getPropertyValue("foregroundColor")},set:function(e){this.setPropertyValue("foregroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureStyle",{get:function(){return this.getPropertyValue("textureStyle")},set:function(e){this.setPropertyValue("textureStyle",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueShadingFormat)&&this.uniqueShadingFormat.propertiesHash.containsKey(i))return this.uniqueShadingFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueShadingFormat))this.initializeUniqueShading(t,i);else{var r=l.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,t);if(this.uniqueShadingFormat.propertiesHash.containsKey(r)&&this.uniqueShadingFormat.propertiesHash.get(r)===i)return;this.uniqueShadingFormat=e.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat,t,i)}},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"backgroundColor":case"foregroundColor":t="empty";break;case"textureStyle":t="TextureNone"}return t},e.prototype.initializeUniqueShading=function(t,i){var r=new a;this.addUniqueShading("backgroundColor",t,i,r),this.addUniqueShading("foregroundColor",t,i,r),this.addUniqueShading("textureStyle",t,i,r),this.uniqueShadingFormat=e.uniqueShadingFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueShading=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i?n.add(o,r):n.add(o,e.getPropertyDefaultValue(t))},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.uniqueShadingFormat)||e.uniqueShadingFormats.remove(this.uniqueShadingFormat),this.uniqueShadingFormat=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.backgroundColor=this.backgroundColor,t.foregroundColor=this.foregroundColor,t.textureStyle=this.textureStyle,t},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.uniqueShadingFormat)||(this.backgroundColor=e.backgroundColor,this.foregroundColor=e.foregroundColor,this.textureStyle=e.textureStyle)},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueShadingFormat)){var t=l.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,e);return this.uniqueShadingFormat.propertiesHash.containsKey(t)}return!1},e.clear=function(){this.uniqueShadingFormats.clear()},e.uniqueShadingFormats=new d,e.uniqueFormatType=5,e}(),Fl=function(){function e(e){this.uniqueTableFormat=void 0,this.borders=new g(this),this.shading=new Il(this),this.ownerBase=void 0,this._styleName=void 0,this._title=void 0,this._description=void 0,this.ownerBase=e,this.assignTableMarginValue(5.4,0,5.4,0)}return Object.defineProperty(e.prototype,"title",{get:function(){return this._title},set:function(e){this._title=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._description},set:function(e){this._description=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowAutoFit",{get:function(){return this.getPropertyValue("allowAutoFit")},set:function(e){this.setPropertyValue("allowAutoFit",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellSpacing",{get:function(){return this.getPropertyValue("cellSpacing")},set:function(e){if(e<0||e>264.6)throw new RangeError("The measurement must be between 0 px and 264.6 px.");this.setPropertyValue("cellSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableAlignment",{get:function(){return this.getPropertyValue("tableAlignment")},set:function(e){this.setPropertyValue("tableAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){if(e<-1440||e>1440)throw new RangeError("The measurement must be between -1440 px and 1440 px.");this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.getPropertyValue("bidi")},set:function(e){this.setPropertyValue("bidi",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalPositionAbs",{get:function(){return this.getPropertyValue("horizontalPositionAbs")},set:function(e){this.setPropertyValue("horizontalPositionAbs",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalPosition",{get:function(){return this.getPropertyValue("horizontalPosition")},set:function(e){this.setPropertyValue("horizontalPosition",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"styleName",{get:function(){return this._styleName},set:function(e){this._styleName=e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueTableFormat)&&this.uniqueTableFormat.propertiesHash.containsKey(i))return this.uniqueTableFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueTableFormat))this.initializeUniqueTableFormat(t,i);else{var r=l.getPropertyType(this.uniqueTableFormat.uniqueFormatType,t);if(this.uniqueTableFormat.propertiesHash.containsKey(r)&&this.uniqueTableFormat.propertiesHash.get(r)===i)return;this.uniqueTableFormat=e.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat,t,i)}},e.prototype.initializeUniqueTableFormat=function(t,i){var r=new a;this.addUniqueTableFormat("allowAutoFit",t,i,r),this.addUniqueTableFormat("cellSpacing",t,i,r),this.addUniqueTableFormat("leftMargin",t,i,r),this.addUniqueTableFormat("topMargin",t,i,r),this.addUniqueTableFormat("bottomMargin",t,i,r),this.addUniqueTableFormat("rightMargin",t,i,r),this.addUniqueTableFormat("leftIndent",t,i,r),this.addUniqueTableFormat("tableAlignment",t,i,r),this.addUniqueTableFormat("preferredWidth",t,i,r),this.addUniqueTableFormat("preferredWidthType",t,i,r),this.addUniqueTableFormat("bidi",t,i,r),this.addUniqueTableFormat("horizontalPositionAbs",t,i,r),this.addUniqueTableFormat("horizontalPosition",t,i,r),this.uniqueTableFormat=e.uniqueTableFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueTableFormat=function(t,i,r,n){var o;o=l.getPropertyType(e.uniqueFormatType,t),t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowAutoFit":t=!1;break;case"cellSpacing":t=0;break;case"leftMargin":t=5.4;break;case"topMargin":case"bottomMargin":t=0;break;case"rightMargin":t=5.4;break;case"leftIndent":t=0;break;case"tableAlignment":t="Left";break;case"preferredWidth":t=0;break;case"preferredWidthType":t="Point";break;case"bidi":t=!1;break;case"horizontalPositionAbs":t=null;break;case"horizontalPosition":t=0}return t},e.prototype.assignTableMarginValue=function(e,t,i,r){this.leftMargin=e,this.topMargin=t,this.rightMargin=i,this.bottomMargin=r},e.prototype.initializeTableBorders=function(){this.borders.left.lineStyle="Single",this.borders.left.lineWidth=.5,this.borders.right.lineStyle="Single",this.borders.right.lineWidth=.5,this.borders.top.lineStyle="Single",this.borders.top.lineWidth=.5,this.borders.bottom.lineStyle="Single",this.borders.bottom.lineWidth=.5,this.borders.horizontal.lineStyle="Single",this.borders.horizontal.lineWidth=.5,this.borders.vertical.lineStyle="Single",this.borders.vertical.lineWidth=.5},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.borders)||this.borders.destroy(),sf.base.isNullOrUndefined(this.shading)||this.shading.destroy(),sf.base.isNullOrUndefined(this.uniqueTableFormat)||e.uniqueTableFormats.remove(this.uniqueTableFormat),this.uniqueTableFormat=void 0,this.borders=void 0,this.shading=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.leftIndent=this.leftIndent,t.tableAlignment=this.tableAlignment,t.cellSpacing=this.cellSpacing,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.preferredWidth=this.preferredWidth,t.preferredWidthType=this.preferredWidthType,t.horizontalPositionAbs=this.horizontalPositionAbs,t.horizontalPosition=this.horizontalPosition,t.borders=sf.base.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),t.shading=sf.base.isNullOrUndefined(this.shading)?void 0:this.shading.cloneFormat(),t.bidi=this.bidi,t.allowAutoFit=this.allowAutoFit,t.styleName=this.styleName,t.title=this.title,t.description=this.description,t},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueTableFormat)){var t=l.getPropertyType(this.uniqueTableFormat.uniqueFormatType,e);return this.uniqueTableFormat.propertiesHash.containsKey(t)}return!1},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.uniqueTableFormat)||(this.cellSpacing=e.cellSpacing,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.tableAlignment=e.tableAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType,this.bidi=e.bidi,this.allowAutoFit=e.allowAutoFit,this.horizontalPosition=e.horizontalPosition,this.horizontalPositionAbs=e.horizontalPositionAbs,this.styleName=e.styleName),sf.base.isNullOrUndefined(e.borders)||(this.borders=new g(this),this.borders.copyFormat(e.borders)),sf.base.isNullOrUndefined(e.shading)||(this.shading=new Il(this),this.shading.copyFormat(e.shading)),sf.base.isNullOrUndefined(e.title)||(this.title=e.title),sf.base.isNullOrUndefined(e.description)||(this.description=e.description))},e.clear=function(){this.uniqueTableFormats.clear()},e.uniqueTableFormats=new d,e.uniqueFormatType=8,e}(),Cl=function(){function e(e){this.uniqueCellFormat=void 0,this.borders=new g(this),this.shading=new Il(this),this.ownerBase=e,this.borders=new g(this),this.shading=new Il(this)}return Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellWidth",{get:function(){return this.getPropertyValue("cellWidth")},set:function(e){this.setPropertyValue("cellWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnSpan",{get:function(){return this.getPropertyValue("columnSpan")},set:function(e){this.setPropertyValue("columnSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowSpan",{get:function(){return this.getPropertyValue("rowSpan")},set:function(e){this.setPropertyValue("rowSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this.getPropertyValue("verticalAlignment")},set:function(e){this.setPropertyValue("verticalAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(t){if(this.hasValue(t)){var i=l.getPropertyType(e.uniqueFormatType,t);if(!sf.base.isNullOrUndefined(this.uniqueCellFormat)&&this.uniqueCellFormat.propertiesHash.containsKey(i))return this.uniqueCellFormat.propertiesHash.get(i)}return e.getPropertyDefaultValue(t)},e.prototype.setPropertyValue=function(t,i){if((sf.base.isNullOrUndefined(i)||""===i)&&(i=e.getPropertyDefaultValue(t)),sf.base.isNullOrUndefined(this.uniqueCellFormat))this.initializeUniqueCellFormat(t,i);else{var r=l.getPropertyType(this.uniqueCellFormat.uniqueFormatType,t);if(this.uniqueCellFormat.propertiesHash.containsKey(r)&&this.uniqueCellFormat.propertiesHash.get(r)===i)return;this.uniqueCellFormat=e.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat,t,i)}},e.prototype.initializeUniqueCellFormat=function(t,i){var r=new a;this.addUniqueCellFormat("leftMargin",t,i,r),this.addUniqueCellFormat("topMargin",t,i,r),this.addUniqueCellFormat("bottomMargin",t,i,r),this.addUniqueCellFormat("rightMargin",t,i,r),this.addUniqueCellFormat("cellWidth",t,i,r),this.addUniqueCellFormat("columnSpan",t,i,r),this.addUniqueCellFormat("rowSpan",t,i,r),this.addUniqueCellFormat("preferredWidth",t,i,r),this.addUniqueCellFormat("verticalAlignment",t,i,r),this.addUniqueCellFormat("preferredWidthType",t,i,r),this.uniqueCellFormat=e.uniqueCellFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueCellFormat=function(t,i,r,n){var o=l.getPropertyType(e.uniqueFormatType,t);t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"cellWidth":t=0;break;case"columnSpan":case"rowSpan":t=1;break;case"preferredWidth":t=0;break;case"verticalAlignment":t="Top";break;case"preferredWidthType":t="Point"}return t},e.prototype.containsMargins=function(){return!(sf.base.isNullOrUndefined(this.leftMargin)&&sf.base.isNullOrUndefined(this.rightMargin)&&sf.base.isNullOrUndefined(this.bottomMargin)&&sf.base.isNullOrUndefined(this.topMargin))},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.borders)||this.borders.destroy(),sf.base.isNullOrUndefined(this.shading)||this.shading.destroy(),sf.base.isNullOrUndefined(this.uniqueCellFormat)||e.uniqueCellFormats.remove(this.uniqueCellFormat),this.uniqueCellFormat=void 0,this.borders=void 0,this.shading=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.verticalAlignment=this.verticalAlignment,t.leftMargin=this.leftMargin,t.rightMargin=this.rightMargin,t.topMargin=this.topMargin,t.bottomMargin=this.bottomMargin,t.preferredWidth=this.preferredWidth,t.preferredWidthType=this.preferredWidthType,t.cellWidth=this.cellWidth,t.borders=sf.base.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),t.shading=sf.base.isNullOrUndefined(this.shading)?void 0:this.shading.cloneFormat(),t},e.prototype.hasValue=function(e){if(!sf.base.isNullOrUndefined(this.uniqueCellFormat)){var t=l.getPropertyType(this.uniqueCellFormat.uniqueFormatType,e);return this.uniqueCellFormat.propertiesHash.containsKey(t)}return!1},e.prototype.copyFormat=function(e){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.uniqueCellFormat)||(this.cellWidth=e.cellWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.preferredWidth=e.preferredWidth,this.columnSpan=e.columnSpan,this.rowSpan=e.rowSpan,this.preferredWidthType=e.preferredWidthType,this.verticalAlignment=e.verticalAlignment),sf.base.isNullOrUndefined(e.shading)||(this.shading=new Il(this),this.shading.copyFormat(e.shading)),sf.base.isNullOrUndefined(e.borders)||(this.borders=new g(this),this.borders.copyFormat(e.borders)))},e.clear=function(){this.uniqueCellFormats.clear()},e.uniqueCellFormats=new d,e.uniqueFormatType=4,e}(),Wl=function(){function e(e){this.documentHelper=void 0,this.commentStarts=void 0,this.commentEnds=void 0,this.commentsCollection=void 0,this.revisionCollection=void 0,this.isPageBreakInsideTable=!1,this.referedRevisions=[],this.isParseHeader=!1,this.footnotes=void 0,this.endnotes=void 0,this.themes=void 0,this.keywordIndex=0,this.isCutPerformed=!1,this.isPaste=!1,this.isHtmlPaste=!1,this.isExternalImageReference=!1,this.documentHelper=e,this.editableRanges=new a}return Object.defineProperty(e.prototype,"isPasting",{get:function(){return this.viewer&&this.viewer.owner.isPastingContent},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.convertJsonToDocument=function(e){this.commentStarts=new a,this.commentEnds=new a,this.commentsCollection=new a,this.revisionCollection=new a,this.referedRevisions=[],this.images=void 0,this.footnotes=new Ca,this.endnotes=new Ca;var t=[],i=x.getSfdtDocument(e);return i.optimizeSfdt&&(this.keywordIndex=1),sf.base.isNullOrUndefined(i[V[this.keywordIndex]])||this.parseFontSubstitutionTable(i[V[this.keywordIndex]]),sf.base.isNullOrUndefined(i[q[this.keywordIndex]])?this.parseCharacterFormat(0,this.viewer.owner.characterFormat,this.documentHelper.characterFormat):(this.documentHelper.characterFormat.clearFormat(),this.parseCharacterFormat(this.keywordIndex,i[q[this.keywordIndex]],this.documentHelper.characterFormat)),sf.base.isNullOrUndefined(i[_[this.keywordIndex]])?this.parseParagraphFormat(0,this.viewer.owner.paragraphFormat,this.documentHelper.paragraphFormat):this.parseParagraphFormat(this.keywordIndex,i[_[this.keywordIndex]],this.documentHelper.paragraphFormat),sf.base.isNullOrUndefined(i[ue[this.keywordIndex]])||this.parseCharacterFormat(this.keywordIndex,i[ue[this.keywordIndex]],this.documentHelper.themeFontLanguage),this.parseDocumentProtection(i),sf.base.isNullOrUndefined(i[Ns[this.keywordIndex]])||!(Object.keys(i[Ns[this.keywordIndex]]).length>0)||i[Ns[this.keywordIndex]][0]instanceof Array||(this.images=i[Ns[this.keywordIndex]]),sf.base.isNullOrUndefined(i[$[this.keywordIndex]])||(this.documentHelper.defaultTabWidth=i[$[this.keywordIndex]]),sf.base.isNullOrUndefined(i[te[this.keywordIndex]])||(this.documentHelper.owner.showRevisions=x.parseBoolValue(i[te[this.keywordIndex]]),this.documentHelper.owner.enableTrackChanges=x.parseBoolValue(i[te[this.keywordIndex]])),sf.base.isNullOrUndefined(i[ae[this.keywordIndex]])||(this.documentHelper.dontUseHtmlParagraphAutoSpacing=x.parseBoolValue(i[ae[this.keywordIndex]])),sf.base.isNullOrUndefined(i[Fs[this.keywordIndex]])||(this.documentHelper.allowSpaceOfSameStyleInTable=x.parseBoolValue(i[Fs[this.keywordIndex]])),sf.base.isNullOrUndefined(i[de[this.keywordIndex]])||(this.documentHelper.alignTablesRowByRow=x.parseBoolValue(i[de[this.keywordIndex]])),sf.base.isNullOrUndefined(i[K[this.keywordIndex]])||(this.documentHelper.backgroundColor=this.getColor(i[K[this.keywordIndex]][Br[this.keywordIndex]])),sf.base.isNullOrUndefined(i[fe[this.keywordIndex]])||(this.documentHelper.compatibilityMode=this.getCompatibilityMode(i[fe[this.keywordIndex]]),sf.base.isNullOrUndefined(this.documentHelper.owner.documentSettings)||(this.documentHelper.owner.documentSettings.compatibilityMode=i[fe[this.keywordIndex]])),sf.base.isNullOrUndefined(i[G[this.keywordIndex]])||this.parseAbstractList(i,this.documentHelper.abstractLists),sf.base.isNullOrUndefined(i[j[this.keywordIndex]])||this.parseList(i,this.documentHelper.lists),sf.base.isNullOrUndefined(i[X[this.keywordIndex]])||this.parseStyles(i,this.documentHelper.styles),sf.base.isNullOrUndefined(i[J[this.keywordIndex]])||this.parseComments(i,this.documentHelper.comments),sf.base.isNullOrUndefined(i[Z[this.keywordIndex]])||this.parseRevisions(i,this.viewer.owner.revisionsInternal.changes),!sf.base.isNullOrUndefined(i[Ns[this.keywordIndex]])&&Object.keys(i[Ns[this.keywordIndex]]).length>0&&i[Ns[this.keywordIndex]][0]instanceof Array&&this.parseImages(i[Ns[this.keywordIndex]]),sf.base.isNullOrUndefined(i[D[this.keywordIndex]])||this.parseSections(i[D[this.keywordIndex]],t),sf.base.isNullOrUndefined(i[Q[this.keywordIndex]])||this.parseCustomXml(i),sf.base.isNullOrUndefined(i[he[this.keywordIndex]])||(this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading=x.parseBoolValue(i[he[this.keywordIndex]])),sf.base.isNullOrUndefined(i[pe[this.keywordIndex]])||this.parseFootnotes(i[pe[this.keywordIndex]],this.documentHelper.footnotes),sf.base.isNullOrUndefined(i[ge[this.keywordIndex]])||this.parseEndtnotes(i[ge[this.keywordIndex]],this.documentHelper.endnotes),sf.base.isNullOrUndefined(i[me[this.keywordIndex]])||this.parseThemes(i[me[this.keywordIndex]],this.documentHelper.themes),this.generalizeRevisions(),this.removeUnmappedBookmark(),this.documentHelper.fieldStacks&&this.documentHelper.fieldStacks.length>0&&(this.documentHelper.fieldStacks=[]),t},e.prototype.parseFontSubstitutionTable=function(e){if(!sf.base.isNullOrUndefined(this.documentHelper)&&!sf.base.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)&&Object.keys(e).length>0)for(var t=0,i=Object.keys(e);t<i.length;t++){var r=i[t];this.documentHelper.fontSubstitutionTable.add(r,e[r])}},e.prototype.removeUnmappedBookmark=function(){for(var e=this.documentHelper.bookmarks.keys,t=this.documentHelper.endBookmarksUpdated,i=0;i<e.length;i++)if(-1===t.indexOf(e[i])){var r=this.documentHelper.bookmarks.get(e[i]);r&&r.line.children.splice(r.line.children.indexOf(r),1),this.documentHelper.bookmarks.remove(e[i])}this.documentHelper.endBookmarksUpdated=[]},e.prototype.generalizeRevisions=function(){var e=this,t=new a,i=[];this.referedRevisions.forEach((function(r){var n=e.documentHelper.revisionsInternal.get(r);-1===i.indexOf(n)&&(i.push(n),t.add(r,n))})),this.viewer.owner.revisionsInternal.changes=i,this.documentHelper.revisionsInternal=t},e.prototype.parseFootnotes=function(e,t){sf.base.isNullOrUndefined(e[zo[this.keywordIndex]])||this.parseBody(e[zo[this.keywordIndex]],t.separator),sf.base.isNullOrUndefined(e[Vo[this.keywordIndex]])||this.parseBody(e[Vo[this.keywordIndex]],t.continuationNotice),sf.base.isNullOrUndefined(e[Do[this.keywordIndex]])||this.parseBody(e[Do[this.keywordIndex]],t.continuationSeparator)},e.prototype.parseImages=function(e){for(var t in e)if(Array.isArray(e[""+t]))this.documentHelper.images.add(parseInt(t),e[""+t]);else{var i=[];i.push(e[""+t]),this.documentHelper.images.add(parseInt(t),i)}},e.prototype.parseEndtnotes=function(e,t){sf.base.isNullOrUndefined(e[zo[this.keywordIndex]])||this.parseBody(e[zo[this.keywordIndex]],t.separator),sf.base.isNullOrUndefined(e[Vo[this.keywordIndex]])||this.parseBody(e[Vo[this.keywordIndex]],t.continuationNotice),sf.base.isNullOrUndefined(e[Do[this.keywordIndex]])||this.parseBody(e[Do[this.keywordIndex]],t.continuationSeparator)},e.prototype.parseCustomXml=function(e){for(var t=0;t<e[Q[this.keywordIndex]].length;t++){var i=e[Q[this.keywordIndex]][t];this.revisionCollection.containsKey(i[In[this.keywordIndex]])||this.documentHelper.customXmlData.add(i[In[this.keywordIndex]],i[Fn[this.keywordIndex]])}},e.prototype.parseDocumentProtection=function(e){sf.base.isNullOrUndefined(e[ee[this.keywordIndex]])||(this.documentHelper.restrictFormatting=x.parseBoolValue(e[ee[this.keywordIndex]])),sf.base.isNullOrUndefined(e[re[this.keywordIndex]])||(this.documentHelper.isDocumentProtected=x.parseBoolValue(e[re[this.keywordIndex]])),sf.base.isNullOrUndefined(e[ie[this.keywordIndex]])||(this.documentHelper.protectionType=this.getProtectionType(e[ie[this.keywordIndex]])),sf.base.isNullOrUndefined(e[ne[this.keywordIndex]])||(this.documentHelper.hashValue=e[ne[this.keywordIndex]]),sf.base.isNullOrUndefined(e[oe[this.keywordIndex]])||(this.documentHelper.saltValue=e[oe[this.keywordIndex]])},e.prototype.parseStyles=function(e,t){for(var i=0;i<e[X[this.keywordIndex]].length;i++)sf.base.isNullOrUndefined(this.documentHelper.styles.findByName(e[X[this.keywordIndex]][i][ye[this.keywordIndex]]))&&this.parseStyle(e,e[X[this.keywordIndex]][i],t)},e.prototype.parseRevisions=function(e,t){for(var i=0;i<e[Z[this.keywordIndex]].length;i++){var r=e[Z[this.keywordIndex]][i];if(!sf.base.isNullOrUndefined(r[xn[this.keywordIndex]])&&!sf.base.isNullOrUndefined(r[bn[this.keywordIndex]])){var n=this.parseRevision(r),o=!0;if(!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange&&this.isPaste){if("Insertion"===this.getRevisionType(r[bn[this.keywordIndex]])&&this.isPaste&&this.documentHelper.owner.enableTrackChanges)continue;this.revisionCollection.containsKey(r[xn[this.keywordIndex]])||this.revisionCollection.add(r[xn[this.keywordIndex]],n)}else this.revisionCollection.add(r[xn[this.keywordIndex]],n);for(var s=0;s<t.length;s++)t[s].revisionID===n.revisionID&&(o=!1);o&&t.push(n)}}this.documentHelper.revisionsInternal=this.revisionCollection,this.documentHelper.owner.sfdtExportModule&&(this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1)},e.prototype.parseRevision=function(e){if(!sf.base.isNullOrUndefined(e)){var t=new N(this.viewer.owner,e[un[this.keywordIndex]],e[yn[this.keywordIndex]]);return t.revisionID=e[xn[this.keywordIndex]],t.revisionType=this.getRevisionType(e[bn[this.keywordIndex]]),t}},e.prototype.checkAndApplyRevision=function(e,t,i){if(!sf.base.isNullOrUndefined(t[Ge[e]])&&t[Ge[e]].length>0)for(var r=0;r<t[Ge[e]].length;r++){var n=t[Ge[e]][r];if(this.revisionCollection.containsKey(n)){this.referedRevisions.push(n);var o=this.revisionCollection.get(n);i instanceof ul||o.range.push(i),i.revisions.push(o)}}},e.prototype.parseComments=function(e,t){for(var i=0,r=0;r<e[J[this.keywordIndex]].length;r++){var n=e[J[this.keywordIndex]][r],o=void 0;for(o=this.parseComment(n,o);i<n[wn[this.keywordIndex]].length;){var s=void 0;(s=this.parseComment(n[wn[this.keywordIndex]][i],s)).ownerComment=o,s.isReply=!0,o.replyComments.push(s),this.commentsCollection.add(s.commentId,s),i++}this.commentsCollection.add(o.commentId,o),t.push(o),i=0}},e.prototype.parseComment=function(e,t){return(t=new ll(e[yn[this.keywordIndex]])).author=e[un[this.keywordIndex]],t.initial=e[mn[this.keywordIndex]],t.commentId=e[gn[this.keywordIndex]],t.isResolved=x.parseBoolValue(e[vn[this.keywordIndex]]),t.text=this.parseCommentText(e[xo[this.keywordIndex]]),t},e.prototype.parseCommentText=function(e){for(var t="",i=0;i<e.length;i++){0!==i&&(t+="\n");for(var r=0;r<e[i][Pn[this.keywordIndex]].length;r++)t+=e[i][Pn[this.keywordIndex]][r][gr[this.keywordIndex]]}return t},e.prototype.parseStyle=function(e,t,i,r){var n,o=0;if(!sf.base.isNullOrUndefined(r)&&r&&(o=this.keywordIndex,this.keywordIndex=0),!sf.base.isNullOrUndefined(t[hs[this.keywordIndex]])){if("Paragraph"===this.getStyleType(t[hs[this.keywordIndex]])&&((n=new vl).type="Paragraph"),"Character"===this.getStyleType(t[hs[this.keywordIndex]])&&((n=new wl).type="Character"),"Table"===this.getStyleType(t[hs[this.keywordIndex]])&&((n=new bl).type="Table"),sf.base.isNullOrUndefined(t[ye[this.keywordIndex]])||(n.name=t[ye[this.keywordIndex]]),i.push(n),!sf.base.isNullOrUndefined(t[ve[this.keywordIndex]])){var s=i.findByName(t[ve[this.keywordIndex]]);if(sf.base.isNullOrUndefined(s)){var a=this.getStyle(t[ve[this.keywordIndex]],e),l=void 0;sf.base.isNullOrUndefined(a)||this.getStyleType(a[hs[this.keywordIndex]])!==n.type?"Paragraph"===n.type?l=JSON.parse('{"type":"Paragraph","name":"Normal","next":"Normal"}'):"Character"===n.type&&(l=JSON.parse('{"type": "Character","name": "Default Paragraph Font"}')):l=a,this.parseStyle(e,l,i),n.basedOn=i.findByName(l[ye[this.keywordIndex]])}else s.type===n.type&&s.name!==n.name&&(n.basedOn=s)}if(!sf.base.isNullOrUndefined(t[be[this.keywordIndex]])){var d=i.findByName(t[be[this.keywordIndex]]),h=this.getStyle(t[be[this.keywordIndex]],e);l=void 0;if(sf.base.isNullOrUndefined(d)){if(sf.base.isNullOrUndefined(h)){var c={};c.characterFormat=t[q[this.keywordIndex]],c.name=t[ye[this.keywordIndex]]+" Char",c.type="Character",c.basedOn="Normal"===t[ve[this.keywordIndex]]?"Default Paragraph Font":t[ve[this.keywordIndex]]+" Char",l=c}else l=h;this.parseStyle(e,l,i),n.link=sf.base.isNullOrUndefined(i.findByName(l[ye[this.keywordIndex]]))?t[be[this.keywordIndex]]:i.findByName(l[ye[this.keywordIndex]])}else n.link=d}if(sf.base.isNullOrUndefined(t[q[this.keywordIndex]])||this.parseCharacterFormat(this.keywordIndex,t[q[this.keywordIndex]],n.characterFormat),sf.base.isNullOrUndefined(t[_[this.keywordIndex]])||this.parseParagraphFormat(this.keywordIndex,t[_[this.keywordIndex]],n.paragraphFormat),!sf.base.isNullOrUndefined(t[we[this.keywordIndex]]))if(t[we[this.keywordIndex]]===t[ye[this.keywordIndex]])n.next=n;else{var p=i.findByName(t[we[this.keywordIndex]]);if(sf.base.isNullOrUndefined(p)||p.type!==n.type){var g=this.getStyle(t[we[this.keywordIndex]],e);sf.base.isNullOrUndefined(g)?n.next=n:(this.parseStyle(e,g,i),n.next=i.findByName(g[ye[this.keywordIndex]]))}else n.next=p}}!sf.base.isNullOrUndefined(r)&&r&&(this.keywordIndex=o)},e.prototype.getStyle=function(e,t){for(var i=0;i<t[X[this.keywordIndex]].length;i++)if(t[X[this.keywordIndex]][i][ye[this.keywordIndex]]===e)return t[X[this.keywordIndex]][i]},e.prototype.parseAbstractList=function(e,t){for(var i=0;i<e[G[this.keywordIndex]].length;i++){var r=new W,n=e[G[this.keywordIndex]][i];if(t.push(r),!sf.base.isNullOrUndefined(n)&&(sf.base.isNullOrUndefined(n[Bo[this.keywordIndex]])||(r.abstractListId=n[Bo[this.keywordIndex]]),!sf.base.isNullOrUndefined(n[Lo[this.keywordIndex]])))for(var o=0;o<n[Lo[this.keywordIndex]].length;o++){var s=n[Lo[this.keywordIndex]][o];if(!sf.base.isNullOrUndefined(s)){var a=this.parseListLevel(s,r);r.levels.push(a)}}}},e.prototype.parseListLevel=function(e,t){var i=new H(t);return"Bullet"===this.getListLevelPattern(e[Oo[this.keywordIndex]])?(i.listLevelPattern="Bullet",i.numberFormat=sf.base.isNullOrUndefined(e[Uo[this.keywordIndex]])?"":e[Uo[this.keywordIndex]]):(i.listLevelPattern=this.getListLevelPattern(e[Oo[this.keywordIndex]]),i.startAt=e[Ho[this.keywordIndex]],i.numberFormat=sf.base.isNullOrUndefined(e[Uo[this.keywordIndex]])?"":e[Uo[this.keywordIndex]],e[Eo[this.keywordIndex]]>=0?i.restartLevel=e[Eo[this.keywordIndex]]:i.restartLevel=e[Ro[this.keywordIndex]]),i.paraStyleName=sf.base.isNullOrUndefined(e[Y[this.keywordIndex]])?"":e[Y[this.keywordIndex]],i.isLegalStyleNumbering=!sf.base.isNullOrUndefined(e[le[this.keywordIndex]])&&x.parseBoolValue(e[le[this.keywordIndex]]),i.followCharacter=this.getFollowCharacterType(e[To[this.keywordIndex]]),this.parseCharacterFormat(this.keywordIndex,e[q[this.keywordIndex]],i.characterFormat),this.parseParagraphFormat(this.keywordIndex,e[_[this.keywordIndex]],i.paragraphFormat),i},e.prototype.parseList=function(e,t){for(var i=0;i<e[j[this.keywordIndex]].length;i++){var r=new u,n=e[j[this.keywordIndex]][i];sf.base.isNullOrUndefined(n[Bo[this.keywordIndex]])||(r.abstractListId=n[Bo[this.keywordIndex]],r.abstractList=this.documentHelper.getAbstractListById(n[Bo[this.keywordIndex]])),t.push(r),sf.base.isNullOrUndefined(n[Ke[this.keywordIndex]])||(r.listId=n[Ke[this.keywordIndex]]),n.hasOwnProperty(Mo[this.keywordIndex])&&this.parseLevelOverride(n[Mo[this.keywordIndex]],r)}},e.prototype.parseLevelOverride=function(e,t){if(!sf.base.isNullOrUndefined(e))for(var i=0;i<e.length;i++){var r=new f,n=e[i];r.startAt=n[Ho[this.keywordIndex]],r.levelNumber=n[Ro[this.keywordIndex]],sf.base.isNullOrUndefined(n[Ao[this.keywordIndex]])||(r.overrideListLevel=this.parseListLevel(n[Ao[this.keywordIndex]],r)),t.levelOverrides.push(r)}},e.prototype.parseSections=function(e,t){for(var i=0;i<e.length;i++){var r=new aa;r.sectionFormat=new h(r),r.index=i;var n,o=e[i],s=e[i+1],a=s&&s[No[this.keywordIndex]]?s[No[this.keywordIndex]]:void 0;n=a&&a[Bt[this.keywordIndex]]?a[Bt[this.keywordIndex]]:"NewPage",sf.base.isNullOrUndefined(o[No[this.keywordIndex]])||this.parseSectionFormat(this.keywordIndex,o[No[this.keywordIndex]],r.sectionFormat),sf.base.isNullOrUndefined(o[Po[this.keywordIndex]])&&(o[Po[this.keywordIndex]]={}),this.documentHelper.headersFooters.push(this.parseHeaderFooter(o[Po[this.keywordIndex]],this.documentHelper.headersFooters)),this.isParseHeader=!1,this.parseTextBody(o[xo[this.keywordIndex]],r,i+1<e.length,n);for(var l=0;l<r.childWidgets.length;l++)r.childWidgets[l].containerWidget=r;t.push(r)}},e.prototype.parseHeaderFooter=function(e,t){this.isParseHeader=!0;var i={};if(!sf.base.isNullOrUndefined(e[Io[this.keywordIndex]])){var r=new la("OddHeader");i[0]=r,this.parseTextBody(e[Io[this.keywordIndex]][xo[this.keywordIndex]],r)}if(!sf.base.isNullOrUndefined(e[Fo[this.keywordIndex]])){var n=new la("OddFooter");i[1]=n,this.parseTextBody(e[Fo[this.keywordIndex]][xo[this.keywordIndex]],n)}if(!sf.base.isNullOrUndefined(e[Co[this.keywordIndex]])){var o=new la("EvenHeader");i[2]=o,this.parseTextBody(e[Co[this.keywordIndex]][xo[this.keywordIndex]],o)}if(!sf.base.isNullOrUndefined(e[Wo[this.keywordIndex]])){var s=new la("EvenFooter");i[3]=s,this.parseTextBody(e[Wo[this.keywordIndex]][xo[this.keywordIndex]],s)}if(!sf.base.isNullOrUndefined(e[ko[this.keywordIndex]])){var a=new la("FirstPageHeader");i[4]=a,this.parseTextBody(e[ko[this.keywordIndex]][xo[this.keywordIndex]],a)}if(!sf.base.isNullOrUndefined(e[So[this.keywordIndex]])){var l=new la("FirstPageFooter");i[5]=l,this.parseTextBody(e[So[this.keywordIndex]][xo[this.keywordIndex]],l)}return i},e.prototype.parseTextBody=function(e,t,i,r){this.parseBody(e,t.childWidgets,t,i,void 0,void 0,r)},e.prototype.addCustomStyles=function(e){if(!sf.base.isNullOrUndefined(e[X[this.keywordIndex]]))for(var t=0;t<e[X[this.keywordIndex]].length;t++){void 0===this.documentHelper.styles.findByName(e[X[this.keywordIndex]][t][ye[this.keywordIndex]])&&this.parseStyle(e,e[X[this.keywordIndex]][t],this.documentHelper.styles)}},e.prototype.parseBody=function(e,t,i,r,n,o,s){if(!sf.base.isNullOrUndefined(e))for(var a=0;a<e.length;a++){var l=e[a],d=!1;if(l.hasOwnProperty(Pn[this.keywordIndex])){var h=new ca;if(h.characterFormat=new T(h),h.paragraphFormat=new ul(h),l[Pn[this.keywordIndex]].length>0&&(d=this.parseParagraph(l[Pn[this.keywordIndex]],h,!1),l.hasOwnProperty(se[this.keywordIndex])&&(h.isCreatedUsingHtmlSpanTag=x.parseBoolValue(l[se[this.keywordIndex]]))),!r||l!==e[e.length-1]||0!==l[Pn[this.keywordIndex]].length||d){this.parseCharacterFormat(this.keywordIndex,l[q[this.keywordIndex]],h.characterFormat),this.parseParagraphFormat(this.keywordIndex,l[_[this.keywordIndex]],h.paragraphFormat);var c,p="Normal";sf.base.isNullOrUndefined(l[_[this.keywordIndex]])||sf.base.isNullOrUndefined(l[_[this.keywordIndex]][Ee[this.keywordIndex]])||(p=l[_[this.keywordIndex]][Ee[this.keywordIndex]]),c=this.documentHelper.styles.findByName(p,"Paragraph"),sf.base.isNullOrUndefined(c)||h.paragraphFormat.applyStyle(c),t.push(h)}else if(r&&1===e.length)t.push(h);else if(r&&l===e[e.length-1]&&0===l[Pn[this.keywordIndex]].length&&!d&&"NoBreak"!=s){var g=e.indexOf(l),f=e[g-1];!sf.base.isNullOrUndefined(f)&&f.hasOwnProperty(oo[this.keywordIndex])&&(t.push(h),h.isSectionBreak=!0)}h.index=t.length-1,h.containerWidget=i}else if(l.hasOwnProperty(oo[this.keywordIndex]))this.parseTable(l,t,t.length,i);else if(l.hasOwnProperty(Nn[this.keywordIndex])){var u=new Oa("Block"),m=new Oa("Block");this.parseContentControlProperties(l[Nn[this.keywordIndex]],u.contentControlProperties),m.contentControlProperties=u.contentControlProperties,u.type=0,m.type=1,this.parseBody(l[xo[this.keywordIndex]],t,i,r,u.contentControlProperties);for(var y=0;y<2;y++){var v=t.length<l[xo[this.keywordIndex]].length?t[0]:0===y?t[t.length-l[xo[this.keywordIndex]].length]:t[t.length-1],w=void 0;if(v instanceof ca)w=v;else if(v instanceof ga){if(0===y)w=v.firstChild.firstChild.firstChild;else w=v.lastChild.lastChild.lastChild}if(!sf.base.isNullOrUndefined(w)&&0===w.childWidgets.length){var b=new ma(w);w.childWidgets.push(b)}0===y?(w.firstChild.children.splice(0,0,u),u.line=w.firstChild):(w.lastChild.children.push(m),m.line=w.lastChild)}}sf.base.isNullOrUndefined(n)||(t[t.length-1].contentControlProperties=n)}},e.prototype.parseTable=function(e,t,i,r){var n=new ga;n.index=i,sf.base.isNullOrUndefined(e[ho[this.keywordIndex]])||this.parseTableFormat(e[ho[this.keywordIndex]],n.tableFormat),n.tableFormat.title=e[En[this.keywordIndex]],n.tableFormat.description=e[so[this.keywordIndex]],this.parseTablePositioning(e,n);for(var o=0;o<e[oo[this.keywordIndex]].length;o++){var s=new fa;s.rowFormat=new k(s);var a=e[oo[this.keywordIndex]][o];if(sf.base.isNullOrUndefined(a[Nn[this.keywordIndex]])||(s.contentControlProperties=new Ta("Row"),this.parseContentControlProperties(a[Nn[this.keywordIndex]],s.contentControlProperties)),a.hasOwnProperty(ro[this.keywordIndex])){this.parseRowFormat(a[ro[this.keywordIndex]],s.rowFormat),this.parseRowGridValues(a,s.rowFormat),this.parseRowGridValues(a[ro[this.keywordIndex]],s.rowFormat),s.index=o;for(var l=0;l<a[no[this.keywordIndex]].length;l++){var d=new ua;d.cellFormat=new Cl(d);var h=a[no[this.keywordIndex]][l];sf.base.isNullOrUndefined(h[Nn[this.keywordIndex]])||(d.contentControlProperties=new Ta("Cell"),this.parseContentControlProperties(h[Nn[this.keywordIndex]],d.contentControlProperties)),s.childWidgets.push(d),d.containerWidget=s,d.index=l,d.rowIndex=o,d.columnIndex=l,h.hasOwnProperty(io[this.keywordIndex])&&this.parseCellFormat(h[io[this.keywordIndex]],d.cellFormat);for(var c=h[xo[this.keywordIndex]],p=0;p<c.length;p++)c[p].hasOwnProperty(oo[this.keywordIndex])&&(n.isContainInsideTable=!0);if(this.isPageBreakInsideTable=!0,this.parseTextBody(h[xo[this.keywordIndex]],d,!1),sf.base.isNullOrUndefined(d.contentControlProperties)&&1===d.childWidgets.length&&d.firstChild instanceof ca&&0===d.firstChild.childWidgets.length&&!sf.base.isNullOrUndefined(d.firstChild.paragraphFormat))-1!==d.firstChild.paragraphFormat.listFormat.listId&&0===d.firstChild.paragraphFormat.leftIndent&&0!==d.firstChild.paragraphFormat.firstLineIndent&&d.firstChild.paragraphFormat.clearIndent();if(!sf.base.isNullOrUndefined(d.contentControlProperties)){var g=new Oa("Cell"),f=new Oa("Cell");if(g.contentControlProperties=d.contentControlProperties,f.contentControlProperties=d.contentControlProperties,g.type=0,f.type=1,0===d.firstChild.childWidgets.length){var u=new ma(d.firstChild);d.firstChild.childWidgets.push(u)}if(g.line=d.firstChild.firstChild,d.firstChild.firstChild.children.splice(0,0,g),0===d.lastChild.childWidgets.length){u=new ma(d.lastChild);d.lastChild.childWidgets.push(u)}f.line=d.lastChild.lastChild,d.lastChild.lastChild.children.push(f)}if(!sf.base.isNullOrUndefined(s.contentControlProperties))if(s.firstChild===d){var m=new Oa("Row");if(m.contentControlProperties=s.contentControlProperties,m.type=0,0===d.firstChild.childWidgets.length){u=new ma(d.firstChild);d.firstChild.childWidgets.push(u)}m.line=d.firstChild.firstChild,d.firstChild.firstChild.children.splice(0,0,m)}else if(s.lastChild===d){var y=new Oa("Row");if(y.contentControlProperties=s.contentControlProperties,y.type=1,0===d.lastChild.childWidgets.length){u=new ma(d.lastChild);d.lastChild.childWidgets.push(u)}y.line=d.lastChild.lastChild,d.lastChild.lastChild.children.push(y)}this.isPageBreakInsideTable=!1}}n.childWidgets.push(s),s.containerWidget=n}n.containerWidget=r,t.push(n),n.isGridUpdated=!1},e.prototype.parseTablePositioning=function(e,t){t.wrapTextAround=!sf.base.isNullOrUndefined(e[ao[this.keywordIndex]])&&x.parseBoolValue(e[ao[this.keywordIndex]]),t.wrapTextAround&&(t.positioning=new pa,t.positioning.allowOverlap=x.parseBoolValue(e[lo[this.keywordIndex]][co[this.keywordIndex]]),sf.base.isNullOrUndefined(e[lo[this.keywordIndex]][uo[this.keywordIndex]])||(t.positioning.distanceBottom=x.convertPointToPixel(e[lo[this.keywordIndex]][uo[this.keywordIndex]])),sf.base.isNullOrUndefined(e[lo[this.keywordIndex]][fo[this.keywordIndex]])||(t.positioning.distanceLeft=x.convertPointToPixel(e[lo[this.keywordIndex]][fo[this.keywordIndex]])),sf.base.isNullOrUndefined(e[lo[this.keywordIndex]][go[this.keywordIndex]])||(t.positioning.distanceRight=x.convertPointToPixel(e[lo[this.keywordIndex]][go[this.keywordIndex]])),sf.base.isNullOrUndefined(e[lo[this.keywordIndex]][po[this.keywordIndex]])||(t.positioning.distanceTop=x.convertPointToPixel(e[lo[this.keywordIndex]][po[this.keywordIndex]])),sf.base.isNullOrUndefined(e[lo[this.keywordIndex]][zt[this.keywordIndex]])||(t.positioning.verticalAlignment=this.getTableVerticalPosition(e[lo[this.keywordIndex]][zt[this.keywordIndex]])),sf.base.isNullOrUndefined(e[lo[this.keywordIndex]][mo[this.keywordIndex]])||(t.positioning.verticalOrigin=this.getTableVerticalRelation(e[lo[this.keywordIndex]][mo[this.keywordIndex]])),t.positioning.verticalPosition=e[lo[this.keywordIndex]][yo[this.keywordIndex]],sf.base.isNullOrUndefined(e[lo[this.keywordIndex]][wo[this.keywordIndex]])||(t.positioning.horizontalAlignment=this.getTableHorizontalPosition(e[lo[this.keywordIndex]][wo[this.keywordIndex]])),sf.base.isNullOrUndefined(e[lo[this.keywordIndex]][vo[this.keywordIndex]])||(t.positioning.horizontalOrigin=this.getTableHorizontalRelation(e[lo[this.keywordIndex]][vo[this.keywordIndex]])),t.positioning.horizontalPosition=e[lo[this.keywordIndex]][bo[this.keywordIndex]])},e.prototype.parseRowGridValues=function(e,t){sf.base.isNullOrUndefined(e[_t[this.keywordIndex]])||(t.gridBefore=e[_t[this.keywordIndex]]),sf.base.isNullOrUndefined(e[jt[this.keywordIndex]])||(t.gridBeforeWidth=e[jt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[Gt[this.keywordIndex]])||(t.gridBeforeWidthType=this.getWidthType(e[Gt[this.keywordIndex]])),sf.base.isNullOrUndefined(e[Kt[this.keywordIndex]])||(t.gridAfter=e[Kt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[Xt[this.keywordIndex]])||(t.gridAfterWidth=e[Xt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[Jt[this.keywordIndex]])||(t.gridAfterWidthType=this.getWidthType(e[Jt[this.keywordIndex]]))},e.prototype.parseContentControlProperties=function(e,t){if(sf.base.isNullOrUndefined(e[On[this.keywordIndex]])||(t.lockContentControl=x.parseBoolValue(e[On[this.keywordIndex]])),sf.base.isNullOrUndefined(e[Tn[this.keywordIndex]])||(t.lockContents=x.parseBoolValue(e[Tn[this.keywordIndex]])),sf.base.isNullOrUndefined(e[Hn[this.keywordIndex]])||(t.tag=e[Hn[this.keywordIndex]]),sf.base.isNullOrUndefined(e[Br[this.keywordIndex]])||(t.color=e[Br[this.keywordIndex]]),sf.base.isNullOrUndefined(e[En[this.keywordIndex]])||(t.title=e[En[this.keywordIndex]]),sf.base.isNullOrUndefined(e[xs[this.keywordIndex]])||(t.appearance=this.getContentControlAppearance(e[xs[this.keywordIndex]])),sf.base.isNullOrUndefined(e[hs[this.keywordIndex]])||(t.type=this.getContentControlType(e[hs[this.keywordIndex]])),sf.base.isNullOrUndefined(e[Rn[this.keywordIndex]])||(t.hasPlaceHolderText=x.parseBoolValue(e[Rn[this.keywordIndex]])),sf.base.isNullOrUndefined(e[Un[this.keywordIndex]])||(t.multiline=x.parseBoolValue(e[Un[this.keywordIndex]])),sf.base.isNullOrUndefined(e[Bn[this.keywordIndex]])||(t.isTemporary=x.parseBoolValue(e[Bn[this.keywordIndex]])),sf.base.isNullOrUndefined(e[q[this.keywordIndex]])||this.parseCharacterFormat(this.keywordIndex,e[q[this.keywordIndex]],t.characterFormat),"CheckBox"===t.type)sf.base.isNullOrUndefined(e[Dn[this.keywordIndex]])||(t.isChecked=x.parseBoolValue(e[Dn[this.keywordIndex]])),sf.base.isNullOrUndefined(e[Vn[this.keywordIndex]])||(t.uncheckedState=new Ea,t.uncheckedState.font=e[Vn[this.keywordIndex]][Gn[this.keywordIndex]],t.uncheckedState.value=e[Vn[this.keywordIndex]][Kn[this.keywordIndex]]),sf.base.isNullOrUndefined(e[qn[this.keywordIndex]])||(t.checkedState=new Ea,t.checkedState.font=e[qn[this.keywordIndex]][Gn[this.keywordIndex]],t.checkedState.value=e[qn[this.keywordIndex]][Kn[this.keywordIndex]]);else if("Date"===t.type)sf.base.isNullOrUndefined(e[Ln[this.keywordIndex]])||(t.dateCalendarType=this.getDateCalendarType(e[Ln[this.keywordIndex]])),sf.base.isNullOrUndefined(e[An[this.keywordIndex]])||(t.dateStorageFormat=this.getDateStorageFormat(e[An[this.keywordIndex]])),sf.base.isNullOrUndefined(e[Mn[this.keywordIndex]])||(t.dateDisplayLocale=e[Mn[this.keywordIndex]]),sf.base.isNullOrUndefined(e[zn[this.keywordIndex]])||(t.dateDisplayFormat=e[zn[this.keywordIndex]]);else if(("ComboBox"===t.type||"DropDownList"===t.type)&&!sf.base.isNullOrUndefined(e[_n[this.keywordIndex]]))for(var i=0;i<e[_n[this.keywordIndex]].length;i++){var r=new Ha;r.displayText=e[_n[this.keywordIndex]][i][Xn[this.keywordIndex]],r.value=e[_n[this.keywordIndex]][i][Kn[this.keywordIndex]],t.contentControlListItems.push(r)}sf.base.isNullOrUndefined(e[jn[this.keywordIndex]])||(t.xmlMapping=new Ra,t.xmlMapping.isMapped=x.parseBoolValue(e[jn[this.keywordIndex]][Jn[this.keywordIndex]]),t.xmlMapping.isWordMl=x.parseBoolValue(e[jn[this.keywordIndex]][Yn[this.keywordIndex]]),sf.base.isNullOrUndefined(e[jn[this.keywordIndex]][Zn[this.keywordIndex]])||(t.xmlMapping.prefixMapping=e[jn[this.keywordIndex]][Zn[this.keywordIndex]]),t.xmlMapping.xPath=e[jn[this.keywordIndex]][Qn[this.keywordIndex]],t.xmlMapping.storeItemId=e[jn[this.keywordIndex]][$n[this.keywordIndex]],sf.base.isNullOrUndefined(e[jn[this.keywordIndex]][eo[this.keywordIndex]])||(t.xmlMapping.customXmlPart=new Ua,t.xmlMapping.customXmlPart.id=e[jn[this.keywordIndex]][eo[this.keywordIndex]][to[this.keywordIndex]],t.xmlMapping.customXmlPart.xml=e[jn[this.keywordIndex]][eo[this.keywordIndex]][Fn[this.keywordIndex]]))},e.prototype.parseSymbol=function(e,t){var i=e.split(" "),r=i.indexOf("SYMBOL");if(-1!==r){var n=i[r+1],o=new Fa;o.characterFormat=new T(o),o.text=String.fromCharCode(parseInt(n));var s=i.indexOf("\\f");if(-1!==s){for(var a="",l=s+1;l<i.length&&"\\s"!==i[l];l++)a+=i[l]+" ";null!==a&&(a=(a=a.replace(/"/g,"")).trim(),o.characterFormat.fontFamily=a)}var d=i.indexOf("\\s");-1!==d&&(o.characterFormat.fontSize=parseInt(i[d+1])),o.line=t,t.children.push(o)}},e.prototype.parseParagraph=function(e,t,i,r){var n=this,o=!1;sf.base.isNullOrUndefined(r)?r=new ma(t):o=!0,e.hasOwnProperty(se[this.keywordIndex])&&(t.isCreatedUsingHtmlSpanTag=x.parseBoolValue(e[se[this.keywordIndex]]));for(var s,a,l=!1,d=this.viewer.owner.enableTrackChanges,h=0,c=!1,p=!1,g=void 0,f=function(o){var f=e[o];if(c=!1,f.hasOwnProperty([Zr[u.keywordIndex]])&&(2===f[Zr[u.keywordIndex]]&&(h=o),1===f[Zr[u.keywordIndex]]&&h+1===o&&(c=!0,h=0)),c&&u.documentHelper.isPageField)return(m=new Sa).characterFormat=new T(m),m.text="",m.line=r,r.children.push(m),l=!0,o--,a=o,"continue";if(c&&!sf.base.isNullOrUndefined(g)&&-1!==g.indexOf("SYMBOL")&&(u.parseSymbol(g,r),g=void 0,c=!1),f.hasOwnProperty(gr[u.keywordIndex])||f.hasOwnProperty(Be[u.keywordIndex])){var m=void 0;if(u.documentHelper.isPageField)(m=new Sa).fieldBegin=u.documentHelper.fieldStacks[u.documentHelper.fieldStacks.length-1];else if("\t"===f[gr[u.keywordIndex]])m=new Pa;else{if("\f"===f[gr[u.keywordIndex]]&&u.isPageBreakInsideTable)return a=o,"continue";if(f.hasOwnProperty(Be[u.keywordIndex]))(m=new gl).breakClearType=u.getBreakClearType(f[Be[u.keywordIndex]]);else if(m=new Fa,0===f[gr[u.keywordIndex]].length&&!sf.base.isNullOrUndefined(f[Ge[u.keywordIndex]]))return a=o,"continue"}if(m.characterFormat=new T(m),u.parseCharacterFormat(u.keywordIndex,f[q[u.keywordIndex]],m.characterFormat,i),u.applyCharacterStyle(f,m),m.text=m instanceof gl?"\v":f[gr[u.keywordIndex]],g=m.text,u.isHtmlPaste&&(m instanceof Fa||m instanceof gl)){var y=void 0;r.children.length>0&&(y=r.children[r.children.length-1]),u.documentHelper.textHelper.isRTLText(m.text)?(m.characterFormat.bidi=!0,y instanceof Fa&&" "===y.text&&(y.characterFormat.bidi=!0)):" "===m.text&&y&&y.characterFormat.bidi&&(m.characterFormat.bidi=!0)}if(u.documentHelper.owner.parser.isPaste&&!u.isCutPerformed){if(!sf.base.isNullOrUndefined(f[Ge[u.keywordIndex]]))for(var v=0;v<f[Ge[u.keywordIndex]].length;v++)if(u.revisionCollection.containsKey(f[Ge[u.keywordIndex]][v])){if(d&&(s=u.revisionCollection.get(f[Ge[u.keywordIndex]][v])),!sf.base.isNullOrUndefined(s)&&!sf.base.isNullOrUndefined(r.children[o-1].revisions[v])&&(!d||d&&"Deletion"===s.revisionType)&&s.revisionID===f[Ge[u.keywordIndex]][v]){f[Ge[u.keywordIndex]][v]=r.children[o-1].revisions[v].revisionID,u.checkAndApplyRevision(u.keywordIndex,f,m);continue}d||(s=u.documentHelper.revisionsInternal.get(f[Ge[u.keywordIndex]][v])),u.documentHelper.owner.editorModule.insertRevision(m,s.revisionType,s.author),f[Ge[u.keywordIndex]][v]=m.revisions[v].revisionID}}else u.checkAndApplyRevision(u.keywordIndex,f,m);m.line=r;for(var w=r.children,b=w.length-1;w.length>0&&w[b]instanceof Na&&!sf.base.isNullOrUndefined(w[b].properties)&&!0===w[b].properties.isAfterParagraphMark;)b--;b!==w.length-1?w.splice(b+1,0,m):w.push(m),m instanceof Fa&&m.text.length>90&&x.splitWordByMaxLength(m,r,!0),l=!0}else if(f.hasOwnProperty(Cn[u.keywordIndex])){var I=new Wa;I.line=r,I.footnoteType=u.getFootnoteType(f[Cn[u.keywordIndex]]),"Footnote"===I.footnoteType?u.documentHelper.footnoteCollection.push(I):u.documentHelper.endnoteCollection.push(I),I.symbolCode=f[Wn[u.keywordIndex]],I.symbolFontName=f[kn[u.keywordIndex]],I.customMarker=f[Sn[u.keywordIndex]],I.characterFormat=new T(I),u.parseCharacterFormat(u.keywordIndex,f[q[u.keywordIndex]],I.characterFormat,i),u.applyCharacterStyle(f,I),u.parseBody(f[xo[u.keywordIndex]],I.bodyWidget.childWidgets,I.bodyWidget,!1),u.checkAndApplyRevision(u.keywordIndex,f,I),r.children.push(I),l=!0}else if(f.hasOwnProperty(dr[u.keywordIndex])){u.documentHelper.owner.editor&&(u.documentHelper.owner.editor.chartType=!0);var F=new ja;F.title=f[lr[u.keywordIndex]],F.type=f[dr[u.keywordIndex]],F.chartGapWidth=f[hr[u.keywordIndex]],F.chartOverlap=f[cr[u.keywordIndex]],u.parseChartTitleArea(f[rr[u.keywordIndex]],F.chartTitleArea),u.parseChartArea(f[ir[u.keywordIndex]],F.chartArea),u.parseChartArea(f[nr[u.keywordIndex]],F.chartPlotArea),u.parseChartLegend(f[or[u.keywordIndex]],F.chartLegend),u.parseChartData(f,F),u.parseChartCategoryAxis(f[sr[u.keywordIndex]],F.chartPrimaryCategoryAxis),u.parseChartCategoryAxis(f[ar[u.keywordIndex]],F.chartPrimaryValueAxis),null!=f[pr[u.keywordIndex]]&&u.parseChartDataTable(f[pr[u.keywordIndex]],F.chartDataTable),F.line=r,r.children.push(F),F.height=x.convertPointToPixel(f[br[u.keywordIndex]]),F.width=x.convertPointToPixel(f[wr[u.keywordIndex]]);var C=new sf.officechart.ChartComponent;C.chartRender(f,u.keywordIndex),F.officeChart=C,C.chart.appendTo(F.targetElement),l=!0}else if(f.hasOwnProperty(Mr[u.keywordIndex])){var W=new Da(x.parseBoolValue(f[Dr[u.keywordIndex]]));W.isMetaFile=x.parseBoolValue(f[Vr[u.keywordIndex]]),W.isCompressed=f[Ss[u.keywordIndex]],W.metaFileImageString=f[zr[u.keywordIndex]],W.characterFormat=new T(W),W.line=r,u.checkAndApplyRevision(u.keywordIndex,f,W),r.children.push(W);var k=x.formatClippedString(f[Mr[u.keywordIndex]]).formatClippedString;u.validateImageUrl(k)?u.isPaste&&!sf.base.isNullOrUndefined(u.documentHelper.owner.editor.pasteImageIndex)?W.imageString=u.documentHelper.owner.editor.pasteImageIndex.get(f[Mr[u.keywordIndex]]):W.imageString=f[Mr[u.keywordIndex]]:W.imageString="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAgVBMVEX///8AAADgAADY2Njl5eVcXFxjY2NZWVl/f3+wsLCmpqb4+PiioqKpqam7u7vV1dX2uLj2wsLhFRXzpKT3vb30sbHhCwv74+P40dH+9vbkIyO2trbBwcHLy8tsbGycnJz529v4zMzrbGzlLS3qZmblNzfrdXXoRkbvi4vvgYHlHh7CZsBOAAADpUlEQVR4nO3da1faQBSF4ekAUQlUEFs14AXxVv7/D6yaQiZx5mSEYXF2ut+PNKzyyK5diYDmR9czx34AB49C/CjE759w3jvvWr15Tdgz3atXE54f++EcIArxoxA/CvGjED8K8aMQPwrxoxA/CvGLEeZ9jPJdhfk4GyCUjb3ECGE/Q6m/q3DwfudjP0ERZYN9hKdn2hvd3+0jHJz5/kBVuTk96bbQUEjhYR9ckiikUH8UUqg/CinUH4UU6o9CCvVHIYX6o5BC/VFIof4opFB/FFKoPwop1B+FFOqPQgrjyxfjVC38Lxk9tnAxGqZqdKtSOE4GHA5/fuNJpDCtcNHbv4VqYYqPLjgfUViPQgrjozA2CptRSGF8/59w+Wrt+rr1btNna1cPzg0wwuXavncxabnX7PfHYYXzlYARvlobQZyUR9mXm+1NMEK7SSLONgcVV9vb8IQXv4J3KSeKKlxXxNCzONkeYp8AV3p9UT1+P3FWHVAsq5thhGZSEb1DrSZq7dS5HUdoLiuBZ6jORG3tCwAkNJfCUJ2Jrqe1P0ESCkMNTdSACYNDDU7UoAkDQw1P1MAJvUMVJmrwhJ6hShM1gMIvQxUnahCFjaHKEzWQQneoxR95ogZTWBuqPFEDKnSHKk/UoArdoYoTNbDC5lBDEzW4QjMpYiZqgIXG/S76JhwHK5zVVipcnkIVuv/RW/HyFKhwYhuFr6NiCmdNoDBUSGFjovJQEYXuRN9ahwoorJ8uSZenPsMTNk+X2q6jwgm/ntHL11HhhL4zenmoYEL/Gb04VCxh6KKTNFQoYfiikzBUJKF00Sk8VCChfF00OFQcYdt10dBQYYRT5xn0n9G7Q0X8GfCzNNEyZ6iPgD/HlydaVg11DfhajJaJlm2HugIUrlomWrYZKuJKHz6vHhbSM/hROdRnxNe1meuXYvW0DB6+aflYrB7dlzDiCM3N1dVN6GDhMCDhjlHYjEIK46MwNgqbUUhhfJ/vA07wO8N1vw94ONo/3e/lTpVOYfc/UyG//ZmqW52fi/FuTNW3/lZ+eguF+qOQQv1RSKH+KKRQfxRSqD8KKdQfhRTqj0IK9UchhfqjkEL9UUih/iikUH8UUqg/CmXh6Hsv3jlK+wnvD/vgkrSHMMuyu1P9ZdmuwnycDQYn+svG3n9KEUKT9zHyf6+IEWJHIX4U4kchfhTiRyF+FOJHIX4U4kchfnVhijeZa6sunCf4ZdPamteEHY5C/CjEr/vCv0ec0g+AtS1QAAAAAElFTkSuQmCC","NaN"===parseInt(f[Mr[u.keywordIndex]]).toString()&&u.documentHelper.addBase64StringInCollection(W),W.width=x.convertPointToPixel(f[wr[u.keywordIndex]]),W.height=x.convertPointToPixel(f[br[u.keywordIndex]]);var S=u.documentHelper.getImageString(W);sf.base.isNullOrUndefined(S)||!x.startsWith(S,"http://")&&!x.startsWith(S,"https://")||(W.element.crossOrigin="Anonymous",u.viewer.documentHelper.getBase64(S,W.width,W.height).then((function(e){n.viewer.documentHelper.images.get(parseInt(W.imageString))[1]=e})),S+="?t="+(new Date).getTime()),W.element.src=S,W.top=f[qr[u.keywordIndex]],W.left=f[Gr[u.keywordIndex]],W.bottom=f[_r[u.keywordIndex]],W.right=f[jr[u.keywordIndex]],W.cropHeightScale=f[Kr[u.keywordIndex]],W.cropWidthScale=f[Xr[u.keywordIndex]],W.name=f[ye[u.keywordIndex]],W.alternateText=f[ur[u.keywordIndex]],W.title=f[En[u.keywordIndex]],W.visible=x.parseBoolValue(f[mr[u.keywordIndex]]),W.widthScale=f[xr[u.keywordIndex]],W.heightScale=f[Ir[u.keywordIndex]],W.verticalPosition=x.convertPointToPixel(f[yo[u.keywordIndex]]),W.verticalOrigin=u.getVerticalOrigin(f[mo[u.keywordIndex]]),W.verticalAlignment=u.getShapeVerticalAlignment(f[zt[u.keywordIndex]]),W.horizontalPosition=x.convertPointToPixel(f[bo[u.keywordIndex]]),W.horizontalOrigin=u.getHorizontalOrigin(f[vo[u.keywordIndex]]),W.horizontalAlignment=u.getShapeHorizontalAlignment(f[wo[u.keywordIndex]]),W.allowOverlap=x.parseBoolValue(f[co[u.keywordIndex]]),sf.base.isNullOrUndefined(f[Wr[u.keywordIndex]])||(W.textWrappingStyle=u.getTextWrappingStyle(f[Wr[u.keywordIndex]])),sf.base.isNullOrUndefined(f[kr[u.keywordIndex]])||(W.textWrappingType=u.getTextWrappingType(f[kr[u.keywordIndex]])),W.isBelowText=x.parseBoolValue(f[yr[u.keywordIndex]]),sf.base.isNullOrUndefined(f[uo[u.keywordIndex]])||(W.distanceBottom=x.convertPointToPixel(f[uo[u.keywordIndex]])),sf.base.isNullOrUndefined(f[fo[u.keywordIndex]])||(W.distanceLeft=x.convertPointToPixel(f[fo[u.keywordIndex]])),sf.base.isNullOrUndefined(f[go[u.keywordIndex]])||(W.distanceRight=x.convertPointToPixel(f[go[u.keywordIndex]])),sf.base.isNullOrUndefined(f[po[u.keywordIndex]])||(W.distanceTop=x.convertPointToPixel(f[po[u.keywordIndex]])),W.zOrderPosition=f[Tr[u.keywordIndex]],W.layoutInCell=x.parseBoolValue(f[Hr[u.keywordIndex]]),(!sf.base.isNullOrUndefined(f[qr[u.keywordIndex]])&&0!==f[qr[u.keywordIndex]]||!sf.base.isNullOrUndefined(f[_r[u.keywordIndex]])&&0!==f[_r[u.keywordIndex]]||!sf.base.isNullOrUndefined(f[Gr[u.keywordIndex]])&&0!==f[Gr[u.keywordIndex]]||!sf.base.isNullOrUndefined(f[jr[u.keywordIndex]])&&0!==f[jr[u.keywordIndex]])&&(W.isCrop=!0),"Inline"!==u.getTextWrappingStyle(W.textWrappingStyle)&&t.floatingElements.push(W),u.parseCharacterFormat(u.keywordIndex,f[q[u.keywordIndex]],W.characterFormat),l=!0}else if(f.hasOwnProperty(Jr[u.keywordIndex])||f.hasOwnProperty(Zr[u.keywordIndex])&&0===f[Zr[u.keywordIndex]]){p=!0;var P=new va(0);if(u.parseCharacterFormat(u.keywordIndex,f[q[u.keywordIndex]],P.characterFormat,i),u.applyCharacterStyle(f,P),P.fieldCodeType=f.fieldCodeType,P.hasFieldEnd=f[Jr[u.keywordIndex]],f.hasOwnProperty(Yr[u.keywordIndex])){var N=void 0;f[Yr[u.keywordIndex]].hasOwnProperty(tn[u.keywordIndex])?((N=new ba).type=u.getTextFormFieldType(f[Yr[u.keywordIndex]][tn[u.keywordIndex]][hs[u.keywordIndex]]),N.maxLength=f[Yr[u.keywordIndex]][tn[u.keywordIndex]][on[u.keywordIndex]],N.defaultValue=f[Yr[u.keywordIndex]][tn[u.keywordIndex]][sn[u.keywordIndex]],N.format=u.getTextFormFieldFormat(f[Yr[u.keywordIndex]][tn[u.keywordIndex]][an[u.keywordIndex]])):f[Yr[u.keywordIndex]].hasOwnProperty(rn[u.keywordIndex])?((N=new xa).sizeType=u.getCheckBoxSizeType(f[Yr[u.keywordIndex]][rn[u.keywordIndex]][ln[u.keywordIndex]]),N.size=f[Yr[u.keywordIndex]][rn[u.keywordIndex]][dn[u.keywordIndex]],N.defaultValue=x.parseBoolValue(f[Yr[u.keywordIndex]][rn[u.keywordIndex]][sn[u.keywordIndex]]),N.checked=x.parseBoolValue(f[Yr[u.keywordIndex]][rn[u.keywordIndex]][hn[u.keywordIndex]])):((N=new Ia).dropdownItems=f[Yr[u.keywordIndex]][nn[u.keywordIndex]][cn[u.keywordIndex]],N.selectedIndex=f[Yr[u.keywordIndex]][nn[u.keywordIndex]][pn[u.keywordIndex]]),N.name=f[Yr[u.keywordIndex]][ye[u.keywordIndex]],N.enabled=x.parseBoolValue(f[Yr[u.keywordIndex]][Qr[u.keywordIndex]]),N.helpText=f[Yr[u.keywordIndex]][$r[u.keywordIndex]],N.statusText=f[Yr[u.keywordIndex]][en[u.keywordIndex]],P.formFieldData=N,u.documentHelper.formFields.push(P)}u.documentHelper.fieldStacks.push(P),u.checkAndApplyRevision(u.keywordIndex,f,P),P.line=r,u.documentHelper.fields.push(P),r.children.push(P)}else if(f.hasOwnProperty([Zr[u.keywordIndex]])){var O=void 0;if(2===f[Zr[u.keywordIndex]]||1===f[Zr[u.keywordIndex]]&&p){if(O=new va(2),u.parseCharacterFormat(u.keywordIndex,f[q[u.keywordIndex]],O.characterFormat,i),u.checkAndApplyRevision(u.keywordIndex,f,O),u.fieldSeparator=O,u.documentHelper.fieldStacks.length>0)if(O.fieldBegin=u.documentHelper.fieldStacks[u.documentHelper.fieldStacks.length-1],O.fieldBegin.fieldSeparator=O,r.children.length>=2){var H=u.containsFieldBegin(r);if(!sf.base.isNullOrUndefined(H)&&H instanceof Fa&&(H.text.match("PAGE")||H.text.match("page")))H.text.replace(/^\s+/g,"").startsWith("HYPERLINK")||(u.documentHelper.isPageField=!0)}1===f[Zr[u.keywordIndex]]&&p&&(o--,h=o),p=!1}else 1===f[Zr[u.keywordIndex]]&&(O=new va(1),u.parseCharacterFormat(u.keywordIndex,f[q[u.keywordIndex]],O.characterFormat,i),u.applyCharacterStyle(f,O),u.checkAndApplyRevision(u.keywordIndex,f,O),u.documentHelper.fieldStacks.length>0&&(O.fieldBegin=u.documentHelper.fieldStacks[u.documentHelper.fieldStacks.length-1],O.fieldBegin.fieldEnd=O),!sf.base.isNullOrUndefined(O.fieldBegin)&&O.fieldBegin.fieldSeparator&&(O.fieldSeparator=O.fieldBegin.fieldSeparator,O.fieldBegin.fieldSeparator.fieldEnd=O,l=!0),u.documentHelper.fieldStacks.splice(u.documentHelper.fieldStacks.length-1,1),u.fieldSeparator=void 0,u.documentHelper.isPageField=!1,u.documentHelper.fieldCollection.push(O.fieldBegin),g=void 0);O.line=r,r.children.push(O)}else if(f.hasOwnProperty([qo[u.keywordIndex]])){var E=void 0;if((E=new Na(f[qo[u.keywordIndex]])).name=f[ye[u.keywordIndex]],E.properties=f[_o[u.keywordIndex]],sf.base.isNullOrUndefined(f[_o[u.keywordIndex]])||(sf.base.isNullOrUndefined(f[_o[u.keywordIndex]][Os[u.keywordIndex]])||(E.properties.isAfterParagraphMark=x.parseBoolValue(f[_o[u.keywordIndex]][Os[u.keywordIndex]])),sf.base.isNullOrUndefined(f[_o[u.keywordIndex]][Us[u.keywordIndex]])||(E.properties.isAfterTableMark=x.parseBoolValue(f[_o[u.keywordIndex]][Us[u.keywordIndex]])),sf.base.isNullOrUndefined(f[_o[u.keywordIndex]][Hs[u.keywordIndex]])||(E.properties.isAfterRowMark=x.parseBoolValue(f[_o[u.keywordIndex]][Hs[u.keywordIndex]])),sf.base.isNullOrUndefined(f[_o[u.keywordIndex]][Ts[u.keywordIndex]])||(E.properties.isAfterCellMark=x.parseBoolValue(f[_o[u.keywordIndex]][Ts[u.keywordIndex]])),sf.base.isNullOrUndefined(f[_o[u.keywordIndex]][Yo[u.keywordIndex]])||(E.properties.columnFirst=f[_o[u.keywordIndex]][Yo[u.keywordIndex]]),sf.base.isNullOrUndefined(f[_o[u.keywordIndex]][Zo[u.keywordIndex]])||(E.properties.columnLast=f[_o[u.keywordIndex]][Zo[u.keywordIndex]])),u.checkAndApplyRevision(u.keywordIndex,f,E),r.children.push(E),E.line=r,!u.isParseHeader||u.isPaste)if(0===f[qo[u.keywordIndex]]){var R=u.isPaste&&!u.documentHelper.bookmarks.containsKey(E.name);!u.isPaste||R?u.documentHelper.bookmarks.add(E.name,E):R||r.children.splice(r.children.indexOf(E),1)}else if(1===f[qo[u.keywordIndex]]&&u.documentHelper.bookmarks.containsKey(E.name)){var U=u.documentHelper.bookmarks.get(E.name),B=u.isPaste&&sf.base.isNullOrUndefined(U.reference);!u.isPaste||B?(U.reference=E,E.reference=U,u.documentHelper.endBookmarksUpdated.push(E.name)):B||r.children.splice(r.children.indexOf(E),1)}0!==E.name.indexOf("_")&&(l=!0)}else if(f.hasOwnProperty([Jo[u.keywordIndex]])){if(f.hasOwnProperty(es[u.keywordIndex])){var L=new qa;if(u.editableRanges.containsKey(f[Jo[u.keywordIndex]])){var A=u.editableRanges.get(f[Jo[u.keywordIndex]]);L.editRangeStart=A,A.editRangeEnd=L,sf.base.isNullOrUndefined(f[Jo[u.keywordIndex]])||(L.editRangeId=f[Jo[u.keywordIndex]]),u.editableRanges.remove(f[Jo[u.keywordIndex]])}r.children.push(L),L.line=r}else{var M=u.parseEditableRangeStart(f);r.children.push(M),M.line=r,u.editableRanges.containsKey(f[Jo[u.keywordIndex]])||u.editableRanges.add(f[Jo[u.keywordIndex]],M)}l=!0}else if(f.hasOwnProperty([gn[u.keywordIndex]])){var z=f[gn[u.keywordIndex]],D=void 0;u.commentStarts.containsKey(z)&&u.commentStarts.get(z);if(u.commentEnds.containsKey(z)&&u.commentEnds.get(z),f.hasOwnProperty([fn[u.keywordIndex]])){if(0===f[fn[u.keywordIndex]]){var V=new al(0);V.commentId=z,u.commentStarts.containsKey(z)||u.commentStarts.add(z,V),V.line=r,r.children.push(V),D=u.commentsCollection.get(z),sf.base.isNullOrUndefined(D)||(D.commentStart=V,V.comment=D)}else{var _=new al(1);_.commentId=z,u.commentEnds.containsKey(z)||u.commentEnds.add(z,_),_.line=r,r.children.push(_),D=u.commentsCollection.get(z),sf.base.isNullOrUndefined(D)||(D.commentEnd=_,_.comment=D)}!sf.base.isNullOrUndefined(D)&&D.isReply&&(sf.base.isNullOrUndefined(D.ownerComment.commentStart)&&(D.ownerComment.commentStart=D.commentStart),sf.base.isNullOrUndefined(D.ownerComment.commentEnd)&&(D.ownerComment.commentEnd=D.commentEnd))}}else if(f.hasOwnProperty([fr[u.keywordIndex]])){var j=new La;if(j.shapeId=f[fr[u.keywordIndex]],j.name=f[ye[u.keywordIndex]],j.alternateText=f[ur[u.keywordIndex]],j.title=f[En[u.keywordIndex]],j.visible=x.parseBoolValue(f[mr[u.keywordIndex]]),j.width=x.convertPointToPixel(f[wr[u.keywordIndex]]),j.height=x.convertPointToPixel(f[br[u.keywordIndex]]),0===j.height&&(j.isZeroHeight=!0),j.widthScale=f[xr[u.keywordIndex]],j.heightScale=f[Ir[u.keywordIndex]],j.verticalPosition=x.convertPointToPixel(f[yo[u.keywordIndex]]),j.verticalOrigin=u.getVerticalOrigin(f[mo[u.keywordIndex]]),j.verticalAlignment=u.getShapeVerticalAlignment(f[zt[u.keywordIndex]]),j.verticalRelativePercent=f[Sr[u.keywordIndex]],j.horizontalPosition=x.convertPointToPixel(f[bo[u.keywordIndex]]),j.horizontalOrigin=u.getHorizontalOrigin(f[vo[u.keywordIndex]]),j.horizontalAlignment=u.getShapeHorizontalAlignment(f[wo[u.keywordIndex]]),j.horizontalRelativePercent=f[Pr[u.keywordIndex]],j.heightRelativePercent=f[Nr[u.keywordIndex]],j.widthRelativePercent=f[Or[u.keywordIndex]],j.zOrderPosition=f[Tr[u.keywordIndex]],j.allowOverlap=x.parseBoolValue(f[co[u.keywordIndex]]),j.textWrappingStyle=u.getTextWrappingStyle(f[Wr[u.keywordIndex]]),j.textWrappingType=u.getTextWrappingType(f[kr[u.keywordIndex]]),j.isBelowText=x.parseBoolValue(f[yr[u.keywordIndex]]),j.isHorizontalRule=x.parseBoolValue(f[vr[u.keywordIndex]]),sf.base.isNullOrUndefined(f[uo[u.keywordIndex]])||(j.distanceBottom=x.convertPointToPixel(f[uo[u.keywordIndex]])),sf.base.isNullOrUndefined(f[fo[u.keywordIndex]])||(j.distanceLeft=x.convertPointToPixel(f[fo[u.keywordIndex]])),sf.base.isNullOrUndefined(f[go[u.keywordIndex]])||(j.distanceRight=x.convertPointToPixel(f[go[u.keywordIndex]])),sf.base.isNullOrUndefined(f[po[u.keywordIndex]])||(j.distanceTop=x.convertPointToPixel(f[po[u.keywordIndex]])),j.layoutInCell=x.parseBoolValue(f[Hr[u.keywordIndex]]),j.lockAnchor=x.parseBoolValue(f[Er[u.keywordIndex]]),j.autoShapeType=u.getAutoShapeType(f[Rr[u.keywordIndex]]),f.hasOwnProperty(Fr[u.keywordIndex])){var G=new Ma;G.line=x.parseBoolValue(f[Fr[u.keywordIndex]][wi[u.keywordIndex]]),G.lineFormatType=u.getLineFormatType(f[Fr[u.keywordIndex]][Is[u.keywordIndex]]),G.color=f[Fr[u.keywordIndex]][Br[u.keywordIndex]],G.weight=f[Fr[u.keywordIndex]][Cs[u.keywordIndex]],G.dashStyle=u.getLineDashStyle(f[Fr[u.keywordIndex]][pi[u.keywordIndex]]),j.lineFormat=G}if(f.hasOwnProperty(Cr[u.keywordIndex])){var K=new za;K.color=f[Cr[u.keywordIndex]][Br[u.keywordIndex]],K.fill=x.parseBoolValue(f[Cr[u.keywordIndex]][Lr[u.keywordIndex]]),j.fillFormat=K}if(f.hasOwnProperty(Ur[u.keywordIndex])){var X=new Aa;X.textVerticalAlignment=u.getTextVerticalAlignment(f[Ur[u.keywordIndex]][Ar[u.keywordIndex]]),X.marginLeft=x.convertPointToPixel(f[Ur[u.keywordIndex]][wt[u.keywordIndex]]),X.marginRight=x.convertPointToPixel(f[Ur[u.keywordIndex]][bt[u.keywordIndex]]),X.marginTop=x.convertPointToPixel(f[Ur[u.keywordIndex]][xt[u.keywordIndex]]),X.marginBottom=x.convertPointToPixel(f[Ur[u.keywordIndex]][It[u.keywordIndex]]),u.parseBody(f[Ur[u.keywordIndex]][xo[u.keywordIndex]],X.childWidgets,X),j.textFrame=X,X.containerShape=j}j.line=r,u.checkAndApplyRevision(u.keywordIndex,f,j),r.children.push(j),t.floatingElements.push(j)}else if(f.hasOwnProperty(Nn[u.keywordIndex])){var J=new Oa("Inline"),Y=new Oa("Inline");u.parseContentControlProperties(f[Nn[u.keywordIndex]],J.contentControlProperties),Y.contentControlProperties=J.contentControlProperties,J.line=r,Y.line=r,J.type=0,Y.type=1,r.children.push(J),u.parseParagraph(f[Pn[u.keywordIndex]],t,i,r);for(var Z=r.children[r.children.length-1];!(Z instanceof Oa);)Z.contentControlProperties=J.contentControlProperties,Z=Z.previousElement;r.children.push(Y),l=!0}a=o},u=this,m=0;m<e.length;m++)f(m),m=a;return this.isCutPerformed=!1,o||t.childWidgets.push(r),l},e.prototype.applyCharacterStyle=function(e,t){if(!sf.base.isNullOrUndefined(e[q[this.keywordIndex]])&&!sf.base.isNullOrUndefined(e[q[this.keywordIndex]][Ee[this.keywordIndex]])){var i=this.documentHelper.styles.findByName(e[q[this.keywordIndex]][Ee[this.keywordIndex]],"Character");t.characterFormat.applyStyle(i)}},e.prototype.parseEditableRangeStart=function(e){var t=new _a;return sf.base.isNullOrUndefined(e[Yo[this.keywordIndex]])||(t.columnFirst=e[Yo[this.keywordIndex]]),sf.base.isNullOrUndefined(e[Zo[this.keywordIndex]])||(t.columnLast=e[Zo[this.keywordIndex]]),sf.base.isNullOrUndefined(e[Jo[this.keywordIndex]])||(t.editRangeId=e[Jo[this.keywordIndex]]),sf.base.isNullOrUndefined(e[Qo[this.keywordIndex]])||(t.user=e[Qo[this.keywordIndex]],-1===this.documentHelper.userCollection.indexOf(t.user)&&this.documentHelper.userCollection.push(t.user),this.addEditRangeCollection(t.user,t)),sf.base.isNullOrUndefined(e[$o[this.keywordIndex]])||""===e[$o[this.keywordIndex]]||(t.group=e[$o[this.keywordIndex]],t.group="everyone"===t.group?"Everyone":t.group,-1===this.documentHelper.userCollection.indexOf(t.group)&&this.documentHelper.userCollection.push(t.group),this.addEditRangeCollection(t.group,t)),t},e.prototype.addEditRangeCollection=function(e,t){if(this.documentHelper.editRanges.containsKey(e)){this.documentHelper.editRanges.get(e).push(t)}else{var i=[];i.push(t),this.documentHelper.editRanges.add(e,i)}},e.prototype.parseChartTitleArea=function(e,t){t.chartfontName=e[ks[this.keywordIndex]],t.chartFontSize=e[Oe[this.keywordIndex]],this.parseChartDataFormat(e[ui[this.keywordIndex]],t.dataFormat),this.parseChartLayout(e[fi[this.keywordIndex]],t.layout)},e.prototype.parseChartDataFormat=function(e,t){t.fill.color=e[Lr[this.keywordIndex]][bi[this.keywordIndex]],t.fill.rgb=e[Lr[this.keywordIndex]][bs[this.keywordIndex]],t.line.color=e[wi[this.keywordIndex]][Br[this.keywordIndex]],t.line.rgb=e[wi[this.keywordIndex]][bs[this.keywordIndex]]},e.prototype.parseChartLayout=function(e,t){t.chartLayoutLeft=e[xi[this.keywordIndex]],t.chartLayoutTop=e[Ii[this.keywordIndex]]},e.prototype.parseChartLegend=function(e,t){t.chartLegendPostion=e[Go[this.keywordIndex]],this.parseChartTitleArea(e[rr[this.keywordIndex]],t.chartTitleArea)},e.prototype.parseChartCategoryAxis=function(e,t){t.categoryAxisType=e[$i[this.keywordIndex]],t.categoryNumberFormat=e[Uo[this.keywordIndex]],e.hasOwnProperty(ps[this.keywordIndex])&&(t.isAutoInternal=x.parseBoolValue(e[ps[this.keywordIndex]])),t.interval=e[cs[this.keywordIndex]],t.axisFontSize=e[Oe[this.keywordIndex]],t.axisFontName=e[ks[this.keywordIndex]],t.max=e[gs[this.keywordIndex]],t.min=e[fs[this.keywordIndex]],t.majorGridLines=x.parseBoolValue(e[us[this.keywordIndex]]),t.minorGridLines=x.parseBoolValue(e[ms[this.keywordIndex]]),t.majorTick=e[ys[this.keywordIndex]],t.minorTick=e[vs[this.keywordIndex]],t.tickPosition=e[ws[this.keywordIndex]],t.categoryAxisTitle=e[lr[this.keywordIndex]],null!=e[lr[this.keywordIndex]]&&this.parseChartTitleArea(e[rr[this.keywordIndex]],t.chartTitleArea)},e.prototype.parseChartDataTable=function(e,t){t.showSeriesKeys=x.parseBoolValue(e[Ji[this.keywordIndex]]),t.hasHorzBorder=x.parseBoolValue(e[Yi[this.keywordIndex]]),t.hasVertBorder=x.parseBoolValue(e[Zi[this.keywordIndex]]),t.hasBorders=x.parseBoolValue(e[Qi[this.keywordIndex]])},e.prototype.parseChartArea=function(e,t){t.chartForeColor=e[bi[this.keywordIndex]]},e.prototype.parseChartData=function(e,t){for(var i=0;i<e[er[this.keywordIndex]].length;i++){var r=new Ka,n=e[er[this.keywordIndex]][i];n.hasOwnProperty(vi[this.keywordIndex])&&(r.xName=n[vi[this.keywordIndex]]);for(var o=0;o<n[yi[this.keywordIndex]].length;o++){var s=new Xa,a=n[yi[this.keywordIndex]][o];s.yAxisValue=a[mi[this.keywordIndex]],"Bubble"===e[dr[this.keywordIndex]]&&(s.bubbleSize=a[dn[this.keywordIndex]]),r.chartData.push(s)}t.chartCategory.push(r)}this.parseChartSeries(e,t)},e.prototype.parseChartSeries=function(e,t){for(var i=e[dr[this.keywordIndex]],r="Pie"===i||"Doughnut"===i,n=0;n<e[tr[this.keywordIndex]].length;n++){var o=new Ya,s=e[tr[this.keywordIndex]][n];if(s.hasOwnProperty(Ri[this.keywordIndex])){if(o.seriesName=s[Ri[this.keywordIndex]],r&&(s.hasOwnProperty(zi[this.keywordIndex])&&(o.firstSliceAngle=s[zi[this.keywordIndex]]),"Doughnut"===i&&(o.doughnutHoleSize=s[Di[this.keywordIndex]])),s.hasOwnProperty(Ui[this.keywordIndex])&&this.parseChartDataLabels(s[Ui[this.keywordIndex]],o),s.hasOwnProperty(Li[this.keywordIndex])){var a=new Qa,l=s[Li[this.keywordIndex]];a.markerStyle=l[ki[this.keywordIndex]],a.markerColor=l[Si[this.keywordIndex]],a.numberValue=l[Pi[this.keywordIndex]],o.seriesFormat=a}if(s.hasOwnProperty(Bi[this.keywordIndex])){var d=o.errorBar;d.errorType=s[Bi[this.keywordIndex]][hs[this.keywordIndex]],d.errorDirection=s[Bi[this.keywordIndex]][Fi[this.keywordIndex]],d.errorEndStyle=s[Bi[this.keywordIndex]][Ci[this.keywordIndex]],d.numberValue=s[Bi[this.keywordIndex]][Wi[this.keywordIndex]]}s.hasOwnProperty(Ai[this.keywordIndex])&&this.parseChartTrendLines(s[Ai[this.keywordIndex]],o),this.parseChartSeriesDataPoints(s[Mi[this.keywordIndex]],o)}t.chartSeries.push(o)}},e.prototype.parseChartDataLabels=function(e,t){var i=new $a;i.labelPosition=e[Go[this.keywordIndex]],i.fontName=e[ks[this.keywordIndex]],i.fontColor=e[Te[this.keywordIndex]],i.fontSize=e[Oe[this.keywordIndex]],i.isLegendKey=x.parseBoolValue(e[Vi[this.keywordIndex]]),i.isBubbleSize=x.parseBoolValue(e[qi[this.keywordIndex]]),i.isCategoryName=x.parseBoolValue(e[_i[this.keywordIndex]]),i.isSeriesName=x.parseBoolValue(e[ji[this.keywordIndex]]),i.isValue=x.parseBoolValue(e[Gi[this.keywordIndex]]),i.isPercentage=x.parseBoolValue(e[Ki[this.keywordIndex]]),i.isLeaderLines=x.parseBoolValue(e[Xi[this.keywordIndex]]),t.dataLabels=i},e.prototype.parseChartSeriesDataPoints=function(e,t){for(var i=0;i<e.length;i++){var r=new il;this.parseChartDataFormat(e[i],r),t.chartDataFormat.push(r)}},e.prototype.parseChartTrendLines=function(e,t){for(var i=0;i<e.length;i++){var r=e[i],n=new el;n.trendLineName=r[ye[this.keywordIndex]],n.trendLineType=r[hs[this.keywordIndex]],n.forwardValue=r[Ni[this.keywordIndex]],n.backwardValue=r[Oi[this.keywordIndex]],n.interceptValue=r[Ti[this.keywordIndex]],n.isDisplayEquation=x.parseBoolValue(r[Ei[this.keywordIndex]]),n.isDisplayRSquared=x.parseBoolValue(r[Hi[this.keywordIndex]]),t.trendLines.push(n)}},e.prototype.parseTableFormat=function(e,t){this.parseBorders(this.keywordIndex,e[ct[this.keywordIndex]],t.borders),sf.base.isNullOrUndefined(e[Yt[this.keywordIndex]])||(t.allowAutoFit=x.parseBoolValue(e[Yt[this.keywordIndex]])),sf.base.isNullOrUndefined(e[Zt[this.keywordIndex]])||(t.cellSpacing=e[Zt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[wt[this.keywordIndex]])||(t.leftMargin=e[wt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[xt[this.keywordIndex]])||(t.topMargin=e[xt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[bt[this.keywordIndex]])||(t.rightMargin=e[bt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[It[this.keywordIndex]])||(t.bottomMargin=e[It[this.keywordIndex]]),sf.base.isNullOrUndefined(e[Je[this.keywordIndex]])||(t.leftIndent=e[Je[this.keywordIndex]]),this.parseShading(e[Qt[this.keywordIndex]],t.shading),sf.base.isNullOrUndefined(e[$t[this.keywordIndex]])||(t.tableAlignment=this.getTableAlignment(e[$t[this.keywordIndex]])),sf.base.isNullOrUndefined(e[ei[this.keywordIndex]])||(t.preferredWidth=e[ei[this.keywordIndex]]),sf.base.isNullOrUndefined(e[ti[this.keywordIndex]])||(t.preferredWidthType=this.getWidthType(e[ti[this.keywordIndex]])),sf.base.isNullOrUndefined(e[Re[this.keywordIndex]])||(t.bidi=x.parseBoolValue(e[Re[this.keywordIndex]])),sf.base.isNullOrUndefined(e[ii[this.keywordIndex]])||(t.horizontalPositionAbs=this.getHorizontalPositionAbs(e[ii[this.keywordIndex]])),sf.base.isNullOrUndefined(e[bo[this.keywordIndex]])||(t.horizontalPosition=e[bo[this.keywordIndex]]),sf.base.isNullOrUndefined(e[Ee[this.keywordIndex]])||(t.styleName=e[Ee[this.keywordIndex]])},e.prototype.parseCellFormat=function(e,t){sf.base.isNullOrUndefined(e)||(this.parseBorders(this.keywordIndex,e[ct[this.keywordIndex]],t.borders),e.isSamePaddingAsTable||this.parseCellMargin(e,t),sf.base.isNullOrUndefined(e[Lt[this.keywordIndex]])||(t.cellWidth=e[Lt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[At[this.keywordIndex]])||(t.columnSpan=e[At[this.keywordIndex]]),sf.base.isNullOrUndefined(e[Mt[this.keywordIndex]])||(t.rowSpan=e[Mt[this.keywordIndex]]),this.parseShading(e[Qt[this.keywordIndex]],t.shading),sf.base.isNullOrUndefined(e[zt[this.keywordIndex]])||(t.verticalAlignment=this.getCellVerticalAlignment(e[zt[this.keywordIndex]])),sf.base.isNullOrUndefined(e[ti[this.keywordIndex]])||(t.preferredWidthType=this.getWidthType(e[ti[this.keywordIndex]])),sf.base.isNullOrUndefined(e[ei[this.keywordIndex]])||(t.preferredWidth=e[ei[this.keywordIndex]]))},e.prototype.parseCellMargin=function(e,t){sf.base.isNullOrUndefined(e[wt[this.keywordIndex]])||(t.leftMargin=e[wt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[bt[this.keywordIndex]])||(t.rightMargin=e[bt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[xt[this.keywordIndex]])||(t.topMargin=e[xt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[It[this.keywordIndex]])||(t.bottomMargin=e[It[this.keywordIndex]])},e.prototype.parseRowFormat=function(e,t){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e[Dt[this.keywordIndex]])||(t.allowBreakAcrossPages=x.parseBoolValue(e[Dt[this.keywordIndex]])),sf.base.isNullOrUndefined(e[Vt[this.keywordIndex]])||(t.isHeader=x.parseBoolValue(e[Vt[this.keywordIndex]])),sf.base.isNullOrUndefined(e[qt[this.keywordIndex]])||(t.heightType=this.getHeightType(e[qt[this.keywordIndex]])),sf.base.isNullOrUndefined(e[br[this.keywordIndex]])||(t.height=e[br[this.keywordIndex]]),sf.base.isNullOrUndefined(e[wt[this.keywordIndex]])||(t.leftMargin=e[wt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[xt[this.keywordIndex]])||(t.topMargin=e[xt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[bt[this.keywordIndex]])||(t.rightMargin=e[bt[this.keywordIndex]]),sf.base.isNullOrUndefined(e[It[this.keywordIndex]])||(t.bottomMargin=e[It[this.keywordIndex]]),sf.base.isNullOrUndefined(e[Je[this.keywordIndex]])||(t.leftIndent=e[Je[this.keywordIndex]]),!sf.base.isNullOrUndefined(e[Ge[this.keywordIndex]])&&e[Ge[this.keywordIndex]].length>0&&this.checkAndApplyRevision(this.keywordIndex,e,t),this.parseBorders(this.keywordIndex,e[ct[this.keywordIndex]],t.borders))},e.prototype.parseBorders=function(e,t,i){sf.base.isNullOrUndefined(t)||(i.isParsing=!0,this.parseBorder(e,t[Gr[e]],i.left),this.parseBorder(e,t[jr[e]],i.right),this.parseBorder(e,t[qr[e]],i.top),this.parseBorder(e,t[_r[e]],i.bottom),this.parseBorder(e,t[li[e]],i.vertical),this.parseBorder(e,t[di[e]],i.horizontal),this.parseBorder(e,t[ci[e]],i.diagonalDown),this.parseBorder(e,t[hi[e]],i.diagonalUp),i.isParsing=!1)},e.prototype.parseBorder=function(e,t,i){sf.base.isNullOrUndefined(t)||(sf.base.isNullOrUndefined(t[Br[e]])||(i.color=this.getColor(t[Br[e]])),sf.base.isNullOrUndefined(t[pi[e]])||(i.lineStyle=this.getLineStyle(t[pi[e]])),sf.base.isNullOrUndefined(t[gi[e]])||(i.lineWidth=t[gi[e]]),sf.base.isNullOrUndefined(t[ai[e]])||(i.hasNoneStyle=x.parseBoolValue(t[ai[e]])),sf.base.isNullOrUndefined(t[ts[e]])||(i.space=t[ts[e]]),sf.base.isNullOrUndefined(t[si[e]])||(i.shadow=x.parseBoolValue(t[si[e]])))},e.prototype.parseShading=function(e,t){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e[ni[this.keywordIndex]])||(t.backgroundColor=this.getColor(e[ni[this.keywordIndex]])),sf.base.isNullOrUndefined(e[oi[this.keywordIndex]])||(t.foregroundColor=this.getColor(e[oi[this.keywordIndex]])),sf.base.isNullOrUndefined(e[ri[this.keywordIndex]])&&sf.base.isNullOrUndefined(e.textureStyle)||(t.textureStyle=sf.base.isNullOrUndefined(e[ri[this.keywordIndex]])?this.getTextureStyle(e.textureStyle):this.getTextureStyle(e[ri[this.keywordIndex]])))},e.prototype.parseCharacterFormat=function(e,t,i,r){if(!sf.base.isNullOrUndefined(t)){if(r&&t.hasOwnProperty(Ws[e]))return void this.parseCharacterFormat(e,t[Ws[e]],i);if(sf.base.isNullOrUndefined(t[Se[e]])||(i.baselineAlignment=this.getBaseAlignment(t[Se[e]])),sf.base.isNullOrUndefined(t[ke[e]])||(i.underline=this.getUnderline(t[ke[e]])),sf.base.isNullOrUndefined(t[Pe[e]])||(i.strikethrough=this.getStrikethrough(t[Pe[e]])),!sf.base.isNullOrUndefined(t[Oe[e]])){t[Oe[e]]=parseFloat(t[Oe[e]]);var n=10*t[Oe[e]];n%10!=0&&(n=10*t[Oe[e]].toFixed(1),t[Oe[e]]=n%5==0?t[Oe[e]].toFixed(1):Math.round(t[Oe[e]]));var o=parseFloat(t[Oe[e]]);i.fontSize=o<0?0:o}if(!sf.base.isNullOrUndefined(t[He[e]])){-1!==t[He[e]].indexOf('"')&&(t[He[e]]=t[He[e]].replace('"',""));var s=t[He[e]];sf.base.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(s)||this.isFontInstalled(s)||(s=this.documentHelper.fontSubstitutionTable.get(s)),i.fontFamily=s,sf.base.isNullOrUndefined(t[_e[e]])&&(i.fontFamilyFarEast=s),sf.base.isNullOrUndefined(t[qe[e]])&&(i.fontFamilyAscii=s),sf.base.isNullOrUndefined(t[je[e]])&&(i.fontFamilyNonFarEast=s)}if(sf.base.isNullOrUndefined(t[Ce[e]])||(i.bold=x.parseBoolValue(t[Ce[e]])),sf.base.isNullOrUndefined(t[We[e]])||(i.italic=x.parseBoolValue(t[We[e]])),sf.base.isNullOrUndefined(t[Ne[e]])||(i.highlightColor=this.getHighlightColor(t[Ne[e]])),sf.base.isNullOrUndefined(t[Te[e]])||(i.fontColor=this.getColor(t[Te[e]])),sf.base.isNullOrUndefined(t[Re[e]])||(i.bidi=x.parseBoolValue(t[Re[e]])),sf.base.isNullOrUndefined(t[Ue[e]])||(i.bdo=this.getBiDirectionalOverride(t[Ue[e]])),sf.base.isNullOrUndefined(t[Bs[e]])||(i.characterSpacing=t[Bs[e]]),sf.base.isNullOrUndefined(t[Ls[e]])||(i.scaling=t[Ls[e]]),sf.base.isNullOrUndefined(t[Le[e]])||(i.fontSizeBidi=t[Le[e]]<0?0:t[Le[e]]),!sf.base.isNullOrUndefined(t[Ae[e]])){-1!==t[Ae[e]].indexOf('"')&&(t[Ae[e]]=t[Ae[e]].replace('"',""));var a=t[Ae[e]];sf.base.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(a)||this.isFontInstalled(a)||(a=this.documentHelper.fontSubstitutionTable.get(a)),i.fontFamilyBidi=a}if(sf.base.isNullOrUndefined(t[Me[e]])||(i.boldBidi=x.parseBoolValue(t[Me[e]])),sf.base.isNullOrUndefined(t[ze[e]])||(i.italicBidi=x.parseBoolValue(t[ze[e]])),!sf.base.isNullOrUndefined(t[Ge[e]])&&t[Ge[e]].length>0&&this.checkAndApplyRevision(e,t,i),sf.base.isNullOrUndefined(t[De[e]])||(i.allCaps=x.parseBoolValue(t[De[e]])),sf.base.isNullOrUndefined(t[Fe[e]])||(i.localeIdBidi=t[Fe[e]]),sf.base.isNullOrUndefined(t[xe[e]])||(i.localeIdAscii=t[xe[e]]),sf.base.isNullOrUndefined(t[Ie[e]])||(i.localeIdFarEast=t[Ie[e]]),sf.base.isNullOrUndefined(t[Ve[e]])||(i.complexScript=x.parseBoolValue(t[Ve[e]])),!sf.base.isNullOrUndefined(t[_e[e]])){-1!==t[_e[e]].indexOf('"')&&(t[_e[e]]=t[_e[e]].replace('"',""));var l=t[_e[e]];sf.base.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(l)||this.isFontInstalled(l)||(l=this.documentHelper.fontSubstitutionTable.get(l)),i.fontFamilyFarEast=l}if(!sf.base.isNullOrUndefined(t[qe[e]])){-1!==t[qe[e]].indexOf('"')&&(t[qe[e]]=t[qe[e]].replace('"',""));var d=t[qe[e]];sf.base.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(d)||this.isFontInstalled(d)||(d=this.documentHelper.fontSubstitutionTable.get(d)),i.fontFamilyAscii=d}if(!sf.base.isNullOrUndefined(t[je[e]])){-1!==t[je[e]].indexOf('"')&&(t[je[e]]=t[je[e]].replace('"',""));var h=t[je[e]];sf.base.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)||!this.documentHelper.fontSubstitutionTable.containsKey(h)||this.isFontInstalled(h)||(h=this.documentHelper.fontSubstitutionTable.get(h)),i.fontFamilyNonFarEast=h}}},e.prototype.isFontInstalled=function(e){var t=this.getWidth("monospace"),i=this.getWidth("sans-serif"),r=this.getWidth("serif");return t!==this.getWidth(e+", monospace",t)||i!==this.getWidth(e+", sans-serif",i)||r!==this.getWidth(e+", serif",r)},e.prototype.getWidth=function(e,t){var i,r=document.createElement("span");return r.innerHTML=Array(100).join("wi"),r.style.cssText=["position:absolute","width:auto","font-size:128px","left:-99999px"].join(" !important;"),r.style.fontFamily=e,document.body.appendChild(r),i=r.clientWidth,""!==r.style.fontFamily||sf.base.isNullOrUndefined(t)||(i=t),document.body.removeChild(r),i},e.prototype.getColor=function(e){return e||"#ffffff"},e.prototype.parseThemes=function(e,t){this.parseFontScheme(e[is[this.keywordIndex]],t)},e.prototype.parseFontScheme=function(e,t){sf.base.isNullOrUndefined(e[rs[this.keywordIndex]])||(t.fontScheme.fontSchemeName=e[rs[this.keywordIndex]]),sf.base.isNullOrUndefined(e[ns[this.keywordIndex]])||this.parseMajorMinorFontScheme(e[ns[this.keywordIndex]],t.fontScheme.majorFontScheme),sf.base.isNullOrUndefined(e[os[this.keywordIndex]])||this.parseMajorMinorFontScheme(e[os[this.keywordIndex]],t.fontScheme.minorFontScheme)},e.prototype.parseMajorMinorFontScheme=function(e,t){if(!sf.base.isNullOrUndefined(e[as[this.keywordIndex]])&&Object.keys(e[as[this.keywordIndex]]).length>0){for(var i=0,r=Object.keys(e[as[this.keywordIndex]]);i<r.length;i++){var n=r[i];t.fontTypeface.add(n,e[as[this.keywordIndex]][n])}this.documentHelper.hasThemes=!0}if(!sf.base.isNullOrUndefined(e[ss[this.keywordIndex]])&&e[ss[this.keywordIndex]].length>0){for(var o=0;o<e[ss[this.keywordIndex]].length;o++){var s=e[ss[this.keywordIndex]][o],a=new js;a.name=sf.base.isNullOrUndefined(s[ks[this.keywordIndex]])?s[ye[this.keywordIndex]]:s[ks[this.keywordIndex]],a.typeface=sf.base.isNullOrUndefined(s[as[this.keywordIndex]])?s[ls[this.keywordIndex]]:s[as[this.keywordIndex]],a.panose=(sf.base.isNullOrUndefined(s[ds[this.keywordIndex]]),s[ds[this.keywordIndex]]),t.fontSchemeList.push(a)}this.documentHelper.hasThemes=!0}},e.prototype.parseParagraphFormat=function(e,t,i){sf.base.isNullOrUndefined(t)||(sf.base.isNullOrUndefined(t[ct[e]])||this.parseBorders(e,t[ct[e]],i.borders),sf.base.isNullOrUndefined(t[Re[e]])||(i.bidi=x.parseBoolValue(t[Re[e]])),sf.base.isNullOrUndefined(t[Je[e]])||(i.leftIndent=t[Je[e]]),sf.base.isNullOrUndefined(t[Ye[e]])||(i.rightIndent=t[Ye[e]]),sf.base.isNullOrUndefined(t[Ze[e]])||(i.firstLineIndent=t[Ze[e]]),sf.base.isNullOrUndefined(t[$e[e]])||(i.afterSpacing=t[$e[e]]),sf.base.isNullOrUndefined(t[et[e]])||(i.beforeSpacing=t[et[e]]),sf.base.isNullOrUndefined(t[it[e]])||(i.spaceBeforeAuto=x.parseBoolValue(t[it[e]])),sf.base.isNullOrUndefined(t[tt[e]])||(i.spaceAfterAuto=x.parseBoolValue(t[tt[e]])),sf.base.isNullOrUndefined(t[rt[e]])||(i.lineSpacing=t[rt[e]]),sf.base.isNullOrUndefined(t[nt[e]])?sf.base.isNullOrUndefined(t[rt[e]])||(i.lineSpacingType="Multiple"):i.lineSpacingType=this.getLineSpacingType(t[nt[e]]),sf.base.isNullOrUndefined(t[Qe[e]])||(i.textAlignment=this.getTextAlignment(t[Qe[e]])),sf.base.isNullOrUndefined(t[dt[e]])||(i.outlineLevel=this.getOutlineLevel(t[dt[e]])),sf.base.isNullOrUndefined(t[ht[e]])||(i.contextualSpacing=x.parseBoolValue(t[ht[e]])),sf.base.isNullOrUndefined(t[st[e]])||(i.keepWithNext=x.parseBoolValue(t[st[e]])),sf.base.isNullOrUndefined(t[lt[e]])||(i.keepLinesTogether=x.parseBoolValue(t[lt[e]])),sf.base.isNullOrUndefined(t[at[e]])||(i.widowControl=x.parseBoolValue(t[at[e]])),i.listFormat=new m(i),t.hasOwnProperty(ot[e])&&this.parseListFormat(e,t,i.listFormat),t.hasOwnProperty(pt[e])&&this.parseTabStop(e,t[pt[e]],i.tabs))},e.prototype.parseListFormat=function(e,t,i){sf.base.isNullOrUndefined(t[ot[e]])||(sf.base.isNullOrUndefined(t[ot[e]][Ke[e]])||(i.listId=t[ot[e]][Ke[e]],i.list=this.documentHelper.getListById(t[ot[e]][Ke[e]])),sf.base.isNullOrUndefined(t[ot[e]][Xe[e]])||(i.listLevelNumber=t[ot[e]][Xe[e]]))},e.prototype.parseSectionFormat=function(e,t,i){if(sf.base.isNullOrUndefined(t[yt[e]])||(i.pageWidth=t[yt[e]]),sf.base.isNullOrUndefined(t[vt[e]])||(i.pageHeight=t[vt[e]]),sf.base.isNullOrUndefined(t[wt[e]])||(i.leftMargin=t[wt[e]]),sf.base.isNullOrUndefined(t[xt[e]])||(i.topMargin=t[xt[e]]),sf.base.isNullOrUndefined(t[bt[e]])||(i.rightMargin=t[bt[e]]),sf.base.isNullOrUndefined(t[It[e]])||(i.bottomMargin=t[It[e]]),sf.base.isNullOrUndefined(t[gt[e]])||(i.headerDistance=t[gt[e]]),sf.base.isNullOrUndefined(t[ft[e]])||(i.footerDistance=t[ft[e]]),sf.base.isNullOrUndefined(t[ut[e]])||(i.differentFirstPage=x.parseBoolValue(t[ut[e]])),sf.base.isNullOrUndefined(t[mt[e]])||(i.differentOddAndEvenPages=x.parseBoolValue(t[mt[e]])),sf.base.isNullOrUndefined(t[Re[e]])||(i.bidi=x.parseBoolValue(t[Re[e]])),sf.base.isNullOrUndefined(t[Ft[e]])||(i.restartPageNumbering=x.parseBoolValue(t[Ft[e]])),sf.base.isNullOrUndefined(t[Ct[e]])||(i.pageStartingNumber=t[Ct[e]]),sf.base.isNullOrUndefined(t[Wt[e]])||(i.endnoteNumberFormat=this.getFootEndNoteNumberFormat(t[Wt[e]])),sf.base.isNullOrUndefined(t[kt[e]])||(i.footNoteNumberFormat=this.getFootEndNoteNumberFormat(t[kt[e]])),sf.base.isNullOrUndefined(t[St[e]])||(i.restartIndexForFootnotes=this.getFootnoteRestartIndex(t[St[e]])),sf.base.isNullOrUndefined(t[Pt[e]])||(i.restartIndexForEndnotes=this.getFootnoteRestartIndex(t[Pt[e]])),sf.base.isNullOrUndefined(t[Nt[e]])||(i.initialFootNoteNumber=t[Nt[e]]),sf.base.isNullOrUndefined(t[Ot[e]])||(i.initialEndNoteNumber=t[Ot[e]]),sf.base.isNullOrUndefined(t[Tt[e]])||(i.pageNumberStyle=t[Tt[e]]),!sf.base.isNullOrUndefined(t[Ht[e]])&&!sf.base.isNullOrUndefined(t[Et[e]])&&t[Et[e]]>1&&(i.numberOfColumns=t[Et[e]],i.equalWidth=x.parseBoolValue(t[Rt[e]]),i.lineBetweenColumns=x.parseBoolValue(t[Ut[e]]),t[Ht[e]]))for(var r=0;r<t[Ht[e]].length;r++){var n=new c;n.width=x.convertPointToPixel(t[Ht[e]][r][wr[e]]),n.space=x.convertPointToPixel(t[Ht[e]][r][ts[e]]),n.index=r,i.columns.push(n)}sf.base.isNullOrUndefined(t[Bt[e]])||(i.breakCode=t[Bt[e]])},e.prototype.parseColumns=function(e,t){if(t=[],e)for(var i=0;i<e.length;i++){var r=new c;r.width=x.convertPointToPixel(e[i][wr[this.keywordIndex]]),r.space=x.convertPointToPixel(e[i][ts[this.keywordIndex]]),r.index=i,t.push(r)}},e.prototype.parseTabStop=function(e,t,i){if(t)for(var r=0;r<t.length;r++){var n=t[r];if(Object.keys(n).length>0){var o=new fl;o.position=n[Go[e]],o.tabLeader=this.getTabLeader(n[Xo[e]]),o.deletePosition=n[Ko[e]],o.tabJustification=this.getTabJustification(n[jo[e]]),i.push(o)}}},e.prototype.validateImageUrl=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;return e.charAt(e.length-1)===t.charAt(64)&&i--,e.charAt(e.length-2)===t.charAt(64)&&i--,i%1==0},e.prototype.containsFieldBegin=function(e){for(var t=void 0,i=e.children.length-1;i>=0;i--){if((t=e.children[i])instanceof va&&t.hasFieldEnd&&t.nextElement instanceof Fa)return t.nextElement;if(t instanceof va)return}return t},e.prototype.getBaseAlignment=function(e){switch(e){case 0:return"Normal";case 1:return"Superscript";case 2:return"Subscript";default:return e}},e.prototype.getUnderline=function(e){switch(e){case 0:return"None";case 1:return"Single";case 2:return"Words";case 3:return"Double";case 4:return"Dotted";case 5:return"Thick";case 6:return"Dash";case 7:return"DashLong";case 8:return"DotDash";case 9:return"DotDotDash";case 10:return"Wavy";case 11:return"DottedHeavy";case 12:return"DashHeavy";case 13:return"DashLongHeavy";case 14:return"DotDashHeavy";case 15:return"DotDotDashHeavy";case 16:return"WavyHeavy";case 17:return"WavyDouble";default:return e}},e.prototype.getStrikethrough=function(e){switch(e){case 0:return"None";case 1:return"SingleStrike";case 2:return"DoubleStrike";default:return e}},e.prototype.getHighlightColor=function(e){switch(e){case 0:return"NoColor";case 1:return"Yellow";case 2:return"BrightGreen";case 3:return"Turquoise";case 4:return"Pink";case 5:return"Blue";case 6:return"Red";case 7:return"DarkBlue";case 8:return"Teal";case 9:return"Green";case 10:return"Violet";case 11:return"DarkRed";case 12:return"DarkYellow";case 13:return"Gray50";case 14:return"Gray25";case 15:return"Black";default:return e}},e.prototype.getLineSpacingType=function(e){switch(e){case 0:return"Multiple";case 1:return"AtLeast";case 2:return"Exactly";default:return e}},e.prototype.getOutlineLevel=function(e){switch(e){case 0:return"BodyText";case 1:return"Level1";case 2:return"Level2";case 3:return"Level3";case 4:return"Level4";case 5:return"Level5";case 6:return"Level6";case 7:return"Level7";case 8:return"Level8";case 9:return"Level9";default:return e}},e.prototype.getTextAlignment=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Right";case 3:return"Justify";default:return e}},e.prototype.getWidthType=function(e){switch(e){case 0:return"Auto";case 1:return"Percent";case 2:return"Point";default:return e}},e.prototype.getTableAlignment=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Right";default:return e}},e.prototype.getLineStyle=function(e){switch(e){case 0:return"Single";case 1:return"None";case 2:return"Dot";case 3:return"DashSmallGap";case 4:return"DashLargeGap";case 5:return"DashDot";case 6:return"DashDotDot";case 7:return"Double";case 8:return"Triple";case 9:return"ThinThickSmallGap";case 10:return"ThickThinSmallGap";case 11:return"ThinThickThinSmallGap";case 12:return"ThinThickMediumGap";case 13:return"ThickThinMediumGap";case 14:return"ThinThickThinMediumGap";case 15:return"ThinThickLargeGap";case 16:return"ThickThinLargeGap";case 17:return"ThinThickThinLargeGap";case 18:return"SingleWavy";case 19:return"DoubleWavy";case 20:return"DashDotStroked";case 21:return"Emboss3D";case 22:return"Engrave3D";case 23:return"Outset";case 24:return"Inset";case 25:return"Thick";case 26:return"Cleared";default:return e}},e.prototype.getTextureStyle=function(e){switch(e){case 0:return"TextureNone";case 1:return"Texture2Pt5Percent";case 2:return"Texture5Percent";case 3:return"Texture7Pt5Percent";case 4:return"Texture10Percent";case 5:return"Texture12Pt5Percent";case 6:return"Texture15Percent";case 7:return"Texture17Pt5Percent";case 8:return"Texture20Percent";case 9:return"Texture22Pt5Percent";case 10:return"Texture25Percent";case 11:return"Texture27Pt5Percent";case 12:return"Texture30Percent";case 13:return"Texture32Pt5Percent";case 14:return"Texture35Percent";case 15:return"Texture37Pt5Percent";case 16:return"Texture40Percent";case 17:return"Texture42Pt5Percent";case 18:return"Texture45Percent";case 19:return"Texture47Pt5Percent";case 20:return"Texture50Percent";case 21:return"Texture52Pt5Percent";case 22:return"Texture55Percent";case 23:return"Texture57Pt5Percent";case 24:return"Texture60Percent";case 25:return"Texture62Pt5Percent";case 26:return"Texture65Percent";case 27:return"Texture67Pt5Percent";case 28:return"Texture70Percent";case 29:return"Texture72Pt5Percent";case 30:return"Texture75Percent";case 31:return"Texture77Pt5Percent";case 32:return"Texture80Percent";case 33:return"Texture82Pt5Percent";case 34:return"Texture85Percent";case 35:return"Texture87Pt5Percent";case 36:return"Texture90Percent";case 37:return"Texture92Pt5Percent";case 38:return"Texture95Percent";case 39:return"Texture97Pt5Percent";case 40:return"TextureSolid";case 41:return"TextureDarkHorizontal";case 42:return"TextureDarkVertical";case 43:return"TextureDarkDiagonalDown";case 44:return"TextureDarkDiagonalUp";case 45:return"TextureDarkCross";case 46:return"TextureDarkDiagonalCross";case 47:return"TextureHorizontal";case 48:return"TextureVertical";case 49:return"TextureDiagonalDown";case 50:return"TextureDiagonalUp";case 51:return"TextureCross";case 52:return"TextureDiagonalCross";default:return e}},e.prototype.getHeightType=function(e){switch(e){case 0:return"AtLeast";case 1:return"Exactly";default:return e}},e.prototype.getCellVerticalAlignment=function(e){switch(e){case 0:return"Top";case 1:return"Center";case 2:return"Bottom";default:return e}},e.prototype.getListLevelPattern=function(e){switch(e){case 0:return"None";case 1:case 13:case"KanjiDigit":return"Arabic";case 2:return"UpRoman";case 3:return"LowRoman";case 4:return"UpLetter";case 5:return"LowLetter";case 6:return"Ordinal";case 7:return"Number";case 8:return"OrdinalText";case 9:return"LeadingZero";case 10:return"Bullet";case 11:return"FarEast";case 12:return"Special";default:return e}},e.prototype.getFollowCharacterType=function(e){switch(e){case 0:return"Tab";case 1:return"Space";case 2:return"None";default:return e}},e.prototype.getStyleType=function(e){switch(e){case 0:return"Paragraph";case 1:return"Character";case 2:return"Table";default:return e}},e.prototype.getProtectionType=function(e){switch(e){case 0:return"NoProtection";case 1:return"ReadOnly";case 2:return"FormFieldsOnly";case 3:return"CommentsOnly";case 4:return"RevisionsOnly";default:return e}},e.prototype.getRevisionType=function(e){switch(e){case 1:return"Insertion";case 2:return"Deletion";case 3:return"MoveTo";case 4:return"MoveFrom";default:return e}},e.prototype.getFootnoteType=function(e){switch(e){case 0:return"Footnote";case 1:return"Endnote";default:return e}},e.prototype.getFootnoteRestartIndex=function(e){switch(e){case 0:return"DoNotRestart";case 1:return"RestartForEachSection";case 2:return"RestartForEachPage";default:return e}},e.prototype.getFootEndNoteNumberFormat=function(e){switch(e){case 0:return"Arabic";case 1:return"UpperCaseRoman";case 2:return"LowerCaseRoman";case 3:return"UpperCaseLetter";case 4:return"LowerCaseLetter";default:return e}},e.prototype.getBiDirectionalOverride=function(e){switch(e){case 0:return"None";case 1:return"LTR";case 2:return"RTL";default:return e}},e.prototype.getBreakClearType=function(e){switch(e){case 0:return"None";case 1:return"Left";case 2:return"Right";case 3:return"All";default:return e}},e.prototype.getTextVerticalAlignment=function(e){switch(e){case 0:return"Top";case 1:return"Center";case 2:return"Bottom";default:return e}},e.prototype.getShapeVerticalAlignment=function(e){switch(e){case 0:return"None";case 1:return"Top";case 2:return"Center";case 3:return"Bottom";case 4:return"Inline";case 5:return"Inside";case 6:return"Outside";default:return e}},e.prototype.getShapeHorizontalAlignment=function(e){switch(e){case 0:return"None";case 1:return"Center";case 2:return"Inside";case 3:return"Left";case 4:return"Outside";case 5:return"Right";default:return e}},e.prototype.getVerticalOrigin=function(e){switch(e){case 0:return"Paragraph";case 1:return"BottomMargin";case 2:return"InsideMargin";case 3:return"Line";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"TopMargin";default:return e}},e.prototype.getHorizontalOrigin=function(e){switch(e){case 0:return"Column";case 1:return"Character";case 2:return"InsideMargin";case 3:return"LeftMargin";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"RightMargin";default:return e}},e.prototype.getTableVerticalRelation=function(e){switch(e){case 0:return"Paragraph";case 1:return"Margin";case 2:return"Page";default:return e}},e.prototype.getTableHorizontalRelation=function(e){switch(e){case 0:return"Column";case 1:return"Margin";case 2:return"Page";default:return e}},e.prototype.getTableVerticalPosition=function(e){switch(e){case 0:return"None";case 1:return"Top";case 2:return"Center";case 3:return"Bottom";case 4:return"Inside";case 5:return"Outside";default:return e}},e.prototype.getTableHorizontalPosition=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Inside";case 3:return"Outside";case 4:return"Right";default:return e}},e.prototype.getLineDashStyle=function(e){switch(e){case 0:return"Solid";case 1:return"Dash";case 2:return"DashDot";case 3:return"DashDotDot";case 4:return"DashDotGEL";case 5:return"DashGEL";case 6:return"Dot";case 7:return"DotGEL";case 8:return"LongDashDotDotGEL";case 9:return"LongDashDotGEL";case 10:return"LongDashGEL";default:return e}},e.prototype.getHorizontalPositionAbs=function(e){switch(e){case 0:return"Left";case 1:return"Center";case 2:return"Right";case 3:return"Inside";case 4:return"Outside";default:return e}},e.prototype.getTabJustification=function(e){switch(e){case 0:return"Left";case 1:return"Bar";case 2:return"Center";case 3:return"Decimal";case 4:return"List";case 5:return"Right";default:return e}},e.prototype.getTabLeader=function(e){switch(e){case 0:return"None";case 1:return"Single";case 2:return"Dot";case 3:return"Hyphen";case 4:return"Underscore";default:return e}},e.prototype.getTextFormFieldType=function(e){switch(e){case 0:return"Text";case 1:return"Number";case 2:return"Date";case 3:return"Calculation";default:return e}},e.prototype.getTextFormFieldFormat=function(e){switch(e){case 0:return"None";case 1:return"FirstCapital";case 2:return"Lowercase";case 3:return"Uppercase";case 4:return"Titlecase";default:return e}},e.prototype.getCheckBoxSizeType=function(e){switch(e){case 0:return"Auto";case 1:return"Exactly";default:return e}},e.prototype.getContentControlAppearance=function(e){switch(e){case 1:return"BoundingBox";case 2:return"Hidden";case 3:return"Tags";default:return e}},e.prototype.getContentControlType=function(e){switch(e){case 0:return"RichText";case 1:return"BuildingBlockGallery";case 2:return"CheckBox";case 3:return"ComboBox";case 4:return"Date";case 5:return"DropDownList";case 6:return"Group";case 7:return"Picture";case 8:return"RepeatingSection";case 9:return"Text";default:return e}},e.prototype.getDateCalendarType=function(e){switch(e){case 0:return"Gregorian";case 1:return"GregorianArabic";case 2:return"GregorianEnglish";case 3:return"GregorianMiddleEastFrench";case 4:return"GregorianTransliteratedEnglish";case 5:return"GregorianTransliteratedFrench";case 6:return"Hebrew";case 7:return"Hijri";case 8:return"Japan";case 9:return"Korean";case 10:return"Saka";case 11:return"Taiwan";case 12:return"Thai";default:return e}},e.prototype.getDateStorageFormat=function(e){switch(e){case 1:return"DateStorageDate";case 2:return"DateStorageDateTime";case 3:return"DateStorageText";default:return e}},e.prototype.getTextWrappingStyle=function(e){switch(e){case 0:return"Inline";case 1:return"InFrontOfText";case 2:return"Square";case 3:return"TopAndBottom";case 4:return"Behind";default:return e}},e.prototype.getTextWrappingType=function(e){switch(e){case 0:return"Both";case 1:return"Left";case 2:return"Right";case 3:return"Largest";default:return e}},e.prototype.getCompatibilityMode=function(e){switch(e){case 0:return"Word2013";case 1:return"Word2003";case 2:return"Word2007";case 3:return"Word2010";default:return e}},e.prototype.getLineFormatType=function(e){switch(e){case 0:return"Solid";case 1:return"Patterned";case 2:return"Gradient";case 3:return"None";default:return e}},e.prototype.getAutoShapeType=function(e){switch(e){case 1:return"Rectangle";case 2:return"RoundedRectangle";case 3:return"StraightConnector";default:return e}},e}(),kl=function(){function e(e){this.boldIn=void 0,this.italicIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.fontSizeIn=0,this.scriptType=t.English,this.fontColorIn=void 0,this.allCapsIn=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontSizeBidi=0,this.bidi=void 0,this.bdo=void 0,this.selection=e}return Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.fontSizeIn},set:function(e){e!==this.fontSizeIn&&(this.fontSizeIn=e,this.notifyPropertyChanged("fontSize"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"renderedFontFamily",{get:function(){return this.renderedFontFamilyIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.fontFamilyIn},set:function(e){e!==this.fontFamilyIn&&(this.fontFamilyIn=this.renderedFontFamilyIn=e,this.notifyPropertyChanged("fontFamily"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.fontColorIn},set:function(e){e!==this.fontColorIn&&(this.fontColorIn=e,this.notifyPropertyChanged("fontColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{get:function(){return this.boldIn},set:function(e){e!==this.boldIn&&(this.boldIn=e,this.notifyPropertyChanged("bold"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this.italicIn},set:function(e){e!==this.italic&&(this.italicIn=e,this.notifyPropertyChanged("italic"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikethrough",{get:function(){return this.strikeThroughIn},set:function(e){e!==this.strikeThroughIn&&(this.strikeThroughIn=e,this.notifyPropertyChanged("strikethrough"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineAlignment",{get:function(){return this.baselineAlignmentIn},set:function(e){e!==this.baselineAlignmentIn&&(this.baselineAlignmentIn=e,this.notifyPropertyChanged("baselineAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this.underlineIn},set:function(e){e!==this.underlineIn&&(this.underlineIn=e,this.notifyPropertyChanged("underline"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this.highlightColorIn},set:function(e){e===this.highlightColorIn&&"NoColor"!==e||(this.highlightColorIn=e,this.notifyPropertyChanged("highlightColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allCaps",{get:function(){return this.allCapsIn},set:function(e){e!==this.allCapsIn&&(this.allCapsIn=e,this.notifyPropertyChanged("allCaps"))},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"bold":return this.bold;case"italic":return this.italic;case"fontSize":return this.fontSize>=1?this.fontSize:void 0;case"fontFamily":return this.fontFamily;case"strikethrough":return this.strikethrough;case"baselineAlignment":return this.baselineAlignment;case"highlightColor":return this.highlightColor;case"underline":return this.underline;case"fontColor":return this.fontColor;case"allCaps":return this.allCaps;default:return}},e.prototype.notifyPropertyChanged=function(e){if((sf.base.isNullOrUndefined(this.selection)||!(this.selection.isCleared||this.selection.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.selection.owner.isDocumentLoaded||this.selection.owner.isPastingContent)||this.selection.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.getPropertyValue(e);sf.base.isNullOrUndefined(t)||this.selection.owner.editorModule.onApplyCharacterFormat(e,t)}},e.prototype.copyFormat=function(e,t){this.styleName=sf.base.isNullOrUndefined(e.baseCharStyle)?"Default Paragraph Font":e.baseCharStyle.name,this.fontSize=e.fontSize,this.renderedFontFamilyIn=t,this.fontFamily=e.fontFamily,this.bold=e.bold,this.italic=e.italic,this.baselineAlignment=e.baselineAlignment,this.underline=e.underline,this.fontColor=e.fontColor,this.highlightColor=e.highlightColor,this.strikethrough=e.strikethrough,this.bidi=e.bidi,this.bdo=e.bdo,this.boldBidi=e.boldBidi,this.italicBidi=e.italicBidi,this.fontFamilyBidi=e.fontFamilyBidi,this.fontSizeBidi=e.fontSizeBidi,this.allCaps=e.allCaps},e.prototype.combineFormat=function(e,t){sf.base.isNullOrUndefined(this.bold)||this.bold===e.bold||(this.bold=void 0),sf.base.isNullOrUndefined(this.italic)||this.italic===e.italic||(this.italic=void 0),0!==this.fontSize&&this.fontSize!==e.fontSize&&(this.fontSize=0),sf.base.isNullOrUndefined(this.renderedFontFamily)||this.renderedFontFamily===t||(this.renderedFontFamilyIn=void 0),sf.base.isNullOrUndefined(this.fontFamily)||this.fontFamily===e.fontFamily||(this.fontFamily=void 0),sf.base.isNullOrUndefined(this.highlightColor)||this.highlightColor===e.highlightColor||(this.highlightColor=void 0),sf.base.isNullOrUndefined(this.baselineAlignment)||this.baselineAlignment===e.baselineAlignment||(this.baselineAlignment=void 0),sf.base.isNullOrUndefined(this.fontColor)||this.fontColor===e.fontColor||(this.fontColor=void 0),sf.base.isNullOrUndefined(this.underline)||this.underline===e.underline||(this.underline=void 0),sf.base.isNullOrUndefined(this.strikethrough)||this.strikethrough===e.strikethrough||(this.strikethrough=void 0),sf.base.isNullOrUndefined(this.boldBidi)||this.boldBidi===e.boldBidi||(this.boldBidi=void 0),sf.base.isNullOrUndefined(this.italicBidi)||this.italicBidi===e.italicBidi||(this.italicBidi=void 0),0!==this.fontSizeBidi&&this.fontSizeBidi!==e.fontSizeBidi&&(this.fontSizeBidi=0),sf.base.isNullOrUndefined(this.fontFamilyBidi)||this.fontFamilyBidi===e.fontFamilyBidi||(this.fontFamilyBidi=void 0),sf.base.isNullOrUndefined(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),sf.base.isNullOrUndefined(this.bdo)||this.bdo===e.bdo||(this.bdo=void 0),sf.base.isNullOrUndefined(this.allCaps)||this.allCaps===e.allCaps||(this.allCaps=void 0)},e.prototype.canRetrieveNextCharacterFormat=function(){return!(sf.base.isNullOrUndefined(this.bold)&&sf.base.isNullOrUndefined(this.italic)&&0===this.fontSize&&sf.base.isNullOrUndefined(this.fontFamily)&&sf.base.isNullOrUndefined(this.highlightColor)&&sf.base.isNullOrUndefined(this.baselineAlignment)&&sf.base.isNullOrUndefined(this.fontColor)&&sf.base.isNullOrUndefined(this.underline)&&sf.base.isNullOrUndefined(this.strikethrough)&&sf.base.isNullOrUndefined(this.boldBidi)&&sf.base.isNullOrUndefined(this.italicBidi)&&0===this.fontSizeBidi&&sf.base.isNullOrUndefined(this.fontFamilyBidi)&&sf.base.isNullOrUndefined(this.bdo)&&sf.base.isNullOrUndefined(this.allCaps))},e.prototype.cloneFormat=function(e){this.bold=e.bold,this.italic=e.italic,this.underline=e.underline,this.strikethrough=e.strikethrough,this.baselineAlignment=e.baselineAlignment,this.highlightColor=e.highlightColor,this.fontSize=e.fontSize,this.fontFamily=e.fontFamily,this.fontColor=e.fontColor,this.styleName=e.styleName,this.bidi=e.bidi,this.bdo=e.bdo,this.boldBidi=e.boldBidi,this.italicBidi=e.italicBidi,this.fontSizeBidi=e.fontSizeBidi,this.fontFamilyBidi=e.fontFamilyBidi,this.allCaps=e.allCaps},e.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.strikethrough===e.strikethrough&&this.bold===e.bold&&this.fontFamily===e.fontFamily&&this.underline===e.underline&&this.highlightColor===e.highlightColor&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.fontColor===e.fontColor&&this.allCaps===e.allCaps},e.prototype.clearFormat=function(){this.fontSizeIn=0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.highlightColorIn=void 0,this.baselineAlignmentIn=void 0,this.styleName=void 0,this.bidi=void 0,this.bdo=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontFamilyBidi=void 0,this.fontSizeBidi=void 0,this.allCapsIn=void 0},e.prototype.destroy=function(){this.fontSizeIn=void 0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.selection=void 0,this.styleName=void 0,this.bidi=void 0,this.bdo=void 0,this.boldBidi=void 0,this.italicBidi=void 0,this.fontFamilyBidi=void 0,this.fontSizeBidi=void 0,this.allCapsIn=void 0},e}(),Sl=function(){function e(e,t,i){this.colorIn=void 0,this.lineStyleIn=void 0,this.lineWidthIn=void 0,this.shadowIn=void 0,this.spaceIn=void 0,this.ownerBase=void 0,this.borderType=t,this.ownerBase=i,this.selection=e}return Object.defineProperty(e.prototype,"color",{get:function(){return this.colorIn},set:function(e){e!==this.colorIn&&(this.colorIn=e,this.notifyPropertyChanged("color"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return this.lineStyleIn},set:function(e){e!==this.lineStyleIn&&(this.lineStyleIn=e,this.notifyPropertyChanged("lineStyle"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this.lineWidthIn},set:function(e){e!==this.lineWidthIn&&(this.lineWidthIn=e,this.notifyPropertyChanged("lineWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadow",{get:function(){return this.shadowIn},set:function(e){e!==this.shadowIn&&(this.shadowIn=e,this.notifyPropertyChanged("shadow"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.spaceIn},set:function(e){e!==this.spaceIn&&(this.spaceIn=e,this.notifyPropertyChanged("space"))},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.color=e.color,this.lineStyle=e.lineStyle,this.lineWidth=e.lineWidth,this.shadow=e.shadow,this.space=e.space},e.prototype.combineFormat=function(e){sf.base.isNullOrUndefined(this.color)||this.color===e.color||(this.color=void 0),sf.base.isNullOrUndefined(this.lineStyle)||this.lineStyle===e.lineStyle||(this.lineStyle=void 0),sf.base.isNullOrUndefined(this.lineWidth)||this.lineWidth===e.lineWidth||(this.lineWidth=void 0),sf.base.isNullOrUndefined(this.shadow)||this.shadow===e.shadow||(this.shadow=void 0),sf.base.isNullOrUndefined(this.space)||this.space===e.space||(this.space=void 0)},e.prototype.getPropertyValue=function(e){switch(e){case"color":return this.color;case"lineStyle":return this.lineStyle;case"lineWidth":return this.lineWidth;case"space":return this.space;case"shadow":return this.shadow}},e.prototype.notifyPropertyChanged=function(e){if((sf.base.isNullOrUndefined(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.selection.owner.editorModule,i=this.getPropertyValue(e);sf.base.isNullOrUndefined(i)||t.applyParagraphBorders(e,this.borderType,i)}},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.colorIn)||(this.colorIn=void 0),sf.base.isNullOrUndefined(this.lineStyleIn)||(this.lineStyleIn=void 0),sf.base.isNullOrUndefined(this.lineWidthIn)||(this.lineWidthIn=void 0),sf.base.isNullOrUndefined(this.spaceIn)||(this.spaceIn=void 0),sf.base.isNullOrUndefined(this.shadowIn)||(this.shadowIn=void 0)},e}(),Pl=function(){function e(e,t){this.ownerBase=t,this.selection=e,this.topIn=new Sl(this.selection,"topBorder",this),this.bottomIn=new Sl(this.selection,"bottomBorder",this),this.rightIn=new Sl(this.selection,"rightBorder",this),this.leftIn=new Sl(this.selection,"leftBorder",this),this.horizontalIn=new Sl(this.selection,"horizontalBorder",this),this.verticalIn=new Sl(this.selection,"verticalBorder",this)}return Object.defineProperty(e.prototype,"top",{get:function(){return this.topIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.bottomIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.leftIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.rightIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontal",{get:function(){return this.horizontalIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertical",{get:function(){return this.verticalIn},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.top.copyFormat(e.top),this.bottom.copyFormat(e.bottom),this.left.copyFormat(e.left),this.right.copyFormat(e.right),this.horizontal.copyFormat(e.horizontal),this.vertical.copyFormat(e.vertical)},e.prototype.combineFormat=function(e){this.top.combineFormat(e.top),this.bottom.combineFormat(e.bottom),this.left.combineFormat(e.left),this.right.combineFormat(e.right),this.vertical.combineFormat(e.vertical),this.horizontal.combineFormat(e.horizontal)},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.topIn)||(this.topIn.destroy(),this.topIn=void 0),sf.base.isNullOrUndefined(this.topIn)||(this.bottomIn.destroy(),this.bottomIn=void 0),sf.base.isNullOrUndefined(this.leftIn)||(this.leftIn.destroy(),this.leftIn=void 0),sf.base.isNullOrUndefined(this.rightIn)||(this.rightIn.destroy(),this.rightIn=void 0),sf.base.isNullOrUndefined(this.horizontalIn)||(this.horizontalIn.destroy(),this.horizontalIn=void 0),sf.base.isNullOrUndefined(this.verticalIn)||(this.verticalIn.destroy(),this.verticalIn=void 0)},e}(),Nl=function(){function e(e,t){this.leftIndentIn=0,this.rightIndentIn=0,this.beforeSpacingIn=0,this.afterSpacingIn=0,this.spaceAfterAutoIn=void 0,this.spaceBeforeAutoIn=void 0,this.textAlignmentIn=void 0,this.outlineLevelIn=void 0,this.firstLineIndentIn=0,this.lineSpacingIn=1,this.lineSpacingTypeIn=void 0,this.bidiIn=void 0,this.keepWithNextIn=void 0,this.keepLinesTogetherIn=void 0,this.widowControlIn=void 0,this.contextualSpacingIn=void 0,this.listLevelNumberIn=-1,this.selection=e,this.documentHelper=t,this.bordersIn=new Pl(this.selection,this)}return Object.defineProperty(e.prototype,"borders",{get:function(){return this.bordersIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightIndent",{get:function(){return this.rightIndentIn},set:function(e){e!==this.rightIndentIn&&(this.rightIndentIn=e,this.notifyPropertyChanged("rightIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstLineIndent",{get:function(){return this.firstLineIndentIn},set:function(e){e!==this.firstLineIndentIn&&(this.firstLineIndentIn=e,this.notifyPropertyChanged("firstLineIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlignment",{get:function(){return this.textAlignmentIn},set:function(e){e!==this.textAlignmentIn&&(this.textAlignmentIn=e,this.notifyPropertyChanged("textAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineLevel",{get:function(){return this.outlineLevelIn},set:function(e){e!==this.outlineLevelIn&&(this.outlineLevelIn=e,this.notifyPropertyChanged("outlineLevel"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"afterSpacing",{get:function(){return this.afterSpacingIn},set:function(e){e!==this.afterSpacingIn&&(this.afterSpacingIn=e,this.notifyPropertyChanged("afterSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beforeSpacing",{get:function(){return this.beforeSpacingIn},set:function(e){e!==this.beforeSpacingIn&&(this.beforeSpacingIn=e,this.notifyPropertyChanged("beforeSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceAfterAuto",{get:function(){return this.spaceAfterAutoIn},set:function(e){e!==this.spaceAfterAutoIn&&(this.spaceAfterAutoIn=e,this.notifyPropertyChanged("spaceAfterAuto"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spaceBeforeAuto",{get:function(){return this.spaceBeforeAutoIn},set:function(e){e!==this.spaceBeforeAutoIn&&(this.spaceBeforeAutoIn=e,this.notifyPropertyChanged("spaceBeforeAuto"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this.lineSpacingIn},set:function(e){e!==this.lineSpacingIn&&(this.lineSpacingIn=e,this.notifyPropertyChanged("lineSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacingType",{get:function(){return this.lineSpacingTypeIn},set:function(e){e!==this.lineSpacingTypeIn&&(this.lineSpacingTypeIn=e,this.notifyPropertyChanged("lineSpacingType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelNumber",{get:function(){return this.listLevelNumberIn},set:function(e){e!==this.listLevelNumberIn&&(this.listLevelNumberIn=e,this.notifyPropertyChanged("listLevelNumber"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.bidiIn},set:function(e){this.bidiIn=e,this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepWithNext",{get:function(){return this.keepWithNextIn},set:function(e){this.keepWithNextIn=e,this.notifyPropertyChanged("keepWithNext")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keepLinesTogether",{get:function(){return this.keepLinesTogetherIn},set:function(e){this.keepLinesTogetherIn=e,this.notifyPropertyChanged("keepLinesTogether")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"widowControl",{get:function(){return this.widowControlIn},set:function(e){this.widowControlIn=e,this.notifyPropertyChanged("widowControl")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextualSpacing",{get:function(){return this.contextualSpacingIn},set:function(e){this.contextualSpacingIn=e,this.notifyPropertyChanged("contextualSpacing")},enumerable:!0,configurable:!0}),e.prototype.validateLineSpacing=function(){return"Multiple"!==this.lineSpacingType&&this.lineSpacingIn<12},Object.defineProperty(e.prototype,"listText",{get:function(){var e=void 0,t=this.documentHelper.getListById(this.listId);if(t instanceof u&&this.listLevelNumberIn>-1&&this.listLevelNumberIn<9){var i=t.getListLevel(this.listLevelNumber);if(i instanceof H)if("Bullet"===i.listLevelPattern)e=i.numberFormat;else{e=i.numberFormat;for(var r=0;r<9;r++){var n="%"+(r+1);if(e.indexOf(n)>-1){r===this.listLevelNumberIn||t.getListLevel(r);var o=this.selection.getListTextElementBox(this.selection.start.paragraph);e=o?o.text:""}}}}return e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"leftIndent":return this.leftIndent;case"rightIndent":return this.rightIndent;case"firstLineIndent":return this.firstLineIndent;case"beforeSpacing":return this.beforeSpacing;case"afterSpacing":return this.afterSpacing;case"spaceAfterAuto":return this.spaceAfterAuto;case"spaceBeforeAuto":return this.spaceBeforeAuto;case"textAlignment":return this.textAlignment;case"lineSpacing":return this.lineSpacing;case"lineSpacingType":return this.lineSpacingType;case"bidi":return this.bidi;case"keepWithNext":return this.keepWithNext;case"keepLinesTogether":return this.keepLinesTogether;case"widowControl":return this.widowControl;case"contextualSpacing":return this.contextualSpacing;case"outlineLevel":return this.outlineLevel;default:return}},e.prototype.notifyPropertyChanged=function(e){if((sf.base.isNullOrUndefined(this.selection)||(!this.selection.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.selection.owner.editorModule;if("lineSpacing"===e||"lineSpacingType"===e){var i=this.selection.owner.editorHistory;if((!i||!i.isUndoing&&!i.isRedoing)&&this.validateLineSpacing()){if(this.selection.owner.editorHistory.initComplexHistory(this.selection,"LineSpacing"),"lineSpacing"===e){this.lineSpacingTypeIn="Multiple";var r=this.getPropertyValue("lineSpacingType");t.onApplyParagraphFormat("lineSpacingType",r,!1,!1),t.onApplyParagraphFormat(e,this.getPropertyValue(e),!1,!1)}else t.onApplyParagraphFormat(e,this.getPropertyValue(e),!1,!1),this.lineSpacingIn=12,t.onApplyParagraphFormat("lineSpacing",this.getPropertyValue("lineSpacing"),!1,!1);return void this.selection.owner.editorHistory.updateComplexHistory()}}var n=this.getPropertyValue(e);if(!("leftIndent"!==e&&"rightIndent"!==e&&"firstLineIndent"!==e||n>=-1056&&n<1056))return;"listLevelNumber"===e?t.onApplyListInternal(this.documentHelper.getListById(this.listId),this.listLevelNumber):t.onApplyParagraphFormat(e,n,"textAlignment"===e,!1)}},e.prototype.copyFormat=function(e){this.styleName=sf.base.isNullOrUndefined(e.baseStyle)?"Normal":e.baseStyle.name,this.leftIndent=e.leftIndent,this.rightIndent=e.rightIndent,this.firstLineIndent=e.firstLineIndent,this.afterSpacing=e.afterSpacing,this.beforeSpacing=e.beforeSpacing,this.spaceAfterAuto=e.spaceAfterAuto,this.spaceBeforeAuto=e.spaceBeforeAuto,this.lineSpacing=e.lineSpacing,this.lineSpacingType=e.lineSpacingType,this.textAlignment=e.textAlignment,this.outlineLevel=e.outlineLevel,this.bidi=e.bidi,this.keepLinesTogether=e.keepLinesTogether,this.keepWithNext=e.keepWithNext,this.widowControl=e.widowControl,this.contextualSpacing=e.contextualSpacing,this.borders.copyFormat(e.borders),sf.base.isNullOrUndefined(e.listFormat)||sf.base.isNullOrUndefined(e.listFormat.listId)?(this.listId=void 0,this.listLevelNumber=0):(this.listId=e.listFormat.listId,this.listLevelNumber=e.listFormat.listLevelNumber)},e.prototype.copyToFormat=function(e){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(this.afterSpacing)||(e.afterSpacing=this.afterSpacing),sf.base.isNullOrUndefined(this.beforeSpacing)||(e.beforeSpacing=this.beforeSpacing),sf.base.isNullOrUndefined(this.spaceAfterAuto)||(e.spaceAfterAuto=this.spaceAfterAuto),sf.base.isNullOrUndefined(this.spaceBeforeAuto)||(e.spaceBeforeAuto=this.spaceBeforeAuto),sf.base.isNullOrUndefined(this.leftIndent)||(e.leftIndent=this.leftIndent),sf.base.isNullOrUndefined(this.rightIndent)||(e.rightIndent=this.rightIndent),sf.base.isNullOrUndefined(this.textAlignment)||(e.textAlignment=this.textAlignment),sf.base.isNullOrUndefined(this.outlineLevel)||(e.outlineLevel=this.outlineLevel),sf.base.isNullOrUndefined(this.lineSpacing)||(e.lineSpacing=this.lineSpacing),sf.base.isNullOrUndefined(this.lineSpacingType)||(e.lineSpacingType=this.lineSpacingType),sf.base.isNullOrUndefined(this.firstLineIndent)||(e.firstLineIndent=this.firstLineIndent),sf.base.isNullOrUndefined(this.bidi)||(e.bidi=this.bidi),sf.base.isNullOrUndefined(this.keepLinesTogether)||(e.keepLinesTogether=this.keepLinesTogether),sf.base.isNullOrUndefined(this.keepWithNext)||(e.keepWithNext=this.keepWithNext),sf.base.isNullOrUndefined(this.widowControl)||(e.widowControl=this.widowControl),sf.base.isNullOrUndefined(this.contextualSpacing)||(e.contextualSpacing=this.contextualSpacing))},e.prototype.combineFormat=function(e){sf.base.isNullOrUndefined(this.leftIndent)||this.leftIndent===e.leftIndent||(this.leftIndent=void 0),sf.base.isNullOrUndefined(this.rightIndent)||this.rightIndent===e.rightIndent||(this.rightIndent=void 0),sf.base.isNullOrUndefined(this.firstLineIndent)||this.firstLineIndent===e.firstLineIndent||(this.firstLineIndent=void 0),0!==this.lineSpacing&&this.lineSpacing!==e.lineSpacing&&(this.lineSpacing=0),-1!==this.beforeSpacing&&this.beforeSpacing!==e.beforeSpacing&&(this.beforeSpacing=-1),-1!==this.afterSpacing&&this.afterSpacing!==e.afterSpacing&&(this.afterSpacing=-1),sf.base.isNullOrUndefined(this.spaceAfterAuto)||this.spaceAfterAuto===e.spaceAfterAuto||(this.spaceAfterAuto=void 0),sf.base.isNullOrUndefined(this.spaceBeforeAuto)||this.spaceBeforeAuto===e.spaceBeforeAuto||(this.spaceBeforeAuto=void 0),sf.base.isNullOrUndefined(this.lineSpacingType)||this.lineSpacingType===e.lineSpacingType||(this.lineSpacingType=void 0),sf.base.isNullOrUndefined(this.textAlignment)||this.textAlignment===e.textAlignment||(this.textAlignment=void 0),sf.base.isNullOrUndefined(this.outlineLevel)||this.outlineLevel===e.outlineLevel||(this.outlineLevel=void 0),this.listLevelNumber>=0&&!sf.base.isNullOrUndefined(this.listId)&&(sf.base.isNullOrUndefined(e.listFormat)||e.listFormat.listLevelNumber!==this.listLevelNumber)&&(this.listLevelNumber=-1),(sf.base.isNullOrUndefined(e.listFormat)||sf.base.isNullOrUndefined(e.listFormat.listId)||!sf.base.isNullOrUndefined(this.listId)&&this.listId!==e.listFormat.listId)&&(this.listId=void 0),sf.base.isNullOrUndefined(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),sf.base.isNullOrUndefined(this.keepLinesTogether)||this.keepLinesTogether===e.keepLinesTogether||(this.keepLinesTogether=void 0),sf.base.isNullOrUndefined(this.keepWithNext)||this.keepWithNext===e.keepWithNext||(this.keepWithNext=void 0),sf.base.isNullOrUndefined(this.widowControl)||this.widowControl===e.widowControl||(this.widowControl=void 0),sf.base.isNullOrUndefined(this.contextualSpacing)||this.contextualSpacing===e.contextualSpacing||(this.contextualSpacing=void 0),!sf.base.isNullOrUndefined(this.styleName)&&e.baseStyle&&this.styleName!==e.baseStyle.name&&(this.styleName=void 0),this.borders.combineFormat(e.borders)},e.prototype.clearFormat=function(){this.leftIndent=0,this.rightIndent=0,this.beforeSpacing=0,this.afterSpacing=0,this.spaceAfterAuto=void 0,this.spaceBeforeAuto=void 0,this.firstLineIndent=0,this.lineSpacing=1,this.textAlignment=void 0,this.lineSpacingType=void 0,this.listId=void 0,this.listLevelNumber=-1,this.styleName=void 0,this.bidi=void 0,this.contextualSpacing=void 0},e.prototype.getList=function(){var e=this.documentHelper.getListById(this.listId);if(!sf.base.isNullOrUndefined(e)){var t=new u,i=new W,r=this.documentHelper.getAbstractListById(e.abstractListId),n=this.selection.owner.editorModule;if(sf.base.isNullOrUndefined(r))i.levels.push(new H(i));else for(var o=0;o<r.levels.length;o++){var s=n.cloneListLevel(r.levels[o]);i.levels.push(s),s.ownerBase=i}if(!sf.base.isNullOrUndefined(e.levelOverrides))for(o=0;o<e.levelOverrides.length;o++){var a=n.cloneLevelOverride(e.levelOverrides[o]);t.levelOverrides.push(a)}return t.abstractList=i,t.abstractListId=i.abstractListId,t.sourceListId=e.listId,t}},e.prototype.setList=function(e){if((!this.documentHelper.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())&&this.documentHelper.owner.isDocumentLoaded){var t=this.documentHelper.getListById(this.listId),i=void 0,r=e?this.documentHelper.getAbstractListById(e.abstractListId):void 0;if(sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(r)||e.sourceListId!==t.listId)sf.base.isNullOrUndefined(e)?this.selection.owner.editorModule.onApplyList(void 0):(this.selection.owner.isLayoutEnabled=!1,sf.base.isNullOrUndefined(r)||-1!==this.documentHelper.abstractLists.indexOf(r)||this.documentHelper.abstractLists.push(r),-1===this.documentHelper.lists.indexOf(e)&&this.documentHelper.lists.push(e),this.selection.owner.isLayoutEnabled=!0,this.selection.owner.editorModule.onApplyList(e));else{var n=this.documentHelper.owner.editorHistory;this.documentHelper.layout.getListLevel(t,1);this.selection.owner.isLayoutEnabled=!1,this.documentHelper.owner.editorModule.setOffsetValue(this.selection),n&&(i=n.updateListChangesInHistory(r,t)),this.documentHelper.owner.editorModule.updateListParagraphs(),n&&n.applyListChanges(this.selection,i),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.owner.editorModule.layoutWholeDocument(),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!1),n&&n.currentBaseHistoryInfo&&(n.currentBaseHistoryInfo.modifiedProperties.length>0&&n.currentBaseHistoryInfo.updateSelection(),n.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange()}}},e.prototype.destroy=function(){this.leftIndentIn=void 0,this.rightIndentIn=void 0,this.beforeSpacingIn=void 0,this.afterSpacingIn=void 0,this.spaceBeforeAutoIn=void 0,this.spaceAfterAutoIn=void 0,this.firstLineIndentIn=void 0,this.lineSpacingIn=void 0,this.textAlignmentIn=void 0,this.lineSpacingTypeIn=void 0,this.listId=void 0,this.listLevelNumberIn=void 0,this.documentHelper=void 0,this.selection=void 0,this.styleName=void 0,this.bidi=void 0,this.contextualSpacing=void 0,sf.base.isNullOrUndefined(this.bordersIn)||(this.bordersIn.destroy(),this.bordersIn=void 0)},e}(),Ol=function(){function e(e){this.linkToPreviousIn=!0,this.selection=e}return Object.defineProperty(e.prototype,"linkToPrevious",{get:function(){return this.linkToPreviousIn},set:function(e){this.linkToPreviousIn=e,this.notifyPropertyChanged("linkToPrevious")},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if((sf.base.isNullOrUndefined(t)||!(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode)&&t.owner.isDocumentLoaded||t.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.start)&&!t.isRetrieveFormatting){var i=this.getPropertyvalue(e);if(!sf.base.isNullOrUndefined(i)){var r=t.start.paragraph.containerWidget,n=r.sectionIndex,o=r.headerFooterType;t.owner.editorModule.removeInlineHeaderFooterWidget(n,o,e,i)}}},e.prototype.getPropertyvalue=function(e){if("linkToPrevious"==e&&!sf.base.isNullOrUndefined(this.linkToPrevious))return this.linkToPrevious},e}(),Tl=function(){function e(e){this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.bidi=void 0,this.selection=e,this.firstPageHeaderIn=new Ol(e),this.firstPageFooterIn=new Ol(e),this.oddPageHeaderIn=new Ol(e),this.oddPageFooterIn=new Ol(e),this.evenPageHeaderIn=new Ol(e),this.evenPageFooterIn=new Ol(e)}return Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.pageHeightIn},set:function(e){this.pageHeightIn=e,this.notifyPropertyChanged("pageHeight")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.pageWidthIn},set:function(e){this.pageWidthIn=e,this.notifyPropertyChanged("pageWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){this.topMarginIn=e,this.notifyPropertyChanged("topMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerDistance",{get:function(){return this.headerDistanceIn},set:function(e){this.headerDistanceIn=e,this.notifyPropertyChanged("headerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPageHeader",{get:function(){return this.firstPageHeaderIn},set:function(e){this.firstPageHeaderIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstPageFooter",{get:function(){return this.firstPageFooterIn},set:function(e){this.firstPageFooterIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oddPageHeader",{get:function(){return this.oddPageHeaderIn},set:function(e){this.oddPageHeaderIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"oddPageFooter",{get:function(){return this.oddPageFooterIn},set:function(e){this.oddPageFooterIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evenPageHeader",{get:function(){return this.evenPageHeaderIn},set:function(e){this.evenPageHeaderIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"evenPageFooter",{get:function(){return this.evenPageFooterIn},set:function(e){this.evenPageFooterIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageStartingNumber",{get:function(){return this.pageStartingNumberIn},set:function(e){this.pageStartingNumberIn=e,this.notifyPropertyChanged("pageStartingNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartPageNumbering",{get:function(){return this.restartPageNumberingIn},set:function(e){this.restartPageNumberingIn=e,this.notifyPropertyChanged("restartPageNumbering")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerDistance",{get:function(){return this.footerDistanceIn},set:function(e){this.footerDistanceIn=e,this.notifyPropertyChanged("footerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentFirstPage",{get:function(){return this.differentFirstPageIn},set:function(e){this.differentFirstPageIn=e,this.notifyPropertyChanged("differentFirstPage")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentOddAndEvenPages",{get:function(){return this.differentOddAndEvenPagesIn},set:function(e){this.differentOddAndEvenPagesIn=e,this.notifyPropertyChanged("differentOddAndEvenPages")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endnoteNumberFormat",{get:function(){return this.endnoteNumberFormatIn},set:function(e){this.endnoteNumberFormatIn=e,this.notifyPropertyChanged("endnoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footNoteNumberFormat",{get:function(){return this.footNoteNumberFormatIn},set:function(e){this.footNoteNumberFormatIn=e,this.notifyPropertyChanged("footNoteNumberFormat")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialFootNoteNumber",{get:function(){return this.initialFootNoteNumberIn},set:function(e){this.initialFootNoteNumberIn=e,this.notifyPropertyChanged("initialFootNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initialEndNoteNumber",{get:function(){return this.initialEndNoteNumberIn},set:function(e){this.initialEndNoteNumberIn=e,this.notifyPropertyChanged("initialEndNoteNumber")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForFootnotes",{get:function(){return this.restartIndexForFootnotesIn},set:function(e){this.restartIndexForFootnotesIn=e,this.notifyPropertyChanged("restartIndexForFootnotes")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartIndexForEndnotes",{get:function(){return this.restartIndexForEndnotesIn},set:function(e){this.restartIndexForEndnotesIn=e,this.notifyPropertyChanged("restartIndexForEndnotes")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberOfColumns",{get:function(){return 0==this.columns.length?1:this.columns.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"equalWidth",{get:function(){return this.equalWidthIn},set:function(e){this.equalWidthIn=e,this.notifyPropertyChanged("equalWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineBetweenColumns",{get:function(){return this.lineBetweenColumnsIn},set:function(e){this.lineBetweenColumnsIn=e,this.notifyPropertyChanged("lineBetweenColumns")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this.columnsIn},set:function(e){this.columnsIn=e;var t=this.selection;(sf.base.isNullOrUndefined(t)||!(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode)&&t.owner.isDocumentLoaded||t.isRetrieveFormatting)&&(sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.start)||t.isRetrieveFormatting||this.selection.owner.editorModule.onApplyColumnFormat("columns",e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"breakCode",{get:function(){return this.breakCodeIn},set:function(e){this.breakCodeIn=e,this.notifyPropertyChanged("breakCode")},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.pageHeight=e.pageHeight,this.pageWidth=e.pageWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.headerDistance=e.headerDistance,this.footerDistance=e.footerDistance,this.differentFirstPage=e.differentFirstPage,this.differentOddAndEvenPages=e.differentOddAndEvenPages,this.bidi=e.bidi,this.pageStartingNumber=e.pageStartingNumber,this.restartPageNumbering=e.restartPageNumbering,this.endnoteNumberFormat=e.endnoteNumberFormat,this.footNoteNumberFormat=e.footNoteNumberFormat,this.restartIndexForEndnotes=e.restartIndexForEndnotes,this.restartIndexForFootnotes=e.restartIndexForFootnotes,this.initialEndNoteNumber=e.initialEndNoteNumber,this.initialFootNoteNumber=e.initialFootNoteNumber,this.equalWidth=e.equalWidth,this.lineBetweenColumns=e.lineBetweenColumns,this.columns=[];for(var t=0,i=e.columns;t<i.length;t++){var r=i[t],n=new Bl(this.selection);n.width=x.convertPixelToPoint(r.width),n.space=x.convertPixelToPoint(r.space),this.columns.push(n)}if(this.breakCode=e.breakCode,this.selection.owner.enableHeaderAndFooter){var o=this.selection.documentHelper.headersFooters,s=this.selection.start.paragraph.containerWidget,a=s.sectionIndex,l=s.headerFooterType,d=!1;if(0==a)this.oddPageHeader.linkToPrevious=!1,this.oddPageFooter.linkToPrevious=!1,this.evenPageHeader.linkToPrevious=!1,this.evenPageFooter.linkToPrevious=!1,this.firstPageHeader.linkToPrevious=!1,this.firstPageFooter.linkToPrevious=!1;else if(o[a]){var h=this.selection.viewer.getHeaderFooter(l),c=o[a][h];if(sf.base.isNullOrUndefined(c)&&(d=!0),!sf.base.isNullOrUndefined(c)||d)switch(l){case"OddHeader":this.oddPageHeader.linkToPrevious=!!d;break;case"OddFooter":this.oddPageFooter.linkToPrevious=!!d;break;case"EvenHeader":this.evenPageHeader.linkToPrevious=!!d;break;case"EvenFooter":this.evenPageFooter.linkToPrevious=!!d;break;case"FirstPageHeader":this.firstPageHeader.linkToPrevious=!!d;break;case"FirstPageFooter":this.firstPageFooter.linkToPrevious=!!d}}}},e.prototype.applyColumnFormat=function(){},e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if((sf.base.isNullOrUndefined(t)||!(t.isCleared||t.owner.isPastingContent||t.owner.isReadOnlyMode)&&t.owner.isDocumentLoaded||t.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.start)&&!t.isRetrieveFormatting){var i=this.getPropertyvalue(e);sf.base.isNullOrUndefined(i)||t.owner.editorModule.onApplySectionFormat(e,i)}},e.prototype.getPropertyvalue=function(e){switch(e){case"pageHeight":return this.pageHeight>0?this.pageHeight:void 0;case"pageWidth":return this.pageWidth>0?this.pageWidth:void 0;case"leftMargin":return this.leftMargin>=0?this.leftMargin:void 0;case"rightMargin":return this.rightMargin>=0?this.rightMargin:void 0;case"topMargin":return this.topMargin>=0?this.topMargin:void 0;case"bottomMargin":return this.bottomMargin>=0?this.bottomMargin:void 0;case"differentFirstPage":return sf.base.isNullOrUndefined(this.differentFirstPage)?void 0:this.differentFirstPage;case"differentOddAndEvenPages":return sf.base.isNullOrUndefined(this.differentOddAndEvenPages)?void 0:this.differentOddAndEvenPages;case"headerDistance":return this.headerDistanceIn;case"footerDistance":return this.footerDistance;case"pageStartingNumber":return sf.base.isNullOrUndefined(this.pageStartingNumber)?void 0:this.pageStartingNumber;case"restartPageNumbering":return sf.base.isNullOrUndefined(this.restartPageNumbering)?void 0:this.restartPageNumbering;case"endnoteNumberFormat":return this.endnoteNumberFormatIn;case"restartIndexForEndnotes":return this.restartIndexForEndnotesIn;case"restartIndexForFootnotes":return this.restartIndexForFootnotesIn;case"footNoteNumberFormat":return this.footNoteNumberFormatIn;case"initialFootNoteNumber":return this.initialFootNoteNumber;case"initialEndNoteNumber":return this.initialEndNoteNumber;case"equalWidth":return this.equalWidthIn;case"lineBetweenColumns":return this.lineBetweenColumnsIn;case"columns":return this.columnsIn;case"breakCode":return this.breakCodeIn;default:return}},e.prototype.combineFormat=function(e){this.pageHeight>0&&this.pageHeight!==e.pageHeight&&(this.pageHeight=0),this.pageWidth>0&&this.pageWidth!==e.pageWidth&&(this.pageWidth=0),this.leftMargin>-1&&this.leftMargin!==e.leftMargin&&(this.leftMargin=-1),this.topMargin>-1&&this.topMargin!==e.topMargin&&(this.topMargin=-1),this.rightMargin>-1&&this.rightMargin!==e.rightMargin&&(this.rightMargin=-1),this.bottomMargin>-1&&this.bottomMargin!==e.bottomMargin&&(this.bottomMargin=-1),0!==this.headerDistance&&this.headerDistance!==e.headerDistance&&(this.headerDistance=0),0!==this.footerDistance&&this.footerDistance!==e.footerDistance&&(this.footerDistance=0),sf.base.isNullOrUndefined(this.differentFirstPage)||this.differentFirstPage===e.differentFirstPage||(this.differentFirstPage=void 0),sf.base.isNullOrUndefined(this.pageStartingNumber)||this.pageStartingNumber===e.pageStartingNumber||(this.pageStartingNumber=void 0),sf.base.isNullOrUndefined(this.restartPageNumbering)||this.restartPageNumbering===e.restartPageNumbering||(this.restartPageNumbering=void 0),sf.base.isNullOrUndefined(this.differentOddAndEvenPages)||this.differentOddAndEvenPages===e.differentOddAndEvenPages||(this.differentOddAndEvenPages=void 0),sf.base.isNullOrUndefined(this.bidi)||this.bidi===e.bidi||(this.bidi=void 0),sf.base.isNullOrUndefined(this.endnoteNumberFormat)||this.endnoteNumberFormat===e.endnoteNumberFormat||(this.endnoteNumberFormat=void 0),sf.base.isNullOrUndefined(this.restartIndexForEndnotes)||this.restartIndexForEndnotes===e.restartIndexForEndnotes||(this.restartIndexForEndnotes=void 0),sf.base.isNullOrUndefined(this.restartIndexForFootnotes)||this.restartIndexForFootnotes===e.restartIndexForFootnotes||(this.restartIndexForFootnotes=void 0),sf.base.isNullOrUndefined(this.footNoteNumberFormat)||this.footNoteNumberFormat===e.footNoteNumberFormat||(this.footNoteNumberFormat=void 0),sf.base.isNullOrUndefined(this.initialFootNoteNumber)||this.initialFootNoteNumber===e.initialFootNoteNumber||(this.initialFootNoteNumber=void 0),sf.base.isNullOrUndefined(this.initialEndNoteNumber)||this.initialEndNoteNumber===e.initialEndNoteNumber||(this.initialEndNoteNumber=void 0)},e.prototype.clearFormat=function(){this.headerDistance=0,this.footerDistance=0,this.pageHeight=0,this.pageWidth=0,this.leftMargin=-1,this.rightMargin=-1,this.topMargin=-1,this.bottomMargin=-1,this.differentFirstPage=void 0,this.differentOddAndEvenPages=void 0,this.bidi=void 0,this.pageStartingNumber=void 0,this.restartPageNumbering=void 0,this.endnoteNumberFormat=void 0,this.footNoteNumberFormat=void 0,this.restartIndexForFootnotes=void 0,this.restartIndexForEndnotes=void 0,this.initialFootNoteNumber=1,this.initialEndNoteNumber=1},e.prototype.destroy=function(){this.headerDistanceIn=void 0,this.footerDistanceIn=void 0,this.pageHeightIn=void 0,this.pageWidthIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.selection=void 0,this.bidi=void 0,this.pageStartingNumberIn=void 0,this.restartPageNumberingIn=void 0,this.endnoteNumberFormatIn=void 0,this.footNoteNumberFormatIn=void 0,this.restartIndexForFootnotesIn=void 0,this.restartIndexForEndnotesIn=void 0,this.initialEndNoteNumber=void 0,this.initialFootNoteNumber=void 0},e}(),Hl=function(){function e(e){this.leftIndentIn=0,this.backgroundIn=void 0,this.tableAlignmentIn=void 0,this.cellSpacingIn=0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.preferredWidthIn=0,this.bidiIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"table",{get:function(){return this.tableIn},set:function(e){this.tableIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this.titleIn},set:function(e){sf.base.isNullOrUndefined(this.table)||(this.titleIn=e,this.notifyPropertyChanged("title"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this.descriptionIn},set:function(e){sf.base.isNullOrUndefined(this.table)||(this.descriptionIn=e,this.notifyPropertyChanged("description"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableAlignment",{get:function(){return this.tableAlignmentIn},set:function(e){e!==this.tableAlignmentIn&&(this.tableAlignmentIn=e,this.notifyPropertyChanged("tableAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellSpacing",{get:function(){return this.cellSpacingIn},set:function(e){e!==this.cellSpacingIn&&(this.cellSpacingIn=e,this.notifyPropertyChanged("cellSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bidi",{get:function(){return this.bidiIn},set:function(e){this.bidiIn=e,this.notifyPropertyChanged("bidi")},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"tableAlignment":return this.tableAlignment;case"leftIndent":return this.leftIndent;case"cellSpacing":return this.cellSpacing;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"background":var t=new Il;return t.backgroundColor=this.background,t;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"bidi":return this.bidi;case"title":return this.title;case"description":return this.description;default:return}},e.prototype.notifyPropertyChanged=function(e){if((sf.base.isNullOrUndefined(this.selection)||!this.selection.isCleared&&this.selection.owner.isDocumentLoaded&&!this.selection.owner.isReadOnlyMode&&!this.selection.owner.isPastingContent||this.selection.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var t=this.getPropertyValue(e);"background"===e&&(e="shading"),sf.base.isNullOrUndefined(t)||this.selection.owner.editorModule.onApplyTableFormat(e,t)}},e.prototype.copyFormat=function(e){this.leftIndent=e.leftIndent,this.background=e.shading.backgroundColor,this.tableAlignment=e.tableAlignment,this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.cellSpacing=e.cellSpacing,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType,this.bidi=e.bidi,this.title=e.title,this.description=e.description},e.prototype.clearFormat=function(){this.table=void 0,this.leftIndent=0,this.background=void 0,this.leftIndent=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.bottomMargin=0,this.cellSpacing=0,this.tableAlignment=void 0,this.bidi=void 0},e.prototype.destroy=function(){this.leftIndentIn=void 0,this.backgroundIn=void 0,this.leftIndentIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.cellSpacingIn=void 0,this.tableAlignmentIn=void 0,this.tableIn=void 0,this.selection=void 0,this.bidi=void 0},e}(),El=function(){function e(e){this.verticalAlignmentIn=void 0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.backgroundIn=void 0,this.preferredWidthTypeIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this.verticalAlignmentIn},set:function(e){e!==this.verticalAlignmentIn&&(this.verticalAlignmentIn=e,this.notifyPropertyChanged("verticalAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if(!sf.base.isNullOrUndefined(t)){if((t.isCleared||!t.owner.isDocumentLoaded||t.owner.isReadOnlyMode||t.owner.isPastingContent)&&!t.isRetrieveFormatting)return;if(!sf.base.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var i=this.getPropertyValue(e);"background"===e&&(e="shading"),sf.base.isNullOrUndefined(i)||this.selection.owner.editorModule.onApplyTableCellFormat(e,i)}}},e.prototype.getPropertyValue=function(e){switch(e){case"verticalAlignment":return this.verticalAlignment;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"background":var t=new Il;return t.backgroundColor=this.background,t;default:return}},e.prototype.copyFormat=function(e){this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.background=e.shading.backgroundColor,this.verticalAlignment=e.verticalAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType},e.prototype.clearCellFormat=function(){this.leftMargin=void 0,this.rightMargin=void 0,this.topMargin=void 0,this.bottomMargin=void 0,this.background=void 0,this.verticalAlignment=void 0},e.prototype.combineFormat=function(e){sf.base.isNullOrUndefined(this.leftMargin)||this.leftMargin===e.leftMargin||(this.leftMargin=void 0),sf.base.isNullOrUndefined(this.topMargin)||this.topMargin===e.topMargin||(this.topMargin=void 0),sf.base.isNullOrUndefined(this.rightMargin)||this.rightMargin===e.rightMargin||(this.rightMargin=void 0),sf.base.isNullOrUndefined(this.bottomMargin)||this.bottomMargin===e.bottomMargin||(this.bottomMargin=void 0),sf.base.isNullOrUndefined(this.background)||this.background===e.shading.backgroundColor||(this.background=void 0),sf.base.isNullOrUndefined(this.verticalAlignment)||this.verticalAlignment===e.verticalAlignment||(this.verticalAlignment=void 0),sf.base.isNullOrUndefined(this.preferredWidth)||this.preferredWidth===e.preferredWidth||(this.preferredWidth=void 0),sf.base.isNullOrUndefined(this.preferredWidthType)||this.preferredWidthType===e.preferredWidthType||(this.preferredWidthType=void 0)},e.prototype.clearFormat=function(){this.background=void 0,this.bottomMargin=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.verticalAlignment=void 0},e.prototype.destroy=function(){this.backgroundIn=void 0,this.verticalAlignmentIn=void 0,this.bottomMarginIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.selection=void 0},e}(),Rl=function(){function e(e){this.heightIn=void 0,this.heightTypeIn=void 0,this.isHeaderIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"height",{get:function(){return this.heightIn},set:function(e){e!==this.heightIn&&(this.heightIn=e,this.notifyPropertyChanged("height"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightType",{get:function(){return this.heightTypeIn},set:function(e){e!==this.heightTypeIn&&(this.heightTypeIn=e,this.notifyPropertyChanged("heightType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHeader",{get:function(){return this.isHeaderIn},set:function(e){e!==this.isHeaderIn&&(this.isHeaderIn=e,this.notifyPropertyChanged("isHeader"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowBreakAcrossPages",{get:function(){return this.allowRowBreakAcrossPagesIn},set:function(e){e!==this.allowRowBreakAcrossPagesIn&&(this.allowRowBreakAcrossPagesIn=e,this.notifyPropertyChanged("allowBreakAcrossPages"))},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var t=this.selection;if((sf.base.isNullOrUndefined(t)||!t.isCleared&&!t.owner.isReadOnlyMode&&t.owner.isDocumentLoaded&&!t.owner.isPastingContent||t.isRetrieveFormatting)&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.start)&&!t.isRetrieveFormatting){var i=this.getPropertyValue(e);sf.base.isNullOrUndefined(i)||t.owner.editorModule.onApplyTableRowFormat(e,i)}},e.prototype.getPropertyValue=function(e){switch(e){case"height":return this.height;case"heightType":return this.heightType;case"isHeader":return this.isHeader;case"allowBreakAcrossPages":return this.allowBreakAcrossPages;default:return}},e.prototype.copyFormat=function(e){this.height=e.height,this.heightType=e.heightType,this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader},e.prototype.combineFormat=function(e){sf.base.isNullOrUndefined(this.height)||this.height===e.height||(this.height=void 0),sf.base.isNullOrUndefined(this.heightType)||this.heightType===e.heightType||(this.heightType=void 0),sf.base.isNullOrUndefined(this.allowBreakAcrossPages)||this.allowBreakAcrossPages===e.allowBreakAcrossPages||(this.allowBreakAcrossPages=void 0),sf.base.isNullOrUndefined(this.isHeader)||this.isHeader===e.isHeader||(this.isHeader=void 0)},e.prototype.clearRowFormat=function(){this.height=void 0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},e.prototype.clearFormat=function(){this.height=0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},e.prototype.destroy=function(){this.heightIn=void 0,this.heightTypeIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.isHeaderIn=void 0,this.selection=void 0},e}(),Ul=function(){function e(e){this.selection=e}return Object.defineProperty(e.prototype,"width",{get:function(){return this.image?this.image.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.image?this.image.height:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alternateText",{get:function(){return this.image?this.image.alternateText:null},set:function(e){e!==this.alternateText&&(this.image.alternateText=e)},enumerable:!0,configurable:!0}),e.prototype.resize=function(e,t){this.updateImageFormat(e,t,this.alternateText)},e.prototype.applyImageAlternativeText=function(e){this.updateImageFormat(this.width,this.height,e)},e.prototype.updateImageFormat=function(e,t,i){this.image&&this.selection.owner.editorModule&&this.selection.owner.editorModule.onImageFormat(this.image,e,t,i)},e.prototype.copyImageFormat=function(e){this.image=e},e.prototype.clearImageFormat=function(){this.image=void 0},e}(),Bl=function(){function e(e){this.widthIn=0,this.spaceIn=0,this.selection=e}return e.prototype.copyFormat=function(e){this.width=e.width,this.space=e.space},Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){e!==this.widthIn&&(this.widthIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.spaceIn},set:function(e){e!==this.spaceIn&&(this.spaceIn=e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"space":return this.space;case"width":return this.width;default:return}},e.prototype.notifyPropertyChanged=function(e){var t=this.selection;sf.base.isNullOrUndefined(t)||this.selection.owner.editorModule.onApplyColumnFormat("columns",this.selection.sectionFormat.columns)},e.prototype.clearFormat=function(){this.widthIn=0,this.spaceIn=0},e.prototype.destroy=function(){this.widthIn=void 0,this.spaceIn=void 0},e}(),Ll=function(){function e(){this.document=void 0,this.prevListLevel=void 0,this.isOrdered=void 0,this.keywordIndex=void 0,this.fieldCheck=0}return e.prototype.writeHtml=function(e,t){this.keywordIndex=t?1:0,this.document=e;var i="";e.hasOwnProperty(Ns[this.keywordIndex])&&this.serializeImages(e[Ns[this.keywordIndex]]);for(var r=0;r<e[D[this.keywordIndex]].length;r++)i+=this.serializeSection(e[D[this.keywordIndex]][r]);return i},e.prototype.serializeImages=function(e){for(var t in this.images=new a,e)if(Array.isArray(e[""+t]))this.images.add(parseInt(t),e[""+t]);else{var i=[];i.push(e[""+t]),this.images.add(parseInt(t),i)}},e.prototype.serializeSection=function(e){for(var t="",i=0;i<e[xo[this.keywordIndex]].length;i++){var r=e[xo[this.keywordIndex]][i];r.hasOwnProperty(Pn[this.keywordIndex])?t+=this.serializeParagraph(r):r.hasOwnProperty(xo[this.keywordIndex])?t+=this.serializeSection(r):(t+=this.closeList(),t+=this.serializeTable(r))}return t+=this.closeList(),this.prevListLevel=void 0,this.isOrdered=void 0,t},e.prototype.serializeParagraph=function(e){var t="",i=!1,r=!1;sf.base.isNullOrUndefined(this.prevListLevel)||(r=!0);var n=[],o=void 0;return sf.base.isNullOrUndefined(e[_[this.keywordIndex]][ot[this.keywordIndex]])||(o=this.getListLevel(e),r||(this.prevListLevel=o),this.prevListLevel!==o&&(r=!1),this.prevListLevel=o),r||(t+=this.closeList()),sf.base.isNullOrUndefined(o)||(i=!0),i&&!r&&(t+=this.getHtmlList(o,e[_[this.keywordIndex]][ot[this.keywordIndex]][Xe[this.keywordIndex]])),n.push('style="'+this.serializeParagraphStyle(e,"",i)+';white-space:pre"'),i?t+=this.createAttributesTag("li",n):(this.prevListLevel=void 0,this.isOrdered=void 0,t+=this.createAttributesTag(this.getStyleName(e[_[this.keywordIndex]][Ee[this.keywordIndex]]),n)),0===e[Pn[this.keywordIndex]].length?t+="&nbsp":t=this.serializeInlines(e,t),i?(t+=this.endTag("li")).indexOf("<ul")>-1?this.isOrdered=!1:t.indexOf("<ol")>-1&&(this.isOrdered=!0):t+=this.endTag(this.getStyleName(e[_[this.keywordIndex]][Ee[this.keywordIndex]])),e[se[this.keywordIndex]]&&(t+='<p class="iscreatedusinghtmlspantag"><span>iscreatedusinghtmlspantag</span></p>'),t},e.prototype.closeList=function(){var e="";return sf.base.isNullOrUndefined(this.isOrdered)||(e=this.isOrdered?this.endTag("ol"):this.endTag("ul"),this.isOrdered=void 0),e},e.prototype.getListLevel=function(e){for(var t=void 0,i=void 0,r=0;r<this.document[j[this.keywordIndex]].length;r++)if(this.document[j[this.keywordIndex]][r][Ke[this.keywordIndex]]===e[_[this.keywordIndex]][ot[this.keywordIndex]][Ke[this.keywordIndex]]){i=this.document[j[this.keywordIndex]][r];break}if(i)for(var n=0;n<this.document[G[this.keywordIndex]].length;n++)if(this.document[G[this.keywordIndex]][n][Bo[this.keywordIndex]]===i[Bo[this.keywordIndex]]){var o=e[_[this.keywordIndex]][ot[this.keywordIndex]][Xe[this.keywordIndex]];t=this.document[G[this.keywordIndex]][n][Lo[this.keywordIndex]][o];break}return t},e.prototype.getHtmlList=function(e,t){var i="";if(e[Oo[this.keywordIndex]]===(1==this.keywordIndex?10:"Bullet")){switch(i+='<ul type="',t){case 0:i+="disc",e[q[this.keywordIndex]][He[this.keywordIndex]]="Symbol";break;case 1:i+="circle",e[q[this.keywordIndex]][He[this.keywordIndex]]="Symbol";break;case 2:i+="square",e[q[this.keywordIndex]][He[this.keywordIndex]]="Wingdings";break;default:i+="disc",e[q[this.keywordIndex]][He[this.keywordIndex]]="Symbol"}i+='">'}else{switch(i+='<ol type="',e[Oo[this.keywordIndex]]){case"UpRoman":case 2:i+="I";break;case"LowRoman":case 3:i+="i";break;case"UpLetter":case 4:i+="A";break;case"LowLetter":case 5:i+="a";break;default:i+="1"}i+='" start="'+e[Ho[this.keywordIndex]].toString()+'">'}return i},e.prototype.serializeInlines=function(e,t){for(var i=void 0,r=0;e[Pn[this.keywordIndex]].length>r;)if((i=e[Pn[this.keywordIndex]][r]).hasOwnProperty(Pn[this.keywordIndex]))t+=this.serializeContentInlines(i,t),r++;else{if(i.hasOwnProperty(Mr[this.keywordIndex]))t+=this.serializeImageContainer(i);else if(i.hasOwnProperty(Zr[this.keywordIndex]))if(0===i[Zr[this.keywordIndex]]){var n=e[Pn[this.keywordIndex]][r+1];if(sf.base.isNullOrUndefined(n[gr[this.keywordIndex]])&&(n=e[Pn[this.keywordIndex]][r+2]),sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n[gr[this.keywordIndex]])||!(n[gr[this.keywordIndex]].indexOf("TOC")>=0||n[gr[this.keywordIndex]].indexOf("HYPERLINK")>=0))this.fieldCheck=void 0;else{this.fieldCheck=1;var o=[];o.push('style="'+this.serializeInlineStyle(i[q[this.keywordIndex]])+'"'),t+=this.createAttributesTag("a",o)}}else 2===i[Zr[this.keywordIndex]]?sf.base.isNullOrUndefined(this.fieldCheck)?this.fieldCheck=0:this.fieldCheck=2:(sf.base.isNullOrUndefined(this.fieldCheck)||0===this.fieldCheck||(t+=this.endTag("a")),this.fieldCheck=0);else{var s=sf.base.isNullOrUndefined(i[gr[this.keywordIndex]])?"":i[gr[this.keywordIndex]];if(i.hasOwnProperty(qo[this.keywordIndex]))switch(i[qo[this.keywordIndex]]){case 0:t+="<a name="+i[ye[this.keywordIndex]]+">";break;case 1:t+="</a>"}if(0===this.fieldCheck&&(t+=this.serializeSpan(s,i[q[this.keywordIndex]])),1===this.fieldCheck)t+=' href= "'+s.replace(/"/g,"").replace("HYPERLINK","").trim(),t+='"',t+=">";2===this.fieldCheck&&(t+=this.serializeSpan(s,i[q[this.keywordIndex]]))}r++}return t},e.prototype.serializeContentInlines=function(e,t){return t+=this.serializeInlines(e,t)},e.prototype.serializeSpan=function(e,t){var i="";if(-1!==e.indexOf("\v"))return(i+="<br>").toString();if(-1!==e.indexOf("\f"))return(i+='<br style = "page-break-after:always;"/>').toString();var r=[];return this.serializeInlineStyle(t),r.push('style="'+this.serializeInlineStyle(t)+'"'),i+=this.createAttributesTag("span",r),i+=this.decodeHtmlNames(e.toString()),(i+=this.endTag("span")).toString()},e.prototype.getStyleName=function(e){switch(e){case"Heading 1":return"h1";case"Heading 2":return"h2";case"Heading 3":return"h3";case"Heading 4":return"h4";case"Heading 5":return"h5";default:return"p"}},e.prototype.serializeImageContainer=function(e){var t="",i=[];this.serializeInlineStyle(e[q[this.keywordIndex]]);var r="";sf.base.isNullOrUndefined(e[Mr[this.keywordIndex]])||(r=this.images.get(parseInt(e[Mr[this.keywordIndex]]))[x.parseBoolValue(e[Vr[this.keywordIndex]])?1:0]);var n=x.convertPointToPixel(e[wr[this.keywordIndex]]),o=x.convertPointToPixel(e[br[this.keywordIndex]]);return i.push('width="'+n.toString()+'"'),i.push('height="'+o.toString()+'"'),i.push('src="'+r+'"'),t+=this.createAttributesTag("img",i),(t+=this.endTag("img")).toString()},e.prototype.serializeCell=function(e,t){var i="",r=[],n="";if(r=[],!sf.base.isNullOrUndefined(e[io[this.keywordIndex]])){if(sf.base.isNullOrUndefined(e[io[this.keywordIndex]][Qt[this.keywordIndex]][ni[this.keywordIndex]])||"empty"===e[io[this.keywordIndex]][Qt[this.keywordIndex]][ni[this.keywordIndex]]||r.push('bgcolor="'+x.getColor(e[io[this.keywordIndex]][Qt[this.keywordIndex]][ni[this.keywordIndex]])+'"'),!sf.base.isNullOrUndefined(e[io[this.keywordIndex]][At[this.keywordIndex]])&&e[io[this.keywordIndex]][At[this.keywordIndex]]>1&&r.push('colspan="'+e[io[this.keywordIndex]][At[this.keywordIndex]].toString()+'"'),!sf.base.isNullOrUndefined(e[io[this.keywordIndex]][Mt[this.keywordIndex]])&&e[io[this.keywordIndex]][Mt[this.keywordIndex]]>1&&r.push('rowspan="'+e[io[this.keywordIndex]][Mt[this.keywordIndex]].toString()+'"'),!sf.base.isNullOrUndefined(e[io[this.keywordIndex]][Lt[this.keywordIndex]])&&0!==e[io[this.keywordIndex]][Lt[this.keywordIndex]]){var o=x.convertPointToPixel(e[io[this.keywordIndex]][Lt[this.keywordIndex]]);r.push('width="'+o.toString()+'"')}var s=sf.base.isNullOrUndefined(e[io[this.keywordIndex]][zt[this.keywordIndex]])?"top":this.convertVerticalAlignment(e[io[this.keywordIndex]][zt[this.keywordIndex]]);r.push('valign="'+s+'"'),sf.base.isNullOrUndefined(e[io[this.keywordIndex]][wt[this.keywordIndex]])||0===e[io[this.keywordIndex]][wt[this.keywordIndex]]||(n+="padding-left:"+e[io[this.keywordIndex]][wt[this.keywordIndex]].toString()+"pt;"),sf.base.isNullOrUndefined(e[io[this.keywordIndex]][bt[this.keywordIndex]])||0===e[io[this.keywordIndex]][bt[this.keywordIndex]]||(n+="padding-right:"+e[io[this.keywordIndex]][bt[this.keywordIndex]].toString()+"pt;"),sf.base.isNullOrUndefined(e[io[this.keywordIndex]][xt[this.keywordIndex]])||0===e[io[this.keywordIndex]][xt[this.keywordIndex]]||(n+="padding-top:"+e[io[this.keywordIndex]][xt[this.keywordIndex]].toString()+"pt;"),sf.base.isNullOrUndefined(e[io[this.keywordIndex]][It[this.keywordIndex]])||0===e[io[this.keywordIndex]][It[this.keywordIndex]]||(n+="padding-bottom:"+e[io[this.keywordIndex]][It[this.keywordIndex]].toString()+"pt;"),sf.base.isNullOrUndefined(e[io[this.keywordIndex]][ct[this.keywordIndex]])||(n+=this.serializeCellBordersStyle(e[io[this.keywordIndex]][ct[this.keywordIndex]],t))}0!==n.length&&r.push('style="'+n+'"'),i+=this.createAttributesTag("td",r);for(var a=0;a<e[xo[this.keywordIndex]].length;a++){var l=e[xo[this.keywordIndex]][a];l.hasOwnProperty(oo[this.keywordIndex])?i+=this.serializeTable(l):i+=this.serializeParagraph(l)}return i+=this.endTag("td")},e.prototype.convertVerticalAlignment=function(e){switch(e){case"Center":case 1:return"middle";case"Bottom":case 2:return"bottom";default:return"top"}},e.prototype.serializeTable=function(e){var t="";t+=this.createTableStartTag(e);for(var i=0;i<e[oo[this.keywordIndex]].length;i++)t+=this.serializeRow(e[oo[this.keywordIndex]][i]);return t+=this.createTableEndTag()},e.prototype.serializeRow=function(e){var t="";t+=this.createRowStartTag(e);for(var i=0;i<e[no[this.keywordIndex]].length;i++)t+=this.serializeCell(e[no[this.keywordIndex]][i],e);return t},e.prototype.serializeParagraphStyle=function(e,t,i){var r="",n=!1;return 0==e[Pn[this.keywordIndex]].length&&(n=!0),r+=this.serializeCharacterFormat(e[q[this.keywordIndex]],n),r+=this.serializeParagraphFormat(e[_[this.keywordIndex]],i)},e.prototype.serializeInlineStyle=function(e){return this.serializeCharacterFormat(e)},e.prototype.serializeTableBorderStyle=function(e){var t="",i={};return i=e[Gr[this.keywordIndex]],sf.base.isNullOrUndefined(i)||i[pi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||i[pi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!sf.base.isNullOrUndefined(i)&&x.parseBoolValue(i[ai[this.keywordIndex]])&&(t+="border-left-style:none;"):(i[Br[this.keywordIndex]]=sf.base.isNullOrUndefined(i[Br[this.keywordIndex]])?"#000000":i[Br[this.keywordIndex]],i[gi[this.keywordIndex]]=sf.base.isNullOrUndefined(i[gi[this.keywordIndex]])?.5:i[gi[this.keywordIndex]],t+=this.serializeBorderStyle(i,"left")),i=e[qr[this.keywordIndex]],sf.base.isNullOrUndefined(i)||i[pi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||i[pi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!sf.base.isNullOrUndefined(i)&&x.parseBoolValue(i[ai[this.keywordIndex]])&&(t+="border-top-style:none;"):(i[Br[this.keywordIndex]]=sf.base.isNullOrUndefined(i[Br[this.keywordIndex]])?"#000000":i[Br[this.keywordIndex]],i[gi[this.keywordIndex]]=sf.base.isNullOrUndefined(i[gi[this.keywordIndex]])?.5:i[gi[this.keywordIndex]],t+=this.serializeBorderStyle(i,"top")),i=e[jr[this.keywordIndex]],sf.base.isNullOrUndefined(i)||i[pi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||i[pi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!sf.base.isNullOrUndefined(i)&&x.parseBoolValue(i[ai[this.keywordIndex]])&&(t+="border-right-style:none;"):(i[Br[this.keywordIndex]]=sf.base.isNullOrUndefined(i[Br[this.keywordIndex]])?"#000000":i[Br[this.keywordIndex]],i[gi[this.keywordIndex]]=sf.base.isNullOrUndefined(i[gi[this.keywordIndex]])?.5:i[gi[this.keywordIndex]],t+=this.serializeBorderStyle(i,"right")),i=e[_r[this.keywordIndex]],sf.base.isNullOrUndefined(i)||i[pi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||i[pi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!sf.base.isNullOrUndefined(i)&&x.parseBoolValue(i[ai[this.keywordIndex]])&&(t+="border-bottom-style:none;"):(i[Br[this.keywordIndex]]=sf.base.isNullOrUndefined(i[Br[this.keywordIndex]])?"#000000":i[Br[this.keywordIndex]],i[gi[this.keywordIndex]]=sf.base.isNullOrUndefined(i[gi[this.keywordIndex]])?.5:i[gi[this.keywordIndex]],t+=this.serializeBorderStyle(i,"bottom")),t},e.prototype.serializeCellBordersStyle=function(e,t){var i="",r={};return r=e[Gr[this.keywordIndex]],sf.base.isNullOrUndefined(r)||r[pi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||r[pi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!sf.base.isNullOrUndefined(r)&&x.parseBoolValue(r[ai[this.keywordIndex]])?i+="border-left-style:none;":sf.base.isNullOrUndefined(t[ro[this.keywordIndex]][ct[this.keywordIndex]][Gr[this.keywordIndex]])||(r=t[ro[this.keywordIndex]][ct[this.keywordIndex]][Gr[this.keywordIndex]],sf.base.isNullOrUndefined(r)||r[pi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||r[pi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(r[Br[this.keywordIndex]]=sf.base.isNullOrUndefined(r[Br[this.keywordIndex]])?"#000000":r[Br[this.keywordIndex]],r[gi[this.keywordIndex]]=sf.base.isNullOrUndefined(r[gi[this.keywordIndex]])?.5:r[gi[this.keywordIndex]],i+=this.serializeBorderStyle(r,"left"))):(r[Br[this.keywordIndex]]=sf.base.isNullOrUndefined(r[Br[this.keywordIndex]])?"#000000":r[Br[this.keywordIndex]],r[gi[this.keywordIndex]]=sf.base.isNullOrUndefined(r[gi[this.keywordIndex]])?.5:r[gi[this.keywordIndex]],i+=this.serializeBorderStyle(r,"left")),r=e[qr[this.keywordIndex]],sf.base.isNullOrUndefined(r)||r[pi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||r[pi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!sf.base.isNullOrUndefined(r)&&x.parseBoolValue(r[ai[this.keywordIndex]])?i+="border-top-style:none;":sf.base.isNullOrUndefined(t[ro[this.keywordIndex]][ct[this.keywordIndex]][qr[this.keywordIndex]])||(r=t[ro[this.keywordIndex]][ct[this.keywordIndex]][qr[this.keywordIndex]],sf.base.isNullOrUndefined(r)||r[pi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||r[pi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(r[Br[this.keywordIndex]]=sf.base.isNullOrUndefined(r[Br[this.keywordIndex]])?"#000000":r[Br[this.keywordIndex]],r[gi[this.keywordIndex]]=sf.base.isNullOrUndefined(r[gi[this.keywordIndex]])?.5:r[gi[this.keywordIndex]],i+=this.serializeBorderStyle(r,"top"))):(r[Br[this.keywordIndex]]=sf.base.isNullOrUndefined(r[Br[this.keywordIndex]])?"#000000":r[Br[this.keywordIndex]],r[gi[this.keywordIndex]]=sf.base.isNullOrUndefined(r[gi[this.keywordIndex]])?.5:r[gi[this.keywordIndex]],i+=this.serializeBorderStyle(r,"top")),r=e[jr[this.keywordIndex]],sf.base.isNullOrUndefined(r)||r[pi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||r[pi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!sf.base.isNullOrUndefined(r)&&x.parseBoolValue(r[ai[this.keywordIndex]])?i+="border-right-style:none;":sf.base.isNullOrUndefined(t[ro[this.keywordIndex]][ct[this.keywordIndex]][jr[this.keywordIndex]])||(r=t[ro[this.keywordIndex]][ct[this.keywordIndex]][jr[this.keywordIndex]],sf.base.isNullOrUndefined(r)||r[pi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||r[pi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(r[Br[this.keywordIndex]]=sf.base.isNullOrUndefined(r[Br[this.keywordIndex]])?"#000000":r[Br[this.keywordIndex]],r[gi[this.keywordIndex]]=sf.base.isNullOrUndefined(r[gi[this.keywordIndex]])?.5:r[gi[this.keywordIndex]],i+=this.serializeBorderStyle(r,"right"))):(r[Br[this.keywordIndex]]=sf.base.isNullOrUndefined(r[Br[this.keywordIndex]])?"#000000":r[Br[this.keywordIndex]],r[gi[this.keywordIndex]]=sf.base.isNullOrUndefined(r[gi[this.keywordIndex]])?.5:r[gi[this.keywordIndex]],i+=this.serializeBorderStyle(r,"right")),r=e[_r[this.keywordIndex]],sf.base.isNullOrUndefined(r)||r[pi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||r[pi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")?!sf.base.isNullOrUndefined(r)&&x.parseBoolValue(r[ai[this.keywordIndex]])?i+="border-bottom-style:none;":sf.base.isNullOrUndefined(t[ro[this.keywordIndex]][ct[this.keywordIndex]][_r[this.keywordIndex]])||(r=t[ro[this.keywordIndex]][ct[this.keywordIndex]][_r[this.keywordIndex]],sf.base.isNullOrUndefined(r)||r[pi[this.keywordIndex]]===(1==this.keywordIndex?1:"None")||r[pi[this.keywordIndex]]===(1==this.keywordIndex?26:"Cleared")||(r[Br[this.keywordIndex]]=sf.base.isNullOrUndefined(r[Br[this.keywordIndex]])?"#000000":r[Br[this.keywordIndex]],r[gi[this.keywordIndex]]=sf.base.isNullOrUndefined(r[gi[this.keywordIndex]])?.5:r[gi[this.keywordIndex]],i+=this.serializeBorderStyle(r,"bottom"))):(r[Br[this.keywordIndex]]=sf.base.isNullOrUndefined(r[Br[this.keywordIndex]])?"#000000":r[Br[this.keywordIndex]],r[gi[this.keywordIndex]]=sf.base.isNullOrUndefined(r[gi[this.keywordIndex]])?.5:r[gi[this.keywordIndex]],i+=this.serializeBorderStyle(r,"bottom")),i},e.prototype.serializeBorderStyle=function(e,t){var i="";return i+="border-"+t+"-style:"+this.convertBorderLineStyle(e[pi[this.keywordIndex]]),i+=";",e[gi[this.keywordIndex]]>0&&(i+="border-"+t+"-width:"+e[gi[this.keywordIndex]].toString()+"pt;"),sf.base.isNullOrUndefined(e[Br[this.keywordIndex]])||(i+="border-"+t+"-color:"+x.getColor(e[Br[this.keywordIndex]])+";"),i},e.prototype.convertBorderLineStyle=function(e){switch(e){case"Single":case 0:return"solid";case"None":case 1:return"none";case"Dot":case 2:return"dotted";case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":case 3:case 4:case 5:case 6:return"dashed";case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:return"double";case"SingleWavy":case 18:return"solid";case"DoubleWavy":case 19:return"double";case"DashDotStroked":case 20:return"solid";case"Emboss3D":case 21:return"ridge";case"Engrave3D":case 22:return"groove";case"Outset":case 23:return"outset";case"Inset":case 24:return"inset";default:return"solid"}},e.prototype.serializeCharacterFormat=function(e,t){if(!sf.base.isNullOrUndefined(e[Ws[this.keywordIndex]]))return this.serializeCharacterFormat(e[Ws[this.keywordIndex]],t);var i,r="";return r+="font-weight",r+=":",r+=x.parseBoolValue(e[Ce[this.keywordIndex]])?"bold":"normal",r+=";",r+="font-style",r+=":",x.parseBoolValue(e[We[this.keywordIndex]])?r+="italic":r+="normal",r+=";",r+=this.serializeTextDecoration(e),e[Se[this.keywordIndex]]!==(1==this.keywordIndex?1:"Superscript")&&e[Se[this.keywordIndex]]!==(1==this.keywordIndex?2:"Subscript")||(r+="vertical-align",r+=":",r+=e[Se[this.keywordIndex]]===(1==this.keywordIndex?1:"Superscript")?"super":"sub",r+=";"),sf.base.isNullOrUndefined(e[Ne[this.keywordIndex]])||e[Ne[this.keywordIndex]]===(1==this.keywordIndex?0:"NoColor")||t||(r+="background-color",r+=":",r+=1==this.keywordIndex?this.getHighlightColorCode(e[Ne[this.keywordIndex]]):x.getHighlightColorCode(e.highlightColor.toString()),r+=";"),i=e[Te[this.keywordIndex]],sf.base.isNullOrUndefined(i)||(r+="color",r+=":",r+=x.getColor(i),r+=";"),!sf.base.isNullOrUndefined(e[De[this.keywordIndex]])&&x.parseBoolValue(e[De[this.keywordIndex]])&&(r+="text-transform",r+=":",r+="uppercase",r+=";"),i=e[Oe[this.keywordIndex]],sf.base.isNullOrUndefined(i)||(r+="font-size",r+=":",r+=i.toString(),r+="pt",r+=";"),i=e[He[this.keywordIndex]],sf.base.isNullOrUndefined(i)||(r+="font-family",r+=":",r+=i.toString(),r+=";"),i=e[Bs[this.keywordIndex]],sf.base.isNullOrUndefined(i)||(r+="letter-spacing",r+=":",r+=i.toString(),r+="pt",r+=";"),i=e[Ls[this.keywordIndex]],sf.base.isNullOrUndefined(i)||(r+="transform:scaleX(",r+=(i/100).toString(),r+=")",r+=";"),r.toString()},e.prototype.serializeTextDecoration=function(e){var t="";return e[Pe[this.keywordIndex]]!==(1==this.keywordIndex?1:"SingleStrike")&&e[Pe[this.keywordIndex]]!==(1==this.keywordIndex?2:"DoubleStrike")||(t+="line-through "),sf.base.isNullOrUndefined(e[ke[this.keywordIndex]])||e[ke[this.keywordIndex]]===(1==this.keywordIndex?0:"None")||(t+="underline"),t.length>1&&(t="text-decoration:"+t+";"),t},e.prototype.serializeParagraphFormat=function(e,t,i){if(sf.base.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=i),!sf.base.isNullOrUndefined(e[Ws[this.keywordIndex]]))return this.serializeParagraphFormat(e[Ws[this.keywordIndex]],t);var r,n="";return r=this.getTextAlignment(e[Qe[this.keywordIndex]]),sf.base.isNullOrUndefined(r)||(n+="text-align:"+r.toLowerCase()+";"),r=e[et[this.keywordIndex]],sf.base.isNullOrUndefined(r)||(n+="margin-top:"+r.toString()+"pt; "),r=e[Ye[this.keywordIndex]],sf.base.isNullOrUndefined(r)||(n+="margin-right:"+r.toString()+"pt; "),r=e[$e[this.keywordIndex]],sf.base.isNullOrUndefined(r)||(n+="margin-bottom:"+r.toString()+"pt; "),r=e[Je[this.keywordIndex]],t&&(r=0),sf.base.isNullOrUndefined(r)||(n+="margin-left:"+r.toString()+"pt; "),r=e[Ze[this.keywordIndex]],t&&(r=0),sf.base.isNullOrUndefined(r)||0===r||(n+="text-indent:"+r.toString()+"pt;"),r=e[rt[this.keywordIndex]],sf.base.isNullOrUndefined(r)||(n+="line-height:"+(r=e[nt[this.keywordIndex]]===(1==this.keywordIndex?0:"Multiple")?Math.round(10*r)/10:r.toString()+"pt;")),n.toString()},e.prototype.createAttributesTag=function(e,t){var i="";i+="<",i+=e;for(var r=0;r<t.length;r++)i+=" ",i+=t[r];return"a"!==e&&(i+=">"),i},e.prototype.createTag=function(e){var t="";return t+="<",t+=e,t+=">"},e.prototype.endTag=function(e){var t="";return t+="<",t+="/",t+=e,t+=">"},e.prototype.createTableStartTag=function(e){var t="",i="",r=[];return sf.base.isNullOrUndefined(e[ho[this.keywordIndex]])||(sf.base.isNullOrUndefined(e[ho[this.keywordIndex]][Qt[this.keywordIndex]])||sf.base.isNullOrUndefined(e[ho[this.keywordIndex]][Qt[this.keywordIndex]][ni[this.keywordIndex]])||"empty"===e[ho[this.keywordIndex]][Qt[this.keywordIndex]][ni[this.keywordIndex]]||r.push('bgcolor="'+x.getColor(e[ho[this.keywordIndex]][Qt[this.keywordIndex]][ni[this.keywordIndex]])+'"'),!sf.base.isNullOrUndefined(e[ho[this.keywordIndex]][Zt[this.keywordIndex]])&&e[ho[this.keywordIndex]][Zt[this.keywordIndex]]>0?r.push('cellspacing="'+(72*e[ho[this.keywordIndex]][Zt[this.keywordIndex]]/96*2).toString()+'"'):i+="border-collapse:collapse;",r.push('cellpadding="0"'),sf.base.isNullOrUndefined(e[ho[this.keywordIndex]][Je[this.keywordIndex]])||0===e[ho[this.keywordIndex]][Je[this.keywordIndex]]||e[ho[this.keywordIndex]][$t[this.keywordIndex]]!==(1==this.keywordIndex?0:"Left")||(i+="margin-left:"+e[ho[this.keywordIndex]][Je[this.keywordIndex]].toString()+"pt;"),sf.base.isNullOrUndefined(e[ho[this.keywordIndex]])||(i+=this.serializeTableWidth(e[ho[this.keywordIndex]])),sf.base.isNullOrUndefined(e[ho[this.keywordIndex]][ct[this.keywordIndex]])||(i+=this.serializeTableBorderStyle(e[ho[this.keywordIndex]][ct[this.keywordIndex]]))),0!==i.length&&r.push('style="',i.toString()+'"'),t+this.createAttributesTag("table",r)},e.prototype.serializeTableWidth=function(e){var t="";switch(e[ti[this.keywordIndex]]){case"Percent":case 1:t+="width: "+e[ei[this.keywordIndex]].toString()+"%;";break;case"Point":case 2:t+="width: "+e[ei[this.keywordIndex]].toString()+"pt;";break;case"Auto":case 0:t+="width: auto;"}return t},e.prototype.getHighlightColorCode=function(e){var t="#ffffff";switch(e){case 1:t="#ffff00";break;case 2:t="#00ff00";break;case 3:t="#00ffff";break;case 4:t="#ff00ff";break;case 5:t="#0000ff";break;case 6:t="#ff0000";break;case 7:t="#000080";break;case 8:t="#008080";break;case 9:t="#008000";break;case 10:t="#800080";break;case 11:t="#800000";break;case 12:t="#808000";break;case 13:t="#808080";break;case 14:t="#c0c0c0";break;case 15:t="#000000"}return t},e.prototype.getTextAlignment=function(e){switch(e){case 1:return"Center";case 2:return"Right";case 3:return"Justify";default:return"Left"}},e.prototype.createTableEndTag=function(){var e="";return e+=this.endTag("table")},e.prototype.createRowStartTag=function(e){var t="",i=[];if(x.parseBoolValue(e[ro[this.keywordIndex]][Vt[this.keywordIndex]])&&(t+=this.createTag("thead")),!sf.base.isNullOrUndefined(e[ro[this.keywordIndex]][br[this.keywordIndex]])&&e[ro[this.keywordIndex]][br[this.keywordIndex]]>0){var r=x.convertPointToPixel(e[ro[this.keywordIndex]][br[this.keywordIndex]]);i.push('height="'+r+'"')}return t+this.createAttributesTag("tr",i)},e.prototype.createRowEndTag=function(e){var t="";return t+=this.endTag("tr"),x.parseBoolValue(e[ro[this.keywordIndex]][Vt[this.keywordIndex]])&&(t+=this.endTag("thead")),t},e.prototype.decodeHtmlNames=function(e){if("\t"===e)return"&emsp;";var t=(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;")).split(" "),i="";if(t.length>0){i=t[0];for(var r=0;r<t.length-1;r++)i+=" "+t[r+1]}return i},e}(),Al=function(){function e(e){this.location=new I(0,0),this.isUpdateLocation=!0,this.owner=e,this.documentHelper=this.owner.documentHelper}return Object.defineProperty(e.prototype,"paragraph",{get:function(){return this.currentWidget.paragraph},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAtParagraphStart",{get:function(){return this.offset===this.owner.selection.getStartOffset(this.paragraph)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAtParagraphEnd",{get:function(){return this.owner.selection.isParagraphLastLine(this.currentWidget)&&this.offset===this.owner.selection.getLineLength(this.currentWidget)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCurrentParaBidi",{get:function(){return!sf.base.isNullOrUndefined(this.currentWidget.paragraph)&&this.currentWidget.paragraph.paragraphFormat.bidi},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hierarchicalPosition",{get:function(){return this.getHierarchicalIndexInternal()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e(this.owner);return t.currentWidget=this.currentWidget,t.offset=this.offset,t.location=this.location,t},e.prototype.containsRtlText=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t].isRightToLeft)return!0;return!1},e.prototype.setPositionForSelection=function(e,t,i,r){var n=!1;sf.base.isNullOrUndefined(t)?this.currentWidget=e:(this.currentWidget=t.line,t.nextNode instanceof va&&i>t.length&&(n=this.selection.isLastRenderedInline(t,t.length))),this.location=r,this.offset=n?this.selection.getParagraphLength(this.currentWidget.paragraph)+1:this.currentWidget.getOffset(t,i)},e.prototype.setPositionFromLine=function(e,t,i){this.currentWidget=e,this.offset=t,i instanceof I&&this.location.copy(i)},e.prototype.setPosition=function(e,t){this.currentWidget=e,this.offset=t?this.selection.getStartOffset(e.paragraph):e.paragraph.lastChild.getEndOffset()+1,this.updatePhysicalPosition(!0)},e.prototype.setPositionInternal=function(e){this.currentWidget=e.currentWidget,this.offset=e.offset,this.location=e.location},e.prototype.setPositionForCurrentIndex=function(e){var t={index:e},i=this.getParagraphWidget(t);this.offset=parseFloat(t.index),this.setPositionParagraph(i,this.offset)},e.prototype.getPage=function(e){var t=e.index.indexOf(";"),i="0";return t>=0&&(i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";","")),t=parseInt(i,10),this.documentHelper.pages[t]},e.prototype.getParagraphWidget=function(e){if(!sf.base.isNullOrUndefined(e.index)){var t=this.getPage(e);return this.getLineWidget(void 0,e,t)}},e.prototype.getLineWidget=function(e,t,i){if(!sf.base.isNullOrUndefined(t.index)){var r=t.index.indexOf(";"),n="0";if(r>=0&&(n=t.index.substring(0,r),t.index=t.index.substring(r).replace(";","")),"H"===n||"F"===n)e="H"===n?i.headerWidget:i.footerWidget;else if("FN"===n||"EN"===n){var o=t.index.indexOf(";"),s=t.index.substring(0,o);t.index=t.index.substring(o).replace(";",""),e="FN"===n?i.footnoteWidget.bodyWidgets[s]:i.endnoteWidget.bodyWidgets[s]}else sf.base.isNullOrUndefined(i)||(e=parseInt(n,10)<i.bodyWidgets.length?i.bodyWidgets[parseInt(n,10)]:i.bodyWidgets[0]);if(r=parseInt(n,10),e instanceof sa&&(r=t.index.indexOf(";"),n="0",n=t.index.substring(0,r),t.index=t.index.substring(r).replace(";",""),r=parseInt(n,10)),e instanceof fa&&r>=e.childWidgets.length&&(t.index="0;0",r=e.childWidgets.length-1),r>=0&&r<e.childWidgets.length){var a=e.childWidgets[r];if(a instanceof ma)return t.index.indexOf(";")>0&&(t.index="0"),a;if(a instanceof oa)return t.index.indexOf(";")>0?this.getLineWidget(a,t):a instanceof ga?this.getLineWidget(this.documentHelper.getFirstParagraphInFirstCell(a),t):a instanceof fa&&-1===t.index.indexOf(";")?this.documentHelper.getFirstParagraphInFirstCell(a.ownerTable).childWidgets[0]:void 0}else if(e.nextRenderedWidget instanceof oa)return t.index="0",e.nextRenderedWidget instanceof ga?this.documentHelper.getFirstParagraphInFirstCell(e.nextRenderedWidget).firstChild:this.getLineWidget(e.nextRenderedWidget,t)}},e.prototype.updatePhysicalPosition=function(e){this.currentWidget&&this.owner.isLayoutEnabled&&this.isUpdateLocation&&(this.location=this.selection.getPhysicalPositionInternal(this.currentWidget,this.offset,e))},e.prototype.isAtSamePosition=function(e){return this.currentWidget===e.currentWidget&&this.offset===e.offset},e.prototype.isInSameParagraphIndex=function(e){if(sf.base.isNullOrUndefined(e))throw new Error("textPosition is undefined.");return this.paragraph.index===e.paragraph.index},e.prototype.isInSameParagraph=function(e){if(sf.base.isNullOrUndefined(e))throw new Error("textPosition is undefined.");return this.paragraph===e.paragraph},e.prototype.isInSameListParagraph=function(e){if(sf.base.isNullOrUndefined(e))throw new Error("textPosition is undefined.");return this.paragraph.paragraphFormat.listFormat.listId===e.paragraph.paragraphFormat.listFormat.listId},e.prototype.isExistBefore=function(e){if(sf.base.isNullOrUndefined(e))throw new Error("textPosition is undefined.");if(this.currentWidget===e.currentWidget)return this.offset<e.offset;var t=this.currentWidget.paragraph,i=e.currentWidget.paragraph;return t===i?t.childWidgets.indexOf(this.currentWidget)<i.childWidgets.indexOf(e.currentWidget):t.containerWidget===i.containerWidget?t.isInsideTable?t.associatedCell.childWidgets.indexOf(t)<i.associatedCell.childWidgets.indexOf(i):t.containerWidget.childWidgets.indexOf(t)<i.containerWidget.childWidgets.indexOf(i):this.owner.selection.isExistBefore(t,i)},e.prototype.isExistAfter=function(e){if(sf.base.isNullOrUndefined(e))throw new Error("textPosition is undefined.");if(this.currentWidget===e.currentWidget)return this.offset>e.offset;if(this.currentWidget.paragraph===e.currentWidget.paragraph)return this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget)>e.currentWidget.paragraph.childWidgets.indexOf(e.currentWidget);var t=this.currentWidget.paragraph,i=e.currentWidget.paragraph;return!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(i)&&(t.containerWidget instanceof aa&&i.containerWidget instanceof aa&&t.containerWidget===i.containerWidget?t.isInsideTable&&i.isInsideTable?t.associatedCell.childWidgets.indexOf(t)>i.associatedCell.childWidgets.indexOf(i):t.containerWidget.childWidgets.indexOf(t)>i.containerWidget.childWidgets.indexOf(i):this.owner.selection.isExistAfter(t,i))},e.prototype.getHierarchicalIndexInternal=function(){return this.getHierarchicalIndex(this.currentWidget,this.offset.toString())},e.prototype.getHierarchicalIndex=function(e,t){return e?e.getHierarchicalIndex(t):t},e.prototype.setPositionParagraph=function(e,t){this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},e.prototype.setPositionForLineWidget=function(e,t){var i=this.selection.getLineLength(e),r=e.paragraph.childWidgets.indexOf(e);if(e.isLastLine()&&(sf.base.isNullOrUndefined(e.paragraph.bodyWidget.footNoteReference)?i+=1:i+=e.paragraph.bodyWidget.footNoteReference.text.length),t>i){var n=void 0;if(r>=e.paragraph.childWidgets.length-1){var o=this.selection.getNextRenderedBlock(e.paragraph);o&&o.index===e.paragraph.index&&(n=o.firstChild)}else n=e.paragraph.childWidgets[r+1];this.setPositionForLineWidget(n,t-i)}else if(t<0){var s=e.paragraph.childWidgets[r-1],a=this.selection.getLineLength(s)+t;this.setPositionForLineWidget(s,a)}else this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},e.prototype.moveNextPosition=function(t){sf.base.isNullOrUndefined(t)&&(t=!0);var i=this.selection.getNextStartInline(this.currentWidget,this.offset);if(i instanceof va&&0===i.fieldType&&!sf.base.isNullOrUndefined(i.fieldEnd)){if(t)return this.moveNextPositionInternal(i),void this.moveNextPosition();var r=i.fieldEnd.line,n=i.fieldEnd,o=r.getOffset(n,1),s=this.getHierarchicalIndex(r,o.toString());if(e.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(),s))return void this.selection.end.moveToInline(i.fieldEnd,1);this.moveToInline(i.fieldEnd,1)}var a=this.selection.getNextValidOffset(this.currentWidget,this.offset),l=this.paragraph.childWidgets.indexOf(this.currentWidget),d=0;if(a>this.offset){this.offset=a;var h=this.currentWidget.getInline(this.offset,d);if(i=h.element,d=h.index,!sf.base.isNullOrUndefined(i)&&d===i.length&&(i.nextNode instanceof va||i.nextNode instanceof Na)){var c=this.selection.getNextValidElement(i.nextNode);(c instanceof va&&1===c.fieldType||c instanceof Na&&1===c.bookmarkType)&&(i=c,this.currentWidget=i.line,this.offset=this.currentWidget.getOffset(i,this.documentHelper.isFormFillProtectedMode?0:1))}}else if(l+1<this.paragraph.childWidgets.length){var p=this.paragraph.childWidgets[l+1];p&&(this.currentWidget=p,this.offset=this.selection.getStartLineOffset(this.currentWidget));var g=this.currentWidget.getInline(this.offset,d);i=g.element,d=g.index,i instanceof va&&0===i.fieldType&&this.offset++}else this.updateOffsetToNextParagraph(d,!1);this.updatePhysicalPosition(!0)},e.prototype.moveToPreviousParagraphInTable=function(e){var t,i=this.currentWidget.paragraph;t=i.isInsideTable?e.getPreviousSelectionCell(i.associatedCell):e.getPreviousParagraphBlock(i),sf.base.isNullOrUndefined(t)||(this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},e.prototype.updateOffsetToNextParagraph=function(e,t){var i,r=!1,n=void 0,o=this.paragraph.childWidgets.indexOf(this.currentWidget);if(t)if(o+1<this.paragraph.childWidgets.length){var s=this.paragraph.childWidgets[o+1];s&&(this.currentWidget=s,this.offset=1)}else{if(n=this.selection.getNextSelectionBlock(this.paragraph),!sf.base.isNullOrUndefined(n))if(n.containerWidget instanceof ua)if(this.selection.start.paragraph.isInsideTable)r=!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,n.associatedCell).ownerTable.contains(n.associatedCell);else r=!0}else n=this.selection.getNextParagraphBlock(this.paragraph);!sf.base.isNullOrUndefined(n)&&n.childWidgets.length>0&&(r?(this.currentWidget=n.childWidgets[n.childWidgets.length-1],this.offset=this.selection.getLineLength(this.currentWidget)+1):(this.currentWidget=n.firstChild,this.offset=t?1:this.selection.getStartLineOffset(this.currentWidget)));var a=this.currentWidget.getInline(this.offset,e);i=a.element,e=a.index,i instanceof va&&0===i.fieldType&&this.offset++},e.prototype.updateOffsetToPrevPosition=function(e,t){var i,r,n=this.paragraph.childWidgets.indexOf(this.currentWidget),o=this.selection.getPreviousValidOffset(this.currentWidget.paragraph,this.offset);if(this.offset>o)this.offset=o;else if(n>0){var s=this.paragraph.childWidgets[n-1];if(s){this.currentWidget=s;var a=this.currentWidget.getEndOffset();this.offset=a>0?a-1:a}}else{var l=void 0,d=!1;if(t){if(l=this.selection.getPreviousSelectionBlock(this.paragraph),!sf.base.isNullOrUndefined(l))if(l.containerWidget instanceof ua)if(this.selection.start.paragraph.isInsideTable)d=!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,l.associatedCell).ownerTable.contains(l.associatedCell);else d=!0}else l=this.selection.getPreviousParagraphBlock(this.paragraph);sf.base.isNullOrUndefined(l)||(d?(this.currentWidget=l.firstChild,this.offset=this.selection.getStartLineOffset(this.currentWidget)):(this.currentWidget=l.childWidgets[l.childWidgets.length-1],this.offset=this.currentWidget.isEndsWithPageBreak||this.currentWidget.isEndsWithColumnBreak?this.currentWidget.getEndOffset()-1:this.currentWidget.getEndOffset()))}if(e=0,r=(i=this.currentWidget.getInline(this.offset,e)).element,e=i.index,r instanceof va&&0===r.fieldType&&this.offset++,r instanceof va){var h=this.selection.getPreviousValidElement(r);sf.base.isNullOrUndefined(h)||(r=h,this.currentWidget=r.line,this.offset=this.currentWidget.getOffset(r,r.length),r instanceof va&&0===r.fieldType&&this.offset--)}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphStartInternal=function(){var e=this.currentWidget.paragraph;sf.base.isNullOrUndefined(this.selection.getNextParagraphBlock(e))||(this.currentWidget=this.selection.getNextParagraphBlock(e).firstChild,this.offset=this.selection.getStartOffset(e),this.updatePhysicalPosition(!0))},e.prototype.movePreviousPosition=function(){var e=0,t=this.currentWidget.getInline(this.offset,e),i=t.element;e=t.index;this.paragraph.childWidgets.indexOf(this.currentWidget);(i instanceof va&&1===i.fieldType&&!sf.base.isNullOrUndefined(i.fieldBegin)||i instanceof Na&&1===i.bookmarkType)&&this.movePreviousPositionInternal(i),this.updateOffsetToPrevPosition(e,!1)},e.prototype.moveNextPositionInternal=function(e){var t;sf.base.isNullOrUndefined(e.fieldSeparator)?t=e.fieldEnd:(t=e.fieldSeparator,this.currentWidget=t.line,this.currentWidget!==e.fieldEnd.line||this.selection.hasValidInline(this.paragraph,t,e.fieldEnd)||(t=e.fieldEnd)),this.currentWidget=t.line,this.offset=this.currentWidget.getOffset(t,1)},e.prototype.moveBackward=function(){var t=0,i=this.currentWidget.getInline(this.offset,t),r=i.element;if(t=i.index,!this.owner.selection.isEmpty&&!sf.base.isNullOrUndefined(r)){var n=this.selection.getNextRenderedElementBox(r,t);if(n instanceof va&&0===n.fieldType){var o=this.owner.selection.start.getHierarchicalIndexInternal(),s=n.fieldEnd.line.getOffset(n.fieldEnd,1),a=this.getHierarchicalIndex(n.fieldEnd.line,s.toString());if(!e.isForwardSelection(a,o))return void this.owner.selection.start.setPositionParagraph(n.fieldEnd.line,s)}}if(r instanceof va&&1===r.fieldType&&!sf.base.isNullOrUndefined(r.fieldBegin)){o=this.owner.selection.start.getHierarchicalIndexInternal(),s=r.line.getOffset(r,1),a=this.getHierarchicalIndex(r.line,s.toString());if(!e.isForwardSelection(o,a)){var l=r.fieldBegin.line.getOffset(r.fieldBegin,0);return this.currentWidget=r.fieldBegin.line,this.offset=l,void this.updatePhysicalPosition(!0)}this.movePreviousPositionInternal(r)}this.updateOffsetToPrevPosition(t,!0)},e.prototype.moveForward=function(){var t=0,i=this.currentWidget.getInline(this.offset,t),r=i.element;if(t=i.index,!sf.base.isNullOrUndefined(r)){if(!this.owner.selection.isEmpty&&t===r.length&&r instanceof va&&1===r.fieldType){var n=this.owner.selection.start.getHierarchicalIndexInternal(),o=r.fieldBegin.line.getOffset(r.fieldBegin,0),s=this.getHierarchicalIndex(r.fieldBegin.line,o.toString());if(!e.isForwardSelection(n,s))return void this.owner.selection.start.setPositionParagraph(r.fieldBegin.line,o)}r=this.selection.getNextRenderedElementBox(r,t)}if(r instanceof va&&!sf.base.isNullOrUndefined(r.fieldEnd)){var a=0,l=this.owner.selection.start.paragraph.getInline(this.owner.selection.start.offset,a),d=l.element;if(a=l.index,this.selection.getNextRenderedElementBox(d,a)!==r)return r=r.fieldEnd,this.currentWidget=r.line,this.offset=this.currentWidget.getOffset(r,1),void this.updatePhysicalPosition(!0);this.moveNextPositionInternal(r)}else r instanceof va&&(0===r.fieldType||1===r.fieldType)&&(this.currentWidget=r.line,this.offset=this.currentWidget.getOffset(r,1));t=0;var h=this.selection.getNextValidOffset(this.currentWidget,this.offset),c=this.selection.getLineLength(this.currentWidget),p=this.selection.isParagraphLastLine(this.currentWidget);if(this.offset<h){this.offset=h;var g=this.currentWidget.getInline(this.offset,t);if(r=g.element,t=g.index,!sf.base.isNullOrUndefined(r)&&t===r.length&&r.nextNode instanceof va){var f=this.selection.getNextValidElement(r.nextNode);f instanceof va&&1===f.fieldType&&(r=f,this.offset=this.currentWidget.getOffset(r,1))}}else this.offset===h&&r instanceof va&&1===r.fieldType&&r.previousNode instanceof Da?this.offset=h:this.offset===h&&this.offset<c+1&&p?this.offset=c+1:this.updateOffsetToNextParagraph(t,!0);this.updatePhysicalPosition(!0)},e.prototype.moveToInline=function(e,t){this.currentWidget=e.line,this.offset=this.currentWidget.getOffset(e,t),this.updatePhysicalPosition(!0)},e.isForwardSelection=function(e,t){if(e===t)return!0;e=e.replace(/S;/g,""),t=t.replace(/S;/g,""),e=e.replace(/C;/g,""),t=t.replace(/C;/g,""),e=e.replace(/H;/g,""),t=t.replace(/H;/g,""),e=e.replace(/F;/g,""),t=t.replace(/F;/g,""),e=e.replace(/FN;/g,""),t=t.replace(/FN;/g,""),e=e.replace(/EN;/g,""),t=t.replace(/EN;/g,"");var i=e.split(";"),r=t.split(";"),n=i.length;n>r.length&&(n=r.length-1);for(var o=0;o<n;o++){var s=parseFloat(i[o]),a=parseFloat(r[o]);if(s!==a)return s<a}return!1},e.prototype.movePreviousPositionInternal=function(e){var t;t=e instanceof va&&sf.base.isNullOrUndefined(e.fieldSeparator)?this.selection.getPreviousValidElement(e.fieldBegin):this.selection.getPreviousValidElement(e),this.currentWidget=t.line;var i=t instanceof va||t instanceof Na&&1===t.bookmarkType?0:t.length;this.offset=this.currentWidget.getOffset(t,i)},e.prototype.moveToWordStartInternal=function(e){var t=this.currentWidget.getEndOffset(),i=this.currentWidget.paragraph,r=this.selection;if(2!==e||this.offset!==t&&this.offset!==t+1){if(this.offset===t+1)this.offset=t;else if(this.offset===r.getStartOffset(i)&&this.currentWidget===i.childWidgets[0]){var n=r.getPreviousParagraphBlock(i);if(sf.base.isNullOrUndefined(n))return;this.currentWidget=n.childWidgets[n.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()}else{if(this.offset===r.getStartLineOffset(this.currentWidget)){var o=i.childWidgets.indexOf(this.currentWidget);o-1>=0&&(this.currentWidget=i.childWidgets[o-1],this.offset=this.currentWidget.getEndOffset())}var s=0,a=this.currentWidget.getInline(this.offset,s),l=a.element;s=a.index,this.getPreviousWordOffset(l,r,s,e,l instanceof va&&1===l.fieldType,!1,!1,this)}1===e&&this.calculateOffset(),this.updatePhysicalPosition(!0)}},e.prototype.getNextWordOffset=function(e,t,i,r,n,o,s){e instanceof Fa?this.getNextWordOffsetSpan(e,t,i,r,n,o,s):e instanceof Da?this.getNextWordOffsetImage(e,t,i,r,n,o,s):e instanceof va&&0===e.fieldType?this.getNextWordOffsetFieldBegin(e,t,i,r,n,o,s):e instanceof va&&2===e.fieldType||e instanceof Na?this.getNextWordOffsetFieldSeparator(e,t,i,r,n,o,s):e instanceof va&&1===e.fieldType?this.getNextWordOffsetFieldEnd(e,t,i,r,n,o,s):e instanceof al&&this.getNextWordOffsetComment(e,t,i,r,n,o,s)},e.prototype.getNextWordOffsetFieldBegin=function(e,t,i,r,n,o,s){var a=e.line.getOffset(e,0);e.length;if(sf.base.isNullOrUndefined(e.fieldSeparator))this.getNextWordOffsetFieldEnd(e.fieldEnd,0,i,r,n,o,s);else if(0===i)this.getNextWordOffsetFieldSeparator(e.fieldSeparator,0,i,r,n,o,s);else if(!sf.base.isNullOrUndefined(e.fieldEnd)){var l=e.fieldSeparator;if(l.line.paragraph!==e.fieldEnd.line.paragraph||this.selection.hasValidInline(l.line.paragraph,l,e.fieldEnd)||(l=e.fieldEnd),this.getNextWordOffset(l,0,i,!(o.paragraph===e.line.paragraph&&o.offset===a),n,o,s),n&&!sf.base.isNullOrUndefined(e.fieldSeparator)&&o.paragraph===e.line.paragraph&&o.offset===e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length))return void o.setPositionParagraph(e.line,a);n||o.setPositionParagraph(e.fieldEnd.line,e.fieldEnd.line.getOffset(e.fieldEnd,e.fieldEnd.length))}},e.prototype.getNextWordOffsetImage=function(e,t,i,r,n,o,s){if(r)return o.setPositionParagraph(e.line,e.line.getOffset(e,t)),void(n=!1);if(0===t){var a=e.line.getOffset(e,0);n=!0,o.offset===a?sf.base.isNullOrUndefined(e.nextNode)?o.setPositionParagraph(e.line,a+e.length):this.getNextWordOffset(e.nextNode,0,i,r,n,o,s):o.setPositionParagraph(e.line,a)}else sf.base.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)},e.prototype.getNextWordOffsetSpan=function(e,t,i,r,n,o,s){if("\t"===e.text||"\v"===e.text){if(r)return o.setPositionParagraph(e.line,e.line.getOffset(e,t)),void(n=!1);if(0===t){n=!0;var a=e.line.getOffset(e,0);o.offset===a?o.setPositionParagraph(e.line,a+e.length):o.setPositionParagraph(e.line,a)}else sf.base.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)}else{var l=0;if(0===t&&n&&-1===x.wordSplitCharacters.indexOf(e.text[0])){if(o.setPositionParagraph(e.line,e.line.getOffset(e,t)),r)return}else if(t<e.length){var d=t>0&&e.text.length-1>=t?e.text.slice(t,e.length):e.text;if(-1===(l=x.indexOfAny(d,x.wordSplitCharacters))&&e.nextNode instanceof al&&sf.base.isNullOrUndefined(e.nextNode.nextNode)&&(l=e.length),-1!==l){if(r)return void(n=!1);var h=e.line.getOffset(e,l+t),c=[" ","　"];if((s||-1===c.indexOf(d[l]))&&!n&&e.line.paragraph===o.paragraph&&h!==o.offset)return n=!0,void o.setPositionParagraph(e.line,h);var p=!1;for(-1!==c.indexOf(d[l])&&-1===c.indexOf(d[l+1])&&(p=!0,l++);l<d.length&&!p&&-1!==x.wordSplitCharacters.indexOf(d[l]);)if(l++,-1!==c.indexOf(d[l])&&-1===c.indexOf(d[l+1])&&-1!==x.wordSplitCharacters.indexOf(d[l+1])){l++;break}n=!0;var g=void 0;sf.base.isNullOrUndefined(e.nextNode)||(g=e.nextNode.text),l<d.length||!sf.base.isNullOrUndefined(g)&&e.line==e.nextNode.line&&-1!==c.indexOf(d[d.length-1])&&-1===c.indexOf(g[0])||sf.base.isNullOrUndefined(e.nextNode)?o.setPositionParagraph(e.line,e.line.getOffset(e,l+t)):this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)}else sf.base.isNullOrUndefined(e.nextNode)?o.setPositionParagraph(e.line,e.line.getEndOffset()):this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)}else sf.base.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)}},e.prototype.getNextWordOffsetFieldSeparator=function(e,t,i,r,n,o,s){sf.base.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)},e.prototype.getNextWordOffsetComment=function(e,t,i,r,n,o,s){sf.base.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,i,r,n,o,s)},e.prototype.getNextWordOffsetFieldEnd=function(e,t,i,r,n,o,s){var a=e.line.getOffset(e,0),l=a+e.length;o.offset===a&&(o.setPositionParagraph(e.line,l),sf.base.isNullOrUndefined(e.nextNode))||(sf.base.isNullOrUndefined(e.nextNode)?o.setPositionParagraph(e.line,a):(this.getNextWordOffset(e.nextNode,0,i,!1,n,o,s),o.offset===l&&o.setPositionParagraph(e.line,a)),n=!0)},e.prototype.getPreviousWordOffset=function(e,t,i,r,n,o,s,a){e instanceof Fa?this.getPreviousWordOffsetSpan(e,t,i,r,n,o,s,a):e instanceof Da?this.getPreviousWordOffsetImage(e,t,i,r,n,o,s,a):e instanceof va&&0===e.fieldType?this.getPreviousWordOffsetFieldBegin(e,t,i,r,n,o,s,a):e instanceof va&&2===e.fieldType?this.getPreviousWordOffsetFieldSeparator(e,t,i,r,n,o,s,a):e instanceof va&&1===e.fieldType?this.getPreviousWordOffsetFieldEnd(e,t,i,r,n,o,s,a):e instanceof Na?this.getPreviousWordOffsetBookMark(e,t,i,r,n,o,s,a):e instanceof Va&&e.previousNode?this.getPreviousWordOffsetSpan(e.previousNode,t,i,r,n,o,s,a):e instanceof al&&this.getPreviousWordOffsetComment(e,t,i,r,n,o,s,a)},e.prototype.getPreviousWordOffsetBookMark=function(e,t,i,r,n,o,s,a){if(e.previousNode){if(e.previousNode instanceof Fa){var l=e.previousNode;x.lastIndexOfAny(l.text,x.wordSplitCharacters)!==l.text.length-1?this.getPreviousWordOffset(l,t,i,r,n,o,s,a):a.setPositionParagraph(e.line,e.line.getOffset(e,0))}}else a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.getPreviousWordOffsetFieldEnd=function(e,t,i,r,n,o,s,a){var l=e.line.getOffset(e,0),d=l+e.length;if(sf.base.isNullOrUndefined(e.fieldSeparator))this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,0,r,n,o,s,a);else if(0!==r||sf.base.isNullOrUndefined(e.previousNode)){if(!sf.base.isNullOrUndefined(e.fieldBegin)&&0!==r){h=e.previousNode;if((sf.base.isNullOrUndefined(h)||h.line.paragraph===e.fieldBegin.line.paragraph&&!t.hasValidInline(h.line.paragraph,h,e.fieldBegin))&&(h=e.fieldBegin),this.getPreviousWordOffset(h,t,h.length,r,!(a.paragraph===e.line.paragraph&&a.offset===d),o,s,a),s&&a.paragraph===e.line.paragraph&&a.offset===l)return void a.setPositionParagraph(e.line,d);s||a.setPositionParagraph(e.fieldBegin.line,e.fieldBegin.line.getOffset(e.fieldBegin,0))}}else{var h=e.previousNode;this.getPreviousWordOffset(h,t,h.length,r,h instanceof va&&1===h.fieldType,o,s,a)}},e.prototype.getPreviousWordOffsetFieldSeparator=function(e,t,i,r,n,o,s,a){this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,e.fieldBegin.length,r,n,o,s,a)},e.prototype.getPreviousWordOffsetComment=function(e,t,i,r,n,o,s,a){if(e.previousNode){var l=e.previousNode;e.previousNode instanceof Fa&&x.lastIndexOfAny(l.text,x.wordSplitCharacters)!==l.text.length-1?this.getPreviousWordOffset(l,t,i,r,n,o,s,a):this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,n,o,s,a)}else a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.getPreviousWordOffsetFieldBegin=function(e,t,i,r,n,o,s,a){var l=e.line.getOffset(e,0),d=l+e.length;a.offset===d&&a.setPositionParagraph(e.line,l),sf.base.isNullOrUndefined(e.previousNode)?e.fieldSeparator?a.setPositionParagraph(e.line,e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length)):a.setPositionParagraph(e.line,t.getStartLineOffset(e.line)):(this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,!1,o,s,a),a.offset===l&&(0===r||sf.base.isNullOrUndefined(e.fieldSeparator)||a.setPositionParagraph(e.line,e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length))))},e.prototype.getPreviousWordOffsetImage=function(e,t,i,r,n,o,s,a){if(n)return a.setPositionParagraph(e.line,e.line.getOffset(e,i)),void(s=!1);if(i===e.length){var l=e.line.getOffset(e,e.length);l===a.offset?a.setPositionParagraph(e.line,l-e.length):a.setPositionParagraph(e.line,l)}else sf.base.isNullOrUndefined(e.previousNode)||this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,n,o,s,a)},e.prototype.getPreviousWordOffsetSpan=function(e,t,i,r,n,o,s,a){if("\t"===e.text||"\v"===e.text){if(n)return void(s=!1);if(i===e.length){s=!0;var l=e.line.getOffset(e,e.length);l===a.offset?a.setPositionParagraph(e.line,l-e.length):a.setPositionParagraph(e.line,l)}else sf.base.isNullOrUndefined(e.previousNode)||this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,n,o,s,a)}else{var d=0;if(!o){for(;i>0&&" "===e.text[i-1];)i--;a.setPositionParagraph(e.line,e.line.getOffset(e,i))}if(i>0){if(o=!0,0===i&&s&&-1===x.wordSplitCharacters.indexOf(e.text[0]))return a.setPositionParagraph(e.line,e.line.getOffset(e,i)),void(s=!0);var h=e.text.length>i?e.text.slice(0,i):e.text;if(-1===(d=x.lastIndexOfAny(h,x.wordSplitCharacters))&&e.previousElement instanceof al&&sf.base.isNullOrUndefined(e.previousNode.previousNode)&&(d=e.length),-1!==d){if(n)return void(s=!1);for(;d>0&&s&&" "!==h[d]&&-1!==x.wordSplitCharacters.indexOf(h[d-1]);)d--;if(" "!==h[d]&&"　"!==h[d]&&s||d++,s=!0,d>0){var c=e.line.getOffset(e,d);e.line.paragraph===a.paragraph&&c===a.offset?this.getPreviousWordOffsetSpan(e,t,i,r,n,o,s,a):a.setPositionParagraph(e.line,c)}else if(e.previousNode instanceof Fa){var p=e.previousNode.text;if(-1!==x.wordSplitCharacters.indexOf(e.text[0])&&-1===x.wordSplitCharacters.indexOf(p[p.length-1])){c=e.line.getOffset(e,d);return void a.setPositionParagraph(e.line,c)}this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,n,o,s,a)}else a.setPositionParagraph(e.line,e.line.getOffset(e,0))}else this.setPreviousWordOffset(e,t,i,r,n,o,s,a)}else this.setPreviousWordOffset(e,t,i,r,n,o,s,a)}},e.prototype.setPreviousWordOffset=function(e,t,i,r,n,o,s,a){e.previousNode instanceof ya&&e.line===e.previousNode.line?this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,n,o,s,a):a.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.validateForwardFieldSelection=function(t,i){var r=new e(this.owner);r.setPositionForCurrentIndex(t),r.isUpdateLocation=!1;var n=!1;for(this.selection.start.paragraph===this.selection.end.paragraph&&this.selection.start.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.selection.end.offset===this.selection.end.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.setPositionParagraph(this.selection.end.currentWidget,this.selection.end.offset+1);t!==i&&e.isForwardSelection(t,i);){if(!n)if(r.moveNextPosition(!1),t===r.getHierarchicalIndexInternal())break;var o=0,s=r.currentWidget.getInline(r.offset,o),a=s.element;if(o=s.index,!sf.base.isNullOrUndefined(a)){var l=this.selection.start.getHierarchicalIndexInternal();if(o===a.length&&a instanceof va&&1===a.fieldType){if(a.line.getOffset(a,0)===this.offset)return;var d=a.fieldBegin.line,h=d.getOffset(a.fieldBegin,0),c=this.getHierarchicalIndex(d,h.toString());e.isForwardSelection(l,c)||this.selection.start.setPositionParagraph(d,h)}var p=this.selection.getNextRenderedElementBox(a,o);!sf.base.isNullOrUndefined(p)&&p instanceof ya&&(a=p)}if(n=a instanceof va&&0===a.fieldType&&!sf.base.isNullOrUndefined(a.fieldEnd)){if(a.line.getOffset(a,0)===this.offset)return;var g=a.fieldEnd,f=(g.line.paragraph,g.line.getOffset(g,1)),u=this.getHierarchicalIndex(g.line,f.toString());if(!e.isForwardSelection(u,i))return void this.moveToInline(a.fieldEnd,1);r.moveToInline(a.fieldEnd,1)}t=r.getHierarchicalIndexInternal()}},e.prototype.validateBackwardFieldSelection=function(t,i){var r=new e(this.owner);r.setPositionForCurrentIndex(t),r.isUpdateLocation=!1;var n=!1;(this.selection.start.paragraph!==this.selection.end.paragraph&&this.selection.end.offset!==this.selection.getStartOffset(this.selection.start.paragraph)||this.documentHelper.isSelectionChangedOnMouseMoved&&this.selection.isParagraphFirstLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getStartOffset(this.selection.start.paragraph)||(sf.base.isNullOrUndefined(this.selection.start.paragraph.previousRenderedWidget)&&this.selection.start.paragraph===this.selection.end.paragraph&&this.selection.end.offset===this.selection.getStartOffset(this.selection.end.paragraph)||this.selection.start.paragraph!==this.selection.end.paragraph)&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.start.currentWidget.isLastLine())&&(n=!0),n&&this.selection.start.offset===this.selection.start.currentWidget.getEndOffset()&&this.selection.isParagraphLastLine(this.selection.start.currentWidget)&&this.selection.start.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+1);for(var o=this.selection.start.getHierarchicalIndexInternal();t!==i&&e.isForwardSelection(i,t);){var s=0,a=r.currentWidget.getInline(r.offset,s),l=a.element;if(s=a.index,!sf.base.isNullOrUndefined(l)){var d=this.selection.getNextRenderedElementBox(l,s);if(d instanceof va&&0===d.fieldType){var h=d.fieldEnd.line,c=h.getOffset(d.fieldEnd,1),p=this.getHierarchicalIndex(h,c.toString());e.isForwardSelection(p,o)||(this.selection.start.setPositionParagraph(h,c),o=p)}}if(l instanceof va&&1===l.fieldType&&!sf.base.isNullOrUndefined(l.fieldBegin)){var g=l.fieldBegin.line,f=l.fieldBegin,u=g.getOffset(f,0),m=this.getHierarchicalIndex(g,u.toString());if(!e.isForwardSelection(i,m))return void this.moveToInline(l.fieldBegin,0);r.moveToInline(l.fieldBegin,0)}else r.movePreviousPosition();t=r.getHierarchicalIndexInternal()}},e.prototype.paragraphStartInternal=function(e,t){var i=e.getStartLineOffset(this.currentWidget);if(this.offset===i&&t){if(this.moveToNextParagraphInTableCheck())this.moveToPreviousParagraphInTable(e);else if(!sf.base.isNullOrUndefined(e.getPreviousParagraphBlock(this.currentWidget.paragraph))){var r=e.getPreviousParagraphBlock(this.currentWidget.paragraph);this.currentWidget=r.childWidgets[0],this.offset=e.getStartLineOffset(this.currentWidget)}}else this.currentWidget=this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0],this.offset=i;this.calculateOffset()},e.prototype.calculateOffset=function(){var e=this.owner.selection.start.getHierarchicalIndexInternal(),t=this.getHierarchicalIndexInternal();e!==t&&this.validateBackwardFieldSelection(e,t),this.updatePhysicalPosition(!0)},e.prototype.moveToParagraphStartInternal=function(e,t){for(var i=this.currentWidget.paragraph;i.previousSplitWidget;)i=i.previousSplitWidget;var r=e.getStartOffset(i);this.offset===r&&t?this.moveToNextParagraphInTableCheck()?this.moveToPreviousParagraphInTable(e):sf.base.isNullOrUndefined(e.getPreviousParagraphBlock(this.paragraph))||(this.currentWidget=e.getPreviousParagraphBlock(this.paragraph).firstChild,this.offset=e.getStartOffset(this.paragraph)):(this.currentWidget=i.firstChild,this.offset=e.getStartLineOffset(this.currentWidget));var n=this.owner.selection.start.getHierarchicalIndexInternal(),o=this.getHierarchicalIndexInternal();n!==o&&this.validateBackwardFieldSelection(n,o),this.updatePhysicalPosition(!1)},e.prototype.moveToParagraphEndInternal=function(e,t){for(var i=this.currentWidget.paragraph;i.nextSplitWidget;)i=i.nextSplitWidget;this.currentWidget=i.childWidgets[i.childWidgets.length-1];var r=this.currentWidget.getEndOffset()+1;if(this.offset===r&&t){if(this.moveToNextParagraphInTableCheck())this.moveToNextParagraphInTable();else if(!sf.base.isNullOrUndefined(e.getNextParagraphBlock(this.currentWidget.paragraph))){var n=e.getNextParagraphBlock(this.currentWidget.paragraph);this.currentWidget=n.childWidgets[n.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1}}else this.offset=r;this.calculateOffset()},e.prototype.moveUp=function(e,t){var i=this.currentWidget.paragraph;this.moveToLineStartInternal(e,!0),this.movePreviousPosition();var r=void 0,n=this.currentWidget.paragraph;if(i.isInsideTable&&i!==n&&i.associatedCell!==n.associatedCell&&!sf.base.isNullOrUndefined(n.associatedCell)&&i.associatedCell.ownerRow===n.associatedCell.ownerRow){var o=n.associatedCell.ownerRow;if(o.previousRenderedWidget instanceof fa){var s=e.getFirstCellInRegion(o.previousRenderedWidget,n.associatedCell,t,!0),a=e.getLastParagraph(s);this.setPosition(a.childWidgets[a.childWidgets.length-1],!1)}else{var l=o.ownerTable.previousRenderedWidget;do{l instanceof ga&&(l=e.getLastBlockInLastCell(l))}while(l instanceof ga);l instanceof ca&&this.setPosition(l.childWidgets[l.childWidgets.length-1],!1)}r=e.getLineWidgetParagraph(this.offset,this.currentWidget)}else{if(!i.isInsideTable&&this.currentWidget.paragraph.isInsideTable){s=e.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),a=e.getLastParagraph(s);this.setPosition(a.childWidgets[a.childWidgets.length-1],!1)}else if(i.isInsideTable&&!sf.base.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow.previousRenderedWidget!==i.associatedCell.ownerRow.previousSplitWidget&&i.associatedCell.ownerRow.previousRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow){s=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),a=e.getLastParagraph(s);this.setPosition(a.childWidgets[a.childWidgets.length-1],!1)}r=e.getLineWidgetParagraph(this.offset,this.currentWidget)}var d=e.getTop(r);(this.currentWidget.isEndsWithPageBreak||this.currentWidget.isEndsWithColumnBreak)&&this.offset===this.currentWidget.getEndOffset()-1&&(t=this.location.x),e.updateTextPositionWidget(r,new I(t,d),this,!1)},e.prototype.moveDown=function(e,t){var i=this.currentWidget.paragraph,r=this.currentWidget;this.moveToLineEndInternal(e,!0);var n=this.selection.getParagraphLength(this.currentWidget.paragraph);this.offset>n&&(this.offset=n),this.moveNextPosition();var o=void 0;if(i.isInsideTable&&i!==this.currentWidget.paragraph&&i.associatedCell!==this.currentWidget.paragraph.associatedCell&&!sf.base.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow===this.currentWidget.paragraph.associatedCell.ownerRow){var s=this.currentWidget.paragraph.associatedCell.ownerRow;if(i.isInsideTable&&this.currentWidget.paragraph.isInsideTable&&i.associatedCell.cellFormat.rowSpan>1&&i.associatedCell.cellFormat.rowSpan+i.associatedCell.ownerRow.rowIndex===i.associatedCell.ownerTable.childWidgets.length&&(s=this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length-1]),s.nextRenderedWidget instanceof fa){var a=this.selection.getLastCellInRegion(s.nextRenderedWidget,this.currentWidget.paragraph.associatedCell,t,!1);this.setPosition(this.selection.getFirstParagraph(a).childWidgets[0],!0)}else{var l=this.selection.getNextRenderedBlock(s.ownerTable);do{l instanceof ga&&(l=this.selection.getFirstBlockInFirstCell(l))}while(l instanceof ga);l instanceof ca&&this.setPosition(l.childWidgets[0],!0)}o=e.getLineWidgetParagraph(this.offset,this.currentWidget)}else{if(!i.isInsideTable&&this.currentWidget.paragraph.isInsideTable){a=this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!1);this.setPosition(this.selection.getFirstParagraph(a).childWidgets[0],!0)}else if(i.isInsideTable&&!sf.base.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&i.associatedCell.ownerRow.nextRenderedWidget!==i.associatedCell.ownerRow.nextSplitWidget&&i.associatedCell.ownerRow.nextRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow){a=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0);this.setPosition(e.getFirstParagraph(a).childWidgets[0],!1)}o=e.getLineWidgetParagraph(this.offset,this.currentWidget)}var d=this.selection.getTop(o);o!==r&&this.selection.updateTextPositionWidget(o,new I(t,d),this,!1)},e.prototype.moveToLineStartInternal=function(e,t){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var i=e.getLineWidgetInternal(this.currentWidget,this.offset,t),r=e.getFirstElementInternal(i);this.documentHelper.moveCaretPosition=1;var n=e.getStartOffset(this.currentWidget.paragraph);if(sf.base.isNullOrUndefined(r)&&this.offset>n){var o=0,s=(l=this.currentWidget.getInline(this.offset,o)).element;o=l.index,s instanceof Fa&&"\v"!==s.text&&(this.offset=n)}else if(!sf.base.isNullOrUndefined(r)){var a=0;this.currentWidget=r.line,this.offset=this.currentWidget.getOffset(r,a),a=0;var l;s=(l=this.currentWidget.getInline(this.offset,a)).element;if(a=l.index,s instanceof va){var d=e.getPreviousValidElement(s);sf.base.isNullOrUndefined(d)||(s=d,this.currentWidget=s.line,this.offset=this.currentWidget.getOffset(s,s.length),s instanceof va&&this.offset--)}}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphInTableCheck=function(){return!(!this.selection.start.paragraph.isInsideTable&&!this.paragraph.isInsideTable||this.selection.start.paragraph.associatedCell===this.paragraph.associatedCell&&!this.selection.isCellSelected(this.selection.start.paragraph.associatedCell,this.selection.start,this))},e.prototype.moveToWordEndInternal=function(e,t){var i=0,r=this.currentWidget.getEndOffset();if(this.selection.isParagraphFirstLine(this.currentWidget)&&(this.currentWidget.children[0]instanceof Va&&(i=1),this.currentWidget.children[1]instanceof Va&&(i=2)),this.offset+i!==r&&this.offset!==r+1||!sf.base.isNullOrUndefined(this.currentWidget.nextLine)){var n=0,o=this.currentWidget.getInline(this.offset,n),s=o.element;n=o.index,this.getNextWordOffset(s,n,e,!1,!1,this,t)}else if(this.offset===r&&0!==e)this.setPositionParagraph(this.currentWidget,r+1);else{var a=this.selection.getNextParagraphBlock(this.currentWidget.paragraph);if(sf.base.isNullOrUndefined(a))return;if(this.currentWidget=a.childWidgets[0],this.offset=this.selection.getStartLineOffset(this.currentWidget),1===e)this.moveToNextParagraphInTableCheck()?this.moveToNextParagraphInTable():this.moveToWordEndInternal(e,t)}if(0!==e){var l=this.owner.selection.start.getHierarchicalIndexInternal(),d=this.getHierarchicalIndexInternal();l!==d&&this.validateForwardFieldSelection(l,d)}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphInTable=function(){var e=this.currentWidget.paragraph,t=e.isInsideTable?this.selection.getNextSelectionCell(e.associatedCell):this.selection.getNextParagraphBlock(e);sf.base.isNullOrUndefined(t)||(this.currentWidget=t.childWidgets[t.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},e.prototype.moveToPreviousParagraph=function(e){var t=e.getStartOffset(this.currentWidget.paragraph);if(this.offset!==t||sf.base.isNullOrUndefined(e.getPreviousParagraphBlock(this.currentWidget.paragraph)))this.offset=e.getStartOffset(this.currentWidget.paragraph);else{var i=e.getPreviousParagraphBlock(this.currentWidget.paragraph);this.currentWidget=i.childWidgets[0],this.offset=e.getStartOffset(this.currentWidget.paragraph)}this.updatePhysicalPosition(!0)},e.prototype.moveToPreviousLine=function(e,t){var i=this.getHierarchicalIndexInternal(),r=e.getLineWidgetParagraph(this.offset,this.currentWidget);this.moveToLineStartInternal(e,!0),this.currentWidget.paragraph.isInsideTable?this.moveUpInTable(e):this.moveBackward();var n=e.getLineWidgetParagraph(this.offset,this.currentWidget),o=e.getLeft(n);if(e.getWidth(n,!0)+o>=t&&r!==n){var s=e.getTop(n),a=new I(t,s);e.updateTextPositionWidget(n,a,this,!0)}var l=this.getHierarchicalIndexInternal();this.validateBackwardFieldSelection(i,l)},e.prototype.moveToLineEndInternal=function(e,t){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var i=e.getLineWidgetParagraph(this.offset,this.currentWidget),r=e.getFirstElementInternal(i),n=this.currentWidget.paragraph.paragraphFormat.bidi;if(this.documentHelper.moveCaretPosition=2,sf.base.isNullOrUndefined(r)&&this.offset===e.getStartLineOffset(this.currentWidget))this.offset=e.getParagraphLength(this.paragraph)+1,this.updatePhysicalPosition(!0);else if(!sf.base.isNullOrUndefined(r)){var o=void 0;if(n&&this.containsRtlText(i)){var s=i.getEndOffset();o=i.getInline(s,0).element}else(o=i.children[i.children.length-1])instanceof Va&&i.children.length>2&&(o=i.children[i.children.length-3]);var a=0;if(a+=o instanceof Fa?o.length:1,this.currentWidget=o.line,a===o.length&&sf.base.isNullOrUndefined(o.nextNode)&&e.isParagraphLastLine(this.currentWidget)){var l=e.getLineLength(this.currentWidget);this.offset=t?l+1:l}else{for(var d=o;!sf.base.isNullOrUndefined(d)&&d.length===a&&d.nextNode instanceof va;){var h=e.getNextValidElement(d.nextNode);if(d!==h&&(d=h,a=0),d instanceof va&&0===d.fieldType&&!sf.base.isNullOrUndefined(d.fieldEnd)){var c=d;sf.base.isNullOrUndefined(c.fieldSeparator)?d=c.fieldEnd:(d=c.fieldSeparator,this.currentWidget=d.line,this.currentWidget!==c.fieldEnd.line||e.hasValidInline(this.currentWidget.paragraph,d,c.fieldEnd)||(d=c.fieldEnd)),this.currentWidget=d.line}d instanceof va&&(a=1)}a===d.length&&sf.base.isNullOrUndefined(d.nextNode)&&a++,!t&&d instanceof ya&&"\v"===d.text&&a--,this.offset=this.currentWidget.getOffset(d,a)}this.updatePhysicalPosition(t)}},e.prototype.moveToNextLine=function(t){var i=this.selection,r=new e(this.owner);r.setPositionInternal(this);var n=this.getHierarchicalIndexInternal();i.getLineWidgetParagraph(this.offset,this.currentWidget);this.moveToLineEndInternal(i,!0);var o=!r.isAtSamePosition(this);(r.setPositionInternal(this),this.currentWidget.paragraph.isInsideTable)?this.moveDownInTable(i):(this.moveNextPosition(),0===this.offset||this.moveForward());var s=i.getLineWidgetParagraph(this.offset,this.currentWidget),a=i.getLeft(s),l=i.getFirstElementInternal(s),d=sf.base.isNullOrUndefined(l)?i.getWidth(s,!0):i.getLeftInternal(s,l,1)-a;if(a<t&&d/2<t-a){var h=i.getTop(s),c=new I(t,h);i.updateTextPositionWidget(s,c,this,!0),i.getWidth(s,!0)<t-a&&this.moveToLineEndInternal(i,!0)}else o&&this.currentWidget.paragraph.isInsideTable&&this.currentWidget===this.owner.selection.start.currentWidget?this.setPositionInternal(r):o||this.moveToLineEndInternal(i,!0);var p=this.getHierarchicalIndexInternal();this.validateForwardFieldSelection(n,p)},e.prototype.moveUpInTable=function(e){var t=!1,i=this.owner.selection.end,r=!this.owner.selection.isEmpty;if(t=i.paragraph.isInsideTable){var n=this.currentWidget.paragraph.associatedCell,o=i.paragraph.associatedCell,s=e.getContainerCellOf(o,n);if(t=s.ownerTable.contains(n)){o=e.getSelectedCell(o,s),n=e.getSelectedCell(n,s);var a=e.containsCell(s,this.currentWidget.paragraph.associatedCell),l=e.isCellSelected(s,this,i);if(l||(l=this.currentWidget.paragraph===e.getFirstParagraph(s)&&this.isAtParagraphStart),(a&&l||!a)&&!sf.base.isNullOrUndefined(n.ownerRow.previousRenderedWidget)){var d=n.ownerRow.previousRenderedWidget,h=e.getFirstCellInRegion(d,s,this.owner.selection.upDownSelectionLength,!0),c=e.getLastParagraph(h);return void this.setPosition(c.childWidgets[0],!0)}if(a&&l&&sf.base.isNullOrUndefined(n.ownerRow.previousRenderedWidget)||!a)if(r){n=n.ownerRow.childWidgets[0];c=e.getFirstParagraph(n);this.setPosition(c.childWidgets[0],!0)}else{n=n.ownerRow.childWidgets[n.ownerRow.childWidgets.length-1];c=e.getLastParagraph(n);this.setPosition(c.childWidgets[0],!1)}}}if(!t){h=e.getContainerCell(this.currentWidget.paragraph.associatedCell);if(r){h=h.ownerRow.childWidgets[0];c=e.getFirstParagraph(h);this.setPosition(c.childWidgets[0],!0)}else{h=h.ownerRow.childWidgets[h.ownerRow.childWidgets.length-1];c=e.getLastParagraph(h);this.setPosition(c.childWidgets[0],!1)}}this.moveBackward()},e.prototype.moveDownInTable=function(e){var t=!1,i=this.owner.selection.isEmpty||this.owner.selection.isForward;if(t=this.owner.selection.start.paragraph.isInsideTable){var r=this.owner.selection.start.paragraph.associatedCell,n=this.currentWidget.paragraph.associatedCell,o=e.getContainerCellOf(r,n);if(t=o.ownerTable.contains(n)){r=e.getSelectedCell(r,o),n=e.getSelectedCell(n,o);var s=e.containsCell(o,this.currentWidget.paragraph.associatedCell),a=e.isCellSelected(o,this.owner.selection.start,this);if((s&&a||!s)&&!sf.base.isNullOrUndefined(n.ownerRow.nextRenderedWidget)){var l=n.ownerRow.nextRenderedWidget,d=e.getLastCellInRegion(l,o,this.owner.selection.upDownSelectionLength,!1),h=e.getLastParagraph(d);return void this.setPosition(h.childWidgets[h.childWidgets.length-1],!1)}if(s&&a&&sf.base.isNullOrUndefined(n.ownerRow.nextRenderedWidget)||!s)if(i){n=n.ownerRow.childWidgets[n.ownerRow.childWidgets.length-1];h=e.getLastParagraph(n);this.setPosition(h.childWidgets[h.childWidgets.length-1],!1)}else{n=n.ownerRow.childWidgets[0];h=e.getFirstParagraph(n);this.setPosition(h.childWidgets[h.childWidgets.length-1],!0)}}}if(!t){d=e.getContainerCell(this.currentWidget.paragraph.associatedCell);if(i){d=d.ownerRow.childWidgets[d.ownerRow.childWidgets.length-1];h=e.getLastParagraph(d);this.setPosition(h.childWidgets[h.childWidgets.length-1],!1)}else if(d.ownerRow.nextRenderedWidget){d=d.ownerRow.nextRenderedWidget.childWidgets[0];h=e.getFirstParagraph(d);this.setPosition(h.childWidgets[h.childWidgets.length-1],!0)}}this.moveForward()},e.prototype.destroy=function(){this.offset=void 0,this.isUpdateLocation=void 0,sf.base.isNullOrUndefined(this.location)||this.location.destroy(),this.location=void 0,this.currentWidget=void 0,this.owner=void 0,this.documentHelper=void 0},e}(),Ml=function(){function e(e,t){this.leftIn=0,this.widthIn=0,this.color="",this.leftIn=e,this.widthIn=t}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.widthIn=void 0,this.leftIn=void 0,this.floatingItems=[],this.floatingItems=void 0},e}(),zl=function(){function e(e,t){this.linkInternal="",this.localRef="",this.opensNewWindow=!1,this.isCrossRefField=!1,this.screenTipText="";var i=t.getFieldCode(e),r=i.toLowerCase();"hyperlink"===r.substring(0,9)?this.parseFieldValues(i.substring(9).trim(),!0):0===r.indexOf("ref ")&&r.match("\\h")?(this.parseFieldValues(i.substring(4).trim(),!1),this.isCrossRefField=!0):0===r.indexOf("pageref")&&this.parseFieldValues(i.substring(7).trim(),!1)}return Object.defineProperty(e.prototype,"screenTip",{get:function(){return this.screenTipText},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"navigationLink",{get:function(){return this.linkInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localReference",{get:function(){return this.localRef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linkType",{get:function(){return this.typeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCrossRef",{get:function(){return this.isCrossRefField},enumerable:!0,configurable:!0}),e.prototype.parseFieldValues=function(e,t){var i=e.split("\\o ");2===i.length&&(this.screenTipText=this.parseFieldValue(i[1],'"'===i[1]?'"':void 0,t),this.screenTipText=this.screenTipText.substring(0,this.screenTipText.length-1),e=i[0],i=void 0),i=e.split(" ");var r=!1,n=!0;if(t)for(var o=0;o<i.length;o++){var s=i[o];s.length<1||("\\t"===s||"\\l"===s?r=!0:"\\n"===s?this.opensNewWindow=!0:(s=this.parseFieldValue(s,'"'===s[0]?'"':void 0,t),r?(this.localRef=s,r=!1,n=!1):this.linkInternal=n?this.parseFieldValue(e,'"'===e[0]?'"':void 0,t):s))}else this.localRef=i[0];this.setLinkType()},e.prototype.parseFieldValue=function(e,t,i){e=i?e.substring(1):e.substring(0);var r=t?e.indexOf(t):-1;return r<0&&(r=e.length),e.substring(0,r).trim()},e.prototype.setLinkType=function(){sf.base.isNullOrUndefined(this.linkInternal)||this.linkInternal.length<1?this.typeInternal="Bookmark":("www."===this.linkInternal.substring(0,4)?this.linkInternal="http://"+this.navigationLink:"@"===this.linkInternal[0]&&(this.linkInternal="mailto:"+this.navigationLink),"http://"===this.linkInternal.substring(0,7)||"https://"===this.linkInternal.substring(0,8)?this.typeInternal="WebPage":"mailto:"===this.linkInternal.substring(0,7)?this.typeInternal="Email":this.typeInternal="File")},e.prototype.destroy=function(){this.linkInternal=void 0,this.localRef=void 0,this.typeInternal=void 0,this.opensNewWindow=void 0,this.screenTipText=void 0},e}(),Dl=function(){function e(e){this.width=0,this.height=0,this.width=e.width,this.height=e.height,this.alternatetext=e.alternateText}return e.prototype.destroy=function(){this.width=void 0,this.height=void 0,this.alternatetext=void 0},e}(),Vl=function(){function t(e){var t=this;this.upDownSelectionLength=0,this.isSkipLayouting=!1,this.isImageSelected=!1,this.contextTypeInternal=void 0,this.caret=void 0,this.isRetrieveFormatting=!1,this.skipFormatRetrieval=!1,this.isModifyingSelectionInternally=!1,this.isMoveDownOrMoveUp=!1,this.isViewPasteOptions=!1,this.skipEditRangeRetrieval=!1,this.selectedWidgets=void 0,this.isHighlightEditRegionIn=!1,this.isHighlightFormFields=!1,this.isHightlightEditRegionInternal=!1,this.isCurrentUser=!1,this.isHighlightNext=!1,this.isWebLayout=!1,this.editRegionHighlighters=void 0,this.formFieldHighlighters=void 0,this.isSelectList=!1,this.previousSelectedFormField=void 0,this.isFormatUpdated=!1,this.isCellPrevSelected=!1,this.currentFormField=void 0,this.pasteOptions=function(e){"Keep source formatting"===e?t.owner.editor.applyPasteOptions("KeepSourceFormatting"):"Match destination formatting"===e?t.owner.editor.applyPasteOptions("MergeWithExistingFormatting"):t.owner.editor.applyPasteOptions("KeepTextOnly")},this.hideCaret=function(){sf.base.isNullOrUndefined(t.caret)||(t.caret.style.display="none")},this.owner=e,this.documentHelper=this.owner.documentHelper,this.start=new Al(this.owner),this.end=new Al(this.owner),this.selectedWidgets=new a,this.characterFormatIn=new kl(this),this.paragraphFormatIn=new Nl(this,this.documentHelper),this.sectionFormatIn=new Tl(this),this.rowFormatIn=new Rl(this),this.cellFormatIn=new El(this),this.tableFormatIn=new Hl(this),this.imageFormatInternal=new Ul(this),this.editRangeCollection=[],this.editRegionHighlighters=new a,this.formFieldHighlighters=new a}return Object.defineProperty(t.prototype,"isHighlightEditRegion",{get:function(){return this.isHighlightEditRegionIn},set:function(e){this.isHighlightEditRegionIn=e,this.onHighlight()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"htmlWriter",{get:function(){return sf.base.isNullOrUndefined(this.htmlWriterIn)&&(this.htmlWriterIn=new Ll),this.htmlWriterIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){if(!sf.base.isNullOrUndefined(this.owner)&&!sf.base.isNullOrUndefined(this.viewer))return sf.base.isNullOrUndefined(this.startInternal)&&(this.startInternal=this.owner.documentStart),this.startInternal},set:function(e){this.startInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"characterFormat",{get:function(){return this.characterFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paragraphFormat",{get:function(){return this.paragraphFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sectionFormat",{get:function(){return this.sectionFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tableFormat",{get:function(){return this.tableFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cellFormat",{get:function(){return this.cellFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowFormat",{get:function(){return this.rowFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageFormat",{get:function(){return this.imageFormatInternal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.endInternal},set:function(e){this.endInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startPage",{get:function(){return!this.owner.isDocumentLoaded||sf.base.isNullOrUndefined(this.viewer)||this.viewer instanceof $s||sf.base.isNullOrUndefined(this.documentHelper.selectionStartPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionStartPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endPage",{get:function(){return!this.owner.isDocumentLoaded||sf.base.isNullOrUndefined(this.viewer)||this.viewer instanceof $s||sf.base.isNullOrUndefined(this.documentHelper.selectionEndPage)?1:this.documentHelper.pages.indexOf(this.documentHelper.selectionEndPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isForward",{get:function(){return this.start.isExistBefore(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isinFootnote",{get:function(){var e=this.getContainerWidget(this.start.paragraph);return e instanceof ha&&"Footnote"===e.footNoteType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isinEndnote",{get:function(){var e=this.getContainerWidget(this.start.paragraph);return e instanceof ha&&"Endnote"===e.footNoteType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return!!sf.base.isNullOrUndefined(this.start)||this.start.isAtSamePosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.start)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endOffset",{get:function(){return this.getHierarchicalIndexByPosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInShape",{get:function(){var e=this.start.paragraph.containerWidget;do{if(e instanceof Aa)return!0;e&&(e=e.containerWidget)}while(e);return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.getText(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contextType",{get:function(){return this.contextTypeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bookmarks",{get:function(){return this.getSelBookmarks(!1)},enumerable:!0,configurable:!0}),t.prototype.getBookmarks=function(e){return this.getSelBookmarks(e)},Object.defineProperty(t.prototype,"isCleared",{get:function(){return sf.base.isNullOrUndefined(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isInField",{get:function(){return!sf.base.isNullOrUndefined(this.getHyperlinkField(!0))},enumerable:!0,configurable:!0}),t.prototype.getFieldInfo=function(){var e=this.getHyperlinkField(!0);if(!sf.base.isNullOrUndefined(e))return{code:this.getFieldCode(e),result:this.owner.editorModule.getFieldResultText(e)}},t.prototype.getSelBookmarks=function(e){var t,i,r=[],n=this.documentHelper.bookmarks,o=this.start,s=this.end;this.isForward||(o=this.end,s=this.start);for(var a=!1,l=this.getSelectedCells(),d=0;d<n.length;d++)if(e||!e&&0!==n.keys[d].indexOf("_")){if(i=(t=n.get(n.keys[d])).reference,sf.base.isNullOrUndefined(i))continue;var h=this.getElementPosition(t).startPosition,c=this.getElementPosition(i,!0).startPosition;if(h.paragraph.isInsideTable||c.paragraph.isInsideTable)if(l.length>0){if(l.indexOf(h.paragraph.associatedCell)>=0||l.indexOf(c.paragraph.associatedCell)>=0)a=!0;else if(a=!1,l.indexOf(h.paragraph.associatedCell)<0||l.indexOf(c.paragraph.associatedCell)<0){var p=s.paragraph.isInsideTable&&s.paragraph.associatedCell,g=c.paragraph.associatedCell;if(p&&g&&p.ownerTable.equals(g.ownerTable)&&!(p.ownerTable&&l.indexOf(this.getCellInTable(p.ownerTable,g))>=0))continue}}else a=!1;else a=!1;((o.isExistAfter(h)||o.isAtSamePosition(h))&&(s.isExistBefore(c)||s.isAtSamePosition(c))||(h.isExistAfter(o)||h.isAtSamePosition(o))&&(c.isExistBefore(s)||c.isAtSamePosition(s))||h.isExistAfter(o)&&h.isExistBefore(s)&&(s.isExistAfter(c)||s.isExistBefore(c))||c.isExistBefore(s)&&c.isExistAfter(o)&&(o.isExistBefore(h)||o.isExistAfter(h))||a)&&r.push(t.name)}return r},Object.defineProperty(t.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),t.prototype.getModuleName=function(){return"Selection"},t.prototype.checkLayout=function(){"Continuous"===this.owner.layoutType&&(this.isWebLayout=!0,this.documentHelper.isHeaderFooter=!0,this.owner.layoutType="Pages",this.owner.viewer.destroy(),this.owner.viewer=new Qs(this.owner),this.owner.editor.layoutWholeDocument())},t.prototype.goToHeader=function(){this.checkLayout(),this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget,this.start.paragraph.bodyWidget.page),this.isWebLayout=!1},t.prototype.goToFooter=function(){this.checkLayout(),this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget,this.start.paragraph.bodyWidget.page),this.isWebLayout=!1},t.prototype.closeHeaderFooter=function(){this.disableHeaderFooter(),this.documentHelper.isHeaderFooter&&"Pages"===this.owner.layoutType&&(this.owner.layoutType="Continuous",this.documentHelper.isHeaderFooter=!1)},t.prototype.goToPage=function(e){if(this.owner.scrollToPage(e),e>=1&&e<=this.owner.documentHelper.pages.length){var t=this.owner.documentHelper.pages[e-1];this.updateTextPositionForBlockContainer(t.bodyWidgets[0])}},t.prototype.selectTable=function(){this.owner.enableSelection&&this.selectTableInternal()},t.prototype.selectRow=function(){this.owner.enableSelection&&this.selectTableRow()},t.prototype.selectColumn=function(){this.owner.enableSelection&&this.selectColumnInternal()},t.prototype.selectCell=function(){this.owner.enableSelection&&this.selectTableCell()},t.prototype.select=function(e,t){if("string"==typeof e){var i=this.getTextPosBasedOnLogicalIndex(e),r=this.getTextPosBasedOnLogicalIndex(t);this.selectPosition(i,r)}else{var n=new I(e.x,e.y),o=this.viewer.findFocusedPage(n,!0);e.extend?this.moveTextPosition(o,this.end):this.documentHelper.updateTextPositionForSelection(o,1)}},t.prototype.selectByHierarchicalIndex=function(e,t){var i=this.getTextPosBasedOnLogicalIndex(e),r=this.getTextPosBasedOnLogicalIndex(t);this.selectPosition(i,r)},t.prototype.selectField=function(e){!this.isInField&&sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e)&&(e=this.getHyperlinkField(!0)),this.selectFieldInternal(e))},t.prototype.selectFieldInternal=function(e,t,i){if(e){var r=this.documentHelper.isFormFillProtectedMode||i,n=e.fieldEnd;r&&(e=e.fieldSeparator);var o=e.line.getOffset(e,r?1:0),s=new Al(this.owner);s.setPositionParagraph(e.line,o),e.nextNode instanceof Na&&!r&&e.nextElement.reference&&(n=e.nextElement.reference);var a=n.line.getOffset(n,r?0:1),l=new Al(this.owner);l.setPositionParagraph(n.line,a),this.documentHelper.selection.selectRange(s,l),i||this.triggerFormFillEvent(t)}},t.prototype.selectShape=function(e){if(e){var t=e.line.getOffset(e,0),i=new Al(this.owner);i.setPositionParagraph(e.line,t);var r=e.line.getOffset(e,1),n=new Al(this.owner);n.setPositionParagraph(e.line,r),this.documentHelper.selection.selectRange(i,n)}},t.prototype.toggleBold=function(){this.owner.editorModule&&this.owner.editorModule.toggleBold()},t.prototype.toggleItalic=function(){this.owner.editorModule&&this.owner.editorModule.toggleItalic()},t.prototype.toggleAllCaps=function(){this.owner.editorModule&&this.owner.editorModule.toggleAllCaps()},t.prototype.toggleUnderline=function(e){this.owner.editor&&this.owner.editor.toggleUnderline(e)},t.prototype.toggleStrikethrough=function(e){this.owner.editor&&this.owner.editor.toggleStrikethrough(e)},t.prototype.toggleHighlightColor=function(e){this.owner.editor&&this.owner.editor.toggleHighlightColor(e)},t.prototype.toggleSubscript=function(){this.owner.editor&&this.owner.editor.toggleSubscript()},t.prototype.toggleSuperscript=function(){this.owner.editor&&this.owner.editor.toggleSuperscript()},t.prototype.toggleTextAlignment=function(e){this.owner.editor&&this.owner.editor.toggleTextAlignment(e)},t.prototype.increaseIndent=function(){this.owner.editor&&this.owner.editor.increaseIndent()},t.prototype.decreaseIndent=function(){this.owner.editor&&this.owner.editor.decreaseIndent()},t.prototype.navigateHyperlink=function(){var e=this.getHyperlinkField();e&&this.fireRequestNavigate(e)},t.prototype.fireRequestNavigate=function(e){var t=this.getFieldCode(e);if(0!==t.toLowerCase().indexOf("ref ")||t.match("\\h")){var i=new zl(e,this),r={isHandled:!1,navigationLink:i.navigationLink,linkType:i.linkType,localReference:i.localReference};this.owner.dotNetRef.invokeMethodAsync("RequestNavigate",r)}},t.prototype.copyHyperlink=function(){var e=this.getHyperlinkField(),t=this.getLinkText(e,!0);this.copyToClipboard(t)},t.prototype.isHideSelection=function(e){var t=e.bodyWidget,i=t.sectionFormat,r=i.pageHeight-i.footerDistance,n=t.page.boundingRectangle.height/100*40;return this.contextType.indexOf("Footer")>=0&&e.y+e.height>x.convertPointToPixel(r)||this.contextType.indexOf("Header")>=0&&e.y+e.height>n},t.prototype.highlightSelection=function(e,t){if(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.hideImageResizer(),this.isEmpty){if(!this.isInShape&&this.isHideSelection(this.start.paragraph))return void this.hideCaret();this.isInShape&&this.showResizerForShape(),this.updateCaretPosition()}else this.isForward?this.highlightSelectedContent(this.start,this.end):this.highlightSelectedContent(this.end,this.start),this.documentHelper.isComposingIME&&this.updateCaretPosition();this.documentHelper.updateTouchMarkPosition(),e&&this.documentHelper.scrollToPosition(this.start,this.end,void 0,t)},t.prototype.createHighlightBorder=function(e,t,i,r,n){t<0&&(t=0);var o=e.paragraph,s=[];if(o.floatingElements.length>0)for(var a=0;a<o.floatingElements.length;a++){var l=o.floatingElements[a];if(l.line===e){var d=this.start,h=this.end;this.isForward||(d=this.end,h=this.start);var c=l.line.getOffset(l,0);(d.currentWidget!==e&&h.currentWidget!==e||d.currentWidget===e&&d.offset<=c&&(h.currentWidget===e&&h.offset>=c+1||h.currentWidget!==e)||d.currentWidget!==e&&h.currentWidget===e&&h.offset>=c)&&s.push(l)}}var p=this.getPage(e.paragraph),g=(e.height,this.selectedWidgets),f=void 0,u=void 0;if(this.isHightlightEditRegionInternal)this.addEditRegionHighlight(e,i,t);else if(this.isHighlightFormFields)this.addFormFieldHighlight(e,i,t);else{if(g.containsKey(e))g.get(e)instanceof Ml?(f=g.get(e),n&&(g.remove(e),u=[],g.add(e,u))):u=g.get(e);else if(n)u=[],g.add(e,u);else{var m=this.getWrapPosition(e,o);if(m.length>0){var y=this.splitSelectionHighlightPosition(i,t,m);if(y.length>0)return y[0].floatingItems=s,g.add(e,y),void this.renderHighlight(p,e,y,r,s);(f=new Ml(i,t)).floatingItems=s,g.add(e,f)}else(f=new Ml(i,t)).floatingItems=s,g.add(e,f)}void 0===f&&((f=new Ml(i,t)).floatingItems=s,g.add(e,f)),this.renderHighlight(p,e,[f],r,s),n&&u.push(f)}},t.prototype.renderHighlight=function(e,t,i,r,n){var o=this.owner.documentHelper,s=this.getPageTop(e),a=e.boundingRectangle.x,l=t.height;if(this.viewer.containerTop<=s||s<this.viewer.containerTop+o.selectionCanvas.height){var d=o.zoomFactor;this.clipSelection(e,s);for(var h=0;h<i.length;h++){var c=i[h],p=c.left,g=c.width;this.documentHelper.isComposingIME?this.renderDashLine(o.selectionContext,e,t,a+p*d-this.viewer.containerLeft,r,g*d,l):(this.documentHelper.selectionContext.fillStyle="gray",o.selectionContext.globalAlpha=.4,o.selectionContext.fillRect(a+p*d-this.viewer.containerLeft,s+r*d-this.viewer.containerTop,g*d,l*d))}if(n.length>0)for(var f=0;f<n.length;f++){p=n[f].x;var u=n[f].y,m=n[f].width,y=n[f].height;o.selectionContext.fillRect(a+p*d-this.viewer.containerLeft,s+u*d-this.viewer.containerTop,m*d,y*d)}o.selectionContext.restore()}},t.prototype.getWrapPosition=function(e,t){var i=t.bodyWidget;if(!sf.base.isNullOrUndefined(i)&&i.floatingElements.length>0&&e.children.length>0){for(var r=this.getLeftInternal(e,e.children[0],0),n=0,o=[],s=!1,a=0;a<e.children.length;a++){var l=e.children[a];if(!(l instanceof Ba&&"Inline"!==l.textWrappingStyle)){if(l.padding.left>0){1===o.length&&0===o[0].end&&(o[0].end=o[0].start-t.x,o[0].start=t.x,r=t.x);var d={};d.start=r+n,d.end=0,s&&(d.end=r+n+l.padding.left),o.push(d)}n+=l.padding.left+l.width,l instanceof Fa&&(s=!0)}}return 1===o.length&&0===o[0].end&&(o[0].end=o[0].start-t.x,o[0].start=t.x),o}return[]},t.prototype.splitSelectionHighlightPosition=function(e,t,i){for(var r=[],n=0;n<i.length;n++){var o=i[n];e<o.start&&e+t<o.end||e>o.end||(e<o.start&&e+t>o.end?(r.push(new Ml(e,o.start-e)),t=e+t-o.end,e=o.end):e===o.start&&(e+=o.end,t-=o.end),n===i.length-1&&r.push(new Ml(e,t)))}return r},t.prototype.addEditRegionHighlight=function(e,t,i){var r=void 0,n=this.editRegionHighlighters;n.containsKey(e)?r=n.get(e):(r=[],n.add(e,r));var o=new Ml(t,i);return this.isCurrentUser&&(o.color=""!==this.owner.userColor?this.owner.userColor:"#FFFF00"),r.push(o),o},t.prototype.addFormFieldHighlight=function(e,t,i){var r=void 0,n=this.formFieldHighlighters;n.containsKey(e)?r=n.get(e):(r=[],n.add(e,r));var o=new Ml(t,i);r.push(o)},t.prototype.createHighlightBorderInsideTable=function(e){var t=this.getPage(e),i=void 0,r=e.x-e.margin.left+e.leftBorderWidth,n=e.width+e.margin.left+e.margin.right-e.leftBorderWidth-e.rightBorderWidth,o=e.y,s=e.height,a=this.getPageTop(t),l=t.boundingRectangle.x,d=this.documentHelper.isPageInVisibleBound(t,a),h=this.selectedWidgets;if(this.isHightlightEditRegionInternal||this.isHighlightFormFields||(h.containsKey(e)&&h.get(e)instanceof Ml?(i=h.get(e),d&&this.documentHelper.selectionContext.clearRect(l+i.left*this.documentHelper.zoomFactor-this.viewer.containerLeft,a+o*this.documentHelper.zoomFactor-this.viewer.containerTop,i.width*this.documentHelper.zoomFactor,s*this.documentHelper.zoomFactor)):(i=new Ml(r,n),h.containsKey(e)&&h.remove(h.get(e)),h.add(e,i))),d){this.documentHelper.selectionContext.fillStyle="gray",this.documentHelper.selectionContext.globalAlpha=.4;var c=this.documentHelper.zoomFactor;this.clipSelection(t,a),this.documentHelper.selectionContext.fillRect(l+r*c-this.viewer.containerLeft,a+o*c-this.viewer.containerTop,n*c,s*c),this.documentHelper.selectionContext.restore()}},t.prototype.clipSelection=function(e,t){var i,r,n=this.owner.documentHelper;this.viewer instanceof $s&&this.documentHelper.zoomFactor<1?(i=e.boundingRectangle.width/this.documentHelper.zoomFactor,r=e.boundingRectangle.height/this.documentHelper.zoomFactor):(i=e.boundingRectangle.width*this.documentHelper.zoomFactor,r=e.boundingRectangle.height*this.documentHelper.zoomFactor);var o=e.boundingRectangle.x;n.selectionContext.beginPath(),n.selectionContext.save(),n.selectionContext.rect(o-this.viewer.containerLeft,t-this.viewer.containerTop,i,r),n.selectionContext.clip()},t.prototype.addSelectionHighlight=function(e,t,i,r){if(this.selectedWidgets.containsKey(t)){var n=this.documentHelper.render.getScaledValue(t.height),o=this.selectedWidgets.get(t),s=void 0;if(o instanceof Ml?(s=[]).push(o):s=o,!sf.base.isNullOrUndefined(s))for(var a=0;a<s.length;a++){var l=s[a],d=this.documentHelper.render.getScaledValue(s[a].width),h=this.documentHelper.render.getScaledValue(s[a].left,1);if(sf.base.isNullOrUndefined(r)&&(r=this.owner.selection.getPage(t.paragraph)),this.owner.selection.clipSelection(r,this.owner.selection.getPageTop(r)),this.documentHelper.isComposingIME)this.renderDashLine(e,r,t,h,i,d,n);else if(e.globalAlpha=.4,e.fillStyle="gray",e.fillRect(h,this.documentHelper.render.getScaledValue(i,2),d,n),l.floatingItems&&l.floatingItems.length>0)for(var c=0;c<l.floatingItems.length;c++){var p=l.floatingItems[c];d=this.documentHelper.render.getScaledValue(p.width),h=this.documentHelper.render.getScaledValue(p.x,1);var g=this.documentHelper.render.getScaledValue(p.y,2);e.fillRect(h,g,d,this.documentHelper.render.getScaledValue(p.height))}e.restore()}}},t.prototype.renderDashLine=function(e,t,i,r,n,o,s){var a=this.characterFormat.fontColor,l=a?x.getColor(a):"#000000";e.globalAlpha=1;var d=this.owner.editor.copyInsertFormat(new T,!1),h=this.documentHelper.textHelper.getHeight(d),c=this.getPageTop(t),p=h.Height-h.BaselineOffset;n=this.documentHelper.render.getUnderlineYPosition(i)+n+4-p,this.documentHelper.render.renderDashLine(e,r,c-this.viewer.containerTop+n*this.documentHelper.zoomFactor,o,l,!0)},t.prototype.addSelectionHighlightTable=function(e,t,i){if(this.selectedWidgets.containsKey(t)){var r=this.selectedWidgets.get(t),n=void 0;if(r instanceof Ml?(n=[]).push(r):n=r,!sf.base.isNullOrUndefined(n))for(var o=0;o<n.length;o++){var s=this.documentHelper.render.getScaledValue(n[o].left,1),a=this.documentHelper.render.getScaledValue(t.y,2),l=this.documentHelper.render.getScaledValue(n[o].width),d=this.documentHelper.render.getScaledValue(t.height);e.fillStyle="gray",sf.base.isNullOrUndefined(i)&&(i=this.owner.selection.getPage(t)),this.owner.selection.clipSelection(i,this.owner.selection.getPageTop(i)),e.fillRect(s,a,l,d),e.restore()}}},t.prototype.removeSelectionHighlight=function(e){var t=0,i=0,r=0,n=0,o=void 0;if(e instanceof ma){var s=e,a=s.paragraph;if(o=sf.base.isNullOrUndefined(a)?void 0:this.getPage(s.paragraph),sf.base.isNullOrUndefined(o))return;i=this.getTop(s),n=s.height}else if(e instanceof ua){if(o=sf.base.isNullOrUndefined(e)?void 0:this.getPage(e),sf.base.isNullOrUndefined(o))return;i=e.y,n=e.height}if(!sf.base.isNullOrUndefined(o)){var l=this.selectedWidgets.get(e),d=void 0;if(l instanceof Ml?(d=[]).push(l):d=l,!sf.base.isNullOrUndefined(d))for(var h=0;h<d.length;h++){r=d[h].width,t=d[h].left;var c=o.boundingRectangle,p=this.documentHelper.pages.indexOf(o),g=this.viewer.pageGap,f=(c.y-g*(p+1))*this.documentHelper.zoomFactor+g*(p+1),u=c.x,m=this.documentHelper.zoomFactor;(this.viewer.containerTop<=f||f<this.viewer.containerTop+this.documentHelper.selectionCanvas.height)&&this.documentHelper.selectionContext.clearRect(u+t*m-this.viewer.containerLeft-.5,f+i*m-this.viewer.containerTop-.5,r*m+.5,n*m+.5)}}},t.prototype.selectCurrentWord=function(e){var t=this.start.clone(),i=this.end.clone();this.selectCurrentWordRange(t,i,e||!1),this.selectRange(t,i)},t.prototype.selectParagraph=function(){sf.base.isNullOrUndefined(this.start)||(this.start.paragraphStartInternal(this,!1),this.end.moveToParagraphEndInternal(this,!1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.selectLine=function(){sf.base.isNullOrUndefined(this.start)||(this.moveToLineStart(),this.handleShiftEndKey())},t.prototype.moveToDocumentStart=function(){this.handleControlHomeKey()},t.prototype.moveToDocumentEnd=function(){this.handleControlEndKey()},t.prototype.moveToParagraphStart=function(){this.isForward?(this.start.paragraphStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.paragraphStartInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.fireSelectionChanged(!0)},t.prototype.moveToParagraphEnd=function(){this.isForward?(this.start.moveToParagraphEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.end.location.x):(this.end.moveToParagraphEndInternal(this,!1),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.fireSelectionChanged(!0)},t.prototype.moveToNextLine=function(){this.moveDown()},t.prototype.moveToPreviousLine=function(){this.moveUp()},t.prototype.moveToNextCharacter=function(){this.handleRightKey()},t.prototype.moveToPreviousCharacter=function(){this.handleLeftKey()},t.prototype.selectCurrentWordRange=function(e,t,i){if(!sf.base.isNullOrUndefined(e)){if(e.offset>0){var r=e.clone(),n=0,o=e.currentWidget.getInline(e.offset,n),s=o.element;n=o.index,!sf.base.isNullOrUndefined(s)&&s instanceof va&&1===s.fieldType?e.offset>2&&(!sf.base.isNullOrUndefined(s.fieldSeparator)||sf.base.isNullOrUndefined(s.fieldBegin))?(r.setPositionParagraph(r.currentWidget,e.offset-2),r.moveToWordEndInternal(0,!1),r.paragraph===e.paragraph&&r.offset===e.offset-1||e.moveToWordStartInternal(2)):e.offset>3&&sf.base.isNullOrUndefined(s.fieldSeparator)&&(r.setPositionParagraph(r.currentWidget,e.offset-3),r.moveToWordEndInternal(0,!1),r.paragraph===e.paragraph&&r.offset===e.offset||e.moveToWordStartInternal(2)):(r.setPositionParagraph(r.currentWidget,e.offset-1),r.moveToWordEndInternal(0,!1),r.paragraph===e.paragraph&&r.offset===e.offset||e.moveToWordStartInternal(2))}t.moveToWordEndInternal(2,i)}},t.prototype.extendToParagraphStart=function(){sf.base.isNullOrUndefined(this.start)||(this.end.paragraphStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToParagraphEnd=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToParagraphEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.moveNextPosition=function(){if(!sf.base.isNullOrUndefined(this.start)&&(this.isEmpty&&(this.start.moveNextPosition(),this.end.setPositionInternal(this.start)),this.updateForwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode)){var e=this.getCurrentFormField();e||(e=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!0,e))}},t.prototype.moveToNextParagraph=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToNextParagraphStartInternal(),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.nextFootnote=function(){if(this.isinFootnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.footnoteCollection.length,this.documentHelper.footnoteCollection.indexOf(e)),i=this.documentHelper.footnoteCollection[t+1];sf.base.isNullOrUndefined(i)&&(i=e);for(var r=this.start.clone(),n=this.end.clone(),o=0;o<this.documentHelper.pages.length;o++)for(var s=this.documentHelper.pages[o].footnoteWidget,a=1;a<s.bodyWidgets.length;a++){s.bodyWidgets[a].footNoteReference===i&&(r.setPositionParagraph(s.bodyWidgets[a].childWidgets[0].childWidgets[0],0),n.setPositionInternal(r),this.selectRange(r,n))}}},t.prototype.previousFootnote=function(){if(this.isinFootnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.footnoteCollection.length,this.documentHelper.footnoteCollection.indexOf(e)),i=this.documentHelper.footnoteCollection[t-1];sf.base.isNullOrUndefined(i)&&(i=e);for(var r=this.start.clone(),n=this.end.clone(),o=0;o<this.documentHelper.pages.length;o++)for(var s=this.documentHelper.pages[o].footnoteWidget,a=1;a<s.bodyWidgets.length;a++){s.bodyWidgets[a].footNoteReference===i&&(r.setPositionParagraph(s.bodyWidgets[a].childWidgets[0].childWidgets[0],0),n.setPositionInternal(r),this.selectRange(r,n))}}},t.prototype.nextEndnote=function(){if(this.isinEndnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.endnoteCollection.length,this.documentHelper.endnoteCollection.indexOf(e)),i=this.documentHelper.endnoteCollection[t+1];sf.base.isNullOrUndefined(i)&&(i=e);for(var r=this.start.clone(),n=this.end.clone(),o=this.documentHelper.pages[this.endPage-1].endnoteWidget,s=0;s<o.childWidgets.length;s++){o.bodyWidgets[s].footNoteReference===i&&(r.setPositionParagraph(o.bodyWidgets[s].childWidgets[0].childWidgets[0],0),n.setPositionInternal(r),this.selectRange(r,n))}}},t.prototype.previousEndnote=function(){if(this.isinEndnote){var e=this.start.paragraph.bodyWidget.footNoteReference,t=(this.documentHelper.endnoteCollection.length,this.documentHelper.endnoteCollection.indexOf(e)),i=this.documentHelper.endnoteCollection[t-1];sf.base.isNullOrUndefined(i)&&(i=e);for(var r=this.start.clone(),n=this.end.clone(),o=this.documentHelper.pages[this.endPage-1].endnoteWidget,s=0;s<o.childWidgets.length;s++){o.bodyWidgets[s].footNoteReference===i&&(r.setPositionParagraph(o.bodyWidgets[s].childWidgets[0].childWidgets[0],0),n.setPositionInternal(r),this.selectRange(r,n))}}},t.prototype.movePreviousPosition=function(){if(!sf.base.isNullOrUndefined(this.start)&&(this.isEmpty&&(this.start.movePreviousPosition(),this.end.setPositionInternal(this.start)),this.updateBackwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0),this.documentHelper.isFormFillProtectedMode)){var e=this.getCurrentFormField();e||(e=this.getFormFieldInFormFillMode(),this.selectPrevNextFormField(!1,e))}},t.prototype.moveToPreviousParagraph=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToPreviousParagraph(this),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToPreviousLine=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToPreviousLine(this,this.upDownSelectionLength),this.fireSelectionChanged(!0))},t.prototype.extendToLineEnd=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToLineEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToLineStart=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToLineStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.start.paragraph===this.end.paragraph&&this.start.offset===this.start.currentWidget.getEndOffset()&&this.isParagraphLastLine(this.start.currentWidget)&&this.isParagraphFirstLine(this.end.currentWidget)&&this.start.setPositionParagraph(this.start.currentWidget,this.start.offset+1),this.fireSelectionChanged(!0))},t.prototype.moveUp=function(){if(this.documentHelper.isFormFillProtectedMode)this.selectPrevNextFormField(!1);else if(!sf.base.isNullOrUndefined(this.start)){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x;var e=this.start.currentWidget.paragraph.bodyWidget.columnIndex,t=this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns,i=this.start.currentWidget.paragraph.bodyWidget.index;this.start.moveUp(this,this.upDownSelectionLength),t=this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1;var r=this.start.currentWidget.paragraph.bodyWidget.columnIndex;if(t)if(e===r||i!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)this.end.setPositionInternal(this.start);else do{if(sf.base.isNullOrUndefined(this.start.currentWidget.paragraph.previousRenderedWidget)||i!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)break;if(i!==this.start.currentWidget.paragraph.bodyWidget.index&&this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1&&e>this.start.currentWidget.paragraph.bodyWidget.columnIndex)break;this.start.moveUp(this,this.upDownSelectionLength)}while(e!==this.start.currentWidget.paragraph.bodyWidget.columnIndex);this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0)}},t.prototype.moveDown=function(){if(this.documentHelper.isFormFillProtectedMode)this.selectPrevNextFormField(!0);else if(!sf.base.isNullOrUndefined(this.start)){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x;var e=this.start.currentWidget.paragraph.bodyWidget.columnIndex,t=this.start.currentWidget.paragraph.bodyWidget.index,i=this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1;this.start.moveDown(this,this.upDownSelectionLength);var r=this.start.currentWidget.paragraph.bodyWidget.columnIndex;if(i)if(e===r||t!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)this.end.setPositionInternal(this.start);else do{if(sf.base.isNullOrUndefined(this.start.currentWidget.paragraph.nextRenderedWidget)||t!==this.start.currentWidget.paragraph.bodyWidget.index&&1===this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns)break;if(t!==this.start.currentWidget.paragraph.bodyWidget.index&&this.start.currentWidget.paragraph.bodyWidget.sectionFormat.numberOfColumns>1&&this.documentHelper.layout.getBodyWidget(this.start.currentWidget.paragraph.bodyWidget,!1)===this.start.currentWidget.paragraph.bodyWidget)break;this.start.moveDown(this,this.upDownSelectionLength)}while(e!==this.start.currentWidget.paragraph.bodyWidget.columnIndex);this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0)}},t.prototype.updateForwardSelection=function(){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start))},t.prototype.updateBackwardSelection=function(){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end))},t.prototype.getFirstBlockInFirstCell=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[0];if(t.childWidgets.length>0){var i=t.childWidgets[0];if(0===i.childWidgets.length)return;return i.childWidgets[0]}}},t.prototype.getFirstCellInRegion=function(e,t,i,r){var n=this.getCellLeft(e,t),o=n+t.cellFormat.cellWidth,s=!0;if(n<=i&&i<o)for(var a=0;a<e.childWidgets.length;a++){var l=this.getCellLeft(e,e.childWidgets[a]);if(x.round(n,2)<=x.round(l,2)&&x.round(l,2)<x.round(o,2))return s=!1,e.childWidgets[a]}else for(var d=0;d<e.childWidgets.length;d++){var h=this.getCellLeft(e,e.childWidgets[d]);if(h<=i&&h+e.childWidgets[d].cellFormat.cellWidth>i)return s=!1,e.childWidgets[d]}if(s){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)&&r){var c=e.previousRenderedWidget;return this.getFirstCellInRegion(c,t,i,r)}if(!sf.base.isNullOrUndefined(e.nextRenderedWidget)&&!r)return this.getFirstCellInRegion(e.nextRenderedWidget,t,i,r)}return e.childWidgets[0]},t.prototype.getFirstParagraph=function(e){for(;e.previousSplitWidget;)e=e.previousSplitWidget;var t=e.firstChild;return this.documentHelper.getFirstParagraphBlock(t)},t.prototype.getLastBlockInLastCell=function(e){if(e.childWidgets.length>0){for(var t=e.childWidgets[e.childWidgets.length-1],i=t.childWidgets[t.childWidgets.length-1];0===i.childWidgets.length&&!sf.base.isNullOrUndefined(i.previousSplitWidget);)i=i.previousSplitWidget;return i.childWidgets[i.childWidgets.length-1]}},t.prototype.moveToLineStart=function(){sf.base.isNullOrUndefined(this.start)||(this.updateBackwardSelection(),this.start.moveToLineStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},t.prototype.moveToLineEnd=function(){sf.base.isNullOrUndefined(this.start)||(this.updateForwardSelection(),this.start.moveToLineEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},t.prototype.getPageTop=function(e){return(e.boundingRectangle.y-this.viewer.pageGap*(this.documentHelper.pages.indexOf(e)+1))*this.documentHelper.zoomFactor+this.viewer.pageGap*(this.documentHelper.pages.indexOf(e)+1)},t.prototype.moveTextPosition=function(e,t,i){if(!sf.base.isNullOrUndefined(this.start)){var r=this.documentHelper.getLineWidgetInternal(e,!0);sf.base.isNullOrUndefined(r)||this.updateTextPositionWidget(r,e,t,!0),this.upDownSelectionLength=t.location.x;var n=this.start.getHierarchicalIndexInternal(),o=this.end.getHierarchicalIndexInternal();n===o||i||(Al.isForwardSelection(n,o)?t.validateForwardFieldSelection(n,o):t.validateBackwardFieldSelection(n,o)),this.fireSelectionChanged(!0),this.documentHelper.updateFocus()}},t.prototype.getDocumentStart=function(){var e=this.documentHelper.pages[0].bodyWidgets[0].childWidgets[0];return this.setPositionForBlock(e,!0)},t.prototype.getDocumentEnd=function(){var e=void 0,t=this.owner.documentStart,i=this.documentHelper.pages[this.documentHelper.pages.length-1];if(!sf.base.isNullOrUndefined(t)&&i.bodyWidgets[i.bodyWidgets.length-1].childWidgets.length>0){var r=void 0,n=i.bodyWidgets[i.bodyWidgets.length-1].childWidgets,o=n[n.length-1];o instanceof da&&(r=o),e=this.setPositionForBlock(r,!1)}return e},t.prototype.handleControlEndKey=function(){var e=void 0;sf.base.isNullOrUndefined(this.owner.documentEnd)||(e=this.owner.documentEnd),sf.base.isNullOrUndefined(e)||this.owner.selection.selectContent(e,!0),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},t.prototype.handleControlHomeKey=function(){var e=void 0;sf.base.isNullOrUndefined(this.owner.documentStart)||(e=this.owner.documentStart),sf.base.isNullOrUndefined(e)||this.owner.selection.selectContent(e,!0),this.checkForCursorVisibility()},t.prototype.handleControlLeftKey=function(){this.extendToWordStartInternal(!0),this.checkForCursorVisibility()},t.prototype.handleControlRightKey=function(){this.extendToWordEndInternal(!0),this.checkForCursorVisibility()},t.prototype.handleControlDownKey=function(){this.moveToNextParagraph(),this.checkForCursorVisibility()},t.prototype.handleControlUpKey=function(){this.moveToPreviousParagraph(),this.checkForCursorVisibility()},t.prototype.handleShiftLeftKey=function(){this.extendBackward(),this.checkForCursorVisibility()},t.prototype.handleShiftUpKey=function(){this.extendToPreviousLine(),this.checkForCursorVisibility()},t.prototype.handleShiftRightKey=function(){this.extendForward(),this.checkForCursorVisibility()},t.prototype.handleShiftDownKey=function(){this.extendToNextLine(),this.checkForCursorVisibility()},t.prototype.handleControlShiftLeftKey=function(){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.extendToWordEndInternal(!1):this.extendToWordStartInternal(!1),this.checkForCursorVisibility()},t.prototype.handleControlShiftUpKey=function(){this.extendToParagraphStart(),this.checkForCursorVisibility()},t.prototype.handleControlShiftRightKey=function(){(this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.extendToWordStartInternal(!1):this.extendToWordEndInternal(!1),this.checkForCursorVisibility()},t.prototype.handleControlShiftDownKey=function(){this.extendToParagraphEnd(),this.checkForCursorVisibility()},t.prototype.handleLeftKey=function(){this.end.isCurrentParaBidi?this.moveNextPosition():this.movePreviousPosition(),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},t.prototype.handleUpKey=function(){this.isMoveDownOrMoveUp=!0,this.moveUp(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},t.prototype.handleRightKey=function(){this.end.isCurrentParaBidi?this.movePreviousPosition():this.moveNextPosition(),this.owner.enableAutoFocus&&this.checkForCursorVisibility()},t.prototype.handleEndKey=function(){this.moveToLineEnd(),this.checkForCursorVisibility()},t.prototype.handleHomeKey=function(){this.moveToLineStart(),this.checkForCursorVisibility()},t.prototype.handleDownKey=function(){this.isMoveDownOrMoveUp=!0,this.moveDown(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},t.prototype.handleShiftEndKey=function(){this.extendToLineEnd(),this.checkForCursorVisibility()},t.prototype.handleShiftHomeKey=function(){this.extendToLineStart(),this.checkForCursorVisibility()},t.prototype.handleControlShiftEndKey=function(){var e=void 0;sf.base.isNullOrUndefined(this.owner.documentEnd)||(e=this.owner.documentEnd),sf.base.isNullOrUndefined(e)||(this.end.setPosition(e.currentWidget,!1),this.fireSelectionChanged(!0),this.documentHelper.updateFocus()),this.checkForCursorVisibility()},t.prototype.handleControlShiftHomeKey=function(){var e=void 0;sf.base.isNullOrUndefined(this.owner.documentStart)||(e=this.owner.documentStart),sf.base.isNullOrUndefined(e)||(this.end.setPositionInternal(e),this.fireSelectionChanged(!0)),this.checkForCursorVisibility()},t.prototype.handleSpaceBarKey=function(){this.owner.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.owner.documentHelper.protectionType&&"CheckBox"===this.getFormFieldType()&&this.owner.editor.toggleCheckBoxFormField(this.getCurrentFormField())},t.prototype.handleTabKey=function(e,t){var i=this.start,r=!1,n=!1;if(!sf.base.isNullOrUndefined(i)){if(0===i.offset&&-1==i.paragraph.paragraphFormat.listFormat.listId&&(i.currentWidget.isFirstLine()&&(r=!0),n=!0),i.paragraph.isInsideTable&&this.end.paragraph.isInsideTable&&(e||t))this.owner.documentHelper.isDocumentProtected||"FormFieldsOnly"===this.documentHelper.protectionType||(t?this.selectPreviousCell():this.selectNextCell());else if(!e&&!t||sf.base.isNullOrUndefined(i)||i.offset!==this.getStartOffset(i.paragraph)||sf.base.isNullOrUndefined(i.paragraph.paragraphFormat)||sf.base.isNullOrUndefined(i.paragraph.paragraphFormat.listFormat)||-1===i.paragraph.paragraphFormat.listFormat.listId||this.owner.isReadOnlyMode)this.owner.isReadOnlyMode||this.documentHelper.isFormFillProtectedMode||(r&&i.paragraph.paragraphFormat.firstLineIndent<this.documentHelper.defaultTabWidth?this.documentHelper.owner.editorModule.onApplyParagraphFormat("firstLineIndent",this.documentHelper.defaultTabWidth,!0,!1):n?t?this.owner.editorModule.decreaseIndent():x.convertPointToPixel(i.paragraph.paragraphFormat.firstLineIndent+i.paragraph.paragraphFormat.leftIndent)<this.documentHelper.viewer.clientArea.width&&this.owner.editorModule.increaseIndent():this.owner.editorModule.handleTextInput("\t"));else{var o=this.documentHelper.selection,s=i.paragraph;o.isForward||(s=o.end.paragraph),this.owner.editorModule.isFirstParaForList(o,s)?t?this.owner.editorModule.updateListLevelIndent(-this.documentHelper.defaultTabWidth,s):this.owner.editorModule.updateListLevelIndent(this.documentHelper.defaultTabWidth,s):this.owner.editorModule.updateListLevel(!t)}"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.formFields.length>0&&this.selectPrevNextFormField(!t),this.checkForCursorVisibility()}},t.prototype.handlePageUpPageDownKey=function(e,t){var i=this,r=this.end.location.x,n=this.end.location.y,o=this.end.paragraph.bodyWidget.page,s=this.getPageTop(o),a=this.documentHelper.viewerContainer.scrollTop;n=n*this.documentHelper.zoomFactor+(s-a),r=r*this.documentHelper.zoomFactor+o.boundingRectangle.x,e?this.documentHelper.viewerContainer.scrollTop+=this.documentHelper.visibleBounds.height:this.documentHelper.viewerContainer.scrollTop-=this.documentHelper.visibleBounds.height;var l=!1;a===this.documentHelper.viewerContainer.scrollTop&&(l=!0),t&&(this.documentHelper.skipScrollToPosition=!0),setTimeout((function(){if(l)if(t){var o=void 0;o=e?i.getDocumentEnd():i.getDocumentStart(),i.end.setPositionForLineWidget(o.currentWidget,o.offset),i.fireSelectionChanged(!0)}else e?i.moveToDocumentEnd():i.moveToDocumentStart();else i.select({x:r,y:n,extend:t})}),0)},t.prototype.getFormFieldInFormFillMode=function(){for(var e,t=this.owner.selection.start,i=this.documentHelper.formFields.length-1;i>=0;i--)if(this.documentHelper.formFields[i].formFieldData.enabled){if(this.getElementPosition(this.documentHelper.formFields[i]).startPosition.isExistBefore(t)){e=this.documentHelper.formFields[i];break}0===i&&(e=this.documentHelper.formFields[this.documentHelper.formFields.length-1])}return e},t.prototype.selectPrevNextFormField=function(e,t){if(this.documentHelper.isFormFillProtectedMode){t||(t=this.getCurrentFormField());var i=this.documentHelper.formFields.indexOf(t);if(e)for(var r=i;;r++){if(r===this.documentHelper.formFields.length-1?r=0:r+=1,this.documentHelper.formFields[r].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[r],!0);break}r-=1}else for(r=i;;r--){if(0===r?r=this.documentHelper.formFields.length-1:r-=1,this.documentHelper.formFields[r].formFieldData.enabled){this.selectFieldInternal(this.documentHelper.formFields[r],!0);break}r+=1}}},t.prototype.navigateToNextFormField=function(){for(var e,t=this.owner.selection.end,i=0;i<this.documentHelper.formFields.length;i++)if(e=this.documentHelper.formFields[i],this.documentHelper.formFields[i].formFieldData.enabled){if(this.getElementPosition(this.documentHelper.formFields[i]).startPosition.isExistAfter(t)){e.formFieldData instanceof ba&&"Text"===e.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[i]):this.selectFieldInternal(this.documentHelper.formFields[i]);break}i===this.documentHelper.formFields.length-1&&((e=this.documentHelper.formFields[0]).formFieldData instanceof ba&&"Text"===e.formFieldData.type&&this.documentHelper.isInlineFormFillProtectedMode?this.selectTextElementStartOfField(this.documentHelper.formFields[0]):this.selectFieldInternal(this.documentHelper.formFields[0]))}},t.prototype.selectTextElementStartOfField=function(e){var t=e.fieldSeparator.nextElement;if(t){for(;!(t instanceof Fa);)t=t.nextElement;var i=e.line.getOffset(t,0),r=this.getPhysicalPositionInternal(e.line,i,!1);this.selectInternal(e.line,t,0,r)}},t.prototype.triggerFormFillEvent=function(e){var t,i=this.previousSelectedFormField,r=this.currentFormField;r!==i&&i&&i.formFieldData instanceof ba&&"Text"===i.formFieldData.type&&(""===i.formFieldData.format||this.isFormatUpdated||this.owner.editor.applyFormTextFormat(i),i.formFieldData.name,this.owner.editorModule.getFieldResultText(i)),r!==i&&r&&r.formFieldData instanceof ba&&"Text"===r.formFieldData.type&&sf.base.isNullOrUndefined(e)&&(t={fieldName:r.formFieldData.name,value:this.owner.editorModule.getFieldResultText(r)},this.owner.fireBeforeFormFieldFill(t)),r!==i&&r&&(r.formFieldData instanceof ba&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode||r.formFieldData instanceof xa)&&e&&(t={fieldName:r.formFieldData.name,value:this.owner.editorModule.getFieldResultText(r)},this.owner.fireBeforeFormFieldFill(t))},t.prototype.selectPreviousCell=function(){var e=this.start.paragraph.associatedCell,t=e.ownerRow;t.ownerTable;if(sf.base.isNullOrUndefined(e.previousWidget)){if(!sf.base.isNullOrUndefined(t.previousRenderedWidget)){var i=void 0;t.previousRenderedWidget instanceof fa&&(i=t.previousRenderedWidget),this.selectTableCellInternal(i.childWidgets[i.childWidgets.length-1],!0)}}else{var r=void 0;e.previousWidget instanceof ua&&(r=e.previousWidget),this.selectTableCellInternal(r,!0)}},t.prototype.selectNextCell=function(){var e=this.start.paragraph.associatedCell,t=e.ownerRow;t.ownerTable;if(sf.base.isNullOrUndefined(e.nextWidget))if(sf.base.isNullOrUndefined(t.nextRenderedWidget)&&!this.owner.isReadOnlyMode)this.owner.editorModule.insertRow(!1);else{var i=void 0;t.nextRenderedWidget instanceof fa&&(i=t.nextRenderedWidget),this.selectTableCellInternal(i.childWidgets[0],!0)}else{var r=void 0;e.nextRenderedWidget instanceof ua&&(r=e.nextRenderedWidget),this.selectTableCellInternal(r,!0)}},t.prototype.selectTableCellInternal=function(e,t){var i=this.getFirstParagraph(e),r=this.getLastParagraph(e);if(i===r&&r.isEmpty())this.selectParagraphInternal(r,!0);else{var n=r.childWidgets[0];this.start.setPosition(i.childWidgets[0],!0),this.end.setPositionParagraph(n,n.getEndOffset()),this.fireSelectionChanged(!0)}},t.prototype.selectTableInternal=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.getTable(e,t))){var i=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell).ownerTable,r=this.documentHelper.getFirstParagraphBlock(i),n=this.documentHelper.getLastParagraphBlock(i),o=n.lastChild.getEndOffset();this.start.setPosition(r.childWidgets[0],!0),this.end.setPositionParagraph(n.lastChild,o+1)}this.selectPosition(this.start,this.end)},t.prototype.selectColumnInternal=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.getTable(e,t))){var i=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell);if(i.ownerTable.contains(t.paragraph.associatedCell)){var r=this.getSelectedCell(e.paragraph.associatedCell,i),n=this.getSelectedCell(t.paragraph.associatedCell,i);if(this.containsCell(i,t.paragraph.associatedCell)){r.ownerRow;var o=i.ownerTable.getColumnCellsForSelection(i,i);if(o.length>0){var s=this.getFirstParagraph(o[0]),a=this.getLastParagraph(o[o.length-1]);this.start.setPosition(s.firstChild,!0);var l=a.lastChild;this.end.setPositionParagraph(l,l.getEndOffset()+1)}}else{var d=i.ownerTable.getColumnCellsForSelection(r,r),h=i.ownerTable.getColumnCellsForSelection(n,n);if(d.length>0&&h.length>0){s=this.getFirstParagraph(d[0]),a=this.getLastParagraph(h[h.length-1]);this.start.setPosition(s.firstChild,!0);l=a.lastChild;this.end.setPositionParagraph(l,l.getEndOffset()+1)}}}}this.selectPosition(this.start,this.end)},t.prototype.selectTableRow=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.getTable(e,t))){var i=void 0;if((i=this.getContainerCellOf(e.paragraph.associatedCell,t.paragraph.associatedCell)).ownerTable.contains(t.paragraph.associatedCell)){var r=this.getSelectedCell(e.paragraph.associatedCell,i),n=this.getSelectedCell(t.paragraph.associatedCell,i);if(this.containsCell(i,t.paragraph.associatedCell)){var o=r.ownerRow,s=this.getFirstParagraph(o.childWidgets[0]),a=this.getLastParagraph(o.childWidgets[o.childWidgets.length-1]);this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(a.lastChild,a.lastChild.getEndOffset()+1)}else{s=this.getFirstParagraph(r.ownerRow.childWidgets[0]),a=void 0;a=this.getLastParagraph(n.ownerRow.childWidgets[n.ownerRow.childWidgets.length-1]),this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(a.lastChild,a.lastChild.getEndOffset()+1)}}}this.selectPosition(this.start,this.end)},t.prototype.selectTableCell=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),!sf.base.isNullOrUndefined(this.getTable(e,t))){if(this.isEmpty){if(e.paragraph.isInsideTable&&!sf.base.isNullOrUndefined(e.paragraph.associatedCell))(r=this.getFirstParagraph(e.paragraph.associatedCell))===(n=this.getLastParagraph(t.paragraph.associatedCell))?(this.start.setPosition(n.firstChild,!0),this.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1)):(this.start.setPosition(r.firstChild,!0),this.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1))}else{var i=this.getContainerCell(e.paragraph.associatedCell);if(this.containsCell(i,e.paragraph.associatedCell)&&this.containsCell(i,t.paragraph.associatedCell)){var r=this.getFirstParagraph(i),n=this.getLastParagraph(i);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(n)||(this.start.setPosition(r.firstChild,!0),this.end.setPositionParagraph(n.lastChild,n.lastChild.getEndOffset()+1))}}this.selectPosition(this.start,this.end)}},t.prototype.selectAll=function(){var e,t;this.documentHelper.skipScrollToPosition=!0;var i=this.getContainerWidget(this.start.paragraph);if(this.owner.enableHeaderAndFooter){var r=this.getContainerWidget(this.start.paragraph);e=this.setPositionForBlock(r.firstChild,!0),t=this.setPositionForBlock(r.lastChild,!1)}else if(this.isInShape){var n=this.getCurrentTextFrame();e=this.setPositionForBlock(n.firstChild,!0),t=this.setPositionForBlock(n.lastChild,!1)}else if(i instanceof ha&&"Footnote"===i.footNoteType){var o=void 0,s=void 0,a=this.documentHelper.pages.length;for(o=0;o<=a-1;o++)if(!sf.base.isNullOrUndefined(this.documentHelper.pages[o].footnoteWidget)){e=this.setPositionForBlock(this.documentHelper.pages[o].footnoteWidget.bodyWidgets[0].firstChild,!0);break}for(s=a-1;s>=0;s--)if(!sf.base.isNullOrUndefined(this.documentHelper.pages[s].footnoteWidget)){var l=this.documentHelper.pages[s].footnoteWidget.bodyWidgets.length,d=this.documentHelper.pages[s].footnoteWidget.bodyWidgets[l-1].childWidgets.length;t=this.setPositionForBlock(this.documentHelper.pages[s].footnoteWidget.bodyWidgets[l-1].childWidgets[d-1],!1);break}}else if(i instanceof ha&&"Endnote"===i.footNoteType){var h=this.getContainerWidget(this.start.paragraph);e=this.setPositionForBlock(h.bodyWidgets[0].firstChild,!0),t=this.setPositionForBlock(h.bodyWidgets[h.bodyWidgets.length-1].lastChild,!1)}else e=this.owner.documentStart,t=this.owner.documentEnd;sf.base.isNullOrUndefined(e)||(this.start.setPositionInternal(e),this.end.setPositionParagraph(t.currentWidget,t.offset+1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendBackward=function(){sf.base.isNullOrUndefined(this.start)||((this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.end.moveForward():this.end.moveBackward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendForward=function(){sf.base.isNullOrUndefined(this.start)||((this.isForward?this.start.isCurrentParaBidi:this.end.isCurrentParaBidi)?this.end.moveBackward():this.end.moveForward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToWordStartEnd=function(){return!(!this.start.paragraph.isInsideTable&&!this.end.paragraph.isInsideTable||this.start.paragraph.associatedCell===this.end.paragraph.associatedCell&&!this.isCellSelected(this.start.paragraph.associatedCell,this.start,this.end))},t.prototype.extendToWordStart=function(){this.extendToWordStartInternal(!1)},Object.defineProperty(t.prototype,"sfdt",{get:function(){return this.owner.editorModule&&this.start.offset!==this.end.offset?JSON.stringify(this.writeSfdt()):null},enumerable:!0,configurable:!0}),t.prototype.extendToWordEnd=function(){this.extendToWordEndInternal(!1)},t.prototype.extendToWordStartInternal=function(e){sf.base.isNullOrUndefined(this.start)||(this.extendToWordStartEnd()?this.end.moveToPreviousParagraphInTable(this):e&&this.end.isCurrentParaBidi?this.end.moveToWordEndInternal(e?0:1,!1):this.end.moveToWordStartInternal(e?0:1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToWordEndInternal=function(e){sf.base.isNullOrUndefined(this.start)||(this.extendToWordStartEnd()?this.end.moveToNextParagraphInTable():e&&this.end.isCurrentParaBidi?this.end.moveToWordStartInternal(e?0:1):this.end.moveToWordEndInternal(e?0:1,!1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},t.prototype.extendToNextLine=function(){sf.base.isNullOrUndefined(this.start)||(this.end.moveToNextLine(this.upDownSelectionLength),this.fireSelectionChanged(!0))},t.prototype.getTextPosition=function(e){var t=new Al(this.owner);return t.setPositionForCurrentIndex(e),t},t.prototype.getText=function(e){if(!(sf.base.isNullOrUndefined(this.start)||sf.base.isNullOrUndefined(this.end)||sf.base.isNullOrUndefined(this.start.paragraph)||sf.base.isNullOrUndefined(this.end.paragraph))){var t=this.start,i=this.end;return t.isAtSamePosition(i)?"":this.getTextInternal(t,i,e)}},t.prototype.getTextInternal=function(e,t,i){if(e.isExistAfter(t)){var r=t;t=e,e=r}var n=e,o=t;if(!(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(e.paragraph)||sf.base.isNullOrUndefined(t.paragraph))){var s=0,a=0,l=e.offset,d=t.offset,h=e.currentWidget.getInline(l,s);s=h.index;var c=h.element;if(c instanceof va&&!sf.base.isNullOrUndefined(c.fieldEnd)){var p=this.getRenderedInline(c,s);c=p.element,s=p.index}var g=t.currentWidget.getInline(d,a),f=g.element;a=g.index;var u="";if(c instanceof Da&&i&&0===s?u=ya.objectCharacter:c instanceof Fa&&(u=sf.base.isNullOrUndefined(c.text)||""===c.text||c.text.length<s?u:c.text.substring(s)),n.paragraph===o.paragraph)c instanceof ya&&(c===f&&c instanceof Fa?u=u.length<a-s?u:u.substring(0,a-s):c.nextNode instanceof ya&&(u+=this.getTextInline(c.nextNode,o.paragraph,f,a,i)));else if(c instanceof ya&&c.nextNode instanceof ya)u+=this.getTextInline(c.nextNode,o.paragraph,f,a,i);else{var m=this.documentHelper.selection.getNextParagraphBlock(n.paragraph);for(u+="\r";!sf.base.isNullOrUndefined(m)&&m.isEmpty();){if(u+="\r",m===o.paragraph)return u;m=this.documentHelper.selection.getNextParagraphBlock(m)}sf.base.isNullOrUndefined(m)||m.isEmpty()||(u+=this.getTextInline(m.childWidgets[0].children[0],o.paragraph,f,a,i))}return d===o.currentWidget.getEndOffset()+1&&(u+="\r"),u}},t.prototype.getHierarchicalIndex=function(e,t){var i;if(e){if(e instanceof la){var r=-1!==e.headerFooterType.indexOf("Header")?"H":"F",n=e.page.index.toString();i=e.page.sectionIndex+";"+r+";"+n+";"+t}else{if(e instanceof aa&&!sf.base.isNullOrUndefined(e.containerWidget)&&e.containerWidget instanceof ha)i=e.containerWidget.bodyWidgets.indexOf(e)+";"+t;else i=e.index+";"+t}if(e instanceof Aa)return i="S;"+e.containerShape.line.getOffset(e.containerShape,1)+";"+t,this.getHierarchicalIndex(e.containerShape.paragraph,i);if(e instanceof ha){r="Footnote"===e.footNoteType?"FN":"EN",n=e.page.index.toString();i=e.page.sectionIndex+";"+r+";"+n+";"+t}if(e.containerWidget)return e instanceof ua&&e.rowIndex!==e.containerWidget.index&&(i=e.rowIndex+";"+i,e=e.containerWidget),this.getHierarchicalIndex(e.containerWidget,i)}return i},t.prototype.getHierarchicalIndexByPosition=function(e){var t=this.getParagraphInfo(e);return this.getHierarchicalIndex(t.paragraph,t.offset.toString())},t.prototype.getTextPosBasedOnLogicalIndex=function(e){var t=new Al(this.owner),i=this.getParagraph({index:e}),r=this.getLineInfoBasedOnParagraph(i.paragraph,i.offset);return t.setPositionForLineWidget(r.line,r.offset),t},t.prototype.getLineInfoBasedOnParagraph=function(e,t){var i=this.getParagraphLength(e),r=e.nextSplitWidget;for(t>i+1&&sf.base.isNullOrUndefined(r)&&(t=i);t>i&&r instanceof ca;)t-=i,e=r,i=this.getParagraphLength(e),r=e.nextSplitWidget;return this.getLineInfo(e,t)},t.prototype.getParagraph=function(e){return{paragraph:this.getParagraphInternal(this.getBodyWidget(e),e),offset:parseInt(e.index,10)}},t.prototype.getBodyWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var r=parseInt(i,10);return t=parseInt(i,10),t=e.index.indexOf(";"),"H"===(i=e.index.substring(0,t))||"F"===i?this.getHeaderFooterWidget(e):"FN"===i||"EN"===i?this.getFootNoteWidget(e):(t=parseInt(i,10),this.getBodyWidgetInternal(r,t))},t.prototype.getFootNoteWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var r="FN"===i;t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10);var n=this.documentHelper.pages[t];return t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10),r?n.footnoteWidget.bodyWidgets[t]:n.endnoteWidget.bodyWidgets[t]},t.prototype.getHeaderFooterWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var r="H"===i;t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10);var n,o=this.documentHelper.pages[t];return n=r?o.headerWidget:o.footerWidget,sf.base.isNullOrUndefined(n)||(n.page=o),n},t.prototype.getBodyWidgetInternal=function(e,t){for(var i=0;i<this.documentHelper.pages.length;i++)for(var r=0;r<this.documentHelper.pages[i].bodyWidgets.length;r++){var n=this.documentHelper.pages[i].bodyWidgets[r];if(n.index===e&&n.childWidgets.length>0&&n.firstChild.index<=t&&n.lastChild.index>=t)return n;if(n.index>e)break}},t.prototype.getParagraphInternal=function(e,t){if(!sf.base.isNullOrUndefined(t.index)){var i=t.index.indexOf(";"),r="0";i>=0&&(r=t.index.substring(0,i),t.index=t.index.substring(i).replace(";","")),i=parseInt(r,10),e instanceof fa&&i>=e.childWidgets.length&&(t.index="0;0",i=e.childWidgets.length-1);var n=this.getBlockByIndex(e,i);if(n){if("S"===(r=t.index.substring(0,1))){t.index=t.index.substring(1).replace(";","");var o=t.index.substring(0,t.index.indexOf(";"));t.index=t.index.substring(t.index.indexOf(";")).replace(";","");var s=t.index.substring(0,t.index.indexOf(";"));t.index=t.index.substring(t.index.indexOf(";")).replace(";","");var a=n.getInline(parseInt(o),0).element;n=a.textFrame.childWidgets[s]}var l=n;if(l instanceof ca)return t.index.indexOf(";")>0&&(t.index="0"),l;if(l instanceof oa)return t.index.indexOf(";")>0?this.getParagraphInternal(l,t):l instanceof ga?this.documentHelper.getFirstParagraphInFirstCell(l):void 0}else if(e){var d=e.getSplitWidgets().pop().nextRenderedWidget;if(d instanceof oa)return t.index="0",d instanceof ga?this.documentHelper.getFirstParagraphInFirstCell(d):d}}},t.prototype.getBlockByIndex=function(e,t){var i;if(e){for(var r=0;r<e.childWidgets.length;r++)if(e.childWidgets[r].index===t){i=e.childWidgets[r];break}if(!(i||e instanceof la))return this.getBlockByIndex(e.nextSplitWidget,t)}return i},t.prototype.getParagraphInfo=function(e){return this.getParagraphInfoInternal(e.currentWidget,e.offset)},t.prototype.getCellFromSelection=function(e){var t,i=this.getSelectedCells();if(!this.hasMergedCells()){if(0==e&&i.length>0){if(!(this.selectedWidgets.keys[0]instanceof ua))return;for(var r=(t=i[0]).rowIndex,n=t.columnIndex,o=t.ownerTable.index,s=0;s<i.length;s++){(a=i[s]).rowIndex<r&&(r=a.rowIndex),a.columnIndex<n&&(n=a.columnIndex),a.ownerTable.index<o&&(o=a.ownerTable.index)}for(s=0;s<i.length;s++){r==(a=i[s]).rowIndex&&n==a.columnIndex&&o==a.ownerTable.index&&(t=a)}}else if(1==e&&i.length>0){if(!(this.selectedWidgets.keys[this.selectedWidgets.length-1]instanceof ua))return;for(r=(t=i[i.length-1]).rowIndex,n=t.columnIndex,o=t.ownerTable.index,s=i.length-1;s>=0;s--){(a=i[s]).rowIndex>r&&(r=a.rowIndex),a.columnIndex>n&&(n=a.columnIndex),a.ownerTable.index>o&&(o=a.ownerTable.index)}for(s=0;s<i.length;s++){var a;r==(a=i[s]).rowIndex&&n==a.columnIndex&&o==a.ownerTable.index&&(t=a)}}return t instanceof ua?t:void 0}},t.prototype.getCellFromSelectionInTable=function(e){for(var t,i,r,n=this.getSelectedCells(),o=this.getCellBoundsInfo(),s=[],a=[],l=0;l<n.length;l++){var d=n[l];s.push(d.rowIndex),a.push(d.columnIndex)}if(s.sort(),a.sort(),1==e){i=o.row.rowLast,r=o.column.colLast;for(var h=!1;!h&&sf.base.isNullOrUndefined(t);){for(l=0;l<n.length;l++){var c=n[l];if(c.rowIndex==i&&c.columnIndex==r){h=!0,t=c;break}}h||(i-=1)}}else if(0==e){i=o.row.rowFirst,r=o.column.colFirst;for(h=!1;!h&&sf.base.isNullOrUndefined(t);){for(l=0;l<n.length;l++){var p=n[l];if(p.rowIndex==i&&p.columnIndex==r){h=!0,t=p;break}}h||(r+=1)}}return t},t.prototype.getActualOffset=function(e,t){var i;if(0==t){var r=this.getFirstParagraph(e);i=this.getHierarchicalIndex(r,this.getStartOffset(r).toString())}else if(1==t){var n=(r=this.getLastParagraph(e)).lastChild,o=this.getParagraphLength(r,n)+this.getLineLength(n)+1;i=this.getHierarchicalIndex(r,o.toString())}return i},t.prototype.getBookmarkProperties=function(e){var t=this.selectedWidgets.keys;if(0==e.bookmarkType){if(!(t[0]instanceof ua))return;var i=this.getCellBoundsInfo();if(!sf.base.isNullOrUndefined(i))return{columnFirst:i.column.colFirst.toString(),columnLast:i.column.colLast.toString()}}if(1==e.bookmarkType){if(t[t.length-1]instanceof ua)return;var r={};this.isParagraphMarkSelected()&&(r.isAfterParagraphMark=!0);var n=e.reference,o=this.getSelectedCells();if(n&&!sf.base.isNullOrUndefined(n.properties)&&1==o.length&&this.isCellSelected(o[0],this.start,this.end)&&(r.isAfterCellMark=!0,delete r.isAfterParagraphMark),this.isTableSelected()&&(r.isAfterTableMark=!0),this.isRowSelected()&&(r.isAfterRowMark=!0),!sf.base.isNullOrUndefined(r.isAfterParagraphMark)||!sf.base.isNullOrUndefined(r.isAfterCellMark))return r}},t.prototype.isParagraphMarkSelected=function(){var e,t=this.end.currentWidget;t instanceof ma&&(e=t.paragraph);var i=this.getParagraphLength(e),r=this.endOffset.split(";");return parseInt(r[r.length-1])>i},t.prototype.isRowSelected=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),sf.base.isNullOrUndefined(e.paragraph.associatedCell)||sf.base.isNullOrUndefined(t.paragraph.associatedCell))return!1;var i,r,n,o=t.paragraph.associatedCell.ownerRow.getSplitWidgets();if(o[0].childWidgets.length>0){if(0===(r=o[0].childWidgets[0]).childWidgets.length)return;i=r.childWidgets[0]}for(var s=o[o.length-1],a=s.childWidgets[s.childWidgets.length-1];0===a.childWidgets.length&&!sf.base.isNullOrUndefined(a.previousSplitWidget);)a=a.previousSplitWidget;return n=a.childWidgets[a.childWidgets.length-1],r.equals(i.associatedCell)&&t.paragraph.associatedCell.equals(n.associatedCell)&&(!i.associatedCell.equals(n.associatedCell)||0===e.offset&&t.offset===this.getLineLength(n.lastChild)+1)},t.prototype.getCellBoundsInfo=function(){var e=this.getSelectedCells();if(e.length>0){for(var t=e[0].columnIndex,i=e[e.length-1].columnIndex,r=e[0].rowIndex,n=e[e.length-1].rowIndex,o=0;o<e.length;o++){var s=e[o];s.columnIndex<t&&(t=s.columnIndex),s.columnIndex>i&&(i=s.columnIndex),s.rowIndex<r&&(r=s.rowIndex),s.rowIndex>n&&(n=s.rowIndex)}return{column:{colFirst:t,colLast:i},row:{rowFirst:r,rowLast:n}}}},t.prototype.hasMergedCells=function(){for(var e=this.getSelectedCells(),t=0;t<e.length;t++){var i=e[t];if(i.cellFormat.rowSpan>1||i.cellFormat.columnSpan>1)return!0}return!1},t.prototype.getParagraphInfoInternal=function(e,t){for(var i=e.paragraph,r=this.getParagraphLength(i,e)+t,n=i.previousSplitWidget;n instanceof ca;)i=n,r+=this.documentHelper.selection.getParagraphLength(i),n=i.previousSplitWidget;return{paragraph:i,offset:r}},t.prototype.getListTextElementBox=function(e){if(!sf.base.isNullOrUndefined(e)){var t;if(!e.isEmpty()){var i=e.childWidgets[0];i.children.length>1&&i.children[0]instanceof Va&&(t=i.children[0])}return t}},t.prototype.getListLevel=function(e){var t=void 0,i=0;if(sf.base.isNullOrUndefined(e.paragraphFormat)||sf.base.isNullOrUndefined(e.paragraphFormat.listFormat)||(t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber),!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId))&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId).levels))return this.documentHelper.layout.getListLevel(t,i)},t.prototype.getTextInline=function(e,t,i,r,n){var o="";do{if(e===i){if(e instanceof Fa){var s=e;sf.base.isNullOrUndefined(s.text)||""===s.text||(s.text.length<r?o+=s.text:o+=s.text.substring(0,r))}else e instanceof Da&&n&&r===e.length&&(o+=ya.objectCharacter);return o}if(e instanceof Fa?o+=e.text:e instanceof Da&&n?o+=ya.objectCharacter:e instanceof va&&!sf.base.isNullOrUndefined(e.fieldEnd)&&(e=sf.base.isNullOrUndefined(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator),sf.base.isNullOrUndefined(e.nextNode))break;e=e.nextNode}while(!sf.base.isNullOrUndefined(e));if(t===e.line.paragraph)return o;for(var a=this.documentHelper.selection.getNextParagraphBlock(e.line.paragraph);!sf.base.isNullOrUndefined(a)&&a.isEmpty();){if(o+="\r",a===t)return o;a=this.documentHelper.selection.getNextParagraphBlock(a)}if(!sf.base.isNullOrUndefined(a)&&!a.isEmpty()){var l=a.childWidgets[0];sf.base.isNullOrUndefined(a.previousSplitWidget)&&(o+="\r"),o+=this.getTextInline(l.children[0],t,i,r,n)}return o},t.prototype.getFieldCode=function(e){var t="";if(!(e.fieldEnd instanceof va))return t;var i=e.paragraph,r=e.fieldEnd.paragraph;e.fieldSeparator instanceof va&&(r=e.fieldSeparator.paragraph);var n=e.line.indexInOwner,o=e.indexInOwner;do{if(t+=this.getFieldCodeInternal(i,n,o),i===r)break;i=this.getNextParagraphBlock(i),n=0,o=0}while(i instanceof ca);return t.trim()},t.prototype.getFieldCodeInternal=function(e,t,i){for(var r="",n=t;n<e.childWidgets.length;n++){for(var o=e.childWidgets[n],s=i;s<o.children.length;s++){var a=o.children[s];if(a instanceof Fa&&(r+=a.text),a instanceof va&&(2===a.fieldType||1===a.fieldType))return r}i=0}return r},t.prototype.getTocFieldInternal=function(){var e=this.start.paragraph;for(this.isEmpty||this.isForward||(e=this.end.paragraph);e instanceof ca&&e.childWidgets.length>0;){var t=e.firstChild;if(t.children.length>0){var i=t.children[0],r=i.nextNode;if(i instanceof va&&0===i.fieldType&&r instanceof Fa&&0===r.text.trim().toLowerCase().indexOf("toc"))return i}e=e.previousRenderedWidget}},t.prototype.getNextParagraph=function(e){if(e.nextRenderedWidget instanceof aa){var t=e.nextRenderedWidget.childWidgets[0];return this.documentHelper.getFirstParagraphBlock(t)}},t.prototype.getPreviousParagraph=function(e){if(e.previousRenderedWidget instanceof aa){var t=e.previousRenderedWidget,i=t.childWidgets[t.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(i)}},t.prototype.getNextStartInline=function(e,t){var i=0,r=e.getInline(t,i),n=r.element;if(i=r.index,!sf.base.isNullOrUndefined(n)&&i===n.length&&n.nextNode instanceof va||n instanceof La){var o=this.getNextValidElement(n.nextNode);o instanceof va&&0===o.fieldType&&(n=o)}return n},t.prototype.getPreviousTextInline=function(e){return e.previousNode instanceof Fa?e.previousNode:e.previousNode instanceof va&&x.isLinkedFieldCharacter(e.previousNode)?0===e.previousNode.fieldType||1===e.previousNode.fieldType?e.previousNode:e.previousNode.fieldBegin:sf.base.isNullOrUndefined(e.previousNode)?void 0:this.getPreviousTextInline(e.previousNode)},t.prototype.getNextTextInline=function(e){return e.nextNode instanceof Fa?e.nextNode:e.nextNode instanceof va&&x.isLinkedFieldCharacter(e.nextNode)?1===e.nextNode.fieldType||0===e.nextNode.fieldType?e.nextNode:e.nextNode.fieldEnd:sf.base.isNullOrUndefined(e.nextNode)?void 0:this.getNextTextInline(e.nextNode)},t.prototype.getContainerTable=function(e){if(e.isInsideTable&&(e=e.associatedCell.ownerTable.isInsideTable?this.getContainerTable(e.associatedCell.ownerTable):e.associatedCell.ownerTable),e instanceof ga)return e},t.prototype.isElementInSelection=function(e,t){var i=e.line.getOffset(e,t?0:1),r=new Al(this.owner);r.setPositionParagraph(e.line,i);var n=this.start,o=this.end;return this.isForward||(n=this.end,o=this.start),(r.isExistAfter(n)||r.isAtSamePosition(n))&&(r.isExistBefore(o)||r.isAtSamePosition(o))},t.prototype.isSelectionInsideElement=function(e){if(this.isEmpty){var t=e.line.getOffset(e,0),i=new Al(this.owner);i.setPositionParagraph(e.line,t);var r=e.line.getOffset(e,e.length),n=new Al(this.owner);return n.setPositionParagraph(e.line,r),(this.start.isExistAfter(i)||this.start.isAtSamePosition(i))&&(this.start.isExistBefore(n)||this.start.isAtSamePosition(n))}return!1},t.prototype.isExistBefore=function(e,t){if(e.isInsideTable){var i=e.associatedCell;if(t.isInsideTable){var r=t.associatedCell;if(i===r)return i.childWidgets.indexOf(e)<i.childWidgets.indexOf(t);if(i.ownerRow===r.ownerRow)return i.cellIndex<r.cellIndex;if(i.ownerTable===r.ownerTable)return i.ownerRow.rowIndex<r.ownerRow.rowIndex;var n=this.getContainerCellOf(i,r);return n.ownerTable.contains(r)?(i=this.getSelectedCell(i,n),r=this.getSelectedCell(r,n),i===n?this.isExistBefore(e,r.ownerTable):r===n?this.isExistBefore(i.ownerTable,t):n.ownerRow===r.ownerRow?n.cellIndex<r.cellIndex:n.ownerTable===r.ownerTable?n.ownerRow.rowIndex<r.ownerRow.rowIndex:this.isExistBefore(i.ownerTable,r.ownerTable)):this.isExistBefore(n.ownerTable,this.getContainerTable(r.ownerTable))}var o=this.getContainerTable(e);return this.isExistBefore(o,t)}if(t.isInsideTable){o=this.getContainerTable(t);return this.isExistBefore(e,o)}if(e.containerWidget===t.containerWidget)return e.index<t.index;if(e.containerWidget instanceof aa&&t.containerWidget instanceof aa){var s=this.documentHelper.pages.indexOf(e.containerWidget.page),a=this.documentHelper.pages.indexOf(t.containerWidget.page);return s===a?e.containerWidget.indexInOwner<t.containerWidget.indexInOwner:s===a&&e.containerWidget.containerWidget instanceof ha&&t.containerWidget.containerWidget instanceof ha?this.documentHelper.pages[s].footnoteWidget.bodyWidgets.indexOf(e.containerWidget)<this.documentHelper.pages[a].footnoteWidget.bodyWidgets.indexOf(t.containerWidget):s===a&&e.containerWidget.index!==t.containerWidget.index?this.documentHelper.pages[s].bodyWidgets.indexOf(e.containerWidget)<this.documentHelper.pages[a].bodyWidgets.indexOf(t.containerWidget):s<a}return!1},t.prototype.isExistAfter=function(e,t){if(e.isInsideTable){var i=e.associatedCell;if(t.isInsideTable){var r=t.associatedCell;if(i===r)return i.childWidgets.indexOf(e)>i.childWidgets.indexOf(t);if(i.ownerRow===r.ownerRow)return i.cellIndex>r.cellIndex;if(i.ownerTable===r.ownerTable)return i.ownerRow.rowIndex>r.ownerRow.rowIndex;var n=this.getContainerCellOf(i,r);return n.ownerTable.contains(r)?(i=this.getSelectedCell(i,n),r=this.getSelectedCell(r,n),i===n?this.isExistAfter(e,r.ownerTable):r===n?this.isExistAfter(i.ownerTable,t):n.ownerRow===r.ownerRow?n.cellIndex>r.cellIndex:n.ownerTable===r.ownerTable?n.ownerRow.rowIndex>r.ownerRow.rowIndex:this.isExistAfter(i.ownerTable,r.ownerTable)):this.isExistAfter(n.ownerTable,this.getContainerTable(r.ownerTable))}var o=this.getContainerTable(e);return this.isExistAfter(o,t)}if(t.isInsideTable){o=this.getContainerTable(t);return this.isExistAfter(e,o)}return e.containerWidget===t.containerWidget?e.index>t.index:(e.containerWidget instanceof aa&&t.containerWidget instanceof aa||e.containerWidget instanceof ha&&t.containerWidget instanceof ha)&&this.documentHelper.pages.indexOf(e.containerWidget.page)>this.documentHelper.pages.indexOf(t.containerWidget.page)},t.prototype.isExistBeforeInline=function(e,t){if(e.line===t.line)return e.line.children.indexOf(e)<=t.line.children.indexOf(t);if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)<t.line.paragraph.childWidgets.indexOf(t.line);var i=e.line.paragraph,r=t.line.paragraph;if(i.containerWidget===r.containerWidget){if(i.isInsideTable)return i.associatedCell.childWidgets.indexOf(i)<r.associatedCell.childWidgets.indexOf(r);if(!(i.containerWidget instanceof la))return i.containerWidget.childWidgets.indexOf(i)<r.containerWidget.childWidgets.indexOf(r)}return this.isExistBefore(i,r)},t.prototype.isExistAfterInline=function(e,t,i){if(e.line===t.line){var r=this.documentHelper.selection;return i?e.line.children.indexOf(e)>=t.line.children.indexOf(t):e===t&&r.start.offset!==r.end.offset?e.line.children.indexOf(e)===t.line.children.indexOf(t):e.line.children.indexOf(e)>t.line.children.indexOf(t)}if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)>t.line.paragraph.childWidgets.indexOf(t.line);var n=e.line.paragraph,o=t.line.paragraph;if(n.containerWidget===o.containerWidget){if(n.isInsideTable)return n.associatedCell.childWidgets.indexOf(n)>o.associatedCell.childWidgets.indexOf(o);if(!(n.containerWidget instanceof la))return n.containerWidget.childWidgets.indexOf(n)>o.containerWidget.childWidgets.indexOf(o)}return this.isExistAfter(n,o)},t.prototype.getNextRenderedBlock=function(e){return sf.base.isNullOrUndefined(e.nextWidget)?e.nextRenderedWidget:e.nextWidget},t.prototype.getPreviousRenderedBlock=function(e){return sf.base.isNullOrUndefined(e.previousWidget)?e.previousRenderedWidget:e.previousWidget},t.prototype.getNextParagraphBlock=function(e){if(e.nextRenderedWidget instanceof ca)return e.nextRenderedWidget;if(e.nextRenderedWidget instanceof ga)return this.documentHelper.getFirstParagraphInFirstCell(e.nextRenderedWidget);if(e.containerWidget instanceof ua)return this.getNextParagraphCell(e.containerWidget);if(e.containerWidget instanceof aa){e.containerWidget;return this.getNextParagraph(e.containerWidget)}return e.containerWidget instanceof la&&this.isMoveDownOrMoveUp?this.getFirstBlockInNextHeaderFooter(e):void 0},t.prototype.getFirstBlockInNextHeaderFooter=function(e){var t,i=e.containerWidget;if(-1!==i.headerFooterType.indexOf("Header"))t=i.page.footerWidget.firstChild;else{if(!i.page.nextPage)return;var r=i.page.nextPage,n=r.headerWidget;n.page=r,r.footerWidget&&(r.footerWidget.page=r),t=n.firstChild}return t instanceof ca?t:this.getFirstBlockInFirstCell(t)},t.prototype.getLastBlockInPreviousHeaderFooter=function(e){var t,i=e.containerWidget;if(-1!==i.headerFooterType.indexOf("Footer"))t=i.page.headerWidget.lastChild;else{if(!i.page.previousPage)return;var r=i.page.previousPage,n=r.footerWidget;n.page=r,r.headerWidget&&(r.headerWidget.page=r),t=n.lastChild}return t instanceof ca?t:this.getFirstBlockInFirstCell(t)},t.prototype.getPreviousParagraphBlock=function(e,t){return e.previousRenderedWidget instanceof ca?e.previousRenderedWidget:e.previousRenderedWidget instanceof ga?this.documentHelper.getLastParagraphInLastCell(e.previousRenderedWidget):e.containerWidget instanceof ua?this.getPreviousParagraphCell(e.containerWidget):e.containerWidget instanceof aa?this.getPreviousParagraph(e.containerWidget):e.containerWidget instanceof la&&this.isMoveDownOrMoveUp&&!t?this.getLastBlockInPreviousHeaderFooter(e):void 0},t.prototype.hasValidInline=function(e,t,i){for(var r=e.childWidgets.indexOf(t.line);r<e.childWidgets.length;r++)for(var n=0;n<e.childWidgets[r].children.length;n++){var o=e.childWidgets[r].children[n];if(0!==o.length){if(o===i)return!1;if(o instanceof Fa||o instanceof Da||o instanceof va&&x.isLinkedFieldCharacter(o))return!0}}return!1},t.prototype.getParagraphLength=function(e,t,i){for(var r=0,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(t instanceof ma&&t===o){i&&(r+=this.getLineLength(o,i));break}r+=this.getLineLength(o)}return r},t.prototype.getLineLength=function(e,t){for(var i=0,r=e.paragraph.bidi,n=r?e.children.length-1:0;r?n>-1:n<e.children.length;r?n--:n++){var o=e.children[n];if(!(o instanceof Va)){if(t&&t.element instanceof ya&&t.element===o){i+=t.index;break}i+=o.length}}return i},t.prototype.getLineInfo=function(e,t){for(var i=void 0,r=0,n=e.childWidgets.length,o=0;o<n&&(i=e.childWidgets[o],!(t<=(r=this.getLineLength(i))||o===n-1));o++)t-=r;return{line:i,offset:t}},t.prototype.getElementInfo=function(e,t){for(var i=void 0,r=0;r<e.children.length;r++)if(!((i=e.children[r])instanceof Va)){if(!(t>i.length)||t===i.length+1&&sf.base.isNullOrUndefined(i.nextNode))break;t-=i.length}return{element:i,index:t}},t.prototype.getStartOffset=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[0];return this.getStartLineOffset(t)}return 0},t.prototype.getStartLineOffset=function(e){for(var t=0,i=0;i<e.children.length;i++){var r=e.children[i];if(0!==r.length){if(r instanceof Fa||r instanceof Da||r instanceof Na||r instanceof La||r instanceof _a||r instanceof qa||r instanceof al||r instanceof va&&x.isLinkedFieldCharacter(r)||r instanceof Oa)return t;r instanceof Va||(t+=r.length)}}return t},t.prototype.getPreviousSelectionCell=function(e){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)){if(this.isForward){var t=e.previousRenderedWidget.childWidgets;return(i=t[t.length-1])instanceof ca?i:this.getPreviousParagraphSelection(i.childWidgets[i.childWidgets.length-1])}var i;return(i=e.previousRenderedWidget.childWidgets[0])instanceof ca?i:this.documentHelper.getFirstParagraphInLastRow(i)}return this.getPreviousSelectionRow(e.ownerRow)},t.prototype.getPreviousSelectionRow=function(e){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)){if(this.isForward)return this.getPreviousParagraphSelection(e.previousRenderedWidget);var t=e.previousRenderedWidget.childWidgets[0].childWidgets[0];return this.documentHelper.getFirstParagraphBlock(t)}return this.getPreviousSelectionBlock(e.ownerTable)},t.prototype.getNextSelectionBlock=function(e){return e.nextRenderedWidget instanceof ca?e.nextRenderedWidget:e.nextRenderedWidget instanceof ga?this.isEmpty||this.isForward?this.documentHelper.getLastParagraphInFirstRow(e.nextRenderedWidget):this.getNextParagraphSelection(e.nextRenderedWidget.childWidgets[0]):e.containerWidget instanceof ua?this.getNextSelectionCell(e.containerWidget):e.containerWidget instanceof aa?this.getNextSelection(e.containerWidget):void 0},t.prototype.getNextSelectionCell=function(e){if(!sf.base.isNullOrUndefined(e.nextRenderedWidget)){if(this.isEmpty||this.isForward){var t=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(t)}return(t=e.nextRenderedWidget.childWidgets[0])instanceof ca?t:this.getNextParagraphSelection(t.childWidgets[0])}return this.getNextSelectionRow(e.ownerRow)},t.prototype.getNextSelectionRow=function(e){if(!sf.base.isNullOrUndefined(e.nextRenderedWidget)){if(this.isEmpty||this.isForward){var t=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1],i=t.childWidgets[t.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(i)}return this.getNextParagraphSelection(e.nextRenderedWidget)}return this.getNextSelectionBlock(e.ownerTable)},t.prototype.getNextSelection=function(e){if(e.nextRenderedWidget instanceof aa){var t=e.nextRenderedWidget.childWidgets[0];return t instanceof ca?t:this.isEmpty||this.isForward?this.documentHelper.getLastParagraphInFirstRow(t):this.getNextParagraphSelection(t.childWidgets[0])}},t.prototype.getNextParagraphSelection=function(e){var t=e.childWidgets[0];if(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)){var i=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell);t=this.getFirstCellInRegion(e,i,this.upDownSelectionLength,!1)}var r=t.childWidgets[0];return this.documentHelper.getFirstParagraphBlock(r)},t.prototype.getPreviousSelectionBlock=function(e){return e.previousRenderedWidget instanceof ca?e.previousRenderedWidget:e.previousRenderedWidget instanceof ga?this.isForward?this.getPreviousParagraphSelection(e.previousRenderedWidget.childWidgets[e.previousRenderedWidget.childWidgets.length-1]):this.documentHelper.getFirstParagraphInLastRow(e.previousRenderedWidget):e.containerWidget instanceof ua?this.getPreviousSelectionCell(e.containerWidget):e.containerWidget instanceof aa?this.getPreviousSelection(e.containerWidget):void 0},t.prototype.getPreviousSelection=function(e){if(e.previousRenderedWidget instanceof aa){var t=e.previousRenderedWidget,i=t.childWidgets[t.childWidgets.length-1];if(i instanceof ca)return i;if(this.isForward){var r=i;return this.getPreviousParagraphSelection(r.childWidgets[r.childWidgets.length-1])}return this.documentHelper.getFirstParagraphInLastRow(i)}},t.prototype.getPreviousParagraphSelection=function(e){var t=e.childWidgets[e.childWidgets.length-1];if(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)){var i=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell);t=this.getLastCellInRegion(e,i,this.upDownSelectionLength,!0)}var r=t.childWidgets[t.childWidgets.length-1];return this.documentHelper.getLastParagraphBlock(r)},t.prototype.getLastCellInRegion=function(e,t,i,r){var n=this.getCellLeft(e,t),o=n+t.cellFormat.cellWidth,s=!0;if(n<=i&&i<o)for(var a=e.childWidgets.length-1;a>=0;a--){var l=this.getCellLeft(e,e.childWidgets[a]);if(x.round(n,2)<=x.round(l,2)&&x.round(l,2)<x.round(o,2))return s=!1,e.childWidgets[a]}else for(a=e.childWidgets.length-1;a>=0;a--){if((l=this.getCellLeft(e,e.childWidgets[a]))<=i&&l+e.childWidgets[a].cellFormat.cellWidth>i)return s=!1,e.childWidgets[a]}if(s){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)&&r)return this.getLastCellInRegion(e.previousRenderedWidget,t,i,r);if(!sf.base.isNullOrUndefined(e.nextRenderedWidget)&&!r)return this.getLastCellInRegion(e.nextRenderedWidget,t,i,r)}return e.childWidgets[e.childWidgets.length-1]},t.prototype.getCellInTable=function(e,t){for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable))return t;t=t.ownerTable.associatedCell}return t},t.prototype.getPreviousValidOffset=function(e,t){if(0===t)return 0;for(var i=0,r=0,n=(e.paragraphFormat.bidi,0);n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.children.length;s++){var a=o.children[s];if(!(0===a.length||a instanceof Va)){if(t<=r+a.length)return t-1===r?i:t-1;(a instanceof Fa||a instanceof Da||a instanceof Na||a instanceof va&&x.isLinkedFieldCharacter(a))&&(i=r+a.length),r+=a.length}}return t-1===r?i:t-1},t.prototype.getNextValidOffset=function(e,t){for(var i=0,r=0;r<e.children.length;r++){var n=e.children[r];if(!(0===n.length||n instanceof Va)){if(t<i+n.length&&(n instanceof Fa||n instanceof Da||n instanceof va&&x.isLinkedFieldCharacter(n)))return(t>i?t:i)+1;if(t===i+n.length&&n instanceof va&&1===n.fieldType&&n.previousNode instanceof Da)return t;i+=n.length}}return t},t.prototype.getParagraphMarkSize=function(e,t,i){var r=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat),n=r.BaselineOffset,o=r.Height,s=n;if(e instanceof ca){if(e.childWidgets.length>0)e.childWidgets[0];var a=this.documentHelper.layout.getLineSpacing(e,o),l=this.documentHelper.layout.getBeforeSpacing(e);t=s-n,i=o-s-(r.Height-n);var d=e.paragraphFormat.lineSpacingType;"Multiple"===d?a>o?i+=a-o:t+=a-o:("Exactly"===d||a>t+r.Height+i)&&(t+=a-(t+r.Height+i)),t+=l,i+=this.documentHelper.layout.getAfterSpacing(e)}return{width:r.Width,height:r.Height,topMargin:t,bottomMargin:i}},t.prototype.getPhysicalPositionInternal=function(e,t,i){if(e.paragraph.isEmpty()){var r=e.paragraph,n=r.x;if(r.childWidgets.length>0){var o=r.childWidgets[0];n=this.getLeft(o)}var s=this.getParagraphMarkSize(e.paragraph,0,0);return(t>0||0===t&&r.isEmpty()&&r.bidi)&&(n+=s.width),new I(n,r.y+s.topMargin)}var a=0,l=e.getInline(t,a,e.paragraph.bidi),d=l.element;return a=l.index,this.getPhysicalPositionInline(d,a,i)},t.prototype.highlightSelectedContent=function(e,t){if(e.paragraph.isInsideTable&&(!t.paragraph.isInsideTable||!e.paragraph.associatedCell.equals(t.paragraph.associatedCell)||!this.documentHelper.isSelectionChangedOnMouseMoved&&this.isCellSelected(e.paragraph.associatedCell,e,t)||this.isCellPrevSelected))this.highlightCell(e.paragraph.associatedCell,this,e,t),this.isCellPrevSelected=!0;else{var i=void 0,r=0;if(!this.owner.isReadOnlyMode&&e.paragraph===t.paragraph)if(e.offset+1===t.offset){var n=t.currentWidget.getInline(t.offset,r);if(i=n.element,r=n.index,i instanceof Da||i instanceof La)e.currentWidget.getOffset(i,0)!==e.offset&&(i=void 0)}else{var o=0,s=e.currentWidget.getInline(e.offset,o),a=s.element;(o=s.index)===a.length&&(a=this.getNextRenderedElementBox(a,o));var l=t.currentWidget.getInline(t.offset,o),d=l.element;if(o=l.index,a instanceof va&&d instanceof va&&!sf.base.isNullOrUndefined(a.fieldSeparator)){var h=a.fieldSeparator.nextNode;h instanceof Da&&h.nextNode===d&&(i=h)}}if(!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&(i instanceof Da||i instanceof La)){var c=this.getElementBoxInternal(i,r),p=c.element;r=c.index,this.owner.enableImageResizerMode&&(this.owner.imageResizerModule.positionImageResizer(p),this.owner.imageResizerModule.showImageResizer()),this.documentHelper.isTouchInput&&(this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none")}else e.paragraph.isInsideTable&&e.paragraph.associatedCell.equals(t.paragraph.associatedCell)&&t.paragraph.equals(this.getLastParagraph(t.paragraph.associatedCell))&&this.getParagraphLength(t.paragraph)+1==t.offset&&t.offset--,this.highlight(e.paragraph,e,t),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,e,t),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0);this.isInShape&&this.showResizerForShape()}},t.prototype.showResizerForShape=function(){var e=this.getCurrentTextFrame().containerShape;this.owner.imageResizerModule.positionImageResizer(e),this.owner.imageResizerModule.showImageResizer()},t.prototype.highlight=function(e,t,i){var r=0,n=0,o=void 0,s=void 0,a=void 0,l=void 0,d=this.getStartLineWidget(e,t,o,r);o=d.element,a=sf.base.isNullOrUndefined(o)?e.childWidgets[0]:o.line,r=d.index;var h=this.getEndLineWidget(i,s,n);l=(s=h.element)?s.line:i.paragraph.childWidgets[i.paragraph.childWidgets.length-1],n=h.index;var c=0,p=0;if(sf.base.isNullOrUndefined(a)||(c=this.getTop(a),p=this.getLeftInternal(a,o,r)),sf.base.isNullOrUndefined(a)||a!==l){if(!sf.base.isNullOrUndefined(a)){a.paragraph.x;e!==a.paragraph&&(e=a.paragraph);m=this.getWidth(a,!0)-(p-a.paragraph.x);if(e.bidi||o instanceof Fa&&o.isRightToLeft){u=0;var g=this.getElementsForward(a,o,s,e.bidi);if(g){for(x=!1,w=0;w<g.length;w++){x=!1,p=(b=g[w])===o?this.getLeftInternal(a,b,r):this.getLeftInternal(a,b,0);I=b instanceof Fa?b.length:1;u=this.getLeftInternal(a,b,I),b instanceof Fa&&(x=b.isRightToLeft),m=Math.abs(u-p),this.createHighlightBorder(a,m,x?u:p,c,!0)}if(a.isLastLine()){F=g[g.length-1].line.paragraph.characterFormat,C=this.documentHelper.textHelper.getParagraphMarkSize(F).Width;p=e.bidi?this.getLineStartLeft(a)-C:x?a.paragraph.x+this.getWidth(a,!1):u,this.createHighlightBorder(a,C,p,c,!0)}}else this.createHighlightBorder(a,m,p,c,!1)}else this.createHighlightBorder(a,m,p,c,!1);var f=a.paragraph.childWidgets.indexOf(a);if(this.highlightParagraph(e,f+1,l,s,n),-1!==e.childWidgets.indexOf(i.currentWidget))return}if(this.isHideSelection(e))return void(this.isHighlightNext=!1);this.isHighlightNext=!0,this.hightLightNextParagraph=e}else{var u=this.getLeftInternal(l,s,n),m=0,y=!1;if(s instanceof Fa&&(y=s.isRightToLeft),!y&&o instanceof Fa&&(y=o.isRightToLeft),m=Math.abs(u-p),y||e.bidi){var v=this.getElementsForward(a,o,s,e.bidi);if(v&&v.length>1)for(var w=0;w<v.length;w++){var b,x=!1,I=(b=v[w])instanceof Fa?b.length:1;if(b===o?(p=this.getLeftInternal(a,b,r),u=this.getLeftInternal(a,b,I)):b===s?(p=this.getLeftInternal(a,b,0),u=this.getLeftInternal(a,b,n)):(p=this.getLeftInternal(a,b,0),u=this.getLeftInternal(a,b,I)),b instanceof Fa&&(x=b.isRightToLeft),m=Math.abs(u-p),b===s&&b instanceof Fa&&n>b.length){var F=b.line.paragraph.characterFormat,C=this.documentHelper.textHelper.getParagraphMarkSize(F).Width;if(e.bidi&&!x){m-=C,this.createHighlightBorder(a,m,p,c,!0),p=this.getLineStartLeft(a)-C,this.createHighlightBorder(a,C,p,c,!0);continue}}this.createHighlightBorder(a,m,x?u:p,c,!0)}else if(s instanceof Fa&&n>s.length){var F=s.line.paragraph.characterFormat,C=this.documentHelper.textHelper.getParagraphMarkSize(F).Width;!e.bidi&&y?(u+=C,m-=C,this.createHighlightBorder(a,m,u,c,!0),u+=s.width,this.createHighlightBorder(a,C,u,c,!0)):e.bidi&&!y?(m-=C,this.createHighlightBorder(a,m,p,c,!0),p=this.getLineStartLeft(a)-C,this.createHighlightBorder(a,C,p,c,!0)):this.createHighlightBorder(a,m,y?u:p,c,!1)}else this.createHighlightBorder(a,m,y?u:p,c,!1)}else this.createHighlightBorder(a,m,e.bidi?u:p,c,!1)}},t.prototype.highlightNextBlock=function(e,t,i){var r=e.nextRenderedWidget;sf.base.isNullOrUndefined(r)||(r instanceof ca?(this.isHighlightNext=!1,this.highlight(r,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightTable(r,t,i))},t.prototype.getStartLineWidget=function(e,t,i,r){var n=e===t.paragraph?t.offset:this.getStartOffset(e),o=void 0;if(i=(o=e===t.paragraph?t.currentWidget.getInline(n,r):e.firstChild.getInline(n,r)).element,r=o.index,i instanceof va){var s=this.getRenderedInline(i,r);i=s.element,r=s.index}return n===this.getParagraphLength(t.paragraph)+1&&r++,{index:r,element:i}},t.prototype.getEndLineWidget=function(e,t,i){var r=e.currentWidget.getInline(e.offset,i);if(t=r.element,i=r.index,t instanceof va){var n=this.getRenderedInline(t,i);t=n.element,i=n.index}return e.paragraph.childWidgets.indexOf(e.currentWidget)===e.paragraph.childWidgets.length-1&&e.offset===this.getLineLength(e.currentWidget)+1&&(i=t?t.length+1:1),{index:i,element:t}},t.prototype.getLineWidgetInternal=function(e,t,i){var r=void 0;if(0===e.children.length&&e instanceof ma)r=e;else{var n=0,o=e.getInline(t,n),s=o.element;n=o.index,r=s instanceof ya?s.line:this.getLineWidgetInternalInline(s,n,i)}return r},t.prototype.getLineWidgetParagraph=function(e,t){var i=void 0;if(0===t.children.length)i=t;else{var r=0,n=t.getInline(e,r),o=n.element;r=n.index,i=this.getLineWidget(o,r)}return i},t.prototype.highlightCells=function(e,t,i){var r=this.getCellLeft(t.ownerRow,t),n=r+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth;r>o&&(r=o),n<s&&(n=s),r>this.upDownSelectionLength&&(r=this.upDownSelectionLength),n<this.upDownSelectionLength&&(n=this.upDownSelectionLength);var a=e.getSplitWidgets(),l=a.indexOf(t.ownerRow.ownerTable),d=a.indexOf(i.ownerRow.ownerTable);if(l===d)for(var h=e.childWidgets.indexOf(i.ownerRow),c=e.childWidgets.indexOf(t.ownerRow);c<=h;c++)this.highlightRow(e.childWidgets[c],r,n);else{var p=0,g=0;for(c=l;c<=d;c++){e=a[c],p=c===l?e.childWidgets.indexOf(t.ownerRow):0,g=c===d?e.childWidgets.indexOf(i.ownerRow):e.childWidgets.length-1;for(var f=p;f<=g;f++)this.highlightRow(e.childWidgets[f],r,n)}}},t.prototype.highlightTable=function(e,t,i){this.highlightInternal(e.childWidgets[0],t,i),i.paragraph.isInsideTable&&e.contains(i.paragraph.associatedCell)||this.highlightNextBlock(e,t,i)},t.prototype.getCellLeft=function(e,t){var i=0;return i+=t.x-t.margin.left},t.prototype.getNextParagraphRow=function(e){if(!sf.base.isNullOrUndefined(e.nextRenderedWidget)){var t=e.nextRenderedWidget.childWidgets[0].childWidgets[0];return this.documentHelper.getFirstParagraphBlock(t)}return this.getNextParagraphBlock(e.ownerTable)},t.prototype.getPreviousParagraphRow=function(e){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)){var t=e.previousRenderedWidget.lastChild,i=t.lastChild?t.lastChild:t.previousSplitWidget.lastChild;return this.documentHelper.getLastParagraphBlock(i)}return this.getPreviousParagraphBlock(e.ownerTable)},t.prototype.containsRow=function(e,t){if(-1!==e.childWidgets.indexOf(t))return!0;for(;t.ownerTable.isInsideTable;){if(-1!==e.childWidgets.indexOf(t))return!0;t=t.ownerTable.associatedCell}return-1!==e.childWidgets.indexOf(t)},t.prototype.highlightRow=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++){var n=this.getCellLeft(e,e.childWidgets[r]);x.round(t,2)<=x.round(n,2)&&x.round(n,2)<x.round(i,2)&&this.highlightCellWidget(e.childWidgets[r])}},t.prototype.highlightInternal=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++)this.highlightCellWidget(e.childWidgets[r]);i.paragraph.isInsideTable&&this.containsRow(e,i.paragraph.associatedCell)||e.nextRenderedWidget instanceof fa&&this.highlightInternal(e.nextRenderedWidget,t,i)},t.prototype.getLastParagraph=function(e){for(;e.nextSplitWidget&&e.nextSplitWidget.childWidgets.length>0;)e=e.nextSplitWidget;var t;return t=e.childWidgets.length>0?e.lastChild:e.previousSplitWidget.lastChild,this.documentHelper.getLastParagraphBlock(t)},t.prototype.containsCell=function(e,t){if(e.equals(t))return!0;for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable.associatedCell))return!0;t=t.ownerTable.associatedCell}return!1},t.prototype.isCellSelected=function(e,t,i){var r=this.getLastParagraph(e);return r===i.paragraph&&i.offset===this.getParagraphLength(r)+1||!this.containsCell(e,t.paragraph.associatedCell)||!this.containsCell(e,i.paragraph.associatedCell)},t.prototype.getContainerCellOf=function(e,t){for(;e.ownerTable.isInsideTable;){if(e.ownerTable.contains(t))return e;e=e.ownerTable.associatedCell}return e},t.prototype.getSelectedCell=function(e,t){if(e.ownerTable.equals(t.ownerTable))return e;for(;e.ownerTable.isInsideTable;){if(e.ownerTable.associatedCell.equals(t))return e;e=e.ownerTable.associatedCell}return e},t.prototype.getSelectedCells=function(){for(var e=[],t=0;t<this.selectedWidgets.keys.length;t++){var i=this.selectedWidgets.keys[t];i instanceof ua&&e.push(i)}return e},t.prototype.getNextParagraphCell=function(e){if(e.nextRenderedWidget&&e.nextRenderedWidget instanceof ua){(e=e.nextRenderedWidget).getSplitWidgets()[0]instanceof ua&&(e=e.getSplitWidgets()[0]);var t=e.firstChild;return t?this.documentHelper.getFirstParagraphBlock(t):this.getNextParagraphCell(e)}return e.nextSplitWidget&&0===e.nextSplitWidget.childWidgets.length&&(e=e.getSplitWidgets().pop()),this.getNextParagraphRow(e.containerWidget)},t.prototype.getPreviousParagraphCell=function(e){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof ua){var t=(e=e.previousRenderedWidget).lastChild;return this.documentHelper.getLastParagraphBlock(t)}return this.getPreviousParagraphRow(e.ownerRow)},t.prototype.getContainerCell=function(e){for(;!sf.base.isNullOrUndefined(e.ownerTable)&&e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},t.prototype.highlightCell=function(e,t,i,r){if(r.paragraph.isInsideTable){var n=this.getContainerCellOf(e,r.paragraph.associatedCell);if(n.ownerTable.contains(r.paragraph.associatedCell)){var o=this.getSelectedCell(e,n),s=this.getSelectedCell(r.paragraph.associatedCell,n);if(this.containsCell(n,r.paragraph.associatedCell))this.isCellSelected(n,i,r)?this.highlightCellWidget(n):o===n?(this.highlight(i.paragraph,i,r),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,i,r),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)):this.highlightContainer(o,i,r);else if(this.highlightCellWidget(n),n.ownerRow.equals(s.ownerRow))for(o=n;!sf.base.isNullOrUndefined(o.nextRenderedWidget)&&(o=o.nextRenderedWidget,this.highlightCellWidget(o),o!==s););else this.highlightCells(n.ownerTable,n,s)}else this.highlightContainer(n,i,r)}else{var a=this.getContainerCell(e);this.highlightContainer(a,i,r)}},t.prototype.highlightContainer=function(e,t,i){this.highlightInternal(e.containerWidget,t,i),this.highlightNextBlock(e.ownerTable.getSplitWidgets().pop(),t,i)},t.prototype.getPreviousValidElement=function(e){var t=void 0;if(this.documentHelper.isFormFillProtectedMode&&2===e.fieldType)return e;for(;e instanceof va;)x.isLinkedFieldCharacter(e)&&(e instanceof va&&0===e.fieldType?t=e:e instanceof va&&1===e.fieldType?(t=e,sf.base.isNullOrUndefined(e.fieldSeparator)&&(t=e=e.fieldBegin)):t=e=e.fieldBegin),e=e.previousNode;return sf.base.isNullOrUndefined(t)?e:t},t.prototype.getNextValidElement=function(e){var t=void 0;if(e instanceof Na&&1===e.bookmarkType)return e;for(;e instanceof va;){if(0===e.fieldType&&!sf.base.isNullOrUndefined(e.fieldEnd))return sf.base.isNullOrUndefined(t)?e:t;1!==e.fieldType||sf.base.isNullOrUndefined(e.fieldBegin)||(t=e),e=e.nextNode}return sf.base.isNullOrUndefined(t)?e:t},t.prototype.validateTextPosition=function(e,t){if(e.length===t&&(e.nextNode instanceof va||!(e instanceof Da)&&e.nextNode instanceof Na)){var i=this.getNextValidElement(e.nextNode);(i instanceof va&&1===i.fieldType||i instanceof Na&&1===i.bookmarkType)&&(e=i,t=this.documentHelper.isFormFillProtectedMode?0:1)}else if(0===t&&e.previousNode instanceof va){t=(e=this.getPreviousValidElement(e.previousNode))instanceof va?0:e.length,e instanceof va&&1===e.fieldType&&t++}return{element:e,index:t}},t.prototype.getPhysicalPositionInline=function(e,t,i){var r=void 0;r=this.getElementBox(e,t,i).element;var n=void 0;if(sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.line)){if(!(e instanceof va&&1===e.fieldType))return e instanceof va||e instanceof Na||e instanceof al?this.getFieldCharacterPosition(e):new I(0,0);r=e}var o,s=r.margin,a=0;if(r instanceof Fa&&"\v"===r.text&&sf.base.isNullOrUndefined(e.nextNode)&&!this.owner.editor.handledEnter?(n=this.getNextLineWidget(r.line.paragraph,r),t=0):n=r.line,a=this.getTop(n),r instanceof Da&&"Inline"===r.textWrappingStyle){var l=r.line.paragraph.characterFormat,d=this.getPreviousTextElement(e);if(sf.base.isNullOrUndefined(d)){var h=this.getNextTextElement(e);sf.base.isNullOrUndefined(h)||(l=h.characterFormat)}else l=d.characterFormat;var c=this.documentHelper.textHelper.getHeight(l);r.margin.top+r.height-c.BaselineOffset>0&&(a+=r.margin.top+r.height-c.BaselineOffset)}else r instanceof va||(a+=s.top>0?s.top:0);return o=sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(n)?0:this.getLeftInternal(n,r,t),new I(o,a)},t.prototype.getFieldCharacterPosition=function(e){var t=this.getNextValidElementForField(e);if(sf.base.isNullOrUndefined(t)){var i=e.line.paragraph;return this.getEndPosition(i)}return this.getPhysicalPositionInline(t,0,!0)},t.prototype.isRenderBookmarkAtEnd=function(e){var t;if((t=1==e.bookmarkType?e.reference:e)&&sf.base.isNullOrUndefined(t.properties)){var i=t.reference?t.reference.paragraph.associatedCell:void 0;if(sf.base.isNullOrUndefined(i))return!1;var r=t.reference?t.reference.paragraph.associatedCell.ownerRow:void 0,n=r?r.childWidgets[r.childWidgets.length-1]:void 0;return!sf.base.isNullOrUndefined(n)&&i==n}return!1},t.prototype.getNextValidElementForField=function(e){if(e instanceof va&&0===e.fieldType&&x.isLinkedFieldCharacter(e)){var t=e;e=sf.base.isNullOrUndefined(t.fieldSeparator)?t.fieldEnd:t.fieldSeparator}var i=void 0;return sf.base.isNullOrUndefined(e.nextNode)||(i=this.getNextValidElement(e.nextNode)),i},t.prototype.getEndPosition=function(e){var t=e.x,i=e.y,r=void 0;e.childWidgets.length>0&&(r=e.childWidgets[e.childWidgets.length-1],t+=this.getWidth(r,!1)),sf.base.isNullOrUndefined(r)||(i=this.getTop(r));var n=this.getParagraphMarkSize(e,0,0);return new I(t,i+n.topMargin)},t.prototype.getElementBox=function(e,t,i){var r=void 0;return e instanceof va||e instanceof Na||e instanceof al||(r=e),{element:r,index:t}},t.prototype.getPreviousTextElement=function(e){return e.previousNode instanceof Fa?e.previousNode:sf.base.isNullOrUndefined(e.previousNode)?void 0:this.getPreviousTextElement(e.previousNode)},t.prototype.getNextTextElement=function(e){return e.nextNode instanceof Fa?e.nextNode:sf.base.isNullOrUndefined(e.nextNode)?void 0:this.getNextTextElement(e.nextNode)},t.prototype.getNextRenderedElementBox=function(e,t){if(e instanceof va){if(0===(r=e).fieldType&&r===(e=this.getRenderedField(r)))return r;t=1}for(;!sf.base.isNullOrUndefined(e)&&t===e.length&&e.nextNode instanceof va;){var i=this.getNextValidElement(e.nextNode);if(i instanceof va&&0===i.fieldType){var r=i;if(e=this.getRenderedField(r),!sf.base.isNullOrUndefined(e)&&r===e)return r;t=1}else e=i}return e},t.prototype.getElementBoxInternal=function(e,t){return{element:e,index:t}},t.prototype.getLineWidget=function(e,t){return this.getLineWidgetInternalInline(e,t,!0)},t.prototype.getLineWidgetInternalInline=function(e,t,i){var r=this.getElementBox(e,t,i),n=r.element;if(t=r.index,!sf.base.isNullOrUndefined(n))return i&&n instanceof Fa&&"\v"===n.text&&1===t?this.getNextLineWidget(n.line.paragraph,n):n.line;var o=e,s=this.getNextValidElementForField(o);if(sf.base.isNullOrUndefined(s)){var a=void 0,l=o.line.paragraph;return l.childWidgets.length>0&&(a=l.childWidgets[l.childWidgets.length-1]),a}return this.getLineWidget(s,0)},t.prototype.getNextLineWidget=function(e,t){var i=void 0,r=e;if(r.childWidgets.length>0){var n=r.childWidgets.indexOf(t.line);n===r.childWidgets.length-1?(r=e,n=-1):n>r.childWidgets.length-1?(r=this.getNextParagraphBlock(e),n=-1):n<0&&(n=(r=e).childWidgets.indexOf(t.line)),i=r.childWidgets[n+1]}return i},t.prototype.getCaretHeight=function(e,t,i,r,n,o){var s=this.getElementBox(e,t,!1).element,a=e;if(sf.base.isNullOrUndefined(s))return a instanceof va?this.getFieldCharacterHeight(a,i,r,n,o):{height:this.documentHelper.textHelper.getHeight(i).Height,topMargin:n,isItalic:o};var l=s.margin,d=s.height,h=0;if(s instanceof Da){var c=this.getPreviousTextElement(e),p=this.getNextTextElement(e);if(sf.base.isNullOrUndefined(c)&&sf.base.isNullOrUndefined(p)){var g=0,f=0,u=e.line.paragraph,m=this.getParagraphMarkSize(u,g,f);g=m.topMargin,f=m.bottomMargin,h=m.height,o=u.characterFormat.italic,r||(h+=this.documentHelper.layout.getAfterSpacing(u))}else{if(sf.base.isNullOrUndefined(c))return o=p.characterFormat.italic,this.getCaretHeight(p,0,p.characterFormat,r,n,o);if(sf.base.isNullOrUndefined(p)||!(s instanceof Da))return o=c.characterFormat.italic,this.getCaretHeight(c,c.length,c.characterFormat,r,n,o);var y=this.documentHelper.textHelper.getHeight(s.characterFormat),v=y.Height,w=y.BaselineOffset;h=s.margin.top<0&&w>s.margin.top+s.height?s.margin.top+s.height+v-w:v,r||(h+=s.margin.bottom)}}else{var b=i.baselineAlignment,x=d;"Normal"!==b&&r&&(x/=1.5,"Subscript"===b&&(n=d-x)),h=(l.top<0?l.top:0)+x,r||(h+=l.bottom)}if(!r)return{height:h,topMargin:n,isItalic:o};var I=this.documentHelper.textHelper.getHeight(i).Height;return I>h&&(I=h),{height:I,topMargin:n,isItalic:o}},t.prototype.getFieldCharacterHeight=function(e,t,i,r,n){var o=this.getNextValidElementForField(e);if(sf.base.isNullOrUndefined(o)){var s=e.line.paragraph,a=this.documentHelper.textHelper.getParagraphMarkSize(t).Height,l=0,d=0,h=this.getParagraphMarkSize(s,l,d),c=h.height;return l=h.topMargin,d=h.bottomMargin,i?(a>c&&(a=c),{height:a,topMargin:r,isItalic:n}):{height:c+=d,topMargin:r,isItalic:n}}return this.getCaretHeight(o,0,t,i,r,n)},t.prototype.getRenderedInline=function(e,t){if(this.documentHelper.isFormFillProtectedMode&&2===e.fieldType)return{element:e,index:t};for(var i=this.getPreviousValidElement(e);i instanceof va;)(i=this.getPreviousTextElement(i))instanceof va&&(i=i.previousNode);if(!sf.base.isNullOrUndefined(i))return{element:i,index:t=i.length};t=0;var r=this.getNextRenderedElementBox(e,0);if(r instanceof va&&0===r.fieldType)for(r=(r=r.fieldSeparator).nextNode;r instanceof va;)r instanceof va&&0===r.fieldType&&x.isLinkedFieldCharacter(r)&&(r=sf.base.isNullOrUndefined(r.fieldSeparator)?r.fieldEnd:r.fieldSeparator),r=r.nextNode;return{element:r,index:t}},t.prototype.getRenderedField=function(e){var t=e;if(sf.base.isNullOrUndefined(e.fieldSeparator))t=e.fieldEnd;else{var i=(t=e.fieldSeparator).line.paragraph;if(i!==e.fieldEnd.line.paragraph||this.hasValidInline(i,t,e.fieldEnd))return t;t=e.fieldEnd}return t},t.prototype.isLastRenderedInline=function(e,t){for(;t===e.length&&e.nextNode instanceof va;){var i=this.getNextValidElement(e.nextNode);if(t=0,i instanceof va&&0===i.fieldType&&(e=i),e instanceof va&&0===e.fieldType&&!sf.base.isNullOrUndefined(e.fieldEnd)){var r=e;if(sf.base.isNullOrUndefined(r.fieldSeparator))e=r.fieldEnd,t=1;else{var n=(e=r.fieldSeparator).line.paragraph;if(t=1,n!==r.fieldEnd.line.paragraph||this.hasValidInline(n,e,r.fieldEnd))break;e=r.fieldEnd}}}return t===e.length&&sf.base.isNullOrUndefined(e.nextNode)},t.prototype.getPage=function(e){var t=void 0;if(e.containerWidget instanceof Aa){var i=e.containerWidget.containerShape;i.line&&(t=this.getPage(i.line.paragraph))}else if(e.containerWidget instanceof sa){e.containerWidget;t=e.containerWidget.page}else sf.base.isNullOrUndefined(e.containerWidget)||(t=this.getPage(e.containerWidget));return t},t.prototype.clearSelectionHighlightInSelectedWidgets=function(){var e=!1,t=this.selectedWidgets.keys;if(!this.viewer.documentHelper.isDragStarted){for(var i=0;i<t.length;i++)this.removeSelectionHighlight(t[i]),e=!0;this.selectedWidgets.clear()}return e},t.prototype.clearChildSelectionHighlight=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t]instanceof ma?this.clearSelectionHighlightLineWidget(e.childWidgets[t]):e.childWidgets[t]instanceof ua?this.clearSelectionHighlight(e.childWidgets[t]):e.childWidgets[t]instanceof oa&&this.clearChildSelectionHighlight(e.childWidgets[t])},t.prototype.getLineWidgetBodyWidget=function(e,t,i){i=!!sf.base.isNullOrUndefined(i)||i;var r=e;if(r instanceof sa)for(var n=0;n<r.floatingElements.length;n++){var o=r.floatingElements[n];if(o instanceof ga){var s=o.getTableCellWidth();if(t.x<=o.x+s&&t.x>=o.x&&t.y<=o.y+o.height&&t.y>=o.y)return this.getLineWidgetTableWidget(o,t)}else if(o instanceof Ba&&o.x<=t.x&&o.x+o.width>=t.x&&o.y<=t.y&&o.y+o.height>=t.y)return o.line}if(e instanceof ha)for(var a=void 0,l=!1,d=0;d<e.bodyWidgets.length;d++)if(e.sectionFormat.columns.length<=1)for(var h=0;h<e.bodyWidgets[d].childWidgets.length;h++){if((g=e.bodyWidgets[d].childWidgets[h])instanceof oa&&g.y<=t.y&&g.y+g.height>=t.y)return g instanceof ca?this.getLineWidgetParaWidget(g,t):this.getLineWidgetTableWidget(g,t)}else{var c=e.bodyWidgets[d];if(c.firstChild.x+c.sectionFormat.columns[c.columnIndex].width>=t.x&&c.firstChild.x<=t.x&&c.firstChild.y<=t.y&&this.documentHelper.layout.getNextWidgetHeight(c)>=t.y||c.firstChild.x+c.sectionFormat.columns[c.columnIndex].width<t.x&&c.firstChild.y<=t.y&&this.documentHelper.layout.getNextWidgetHeight(c)>=t.y?a=c:e.x>t.x&&c.firstChild.y<=t.y&&this.documentHelper.layout.getNextWidgetHeight(c)>=t.y&&!l&&(a=c,l=!0),d===e.bodyWidgets.length-1&&!sf.base.isNullOrUndefined(a))for(h=0;h<a.childWidgets.length;h++){if((g=a.childWidgets[h])instanceof oa&&g.y<=t.y&&g.y+g.height>=t.y)return g instanceof ca?this.getLineWidgetParaWidget(g,t):this.getLineWidgetTableWidget(g,t)}}for(var p=0;p<e.childWidgets.length;p++){if((y=e.childWidgets[p])instanceof ha)for(d=0;d<y.bodyWidgets.length;d++){var g;if((g=y.bodyWidgets[d].childWidgets[0])instanceof oa&&g.y<=t.y&&g.y+g.height>=t.y)return g instanceof ca?this.getLineWidgetParaWidget(g,t):this.getLineWidgetTableWidget(g,t)}else if(y instanceof oa&&y.y<=t.y&&y.y+y.height>=t.y){if(y instanceof ca)return this.getLineWidgetParaWidget(y,t);var f=y;if(f.wrapTextAround)continue;return this.getLineWidgetTableWidget(f,t)}}var u=void 0;if(i&&e.childWidgets.length>0){var m=e.childWidgets[0];if(m instanceof oa&&m.y<=t.y)if(e.childWidgets[e.childWidgets.length-1]instanceof ca)for(p=0;p<e.childWidgets.length;p++)u=this.getLineWidgetParaWidget(e.childWidgets[p],t);else for(p=0;p<e.childWidgets.length;p++)u=this.getLineWidgetTableWidget(e.childWidgets[p],t);else{var y=void 0;m instanceof oa&&(y=m),sf.base.isNullOrUndefined(y)||(u=y instanceof ca?this.getLineWidgetParaWidget(m,t):this.getLineWidgetTableWidget(m,t))}}return u},t.prototype.getLineWidgetParaWidget=function(e,t){for(var i=e.childWidgets,r=e.y,n=0;n<i.length;n++){var o=i[n];r+=o.marginTop;var s=o.height;if(o.nextLine&&o.nextLine.marginTop>0&&(s+=o.nextLine.marginTop),r<=t.y&&r+s>=t.y)return o;r+=o.height}var a=void 0;return i.length>0&&(a=e.y<=t.y?i[i.length-1]:i[0]),a},t.prototype.highlightParagraph=function(e,t,i,r,n){var o=0,s=0,a=!1;e.paragraphFormat.bidi&&i.children.indexOf(r)>0&&(r=i.children[0]);for(var l=t;l<e.childWidgets.length;l++){var d=e.childWidgets[l];l===t?o=this.getTop(d):o+=d.marginTop,r instanceof Fa&&(a=r.isRightToLeft);var h=this.getLeft(d);if(d===i){var c=0;if(a||e.bidi){for(var p=this.getElementsBackward(d,r,r,e.bidi),g=0;g<p.length;g++){var f=p[g],u=!1;if(f===r)c=this.getLeftInternal(d,f,f.length);else{var m=f instanceof Fa?f.length:1;c=this.getLeftInternal(d,f,m)}if(h=this.getLeftInternal(d,f,0),f instanceof Fa&&(u=f.isRightToLeft),s=Math.abs(c-h),f===r&&f instanceof Fa&&n>f.length){var y=this.documentHelper.textHelper.getParagraphMarkSize(f.line.paragraph.characterFormat).Width;if(!e.bidi&&u)c+=y;else if(e.bidi&&!u){s-=y,this.createHighlightBorder(d,s,h,o,!0),h=this.getLineStartLeft(d)-y,this.createHighlightBorder(d,y,h,o,!0);continue}}this.createHighlightBorder(d,s,u?c:h,o,!0)}return}return c=this.getLeftInternal(i,r,n),s=Math.abs(c-h),void this.createHighlightBorder(d,s,a?c:h,o,!1)}s=this.getWidth(d,!0)-(h-e.x),e.bidi&&d.isLastLine()&&(h-=this.documentHelper.textHelper.getParagraphMarkSize(e.characterFormat).Width),this.createHighlightBorder(d,s,h,o,!1),o+=d.height}},t.prototype.getLineWidgetTableWidget=function(e,t){for(var i=void 0,r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];if(n instanceof fa&&n.y<=t.y){if("Exactly"===n.rowFormat.heightType&&n.y+x.convertPointToPixel(n.rowFormat.height)<t.y)continue;i=this.getLineWidgetRowWidget(n,t);var o=void 0;!sf.base.isNullOrUndefined(i)&&i.paragraph.containerWidget instanceof ua&&(o=i.paragraph.containerWidget);var s=0,a=0;if(!sf.base.isNullOrUndefined(o)){var l=o.ownerRow.containerWidget;s=x.convertPointToPixel(l.tableFormat.cellSpacing),a=o.cellFormat.rowSpan}var d=0,h=0,c=0,p=0;if(s>0){d=0===o.cellIndex?s:s/2,h=o.cellIndex===o.ownerRow.childWidgets.length-1?s:s/2;var g=void 0;o.containerWidget instanceof fa&&(g=o.containerWidget);l=void 0;o.containerWidget.containerWidget instanceof ga&&(l=o.containerWidget.containerWidget),sf.base.isNullOrUndefined(g)||sf.base.isNullOrUndefined(l)||(c=0===o.ownerRow.rowIndex?s:s/2,p=o.ownerRow.rowIndex+a===o.ownerTable.childWidgets.length?s:s/2)}if(!sf.base.isNullOrUndefined(i)&&i.paragraph.x<=t.x&&i.paragraph.x+i.width>=t.x&&i.paragraph.y<=t.y&&this.getTop(i)+i.height>=t.y||!sf.base.isNullOrUndefined(o)&&o.x-o.margin.left-d<=t.x&&o.x+o.width+o.margin.right+h>=t.x&&o.y-o.margin.top-c<=t.y&&o.y+o.height+o.margin.bottom+p>=t.y)break}}return i},t.prototype.getLineWidgetRowWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var r,n=0,o=0;if((r=x.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))>0&&(n=0===e.childWidgets[i].columnIndex?r:r/2,o=e.childWidgets[i].cellIndex===e.childWidgets[i].ownerRow.childWidgets.length-1?r:r/2),e.childWidgets[i].x-e.childWidgets[i].margin.left-n<=t.x&&e.childWidgets[i].x+e.childWidgets[i].width+e.childWidgets[i].margin.right+o>=t.x)return this.getLineWidgetCellWidget(e.childWidgets[i],t)}var s=void 0;return e.childWidgets.length>0&&(s=e.childWidgets[0].x<=t.x?this.getLineWidgetCellWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetCellWidget(e.childWidgets[0],t)),s},t.prototype.getFirstBlock=function(e){if(e.childWidgets.length>0)return e.childWidgets[0]},t.prototype.highlightCellWidget=function(e){var t=[];e.previousSplitWidget||e.nextSplitWidget?t=e.getSplitWidgets():t.push(e);for(var i=0;i<t.length;i++)e=t[i],this.clearChildSelectionHighlight(e),this.createHighlightBorderInsideTable(e)},t.prototype.clearSelectionHighlight=function(e){this.selectedWidgets.containsKey(e)&&(this.removeSelectionHighlight(e),this.selectedWidgets.remove(e))},t.prototype.getLineWidgetCellWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i].y<=t.y&&e.childWidgets[i].y+e.childWidgets[i].height>=t.y)return e.childWidgets[i]instanceof ca?this.getLineWidgetParaWidget(e.childWidgets[i],t):this.getLineWidgetTableWidget(e.childWidgets[i],t);var r=void 0;return e.childWidgets.length>0&&e.childWidgets[0].y-e.margin.top<=t.y&&(r=e.childWidgets[e.childWidgets.length-1]instanceof ca?this.getLineWidgetParaWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetTableWidget(e.childWidgets[0],t)),r},t.prototype.updateTextPosition=function(e,t){var i=t,r=void 0,n=0,o=!1;if(this.owner.enableHeaderAndFooter){var s=this.start.paragraph.bodyWidget;-1!=s.headerFooterType.indexOf("Header")?this.comparePageWidthAndMargins(s.page.headerWidget,s.page):this.comparePageWidthAndMargins(s.page.footerWidget,s.page)}var a=this.updateTextPositionIn(e,r,n,t,!1);sf.base.isNullOrUndefined(a)||(r=a.element,n=a.index,i=a.caretPosition,o=a.isImageSelected,this.isImageSelected=o),o?(this.selectInternal(e,r,n,i),0===n?this.extendForward():this.extendBackward()):(sf.base.isNullOrUndefined(this.owner.imageResizerModule)||this.owner.imageResizerModule.selectedImageWidget.clear(),this.selectInternal(e,r,n,i))},t.prototype.updateTextPositionIn=function(e,t,i,r,n){var o=!1,s=this.getTop(e),a=e.paragraph.x,l=this.getFirstElement(e,a),d=l.element,h=!1,c=!1;a=l.left;var p=e.renderedElements;if(sf.base.isNullOrUndefined(d)){var g=0,f=0,u=this.getParagraphMarkSize(e.paragraph,g,f);g=u.topMargin,f=u.bottomMargin,(!(this.documentHelper.mouseDownOffset.y>=s&&this.documentHelper.mouseDownOffset.y<s+e.height)||this.documentHelper.mouseDownOffset.x<a+u.width)&&n&&r.x>a+u.width/2?(a+=u.width,p.length>0&&(i=(t=p[p.length-1]).length),i++):e.paragraph.isEmpty()&&e.paragraph.bidi&&(a+=u.width),r=new I(a,g>0?s+g:s)}else if(!sf.base.isNullOrUndefined(d)){if(r.x>a+d.margin.left||d instanceof Ba&&"Inline"!==d.textWrappingStyle){var m=!1;e.paragraph.floatingElements.length>0&&(m=this.documentHelper.checkPointIsInLine(e,r));for(var y=p.indexOf(d);y<p.length;y++)if((d=p[y])instanceof Ba&&"Inline"!==d.textWrappingStyle){if(this.documentHelper.isInShapeBorder(d,r)&&!this.documentHelper.isSelectionChangedOnMouseMoved&&!m){a=d.x,s=d.y;break}}else{var v=!1;if((d instanceof Va||d instanceof Fa)&&(v=d.line.paragraph.paragraphFormat.bidi),r.x<a+d.margin.left+d.width+d.padding.left||y===p.length-1||p[y+1]instanceof Va&&v)break;a+=d.margin.left+d.width+d.padding.left}if(d instanceof Fa&&(h=d.isRightToLeft,c=d.line.paragraph.paragraphFormat.bidi),r.x>a+d.margin.left+d.width+d.padding.left)i=d instanceof Fa?d.length:1,h&&c&&(i=0),(d instanceof Fa&&"\v"!==d.text&&"\f"!==d.text&&d.text!==String.fromCharCode(14)||n)&&(a+=d.margin.left+d.width+d.padding.left);else if(d instanceof Fa){d instanceof Fa&&h&&(a+=d.width+d.padding.left);var w=0;w=h?a+d.margin.left-r.x:r.x-a-d.margin.left-d.padding.left,a+=d.margin.left+d.padding.left;var b=0,x=0;for(y=1;y<=d.length;y++){var F=0;if(y===d.length?F=d.width+d.padding.left:(F=this.documentHelper.textHelper.getWidth(d.text.substr(0,y),d.characterFormat,d.scriptType),d.trimEndWidth=F),w<F||y===d.length){if(w-b>(F-b)/2)h?a-=F:a+=F,x=y;else if(h?a-=b:a+=b,x=y-1,1===y&&d!==p[0]&&!(p[0]instanceof Ba&&"Inline"!==p[0].textWrappingStyle)){var C=p.indexOf(d);p[C-1]instanceof Va||h||((d=p[C-1])instanceof Ba&&"Inline"!==d.textWrappingStyle&&0==x&&!sf.base.isNullOrUndefined(d.previousElement)&&(d=p[p.indexOf(d)-1]),x=d instanceof Fa?d.length:1)}break}b=F}i=x}else if(o=d instanceof Da||d instanceof La,r.x-a-d.margin.left>d.width/2)i=1,a+=d.margin.left+d.width+d.padding.left;else if(d!==p[0]&&!o){C=p.indexOf(d);p[C-1]instanceof Va||(i=(d=p[C-1])instanceof Fa?d.length:1)}d instanceof Fa&&("\v"===d.text||"\f"===d.text||d.text===String.fromCharCode(14))&&(i=0)}else h=d.isRightToLeft,c=d.line.paragraph.paragraphFormat.bidi,i=d instanceof Fa&&(c||h)&&r.x<a+d.margin.left+d.width+d.padding.left?this.getTextLength(d.line,d)+d.length:this.getTextLength(d.line,d),a+=d.margin.left;if(d instanceof Fa)s+=d.margin.top>0?d.margin.top:0;else{var W=this.documentHelper.textHelper.getHeight(d.characterFormat),k=d.height;d instanceof Na&&!this.documentHelper.layout.hasValidElement(d.line.paragraph)&&(k=W.Height),s+=d.margin.top+k-W.BaselineOffset}(t=d)instanceof va&&2===t.fieldType&&!sf.base.isNullOrUndefined(t.fieldBegin)&&(t=t.fieldBegin,i=0),t instanceof qa&&(i=0),!sf.base.isNullOrUndefined(t.previousElement)&&t.previousElement instanceof Ba&&"Inline"!==t.previousElement.textWrappingStyle&&0==i&&(t=t.previousElement);var S=this.validateTextPosition(t,i);t=S.element,i=S.index;var P=sf.base.isNullOrUndefined(t.nextNode)&&i===t.length,N=t.line.isEndsWithLineBreak&&t instanceof Fa&&"\v"===t.text;if(n&&t.nextNode instanceof va&&i===t.length&&(P=this.isLastRenderedInline(t,i)),n&&P||N){F=0;if(P)F=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat),(!(this.documentHelper.mouseDownOffset.y>=s&&this.documentHelper.mouseDownOffset.y<s+e.height)||this.documentHelper.mouseDownOffset.x<a+F)&&r.x>a+F/2&&(a+=F,i=t.length+1);else N&&(a+=F=d.width+d.padding.left)}r=new I(a,s)}return{element:t,index:i,caretPosition:r,isImageSelected:o}},t.prototype.checkAllFloatingElements=function(e,t){var i,r,n=!1,o=!1;if(!sf.base.isNullOrUndefined(e)){i=e.paragraph.bodyWidget,n=!1,o=!1;for(var s=0;s<i.floatingElements.length;s++)if(!(i.floatingElements[s]instanceof ga)&&(r=i.floatingElements[s],t.x<r.x+r.margin.left+r.width&&t.x>r.x&&t.y<r.y+r.margin.top+r.height&&t.y>r.y)){n=!0,this.documentHelper.isInShapeBorder(r,t)&&(o=!0);break}}return{element:r,caretPosition:t,isShapeSelected:n,isInShapeBorder:o}},t.prototype.getTextLength=function(e,t){var i=0,r=e.renderedElements,n=r.indexOf(t);r.length>0&&r[0]instanceof Va&&(r[1]instanceof Va?n-=2:n-=1);for(var o=1;o<n;o++)i+=r[o].length;return i},t.prototype.getLeft=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!i.bidi&&"Right"!==i.textAlignment&&(t+=x.convertPointToPixel(i.firstLineIndent));for(var r=e.renderedElements,n=0;n<r.length;n++){var o=r[n];if(!(o instanceof Va)||i.bidi){t+=o.margin.left;break}t+=0===n?o.margin.left+o.width:o.width}return t},t.prototype.getTop=function(e){for(var t=e.paragraph.y,i=e.paragraph.childWidgets.indexOf(e),r=0;r<i;r++){var n=e.paragraph.childWidgets[r];t=t+n.height+n.marginTop}return t+=e.marginTop},t.prototype.getFirstElement=function(e,t){var i=0;this.isParagraphFirstLine(e)&&!e.paragraph.paragraphFormat.bidi&&(i=x.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent)),t+=i;for(var r=void 0,n=e.renderedElements,o=0;o<n.length&&((r=n[o])instanceof Va||r instanceof al);o++){if(e.paragraph.paragraphFormat.bidi){t+=r.margin.left,r=void 0;break}t+=r.margin.left+r.width,r=void 0}return{element:r,left:t}},t.prototype.getIndexInInline=function(e){var t=0;if(e instanceof Fa)for(var i=e.line.children.indexOf(e),r=0;r<i;r++){var n=e.line.children[r];n instanceof va||n instanceof Va||(t+=n.length)}return t},t.prototype.isParagraphFirstLine=function(e){return!(!sf.base.isNullOrUndefined(e.paragraph.previousSplitWidget)||e!==e.paragraph.firstChild)},t.prototype.isParagraphLastLine=function(e){return!(!sf.base.isNullOrUndefined(e.paragraph.nextSplitWidget)||e!==e.paragraph.lastChild)},t.prototype.getWidth=function(e,t){var i=0,r=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&!r.bidi&&(i+=x.convertPointToPixel(r.firstLineIndent));for(var n=0;n<e.children.length;n++){var o=e.children[n];o instanceof Ba&&"Inline"!==o.textWrappingStyle||(i+=o.margin.left+o.width+o.padding.left)}return t&&e.paragraph.childWidgets.indexOf(e)===e.paragraph.childWidgets.length-1&&sf.base.isNullOrUndefined(e.paragraph.nextSplitWidget)&&(i+=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat)),i},t.prototype.getLeftInternal=function(t,i,r){var n=t.paragraph.x,o=t.paragraph.paragraphFormat;this.isParagraphFirstLine(t)&&!o.bidi&&(n+=x.convertPointToPixel(t.paragraph.paragraphFormat.firstLineIndent));var s=t.renderedElements,a=s.indexOf(i);(1===s.length&&s[0]instanceof Va||2===s.length&&s[0]instanceof Va&&s[1]instanceof Va)&&(a=s.length);for(var l=!1,d=0;d<a;d++){var h=s[d];h instanceof va&&2===h.fieldType&&(l=!1),l||(h instanceof Ba&&"Inline"!==h.textWrappingStyle||(n+=1===d&&h instanceof Va?h.width:h instanceof Pa&&i===h?h.margin.left:h.margin.left+h.width+h.padding.left,h instanceof va&&0===h.fieldType&&(l=!0)))}var c=!1,p=t.paragraph.bidi;sf.base.isNullOrUndefined(i)||(c=i.characterRange===e.RightToLeft,p=i.line.paragraph.paragraphFormat.bidi,n+=i.margin.left+i.padding.left,i instanceof Ba&&!sf.base.isNullOrUndefined(i.nextElement)&&(n+=i.nextElement.margin.left+i.nextElement.padding.left),(c||1===this.documentHelper.moveCaretPosition&&!c&&p)&&(n+=i.width));var g=0;if(i instanceof Fa){if(0!==this.documentHelper.moveCaretPosition&&(p||c))return(c&&p&&2===this.documentHelper.moveCaretPosition||c&&!p&&1===this.documentHelper.moveCaretPosition)&&(n-=i.width),this.documentHelper.moveCaretPosition=0,n;r!==i.length||c?r>i.length?(g=this.documentHelper.textHelper.getParagraphMarkWidth(i.line.paragraph.characterFormat),c?n-=i.width+g:n+=i.width+g):(g=r===i.length&&c&&"Justify"===o.textAlignment?i.width:this.documentHelper.textHelper.getWidth(i.text.substr(0,r),i.characterFormat,i.scriptType),c?n-=g:n+=g):n+=i.width,this.documentHelper.moveCaretPosition=0}else if(r>0)if(sf.base.isNullOrUndefined(i)||i instanceof Va)n+=this.documentHelper.textHelper.getParagraphMarkWidth(t.paragraph.characterFormat);else if(i instanceof Ba&&"Inline"!==i.textWrappingStyle||(n+=i.width),2===r){var f=i.line.paragraph;n+=this.documentHelper.textHelper.getParagraphMarkWidth(f.characterFormat)}return n},t.prototype.getLineStartLeft=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;return this.isParagraphFirstLine(e)&&!i.bidi&&(t+=x.convertPointToPixel(i.firstLineIndent)),e.children.length>0&&(t+=e.children[0].margin.left),t},t.prototype.updateTextPositionWidget=function(e,t,i,r){var n,o=t,s=void 0,a=0;s=(n=this.updateTextPositionIn(e,s,a,o,r)).element,a=n.index,o=n.caretPosition,i.setPositionForSelection(e,s,a,o)},t.prototype.clearSelectionHighlightLineWidget=function(e){!sf.base.isNullOrUndefined(this.owner)&&this.selectedWidgets.length>0&&this.clearSelectionHighlight(this)},t.prototype.getFirstElementInternal=function(e){for(var t=void 0,i=e.children.length,r=0;r<i&&(t=e.children[r])instanceof Va;r++)t=void 0;return t},t.prototype.selectRange=function(e,t,i){this.start.setPositionInternal(e),this.end.setPositionInternal(t),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0,!0,i)},t.prototype.selectParagraphInternal=function(e,t){var i;if(!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(e.firstChild))if(i=e.firstChild,t)this.start.setPosition(i,t);else{var r=i.getEndOffset();this.start.setPositionParagraph(i,r)}this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0)},t.prototype.setPositionForBlock=function(e,t){var i;if(e instanceof ga&&(e=t?this.documentHelper.getFirstParagraphInFirstCell(e):this.documentHelper.getLastParagraphInLastCell(e)),e instanceof ca)if(i=new Al(this.owner),t)i.setPosition(e.firstChild,!0);else{var r=e.lastChild;i.setPositionParagraph(r,r.getEndOffset())}return i},t.prototype.selectContent=function(e,t){if(sf.base.isNullOrUndefined(e))throw new Error("textPosition is undefined.");this.start.setPositionInternal(e),this.end.setPositionInternal(e),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0)},t.prototype.selectInternal=function(e,t,i,r){this.start.setPositionForSelection(e,t,i,r),this.end.setPositionInternal(this.start),this.upDownSelectionLength=r.x,this.fireSelectionChanged(!0)},t.prototype.selects=function(e,t,i){this.documentHelper.clearSelectionHighlight(),this.start.setPositionForLineWidget(e,t),this.end.setPositionInternal(this.start),i||this.fireSelectionChanged(!0)},t.prototype.selectPosition=function(e,t){if(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t))throw new Error("TextPosition cannot be undefined");if(sf.base.isNullOrUndefined(e.paragraph)||e.offset>this.getParagraphLength(e.paragraph)+1)throw new Error("Start TextPosition is not valid.");if(sf.base.isNullOrUndefined(t.paragraph)||t.offset>this.getParagraphLength(t.paragraph)+1)throw new Error("End TextPosition is not valid.");e.isAtSamePosition(t)?this.selectRange(e,e):(e.isExistBefore(t)?t.validateForwardFieldSelection(e.getHierarchicalIndexInternal(),t.getHierarchicalIndexInternal()):e.validateForwardFieldSelection(t.getHierarchicalIndexInternal(),e.getHierarchicalIndexInternal()),this.selectRange(e,t))},t.prototype.fireSelectionChanged=function(e,t,i){this.isEmpty||(this.isForward?(this.start.updatePhysicalPosition(!0),this.end.updatePhysicalPosition(!1)):(this.start.updatePhysicalPosition(!1),this.end.updatePhysicalPosition(!0))),this.isModifyingSelectionInternally||(!this.documentHelper.isFormFillProtectedMode||!e||this.isFormatUpdated||this.documentHelper.isTextFormEmpty||this.owner.documentHelper.layout.isRelayout||(this.currentFormField=this.getCurrentFormField()),this.skipFormatRetrieval||this.retrieveCurrentFormatProperties(),this.documentHelper.clearSelectionHighlight(),this.hideToolTip(),this.owner.isLayoutEnabled&&!this.owner.isShiftingEnabled&&this.highlightSelection(!0,i),e&&(this.start.paragraph.isInHeaderFooter&&!this.owner.enableHeaderAndFooter?this.owner.enableHeaderAndFooter=!0:!this.start.paragraph.isInHeaderFooter&&this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1),this.owner.fireSelectionChange()),this.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.documentHelper.isInlineFormFillProtectedMode&&e&&(this.triggerFormFillEvent(t),this.previousSelectedFormField=this.currentFormField),this.owner.rulerHelper&&this.owner.documentEditorSettings&&this.owner.documentEditorSettings.showRuler&&this.owner.rulerHelper.updateRuler(this.owner,!1))},t.prototype.retrieveCurrentFormatProperties=function(){this.isRetrieveFormatting=!0;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start),this.retrieveImageFormat(e,t),this.retrieveCharacterFormat(e,t),this.retrieveParagraphFormat(e,t),this.retrieveSectionFormat(e,t),this.retrieveTableFormat(e,t),this.isRetrieveFormatting=!1,this.setCurrentContextType()},t.prototype.retrieveImageFormat=function(e,t){var i;if(e.currentWidget===t.currentWidget&&e.offset+1===t.offset){var r=t.currentWidget.getInline(t.offset,0);i=r.element;r.index;if(i instanceof Da)e.currentWidget.getOffset(i,0)!==e.offset&&(i=void 0)}i instanceof Da?this.imageFormat.copyImageFormat(i):this.imageFormat.clearImageFormat()},t.prototype.getPreviousContextType=function(e){var t=this.start;if(t.offset>0){var i=t.currentWidget.getInline(t.offset,0).element;return i=e?i.previousElement:t.currentWidget.getInline(t.offset-1,0).element,this.getContextElement(i)}},t.prototype.getNextContextType=function(e){var t=this.start,i=t.currentWidget.getInline(t.offset,0).element;return i=e&&i.nextElement?i.nextElement:t.currentWidget.getInline(t.offset+1,0).element,this.getContextElement(i)},t.prototype.getContextElement=function(e){return e instanceof Fa?"Text":e instanceof va||e instanceof Sa?"Field":e instanceof Na?"Bookmark":e instanceof Da?"Image":e instanceof La?"Shape":e instanceof ll||e instanceof al?"Comment":e instanceof Va?"List":e instanceof _a||e instanceof qa?"EditRange":void 0},t.prototype.setCurrentContextType=function(){var e=!!this.imageFormat.image,t=!sf.base.isNullOrUndefined(this.tableFormat)&&!sf.base.isNullOrUndefined(this.tableFormat.table),i=this.start.paragraph.paragraphFormat.baseStyle;if(i instanceof vl&&0===i.name.toLowerCase().indexOf("toc")){var r=this.getTocFieldInternal();if(!sf.base.isNullOrUndefined(r))return void(this.contextTypeInternal="TableOfContents")}var n=this.getCurrentRevision();if(n?(this.owner.showRevisions=!0,this.owner.dotNetRef.invokeMethodAsync("ShowRevisions",!0),this.owner.trackChangesPane.currentSelectedRevision=n[0]):sf.base.isNullOrUndefined(this.owner.trackChangesPane.currentSelectedRevision)||(this.owner.trackChangesPane.currentSelectedRevision=void 0),this.start.paragraph.isInHeaderFooter){var o=-1!==this.start.paragraph.bodyWidget.headerFooterType.indexOf("Header");this.contextTypeInternal=t?e?o?"HeaderTableImage":"FooterTableImage":o?"HeaderTableText":"FooterTableText":e?o?"HeaderImage":"FooterImage":o?"HeaderText":"FooterText"}else this.contextTypeInternal=t?e?"TableImage":"TableText":e?"Image":"Text"},t.prototype.addItemRevisions=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i];this.selectRevision(r),t?r.accept():r.reject()}},t.prototype.hasRevisions=function(){return!!this.getCurrentRevision()},t.prototype.getCurrentRevision=function(){var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start);var i,r=e.currentWidget.getInline(e.offset,0).element,n=e.paragraph,o=e.currentWidget.getInline(e.offset+1,0).element;if(r&&r===o){var s=r.line.getOffset(r,r.length);if((i=new Al(this.owner)).setPositionParagraph(r.line,s),t.offset===i.offset&&!sf.base.isNullOrUndefined(r.nextElement))return}if(!sf.base.isNullOrUndefined(r)&&r.revisions.length>0)return r.revisions;if(n.isInsideTable){var a=n.associatedCell;if(!sf.base.isNullOrUndefined(a.ownerRow)&&a.ownerRow.rowFormat.revisions.length>0)return a.ownerRow.rowFormat.revisions}return t.offset>t.paragraph.getLength()&&t.paragraph.characterFormat.revisions.length>0?t.paragraph.characterFormat.revisions:void 0},t.prototype.processLineRevisions=function(e,t){for(var i=0;i<e.children.length;i++){var r=e.children[i];r.revisions.length>0&&this.addItemRevisions(r,t)}},t.prototype.handleAcceptReject=function(e){if(this.isEmpty){var t=this.start.currentWidget.getInline(this.start.offset+1,0).element,i=this.start.paragraph;if(!sf.base.isNullOrUndefined(t)&&t.revisions.length>0&&this.addItemRevisions(t,e),i.isInsideTable){var r=i.associatedCell;if(sf.base.isNullOrUndefined(r)){if(!i.isEmpty())for(var n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=void 0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];this.processLineRevisions(a,e)}}else r.ownerRow.rowFormat.revisions.length>0&&this.addItemRevisions(r.ownerRow.rowFormat,e)}}else{var l=this.getselectedRevisionElements();for(n=0;n<l.length;n++)this.acceptReject(l[n],e)}},t.prototype.acceptReject=function(e,t){this.selectRevision(e),t?e.accept():e.reject()},t.prototype.getselectedRevisionElements=function(){var e=[],t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start);for(var r=0;r<this.selectedWidgets.length;r++){var n=this.selectedWidgets.keys[r];if(n instanceof ma)e=this.getSelectedLineRevisions(n,t,i,e);else if(n instanceof ua){n.ownerRow.rowFormat.revisions.length>0&&(e=this.addRevisionsCollec(n.ownerRow.rowFormat.revisions,e));for(var o=0;o<n.childWidgets.length;o++)for(var s=n.childWidgets[o],a=0;a<s.childWidgets.length;a++){var l=s.childWidgets[a];e=this.getSelectedLineRevisions(l,t,i,e)}}}return e},t.prototype.getSelectedLineRevisions=function(e,t,i,r){e.paragraph.characterFormat.revisions.length>0&&(r=this.addRevisionsCollec(e.paragraph.characterFormat.revisions,r));for(var n=0;n<e.children.length;n++){var o=e.children[n],s=o.line.getOffset(o,0),a=new Al(this.owner);a.setPositionParagraph(o.line,s),s=o.line.getOffset(o,o.length);var l=new Al(this.owner);l.setPositionParagraph(o.line,s),(l.isExistAfter(t)&&l.isExistBefore(i)||a.isExistAfter(t)&&a.isExistBefore(i)||a.isAtSamePosition(t)||t.isExistAfter(a)&&i.isExistBefore(l))&&o.revisions.length>0&&(r=this.addRevisionsCollec(o.revisions,r))}return r},t.prototype.addRevisionsCollec=function(e,t){for(var i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t},t.prototype.retrieveTableFormat=function(e,t){var i=this.getTable(e,t);sf.base.isNullOrUndefined(i)?this.tableFormat.clearFormat():(this.tableFormat.table=i,this.tableFormat.copyFormat(i.tableFormat),this.retrieveCellFormat(e,t),this.retrieveRowFormat(e,t))},t.prototype.retrieveCellFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.cellFormat.copyFormat(e.paragraph.associatedCell.cellFormat),this.getCellFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.cellFormat.clearCellFormat()},t.prototype.retrieveRowFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.rowFormat.copyFormat(e.paragraph.associatedCell.ownerRow.rowFormat),this.getRowFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.rowFormat.clearRowFormat()},t.prototype.getCellFormat=function(e,t,i){if(!t.paragraph.associatedCell.equals(i.paragraph.associatedCell))for(var r=!1,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(o===t.paragraph.associatedCell.ownerRow&&(r=!0),r)for(var s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(this.isCellSelected(a,t,i)&&this.cellFormat.combineFormat(a.cellFormat),a===i.paragraph.associatedCell)return void this.cellFormat.combineFormat(a.cellFormat)}}},t.prototype.getRowFormat=function(e,t,i){var r=t.paragraph.associatedCell.ownerRow;if(r!==i.paragraph.associatedCell.ownerRow)for(var n=e.childWidgets.indexOf(r)+1;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(this.rowFormat.combineFormat(o.rowFormat),o===i.paragraph.associatedCell.ownerRow)return}},t.prototype.getTable=function(e,t){if(!sf.base.isNullOrUndefined(e.paragraph.associatedCell)&&!sf.base.isNullOrUndefined(t.paragraph.associatedCell)){var i=e.paragraph.associatedCell.ownerTable,r=e.paragraph.associatedCell.ownerTable;if(i===r)return i;if(i.contains(e.paragraph.associatedCell))return i;if(r.contains(e.paragraph.associatedCell))return r;if(!i.isInsideTable||!r.isInsideTable)return;do{if((i=i.associatedCell.ownerTable)===r||i.contains(r.associatedCell))return i;if(r.contains(i.associatedCell))return r}while(!sf.base.isNullOrUndefined(i.associatedCell))}},t.prototype.getContainerWidget=function(e){var t;if(e.containerWidget instanceof Aa)t=e.containerWidget.containerShape.line.paragraph.bodyWidget;else if(e.containerWidget instanceof sa)t=!sf.base.isNullOrUndefined(e.containerWidget.containerWidget)&&e.containerWidget.containerWidget instanceof ha?e.containerWidget.containerWidget:e.containerWidget;else for(t=e.containerWidget;!(t instanceof sa);)t instanceof Aa&&(t=t.containerShape.line.paragraph),t=t.containerWidget;return t},t.prototype.retrieveSectionFormat=function(e,t){var i=this.getContainerWidget(e.paragraph),r=this.getContainerWidget(t.paragraph);if(!sf.base.isNullOrUndefined(i)){this.sectionFormat.copyFormat(i.sectionFormat);for(var n=this.documentHelper.pages.indexOf(i.page),o=this.documentHelper.pages.indexOf(r.page),s=n+1;s<=o;s++)this.sectionFormat.combineFormat(this.documentHelper.pages[s].bodyWidgets[0].sectionFormat)}},t.prototype.retrieveParagraphFormat=function(e,t){this.getParagraphFormatForSelection(e.paragraph,this,e,t)},t.prototype.getParagraphFormatForSelection=function(e,t,i,r){if(!i.paragraph.isInsideTable||r.paragraph.isInsideTable&&i.paragraph.associatedCell===r.paragraph.associatedCell&&!this.isCellSelected(i.paragraph.associatedCell,i,r)){if(this.getParagraphFormatInternalInParagraph(e,i,r),r.paragraph===e)return;var n=this.getNextRenderedBlock(e);sf.base.isNullOrUndefined(n)||this.getParagraphFormatInternalInBlock(n,i,r)}else this.getParagraphFormatInternalInCell(i.paragraph.associatedCell,i,r)},t.prototype.getParagraphFormatInternalInParagraph=function(e,t,i){t.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat)},t.prototype.getParagraphsInSelection=function(){var e=this.owner.selection,t=e.selectedWidgets.keys,i=[];if(e.isEmpty||e.start.paragraph===e.end.paragraph)return[e.start.paragraph];for(var r=0;r<t.length;r++){var n=t[r];-1===i.indexOf(n.paragraph)&&i.push(n.paragraph)}return i},t.prototype.getParagraphFormatInternalInBlock=function(e,t,i){if(e instanceof ca){if(this.getParagraphFormatInternalInParagraph(e,t,i),i.paragraph===e)return;var r=this.getNextRenderedBlock(e);sf.base.isNullOrUndefined(r)||this.getParagraphFormatInternalInBlock(r,t,i)}else this.getParagraphFormatInternalInTable(e,t,i)},t.prototype.getParagraphFormatInternalInTable=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++){for(var n=e.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.getParagraphFormatInCell(n.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e);this.getParagraphFormatInternalInBlock(s,t,i)},t.prototype.getParagraphFormatInCell=function(e){for(var t=0;t<e.childWidgets.length;t++)this.getParagraphFormatInBlock(e.childWidgets[t])},t.prototype.getParagraphFormatInBlock=function(e){e instanceof ca?this.getParagraphFormatInParagraph(e):this.getParagraphFormatInTable(e)},t.prototype.getParagraphFormatInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.childWidgets.length;r++)this.getParagraphFormatInCell(i.childWidgets[r])},t.prototype.getParagraphFormatInParagraph=function(e){this.start.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat)},t.prototype.getParagraphFormatInternalInCell=function(e,t,i){if(i.paragraph.isInsideTable){var r=this.getContainerCellOf(e,i.paragraph.associatedCell);if(r.ownerTable.contains(i.paragraph.associatedCell)){var n=this.getSelectedCell(e,r),o=this.getSelectedCell(i.paragraph.associatedCell,r);if(this.containsCell(r,i.paragraph.associatedCell))if(this.isCellSelected(r,t,i))this.getParagraphFormatInCell(r);else if(n===r){if(this.getParagraphFormatInternalInParagraph(t.paragraph,t,i),i.paragraph===t.paragraph)return;var s=this.getNextRenderedBlock(t.paragraph);sf.base.isNullOrUndefined(s)||this.getParagraphFormatInternalInBlock(s,t,i)}else this.getParagraphFormatInRow(n.ownerRow,t,i);else this.getParaFormatForCell(r.ownerTable,r,o)}else this.getParagraphFormatInRow(r.ownerRow,t,i)}else{var a=this.getContainerCell(e);this.getParagraphFormatInRow(a.ownerRow,t,i)}},t.prototype.getParaFormatForCell=function(e,t,i){var r=this.getCellLeft(t.ownerRow,t),n=r+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth;r>o&&(r=o),n<s&&(n=s),r>this.upDownSelectionLength&&(r=this.upDownSelectionLength),r<this.upDownSelectionLength&&(r=this.upDownSelectionLength);for(var a=e.childWidgets.indexOf(i.ownerRow),l=e.childWidgets.indexOf(t.ownerRow);l<=a;l++)for(var d=e.childWidgets[l],h=0;h<d.childWidgets.length;h++){var c=d.childWidgets[h],p=this.getCellLeft(d,c);x.round(r,2)<=x.round(p,2)&&x.round(p,2)<x.round(n,2)&&this.getParagraphFormatInCell(c)}},t.prototype.getParagraphFormatInRow=function(e,t,i){for(var r=e.rowIndex;r<e.ownerTable.childWidgets.length;r++){for(var n=e.ownerTable.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.getParagraphFormatInCell(n.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e.ownerTable);this.getParagraphFormatInternalInBlock(s,t,i)},t.prototype.retrieveCharacterFormat=function(e,t){if(this.characterFormat.copyFormat(e.paragraph.characterFormat),e.paragraph.isEmpty()&&this.characterFormat.copyFormat(e.paragraph.characterFormat,this.documentHelper.textHelper.getFontNameToRender(0,e.paragraph.characterFormat)),e.paragraph!==t.paragraph||!e.currentWidget.isLastLine()||e.offset!==this.getLineLength(e.currentWidget)||e.offset+1!==t.offset){var i=e.paragraph;if(e.paragraph===t.paragraph&&this.isSelectList){var r=this.getListLevel(e.paragraph);r&&r.characterFormat.uniqueCharacterFormat&&this.characterFormat.copyFormat(r.characterFormat)}else{for(e.offset!==this.getParagraphLength(i)||this.isEmpty||(i=this.getNextParagraphBlock(i));!sf.base.isNullOrUndefined(i)&&i!==t.paragraph&&i.isEmpty();)i=this.getNextParagraphBlock(i);var n=i===e.paragraph?e.offset:0;if(!sf.base.isNullOrUndefined(i)&&!i.isEmpty()){var o=new Al(this.owner),s=e.currentWidget.getInline(n,0),a=this.getPhysicalPositionInternal(e.currentWidget,n,!0);o.setPositionForSelection(e.currentWidget,s.element,s.index,a),this.getCharacterFormatForSelection(i,this,o,t)}}}},t.prototype.getCharacterFormatForSelection=function(e,t,i,r){i.paragraph instanceof ca&&i.paragraph.isInsideTable&&(!r.paragraph.isInsideTable||i.paragraph.associatedCell!==r.paragraph.associatedCell||this.isCellSelected(i.paragraph.associatedCell,i,r))?this.getCharacterFormatInTableCell(i.paragraph.associatedCell,t,i,r):this.getCharacterFormat(e,i,r)},t.prototype.getCharacterFormatForTableRow=function(e,t,i){for(var r=e.rowIndex;r<e.ownerTable.childWidgets.length;r++){for(var n=e.ownerTable.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(n.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e.ownerTable);this.getCharacterFormatForBlock(s,t,i)},t.prototype.getCharacterFormatInTableCell=function(e,t,i,r){if(r.paragraph.isInsideTable){var n=this.getContainerCellOf(e,r.paragraph.associatedCell);if(n.ownerTable.contains(r.paragraph.associatedCell)){var o=this.getSelectedCell(e,n),s=this.getSelectedCell(r.paragraph.associatedCell,n);this.containsCell(n,r.paragraph.associatedCell)?this.isCellSelected(n,i,r)?this.getCharacterFormatForSelectionCell(n,i,r):o===n?this.getCharacterFormat(i.paragraph,i,r):this.getCharacterFormatForTableRow(o.ownerRow,i,r):this.getCharacterFormatInternalInTable(n.ownerTable,n,s,i,r)}else this.getCharacterFormatForTableRow(n.ownerRow,i,r)}else{var a=this.getContainerCell(e);this.getCharacterFormatForTableRow(a.ownerRow,i,r)}},t.prototype.getCharacterFormatInternalInTable=function(e,t,i,r,n){var o=this.getCellLeft(t.ownerRow,t),s=o+t.cellFormat.cellWidth,a=this.getCellLeft(i.ownerRow,i),l=a+i.cellFormat.cellWidth;o>a&&(o=a),s<l&&(s=l),o>this.upDownSelectionLength&&(o=this.upDownSelectionLength),s<this.upDownSelectionLength&&(s=this.upDownSelectionLength);for(var d=e.childWidgets.indexOf(i.ownerRow),h=e.childWidgets.indexOf(t.ownerRow);h<=d;h++)for(var c=e.childWidgets[h],p=0;p<c.childWidgets.length;p++){var g=c.childWidgets[p],f=this.getCellLeft(c,g);x.round(o,2)<=x.round(f,2)&&x.round(f,2)<x.round(s,2)&&this.getCharacterFormatForSelectionCell(g,r,n)}},t.prototype.getCharacterFormat=function(e,t,i){if((e===t.paragraph||e===i.paragraph||e.isEmpty()||(this.getCharacterFormatInternal(e,this),this.characterFormat.canRetrieveNextCharacterFormat()))&&(i.paragraph!==e||t.paragraph===e||0!==i.offset)){var r=0,n=this.getParagraphLength(e);if(e===t.paragraph)if(r=t.offset,this.setCharacterFormat(e,t,i,n))return;var o=-1!==e.childWidgets.indexOf(t.currentWidget)?e.childWidgets.indexOf(t.currentWidget):0,s=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):e.childWidgets.length-1,a=i.offset;e!==i.paragraph&&(a=n);for(var l=o;l<=s;l++){var d=e.childWidgets[l];l!==o&&(r=this.getStartLineOffset(d)),a=d===i.currentWidget?i.offset:this.getLineLength(d);for(var h=0,c=0;c<d.children.length;c++){var p=d.children[c];if(!(p instanceof Va))if(r>=h+p.length)h+=p.length;else if(p instanceof va&&0===p.fieldType&&x.isLinkedFieldCharacter(p)){var g=sf.base.isNullOrUndefined(p.fieldEnd)?p.fieldBegin:p.fieldEnd;c--;do{this.characterFormat.combineFormat(p.characterFormat),h+=p.length,p=p.nextNode,l++,c++}while(!sf.base.isNullOrUndefined(p)&&p!==g)}else{if((p instanceof Fa||p instanceof va)&&this.characterFormat.combineFormat(p.characterFormat,this.documentHelper.textHelper.getFontNameToRender(p.scriptType,p.characterFormat)),sf.base.isNullOrUndefined(p)||a<=h+p.length)break;h+=p.length}}}if(i.paragraph!==e){var f=this.getNextRenderedBlock(e);sf.base.isNullOrUndefined(f)||this.getCharacterFormatForBlock(f,t,i)}}},t.prototype.setCharacterFormat=function(e,t,i,r){var n=0,o=t.offset,s=t.currentWidget.getInline(o,n);n=s.index;var a=s.element;if(sf.base.isNullOrUndefined(a)){t.paragraph.childWidgets.indexOf(t.currentWidget);if(t.currentWidget.previousLine)return a=t.currentWidget.previousLine.children[t.currentWidget.previousLine.children.length-1],this.characterFormat.copyFormat(a.characterFormat,this.documentHelper.textHelper.getFontNameToRender(a.scriptType,a.characterFormat)),!0}if(o<r){if(this.isEmpty){if(a instanceof Fa||a instanceof va&&(0===a.fieldType||1===a.fieldType)){var l=this.getPreviousTextElement(a);0===o&&l&&(a=l),this.characterFormat.copyFormat(a.characterFormat,this.documentHelper.textHelper.getFontNameToRender(a.scriptType,a.characterFormat))}else if(sf.base.isNullOrUndefined(this.getPreviousTextElement(a)))if(sf.base.isNullOrUndefined(this.getNextTextElement(a)))this.characterFormat.copyFormat(e.characterFormat);else{d=this.getNextTextElement(a);this.characterFormat.copyFormat(d.characterFormat,this.documentHelper.textHelper.getFontNameToRender(d.scriptType,a.characterFormat))}else{var d=this.getPreviousTextElement(a);this.characterFormat.copyFormat(d.characterFormat,this.documentHelper.textHelper.getFontNameToRender(d.scriptType,a.characterFormat))}return!0}n!==a.length||sf.base.isNullOrUndefined(a.nextNode)?a instanceof Fa?this.characterFormat.copyFormat(a.characterFormat,this.documentHelper.textHelper.getFontNameToRender(a.scriptType,a.characterFormat)):a instanceof va&&this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(a)):this.characterFormat.copyFormat(this.getNextValidCharacterFormat(a),this.documentHelper.textHelper.getFontNameToRender(a.scriptType,a.characterFormat))}else if(r===i.offset)return a instanceof Fa||a instanceof va?this.characterFormat.copyFormat(a.characterFormat,this.documentHelper.textHelper.getFontNameToRender(a.scriptType,a.characterFormat)):sf.base.isNullOrUndefined(a)?this.characterFormat.copyFormat(e.characterFormat):(a=this.getPreviousTextElement(a),sf.base.isNullOrUndefined(a)||this.characterFormat.copyFormat(a.characterFormat,this.documentHelper.textHelper.getFontNameToRender(a.scriptType,a.characterFormat))),!0;return!1},t.prototype.getCharacterFormatForBlock=function(e,t,i){e instanceof ca?this.getCharacterFormat(e,t,i):this.getCharacterFormatInTable(e,t,i)},t.prototype.getCharacterFormatInTable=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++){for(var n=e.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(n.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell))return}var s=this.getNextRenderedBlock(e);sf.base.isNullOrUndefined(s)||this.getCharacterFormatForBlock(s,t,i)},t.prototype.getCharacterFormatForSelectionCell=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++)this.getCharacterFormatForBlock(e.childWidgets[r],t,i)},t.prototype.getCharacterFormatInternal=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.children.length;n++){var o=r.children[n];o instanceof Da||o instanceof va||o instanceof Va||t.characterFormat.combineFormat(o.characterFormat)}},t.prototype.getNextValidCharacterFormat=function(e){var t=this.getNextTextElement(e);if(sf.base.isNullOrUndefined(t))return e.characterFormat;var i=void 0;return t instanceof va&&0===i.fieldType&&(i=t),sf.base.isNullOrUndefined(i)?t.characterFormat:this.getNextValidCharacterFormatOfField(i)},t.prototype.getNextValidCharacterFormatOfField=function(e){var t=e;x.isLinkedFieldCharacter(e)&&(t=sf.base.isNullOrUndefined(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator);var i=void 0;return sf.base.isNullOrUndefined(t.nextNode)||(i=this.getNextValidElement(t.nextNode)),sf.base.isNullOrUndefined(i)?t.characterFormat:i.characterFormat},t.prototype.checkCursorIsInSelection=function(e,t){if(sf.base.isNullOrUndefined(this.start)||this.isEmpty||sf.base.isNullOrUndefined(e))return!1;var i=!1;do{if(this.selectedWidgets.containsKey(e)){var r=void 0;e instanceof ma?(r=this.owner.selection.getTop(e),this.owner.selection.getLeft(e)):(r=e.y,e.x);var n=this.selectedWidgets.get(e);if(n instanceof Ml)i=n.left<=t.x&&r<=t.y&&r+e.height>=t.y&&n.left+n.width>=t.x;else for(var o=n,s=0;s<o.length&&!(o[s]instanceof Ml&&(i=o[s].left<=t.x&&r<=t.y&&r+e.height>=t.y&&o[s].left+o[s].width>=t.x));s++);}e=e instanceof ma?e.paragraph:e.containerWidget}while(!sf.base.isNullOrUndefined(e)&&!i);return i},t.prototype.copySelectionParagraphFormat=function(){var e=new ul;return this.paragraphFormat.copyToFormat(e),e},t.prototype.getHyperlinkDisplayText=function(e,t,i,r,n){var o=e;if(o!==i.line.paragraph)return{displayText:"<<Selection in Document>>",isNestedField:r=!0,format:n};for(var s="",a=o.childWidgets.indexOf(t.line),l=o.childWidgets[a].children.indexOf(t),d=a;d<o.childWidgets.length;d++){var h=o.childWidgets[d];d!==a&&(l=-1);for(var c=l+1;c<h.children.length;c++){var p=h.children[c];if(p===i)return{displayText:s,isNestedField:r,format:n};if(p instanceof Fa)s+=p.text,n=p.characterFormat;else{if(!(p instanceof va))return{displayText:"<<Selection in Document>>",isNestedField:r=!0,format:n};p instanceof va&&0===p.fieldType&&!sf.base.isNullOrUndefined(p.fieldEnd)&&(l=sf.base.isNullOrUndefined(p.fieldSeparator)?h.children.indexOf(p.fieldEnd):h.children.indexOf(p.fieldSeparator))}}}return{displayText:s,isNestedField:r,format:n}},t.prototype.navigateHyperLinkOnEvent=function(e,t){var i=this,r=this.documentHelper.getLineWidget(e);if(!sf.base.isNullOrUndefined(r)){var n=this.getHyperLinkFieldInCurrentSelection(r,e);sf.base.isNullOrUndefined(n)||(this.documentHelper.updateTextPositionForSelection(e,1),this.fireRequestNavigate(n),setTimeout((function(){i.viewer&&(i.documentHelper.isTouchInput=t,i.documentHelper.updateFocus(),i.documentHelper.isTouchInput=!1)})))}},t.prototype.getLinkText=function(e,t){var i=new zl(e,this),r=i.navigationLink,n=i.screenTip;return t?(i.localReference.length>0&&("_"!==i.localReference[0]||!sf.base.isNullOrUndefined(r)&&0!==r.length?i.isCrossRef?r+=i.localReference:r+="#"+i.localReference:r="Current Document"),i.destroy(),r):(i.destroy(),n)},t.prototype.setHyperlinkContentToToolTip=function(e,t,i,r){if(e){this.toolTipElement||(this.toolTipElement=sf.base.createElement("div",{className:"e-de-tooltip e-lib e-popup e-control"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement),this.screenTipElement=sf.base.createElement("p"),this.toolTipElement.appendChild(this.screenTipElement),this.toolTipTextElement=sf.base.createElement("p",{styles:"font-weight:bold"}),this.toolTipElement.appendChild(this.toolTipTextElement)),this.toolTipElement.style.display="block";var n=this.owner.defaultLocale["Click to follow link"]?this.owner.defaultLocale["Click to follow link"]:"Click to follow link";this.owner.useCtrlClickToFollowHyperlink&&(n=this.documentHelper.isIosDevice?"Command+"+n:"Ctrl+"+n);var o=this.getScreenTipText(e);if(r){var s=e.formFieldData.helpText;if(sf.base.isNullOrUndefined(s)||""===s)return;this.screenTipElement.innerText=s}else this.screenTipElement.innerText=o,this.toolTipTextElement.innerText=n;var a=this.getTooltipPosition(e.line,i,this.toolTipElement.clientWidth,this.toolTipElement.offsetHeight,!1);this.showToolTip(a.x,a.y),(sf.base.isNullOrUndefined(this.toolTipField)||!sf.base.isNullOrUndefined(this.toolTipField)&&e!==this.toolTipField)&&(this.toolTipElement.style.left=a.x+"px",this.toolTipElement.style.top=a.y+"px",this.toolTipElement.style.zIndex="2000"),this.toolTipElement.style.position="absolute",this.toolTipElement.style.display="block",this.toolTipField=e}else this.hideToolTip()},t.prototype.getScreenTipText=function(e){var t=new zl(e,this);return t.screenTip||t.localReference?t.screenTip?t.screenTip:t.localReference:t.navigationLink},t.prototype.setFootnoteContentToToolTip=function(e,t,i){if(e){this.toolTipElement||(this.toolTipElement=sf.base.createElement("div",{className:"e-de-tooltip"}),this.documentHelper.viewerContainer.appendChild(this.toolTipElement)),this.toolTipElement.style.display="block";var r=void 0;"Endnote"===e.footnoteType?r="Click to View/Edit Endnote":"Footnote"===e.footnoteType&&(r="Click to View/Edit Footnote"),this.toolTipElement.innerHTML="<b>"+r+"</b>";var n=this.getTooltipPosition(e.line,i,this.toolTipElement.clientWidth,this.toolTipElement.offsetHeight,!1);this.showToolTip(n.x,n.y),sf.base.isNullOrUndefined(this.toolTipField)||(this.toolTipElement.style.left=n.x+"px",this.toolTipElement.style.top=n.y+"px",this.toolTipElement.style.zIndex="2000"),this.toolTipElement.style.position="absolute",this.toolTipElement.style.display="block"}else this.hideToolTip()},t.prototype.setLockInfoTooptip=function(e,t,i){},t.prototype.getTooltipPosition=function(e,t,i,r,n){var o=this.getTop(e)*this.documentHelper.zoomFactor,s=this.getPage(e.paragraph),a=this.documentHelper.viewerContainer.getBoundingClientRect().width+this.documentHelper.viewerContainer.scrollLeft,l=s.boundingRectangle.x+t*this.documentHelper.zoomFactor;l+i+10>a&&(l-=i-(a-l)+15);var d=n?0:r,h=this.getPageTop(s)+(o-d);return h=h>this.documentHelper.viewerContainer.scrollTop?h:h+e.height+d,new I(l,h)},t.prototype.updateSelectionInfo=function(e){var t=this.selectedWidgets.keys;if(t[0]instanceof ua&&t[t.length-1]instanceof ua&&t.length>0){var i=t[0],r=t[t.length-1],n=i.ownerRow,o=r.ownerRow,s=n.getCell(n.rowIndex,0),a=this.owner.documentHelper.getFirstParagraphInCell(s);e.start=this.owner.documentHelper.selection.getHierarchicalIndex(a,"0");var l=o.getCell(o.rowIndex,o.childWidgets.length-1),d=this.getLastParagraph(l),h=this.getParagraphLength(d);e.end=this.owner.documentHelper.selection.getHierarchicalIndex(d,h.toString())}return e},t.prototype.createPasteElement=function(e,t){if(!this.pasteElement){var i=this.documentHelper.viewerContainer.getElementsByClassName("e-de-paste")[0];this.pasteElement=i.parentElement.parentElement}this.pasteElement.style.display="block",this.pasteElement.style.position="absolute",this.pasteElement.style.left=t,this.pasteElement.style.top=e,this.pasteElement.style.zIndex="2000"},t.prototype.showToolTip=function(e,t){},t.prototype.hideToolTip=function(){this.toolTipField=void 0,this.toolTipElement&&(this.toolTipElement.style.display="none")},t.prototype.getHyperLinkFieldInCurrentSelection=function(e,t,i){var r=void 0,n=this.getTop(e),o=x.convertPointToPixel(e.paragraph.paragraphFormat.leftIndent),s=x.convertPointToPixel(e.paragraph.paragraphFormat.rightIndent),a=this.getLineStartLeft(e);if(!(t.y<n||t.y>n+e.height||t.x<a||t.x>a+e.paragraph.width+o+s)){var l=e.paragraph.x,d=this.getFirstElement(e,l);l=d.left;var h=d.element;if(sf.base.isNullOrUndefined(h)){var c=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(t.x<=a+c||t.x>=a+c){var p=[],g=this.getHyperLinkFields(e.paragraph,p,!1,i);return p=[],p=void 0,g}}else{var f=e.renderedElements;if(t.x>l+h.margin.left)for(var u=f.indexOf(h);u<f.length&&(h=f[u],!(t.x<l+h.margin.left+h.width||u===f.length-1));u++)l+=h.margin.left+h.width;r=h;c=h.margin.left+h.width;if(sf.base.isNullOrUndefined(r.nextNode)&&(c+=this.documentHelper.textHelper.getParagraphMarkWidth(r.line.paragraph.characterFormat)),t.x<=l+c){p=[],g=this.getHyperLinkFieldInternal(r.line.paragraph,r,p,!1,i);return p=[],p=void 0,g}}}},t.prototype.getFootNoteElementInCurrentSelection=function(e,t){var i=void 0,r=this.getTop(e),n=this.getLineStartLeft(e);if(!(t.y<r||t.y>r+e.height||t.x<n||t.x>n+e.paragraph.width)){var o=e.paragraph.x,s=this.getFirstElement(e,o);o=s.left;var a=s.element;if(sf.base.isNullOrUndefined(a)){var l=this.documentHelper.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(t.x<=n+l||t.x>=n+l){var d=this.documentHelper.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,0).element;return d instanceof Wa?d:void 0}}else{if(t.x>o+a.margin.left)for(var h=e.children.indexOf(a);h<e.children.length&&(a=e.children[h],!(t.x<o+a.margin.left+a.width||h===e.children.length-1));h++)o+=a.margin.left+a.width;a instanceof Wa&&(i=a);l=a.margin.left+a.width;if(sf.base.isNullOrUndefined(a.nextNode)&&(l+=this.documentHelper.textHelper.getParagraphMarkWidth(a.line.paragraph.characterFormat)),t.x<=o+l)return i}}},t.prototype.getHyperlinkField=function(e){if(!sf.base.isNullOrUndefined(this.end)){var t=0,i=this.documentHelper.selection,r=(i.start,i.end);i.isForward||(i.end,r=i.start);var n=this.end.currentWidget.getInline(r.offset,t);t=n.index;var o=n.element,s=[],a=void 0;if(sf.base.isNullOrUndefined(o))a=this.getHyperLinkFields(this.end.paragraph,s,e);else if(this.documentHelper.isFormFillProtectedMode&&o instanceof Na&&o.previousNode instanceof va&&1===o.previousNode.fieldType)a=void 0;else{var l=o.line.paragraph;a=this.getHyperLinkFieldInternal(l,o,s,e,!1)}return s=[],a}},t.prototype.getHyperLinkFields=function(e,t,i,r){for(var n=0;n<this.documentHelper.fields.length;n++)if(-1===t.indexOf(this.documentHelper.fields[n])&&!sf.base.isNullOrUndefined(this.documentHelper.fields[n].fieldSeparator)){t.push(this.documentHelper.fields[n]);var o=this.getFieldCode(this.documentHelper.fields[n]);o=o.trim().toLowerCase();var s=this.paragraphIsInFieldResult(this.documentHelper.fields[n],e);if((i||!i&&o.match("hyperlink "))&&s)return this.documentHelper.fields[n];if(s&&r&&this.documentHelper.fields[n].formFieldData)return this.documentHelper.fields[n];if((i||!i&&o.match("ref "))&&s)return this.documentHelper.fields[n]}},t.prototype.getHyperLinkFieldInternal=function(e,t,i,r,n){for(var o=0;o<this.documentHelper.fields.length;o++)if(-1===i.indexOf(this.documentHelper.fields[o])&&!sf.base.isNullOrUndefined(this.documentHelper.fields[o].fieldSeparator)){i.push(this.documentHelper.fields[o]);var s=this.getFieldCode(this.documentHelper.fields[o]);s=s.trim().toLowerCase();var a=this.documentHelper.fields[o],l=a.fieldEnd;r&&a.nextNode instanceof Na&&a.nextNode.reference&&(l=a.nextNode.reference);var d=this.inlineIsInFieldResult(a,l,a.fieldSeparator,t,r)||this.isImageField();if((r||!r&&s.match("hyperlink "))&&d)return this.documentHelper.fields[o];if(d&&n&&this.documentHelper.fields[o].formFieldData)return this.documentHelper.fields[o];if((r||!r&&s.match("ref "))&&d)return this.documentHelper.fields[o]}if(e.containerWidget instanceof aa&&!(e instanceof la))return this.getHyperLinkFieldInternal(e.containerWidget,t,i,r,n)},t.prototype.getBlock=function(e){if(""!==e&&!sf.base.isNullOrUndefined(e)){var t={index:e},i=this.start.getPage(t),r=t.index.indexOf(";"),n=t.index.substring(0,r);t.index=t.index.substring(r).replace(";","");var o=i.bodyWidgets[parseInt(n,10)];return this.getBlockInternal(o,t.index)}},t.prototype.getBlockInternal=function(e,t){if(""!==t&&!sf.base.isNullOrUndefined(t)){var i=t.indexOf(";"),r=t.substring(0,i);t=t.substring(i).replace(";","");var n=e;if(!((i=parseInt(r,10))>=0&&i<e.childWidgets.length))return n;var o=e.childWidgets[i];return t.indexOf(";")>=0?o instanceof ca?(t.indexOf(";")>=0&&(t="0"),o):o instanceof da?this.getBlockInternal(o,t):n:o}},t.prototype.inlineIsInFieldResult=function(e,t,i,r,n){return!(sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(i)||!this.isExistBeforeInline(i,r))&&this.isExistAfterInline(t,r,n)},t.prototype.paragraphIsInFieldResult=function(e,t){if(!sf.base.isNullOrUndefined(e.fieldEnd)&&!sf.base.isNullOrUndefined(e.fieldSeparator)){var i=e.fieldSeparator.line.paragraph;if(e.fieldSeparator.line.paragraph===t||this.isExistBefore(i,t))return e.fieldEnd.line.paragraph!==t&&this.isExistAfter(i,t)}return!1},t.prototype.isImageField=function(){if(this.start.paragraph.isEmpty()||this.end.paragraph.isEmpty())return!1;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start);var i=0,r=e.paragraph.getInline(e.offset,i),n=r.element;(i=r.index)===n.length&&(n=this.getNextRenderedElementBox(n,i));var o=(r=t.paragraph.getInline(t.offset,i)).element;if(i=r.index,n instanceof va&&0===n.fieldType&&o instanceof va&&1===o.fieldType&&n.fieldSeparator){var s=n.fieldSeparator.nextNode;if(s instanceof Da&&s.nextNode===o)return!0}return!1},t.prototype.isFormField=function(){var e=this.currentFormField;return!!(e instanceof va&&e.formFieldData)},t.prototype.isReferenceField=function(e){if(sf.base.isNullOrUndefined(e)&&(e=this.getHyperlinkField(!0)),e){var t=this.getFieldCode(e);if(t=t.toLowerCase(),e instanceof va&&t.match("ref "))return!0}return!1},t.prototype.isInlineFormFillMode=function(e){return!!(this.documentHelper.isInlineFormFillProtectedMode&&(e=sf.base.isNullOrUndefined(e)?this.currentFormField:e,sf.base.isNullOrUndefined(e)&&(e=this.getCurrentFormField()),e&&e.formFieldData instanceof ba&&"Text"===e.formFieldData.type))},t.prototype.getFormFieldType=function(e){if(sf.base.isNullOrUndefined(e)&&(e=this.currentFormField),e instanceof va){if(e.formFieldData instanceof ba)return"Text";if(e.formFieldData instanceof xa)return"CheckBox";if(e.formFieldData instanceof Ia)return"DropDown"}},t.prototype.getCurrentFormField=function(e){var t;if(e||this.documentHelper.isFormFillProtectedMode&&this.owner.documentEditorSettings.formFieldSettings&&"Inline"===this.owner.documentEditorSettings.formFieldSettings.formFillingMode)for(var i=0;i<this.documentHelper.formFields.length;i++){var r=this.documentHelper.formFields[i],n=this.start,o=this.end;if(this.isForward||(n=this.end,o=this.start),x.isLinkedFieldCharacter(r)){var s=r.fieldSeparator.line.getOffset(r.fieldSeparator,1),a=new Al(this.owner);a.setPositionParagraph(r.fieldSeparator.line,s);var l=r.fieldEnd;s=l.line.getOffset(l,0);var d=new Al(this.owner);if(d.setPositionParagraph(l.line,s),(n.isExistAfter(a)||n.isAtSamePosition(a))&&(o.isExistBefore(d)||o.isAtSamePosition(d))){t=r;break}}}else t=this.getHyperlinkField(!0);if(t instanceof va&&0===t.fieldType&&!sf.base.isNullOrUndefined(t.formFieldData))return t},t.prototype.getCurrentTextFrame=function(){var e=this.start.paragraph.containerWidget;do{if(e instanceof Aa)return e;e&&(e=e.containerWidget)}while(e);return null},t.prototype.isTableSelected=function(){var e=this.start,t=this.end;if(this.isForward||(e=this.end,t=this.start),sf.base.isNullOrUndefined(e.paragraph.associatedCell)||sf.base.isNullOrUndefined(t.paragraph.associatedCell))return!1;var i=e.paragraph.associatedCell.ownerTable.getSplitWidgets(),r=this.getFirstBlockInFirstCell(i[0]),n=this.getLastBlockInLastCell(i[i.length-1]);return e.paragraph.associatedCell.equals(r.associatedCell)&&t.paragraph.associatedCell.equals(n.associatedCell)&&(!r.associatedCell.equals(n.associatedCell)||0===e.offset&&t.offset===this.getLineLength(n.lastChild)+1)},t.prototype.selectListText=function(){var e=this.documentHelper.selectionLineWidget.getHierarchicalIndex("0"),t=this.getTextPosition(e),i=this.getTextPosition(e);this.isSelectList=!0,this.selectRange(t,i),this.isSelectList=!1,this.highlightListText(this.documentHelper.selectionLineWidget),this.contextTypeInternal="List"},t.prototype.highlightListText=function(e){var t=e.children[0].width,i=this.documentHelper.getLeftValue(e),r=e.paragraph.y;this.createHighlightBorder(e,t,i,r,!1),this.documentHelper.isListTextSelected=!0},t.prototype.updateImageSize=function(e){this.owner.isShiftingEnabled=!0;var t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start);var r=null,n=0,o=t.paragraph;if(o===i.paragraph&&t.offset+1===i.offset){var s=o.getInline(i.offset,n);r=s.element,n=s.index}if(r instanceof Da||r instanceof La){var a=r.width,l=r.height,d=r.alternateText;if(r.width=e.width,r.height=e.height,r.alternateText=e.alternatetext,e.width=a,e.height=l,e.alternatetext=d,null!==o&&null!==o.containerWidget&&this.owner.editorModule){var h=o.childWidgets.indexOf(r.line),c=r.line.children.indexOf(r);this.documentHelper.layout.reLayoutParagraph(o,h,c),this.highlightSelection(!1)}}},t.prototype.getSelectedCellsInTable=function(e,t,i){for(var r=t.columnIndex,n=i.columnIndex+i.cellFormat.columnSpan-1,o=t.ownerRow.index,s=i.ownerRow.index,a=[],l=0;l<e.childWidgets.length;l++){var d=e.childWidgets[l];if(d.index>=o&&d.index<=s)for(var h=0;h<d.childWidgets.length;h++){var c=d.childWidgets[h];c.columnIndex>=r&&c.columnIndex<=n&&a.push(c)}if(d.index>s)break}return a},t.prototype.copy=function(){this.isEmpty||this.copySelectedContent(!1)},t.prototype.copySelectedContent=function(e){sf.base.isNullOrUndefined(this.owner.sfdtExportModule)||(this.owner.editor.isCopying=!0,this.copyToClipboard(this.getHtmlContent()),this.owner.editor.isCopying=!1,e&&this.owner.editorModule&&this.owner.editorModule.handleCut(this),this.owner.enableAutoFocus&&this.documentHelper.updateFocus())},t.prototype.writeSfdt=function(){var e=this.start,t=this.end;return this.isForward||(e=this.end,t=this.start),this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,e.currentWidget,e.offset,t.currentWidget,t.offset,!0)},t.prototype.getHtmlContent=function(){var e=this.writeSfdt();this.owner.editorModule&&(this.owner.editorModule.copiedData=JSON.stringify(e));var t=this.owner.documentEditorSettings.optimizeSfdt;return this.htmlWriter.writeHtml(e,t)},t.prototype.copyToClipboard=function(e){window.getSelection().removeAllRanges();var t,i=navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&navigator.userAgent.indexOf("Macintosh")>-1&&navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome"),r=/Android|Windows Phone|iPhone|Trident|webOS/i.test(navigator.userAgent)||i,n=document.createElement("div");(n.style.left="-10000px",n.style.top="-10000px",n.style.position="relative",n.innerHTML=e,r)?document.body.appendChild(n):((t=document.createElement("div")).attachShadow({mode:"open"}).appendChild(n),document.body.appendChild(t));void 0!==navigator&&-1!==navigator.userAgent.indexOf("Firefox")&&(n.contentEditable="true");var o=document.createRange();o.selectNodeContents(n),window.getSelection().addRange(o);var s=!1;try{s=document.execCommand("copy")}catch(e){}finally{window.getSelection().removeAllRanges(),n.parentNode.removeChild(n),r||t.parentNode.removeChild(t)}return s},t.prototype.showCaret=function(){var e=sf.base.isNullOrUndefined(this.documentHelper.currentPage)?this.documentHelper.currentRenderingPage:this.documentHelper.currentPage;if(!(sf.base.isNullOrUndefined(e)||this.documentHelper.isRowOrCellResizing||this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible&&!this.owner.imageResizerModule.isShapeResize)){var t,i=e.boundingRectangle.x;if(t=this.viewer instanceof Qs?e.boundingRectangle.width*this.documentHelper.zoomFactor+i:e.boundingRectangle.width-this.owner.viewer.padding.right-this.documentHelper.scrollbarWidth,!this.owner.enableImageResizerMode||!this.owner.imageResizerModule.isImageResizerVisible||this.owner.imageResizerModule.isShapeResize)if(this.isHideSelection(this.start.paragraph))this.caret.style.display="none";else if(this.isEmpty&&(!this.owner.isReadOnly||this.owner.enableCursorOnReadOnly||this.isInlineFormFillMode())){var r=parseInt(this.caret.style.left.replace("px",""),10);this.caret.style.display=r<i||r>t?"none":"block"}else this.isImageSelected&&!this.owner.enableImageResizerMode?this.caret.style.display="block":("block"===this.caret.style.display||sf.base.isNullOrUndefined(this))&&(this.documentHelper.isComposingIME||(this.caret.style.display="none"));if(sf.base.isNullOrUndefined(this)||!this.documentHelper.isTouchInput||this.owner.isReadOnlyMode)this.documentHelper.touchStart.style.display="none",this.documentHelper.touchEnd.style.display="none";else{var n=parseInt(this.documentHelper.touchStart.style.left.replace("px",""),10)+14,o=parseInt(this.documentHelper.touchEnd.style.left.replace("px",""),10)+14,s=this.getSelectionPage(this.start);s&&(this.documentHelper.touchEnd.style.display=o<i||o>t?"none":"block",this.isEmpty||(i=s.boundingRectangle.x,t=s.boundingRectangle.width*this.documentHelper.zoomFactor+i),this.documentHelper.touchStart.style.display=n<i||n>t?"none":"block")}}},t.prototype.setEditableDivCaretPosition=function(e){this.documentHelper.editableDiv.focus();var t=this.documentHelper.editableDiv.childNodes[this.documentHelper.editableDiv.childNodes.length-1];if(t){var i=document.createRange();i.setStart(t,e),i.collapse(!0),window.getSelection().removeAllRanges(),window.getSelection().addRange(i)}},t.prototype.initCaret=function(){this.caret=sf.base.createElement("div",{styles:"position:absolute",className:"e-de-blink-cursor e-de-cursor-animation"}),this.caret.style.display="none",this.owner.documentHelper.viewerContainer.appendChild(this.caret)},t.prototype.updateCaretPosition=function(){var e=this.end.location,t=this.getSelectionPage(this.end);if(t&&!sf.base.isNullOrUndefined(this.caret)){this.caret.style.left=t.boundingRectangle.x+Math.round(e.x)*this.documentHelper.zoomFactor+"px";var i=this.updateCaretSize(this.owner.selection.end),r=i.topMargin,n=this.viewer,o=(t.boundingRectangle.y-n.pageGap*(this.documentHelper.pages.indexOf(t)+1))*this.documentHelper.zoomFactor+n.pageGap*(this.documentHelper.pages.indexOf(t)+1);this.caret.style.top=o+Math.round(e.y+r)*this.documentHelper.zoomFactor+"px","Subscript"===this.owner.selection.characterFormat.baselineAlignment&&(this.caret.style.top=parseFloat(this.caret.style.top)+parseFloat(this.caret.style.height)/2+"px"),(this.documentHelper.isTouchInput||"none"!==this.documentHelper.touchStart.style.display)&&(this.documentHelper.touchStart.style.left=t.boundingRectangle.x+(Math.round(e.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchStart.style.top=o+(e.y+i.height)*this.documentHelper.zoomFactor+"px",this.documentHelper.touchEnd.style.left=t.boundingRectangle.x+(Math.round(e.x)*this.documentHelper.zoomFactor-14)+"px",this.documentHelper.touchEnd.style.top=o+(e.y+i.height)*this.documentHelper.zoomFactor+"px")}this.showHidePasteOptions(this.caret.style.top,this.caret.style.left)},t.prototype.showHidePasteOptions=function(e,t){if(!sf.base.Browser.isIE)if(this.isViewPasteOptions){if(this.pasteElement&&"block"===this.pasteElement.style.display)return;this.createPasteElement(e,t)}else this.pasteElement&&(this.pasteElement.style.display="none",sf.base.isNullOrUndefined(this.owner.editor)||(this.owner.editor.isHtmlPaste=!1))},t.prototype.getRect=function(e){var t=e.location,i=this.getSelectionPage(e);if(i){var r=this.owner.documentHelper,n=i.boundingRectangle.x+Math.round(t.x)*r.zoomFactor,o=this.viewer.pageGap,s=(i.boundingRectangle.y-o*(i.index+1))*r.zoomFactor+o*(i.index+1)+Math.round(t.y)*r.zoomFactor;return new I(n,s)}return new I(0,0)},t.prototype.getSelectionPage=function(e){var t=this.getLineWidgetInternal(e.currentWidget,e.offset,!0);if(t)return this.getPage(t.paragraph)},t.prototype.updateCaretSize=function(e,t){var i,r=0,n=!1,o=0,s=0;if(this.characterFormat.italic&&(n=this.characterFormat.italic),e.paragraph.isEmpty()){var a=e.paragraph,l=0,d=this.getParagraphMarkSize(a,r,l);r=d.topMargin,l=d.bottomMargin;var h=d.height;s=r<0?r+h:h,t||(this.caret.style.height=s*this.documentHelper.zoomFactor+"px"),r=0}else{var c=e.currentWidget.getInline(e.offset,o);o=c.index;var p=c.element;sf.base.isNullOrUndefined(p)||(s=(i=this.getCaretHeight(p,o,p.characterFormat,!0,r,n)).height,t||(this.caret.style.height=i.height*this.documentHelper.zoomFactor+"px"))}return t||(this.caret.style.transform=n?"rotate(13deg)":""),{topMargin:r,height:s}},t.prototype.updateCaretToPage=function(e,t){if(!sf.base.isNullOrUndefined(t))if(this.documentHelper.selectionEndPage=t,this.owner.selection.isEmpty)this.documentHelper.selectionStartPage=t;else{var i=this.getLineWidgetParagraph(e.offset,e.paragraph.childWidgets[0]),r=this.getPage(i.paragraph);sf.base.isNullOrUndefined(r)||(this.documentHelper.selectionStartPage=r)}this.owner.enableAutoFocus&&this.checkForCursorVisibility()},t.prototype.getCaretBottom=function(e,t){var i=e.location.y;if(e.paragraph.isEmpty()){var r=e.paragraph,n=0,o=0,s=this.getParagraphMarkSize(r,n,o);n=s.topMargin,o=s.bottomMargin,i+=s.height,i+=n,t||(i+=o)}else{var a=0,l=e.paragraph.getInline(e.offset,a),d=l.element;a=l.index;n=0;var h=!1,c=this.getCaretHeight(d,a,d.characterFormat,!1,n,h);n=c.topMargin,h=c.isItalic,i+=c.height,t&&(i-=x.convertPointToPixel(this.documentHelper.layout.getAfterSpacing(e.paragraph)))}return i},t.prototype.checkForCursorVisibility=function(){this.showCaret()},t.prototype.onKeyDownInternal=function(e,t,i,r){var n=e.which||e.keyCode;if(this.owner.focusIn(),!t||i||r)if(!i||t||r)if(i&&t&&!r)switch(n){case 32:this.owner.editor.insertText(String.fromCharCode(160));break;case 35:this.handleControlShiftEndKey();break;case 36:this.handleControlShiftHomeKey();break;case 37:this.handleControlShiftLeftKey();break;case 38:this.handleControlShiftUpKey();break;case 39:this.handleControlShiftRightKey();break;case 40:this.handleControlShiftDownKey();break;case 56:this.owner.documentEditorSettings.showHiddenMarks=!this.owner.documentEditorSettings.showHiddenMarks,this.owner.setShowHiddenMarks(this.owner.documentEditorSettings.showHiddenMarks)}else switch(n){case 33:e.preventDefault(),this.handlePageUpPageDownKey(!1,i);break;case 34:e.preventDefault(),this.handlePageUpPageDownKey(!0,i);break;case 35:this.handleEndKey(),e.preventDefault();break;case 36:this.handleHomeKey(),e.preventDefault();break;case 37:this.handleLeftKey(),e.preventDefault();break;case 38:this.handleUpKey(),e.preventDefault();break;case 39:this.handleRightKey(),e.preventDefault();break;case 40:this.handleDownKey(),e.preventDefault()}else switch(this.documentHelper.isCompleted=!1,n){case 33:e.preventDefault(),this.handlePageUpPageDownKey(!1,i);break;case 34:e.preventDefault(),this.handlePageUpPageDownKey(!0,i);break;case 35:this.handleShiftEndKey(),e.preventDefault();break;case 36:this.handleShiftHomeKey(),e.preventDefault();break;case 37:this.handleShiftLeftKey(),e.preventDefault();break;case 38:this.handleShiftUpKey(),e.preventDefault();break;case 39:this.handleShiftRightKey(),e.preventDefault();break;case 40:this.handleShiftDownKey(),e.preventDefault()}else switch(this.documentHelper.isControlPressed=!0,n){case 35:this.handleControlEndKey();break;case 36:this.handleControlHomeKey();break;case 37:this.handleControlLeftKey();break;case 38:this.handleControlUpKey();break;case 39:this.handleControlRightKey();break;case 40:this.handleControlDownKey();break;case 65:this.owner.selection.selectAll();break;case 67:e.preventDefault(),this.copy();break;case 70:e.preventDefault(),this.owner.showDialog("FindPane")}if(this.isFormField()&&!this.documentHelper.isDocumentProtected){var o=this.getCurrentFormField(!0);if(o&&o.formFieldData instanceof Ia){o=37===e.keyCode||38===e.keyCode||40===e.keyCode?o:o.nextElement instanceof Na?o.nextElement.reference:o.fieldEnd;var s=39===e.keyCode?1:0,a=o.line.getOffset(o,s),l=this.getPhysicalPositionInternal(o.line,a,!1);this.selectInternal(o.line,o,s,l)}}!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode||this.isInlineFormFillMode()?this.owner.editorModule.onKeyDownInternal(e,t,i,r):this.documentHelper.isDocumentProtected&&"FormFieldsOnly"===this.documentHelper.protectionType&&(9!==e.keyCode&&32!==e.keyCode||this.owner.editorModule.onKeyDownInternal(e,t,i,r)),this.owner.searchModule&&!sf.base.isNullOrUndefined(this.owner.searchModule.searchHighlighters)&&this.owner.searchModule.searchHighlighters.length>0&&this.owner.searchModule.searchResults.clear(),27!==e.keyCode&&27!==e.which||(sf.base.isNullOrUndefined(this.owner.optionsPaneModule),this.owner.enableHeaderAndFooter&&this.disableHeaderFooter()),this.documentHelper.updateFocus()},t.prototype.checkAndEnableHeaderFooter=function(e,t){var i=this.documentHelper.currentPage;if(this.isCursorInsidePageRect(e,i)){if(this.isCursorInHeaderRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.headerWidget,i);if(this.isCursorInFooterRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.footerWidget,i)}return!!this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1,this.documentHelper.updateTextPositionForSelection(t,1),!0)},t.prototype.isCursorInsidePageRect=function(e,t){return this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width*this.documentHelper.zoomFactor&&this.viewer instanceof Qs||this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width},t.prototype.isCursorInHeaderRegion=function(e,t){if(this.viewer instanceof Qs){var i=this.getPageTop(t),r=0,n=t.headerWidget;n&&(r=n.y+n.height);var o=n.isEmpty&&!this.owner.enableHeaderAndFooter,s=x.convertPointToPixel(t.bodyWidgets[0].sectionFormat.topMargin),a=x.convertPointToPixel(t.bodyWidgets[0].sectionFormat.pageHeight),l=o?s:Math.min(Math.max(r,s),a/100*40);if(l*=this.documentHelper.zoomFactor,this.viewer.containerTop+e.y>=i&&this.viewer.containerTop+e.y<=i+l)return!0}return!1},t.prototype.isCursorInFooterRegion=function(e,t){if(this.viewer instanceof Qs){var i=t.boundingRectangle,r=this.getPageTop(t),n=r+i.height*this.documentHelper.zoomFactor,o=x.convertPointToPixel(t.bodyWidgets[0].sectionFormat.footerDistance),s=0;t.footerWidget&&(s=t.footerWidget.height);var a=x.convertPointToPixel(t.bodyWidgets[0].sectionFormat.bottomMargin),l=t.footerWidget.isEmpty&&!this.owner.enableHeaderAndFooter,d=i.height;if(d=l?(d-a)*this.documentHelper.zoomFactor:(d-Math.min(i.height/100*40,Math.max(s+o,a)))*this.documentHelper.zoomFactor,this.viewer.containerTop+e.y<=n&&this.viewer.containerTop+e.y>=r+d)return!0}return!1},t.prototype.enableHeadersFootersRegion=function(e,t){return this.viewer instanceof Qs&&(this.owner.enableHeaderAndFooter=!0,e.page=t,this.comparePageWidthAndMargins(e,t),this.updateTextPositionForBlockContainer(e),this.shiftBlockOnHeaderFooterEnableDisable(),!0)},t.prototype.comparePageWidthAndMargins=function(e,t){var i,r=-1!=e.headerFooterType.indexOf("Header"),n=!1;if(i=r?t.headerWidgetIn:t.footerWidgetIn,!sf.base.isNullOrUndefined(i)){var o=e.sectionFormat,s=i.sectionFormat;sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(s)||(r?e.width==i.width&&o.headerDistance==s.headerDistance||(n=!0):e.width==i.width&&o.footerDistance==s.footerDistance||(n=!0)),n&&(this.owner.viewer.updateHFClientArea(e.sectionFormat,r),e=this.documentHelper.layout.layoutHeaderFooterItems(this.owner.viewer,e))}},t.prototype.shiftBlockOnHeaderFooterEnableDisable=function(){for(var e=0;e<this.documentHelper.headersFooters.length;e++){var t=this.documentHelper.headersFooters[e],i=this.getBodyWidgetInternal(e,0);if(!sf.base.isNullOrUndefined(i))for(var r=i.sectionFormat,n=0,o=Object.keys(t);n<o.length;n++){var s=t[o[n]];s.isEmpty&&this.owner.editor.shiftPageContent(s.headerFooterType,r)}}},t.prototype.updateTextPositionForBlockContainer=function(e){var t=e.firstChild;t instanceof ga&&(t=this.getFirstBlockInFirstCell(t))instanceof ga&&(t=this.getFirstBlockInFirstCell(t)),this.selectParagraphInternal(t,!0)},t.prototype.disableHeaderFooter=function(){var e=this.getPage(this.start.paragraph);this.updateTextPositionForBlockContainer(e.bodyWidgets[0]),this.owner.enableHeaderAndFooter=!1,this.shiftBlockOnHeaderFooterEnableDisable()},t.prototype.clear=function(){this.editRegionHighlighters&&this.editRegionHighlighters.clear(),this.editRangeCollection=[]},t.prototype.destroy=function(){sf.base.isNullOrUndefined(this.contextTypeInternal)||(this.contextTypeInternal=void 0),this.caret=void 0,this.contextTypeInternal=void 0,this.upDownSelectionLength=void 0,this.owner=void 0,this.isCellPrevSelected=void 0,this.currentFormField=void 0},t.prototype.getCellsToSelect=function(e,t,i,r){var n=e.childWidgets;if(!(sf.base.isNullOrUndefined(r.paragraph.associatedCell)||!sf.base.isNullOrUndefined(r.reference)&&sf.base.isNullOrUndefined(r.reference.paragraph.associatedCell))){for(var o=r.paragraph.associatedCell.ownerRow.rowIndex,s=r.reference.paragraph.associatedCell.ownerRow.rowIndex,a=[],l=o;l<=s;l++)for(var d=n[l],h=t;h<=i;h++){var c=d.childWidgets[h];sf.base.isNullOrUndefined(c)||a.push(c)}return a}},t.prototype.selectBookmarkInTable=function(e){this.documentHelper.clearSelectionHighlight();var t=parseInt(e.properties.columnFirst),i=parseInt(e.properties.columnLast),r=e.paragraph.associatedCell.ownerTable,n=this.getCellsToSelect(r,t,i,e);if(!sf.base.isNullOrUndefined(n))for(var o=0;o<n.length;o++)this.highlightCellWidget(n[o])},t.prototype.navigateBookmark=function(e,t,i){var r=this.documentHelper.bookmarks;if(r.containsKey(e)){var n=r.get(e);if(sf.base.isNullOrUndefined(n.properties)){var o=n.line.getOffset(n,0);i&&o++;var s=new Al(this.owner);if(s.setPositionParagraph(n.line,o),t)this.documentHelper.selection.selectRange(s,s,!0);else{var a=n.reference;n.reference&&null==n.reference.line.paragraph.bodyWidget&&(a=n);var l=a.line.getOffset(a,1);a instanceof Na&&(sf.base.isNullOrUndefined(a.properties)||i||a.properties.isAfterParagraphMark&&(l=a.line.getOffset(a,1))),i&&l--;var d=new Al(this.owner);d.setPositionParagraph(a.line,l),this.documentHelper.selection.selectRange(s,d,!0)}}else this.selectBookmarkInTable(n)}},t.prototype.selectBookmark=function(e,t){this.navigateBookmark(e,void 0,t)},t.prototype.getTocField=function(){for(var e=this.start.paragraph,t=void 0;void 0!==e&&this.isTocStyle(e);)t=e,e=e.previousRenderedWidget;if(void 0!==t){var i=t.childWidgets[0];if(void 0!==i)return i.children[0]}},t.prototype.isTocStyle=function(e){var t=e.paragraphFormat.baseStyle;return void 0!==t&&-1!==t.name.toLowerCase().indexOf("toc")},t.prototype.isTOC=function(){for(var e=this.getParagraphInfo(this.start).paragraph,t=0;t<e.childWidgets[0].children.length;t++){var i=e.childWidgets[0].children[t];if(i instanceof va){var r=this.owner.selection.getFieldCode(i);if(r.match("TOC ")||r.match("Toc"))return!0}}return!1},t.prototype.getElementsForward=function(e,t,i,r){if(!sf.base.isNullOrUndefined(t)){for(var n=[],o=e.children.indexOf(t);o>=0;){for(var s=o;s<e.children.length;s++){var a=e.children[s];if(a.line!==e){o=-1;break}if(a===i){n.push(a),o=-1;break}n.push(a)}o=-1}return 0===n.length?void 0:n}},t.prototype.getElementsBackward=function(e,t,i,r){for(var n=[];r&&t&&t.previousElement&&(!t.isRightToLeft||t instanceof Fa&&this.documentHelper.textHelper.isRTLText(t.text));)t=t.previousElement;for(var o=e.children.indexOf(t);o>=0;){for(var s=o;s>-1&&s<e.children.length;r?s++:s--){var a=e.children[s];if(a.line!==e){o=-1;break}n.push(a)}o=-1}return n},t.prototype.navigatePreviousComment=function(){this.commentNavigateInternal(!1)},t.prototype.navigateNextComment=function(){this.commentNavigateInternal(!0)},t.prototype.commentNavigateInternal=function(e){if(!this.documentHelper.currentSelectedComment){if(0===this.documentHelper.comments.length)return;this.documentHelper.currentSelectedComment=this.documentHelper.comments[0]}if(this.documentHelper.currentSelectedComment){var t=this.documentHelper.comments,i=this.documentHelper.currentSelectedComment,r=t.indexOf(i);i=e?r===t.length-1?t[0]:t[r+1]:0===r?t[t.length-1]:t[r-1],this.documentHelper.currentSelectedComment=i,this.selectComment(i)}},t.prototype.navigatePreviousRevision=function(){this.revisionNavigateInternal(!1)},t.prototype.navigateNextRevision=function(){this.revisionNavigateInternal(!0)},t.prototype.revisionNavigateInternal=function(e){if(!this.documentHelper.currentSelectedRevisionInternal){if(0===this.documentHelper.owner.revisions.length)return;this.documentHelper.currentSelectedRevision=this.documentHelper.owner.revisions.get(0)}if(this.documentHelper.currentSelectedRevision){var t=this.documentHelper.owner.revisions.changes,i=this.documentHelper.currentSelectedRevision,r=t.indexOf(i);i=e?r===t.length-1?t[0]:t[r+1]:0===r?t[t.length-1]:t[r-1],this.documentHelper.currentSelectedRevision=i,this.selectRevision(i)}this.owner.trackChangesPane.currentSelectedRevision=this.documentHelper.currentSelectedRevision},t.prototype.selectComment=function(e){if(!sf.base.isNullOrUndefined(e)){var t=this.getElementPosition(e.commentStart).startPosition,i=this.getElementPosition(e.commentEnd).startPosition;this.selectPosition(t,i),this.documentHelper.currentSelectedComment=e,this.updatePreviousCommentMark(e),this.hightlightCommentSelectionMark(),this.owner.dotNetRef.invokeMethodAsync("SetSelectedComment",e.commentId)}},t.prototype.hightlightCommentSelectionMark=function(){if(this.documentHelper.currentSelectedComment){var e=this.getCommentStart(this.documentHelper.currentSelectedComment);e&&!e.commentMark&&e.renderCommentMark(),sf.base.classList(e.commentMark,["e-de-cmt-mark-selected"],[])}},t.prototype.updatePreviousCommentMark=function(e){if(this.documentHelper.currentSelectedComment){var t=this.getCommentStart(this.documentHelper.currentSelectedComment).commentMark;t&&(sf.base.classList(t,[],["e-de-cmt-mark-selected"]),this.removeSelectionMark("e-de-cmt-mark-selected"))}},t.prototype.removeSelectionMark=function(e){if(this.documentHelper.pageContainer)for(var t=this.documentHelper.pageContainer.getElementsByClassName(e),i=0;i<t.length;i++)sf.base.classList(t[i],[],[e])},t.prototype.getCommentStart=function(e){var t=void 0;return e&&e.commentStart&&(t=e.commentStart),void 0!==t.commentMark&&(t.commentMark.title="Click to see this comment"),this.getFirstCommentInLine(t)},t.prototype.getFirstCommentInLine=function(e){for(var t=0;t<e.line.children.length;t++){var i=e.line.children[t];if(i instanceof al&&0===i.commentType)return i}return e},t.prototype.selectRevision=function(e){if(!sf.base.isNullOrUndefined(e)&&e.range.length>0){var t=e.range[0],i=e.range[e.range.length-1];if(t instanceof k){var r=t.ownerBase,n=r.childWidgets[0],o=r.childWidgets[r.childWidgets.length-1],s=this.getFirstParagraph(n),a=this.getLastParagraph(o);this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(a.lastChild,a.lastChild.getEndOffset()+1),this.selectPosition(this.start,this.end)}else if(t&&i){var l=new Al(this.owner),d=0;if(t instanceof T){d=(g=t.ownerBase).childWidgets.length>1?this.getParagraphLength(g)-this.getParagraphLength(g,g.lastChild):this.isEmptyWidget(g)?0:g.getLength(),l.setPositionParagraph(g.lastChild,d)}else{d=t.line.getOffset(t,0);var h=t.line;if(h.isFirstLine())for(var c=0;c<h.children.length;c++){if(t===h.children[c]&&h.children[c]instanceof Fa){d=0;break}if(h.children[c]instanceof Fa)break}l.setPositionForLineWidget(t.line,d)}var p=new Al(this.owner);if(i instanceof T){var g,f=(g=i.ownerBase).getSplitWidgets();((g=f[f.length-1]).isEndsWithPageBreak||g.isEndsWithColumnBreak)&&(this.owner.trackChangesPane.isTrackingPageBreak=!0),d=g.childWidgets.length>1?this.getParagraphLength(g)-this.getParagraphLength(g,g.lastChild):g.getLength(),p.setPositionParagraph(g.lastChild,d+1)}else d=i.line.getOffset(i,0)+i.length,this.isTOC()&&(d+=1),p.setPositionForLineWidget(i.line,d);var u=l.clone();l.isExistBefore(p)||(l=p,p=u),this.selectPosition(l,p)}}},t.prototype.isEmptyWidget=function(e){if(e instanceof ga)return!1;if(e.isEmpty())return!0;for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.children.length;r++)if(i.children[r]instanceof Fa)return!1;return!0},t.prototype.selectTableRevision=function(e){if(!sf.base.isNullOrUndefined(e)&&e[0].range.length>0){var t=e[0].range[0],i=e[e.length-1].range[0];if(t instanceof k){var r=t.ownerBase.childWidgets[0],n=i.ownerBase,o=n.childWidgets[n.childWidgets.length-1],s=this.getFirstParagraph(r),a=this.getLastParagraph(o);this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(a.lastChild,a.lastChild.getEndOffset()+1),this.selectPosition(this.start,this.end)}}},t.prototype.updateEditRangeCollection=function(){var e,t;if(this.editRangeCollection.length>0&&(this.editRangeCollection=[]),this.documentHelper.isDocumentProtected){if(this.documentHelper.editRanges.containsKey(this.owner.currentUser)){e=this.documentHelper.editRanges.get(this.owner.currentUser);for(n=0;n<e.length;n++)this.editRangeCollection.push(e[n])}if(this.documentHelper.editRanges.containsKey("Everyone")){r="Everyone";t=this.documentHelper.editRanges.get(r);for(n=0;n<t.length;n++)this.editRangeCollection.push(t[n])}}else for(var i=0;i<this.documentHelper.editRanges.length;i++){var r=this.documentHelper.editRanges.keys[i];e=this.documentHelper.editRanges.get(r);for(var n=0;n<e.length;n++)this.editRangeCollection.push(e[n])}},t.prototype.onHighlight=function(){this.isHighlightEditRegion?this.highlightEditRegion():this.unHighlightEditRegion(),this.viewer.renderVisiblePages()},t.prototype.highlightEditRegion=function(){if(this.updateEditRangeCollection(),this.isHighlightEditRegion){this.isHightlightEditRegionInternal=!0,sf.base.isNullOrUndefined(this.editRegionHighlighters)&&(this.editRegionHighlighters=new a),this.editRegionHighlighters.clear();for(var e=0;e<this.editRangeCollection.length;e++)this.highlightEditRegionInternal(this.editRangeCollection[e]);this.isHightlightEditRegionInternal=!1,this.viewer.updateScrollBars()}else this.unHighlightEditRegion()},t.prototype.highlightFormFields=function(){sf.base.isNullOrUndefined(this.formFieldHighlighters)&&(this.formFieldHighlighters=new a),this.formFieldHighlighters.clear();var e=this.documentHelper.formFields;if(!sf.base.isNullOrUndefined(e)&&e.length>0){for(var t=0;t<e.length;t++){var i=e[t];if(x.isLinkedFieldCharacter(i)){var r=i.line.getOffset(i,0),n=new Al(this.owner);n.setPositionParagraph(i.line,r);var o=i.fieldEnd;r=o.line.getOffset(o,1);var s=new Al(this.owner);s.setPositionParagraph(o.line,r),this.isHighlightFormFields=!0,this.highlight(n.paragraph,n,s),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,n,s),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0)}}this.isHighlightFormFields=!1,this.viewer.updateScrollBars()}},t.prototype.unHighlightEditRegion=function(){sf.base.isNullOrUndefined(this.editRegionHighlighters)||(this.editRegionHighlighters.clear(),this.editRegionHighlighters=void 0),this.isHightlightEditRegionInternal=!1},t.prototype.highlightEditRegionInternal=function(e){var t=this.getPosition(e),i=t.startPosition,r=t.endPosition;this.isCurrentUser=!0,this.highlightEditRegions(e,i,r),this.isCurrentUser=!1},t.prototype.showAllEditingRegion=function(){0===this.editRangeCollection.length&&this.updateEditRangeCollection(),this.documentHelper.clearSelectionHighlight();for(var e=0;e<this.editRangeCollection.length;e++){var t=this.editRangeCollection[e],i=this.getPosition(t),r=i.startPosition,n=i.endPosition;this.highlightEditRegions(t,r,n)}},t.prototype.highlightEditRegions=function(e,t,i){if(!e.line.paragraph.isInsideTable||e.line.paragraph.isInsideTable&&!e.editRangeEnd.line.paragraph.isInsideTable||-1===e.columnFirst)this.highlight(e.line.paragraph,t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0);else{var r=e.line.paragraph.associatedCell.ownerRow.childWidgets[e.columnFirst];if(r)for(var n=0;n<r.childWidgets.length;n++)r.childWidgets[n]instanceof ca&&(this.highlight(r.childWidgets[n],t,i),this.isHighlightNext&&(this.highlightNextBlock(this.hightLightNextParagraph,t,i),this.isHighlightNext=!1,this.hightLightNextParagraph=void 0))}},t.prototype.navigateToNextEditingRegion=function(){var e=this.getEditRangeStartElement();if(this.editRangeCollection.length>0){this.sortEditRangeCollection();var t=this.editRangeCollection.length,i=t;sf.base.isNullOrUndefined(e)||(i=this.editRangeCollection.indexOf(e));var r=i<t-1?this.editRangeCollection[i+1]:this.editRangeCollection[0],n=this.getPosition(r),o=n.startPosition,s=n.endPosition;this.selectRange(o,s)}},t.prototype.sortEditRangeCollection=function(){for(var e=this.editRangeCollection.length-1;e>=0;e--)for(var t=1;t<=e;t++){var i=this.getPosition(this.editRangeCollection[t-1]).startPosition,r=this.getPosition(this.editRangeCollection[t]).startPosition;if(i.isExistAfter(r)){var n=this.editRangeCollection[t-1];this.editRangeCollection[t-1]=this.editRangeCollection[t],this.editRangeCollection[t]=n}}},t.prototype.toggleEditingRegionHighlight=function(){this.isHighlightEditRegion=!this.isHighlightEditRegion},t.prototype.getEditRangeStartElement=function(){for(var e=0;e<this.editRangeCollection.length;e++){var t=this.editRangeCollection[e],i=this.getPosition(t),r=i.startPosition,n=i.endPosition;if((this.start.isExistAfter(r)||this.start.isAtSamePosition(r))&&(this.end.isExistBefore(n)||this.end.isAtSamePosition(n)))return t}},t.prototype.isSelectionInEditRegion=function(){return!!this.documentHelper.isDocumentProtected&&this.checkSelectionIsAtEditRegion()},t.prototype.checkSelectionIsAtEditRegion=function(e,t){sf.base.isNullOrUndefined(e)&&sf.base.isNullOrUndefined(t)&&(e=this.start,t=this.end,this.isForward||(e=this.end,t=this.start));for(var i=0;i<this.editRangeCollection.length;i++){var r=this.editRangeCollection[i];if(!r.line.paragraph.isInsideTable||r.line.paragraph.isInsideTable&&!r.editRangeEnd.line.paragraph.isInsideTable||-1===r.columnFirst){if(this.isSelectionInsideEditRange(r,e,t))return!0}else if(r.paragraph.isInsideTable&&r.editRangeEnd&&r.editRangeEnd.line.paragraph.isInsideTable){var n=r.paragraph.associatedCell.ownerRow,o=e.paragraph.associatedCell,s=t.paragraph.associatedCell;if(!sf.base.isNullOrUndefined(o)&&!sf.base.isNullOrUndefined(s)&&n.equals(o.ownerRow)&&n.equals(s.ownerRow)&&o.index>=r.columnFirst&&o.index<=r.columnLast)if(this.isEmpty&&o.index===r.line.paragraph.associatedCell.index){if(this.isSelectionInsideEditRange(r,e,t))return!0}else if(!this.isCellSelected(o,e,t))return!0}}return!1},t.prototype.isSelectionInsideEditRange=function(e,t,i){var r=this.getPosition(e),n=r.startPosition,o=r.endPosition;return!(!t.isExistAfter(n)&&!t.isAtSamePosition(n)||!i.isExistBefore(o)&&!i.isAtSamePosition(o))},t.prototype.getPosition=function(e){var t,i,r=e.line.getOffset(e,1),n=new Al(this.owner);return n.setPositionParagraph(e.line,r),e instanceof _a?t=e.editRangeEnd:e instanceof Oa||e instanceof Na?t=e.reference:e instanceof al&&(t=e.comment.commentEnd),sf.base.isNullOrUndefined(t.line)?i=n.clone():(r=t.line.getOffset(t,1),(i=new Al(this.owner)).setPositionParagraph(t.line,r)),{startPosition:n,endPosition:i}},t.prototype.checkContentControlLocked=function(e){this.owner.editorModule.isXmlMapped=!1;for(var t=0;t<this.documentHelper.contentControlCollection.length;t++){var i=this.documentHelper.contentControlCollection[t];if(!sf.base.isNullOrUndefined(i.reference)&&-1!==i.reference.indexInOwner){var r=this.getPosition(i),n=r.startPosition,o=r.endPosition,s=this.start,a=this.end;if(this.isForward||(s=this.end,a=this.start),sf.base.isNullOrUndefined(e)){var l=(n.isExistAfter(s)||n.isAtSamePosition(s))&&(n.isExistBefore(a)||n.isAtSamePosition(a)),d=(o.isExistAfter(s)||o.isAtSamePosition(s))&&(o.isExistBefore(a)||o.isAtSamePosition(a));if(l&&d)return!!i.contentControlProperties.lockContentControl;if((l||d)&&!n.isAtSamePosition(s)&&!o.isAtSamePosition(s)&&(i.contentControlProperties.lockContentControl||i.contentControlProperties.lockContents))return!0}if((s.isExistAfter(n)||s.isAtSamePosition(n))&&(a.isExistBefore(o)||a.isAtSamePosition(o))){if(i.contentControlProperties.xmlMapping&&i.contentControlProperties.xmlMapping.isMapped&&(this.owner.editorModule.isXmlMapped=!0),i.contentControlProperties.lockContents)return!0;if(sf.base.isNullOrUndefined(e)&&("CheckBox"===i.contentControlProperties.type||"ComboBox"===i.contentControlProperties.type||"DropDownList"===i.contentControlProperties.type||"Date"===i.contentControlProperties.type))return!0}}}return!1},t.prototype.getElementPosition=function(e,t){var i=e.line.getOffset(e,t?0:1),r=new Al(this.owner);return r.setPositionParagraph(e.line,i),{startPosition:r,endPosition:void 0}},t.prototype.updateRefField=function(e){if(sf.base.isNullOrUndefined(e)&&(e=this.getHyperlinkField(!0)),!sf.base.isNullOrUndefined(e)){if(!this.isReferenceField(e))return;var t=this.getFieldCode(e).replace(/\s+/g," ");if(0===(t=t.trim()).toLowerCase().indexOf("ref")){var i=t.split(" ");if(i.length>1){var r=i[1];if(this.documentHelper.bookmarks.containsKey(r)){var n=this.start,o=this.end;this.isForward||(n=this.end,o=this.start);var s=this.documentHelper.bookmarks.get(r),a=s.reference,l=s.previousNode;!sf.base.isNullOrUndefined(l)&&l instanceof va||!a||!(a.previousNode instanceof va)||1!==a.previousNode.fieldType||sf.base.isNullOrUndefined(a.previousNode.fieldBegin)||sf.base.isNullOrUndefined(a.previousNode.fieldBegin.formFieldData)?l instanceof va&&0===l.fieldType&&!sf.base.isNullOrUndefined(l.formFieldData)&&(s=l.fieldSeparator,a=l.fieldEnd):(s=a.previousNode.fieldBegin.fieldSeparator,a=a.previousNode.fieldBegin.fieldEnd);var d=s.line.getOffset(s,1);n.setPositionParagraph(s.line,d),o.setPositionParagraph(a.line,a.line.getOffset(a,0));var h=this.owner.sfdtExportModule.write(this.owner.documentEditorSettings.optimizeSfdt?1:0,n.currentWidget,n.offset,o.currentWidget,o.offset,!1,!0),c=e.fieldSeparator,p=e.fieldEnd;n.setPositionParagraph(c.line,c.line.getOffset(c,1)),o.setPositionParagraph(p.line,p.line.getOffset(p,0)),this.owner.editor.pasteContents(h)}}}}},t.prototype.footnoteReferenceElement=function(e,t,i){var r=0;if(this.getContainerWidget(e.paragraph)instanceof ha)for(var n=this.start.paragraph.bodyWidget.footNoteReference,o=0;o<this.documentHelper.pages.length;o++){r=0;for(var s=this.documentHelper.pages[o],a=0;a<s.bodyWidgets.length;a++)for(var l=s.bodyWidgets[a],d=0;d<l.childWidgets.length;d++){var h=l.childWidgets[d];if(h instanceof ga)for(var c=0;c<h.childWidgets.length;c++)for(var p=h.childWidgets[c],g=0;g<p.childWidgets.length;g++)for(var f=p.childWidgets[g],u=0;u<f.childWidgets.length;u++)for(var m=f.childWidgets[u],y=0;y<m.childWidgets.length;y++){var v=m.childWidgets[y];if(r=0,!sf.base.isNullOrUndefined(v.children))for(var w=0;w<v.children.length;w++){r+=(x=v.children[w]).length,x instanceof Wa&&x===n&&(e.setPositionParagraph(v,r-1),t.setPositionParagraph(v,r),this.selectRange(e,t))}}else for(var b=0;b<h.childWidgets.length;b++){v=h.childWidgets[b];if(r=0,!sf.base.isNullOrUndefined(v.children))for(w=0;w<v.children.length;w++){var x;r+=(x=v.children[w]).length,x instanceof Wa&&x===n&&(e.setPositionParagraph(v,r-1),t.setPositionParagraph(v,r),this.selectRange(e,t))}}}}},t}(),ql=function(){function e(e){this.wordBefore="\\b",this.wordAfter="\\b",this.owner=e,this.documentHelper=this.owner.documentHelper}return e.prototype.find=function(e,t){return this.findNext(e,t,"0;0;0")},e.prototype.findNext=function(e,t,i){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===i&&(i="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var r=this.owner.searchModule.textSearchResults;return this.findDocument(r,e,!0,t,i),r.length,r.currentSearchResult},e.prototype.stringToRegex=function(e,t){if(e.indexOf("\\")>-1&&(e=e.split("\\").join("\\\\")),e.indexOf("(")>-1||e.indexOf(")")>-1||e.indexOf(".")>-1||e.indexOf("[")>-1||e.indexOf("]")>-1||e.indexOf("$")>-1||e.indexOf("{")>-1||e.indexOf("}")>-1||e.indexOf("*")>-1||e.indexOf("|")>-1||e.indexOf("^")>-1||e.indexOf("?")>-1||e.indexOf("+")>-1){for(var i="",r=0;r<e.length;r++)"("===e[parseInt(r.toString(),10)]||")"===e[parseInt(r.toString(),10)]||"."===e[parseInt(r.toString(),10)]||"["===e[parseInt(r.toString(),10)]||"]"===e[parseInt(r.toString(),10)]||"$"===e[parseInt(r.toString(),10)]||"{"===e[parseInt(r.toString(),10)]||"}"===e[parseInt(r.toString(),10)]||"*"===e[parseInt(r.toString(),10)]||"|"===e[parseInt(r.toString(),10)]||"^"===e[parseInt(r.toString(),10)]||"?"===e[parseInt(r.toString(),10)]||"+"===e[parseInt(r.toString(),10)]?i+="\\"+e[parseInt(r.toString(),10)]:i+=e[parseInt(r.toString(),10)];e=i}return"WholeWord"!==t&&"CaseSensitiveWholeWord"!==t||(e=this.wordBefore+e+this.wordAfter),RegExp(e,"CaseSensitive"===t||"CaseSensitiveWholeWord"===t?"g":"ig")},e.prototype.isPatternEmpty=function(e){var t=this.wordBefore+this.wordAfter,i=e.toString();return 0===i.length||i===t},e.prototype.findAll=function(e,t,i){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===i&&(i="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var r=this.owner.searchModule.textSearchResults;if(this.findDocument(r,e,!1,t,i),r.length>0&&r.currentIndex<0&&(r.currentIndex=0),!sf.base.isNullOrUndefined(r.currentSearchResult)){this.documentHelper.owner;return this.owner.dotNetRef.invokeMethodAsync("SearchResultsChange"),r}},e.prototype.getElementInfo=function(e,t,i,r,n,o,s,l,d){for(var h=e,c="",p=new a,g=0;;){if(e instanceof Fa&&!sf.base.isNullOrUndefined(e.text)&&""!==e.text)p.add(e,d?c.length+g:c.length),g=0,c+=e===h?e.text.substring(t):e.text;else if(e instanceof va){var f=e;sf.base.isNullOrUndefined(f.fieldEnd)||(e=sf.base.isNullOrUndefined(f.fieldSeparator)?f.fieldEnd:f.fieldSeparator)}else e instanceof La&&!sf.base.isNullOrUndefined(e.textFrame)&&e.textFrame.childWidgets.length>0&&this.findInlineText(e.textFrame,r,n,o,s,l);if(e instanceof Fa||(g+=e.length),!sf.base.isNullOrUndefined(e)&&sf.base.isNullOrUndefined(e.nextNode)){var u=e.paragraph.nextSplitWidget;if(!d&&!sf.base.isNullOrUndefined(u)&&u!==e.paragraph&&u.childWidgets.length>0&&u.childWidgets[0]instanceof ma&&u.childWidgets[0].children.length>0){e=u.childWidgets[0].children[0];continue}break}if(!sf.base.isNullOrUndefined(e))if(sf.base.isNullOrUndefined(i)||i)e=e.nextNode;else{var m=e.line.children,y=e.line.children.length;if(!(m.indexOf(e)<y-1)){e=void 0;break}e=e.nextNode}}return{elementsWithOffset:p,fullText:c.toString()}},e.prototype.updateMatchedTextLocation=function(e,t,i,r,n,o,s,a){for(var l=0;l<e.length;l++){var d=e[parseInt(l.toString(),10)],h=void 0;if(sf.base.isNullOrUndefined(a)||!(d.index<a)){for(var c=t.addResult(),p=i.keys,g=0;g<p.length;g++){var f=p[parseInt(g.toString(),10)],u=i.get(f),m=f.length;if(f===n&&(m-=r),sf.base.isNullOrUndefined(c.start)&&d.index<u+m){var y=d.index-u;f===n&&(y+=r);var v=f.line.getOffset(f,y);c.start=this.getTextPosition(f.line,v.toString()),c.start.location=this.owner.selection.getPhysicalPositionInternal(f.line,v,!0),c.start.setPositionParagraph(f.line,v)}if(d.index+d[0].length<=u+m){y=d.index+d[0].length-u;f===n&&(y+=r);v=f.line.getOffset(f,y);c.end=this.getTextPosition(f.line,v.toString()),c.end.location=this.owner.selection.getPhysicalPositionInternal(f.line,v,!0),c.end.setPositionParagraph(f.line,v),h=!0;break}}if(o){t.currentIndex=0;break}if(t.currentIndex<0&&!sf.base.isNullOrUndefined(s)&&(s.isExistBefore(c.start)||s.isAtSamePosition(c.start))&&(t.currentIndex=t.indexOf(c)),!sf.base.isNullOrUndefined(a)&&h)break}}},e.prototype.findDocument=function(e,t,i,r,n){if(!this.isPatternEmpty(t)){void 0===r&&(r="None");var o,s=void 0,a=void 0;if(void 0!==n&&(a=this.owner.selection.end),void 0!==n&&i&&void 0!==a&&void 0!==a.paragraph&&a.paragraph instanceof ca){var l=0,d=a.currentWidget.getInline(this.owner.selection.start.offset,l);if(s=d.element,l=d.index,!sf.base.isNullOrUndefined(s)){var h=void 0;for(h=this.findInline(s,t,r,l,i,e,a);0===e.length&&!sf.base.isNullOrUndefined(h);){for(;!sf.base.isNullOrUndefined(h)&&0===h.childWidgets.length;)h=this.owner.selection.getNextParagraph(h.containerWidget);if(sf.base.isNullOrUndefined(h))break;var c=h.childWidgets[0];if(s=c.children[0]instanceof Va?c.children[2]instanceof Fa?c.children[2]:void 0:c.children[0],sf.base.isNullOrUndefined(s))break;h=this.findInline(s,t,r,0,i,e,a)}if(e.length>0)return}}for(o=this.documentHelper.pages[0].bodyWidgets[0];!sf.base.isNullOrUndefined(o)&&0===o.childWidgets.length;)o=o.nextWidget;if(!sf.base.isNullOrUndefined(o)&&0!==o.childWidgets.length){this.findInlineText(o,t,r,i,e,a);for(var p=this.documentHelper.headersFooters,g=0;g<p.length;g++){var f=p[parseInt(g.toString(),10)];if(f)for(var u in f){var m=f[parseInt(u.toString(),10)];sf.base.isNullOrUndefined(m)||sf.base.isNullOrUndefined(m.page)||this.findInlineText(m,t,r,i,e,a)}}var y=this.documentHelper.endnoteCollection;for(g=0;g<y.length;g++){var v=y[parseInt(g.toString(),10)];v&&(sf.base.isNullOrUndefined(v)||sf.base.isNullOrUndefined(v.bodyWidget.page)||this.findInlineText(v.bodyWidget,t,r,i,e,a))}var w=this.documentHelper.footnoteCollection;for(g=0;g<w.length;g++){var b=w[parseInt(g.toString(),10)];b&&(sf.base.isNullOrUndefined(b)||sf.base.isNullOrUndefined(b.bodyWidget.page)||this.findInlineText(b.bodyWidget,t,r,i,e,a))}i&&!sf.base.isNullOrUndefined(e)&&e.length}}},e.prototype.findInlineText=function(e,t,i,r,n,o){for(var s=this.owner.documentHelper.getFirstParagraphBlock(e.childWidgets[0]);!sf.base.isNullOrUndefined(s)&&1===s.childWidgets.length&&0===s.childWidgets[0].children.length;)s=this.owner.selection.getNextParagraphBlock(s);for(;!sf.base.isNullOrUndefined(s)&&s.childWidgets.length>0;){var a=s.childWidgets[0].children[0];if(sf.base.isNullOrUndefined(a))break;for(this.findInline(a,t,i,0,r,n,o),s=this.owner.selection.getNextParagraphBlock(s);!sf.base.isNullOrUndefined(s)&&(1===s.childWidgets.length&&0===s.childWidgets[0].children.length||!sf.base.isNullOrUndefined(s.previousSplitWidget));)s=this.owner.selection.getNextParagraphBlock(s)}r&&!sf.base.isNullOrUndefined(n)&&n.length},e.prototype.findInline=function(e,t,i,r,n,o,s){for(var a,l=e,d=this.getElementInfo(e,r,void 0,t,i,n,o,s),h=d.fullText,c=[],p=d.elementsWithOffset;!sf.base.isNullOrUndefined(a=t.exec(h));)c.push(a);if(this.updateMatchedTextLocation(c,o,p,r,l,n,s),!n)return this.owner.selection.getNextParagraphBlock(e.line.paragraph)},e.prototype.getTextPosition=function(e,t){var i=new Al(this.owner),r=i.getHierarchicalIndex(e,t);return i.setPositionForCurrentIndex(r),i},e}(),_l=function(){function e(e,t){this.leftInternal=0,this.widthInternal=0,this.leftInternal=e,this.widthInternal=t}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftInternal},set:function(e){this.leftInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthInternal},set:function(e){this.widthInternal=e},enumerable:!0,configurable:!0}),e}(),jl=function(){function e(e){this.startIn=void 0,this.endIn=void 0,this.owner=e,this.documentHelper=this.owner.documentHelper}return Object.defineProperty(e.prototype,"start",{get:function(){return this.startIn},set:function(e){this.startIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.endIn},set:function(e){this.endIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.documentHelper.selection.getTextInternal(this.start,this.end,!1)},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.start=void 0,this.end=void 0},e}(),Gl=function(){function e(e){this.currentIndex=-1,this.owner=e}return Object.defineProperty(e.prototype,"length",{get:function(){return void 0===this.innerList?0:this.innerList.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSearchResult",{get:function(){if(!(void 0===this.innerList||this.currentIndex<0||this.currentIndex>=this.length))return this.innerList[this.currentIndex]},enumerable:!0,configurable:!0}),e.prototype.addResult=function(){var e=new jl(this.owner);return sf.base.isNullOrUndefined(this.innerList)&&(this.innerList=[]),this.innerList.push(e),e},e.prototype.clearResults=function(){if(this.currentIndex=-1,!sf.base.isNullOrUndefined(this.innerList))for(var e=this.innerList.length-1;e>=0;e--)this.innerList[parseInt(e.toString(),10)].destroy(),this.innerList.splice(e,1)},e.prototype.indexOf=function(e){return sf.base.isNullOrUndefined(this.innerList)?-1:this.innerList.indexOf(e)},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.innerList)||this.clearResults(),this.innerList=void 0},e}(),Kl=function(){function e(e){this.searchModule=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.searchModule.textSearchResults.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.searchModule.textSearchResults.currentIndex},set:function(e){0===this.length||e<0||e>this.searchModule.textSearchResults.length-1||(this.searchModule.textSearchResults.currentIndex=e,this.navigate())},enumerable:!0,configurable:!0}),e.prototype.getTextSearchResultsOffset=function(){for(var e,t=[],i=0;i<this.searchModule.textSearchResults.innerList.length;i++)e=this.getOffset(this.searchModule.textSearchResults.innerList[parseInt(i.toString(),10)]),t.push(e);return t},e.prototype.getOffset=function(e){var t=e.start,i=e.end,r=this.searchModule.documentHelper.owner.selection.getParagraphInfo(t),n=this.searchModule.documentHelper.owner.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());return r=this.searchModule.documentHelper.owner.selection.getParagraphInfo(i),{startOffset:n,endOffset:this.searchModule.documentHelper.owner.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())}},e.prototype.getModuleName=function(){return"SearchResults"},e.prototype.replace=function(e){-1!==this.index&&this.searchModule.replaceInternal(e)},e.prototype.replaceAll=function(e){-1!==this.index&&this.searchModule.replaceAllInternal(e)},e.prototype.navigate=function(){this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult),this.searchModule.highlight(this.searchModule.textSearchResults)},e.prototype.clear=function(){this.searchModule.textSearchResults.clearResults(),this.searchModule.clearSearchHighlight(),this.searchModule.viewer.renderVisiblePages()},e}(),Xl=function(){function e(e){this.searchHighlighters=void 0,this.owner=e,this.searchHighlighters=new a,this.textSearch=new ql(this.owner),this.textSearchResults=new Gl(this.owner),this.searchResultsInternal=new Kl(this)}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchResults",{get:function(){return this.searchResultsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentHelper",{get:function(){return this.owner.documentHelper},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"Search"},e.prototype.find=function(e,t){sf.base.isNullOrUndefined(t)&&(t="None");var i=this.textSearch.find(e,t);sf.base.isNullOrUndefined(i)||this.navigate(i)},e.prototype.findAll=function(e,t){if(!sf.base.isNullOrUndefined(e||""===e)){sf.base.isNullOrUndefined(t)&&(t="None");var i=this.textSearch.findAll(e,t);!sf.base.isNullOrUndefined(i)&&i.length>0&&(this.navigate(i.innerList[i.currentIndex]),this.highlight(i))}},e.prototype.replace=function(e,t,i){if(sf.base.isNullOrUndefined(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||!this.viewer.owner.editorModule.canEditContentControl||sf.base.isNullOrUndefined(i))return 0;sf.base.isNullOrUndefined(this.viewer)||this.clearSearchHighlight(),this.navigate(t);var r=this.documentHelper.selection.start;if(this.owner.enableTrackChanges&&this.documentHelper.selection.start.currentWidget){this.documentHelper.selection.end.currentWidget.getInline(this.owner.selection.start.offset,0).element.revisions.length>0&&(this.isRepalceTracking=!0)}if(i.indexOf(t)<0)return 0;this.owner.editorModule.insertTextInternal(e,!0);var n=t.end,o=new Al(this.viewer.owner);if(0===n.currentWidget.children.length){var s=n.currentWidget.paragraph.childWidgets[0];o.setPositionParagraph(s,r.offset-e.length)}else o.setPositionParagraph(n.currentWidget,r.offset-e.length);this.documentHelper.selection.selectRange(r,o);this.viewer.owner;return this.owner.dotNetRef.invokeMethodAsync("SearchResultsChange"),1},e.prototype.replaceInternal=function(e,t){if(""!==e&&!sf.base.isNullOrUndefined(e)){sf.base.isNullOrUndefined(t)&&(t="None");var i=this.textSearchResults.currentSearchResult.text,r=this.viewer.owner.searchModule.textSearch.stringToRegex(i,t),n=this.owner.selection.end.getHierarchicalIndexInternal(),o=this.viewer.owner.searchModule.textSearch.findNext(r,t,n);sf.base.isNullOrUndefined(o)||(this.navigate(o),this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=o,this.replace(e,o,this.textSearchResults),n=this.owner.selection.end.getHierarchicalIndexInternal(),(o=this.textSearch.findNext(i,t,n))&&(this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=o,this.navigate(o)))}},e.prototype.replaceAll=function(e,t){if(sf.base.isNullOrUndefined(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||sf.base.isNullOrUndefined(t))return 0;this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(this.owner.selection,"ReplaceAll");var i=t.length;this.viewer.owner.isLayoutEnabled=!1;for(var r=t.innerList[0].text,n=i-1;n>=0;n--){var o=t.innerList[parseInt(n.toString(),10)];if(0===o.start.currentWidget.children.length)n=(t=this.textSearch.findAll(r)).length;else{if(this.navigate(o),this.viewer.owner.isReadOnlyMode||!this.viewer.owner.editorModule.canEditContentControl)continue;var s=!0;if(n>0)t.innerList[n-1].start.paragraph.equals(o.start.paragraph)&&(s=!1);this.owner.editorModule.insertTextInternal(e,!0,void 0,s),o.destroy()}}return this.owner.editorHistory&&!sf.base.isNullOrUndefined(this.owner.editorHistory.currentHistoryInfo)?this.owner.editorHistory.updateComplexHistory():this.owner.editorModule.updateComplexWithoutHistory(2),this.searchResults.clear(),i},e.prototype.replaceAllInternal=function(e,t){sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(t)&&(t="None"),this.textSearchResults.length>0&&(this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]),this.highlight(this.textSearchResults),this.replaceAll(e,this.textSearchResults)))},e.prototype.navigate=function(e){if(e){var t=e.start,i=e.end;sf.base.isNullOrUndefined(this.owner)||sf.base.isNullOrUndefined(this.owner.selection)||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(t.paragraph)||sf.base.isNullOrUndefined(i.paragraph)||this.owner.selection.selectRange(t,i)}},e.prototype.highlight=function(e){this.searchHighlighters=new a;for(var t=0;t<e.innerList.length;t++){var i=e.innerList[parseInt(t.toString(),10)];this.highlightResult(i)}this.viewer.renderVisiblePages()},e.prototype.highlightResult=function(e){this.highlightSearchResult(e.start.paragraph,e.start,e.end)},e.prototype.highlightSearchResult=function(e,t,i){var r=0,n=0,o=null,s=null,a=this.documentHelper.selection.getStartLineWidget(e,t,o,r);r=a.index;var l=(o=a.element)?o.line:e.childWidgets[0],d=this.documentHelper.selection.getEndLineWidget(i,s,n);n=d.index;var h=(s=d.element)?s.line:i.paragraph.childWidgets[i.paragraph.childWidgets.length-1],c=this.documentHelper.selection.getTop(l),p=this.documentHelper.selection.getLeftInternal(l,o,r);if(sf.base.isNullOrUndefined(l)||l!==h){if(!sf.base.isNullOrUndefined(l)){e!==l.paragraph&&(e=l.paragraph);y=this.documentHelper.selection.getWidth(l,!0)-(p-l.paragraph.x);if(e.bidi||o instanceof Fa&&o.isRightToLeft){u=0;var g=this.documentHelper.selection.getElementsForward(l,o,s,e.bidi);if(g)for(x=!1,w=0;w<g.length;w++){I=(b=g[w])instanceof Fa?b.length:1;u=this.documentHelper.selection.getLeftInternal(l,b,I),x=!1,p=b===o?this.documentHelper.selection.getLeftInternal(l,b,r):this.documentHelper.selection.getLeftInternal(l,b,0),b instanceof Fa&&(x=b.isRightToLeft),y=Math.abs(u-p),this.createHighlightBorder(l,y,x?u:p,c)}}else this.createHighlightBorder(l,y,p,c);var f=l.paragraph.childWidgets.indexOf(l);for(w=0;w<e.childWidgets.length;w++){if(e===l.paragraph&&(f+=1),this.highlightSearchResultParaWidget(e,f,h,s,n),e===h.paragraph)return;f=0,e=h.paragraph,w--}}}else{var u=this.documentHelper.selection.getLeftInternal(h,s,n),m=!1;s instanceof Fa&&(m=s.isRightToLeft);var y=0;if(y=Math.abs(u-p),!m&&o instanceof Fa&&(m=o.isRightToLeft),m||e.bidi){var v=this.documentHelper.selection.getElementsForward(l,o,s,e.bidi);if(v&&v.length>1)for(var w=0;w<v.length;w++){var b,x=!1,I=(b=v[w])instanceof Fa?b.length:1;b===o?(p=this.documentHelper.selection.getLeftInternal(l,b,r),u=this.documentHelper.selection.getLeftInternal(l,b,I)):b===s?(p=this.documentHelper.selection.getLeftInternal(l,b,0),u=this.documentHelper.selection.getLeftInternal(l,b,n)):(p=this.documentHelper.selection.getLeftInternal(l,b,0),u=this.documentHelper.selection.getLeftInternal(l,b,I)),b instanceof Fa&&(x=b.isRightToLeft),y=Math.abs(u-p),this.createHighlightBorder(l,y,x?u:p,c)}else this.createHighlightBorder(l,y,m?u:p,c)}else this.createHighlightBorder(l,y,p,c)}},e.prototype.createHighlightBorder=function(e,t,i,r){var n=this.addSearchHighlightBorder(e),o=this.viewer.owner.selection.getPage(e.paragraph);o.boundingRectangle.y,o.boundingRectangle.x;n.left=Math.ceil(i),r=Math.ceil(r),n.width=Math.floor(t);Math.floor(e.height),this.documentHelper.containerContext},e.prototype.addSearchHighlightBorder=function(e){var t=void 0,i=this.searchHighlighters;i.containsKey(e)?t=i.get(e):(t=[],i.add(e,t));var r=new _l(0,0);return t.push(r),r},e.prototype.highlightSearchResultParaWidget=function(e,t,i,r,n){for(var o=0,s=0,a=!1,l=t;l<e.childWidgets.length;l++){var d=e.childWidgets[l];l===t&&(o=this.documentHelper.selection.getTop(d));var h=this.documentHelper.selection.getLeft(d);if(r instanceof Fa&&(a=r.isRightToLeft),d===i){var c=0;if(a||e.bidi){for(var p=this.documentHelper.selection.getElementsBackward(d,r,r,e.bidi),g=0;g<p.length;g++){var f=p[g],u=!1;if(h=this.documentHelper.selection.getLeftInternal(d,f,0),f===r)c=this.documentHelper.selection.getLeftInternal(d,f,n);else{var m=f instanceof Fa?f.length:1;c=this.documentHelper.selection.getLeftInternal(d,f,m)}f instanceof Fa&&(u=f.isRightToLeft),s=Math.abs(c-h),this.createHighlightBorder(d,s,u?c:h,o)}return}return c=this.documentHelper.selection.getLeftInternal(i,r,n),s=Math.abs(c-h),void this.createHighlightBorder(d,s,a?c:h,o)}s=this.documentHelper.selection.getWidth(d,!0)-(h-e.x),this.createHighlightBorder(d,s,h,o),o+=d.height}},e.prototype.addSearchResultItems=function(e){sf.base.isNullOrUndefined(e)||""===e||(sf.base.isNullOrUndefined(this.owner.findResultsList)&&(this.owner.findResultsList=[]),this.owner.findResultsList.push(e))},e.prototype.addFindResultView=function(e){for(var t=0;t<e.innerList.length;t++){var i=e.innerList[t];this.addFindResultViewForSearch(i)}},e.prototype.addFindResultViewForSearch=function(e){if(null!=e.start&&null!=e.end&&null!=e.start.paragraph&&null!=e.end.paragraph){var t=void 0,i=0,r=e.start.currentWidget.getInline(e.start.offset,i),n=r.element;i=r.index;var o="",s=0;if(n instanceof va){var a=this.owner.selection.getRenderedInline(n,i);a.element.nextNode instanceof Fa?(n=a.element.nextNode,i=a.index):(n=a.element,i=a.index)}var l=this.owner.selection.getElementBoxInternal(n,i),d=l.element;if(i=l.index,null!=d){d instanceof Fa&&i>0&&(o=d.text.substring(0,i));var h=d.line.children.indexOf(d);for(s=o.lastIndexOf(" ");s<0&&h>0&&d.line.children[h-1]instanceof Fa;)o=d.line.children[h-1].text+o,h--,s=o.lastIndexOf(" ")}var c=o.lastIndexOf("\v");c>0?o=o.substring(0,c):(s=o.lastIndexOf(" "))<0?o:o.substring(s+1),e.text;var p=0,g=e.end.currentWidget.getInline(e.end.offset,p),f=g.element;if(p=g.index,t="",null!=l&&(d=(l=this.owner.selection.getElementBoxInternal(f,p)).element,p=l.index),null!=d){d instanceof Fa&&p<d.length&&(t=d.text.substring(p));for(h=d.line.children.indexOf(d);h+1<d.line.children.length&&d.line.children[h+1]instanceof Fa||d.line.children[h+1]instanceof va;)d.line.children[h+1]instanceof va?h+=2:(t+=d.line.children[h+1].text,h+=1)}s=t.lastIndexOf(" "),t="\v"===t?t="":t;var u="",m="",y=e.start.paragraph.containerWidget,v=y instanceof la?y.headerFooterType:"";-1!=v.indexOf("Header")?u='<span class="e-de-header-footer-list">Header: </span>':-1!=v.indexOf("Footer")&&(m='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+u+o+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+t+"</li>",u='<span class="e-de-header-footer-list">Footer: </span>'),m='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+u+o+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+t+"</li>",this.addSearchResultItems(m)}},e.prototype.clearSearchHighlight=function(){sf.base.isNullOrUndefined(this.searchHighlighters)||(this.searchHighlighters.clear(),this.searchHighlighters=void 0);this.viewer.owner;this.owner.dotNetRef.invokeMethodAsync("SearchResultsChange")},e.prototype.destroy=function(){this.textSearchResults&&this.textSearchResults.destroy()},e}(),Jl=function(){},Yl=function(){function e(e,t){this.ownerListLevelIn=void 0,this.modifiedListLevelIn=void 0,this.ownerListLevel=e,this.modifiedListLevel=t}return Object.defineProperty(e.prototype,"ownerListLevel",{get:function(){return this.ownerListLevelIn},set:function(e){this.ownerListLevelIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedListLevel",{get:function(){return this.modifiedListLevelIn},set:function(e){this.modifiedListLevelIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.ownerListLevel=void 0,this.modifiedListLevel=void 0},e}(),Zl=function(){function e(e,t){this.ownerFormatIn=void 0,this.modifiedFormatIn=void 0,this.ownerFormat=e,this.modifiedFormat=t}return Object.defineProperty(e.prototype,"ownerFormat",{get:function(){return this.ownerFormatIn},set:function(e){this.ownerFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedFormat",{get:function(){return this.modifiedFormatIn},set:function(e){this.modifiedFormatIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.ownerFormat=void 0,this.modifiedFormat.destroy(),this.modifiedFormat=void 0},e}(),Ql=function(){function e(e,t,i,r){this.startingPoint=t,this.rowFormat=i,this.rowHeightType=i.heightType,this.tableHierarchicalIndex=r.selection.getHierarchicalIndex(e,"0")}return e.prototype.revertChanges=function(e,t,i){var r=this.rowFormat.heightType,n=i.childWidgets[this.rowFormat.ownerBase.index];t.editorModule.tableResize.updateRowHeight(n,e?this.displacement:-this.displacement),t.documentHelper.layout.reLayoutTable(i),this.rowFormat.heightType!==this.rowHeightType&&(this.rowFormat.heightType=this.rowHeightType),this.rowHeightType=r},e}(),$l=function(){function e(e,t){this.tableHolder=new hl,this.tableFormat=new ed,this.rows=[],this.owner=t,this.copyProperties(e)}return e.prototype.copyProperties=function(e){e.tableHolder&&(this.tableHolder=e.tableHolder.clone()),e.tableFormat&&(this.tableFormat.leftIndent=e.tableFormat.leftIndent,this.tableFormat.preferredWidth=e.tableFormat.preferredWidth,this.tableFormat.preferredWidthType=e.tableFormat.preferredWidthType,this.tableFormat.allowAutoFit=e.tableFormat.allowAutoFit);for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[parseInt(t.toString(),10)],r=new td;r.gridBefore=i.rowFormat.gridBefore,r.gridBeforeWidth=i.rowFormat.gridBeforeWidth,r.gridBeforeWidthType=i.rowFormat.gridBeforeWidthType,r.gridAfter=i.rowFormat.gridAfter,r.gridAfterWidth=i.rowFormat.gridAfterWidth,r.gridAfterWidthType=i.rowFormat.gridAfterWidthType;for(var n=0;n<i.childWidgets.length;n++){var o=i.childWidgets[parseInt(n.toString(),10)],s=new id;s.columnIndex=o.columnIndex,s.columnSpan=o.cellFormat.columnSpan,s.preferredWidth=o.cellFormat.preferredWidth,s.preferredWidthType=o.cellFormat.preferredWidthType,r.cells.push(s)}this.rows.push(r)}this.tableHierarchicalIndex=this.owner.selection.getHierarchicalIndex(e,"0")},e.prototype.destroy=function(){this.tableHierarchicalIndex=void 0,this.tableHolder&&(this.tableHolder.destroy(),this.tableHolder=void 0),this.tableFormat&&(this.tableFormat=null),this.rows&&(this.rows=[],this.rows=void 0)},e}(),ed=function(){},td=function(){this.cells=[]},id=function(){},rd=function(){function e(e){this.ownerIn=e,this.documentHelper=e.documentHelper,this.modifiedPropertiesIn=[],this.modifiedNodeLength=[],this.removedNodesIn=[]}return Object.defineProperty(e.prototype,"owner",{get:function(){return this.ownerIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.owner.editorHistory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"action",{get:function(){return this.actionIn},set:function(e){this.actionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedProperties",{get:function(){return this.modifiedPropertiesIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removedNodes",{get:function(){return this.removedNodesIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this.selectionStartIn},set:function(e){this.selectionStartIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this.selectionEndIn},set:function(e){this.selectionEndIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"insertPosition",{get:function(){return this.insertPositionIn},set:function(e){this.insertPositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endPosition",{get:function(){return this.endPositionIn},set:function(e){this.endPositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.ownerIn.viewer},enumerable:!0,configurable:!0}),e.prototype.updateSelection=function(){var e=this.owner.selection.getParagraphInfo(this.owner.selection.start);this.selectionStart=this.owner.selection.getHierarchicalIndex(e.paragraph,e.offset.toString()),e=this.owner.selection.getParagraphInfo(this.owner.selection.end),this.selectionEnd=this.owner.selection.getHierarchicalIndex(e.paragraph,e.offset.toString())},e.prototype.setBookmarkInfo=function(e){this.removedNodes.push({bookmark:e,startIndex:e.indexInOwner,endIndex:e.reference.indexInOwner})},e.prototype.setFormFieldInfo=function(e,t){this.removedNodes.push({formField:e,value:t})},e.prototype.setEditRangeInfo=function(e){this.removedNodes.push({editStart:e,startIndex:e.indexInOwner,endIndex:e.editRangeEnd.indexInOwner})},e.prototype.revertFormTextFormat=function(){var e=this.removedNodes[0],t=e.value,i=e.formField;this.editorHistory.isUndoing?(this.owner.editorModule.applyTextFormatInternal(i,t),this.editorHistory.recordChanges(this)):(t=x.formatText(i.formFieldData.format,t),this.owner.editorModule.applyTextFormatInternal(i,t),this.editorHistory.undoStack.push(this))},e.prototype.revertFormField=function(){var e=this.removedNodes[0],t=e.formField;t.formFieldData instanceof xa?this.owner.editorModule.toggleCheckBoxFormField(t,!0,e.value):this.owner.editorModule.updateFormField(t,e.value)},e.prototype.revertBookmark=function(){var e=this.removedNodes[0],t=e.bookmark;if(this.editorHistory.isUndoing){this.documentHelper.bookmarks.add(t.name,t),t.line.children.splice(e.startIndex,0,t);var i=t.previousNode;i instanceof va&&!sf.base.isNullOrUndefined(i.formFieldData)&&(i.formFieldData.name=t.name),t.reference&&t.reference.line.children.splice(e.endIndex,0,t.reference),this.editorHistory.recordChanges(this)}else this.owner.editorModule.deleteBookmarkInternal(t),this.editorHistory.undoStack.push(this)},e.prototype.revertComment=function(){var e=this.insertPosition,t=this.removedNodes[0],i=!1;if("InsertCommentWidget"===this.action?i=this.editorHistory.isRedoing:"DeleteCommentWidget"===this.action&&(i=this.editorHistory.isUndoing),i)t&&(t.isReply?this.owner.editor.addReplyComment(t,this.insertPosition):this.owner.editor.addCommentWidget(t,!1,!0,!0));else{var r=this.owner.editor.getCommentElementBox(e);this.owner.editor.deleteCommentWidget(r)}},e.prototype.revertEditRangeRegion=function(){var e=this.removedNodes[0],t=e.editStart;if(this.editorHistory.isUndoing){var i=""===t.user?t.group:t.user;this.owner.editor.updateRangeCollection(t,i),t.line.children.splice(e.startIndex,0,t),t.editRangeEnd.line.children.splice(e.endIndex,0,t.editRangeEnd),this.editorHistory.recordChanges(this)}else this.owner.editorModule.removeUserRestrictionsInternal(t),this.editorHistory.undoStack.push(this);this.owner.editor.fireContentChange()},e.prototype.revert=function(){if("FormTextFormat"!==this.action)if("UpdateFormField"!==this.action)if("DeleteBookmark"!==this.action)if("RemoveEditRange"!==this.action)if("InsertCommentWidget"!==this.action&&"DeleteCommentWidget"!==this.action){if("ListFormat"===this.action&&""!==this.owner.editor.listNumberFormat){var e=this.documentHelper.lists[0].abstractList.levels[this.owner.editor.listLevelNumber],t=e.listLevelPattern,i=e.numberFormat;e.listLevelPattern=this.owner.editor.listLevelPattern,e.numberFormat=this.owner.editor.listNumberFormat,this.owner.editor.listLevelPattern=t,this.owner.editor.listNumberFormat=i}this.owner.isShiftingEnabled=!0;var r=void 0,n=void 0,o=this.selectionStart,s=this.selectionEnd,a=Al.isForwardSelection(o,s);if(this.modifiedProperties.length>0||"Selection"===this.action||"ClearCharacterFormat"===this.action||"ClearParagraphFormat"===this.action)r=this.owner.selection.getTextPosBasedOnLogicalIndex(o),n=this.owner.selection.getTextPosBasedOnLogicalIndex(s),this.revertModifiedProperties(r,n);else{var l=this.owner.selection,d=this.removedNodes;this.removedNodesIn=[],sf.base.isNullOrUndefined(this.endPosition)&&(this.endPosition=this.insertPosition);var h,c=Al.isForwardSelection(this.insertPosition,this.endPosition),p=l.getTextPosBasedOnLogicalIndex(c?this.insertPosition:this.endPosition),g=l.getTextPosBasedOnLogicalIndex(c?this.endPosition:this.insertPosition);if("RemoveRowTrack"===this.action&&this.editorHistory.isUndoing&&(this.owner.selection.select(this.selectionEnd,this.selectionEnd),this.owner.selection.start.paragraph.isInsideTable&&(this.endRevisionLogicalIndex=this.selectionEnd)),this.editorHistory.isUndoing&&(this.lastElementRevision&&sf.base.isNullOrUndefined(this.isAcceptOrReject)&&d.length>0&&d[0]instanceof ca&&d[0].isEmpty()?this.endRevisionLogicalIndex=this.selectionEnd:this.lastElementRevision&&sf.base.isNullOrUndefined(this.endRevisionLogicalIndex)?this.updateEndRevisionInfo():"RemoveRowTrack"===this.action&&(this.endRevisionLogicalIndex=this.selectionEnd)),"ClearRevisions"===this.action&&(this.undoRevisionForElements(p,g,d[d.length-1]),d=[]),"Uppercase"===this.action)return l.selectPosition(p,g),this.editorHistory.currentBaseHistoryInfo=this,(h=this.owner.editorModule).changeSelectedTextCase(l,p,g,this.action.toString(),d),void h.reLayout(l);if("Lowercase"===this.action)return l.selectPosition(p,g),this.editorHistory.currentBaseHistoryInfo=this,(h=this.owner.editorModule).changeSelectedTextCase(l,p,g,this.action.toString(),d),void h.reLayout(l);if("CapitalizeEachWord"===this.action)return l.selectPosition(p,g),this.editorHistory.currentBaseHistoryInfo=this,(h=this.owner.editorModule).changeSelectedTextCase(l,p,g,this.action.toString(),d),void h.reLayout(l);if("SentenceCase"===this.action)return l.selectPosition(p,g),this.editorHistory.currentBaseHistoryInfo=this,(h=this.owner.editorModule).changeSelectedTextCase(l,p,g,this.action.toString(),d),void h.reLayout(l);if("ToggleCase"===this.action)return l.selectPosition(p,g),this.editorHistory.currentBaseHistoryInfo=this,(h=this.owner.editorModule).changeSelectedTextCase(l,p,g,this.action.toString(),d),void h.reLayout(l);if(p.isAtSamePosition(g)?l.selectContent(p,!0):l.selectPosition(p,g),"InsertHyperlink"===this.action&&this.editorHistory.isRedoing){var f=this.owner.selection.getHyperlinkField();if(!sf.base.isNullOrUndefined(f)){var u=f.line.getOffset(f,0);p.setPositionParagraph(f.line,u),this.owner.selection.start.setPositionInternal(p),u=f.fieldEnd.line.getOffset(f.fieldEnd,1),g.setPositionParagraph(f.fieldEnd.line,u)}}this.editorHistory.currentBaseHistoryInfo=this,this.selectionStart=this.insertPosition,this.insertPosition=void 0,this.selectionEnd=this.endPosition,this.endPosition=void 0;var m=!1;if(this.endRevisionLogicalIndex&&d.length>0){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing&&p.isAtSamePosition(g)){var y=l.getTextPosBasedOnLogicalIndex(this.endRevisionLogicalIndex);l.selectPosition(p,y)}(this.editorHistory.isUndoing||this.editorHistory.isRedoing&&!this.owner.selectionModule.isEmpty&&d.length>0)&&(this.owner.editor.deleteSelectedContents(l,!0),m=!0)}if(p.isAtSamePosition(g)||m)if("SectionBreakContinuous"===this.action&&p&&this.editorHistory.isUndoing){if(0===p.offset&&!sf.base.isNullOrUndefined(p.paragraph.previousRenderedWidget)&&p.paragraph.previousRenderedWidget instanceof ca&&p.paragraph.previousRenderedWidget.isEndsWithPageBreak&&p.paragraph.containerWidget instanceof aa&&p.currentWidget===p.currentWidget.paragraph.firstChild&&"NoBreak"===p.paragraph.containerWidget.sectionFormat.breakCode){var v=p.paragraph.previousRenderedWidget.containerWidget;this.owner.editor.combineSectionInternal(this.owner.selection,v,p.paragraph.containerWidget),this.owner.editorModule.layoutWholeDocument()}}else m=!1,p.isAtSamePosition(g)||(m="BackSpace"===this.action||"Delete"===this.action||"ClearCells"===this.action||"DeleteCells"===this.action);else{m="BackSpace"===this.action||"Delete"===this.action||"ClearCells"===this.action||"DeleteCells"===this.action;var w=d.length>0&&"ParaMarkTrack"===this.action||"ClearRevisions"===this.action||"AcceptTOC"===this.action;m||"MergeCells"===this.action||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"DeleteTable"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||(l.end.setPositionInternal(g),this.owner.selection.isEmpty||w||(this.editorHistory.isRedoing&&"Accept Change"!==this.action&&"ParaMarkTrack"!==this.action&&"ParaMarkReject"!==this.action&&"RemoveRowTrack"!==this.action?this.owner.editorModule.removeSelectedContents(l):this.owner.editorModule.deleteSelectedContents(l,!0),!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.blockToShift&&this.documentHelper.layout.shiftLayoutedItems(!1)))}var b=this.editorHistory.isRedoing&&!m;m=!this.lastElementRevision&&m,this.revertModifiedNodes(d,b,a?o:s,o===s);var x=!1;"DeleteCells"===this.action&&(x=!0),m&&this.removeContent(p,g,x)}var I=!1,F=!1;sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"Reject All"!==this.editorHistory.currentHistoryInfo.action&&"Accept All"!==this.editorHistory.currentHistoryInfo.action&&"Paste"!==this.editorHistory.currentHistoryInfo.action||(F=!0),(!this.owner.trackChangesPane.isTrackingPageBreak&&((this.editorHistory.isUndoing||this.endRevisionLogicalIndex||"RemoveRowTrack"===this.action||F)&&sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||F)||("InsertRowAbove"===this.action||"Borders"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Accept Change"===this.action)&&(this.editorHistory.isRedoing||"Paste"===this.editorHistory.currentHistoryInfo.action))&&("RemoveRowTrack"===this.action&&this.editorHistory.isRedoing?(r=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionStart),n=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionEnd)):(r=this.owner.selection.getTextPosBasedOnLogicalIndex(o),n=this.owner.selection.getTextPosBasedOnLogicalIndex(s)),this.owner.selection.selectRange(r,n),I=!0),this.owner.trackChangesPane.isTrackingPageBreak=!1,this.insertPosition=o,this.endPosition=s,sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"Accept All"!==this.editorHistory.currentHistoryInfo.action&&"Reject All"!==this.editorHistory.currentHistoryInfo.action||this.owner.documentHelper.blockToShift&&this.owner.documentHelper.layout.shiftLayoutedItems(!1),this.owner.editorModule.reLayout(this.owner.selection,this.owner.selection.isEmpty),this.editorHistory.isUndoing&&"SectionBreak"===this.action&&this.owner.editorModule.layoutWholeDocument(),I&&this.documentHelper.scrollToPosition(this.owner.selection.start,this.owner.selection.end),this.highlightListText()}else this.revertComment();else this.revertEditRangeRegion();else this.revertBookmark();else this.revertFormField();else this.revertFormTextFormat()},e.prototype.highlightListText=function(){if(!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&("ListCharacterFormat"===this.action||"ListSelect"===this.editorHistory.currentHistoryInfo.action&&"ListFormat"===this.action)){var e=this.owner.selection.getTextPosBasedOnLogicalIndex(this.selectionStart).currentWidget;this.documentHelper.selection.highlightListText(e)}},e.prototype.removeContent=function(e,t,i){if(!sf.base.isNullOrUndefined(e.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof aa&&!sf.base.isNullOrUndefined(t.paragraph.containerWidget)&&t.paragraph.containerWidget instanceof aa||!sf.base.isNullOrUndefined(e.paragraph.containerWidget)&&!sf.base.isNullOrUndefined(t.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof ua&&t.paragraph.containerWidget instanceof ua&&!sf.base.isNullOrUndefined(e.paragraph.bodyWidget)||!sf.base.isNullOrUndefined(e.paragraph.containerWidget)&&!sf.base.isNullOrUndefined(t.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof Aa&&t.paragraph.containerWidget instanceof Aa){this.owner.selection.selectRange(e,t);var r=!1;"BackSpace"!==this.action&&"Uppercase"!==this.action&&"RemoveRowTrack"!==this.action||(r=!0),this.owner.editorModule.deleteSelectedContents(this.owner.selection,r,i)}},e.prototype.updateEndRevisionInfo=function(){this.lastElementRevision=this.checkAdjacentNodeForMarkedRevision(this.lastElementRevision);var e=this.retrieveEndPosition(this.lastElementRevision),t=this.owner.selection.getParagraphInfo(e),i=t.paragraph==this.owner.editor.getLastParaForBodywidgetCollection(t.paragraph);t.paragraph.getLength()!=t.offset||t.paragraph.isInsideTable||i||t.offset++,this.endRevisionLogicalIndex=this.owner.selection.getHierarchicalIndex(t.paragraph,t.offset.toString()),this.lastElementRevision.isMarkedForRevision=!1},e.prototype.retrieveEndPosition=function(e){var t=new Al(this.owner),i=e.line.getOffset(e,0)+e.length;return t.setPositionFromLine(e.line,i),t},e.prototype.checkAdjacentNodeForMarkedRevision=function(e){for(var t,i=e.nextNode;!sf.base.isNullOrUndefined(i)&&i.isMarkedForRevision;)t=i,i=i.nextNode;return sf.base.isNullOrUndefined(t)?e:t},e.prototype.revertModifiedProperties=function(e,t){"CellFormat"!==this.action&&"CellOptions"!==this.action&&"TableOptions"!==this.action||(this.owner.isShiftingEnabled=!1),this.owner.selection.selectRange(e,t),"RowResizing"===this.action||"CellResizing"===this.action?this.revertResizing():"CellOptions"===this.action||"TableOptions"===this.action?this.revertTableDialogProperties(this.action):"Selection"!==this.action&&this.revertProperties()},e.prototype.redoAction=function(){var e=this.owner.editorModule;switch(this.action){case"BackSpace":e.singleBackspace(this.owner.selection,!0);break;case"Delete":e.singleDelete(this.owner.selection,!0);break;case"DeleteTable":e.deleteTable();break;case"DeleteColumn":e.deleteColumn();break;case"DeleteRow":e.deleteRow();break;case"MergeCells":e.mergeSelectedCellsInTable();break;case"InsertRowAbove":e.insertRow(!0);break;case"InsertRowBelow":e.insertRow(!1);break;case"InsertColumnLeft":case"InsertColumnRight":e.insertColumn(!0);break;case"SectionBreak":e.insertSection(this.owner.selection,!0);break;case"SectionBreakContinuous":e.insertSection(this.owner.selection,!0,void 0,!0);break;case"TableAutoFitToContents":e.autoFitTable("FitToContents");break;case"TableAutoFitToWindow":e.autoFitTable("FitToWindow");break;case"TableFixedColumnWidth":e.autoFitTable("FixedColumnWidth");break;case"RemoveRowTrack":this.owner.selection.handleAcceptReject(!0)}},e.prototype.revertModifiedNodes=function(e,t,i,r){if((!t||"BackSpace"!==this.action&&"Delete"!==this.action&&"DeleteTable"!==this.action&&"DeleteColumn"!==this.action&&"DeleteRow"!==this.action&&"InsertRowAbove"!==this.action&&"InsertRowBelow"!==this.action&&"InsertColumnLeft"!==this.action&&"InsertColumnRight"!==this.action&&"MergeCells"!==this.action&&"SectionBreak"!==this.action&&"SectionBreakContinuous"!==this.action&&"TableAutoFitToContents"!==this.action&&"TableAutoFitToWindow"!==this.action&&"TableFixedColumnWidth"!==this.action||(this.redoAction(),"SectionBreak"!==this.action&&"SectionBreakContinuous"!==this.action))&&e.length>0)if(this.editorHistory.isUndoing&&("RemoveRowTrack"===this.action||"DeleteCells"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||"MergeCells"===this.action)||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"ClearCells"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"TableAutoFitToContents"===this.action||"TableAutoFitToWindow"===this.action||"TableFixedColumnWidth"===this.action||"RemoveRowTrack"===this.action){var n=this.selectionStart,o=this.owner.editorModule.getBlock({index:n}).node,s=e[e.length-1];(o instanceof ga||o.previousRenderedWidget instanceof ga||o.isInsideTable)&&s instanceof ga?(o instanceof ca&&!o.isInsideTable?o=o.previousRenderedWidget:o instanceof ca&&o.isInsideTable&&(o=o.associatedCell.ownerTable),o=o.combineWidget(this.viewer),this.owner.editorModule.insertTableInternal(o,s,!1),e.splice(e.indexOf(s),1)):s instanceof ga&&"RemoveRowTrack"!==this.action?this.owner.editorModule.insertBlock(s):this.insertRemovedNodes(e,e[e.length-1])}else{var a=i;o=this.owner.editorModule.getBlock({index:a}).node;if(e.length>0&&("BackSpace"===this.action&&r||!(o instanceof ga)&&!(o instanceof la))){if((s=e[0])instanceof aa&&!sf.base.isNullOrUndefined(e[1])&&(s=e[1]),("TrackingPageBreak"===this.action||("SectionBreak"===this.action||"SectionBreakContinuous"===this.action)&&s instanceof aa||!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action)&&(s=e[1]),s instanceof T){var l=new ca;l.characterFormat=s,this.owner.editorModule.insertNewParagraphWidget(l,!0),e.splice(e.indexOf(s),1),o=l}var d=!1;if(sf.base.isNullOrUndefined(this.isAcceptOrReject)||(d=!0,!sf.base.isNullOrUndefined(this.owner.selectionModule.start.paragraph.nextRenderedWidget)&&this.owner.selectionModule.start.paragraph.nextRenderedWidget instanceof ga&&(d=!1)),s instanceof ca&&this.owner.selection.start.offset>0&&!d&&(this.owner.editorModule.insertNewParagraphWidget(s,!0),s.characterFormat.removedIds.length>0&&this.owner.editor.constructRevisionFromID(s.characterFormat,void 0),e.splice(e.indexOf(s),1),sf.base.isNullOrUndefined(o))){var h=this.documentHelper.selection.getNextParagraphBlock(s.getSplitWidgets().pop());this.owner.selection.getNextRenderedBlock(s);var c=this.owner.selection.start.paragraph;!(h&&c&&c.bodyWidget instanceof aa)||c.isInsideTable||this.owner.selection.isinEndnote||this.owner.selection.isinFootnote||c.bodyWidget.equals(h.bodyWidget)||(h=void 0),sf.base.isNullOrUndefined(h)&&this.owner.selection.selectParagraphInternal(s,!0)}if(s instanceof ga&&this.owner.selection.start.offset>0){var p=e[e.length-1];if(p instanceof ca&&(this.owner.editorModule.insertNewParagraphWidget(p,!0),e.splice(e.indexOf(p),1),sf.base.isNullOrUndefined(o))){h=this.documentHelper.selection.getNextParagraphBlock(p.getSplitWidgets().pop());sf.base.isNullOrUndefined(h)&&this.owner.selection.selectParagraphInternal(p,!0)}}}if(e.length>0){var g=e[e.length-1];if(o instanceof ga&&(o=o.combineWidget(this.viewer),g instanceof ga)){this.owner.editorModule.insertTableInternal(o,g,!0),e.splice(e.indexOf(g),1),this.insertPosition=i;var f=g.getSplitWidgets().pop();f.nextRenderedWidget instanceof ga?o=f.nextRenderedWidget:(a=i,o=this.owner.editorModule.getBlock({index:a}).node)}if(g instanceof ca&&this.owner.selection.start.offset>0&&this.owner.selection.start.offset===this.owner.selection.getLineLength(this.owner.selection.start.paragraph.lastChild)){var u=this.owner.editorModule;u.insertNewParagraphWidget(g,!1),g.characterFormat.removedIds.length>0&&this.owner.editor.constructRevisionFromID(g.characterFormat,void 0),e.splice(e.indexOf(g),1),"Paste"!==this.action&&u.removeBlock(this.owner.selection.start.paragraph);var m=this.documentHelper.selection.getNextParagraphBlock(g.getSplitWidgets().pop());sf.base.isNullOrUndefined(m)?sf.base.isNullOrUndefined(g)||this.owner.selectionModule.selectParagraphInternal(g,!1):this.owner.selection.selectParagraphInternal(m,!0)}else if(e[0]instanceof ga&&1!==e.length){var y=e[1];y instanceof ca&&y.isEmpty()&&e.splice(e.indexOf(y),1)}}e.length>0&&(o instanceof ga&&(o=o.combineWidget(this.viewer)),this.insertRemovedNodes(e,o))}},e.prototype.insertRemovedNodes=function(e,t){for(var i=!1,r=e.length-1;r>-1;r--){var n=e[r];if(n instanceof ya)this.owner.editorModule.insertInlineInSelection(this.owner.selection,n);else if(n instanceof ca&&void 0===n.childWidgets)this.owner.selection.moveToNextParagraph();else if(n instanceof da)n instanceof fa?t instanceof ga&&(t.childWidgets.splice(0,0,n),this.owner.editorModule.updateNextBlocksIndex(n,!0),0!==r&&e[r-1]instanceof fa||this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)):t instanceof ga&&"RemoveRowTrack"!==this.action?this.owner.editorModule.insertBlockTable(this.owner.selection,n,t):n instanceof ca&&!n.isInsideTable&&"RemoveRowTrack"===this.action?this.owner.editorModule.insertNewParagraphWidget(n,!1):n instanceof ga&&"RemoveRowTrack"===this.action?(this.owner.editorModule.insertTableInternal(n,n,!1,!0),!sf.base.isNullOrUndefined(e[r-1])&&!sf.base.isNullOrUndefined(n.nextRenderedWidget)&&n.nextRenderedWidget instanceof ca&&(this.owner.selection.start.setPositionParagraph(n.nextRenderedWidget.firstChild,0),this.owner.selection.end.setPositionParagraph(n.nextRenderedWidget.firstChild,0))):this.owner.editorModule.insertBlock(n);else if(n instanceof T){var o=this.selectionStart,s=this.owner.editorModule.getBlock({index:o}).node;s instanceof ca&&(n.removedIds.length>0?(s.characterFormat.removedIds=n.removedIds.slice(),this.owner.editor.constructRevisionFromID(s.characterFormat,!0)):s.characterFormat.revisions.length>0&&(s.characterFormat=n.cloneFormat()))}else if(n instanceof aa)sf.base.isNullOrUndefined(n.removedHeaderFooters)||0===n.removedHeaderFooters.length||(this.owner.documentHelper.headersFooters.splice(n.sectionIndex,0,n.removedHeaderFooters[0]),n.removedHeaderFooters=void 0),i=!0,this.owner.editorModule.insertSection(this.owner.selection,!1,!0,void 0,void 0,n.sectionFormat);else if("string"==typeof n&&"AcceptTOC"===this.action){o=this.selectionStart;var a=this.owner.editorModule.getBlock({index:o}).node,l=this.owner.editorModule.getBlock({index:this.selectionEnd}).node,d=this.owner.documentHelper.revisionsInternal.get(n);if(this.editorHistory.isUndoing){for(;a instanceof ca&&a!==l;)this.owner.editor.insertRevisionForBlock(a,d.revisionType,!0,d),a=this.documentHelper.selection.getNextParagraphBlock(a.getSplitWidgets().pop());this.owner.editor.insertRevisionForBlock(l,d.revisionType,!0,d)}else for(;d.range.length>0;){var h=d.range[0],c=h.revisions.indexOf(d);if(c>=0){h.revisions.splice(c,1);var p=d.range.indexOf(h);d.range.splice(p,1),this.owner.trackChangesPane.updateCurrentTrackChanges(d)}0===d.range.length&&this.owner.revisions.remove(d)}this.owner.editor.addRemovedNodes(d.revisionID)}}i&&this.owner.editorModule.layoutWholeDocument(!0),e=[]},e.prototype.undoRevisionForElements=function(e,t,i){var r=e.paragraph,n=t.paragraph,o=this.documentHelper.revisionsInternal.get(i),s=this.owner.selection.getParagraphInfo(e).offset,a=this.owner.selection.getParagraphInfo(t).offset,l=e.paragraph===t.paragraph,d=!1;if(this.editorHistory.isUndoing){for(;r!==n;)d=!1,this.owner.editor.applyRevisionForCurrentPara(r,s,r.getLength(),i,!0),r=this.documentHelper.selection.getNextParagraphBlock(r),!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.previousRenderedWidget)&&r.previousRenderedWidget instanceof ca&&r.previousRenderedWidget.nextSplitWidget&&r===n&&(d=!0),r!==n&&(s=0);r===n&&(l||(s=0),d&&(s=r.previousRenderedWidget.getLength()),this.owner.editor.applyRevisionForCurrentPara(r,s,a,i,!1))}else for(;o.range.length>0;){var h=o.range[0],c=h.revisions.indexOf(o);if(c>=0){h.revisions.splice(c,1);var p=o.range.indexOf(h);o.range.splice(p,1),this.owner.trackChangesPane.updateCurrentTrackChanges(o)}if(0===o.range.length&&this.owner.revisions.remove(o),r.characterFormat.revisions.length>0&&this.editorHistory.isRedoing)for(var g=0;g<r.characterFormat.revisions.length;g++){0===r.characterFormat.revisions[g].range.length&&(r.characterFormat.revisions.splice(g,1),g--)}}this.removedNodes.push(i)},e.prototype.revertResizing=function(){if(this.editorHistory.currentBaseHistoryInfo=this,"RowResizing"===this.action){if(this.modifiedProperties[0]instanceof Ql){var e=this.modifiedProperties[0].tableHierarchicalIndex;(t=this.owner.editorModule.getBlock({index:e}).node)instanceof ga&&this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing,this.owner,t)}}else if(this.modifiedProperties[0]instanceof $l){0===this.owner.selection.selectedWidgets.length&&this.owner.selection.highlightSelection(!0);var t,i=this.modifiedProperties[0];e=i.tableHierarchicalIndex;if((t=this.owner.editorModule.getBlock({index:e}).node)instanceof ga){var r=this.owner.editorModule.tableResize;if(this.owner.editor.setOffsetValue(this.owner.selection),t=t.combineWidget(this.owner.viewer),r.currentResizingTable=t,this.modifiedProperties.splice(0,1),this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=new $l(t,this.owner);this.modifiedProperties.splice(0,0,n),this.owner.isLayoutEnabled=!1,r.applyProperties(r.currentResizingTable,i),r.currentResizingTable.isGridUpdated=!0,this.owner.isLayoutEnabled=!0,r.updateGridValue(r.currentResizingTable,!1),i.destroy(),i=void 0}}}},e.prototype.revertTableDialogProperties=function(e){if(this.owner.isShiftingEnabled=!1,this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0,"CellOptions"===e){var t=this.owner.selection,i=this.modifiedProperties[0];this.owner.editorModule.updateCellMargins(t,i)}this.currentPropertyIndex=0,this.owner.isShiftingEnabled=!0},e.prototype.addModifiedPropertiesForSection=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.modifiedProperties,n=this.currentPropertyIndex<r.length?r[this.currentPropertyIndex]:r[r.length-1];sf.base.isNullOrUndefined(t)?(i=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()):(i=n.getPropertyValue(t),n.copyFormat(e)),this.currentPropertyIndex++}else if(sf.base.isNullOrUndefined(t))this.modifiedProperties.push(e.cloneFormat());else{var o=new h;o.copyFormat(e),this.modifiedProperties.push(o)}return i},e.prototype.addModifiedProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],n=!1;if(e.ownerBase instanceof ya){var o=this.modifiedNodeLength[this.currentPropertyIndex];if(e.ownerBase.length<o){n=!0,this.modifiedNodeLength[this.currentPropertyIndex]=e.ownerBase.length,this.modifiedNodeLength.splice(this.currentPropertyIndex+1,0,o-e.ownerBase.length);var s=new T(void 0);s.copyFormat(r),this.modifiedProperties.splice(this.currentPropertyIndex+1,0,s)}}"ClearCharacterFormat"===this.action?this.editorHistory.isUndoing?(i=r,n||(this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--)):this.modifiedProperties.push(e.cloneFormat()):(i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()),this.currentPropertyIndex++}else{if(sf.base.isNullOrUndefined(t))this.modifiedProperties.push(e.cloneFormat());else{var a=new T(void 0);a.copyFormat(e),this.modifiedProperties.push(a)}e.ownerBase instanceof ya?this.modifiedNodeLength.push(e.ownerBase.length):this.modifiedNodeLength.push(0)}return i},e.prototype.addModifiedPropertiesForParagraphFormat=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if("ClearParagraphFormat"===this.action)return this.editorHistory.isUndoing?(i=r,this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--):this.modifiedProperties.push(e.cloneFormat()),this.currentPropertyIndex++,i;if(sf.base.isNullOrUndefined(t))return i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;if("listFormat"===t)return(i=new ul(void 0)).copyFormat(r),r.listFormat=new m(r),r.listFormat.copyFormat(e.listFormat),this.currentPropertyIndex++,i;if("tabStop"===t){i=[];for(var n=0;n<r.tabs.length;n++)i.push(r.tabs[n]);return(o=new ul(void 0)).copyFormat(e),this.modifiedProperties[this.currentPropertyIndex]=o,this.currentPropertyIndex++,i}if("styleName"===t)return sf.base.isNullOrUndefined(r.baseStyle)?void(sf.base.isNullOrUndefined(e.baseStyle)||(r.baseStyle=new vl,r.baseStyle.copyStyle(e.baseStyle))):((i=new vl).copyStyle(r.baseStyle),this.currentPropertyIndex++,sf.base.isNullOrUndefined(e.baseStyle)||(r.baseStyle=new vl,r.baseStyle.copyStyle(e.baseStyle)),i);i="borders"===t?r.borders.cloneFormat():this.action.indexOf("Border")>=0?r.borders.getBorder(t.replace("Border","")):r.getPropertyValue(t),r.copyFormat(e),this.currentPropertyIndex++}else{var o;if(sf.base.isNullOrUndefined(t))this.modifiedProperties.push(e.cloneFormat());else(o=new ul(void 0)).copyFormat(e),this.modifiedProperties.push(o)}return i},e.prototype.addModifiedPropertiesForContinueNumbering=function(e,t){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)return t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,t;var i=new ul;return i.copyFormat(e),this.modifiedProperties.push(i),t},e.prototype.addModifiedPropertiesForRestartNumbering=function(e,t){return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.listId:this.modifiedProperties[this.modifiedProperties.length-1]=e.listId,this.currentPropertyIndex++,t):(this.modifiedProperties.push(e.listId),t)},e.prototype.addModifiedPropertiesForList=function(e){var t;if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var i=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];t=i,i=new Yl(e,this.owner.editorModule.cloneListLevel(e)),this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=i:this.modifiedProperties[this.modifiedProperties.length-1]=i,this.currentPropertyIndex++}else this.modifiedProperties.push(new Yl(e,this.owner.editorModule.cloneListLevel(e))),t=e;return t},e.prototype.revertProperties=function(){this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0;var e=this.getProperty();if(this.viewer.owner.editorModule.setOffsetValue(this.documentHelper.selection),"ClearCharacterFormat"===this.action||this.modifiedProperties[0]instanceof T){if("ListCharacterFormat"===this.action)return void this.owner.editorModule.updateListCharacterFormat(this.documentHelper.selection,e,void 0);this.owner.editorModule.updateSelectionCharacterFormatting(e,void 0,!1)}else if("ClearParagraphFormat"===this.action||this.modifiedProperties[0]instanceof ul){if("ContinueNumbering"===this.action)return void this.owner.editorModule.revertContinueNumbering(this.owner.selection,this.modifiedProperties[0]);if("StyleName"===this.action&&this.modifiedProperties[0]instanceof ul)return void this.owner.editorModule.updateSelectionParagraphFormatting(e,this.modifiedProperties[0].baseStyle,!1);this.owner.editor.setPreviousBlockToLayout(),this.owner.editorModule.updateSelectionParagraphFormatting(e,void 0,!1)}else if("LinkToPrevious"===this.action&&this.modifiedProperties[0]instanceof h){var t=parseInt(this.selectionStart.split(";")[0]);this.owner.editorModule.updateHeaderFooters(e,void 0,t,this.modifiedProperties[0].removedHeaderFooters[0])}else if(this.modifiedProperties[0]instanceof h)this.owner.editorModule.updateSectionFormat(e,void 0);else{if("RestartNumbering"===this.action)return void this.owner.editorModule.restartListAtInternal(this.owner.selection,this.modifiedProperties[0]);if(this.modifiedProperties[0]instanceof Dl)this.owner.selection.updateImageSize(this.modifiedProperties[0]);else if(this.modifiedProperties[0]instanceof Yl){for(var i=new a,r=0;r<this.modifiedProperties.length;r++){var n=this.modifiedProperties[r];i.add(r,n)}this.editorHistory.updateListChanges(i),i.destroy(),i=void 0}else this.modifiedProperties[0]instanceof Fl?this.owner.editorModule.updateTableFormat(this.owner.selection,e,void 0):this.modifiedProperties[0]instanceof Cl?(this.owner.isShiftingEnabled=!0,this.owner.editorModule.updateCellFormat(this.owner.selection,e,void 0)):this.modifiedProperties[0]instanceof k&&this.owner.editorModule.updateRowFormat(this.owner.selection,e,void 0)}this.currentPropertyIndex=0,"ClearCharacterFormat"!==this.action&&"ClearParagraphFormat"!==this.action||this.owner.editorModule.getOffsetValue(this.documentHelper.selection)},e.prototype.addModifiedCellOptions=function(e,t,i){var r;return r=sf.base.isNullOrUndefined(e.bottomMargin)&&sf.base.isNullOrUndefined(e.topMargin)&&sf.base.isNullOrUndefined(e.rightMargin)&&sf.base.isNullOrUndefined(e.leftMargin)?this.copyCellOptions(i.tableFormat):this.copyCellOptions(e),this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=this.copyCellOptions(e):this.modifiedProperties[this.modifiedProperties.length-1]=this.copyCellOptions(e),this.currentPropertyIndex++,t):(this.modifiedProperties.push(r),t)},e.prototype.copyCellOptions=function(e){var t=new Cl;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t},e.prototype.addModifiedTableOptions=function(e){var t=this.copyTableOptions(e);if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties.splice(this.currentPropertyIndex,1,t):this.modifiedProperties.splice(this.modifiedProperties.length-1,1,t),this.currentPropertyIndex++}else this.modifiedProperties.push(t)},e.prototype.copyTableOptions=function(e){var t=new Fl;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.cellSpacing=e.cellSpacing,t},e.prototype.getProperty=function(){switch(this.action){case"Bold":return"bold";case"Italic":return"italic";case"FontColor":return"fontColor";case"FontFamily":return"fontFamily";case"FontSize":return"fontSize";case"HighlightColor":return"highlightColor";case"BaselineAlignment":return"baselineAlignment";case"Strikethrough":return"strikethrough";case"Underline":return"underline";case"AfterSpacing":return"afterSpacing";case"BeforeSpacing":return"beforeSpacing";case"LeftIndent":return"leftIndent";case"RightIndent":return"rightIndent";case"FirstLineIndent":return"firstLineIndent";case"LineSpacingType":return"lineSpacingType";case"LineSpacing":return"lineSpacing";case"TextAlignment":return"textAlignment";case"ListFormat":return"listFormat";case"PageHeight":return"pageHeight";case"PageWidth":return"pageWidth";case"DifferentOddAndEvenPages":return"differentOddAndEvenPages";case"TableAlignment":return"tableAlignment";case"TableLeftIndent":return"leftIndent";case"DefaultCellSpacing":return"cellSpacing";case"LeftMargin":case"CellLeftMargin":case"DefaultCellLeftMargin":return"leftMargin";case"RightMargin":case"CellRightMargin":case"DefaultCellRightMargin":return"rightMargin";case"TopMargin":case"CellTopMargin":case"DefaultCellTopMargin":return"topMargin";case"BottomMargin":case"CellBottomMargin":case"DefaultCellBottomMargin":return"bottomMargin";case"CellContentVerticalAlignment":return"verticalAlignment";case"RowHeight":return"height";case"RowHeightType":return"heightType";case"RowHeader":return"isHeader";case"AllowBreakAcrossPages":return"allowBreakAcrossPages";case"TablePreferredWidth":case"CellPreferredWidth":return"preferredWidth";case"TablePreferredWidthType":case"CellPreferredWidthType":return"preferredWidthType";case"Shading":return"shading";case"StyleName":return"styleName";case"ParagraphBidi":case"TableBidi":return"bidi";case"ContextualSpacing":return"contextualSpacing";case"LinkToPrevious":return"linkToPrevious";case"LeftBorder":case"TopBorder":case"RightBorder":case"BottomBorder":case"HorizontalBorder":case"VerticalBorder":case"Borders":return this.action[0].toLowerCase()+this.action.slice(1)}},e.prototype.getCharacterPropertyValue=function(e,t){var i;return"bold"===e?i=t.bold:"italic"===e?i=t.italic:"fontColor"===e?i=t.fontColor:"fontFamily"===e?i=t.fontFamily:"fontSize"===e?i=t.fontSize:"highlightColor"===e?i=t.highlightColor:"baselineAlignment"===e?i=t.baselineAlignment:"strikethrough"===e?i=t.strikethrough:"underline"===e&&(i=t.underline),i},e.prototype.addModifiedTableProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(sf.base.isNullOrUndefined(t))return i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i="shading"===t?r.shading:r.getPropertyValue(t),r.copyFormat(e),this.currentPropertyIndex++}else{var n=new Fl;n.copyFormat(e),this.modifiedProperties.push(n)}return i},e.prototype.addModifiedRowProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(sf.base.isNullOrUndefined(t))return i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i=r.getPropertyValue(t),r.copyFormat(e),this.currentPropertyIndex++}else{var n=new k;n.copyFormat(e),this.modifiedProperties.push(n)}return i},e.prototype.addModifiedCellProperties=function(e,t,i){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var r=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(sf.base.isNullOrUndefined(t))return i=r,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,i;i="shading"===t?r.shading:r.getPropertyValue(t),r.copyFormat(e),this.currentPropertyIndex++}else{var n=new Cl;n.copyFormat(e),this.modifiedProperties.push(n)}return i},e.prototype.destroy=function(){if(this.selectionStart=void 0,this.selectionEnd=void 0,this.insertPosition=void 0,this.endPosition=void 0,sf.base.isNullOrUndefined(this.modifiedNodeLength)||(this.modifiedNodeLength=[],this.modifiedNodeLength=void 0),!sf.base.isNullOrUndefined(this.modifiedProperties)){for(var e=0;e<this.modifiedProperties.length;e++){var t=this.modifiedProperties[e];(t instanceof T||t instanceof ul||t instanceof h||t instanceof Yl)&&t.destroy(),this.modifiedProperties.splice(this.modifiedProperties.indexOf(t),1),e--}this.modifiedPropertiesIn=void 0}if(!sf.base.isNullOrUndefined(this.removedNodes)){for(e=0;e<this.removedNodes.length;e++){var i=this.removedNodes[e];i instanceof ca?i.destroyInternal(this.viewer):i instanceof ya&&!(i instanceof al)&&i.destroy(),this.removedNodes.splice(this.removedNodes.indexOf(i),1),e--}this.removedNodesIn=void 0}this.ownerIn=void 0},e}(),nd=(b=function(e,t){return(b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),od=function(e){function t(t,i){var r=e.call(this,t)||this;return r.isChildHistoryInfo=!1,r.editRangeStart=void 0,r.documentHelper=t.documentHelper,r.isChildHistoryInfo=i,r}return nd(t,e),Object.defineProperty(t.prototype,"hasAction",{get:function(){return!sf.base.isNullOrUndefined(this.modifiedActions)},enumerable:!0,configurable:!0}),t.prototype.addModifiedAction=function(e){this.editorHistory.isUndoing||this.editorHistory.isRedoing||(sf.base.isNullOrUndefined(this.modifiedActions)&&(this.modifiedActions=[]),this.modifiedActions.push(e))},t.prototype.revert=function(){if(this.editorHistory.currentHistoryInfo=this,"BordersAndShading"===this.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),!sf.base.isNullOrUndefined(this.modifiedActions))if(this.editorHistory.isUndoing)for(var e=this.modifiedActions.length;e>0;){this.modifiedActions[e-1].revert(),e-=1}else for(e=0;e<this.modifiedActions.length;){this.modifiedActions[parseInt(e.toString(),10)].revert(),e+=1}if("RestrictEditing"===this.action){var t=""!==this.editRangeStart.user?this.editRangeStart.user:this.editRangeStart.group;if(this.editorHistory.isUndoing){var i=this.owner.documentHelper.editRanges.get(t).indexOf(this.editRangeStart);-1!==i&&this.owner.documentHelper.editRanges.get(t).splice(i,1)}else this.owner.editor.updateRangeCollection(this.editRangeStart,t);this.owner.selection.updateEditRangeCollection()}this.isChildHistoryInfo?this.editorHistory.updateComplexHistoryInternal():this.editorHistory.updateComplexHistory()},t.prototype.destroy=function(){if(!sf.base.isNullOrUndefined(this.modifiedActions)){for(;this.modifiedActions.length>0;){var t=this.modifiedActions[this.modifiedActions.length-1];t.destroy(),this.modifiedActions.splice(this.modifiedActions.indexOf(t),1)}this.modifiedActions=void 0}e.prototype.destroy.call(this)},t}(rd),sd=function(){function e(e){this.undoStackIn=[],this.redoStackIn=[],this.historyInfoStack=[],this.isUndoGroupingEnded=!0,this.isUndoing=!1,this.isRedoing=!1,this.owner=e,this.documentHelper=e.documentHelper,this.modifiedParaFormats=new a,this.undoLimitIn=500,this.redoLimitIn=500}return Object.defineProperty(e.prototype,"currentHistoryInfo",{get:function(){return this.historyInfoStack&&this.historyInfoStack.length>0?this.historyInfoStack[this.historyInfoStack.length-1]:void 0},set:function(e){e instanceof od?this.historyInfoStack.push(e):this.historyInfoStack.pop()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"undoStack",{get:function(){return this.undoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redoStack",{get:function(){return this.redoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"undoLimit",{get:function(){return sf.base.isNullOrUndefined(this.undoLimitIn)?0:this.undoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.undoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redoLimit",{get:function(){return sf.base.isNullOrUndefined(this.redoLimitIn)?0:this.redoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.redoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"EditorHistory"},e.prototype.canUndo=function(){return!sf.base.isNullOrUndefined(this.undoStack)&&this.undoStack.length>0},e.prototype.canRedo=function(){return!sf.base.isNullOrUndefined(this.redoStack)&&this.redoStack.length>0},e.prototype.initializeHistory=function(e){sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)||this.currentBaseHistoryInfo.destroy(),this.currentBaseHistoryInfo=new rd(this.owner),this.currentBaseHistoryInfo.action=e,this.currentBaseHistoryInfo.updateSelection()},e.prototype.initComplexHistory=function(e,t){this.currentHistoryInfo=new od(e.owner,!sf.base.isNullOrUndefined(this.currentHistoryInfo)),this.currentHistoryInfo.action=t,this.currentHistoryInfo.updateSelection()},e.prototype.initResizingHistory=function(e,t){if(1===t.resizeNode)this.initializeHistory("RowResizing"),sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)||(t.currentResizingTable=t.currentResizingTable.combineWidget(this.viewer),this.currentBaseHistoryInfo.modifiedProperties.push(new Ql(t.currentResizingTable,e,t.currentResizingTable.childWidgets[t.resizerPosition].rowFormat,this.owner)),this.documentHelper.layout.reLayoutTable(t.currentResizingTable));else if(this.initializeHistory("CellResizing"),this.currentBaseHistoryInfo){t.currentResizingTable=t.currentResizingTable.combineWidget(this.viewer);var i=new $l(t.currentResizingTable,this.owner);i.startingPoint=e,this.currentBaseHistoryInfo.modifiedProperties.push(i),this.documentHelper.layout.reLayoutTable(t.currentResizingTable)}},e.prototype.beginUndoAction=function(){this.isUndoGroupingEnded&&(this.owner.editorModule.initComplexHistory("Grouping"),this.isUndoGroupingEnded=!1,this.clearRedoStack())},e.prototype.endUndoAction=function(){this.isUndoGroupingEnded||(this.updateComplexHistory(),this.isUndoGroupingEnded=!0)},e.prototype.updateResizingHistory=function(e,t){if(1===t.resizeNode){if(!sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)){var i=this.currentBaseHistoryInfo.modifiedProperties[0];i.startingPoint.y===e.y?this.currentBaseHistoryInfo.modifiedProperties.length=0:(i.displacement=x.convertPixelToPoint(e.y-i.startingPoint.y),this.recordChanges(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)}}else if(!sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)){var r=this.currentBaseHistoryInfo.modifiedProperties[0];r.startingPoint.x===e.x?this.currentBaseHistoryInfo.modifiedProperties.length=0:(r.displacement=x.convertPixelToPoint(e.x-r.startingPoint.x),r.endIndex=t.getCellReSizerPosition(e),this.owner.editorHistory.recordChanges(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)}},e.prototype.recordChanges=function(e){if(this.owner.enableHistoryMode)if(this.isUndoing){if(sf.base.isNullOrUndefined(this.redoStack)&&(this.redoStackIn=[]),this.redoStack.length===this.redoLimit&&this.redoLimit>0){var t=this.undoLimit>20?10:1;this.redoStackIn.splice(0,t)}this.redoStack.length<this.redoLimit&&this.redoStack.push(e)}else{if(this.isRedoing||this.clearRedoStack(),sf.base.isNullOrUndefined(this.undoStack)&&(this.undoStackIn=[]),this.undoStack.length===this.undoLimit&&this.undoLimit>0){t=this.undoLimit>20?10:1;this.undoStackIn.splice(0,t)}this.undoStack.length<this.undoLimit&&this.undoStackIn.push(e)}},e.prototype.updateHistory=function(){this.documentHelper.owner.enableHistoryMode&&!sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)&&(!sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)&&sf.base.isNullOrUndefined(this.currentBaseHistoryInfo.endPosition)&&(this.currentBaseHistoryInfo.endPosition=this.currentBaseHistoryInfo.insertPosition),sf.base.isNullOrUndefined(this.currentHistoryInfo)?this.recordChanges(this.currentBaseHistoryInfo):this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)},e.prototype.isHandledComplexHistory=function(){var e=!1;return this.isUndoing||this.isRedoing||(this.owner.editorModule.removedBookmarkElements.length>0&&this.owner.editorModule.insertRemoveBookMarkElements(e)&&(e=!0),this.owner.editorModule.removedEditRangeEndElements.length>0&&this.owner.editorModule.insertRemovedEditRangeEndElements(e)&&(e=!0),this.owner.editorModule.removedEditRangeStartElements.length>0&&this.owner.editorModule.insertRemovedEditRangeStartElements(e)&&(e=!0)),this.documentHelper.owner.enableHistoryMode&&!sf.base.isNullOrUndefined(this.currentHistoryInfo)?"Grouping"!=this.currentHistoryInfo.action&&(this.updateHistory(),e=!0):this.owner.editorModule.isHandledComplex&&(e=!0),e},e.prototype.updateComplexHistory=function(){var e=this.documentHelper.selection;if(!sf.base.isNullOrUndefined(this.currentHistoryInfo)&&this.currentHistoryInfo.hasAction){if("AutoFormatHyperlink"===this.currentHistoryInfo.action||"SkipCommentInline"===this.currentHistoryInfo.action){var t=new Al(e.owner);this.owner.editorModule.setPositionForCurrentIndex(t,this.currentHistoryInfo.insertPosition),e.owner.editorHistory.isUndoing?(this.owner.editorModule.setPositionForCurrentIndex(e.start,this.currentHistoryInfo.selectionStart),this.owner.editorModule.setPositionForCurrentIndex(e.end,this.currentHistoryInfo.selectionEnd)):(this.owner.editorModule.setPositionForCurrentIndex(e.start,this.currentHistoryInfo.endPosition),this.owner.editorModule.setPositionForCurrentIndex(e.end,this.currentHistoryInfo.endPosition))}if("InsertHyperlink"===this.currentHistoryInfo.action){t=new Al(e.owner);this.owner.editorModule.setPositionForCurrentIndex(t,this.currentHistoryInfo.insertPosition);var i=new Al(e.owner);this.owner.editorModule.setPositionForCurrentIndex(i,this.currentHistoryInfo.endPosition),this.documentHelper.layout.reLayoutParagraph(t.paragraph,0,0),i.paragraph!==t.paragraph&&this.documentHelper.layout.reLayoutParagraph(i.paragraph,0,0)}"ReplaceAll"===this.currentHistoryInfo.action?(this.documentHelper.contentControlCollection=[],this.owner.editorModule.layoutWholeDocument()):e.owner.isShiftingEnabled&&(this.documentHelper.layout.shiftLayoutedItems(!1),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget(),this.documentHelper.removeEmptyPages())}this.owner.showRevisions&&this.owner.trackChangesPane.updateTrackChanges(),e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0,sf.base.isNullOrUndefined(this.currentHistoryInfo)||"ApplyStyle"!==this.currentHistoryInfo.action?(e.start.updatePhysicalPosition(!0),e.isEmpty?e.end.setPositionInternal(e.start):e.end.updatePhysicalPosition(!0)):this.owner.editor.getOffsetValue(e),e.upDownSelectionLength=e.end.location.x,this.documentHelper.isScrollHandler=!0,this.viewer.updateScrollBars(),e.fireSelectionChanged(!0),this.documentHelper.isScrollHandler=!1,this.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.updateComplexHistoryInternal(),this.owner.editorModule.fireContentChange()},e.prototype.updateComplexHistoryInternal=function(){if(!sf.base.isNullOrUndefined(this.currentHistoryInfo)){if(sf.base.isNullOrUndefined(this.currentHistoryInfo.endPosition)&&(this.currentHistoryInfo.endPosition=this.currentHistoryInfo.insertPosition),this.historyInfoStack.length>1)this.historyInfoStack[this.historyInfoStack.length-2].addModifiedAction(this.currentHistoryInfo);else this.recordChanges(this.currentHistoryInfo);this.currentHistoryInfo=void 0}},e.prototype.updateListChangesInHistory=function(e,t){this.currentBaseHistoryInfo=new rd(this.documentHelper.owner),this.currentBaseHistoryInfo.action="List",this.currentBaseHistoryInfo.updateSelection();for(var i=new a,r=0;r<e.levels.length;r++){var n=this.documentHelper.getAbstractListById(t.abstractListId).levels[parseInt(r.toString(),10)];this.currentBaseHistoryInfo.addModifiedPropertiesForList(n);var o=new Yl(n,e.levels[parseInt(r.toString(),10)]);sf.base.isNullOrUndefined(n)||this.documentHelper.owner.editorModule.copyListLevel(n,e.levels[parseInt(r.toString(),10)]),i.add(r,o)}return i},e.prototype.applyListChanges=function(e,t){sf.base.isNullOrUndefined(this.modifiedParaFormats)&&(this.modifiedParaFormats=new a);for(var i=[],r=0;r<this.documentHelper.listParagraphs.length;r++){var n=this.documentHelper.listParagraphs[parseInt(r.toString(),10)].paragraphFormat,o=this.documentHelper.getListById(n.listFormat.listId),s=this.documentHelper.layout.getListLevel(o,n.listFormat.listLevelNumber);if(t.containsKey(n.listFormat.listLevelNumber)&&t.get(n.listFormat.listLevelNumber).ownerListLevel===s){var l=new ul(null);l.leftIndent=n.leftIndent,l.firstLineIndent=n.firstLineIndent;var d=new Zl(n,l);i.push(d),this.owner.editorModule.copyFromListLevelParagraphFormat(n,s.paragraphFormat)}}this.modifiedParaFormats.add(this.currentBaseHistoryInfo,i)},e.prototype.updateListChanges=function(e){this.documentHelper.owner.isLayoutEnabled=!1,this.owner.editorModule.updateListParagraphs();for(var t=0;t<e.keys.length;t++){var i=e.keys[parseInt(t.toString(),10)],r=e.get(i);sf.base.isNullOrUndefined(this.currentBaseHistoryInfo)||(r=this.currentBaseHistoryInfo.addModifiedPropertiesForList(r.ownerListLevel)),this.owner.editorModule.copyListLevel(r.ownerListLevel,r.modifiedListLevel)}this.documentHelper.owner.isLayoutEnabled=!0,this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.owner.editorModule.layoutWholeDocument();var n=this.documentHelper.selection;n.start.updatePhysicalPosition(!0),n.isEmpty?n.end.setPositionInternal(n.start):n.end.updatePhysicalPosition(!0),n.upDownSelectionLength=n.end.location.x,n.fireSelectionChanged(!1),this.updateHistory()},e.prototype.undo=function(){if((!this.owner.isReadOnlyMode||this.owner.documentHelper.isCommentOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canUndo()&&this.owner.enableHistoryMode){var e=this.undoStack.pop();this.isUndoing=!0,e.revert(),this.isUndoing=!1,this.owner.selection.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1}},e.prototype.redo=function(){if((!this.owner.isReadOnlyMode||this.owner.documentHelper.isCommentOnlyMode||"FormFieldsOnly"===this.owner.documentHelper.protectionType)&&this.canRedo()&&this.owner.enableHistoryMode){var e=this.redoStack.pop();"BordersAndShading"===e.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),this.isRedoing=!0,e.revert(),this.isRedoing=!1,this.owner.selection.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1}},e.prototype.destroy=function(){this.clearHistory(),this.undoStackIn=void 0,this.redoStackIn=void 0},e.prototype.clearHistory=function(){this.clearUndoStack(),this.clearRedoStack()},e.prototype.clearUndoStack=function(){if(this.canUndo())for(;this.undoStack.length>0;){var e=this.undoStack.pop();e.destroy(),e=void 0}},e.prototype.clearRedoStack=function(){if(this.canRedo())for(;this.redoStack.length>0;){var e=this.redoStack.pop();e.destroy(),e=void 0}},e}(),ad=function(){function e(e){this.resizeNode=0,this.resizerPosition=-1,this.currentResizingTable=void 0,this.owner=e,this.documentHelper=this.owner.documentHelper,this.startingPoint=new I(0,0)}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TableResizer"},e.prototype.updateResizingHistory=function(e){this.owner.editorHistory&&this.owner.editorHistory.updateResizingHistory(e,this),this.documentHelper.isRowOrCellResizing=!1,this.resizerPosition=-1},e.prototype.handleResize=function(e){this.owner.documentHelper.isRowOrCellResizing=!0,this.startingPoint.x=e.x,this.startingPoint.y=e.y,this.owner.editorHistory.initResizingHistory(e,this)},e.prototype.isInRowResizerArea=function(e){var t=this.getRowReSizerPosition(void 0,e);return-1!==t&&(this.resizeNode=1,this.resizerPosition=t,!0)},e.prototype.isInCellResizerArea=function(e){var t=this.getCellReSizerPosition(e);return-1!==t&&(this.resizeNode=0,this.resizerPosition=t,!0)},e.prototype.getCellReSizerPosition=function(e){var t=-1,i=this.getTableWidget(e),r=this.getTableCellWidget(e),n=sf.base.isNullOrUndefined(i)?0:i.tableFormat.cellSpacing;if(i&&n>0){if(this.currentResizingTable=i,this.documentHelper.isInsideRect(i.x-x.convertPointToPixel(i.leftBorderWidth)-.25,i.y,x.convertPointToPixel(i.leftBorderWidth)+.5,i.height,e))return 0;for(var o=i.x,s=0;s<i.tableHolder.columns.length;s++){var a=x.convertPointToPixel(i.tableHolder.columns[parseInt(s.toString(),10)].preferredWidth);if(this.documentHelper.isInsideRect(o-1,i.y,i.leftBorderWidth+2,i.height,e))return s>0?s:0;if(s>0&&this.documentHelper.isInsideRect(o+a-1,i.y,2,i.height,e))return s+1;o+=a}}else if(!sf.base.isNullOrUndefined(r)){if(this.currentResizingTable=r.ownerTable,this.documentHelper.isInsideRect(r.x-r.margin.left-1,r.y-r.margin.top,2,r.height+r.margin.top+r.margin.bottom,e))return r.columnIndex;if(sf.base.isNullOrUndefined(r.nextRenderedWidget)&&this.documentHelper.isInsideRect(r.x+r.margin.right+r.width-1,r.y-r.margin.top,2,r.height+r.margin.top+r.margin.bottom,e))return r.columnIndex+r.cellFormat.columnSpan;if(r.childWidgets.length>0)return this.getCellReSizerPositionInternal(r,e)}return t},e.prototype.getCellReSizerPositionInternal=function(e,t){var i=-1,r=this.getTableWidgetFromWidget(t,e),n=void 0;if(!sf.base.isNullOrUndefined(r)&&r.tableFormat.cellSpacing>0){if(this.currentResizingTable=r,this.documentHelper.isInsideRect(r.x-r.leftBorderWidth-.25,r.y,r.leftBorderWidth+.5,r.height,t))return 0;for(var o=r.x,s=0;s<r.tableHolder.columns.length;s++){var a=x.convertPointToPixel(r.tableHolder.columns[parseInt(s.toString(),10)].preferredWidth);if(this.documentHelper.isInsideRect(o-1,r.y,r.leftBorderWidth+2,r.height,t))return s>0?s:0;if(s>0&&this.documentHelper.isInsideRect(o+a-1,r.y,2,r.height,t))return s+1;o+=a}}else if(sf.base.isNullOrUndefined(r)||(n=r.getTableCellWidget(t)),!sf.base.isNullOrUndefined(n)){if(this.currentResizingTable=n.ownerTable,this.documentHelper.isInsideRect(n.x-n.margin.left-1,n.y-n.margin.top,2,n.height,t))return n.columnIndex;if(sf.base.isNullOrUndefined(n.nextRenderedWidget)&&this.documentHelper.isInsideRect(n.x+n.margin.right+n.width-1,n.y-n.margin.top,2,n.height,t))return n.columnIndex+n.cellFormat.columnSpan;if(n.childWidgets.length>0)return this.getCellReSizerPositionInternal(n,t)}return i},e.prototype.getRowReSizerPosition=function(e,t){var i=void 0,r=void 0;sf.base.isNullOrUndefined(e)?(i=this.getTableWidget(t),r=this.getTableCellWidget(t)):i=this.getTableWidgetFromWidget(t,e);var n=sf.base.isNullOrUndefined(i)?0:i.tableFormat.cellSpacing;if(i&&n>0){if(this.currentResizingTable=i,this.owner.documentHelper.isInsideRect(i.x,i.y+i.height-n,this.getActualWidth(i.lastChild),sf.base.isNullOrUndefined(i.nextSplitWidget)?i.bottomBorderWidth+n:0,t))return i.lastChild.rowIndex;for(var o=0;o<i.childWidgets.length;o++){var s=i.childWidgets[parseInt(o.toString(),10)];if(i.childWidgets.indexOf(s)>-1&&this.owner.documentHelper.isInsideRect(s.x,s.y+s.height+n/2,this.getActualWidth(s),n/2,t))return s.rowIndex}}else if(i&&r&&(r=this.getTableCellWidget(t)),r){var a=0;if(a=(s=r.containerWidget).rowIndex===s.ownerTable.childWidgets.length-1?s.bottomBorderWidth+2:s.nextRenderedWidget.topBorderWidth+2,this.owner.documentHelper.isInsideRect(s.x,s.y+s.height-a,s.width,2*a,t))return this.currentResizingTable=s.ownerTable,s.rowIndex;if(r.childWidgets.length>0)return this.getRowReSizerPosition(r,t)}return-1},e.prototype.handleResizing=function(e,t,i){this.owner.isShiftingEnabled=!0,t?0===this.resizeNode&&this.resizeTableCellColumn(i):0===this.resizeNode?(i=e.x-this.startingPoint.x,this.resizeTableCellColumn(i)):(i=e.y-this.startingPoint.y,this.resizeTableRow(i))},e.prototype.resizeTableRow=function(e){var t=this.currentResizingTable;if(!sf.base.isNullOrUndefined(t)&&0!==e&&-1!==this.resizerPosition){var i=this.owner.selection;t.isInsideTable&&(this.owner.isLayoutEnabled=!1);var r=void 0;if(this.resizerPosition>-1&&((r=t.childWidgets[this.resizerPosition])&&this.updateRowHeight(r,e),i.selectPosition(i.start,i.end)),t.isInsideTable){var n=this.owner.documentHelper.layout.getParentTable(t);this.owner.isLayoutEnabled=!0,t=n}this.startingPoint.y+=x.convertPointToPixel(e),this.owner.documentHelper.layout.reLayoutTable(t),this.owner.editorModule.reLayout(this.owner.selection),r&&this.getRowReSizerPosition(void 0,this.startingPoint),!this.currentResizingTable||void 0!==this.currentResizingTable.childWidgets&&void 0!==this.currentResizingTable.childWidgets[this.resizerPosition]||(this.resizerPosition=-1)}},e.prototype.getTableWidget=function(e){var t=void 0,i=this.owner.documentHelper.currentPage;if(!sf.base.isNullOrUndefined(i))for(var r=0;r<i.bodyWidgets.length;r++){var n=i.bodyWidgets[parseInt(r.toString(),10)];if(t=this.getTableWidgetFromWidget(e,n),!sf.base.isNullOrUndefined(t))break;if("Pages"===this.documentHelper.owner.layoutType){var o=i.headerWidget;if(t=this.getTableWidgetFromWidget(e,o),!sf.base.isNullOrUndefined(t))break;var s=i.footerWidget;if(t=this.getTableWidgetFromWidget(e,s),!sf.base.isNullOrUndefined(t))break}}return t},e.prototype.getTableWidgetFromWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++)if(t.childWidgets[parseInt(i.toString(),10)]instanceof ga){var r=t.childWidgets[parseInt(i.toString(),10)],n=0;if(r.wrapTextAround&&(n=r.getTableCellWidth()),!r.wrapTextAround&&r.y<=e.y&&r.y+r.height>=e.y)return r;if(r.wrapTextAround&&r.x<=e.x&&r.x+n>=e.x&&r.y<=e.y&&r.y+r.height>=e.y)return r}},e.prototype.getTableCellWidget=function(e){var t=void 0,i=this.owner.documentHelper.currentPage;if(!sf.base.isNullOrUndefined(i))for(var r=0;r<i.bodyWidgets.length;r++){if(t=i.bodyWidgets[parseInt(r.toString(),10)].getTableCellWidget(e),!sf.base.isNullOrUndefined(t))break;if("Pages"===this.documentHelper.owner.layoutType&&this.viewer.owner.enableHeaderAndFooter){if(t=i.headerWidget.getTableCellWidget(e),!sf.base.isNullOrUndefined(t))break;if(t=i.footerWidget.getTableCellWidget(e),!sf.base.isNullOrUndefined(t))break}}return t},e.prototype.updateRowHeight=function(e,t){var i=e.rowFormat;if("Auto"===i.heightType){i.heightType="AtLeast";var r=i.ownerBase,n=this.owner.documentHelper.layout.getRowHeight(r,[r]);n+t>=2.7&&i.height!==n+t&&(i.height=n+t)}else i.height+t>=2.7&&i.height!==i.height+t&&(i.height=i.height+t)},e.prototype.resizeTableCellColumn=function(e){var t=this.currentResizingTable;if(!(sf.base.isNullOrUndefined(t)||0===e||sf.base.isNullOrUndefined(t.childWidgets)||this.resizerPosition<0)){var i=!0,r=this.owner.selection;this.owner.editor.setOffsetValue(r),t=t.combineWidget(this.viewer),this.owner.isLayoutEnabled=!1,this.setPreferredWidth(t);var n=t.getOwnerWidth(!0),o=t.leftIndent,s=t.tableFormat.tableAlignment;if(r.isEmpty||(i=this.resizeColumnWithSelection(r,t,e)),i){if(0===this.resizerPosition){var a=this.resizerPosition,l=t.tableHolder.columns[parseInt(a.toString(),10)],d=l.preferredWidth;if(e>0){var h=e;do{if((c=x.round(l.preferredWidth-e,1))>=l.minWidth){l.preferredWidth=c,o=(o=t.leftIndent+e)>=-1440?o<=1440?o:1440:-1440;break}h=e,e+=c-l.minWidth}while(e!==h)}else{h=e;do{var c;if((c=x.round(l.preferredWidth-e,1))<=2112){l.preferredWidth=c,o=(o=t.leftIndent+e)>=-1440?o<=1440?o:1440:-1440;break}h=e,e-=c-2112}while(e!==h)}var p=e;"Left"!==s&&t.tableHolder.getTotalWidth(0)>n&&"Auto"===t.tableFormat.preferredWidthType&&(t.tableHolder.isFitColumns(n,t.tableHolder.tableWidth,"Auto"===t.tableFormat.preferredWidthType)?t.tableHolder.fitColumns(n,t.tableHolder.tableWidth,"Auto"===t.tableFormat.preferredWidthType,t.tableFormat.allowAutoFit):l.preferredWidth=d,p=0),"Center"===s&&(t.tableHolder.getTotalWidth(0)<n||"Auto"!==t.tableFormat.preferredWidthType)&&(p/=2),t.tableFormat.leftIndent="Left"===s?o:0,t.tableHolder.tableWidth=t.tableHolder.getTotalWidth(0),this.updateCellPreferredWidths(t),"Auto"!==t.tableFormat.preferredWidthType&&t.updateWidth(e),this.updateGridValue(t,!0,p)}else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length)this.resizeColumnAtLastColumnIndex(t,e,n);else{if(-1===this.resizerPosition)return void(this.owner.isLayoutEnabled=!0);this.resizeCellAtMiddle(t,e)}this.owner.isLayoutEnabled=!0,r.selectPosition(r.start,r.end)}else this.updateGridValue(t,!0)}},e.prototype.resizeColumnWithSelection=function(e,t,i){var r=this.getTableCellWidget(this.startingPoint);if(r&&(e.selectedWidgets.containsKey(r)||r.previousWidget&&e.selectedWidgets.containsKey(r.previousWidget))){var n=e.getSelectedCells();if(0===this.resizerPosition)this.resizeColumnAtStart(t,i,n);else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length){for(var o=this.getColumnCells(t,this.resizerPosition,!0),s=0;s<o.length;s++){var a=o[parseInt(s.toString(),10)];-1!==n.indexOf(a)&&this.increaseOrDecreaseWidth(a,i,!0)}this.updateRowsGridAfterWidth(t),t.updateWidth(i),t.tableFormat.allowAutoFit=!1,this.updateGridValue(t,!0,i)}else{if(-1===this.resizerPosition)return!1;var l=this.resizerPosition,d=(o=this.getColumnCells(t,l,!0),this.getColumnCells(t,l,!1)),h=this.isColumnSelected(t,l);if(o.length>0&&!h)for(s=0;s<o.length;s++)-1===n.indexOf(o[parseInt(s.toString(),10)])&&(o.splice(s,1),s--);if(d.length>0&&!h)for(s=0;s<d.length;s++)-1===n.indexOf(d[parseInt(s.toString(),10)])&&(d.splice(s,1),s--);if(0===o.length&&d.length>0)for(s=0;s<d.length;s++){(a=d[parseInt(s.toString(),10)]).previousWidget&&o.push(a.previousWidget)}else if(0===d.length&&o.length>0)for(s=0;s<o.length;s++){(a=o[parseInt(s.toString(),10)]).nextWidget&&d.push(a.nextWidget)}this.changeWidthOfCells(t,o,d,i),t.tableFormat.allowAutoFit&&t.updateWidth(i),t.tableFormat.allowAutoFit=!1,this.updateGridValue(t,!0,i)}e.selectPosition(e.start,e.end)}return!1},e.prototype.resizeColumnAtStart=function(e,t,i){var r=e.leftIndent,n=i[0].ownerRow,o=n.rowFormat;if(o.beforeWidth>0){var s=o.beforeWidth+t;if(s>0)this.updateGridBefore(n,t);else if(s<(l=this.getLeastGridBefore(e,n))&&0!==s){r=e.leftIndent+s,e.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440;for(var a=0;a<e.childWidgets.length;a++){n!==(d=e.childWidgets[parseInt(a.toString(),10)])&&this.updateGridBefore(d,-s)}}}else if(t<0)r=e.leftIndent+t,e.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440,this.updateWidthForCells(e,i,t);else{var l=this.getLeastGridBefore(e,n);if(0===e.tableFormat.leftIndent)for(a=0;a<e.childWidgets.length;a++){var d=e.childWidgets[parseInt(a.toString(),10)];-1!==i.indexOf(d.childWidgets[0])&&(this.updateGridBefore(d,t),this.increaseOrDecreaseWidth(d.childWidgets[0],t,!1))}else if(l-t>0)r=e.leftIndent+t,e.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440,this.updateWidthForCells(e,i,t);else{r=e.leftIndent+l,e.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440;for(a=0;a<e.childWidgets.length;a++){d=e.childWidgets[parseInt(a.toString(),10)];-1!==i.indexOf(d.childWidgets[0])?(this.increaseOrDecreaseWidth(d.childWidgets[0],t,!1),this.updateGridBefore(d,t-l)):this.updateGridBefore(d,-l)}}}e.tableFormat.allowAutoFit=!1,this.updateGridValue(e,!0,t)},e.prototype.updateWidthForCells=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[parseInt(r.toString(),10)];-1!==t.indexOf(n.childWidgets[0])?this.increaseOrDecreaseWidth(n.childWidgets[0],i,!1):this.updateGridBefore(n,-i)}},e.prototype.resizeColumnAtLastColumnIndex=function(e,t,i){for(var r=e.tableFormat.tableAlignment,n=e.tableFormat.preferredWidth,o=this.resizerPosition,s=e.tableHolder.columns[o-1],a=0;t!==a;){var l=x.round(s.preferredWidth+t,1);l>=s.minWidth?(s.preferredWidth=l,a=t):(a=t,t-=l-s.minWidth)}this.updateCellPreferredWidths(e),(n||e.tableHolder.getTotalWidth(0)>i)&&(e.tableFormat.allowAutoFit=!1,e.updateWidth(t),e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(0));var d=t;"Right"===r?d=0:"Center"===r&&(d/=2),this.updateGridValue(e,!0,d)},e.prototype.resizeCellAtMiddle=function(e,t){var i=this.resizerPosition,r=e.tableHolder.columns[i-1],n=e.tableHolder.columns[parseInt(i.toString(),10)];if(t>0)for(var o=!0;o;){(s=x.round(n.preferredWidth-t,1))>=n.minWidth?(n.preferredWidth=s,r.preferredWidth=r.preferredWidth+t,o=!1):t+=s-n.minWidth}else for(o=!0;o;){var s;(s=x.round(r.preferredWidth+t,1))>=r.minWidth?(r.preferredWidth=s,n.preferredWidth=n.preferredWidth-t,o=!1):t-=s-r.minWidth}this.updateCellPreferredWidths(e),e.tableFormat.allowAutoFit&&e.updateWidth(t),e.tableFormat.allowAutoFit=!1,e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(0),this.updateGridValue(e,!1,t)},e.prototype.updateGridValue=function(e,t,i){if(t&&(e.calculateGrid(),e.isGridUpdated=!1),e.buildTableColumns(),e.isGridUpdated=!0,this.viewer.owner.isLayoutEnabled=!0,e.isInsideTable){var r=this.documentHelper.layout.getParentTable(e);this.documentHelper.layout.reLayoutTable(r)}else this.documentHelper.layout.reLayoutTable(e);this.owner.editor.getOffsetValue(this.documentHelper.selection),this.owner.editorModule.reLayout(this.owner.selection),i&&(this.startingPoint.x+=x.convertPointToPixel(i),this.resizerPosition=this.getCellReSizerPosition(this.startingPoint))},e.prototype.getColumnCells=function(e,t,i){for(var r=[],n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[parseInt(n.toString(),10)],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[parseInt(s.toString(),10)];i?a.columnIndex+a.cellFormat.columnSpan===t&&r.push(a):a.columnIndex===t&&r.push(a)}return r},e.prototype.updateGridBefore=function(e,t){e.rowFormat.beforeWidth+t!==e.rowFormat.beforeWidth&&(e.rowFormat.beforeWidth=e.rowFormat.beforeWidth+t,e.rowFormat.gridBeforeWidth=e.rowFormat.beforeWidth)},e.prototype.getLeastGridBefore=function(e,t){for(var i=0,r=0,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[parseInt(n.toString(),10)];o!==t&&(0===r&&(i=o.rowFormat.beforeWidth,r++),o.rowFormat.beforeWidth<=i&&(i=o.rowFormat.beforeWidth))}return i},e.prototype.increaseOrDecreaseWidth=function(e,t,i){var r=e.cellFormat.preferredWidth;"Auto"===e.cellFormat.preferredWidthType&&(r=e.cellFormat.cellWidth,e.cellFormat.preferredWidthType="Point");var n=e.ownerColumn.minWidth;"Percent"===e.cellFormat.preferredWidthType&&(n=e.convertPointToPercent(n)),e.cellFormat.preferredWidth=i?r+t>n?r+t:n:r-t>n?r-t:n},e.prototype.changeWidthOfCells=function(e,t,i,r){if(t.length>0){for(var n=!1,o=0;o<t.length;o++){var s=t[parseInt(o.toString(),10)];this.increaseOrDecreaseWidth(s,r,!0),s.cellIndex===s.ownerRow.childWidgets.length-1&&(n=!0)}n&&this.updateRowsGridAfterWidth(e)}if(i.length>0){var a=0;for(o=0;o<i.length;o++){if(0===(s=i[parseInt(o.toString(),10)]).cellIndex){var l=s.ownerRow.rowFormat.beforeWidth+r;l>=0?this.updateGridBefore(s.ownerRow,r):(a!==l&&(a=l),s.ownerRow.rowFormat.gridBeforeWidth=0,s.ownerRow.rowFormat.gridBeforeWidthType="Auto")}this.increaseOrDecreaseWidth(s,r,!1)}if(0!==a){var d=e.leftIndent+a;e.tableFormat.leftIndent=d>=-1440?d<=1440?d:1440:-1440;for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[parseInt(h.toString(),10)];-1===i.indexOf(c.childWidgets[0])&&this.updateGridBefore(c,a>0?a:-a)}}}},e.prototype.updateRowsGridAfterWidth=function(e){for(var t=this.getMaxRowWidth(e,!0),i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[parseInt(i.toString(),10)],n=this.getRowWidth(r,!0);if(t>=n&&r.rowFormat.afterWidth!==t-n){var o=t-n;r.rowFormat.gridAfterWidth=o,r.rowFormat.afterWidth=o}}},e.prototype.getRowWidth=function(e,t){var i=0;t&&(i+=e.rowFormat.beforeWidth);for(var r=0;r<e.childWidgets.length;r++){i+=e.childWidgets[parseInt(r.toString(),10)].cellFormat.cellWidth}return i},e.prototype.getMaxRowWidth=function(e,t){for(var i=0,r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[parseInt(r.toString(),10)],o=0;t&&(o+=n.rowFormat.beforeWidth);for(var s=0;s<n.childWidgets.length;s++){o+=n.childWidgets[parseInt(s.toString(),10)].cellFormat.cellWidth}i<o&&(i=o)}return i},e.prototype.isColumnSelected=function(e,t){for(var i=this.owner.selection.getSelectedCells(),r=this.getColumnCells(e,t,!0),n=this.getColumnCells(e,t,!1),o=!1,s=0;s<r.length;s++){var a=r[parseInt(s.toString(),10)];o=-1!==i.indexOf(a)}if(!o)for(s=0;s<n.length;s++){a=n[parseInt(s.toString(),10)];o=-1!==i.indexOf(a)}return o},e.prototype.applyProperties=function(e,t){if(!sf.base.isNullOrUndefined(t)){t.tableHolder&&(e.tableHolder=t.tableHolder.clone()),null!==t.tableFormat&&(e.tableFormat.leftIndent=t.tableFormat.leftIndent,e.tableFormat.preferredWidth=t.tableFormat.preferredWidth,e.tableFormat.preferredWidthType=t.tableFormat.preferredWidthType,e.tableFormat.allowAutoFit=t.tableFormat.allowAutoFit);for(var i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[parseInt(i.toString(),10)],n=t.rows[parseInt(i.toString(),10)];r.rowFormat.gridBefore=n.gridBefore,r.rowFormat.gridBeforeWidth=n.gridBeforeWidth,r.rowFormat.gridBeforeWidthType=n.gridBeforeWidthType,r.rowFormat.gridAfter=n.gridAfter,r.rowFormat.gridAfterWidth=n.gridAfterWidth,r.rowFormat.gridAfterWidthType=n.gridAfterWidthType;for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[parseInt(o.toString(),10)],a=n.cells[parseInt(o.toString(),10)];s.columnIndex=a.columnIndex,s.cellFormat.columnSpan=a.columnSpan,s.cellFormat.preferredWidth=a.preferredWidth,s.cellFormat.preferredWidthType=a.preferredWidthType}}var l=e.getOwnerWidth(!0),d=e.getTableClientWidth(l);e.setWidthToCells(d,"Auto"===e.tableFormat.preferredWidthType)}},e.prototype.getActualWidth=function(e){var t=0;if(e.childWidgets.length>0)for(var i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[parseInt(i.toString(),10)].cellFormat.cellWidth;return t},e.prototype.setPreferredWidth=function(e){for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[parseInt(t.toString(),10)],r=i.rowFormat;r.gridBefore>0&&(r.gridBeforeWidth=r.beforeWidth,r.gridBeforeWidthType="Point");for(var n=0;n<i.childWidgets.length;n++){var o=i.childWidgets[parseInt(n.toString(),10)];o.cellFormat.preferredWidth=o.cellFormat.cellWidth,o.cellFormat.preferredWidthType="Point"}r.gridAfter>0&&(r.gridAfterWidth=r.afterWidth,r.gridAfterWidthType="Point")}},e.prototype.updateCellPreferredWidths=function(e){for(var t=e.tableHolder.tableWidth,i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[parseInt(i.toString(),10)];if(r.rowFormat.gridBefore>0){var n=e.tableHolder.getCellWidth(0,r.rowFormat.gridBefore,t);this.updateGridBeforeWidth(n,r)}for(var o=0;o<r.childWidgets.length;o++){var s=r.childWidgets[parseInt(o.toString(),10)];s.updateWidth(e.tableHolder.getCellWidth(s.columnIndex,s.cellFormat.columnSpan,t))}r.rowFormat.gridAfter>0&&this.updateGridAfterWidth(e.tableHolder.getCellWidth(r.childWidgets.length,r.rowFormat.gridAfter,t),r)}},e.prototype.updateGridBeforeWidth=function(e,t){var i=t.rowFormat;if(e!==i.beforeWidth)if(i.beforeWidth=e,"Auto"===i.gridBeforeWidthType&&(i.gridBeforeWidthType="Point"),"Point"===i.gridBeforeWidthType)i.gridBeforeWidth=i.beforeWidth;else{var r=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),n=t.ownerTable.convertPointToPercent(i.beforeWidth,r);i.gridBeforeWidth=n}},e.prototype.updateGridAfterWidth=function(e,t){var i=t.rowFormat;if(e!==i.afterWidth&&(i.afterWidth=e),"Auto"===i.gridAfterWidthType&&(i.gridAfterWidthType="Point"),"Point"===i.gridAfterWidthType)i.gridAfterWidth=i.afterWidth;else{var r=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),n=t.ownerTable.convertPointToPercent(i.afterWidth,r);i.gridAfterWidth=n}},e}(),ld=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new i((function(t){t(e.value)})).then(s,a)}l((r=r.apply(e,t||[])).next())}))},dd=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},hd=function(){function e(e){var t=this;this.nodes=[],this.editHyperlinkInternal=!1,this.startParagraph=void 0,this.endParagraph=void 0,this.formFieldCounter=1,this.skipFieldDeleteTracking=!1,this.skipFootNoteDeleteTracking=!1,this.isForHyperlinkFormat=!1,this.isTrackingFormField=!1,this.isCmtDeleteStarted=!1,this.removeCommentCharacters=[],this.isInsertText=!1,this.keywordIndex=0,this.casingIndex=-1,this.checkLastLetterSpace="",this.checkLastLetterSpaceDot="",this.isCopying=!1,this.isFootnoteElementRemoved=!1,this.isEndnoteElementRemoved=!1,this.handledEnter=!1,this.removeEditRange=!1,this.isRemoveRevision=!1,this.isFootNoteInsert=!1,this.isTableInsert=!1,this.isFootNote=!1,this.isHandledComplex=!1,this.tableResize=void 0,this.tocStyles={},this.chartType=!1,this.removedBookmarkElements=[],this.removedEditRangeStartElements=[],this.isCellFormatApplied=!1,this.removedEditRangeEndElements=[],this.tocBookmarkId=0,this.triggerPageSpellCheck=!0,this.copiedData=void 0,this.isPasteContentCheck=!1,this.pageRefFields={},this.delBlockContinue=!1,this.delBlock=void 0,this.delSection=void 0,this.isInsertingTOC=!1,this.editStartRangeCollection=[],this.skipReplace=!1,this.skipTableElements=!1,this.listNumberFormat="",this.listLevelNumber=0,this.isXmlMapped=!1,this.isAutoList=!1,this.combineLastBlock=!1,this.copiedContent="",this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.pasteTextPosition=void 0,this.isPaste=!1,this.isPasteListUpdated=!1,this.isHtmlPaste=!1,this.isInsertField=!1,this.isBordersAndShadingDialog=!1,this.pasteImageIndex=void 0,this.onTextInputInternal=function(){if(sf.base.Browser.isDevice){var e=t.documentHelper,i=new RegExp(String.fromCharCode(160),"g"),r=new RegExp(String.fromCharCode(10),"g");e.prefix=e.prefix.replace(i," ").replace(r," ");var n=(o=e.editableDiv.textContent.replace(i," ").replace(r," ")).substring(2);if(e.isCompositionStart&&e.isCompositionUpdated)return e.isCompositionUpdated=!1,void(!e.owner.isReadOnlyMode&&e.owner.isDocumentLoaded&&t.canEditContentControl&&e.prefix.substring(2)!==n&&(t.selection.isEmpty?(t.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,t.selection.start.offset-(e.prefix.length-2)),t.handleTextInput(n),e.prefix="@"+String.fromCharCode(160)+n):(t.handleTextInput(n),e.prefix="@"+String.fromCharCode(160)+n)));if(e.isCompositionStart&&e.isCompositionEnd&&""===e.suffix)return e.prefix.substring(2)!==n?t.selection.isEmpty&&e.isCompositionStart?(e.isCompositionStart=!1,t.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,t.selection.start.offset-e.prefix.substring(2).length),t.selection.retrieveCurrentFormatProperties(),""!==e.suffix&&""!==n||t.handleTextInput(n)):t.selection.isEmpty||(e.isCompositionStart=!1,t.handleTextInput(n)):""===n?(e.isCompositionStart=!1,t.handleBackKey()):e.prefix.substring(2)===n&&""===e.suffix&&(e.isCompositionStart=!1,t.handleTextInput(" ")),void(e.isCompositionEnd=!1);if(e.isCompositionEnd||e.isCompositionStart&&!e.isCompositionUpdated){if(n.length<e.prefix.length&&n===e.prefix.substring(2,e.prefix.length-1)||e.editableDiv.innerText.length<2)return void t.handleBackKey();if(""!==e.suffix&&e.editableDiv.innerText[e.editableDiv.innerText.length-1]!==String.fromCharCode(160))return e.isCompositionStart=!1,t.selection.start.setPositionForLineWidget(e.selection.start.currentWidget,t.selection.start.offset-(e.prefix.length-2)),t.selection.end.setPositionForLineWidget(e.selection.end.currentWidget,t.selection.end.offset+e.suffix.length),t.selection.retrieveCurrentFormatProperties(),void t.handleTextInput(n)}"\r"!==o&&"\b"!==o&&o!==String.fromCharCode(27)&&!e.owner.isReadOnlyMode&&!1===e.isControlPressed&&t.canEditContentControl&&("@"===o||"@"!==o[0]||""===o||o.length<e.prefix.length&&n===e.prefix.substring(2,e.prefix.length-1)?(t.handleBackKey(),e.editableDiv.innerText.length<2&&t.predictText()):0===o.indexOf(e.prefix)&&o.length>e.prefix.length?t.handleTextInput(o.substring(e.prefix.length)):-1===o.indexOf(e.prefix)&&o[o.length-1]!==String.fromCharCode(160)&&" "!==o[o.length-1]?(n.charAt(0).toLowerCase()+n.slice(1)===e.prefix.substring(2)&&t.selection.start.setPositionParagraph(e.selection.start.currentWidget,t.selection.start.offset-(e.prefix.length-2)),t.handleTextInput(n)):2!==o.length&&t.handleTextInput(" "))}else{var o;(o=t.documentHelper.editableDiv.innerText)!==String.fromCharCode(160)?"\r"!==o&&"\b"!==o&&o!==String.fromCharCode(27)&&!t.owner.isReadOnlyMode&&!1===t.documentHelper.isControlPressed&&t.canEditContentControl&&t.handleTextInput(o):t.handleTextInput(" "),t.documentHelper.editableDiv.innerText=""}},this.onPaste=function(e){!t.owner.isReadOnlyMode&&t.canEditContentControl&&t.pasteInternal(e),e.preventDefault()},this.documentHelper=e,sf.base.isNullOrUndefined(this.documentHelper)||(this.tableResize=new ad(this.documentHelper.owner)),this.base64=new F}return Object.defineProperty(e.prototype,"restrictFormatting",{get:function(){return this.documentHelper.isDocumentProtected&&(this.documentHelper.restrictFormatting||!this.documentHelper.restrictFormatting&&!this.selection.isSelectionInEditRegion())&&"RevisionsOnly"!==this.documentHelper.protectionType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restrictEditing",{get:function(){return this.documentHelper.isDocumentProtected&&(("ReadOnly"===this.documentHelper.protectionType||this.documentHelper.isCommentOnlyMode)&&!this.selection.isSelectionInEditRegion()||"FormFieldsOnly"===this.documentHelper.protectionType)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"HeadingDataSource",{get:function(){return this.dataForTreeview()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canEditContentControl",{get:function(){return!this.owner.isReadOnlyMode&&!this.selection.checkContentControlLocked()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){if(!sf.base.isNullOrUndefined(this.owner))return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.documentHelper.owner.editorHistory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){if(this.documentHelper)return this.documentHelper.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"Editor"},e.prototype.setFieldInfo=function(e){var t=this.selection.getHyperlinkField(!0);sf.base.isNullOrUndefined(t)||(this.selection.selectField(),this.insertField(e.code,e.result))},e.prototype.insertField=function(e,t){this.isInsertField=!0;var i=e;if("NUMPAGES"===(i=x.trimStart(i)).substring(0,8))this.insertPageCount(t);else if("PAGE"===i.substring(0,4))this.insertPageNumber(t);else{if(sf.base.isNullOrUndefined(t)&&"MERGEFIELD"===i.substring(0,10)){var r=(i=i.substring(10).trim()).indexOf("\\*");t="«"+i.substring(0,r).trim()+"»"}var n=new ca,o=new T,s=this.copyInsertFormat(o,!1),a=new ma(n),l=new va(0);l.characterFormat.mergeFormat(s),a.children.push(l);var d=new Fa;d.characterFormat.mergeFormat(s),d.text=e,a.children.push(d);var c=new va(2);c.characterFormat.mergeFormat(s),c.fieldBegin=l,l.fieldSeparator=c,a.children.push(c);var p=new Fa;p.text=t,p.characterFormat.mergeFormat(s),a.children.push(p);var g=new va(1);g.characterFormat.mergeFormat(s),g.fieldSeparator=c,g.fieldBegin=l,l.fieldEnd=g,c.fieldEnd=g,a.children.push(g),l.line=a,n.childWidgets.push(a),this.documentHelper.fields.push(l);var f=new aa;f.sectionFormat=new h(f),f.childWidgets.push(n),n.isCreatedUsingHtmlSpanTag=!0,this.pasteContentsInternal([f],!1)}this.isInsertField=!1},e.prototype.isLinkedStyle=function(e){var t=this.documentHelper.styles.findByName(e);return!sf.base.isNullOrUndefined(t.link)},e.prototype.applyStyle=function(e,t){var i=void 0,r=void 0;if(t=!sf.base.isNullOrUndefined(t)&&t){this.initComplexHistory("ApplyStyle"),this.setOffsetValue(this.selection),i=this.startOffset,r=this.endOffset;var n=this.selection.isEmpty;this.clearFormattingInternal(!this.isLinkedStyle(e)),n&&!this.selection.isEmpty&&this.selection.end.setPositionInternal(this.selection.start)}var o=this.documentHelper.styles.findByName(e);if(void 0!==o)if(o instanceof wl&&"Character"===o.type)if(this.selection.isEmpty){var s=this.selection.start.offset,a=this.selection.start.clone(),l=this.selection.end.clone();this.selection.selectCurrentWord(),s===this.selection.start.offset||s===this.selection.end.offset-1?(this.selection.start=a,this.selection.end=l,this.selection.characterFormat.copyFormat(o.characterFormat)):this.onApplyCharacterFormat("styleName",o,!1,!0)}else this.onApplyCharacterFormat("styleName",o,!1,!0);else this.onApplyParagraphFormat("styleName",o,!1,!0);else this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(e)),this.documentHelper.styles),this.applyStyle(e);this.editorHistory&&this.editorHistory.currentHistoryInfo&&"ApplyStyle"===this.editorHistory.currentHistoryInfo.action&&(this.startOffset=i,this.endOffset=r,this.editorHistory.updateComplexHistory()),this.startParagraph=void 0,this.endParagraph=void 0},e.prototype.cut=function(){this.owner.isReadOnlyMode||this.selection.isEmpty||!this.canEditContentControl||(this.selection.copySelectedContent(!0),this.documentHelper.owner.parser.isCutPerformed=!0)},e.prototype.insertEditingRegion=function(e){this.insertEditRangeElement(e&&""!==e?e:"Everyone")},e.prototype.enforceProtection=function(e,t,i){var r,n;"boolean"==typeof t?(r=i?"ReadOnly":this.documentHelper.protectionType,n=t):r=t,sf.base.isNullOrUndefined(n)||(this.documentHelper.restrictFormatting=n),this.documentHelper.protectionType=r,this.selection.isHighlightEditRegion=!0,this.addProtection(e,this.documentHelper.protectionType)},e.prototype.enforceProtectionAsync=function(e,t,i){return ld(this,void 0,void 0,(function(){var r,n;return dd(this,(function(o){switch(o.label){case 0:return"boolean"==typeof t?(r=i?"ReadOnly":this.documentHelper.protectionType,n=t):(n=!0,r=t),this.documentHelper.restrictFormatting=n,this.documentHelper.protectionType=r,this.selection.isHighlightEditRegion=!0,[4,this.addProtection(e,this.documentHelper.protectionType)];case 1:return o.sent(),[2]}}))}))},e.prototype.getCommentHierarchicalIndex=function(e){for(var t="";e.ownerComment;)t=e.ownerComment.replyComments.indexOf(e)+";"+t,e=e.ownerComment;return t="C;"+this.documentHelper.comments.indexOf(e)+";"+t},e.prototype.alertBox=function(){},e.prototype.insertComment=function(e){sf.base.isNullOrUndefined(this.selection.start)||this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||this.viewer.owner.enableHeaderAndFooter||!this.viewer.owner.enableComment||(sf.base.isNullOrUndefined(e)&&(e=""),this.insertCommentInternal(e))},e.prototype.insertCommentInternal=function(e){if(this.documentHelper.layout.allowLayout=!1,this.selection.isEmpty){if(this.selection.start.isAtSamePosition(this.selection.end)&&this.selection.start.isAtParagraphEnd){var t=this.selection.start.offset;this.selection.start.offset=t-1!=-1?t-1:t}this.selection.selectCurrentWord()}this.selection.isParagraphLastLine(this.selection.end.currentWidget)&&this.selection.end.offset===this.selection.getLineLength(this.selection.end.currentWidget)+1&&(this.selection.end.offset-=1);var i=this.selection.getParagraphInfo(this.selection.start),r=(this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString()),this.selection.getParagraphInfo(this.selection.end)),n=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());this.initComplexHistory("InsertComment");var o=this.selection.start,s=this.selection.end,a=new Al(this.owner);this.selection.isForward||(o=this.selection.end,s=this.selection.start),a.setPositionInternal(s);var l=new al(0),d=new al(1),h=o.currentWidget===s.currentWidget;if(s.setPositionInternal(o),this.initInsertInline(l),sf.base.isNullOrUndefined(a.paragraph)||a.currentWidget&&0===a.currentWidget.children.length&&-1===a.currentWidget.indexInOwner){var c=this.selection.getTextPosBasedOnLogicalIndex(n);a.setPositionInternal(c)}h&&a.setPositionParagraph(a.currentWidget,a.offset+l.length),o.setPositionInternal(a),s.setPositionInternal(a),this.initInsertInline(d);var p=new ll(x.getUtcDate());return this.owner.editorHistory&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(p)),p.author=this.owner.currentUser?this.owner.currentUser:"Guest user",p.initial=this.constructCommentInitial(p.author),p.text=sf.base.SanitizeHtmlHelper.sanitize(e),p.commentId=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),l.comment=p,l.commentId=p.commentId,d.comment=p,d.commentId=p.commentId,p.commentStart=l,p.commentEnd=d,this.addCommentWidget(p,!0,!0,!0),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(p),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection,!1),this.documentHelper.layout.allowLayout=!0,p},e.prototype.deleteAllComments=function(){if(0!==this.documentHelper.comments.length){var e;for(this.initComplexHistory("DeleteAllComments"),this.owner.isLayoutEnabled=!1,this.editorHistory&&this.editorHistory.currentHistoryInfo&&(e=this.editorHistory.currentHistoryInfo);this.documentHelper.comments.length>0;){var t=this.documentHelper.comments[0];this.initComplexHistory("DeleteComment"),this.deleteCommentInternal(t),this.editorHistory&&this.editorHistory.currentHistoryInfo&&e.addModifiedAction(this.editorHistory.currentHistoryInfo)}this.selection.selectContent(this.owner.documentStart,!0),this.editorHistory&&(this.editorHistory.currentHistoryInfo=e,this.editorHistory.updateComplexHistory())}},e.prototype.deleteComment=function(){this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||sf.base.isNullOrUndefined(this.owner)||sf.base.isNullOrUndefined(this.owner.viewer)||sf.base.isNullOrUndefined(this.owner.documentHelper.currentSelectedComment)||this.owner.enableHeaderAndFooter||!this.viewer.owner.enableComment||this.deleteCommentInternal(this.owner.documentHelper.currentSelectedComment)},e.prototype.deleteCommentInternal=function(e){if(this.initComplexHistory("DeleteComment"),e){var t=e.commentStart,i=e.commentEnd;if(-1!==i.indexInOwner&&this.removeInline(i),-1!==t.indexInOwner&&this.removeInline(t),t.removeCommentMark(),e.replyComments.length>0)for(var r=e.replyComments.length-1;r>=0;r--)this.deleteCommentInternal(e.replyComments[r]);this.owner.editorHistory&&(this.initHistory("DeleteCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(e),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(e)),this.deleteCommentWidget(e),this.editorHistory&&this.editorHistory.updateHistory()}this.editorHistory&&this.editorHistory.updateComplexHistory()},e.prototype.deleteCommentWidget=function(e){var t,i=this.documentHelper.comments.indexOf(e);-1!==i?this.documentHelper.comments.splice(i,1):e.isReply&&e.ownerComment&&(i=e.ownerComment.replyComments.indexOf(e),e.ownerComment.replyComments.splice(i,1));var r={};r.comment=this.getCommentObj(e),t=JSON.stringify(r),this.owner.dotNetRef.invokeMethodAsync("DeleteCommentWidget",t)},e.prototype.resolveComment=function(e){this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||this.resolveOrReopenComment(e,!0)},e.prototype.reopenComment=function(e){this.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||this.resolveOrReopenComment(e,!1)},e.prototype.resolveOrReopenComment=function(e,t){e.isResolved=t;for(var i=0;i<e.replyComments.length;i++)e.replyComments[i].isResolved=t},e.prototype.replyComment=function(e,t){if(!this.owner.isReadOnlyMode||this.documentHelper.isCommentOnlyMode){var i=e;if(e){this.initComplexHistory("InsertComment");var r=i.commentStart,n=i.commentEnd,o=i.replyComments.length,s=r.line.getOffset(r,o+1),a=new Al(this.documentHelper.owner);a.setPositionParagraph(r.line,s);var l=n.line.getOffset(n,o+1),d=new Al(this.documentHelper.owner);d.setPositionParagraph(n.line,l),this.selection.start.setPositionInternal(a),this.selection.end.setPositionInternal(d),a=this.selection.start,d=this.selection.end;var h=new Al(this.owner);h.setPositionInternal(d);var c=new al(0),p=new al(1),g=a.currentWidget===d.currentWidget;d.setPositionInternal(a),this.initInsertInline(c),g&&h.setPositionParagraph(h.currentWidget,h.offset+c.length),a.setPositionInternal(h),d.setPositionInternal(h),this.initInsertInline(p);var f=new ll(x.getUtcDate());f.author=this.owner.currentUser?this.owner.currentUser:"Guest user",f.text=t||"",f.commentId=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),f.isReply=!0,i.replyComments.push(f),f.ownerComment=i,this.owner.editorHistory&&(this.initHistory("InsertCommentWidget"),this.owner.editorHistory.currentBaseHistoryInfo.removedNodes.push(f)),c.comment=f,c.commentId=f.commentId,p.comment=f,p.commentId=f.commentId,f.commentStart=c,f.commentEnd=p,this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=this.getCommentHierarchicalIndex(f),this.editorHistory.updateHistory()),this.editorHistory&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection)}}},e.prototype.removeInline=function(e){this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,0)),this.selection.end.setPositionParagraph(this.selection.start.currentWidget,this.selection.start.offset+e.length),this.initHistory("RemoveInline"),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.start,!0),this.removeSelectedContents(this.documentHelper.selection),this.editorHistory&&this.editorHistory.updateHistory(),this.fireContentChange()},e.prototype.addCommentWidget=function(e,t,i,r){if(-1===this.documentHelper.comments.indexOf(e)){var n=!1;if(this.documentHelper.comments.length>0)for(var o=this.selection.getElementPosition(e.commentStart).startPosition,s=0;s<this.documentHelper.comments.length;s++){var a=this.selection.getElementPosition(this.documentHelper.comments[s].commentStart).startPosition;if(o.isExistBefore(a)){n=!0,this.documentHelper.comments.splice(s,0,e);break}}n||this.documentHelper.comments.push(e);var l,d={};d.comment=this.getCommentObj(e),d.index=this.documentHelper.comments.indexOf(e),d.isNewComment=t,l=JSON.stringify(d),this.owner.dotNetRef.invokeMethodAsync("AddCommentWidget",l)}},e.prototype.addReplyComment=function(e,t){var i,r=t.split(";"),n=this.documentHelper.comments[parseInt(r[1],10)];""!==r[2]&&(n.replyComments.splice(parseInt(r[2],10),0,e),e.ownerComment=n);var o={};o.comment=this.getCommentObj(e),o.index=n.replyComments.indexOf(e),i=JSON.stringify(o),this.owner.dotNetRef.invokeMethodAsync("AddReplyComment",i)},e.prototype.getCommentObj=function(e){var t={};return t.date=e.date,t.text=e.text,t.isReply=e.isReply,t.isResolved=e.isResolved,t.author=e.author,t.initial=e.initial,t.commentId=e.commentId,t.userColor=this.documentHelper.getAuthorColor(e.author),e.ownerComment&&e.ownerComment.commentId&&(t.ownerCommentId=e.ownerComment.commentId),t},e.prototype.addProtection=function(e,t){return ld(this,void 0,void 0,(function(){var i=this;return dd(this,(function(r){return[2,new Promise((function(r,n){if(""===e)i.protectDocument(t),r();else{i.currentProtectionType=t;var o=new M,s={passwordBase64:i.base64.encodeString(e),saltBase64:"",spinCount:1e5},a=i.owner.serviceUrl+i.owner.serverActionSettings.restrictEditing;o.url=a,o.contentType="application/json;charset=UTF-8",o.onSuccess=function(e){i.enforceProtectionInternal(e,i.currentProtectionType),r()},o.onFailure=function(e){i.protectionFailureHandler(e),n()},o.onError=function(e){i.protectionFailureHandler(e),n()},o.customHeaders=i.owner.headers,o.send(s)}}))]}))}))},e.prototype.toggleTrackChangesProtection=function(e){"RevisionsOnly"===this.currentProtectionType&&(this.viewer.owner.enableTrackChanges=e)},e.prototype.protectionFailureHandler=function(e){},e.prototype.enforceProtectionInternal=function(e,t){var i=JSON.parse(e.data);this.documentHelper.saltValue=i[0],this.documentHelper.hashValue=i[1],t&&(this.currentProtectionType=t),this.protectDocument(this.currentProtectionType)},e.prototype.protectDocument=function(e){this.protect(e),this.toggleTrackChangesProtection(!0),this.owner.trackChangesPane.enableDisableButton(!1)},e.prototype.stopProtection=function(e){if(this.documentHelper.isDocumentProtected){if(!sf.base.isNullOrUndefined(this.documentHelper.saltValue)&&""===this.documentHelper.saltValue&&!sf.base.isNullOrUndefined(this.documentHelper.hashValue)&&""===this.documentHelper.hashValue&&!sf.base.isNullOrUndefined(e)&&""===e)return void this.unProtectDocument();var t=new M,i={passwordBase64:this.base64.encodeString(e),saltBase64:this.documentHelper.saltValue,spinCount:1e5};t.url=this.owner.serviceUrl+this.owner.serverActionSettings.restrictEditing,t.contentType="application/json;charset=UTF-8",t.customHeaders=this.owner.headers,t.onSuccess=this.onUnProtectionSuccess.bind(this),t.onFailure=this.protectionFailureHandler.bind(this),t.onError=this.protectionFailureHandler.bind(this),t.send(i)}},e.prototype.stopProtectionAsync=function(e){return ld(this,void 0,void 0,(function(){var t=this;return dd(this,(function(i){return[2,new Promise((function(i,r){if(t.documentHelper.isDocumentProtected){if(!sf.base.isNullOrUndefined(t.documentHelper.saltValue)&&""===t.documentHelper.saltValue&&!sf.base.isNullOrUndefined(t.documentHelper.hashValue)&&""===t.documentHelper.hashValue&&!sf.base.isNullOrUndefined(e)&&""===e)return t.unProtectDocument(),void i();var n=new M,o={passwordBase64:t.base64.encodeString(e),saltBase64:t.documentHelper.saltValue,spinCount:1e5};n.url=t.owner.serviceUrl+t.owner.serverActionSettings.restrictEditing,n.contentType="application/json;charset=UTF-8",n.customHeaders=t.owner.headers,n.onSuccess=function(e){t.onUnProtectionSuccess(e),i()},n.onFailure=function(e){t.protectionFailureHandler(e),r()},n.onError=function(e){t.protectionFailureHandler(e),r()},n.send(o)}}))]}))}))},e.prototype.onUnProtectionSuccess=function(e){var t=JSON.parse(e.data);this.validateHashValue(t[1])},e.prototype.validateHashValue=function(e){var t=this.base64.decodeString(e),i=this.documentHelper.hashValue,r=this.base64.decodeString(i),n=!0;if(t.length===r.length){for(var o=0;o<t.length;o++)if(t[o]!==r[o]){n=!1;break}}else n=!1;n&&this.unProtectDocument()},e.prototype.unProtectDocument=function(){var e=this.documentHelper.protectionType;this.documentHelper.isDocumentProtected=!1,this.documentHelper.restrictFormatting=!1,this.documentHelper.protectionType="NoProtection",this.documentHelper.saltValue="",this.documentHelper.hashValue="",this.documentHelper.selection.highlightEditRegion(),"RevisionsOnly"!==e||this.owner.enableTrackChanges||this.toggleTrackChangesProtection(!1),this.owner.trackChangesPane.enableDisableButton(!0),sf.base.isNullOrUndefined(this.editorHistory)||this.owner.editorHistory.clearHistory()},e.prototype.fireContentChange=function(){this.owner.documentHelper.render.commentMarkDictionary.clear(),this.selection.isHighlightEditRegion&&this.selection.onHighlight(),this.selection.highlightFormFields(),this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousSectionFormat=void 0,this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0)),this.documentHelper.owner.isLayoutEnabled&&!this.documentHelper.owner.isShiftingEnabled&&this.documentHelper.owner.fireContentChange(),this.owner.isSpellCheck&&!sf.base.isNullOrUndefined(this.selection.editPosition)&&(this.triggerPageSpellCheck=!1)},e.prototype.updateSelectionTextPosition=function(e){this.getOffsetValue(this.selection),this.selection.start.updatePhysicalPosition(!0),this.selection.isEmpty?this.selection.end.setPositionInternal(this.selection.start):this.selection.end.updatePhysicalPosition(!0),this.selection.upDownSelectionLength=this.selection.end.location.x,this.selection.fireSelectionChanged(e)},e.prototype.predictText=function(){this.documentHelper.suffix="",this.selection.start.paragraph.isEmpty()||0===this.selection.start.offset&&this.selection.start.currentWidget.isFirstLine()||0===this.selection.end.offset&&this.selection.end.currentWidget.isFirstLine()?this.documentHelper.prefix="":this.getPrefixAndSuffix(),this.documentHelper.prefix="@"+String.fromCharCode(160)+this.documentHelper.prefix,this.documentHelper.editableDiv.innerText=this.documentHelper.prefix,this.documentHelper.selection.setEditableDivCaretPosition(this.documentHelper.prefix.length)},e.prototype.getPrefixAndSuffix=function(){var e=this.owner.documentHelper;if(""===this.selection.text){var t=0,i=this.selection.start.currentWidget.getInline(this.selection.start.offset,t),r=i.element;if(t=i.index,void 0!==r){var n=this.selection.getElementBoxInternal(r,t),o=n.element;t=n.index;var s=0;if(!sf.base.isNullOrUndefined(o)){var a=!1;for(o instanceof Fa&&t>0&&o.line.isFirstLine()&&(e.prefix=""),r instanceof Fa||(r=this.selection.getPreviousTextElement(r));(s=e.prefix.lastIndexOf(" "))<0&&r instanceof Fa;)if(r.previousNode instanceof Fa&&-1===e.prefix.indexOf(" ")){if(a?e.prefix=r.text+e.prefix:(e.prefix=r.text.substring(0,t),a=!0),(r=r.previousNode)instanceof Va)break;r instanceof Fa||(r=this.selection.getPreviousTextElement(r))}else if(!(r.previousNode instanceof Fa)){a?e.prefix=r.text+e.prefix:(e.prefix=r.text.substring(0,t),a=!0);break}e.prefix.length>1&&" "===e.prefix[e.prefix.length-1]&&"."===e.prefix[e.prefix.length-2]?(s=-1,e.prefix=""):s=e.prefix.lastIndexOf(" "),e.prefix=s<0?e.prefix:e.prefix.substring(s),0===e.prefix.indexOf(" ")&&e.prefix.length>=1&&(e.prefix=e.prefix.substring(1));var l=0,d=this.selection.end.currentWidget.getInline(this.selection.end.offset,l),h=d.element;if(l=d.index,o=(n=this.selection.getElementBoxInternal(h,l)).element,l=n.index,o){var c=!1;for(o instanceof Fa&&l<o.length&&(e.suffix="");(s=e.suffix.indexOf(" "))<0&&h instanceof Fa;)if(h.nextNode instanceof Fa&&-1===e.suffix.indexOf(" "))c?e.suffix=e.suffix+h.text:(e.suffix=o.text.substring(l),c=!0),h=h.nextNode;else if(!(h.nextNode instanceof Fa)){c?e.suffix=e.suffix+h.text:(e.suffix=o.text.substring(l),c=!0);break}s=e.suffix.indexOf(" "),e.suffix=s<0?e.suffix:e.suffix.substring(0,s)}}}}else e.prefix=""},e.prototype.onKeyDownInternal=function(e,t,i,r){var n=e.which||e.keyCode;if(this.owner.focusIn(),!t||i||r)if(!i||t||r)if(i&&t&&!r)switch(n){case 13:this.owner.isReadOnlyMode||(e.preventDefault(),this.insertColumnBreak());break;case 68:this.owner.isReadOnlyMode||this.owner.selection.toggleUnderline("Double");break;case 77:this.owner.isReadOnlyMode||this.owner.selection.decreaseIndent(),e.preventDefault();break;case 188:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 190:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode||this.toggleBaselineAlignment("Superscript");break;case 69:if(e.preventDefault(),!this.owner.isReadOnlyMode)this.owner.enableTrackChanges}else if(!i&&t&&r)switch(n){case 72:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.toggleHighlightColor();break;case 70:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertFootnote();break;case 68:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.insertEndnote()}else switch(n){case 8:e.preventDefault(),this.handleBackKey();break;case 9:this.owner.acceptTab?(e.preventDefault(),this.selection.handleTabKey(!0,!1)):this.documentHelper.editableDiv.blur();break;case 13:e.preventDefault(),this.owner.isSpellCheck&&(this.documentHelper.triggerSpellCheck=!0),this.handleEnterKey(),this.owner.isSpellCheck&&(this.documentHelper.triggerSpellCheck=!1);break;case 27:e.preventDefault(),this.isPaste||(this.copiedContent=void 0,this.copiedTextContent="",this.previousParaFormat=void 0,this.previousCharFormat=void 0,this.previousSectionFormat=void 0,this.selection.isViewPasteOptions=!1,this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.selection.showHidePasteOptions(void 0,void 0));break;case 46:this.handleDelete(),e.preventDefault();break;case 32:this.selection.handleSpaceBarKey();break;case 120:var o=this.selection.getDocumentEnd();o.offset=this.selection.getDocumentEnd().offset+1,this.selection.start.isAtSamePosition(this.selection.getDocumentStart())&&this.selection.end.isAtSamePosition(o)?this.owner.updateFields():this.selection.updateRefField()}else switch(n){case 9:this.owner.acceptTab?(e.preventDefault(),this.selection.handleTabKey(!1,!0)):this.documentHelper.editableDiv.blur();break;case 13:this.handleShiftEnter(),e.preventDefault();break;case 114:e.preventDefault(),this.changeCase(this.toggleChangeCase())}else switch(this.documentHelper.isControlPressed=!0,n){case 8:e.preventDefault(),this.handleCtrlBackKey();break;case 46:e.preventDefault(),this.handleCtrlDelete();break;case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!1,!1);break;case 13:e.preventDefault(),this.insertPageBreak();break;case 48:e.preventDefault();var s=0,a=this.documentHelper.selection.start.paragraph.paragraphFormat.beforeSpacing;a>12?s=12:a>0&&a<=12?s=0:0===a&&(s=12),this.onApplyParagraphFormat("beforeSpacing",s,!0,!1);break;case 49:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",1,!1,!1);break;case 50:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",2,!1,!1);break;case 53:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("lineSpacing",1.5,!1,!1);break;case 66:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleBold();break;case 68:e.preventDefault(),this.owner.showDialog("Font");break;case 69:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Center"),e.preventDefault();break;case 72:e.preventDefault(),this.owner.isReadOnly||this.owner.showDialog("ReplacePane");break;case 73:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleItalic();break;case 74:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Justify"),e.preventDefault();break;case 75:e.preventDefault(),this.owner.showDialog("Hyperlink");break;case 76:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Left"),e.preventDefault();break;case 77:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.owner.selection.increaseIndent(),e.preventDefault();break;case 78:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.openBlank();break;case 82:this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleTextAlignment("Right"),e.preventDefault();break;case 85:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.owner.selection.toggleUnderline("Single");break;case 88:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.editor.cut();break;case 89:this.owner.enableEditorHistory&&(this.editorHistory.redo(),e.preventDefault());break;case 90:this.owner.enableEditorHistory&&(this.editorHistory.undo(),e.preventDefault());break;case 219:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 221:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.toggleBaselineAlignment("Subscript")}this.owner.focusIn()},e.prototype.handleShiftEnter=function(){this.owner.isReadOnlyMode||this.handleTextInput("\v"),this.selection.checkForCursorVisibility()},e.prototype.handleBackKey=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&this.owner.editorModule.onBackSpace(),this.selection.checkForCursorVisibility()},e.prototype.handleDelete=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&this.owner.editorModule.delete(),this.selection.checkForCursorVisibility()},e.prototype.handleEnterKey=function(){(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&(sf.base.Browser.isDevice&&(this.documentHelper.isCompositionStart=!1),this.owner.editorModule.onEnter()),this.selection.checkForCursorVisibility()},e.prototype.handleCtrlBackKey=function(){var e=this.selection.start,t=this.selection.end;if(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode())if(this.selection.isForward||(e=t),this.selection.isEmpty)this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace();else{if((sf.base.isNullOrUndefined(e.paragraph.previousRenderedWidget)||e.paragraph.previousRenderedWidget instanceof ga)&&0===e.offset)return;this.selection.handleLeftKey(),this.selection.handleControlShiftLeftKey(),this.owner.editorModule.onBackSpace()}},e.prototype.handleCtrlDelete=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())if(this.selection.isEmpty)this.selection.handleControlShiftRightKey(),this.owner.editorModule.delete();else{this.selection.handleLeftKey(),this.selection.handleControlShiftRightKey();var e=this.selection.text;x.endsWith(e)&&this.selection.handleShiftLeftKey(),this.owner.editorModule.delete()}},e.prototype.handleTextInput=function(e){var t=this;(!this.owner.isReadOnlyMode&&this.canEditContentControl||this.selection.isInlineFormFillMode())&&(this.animationTimer&&clearTimeout(this.animationTimer),sf.base.classList(this.selection.caret,[],["e-de-cursor-animation"]),this.owner.editorModule.insertText(e),this.animationTimer=setTimeout((function(){t.animationTimer&&clearTimeout(t.animationTimer),t.selection&&t.selection.caret&&sf.base.classList(t.selection.caret,["e-de-cursor-animation"],[])}),600)),this.selection.checkForCursorVisibility()},e.prototype.copyInsertFormat=function(e,t){var i=new T,r=this.selection.characterFormat;return t&&i.copyFormat(e),sf.base.isNullOrUndefined(r.bidi)||e.bidi===r.bidi||(i.bidi=r.bidi),sf.base.isNullOrUndefined(r.bold)||e.bold===r.bold||(i.bold=r.bold),sf.base.isNullOrUndefined(r.italic)||e.italic===r.italic||(i.italic=r.italic),r.fontSize>0&&e.fontSize!==r.fontSize&&(i.fontSize=r.fontSize),sf.base.isNullOrUndefined(r.fontFamily)||e.fontFamily===r.fontFamily||(i.fontFamily=r.fontFamily),sf.base.isNullOrUndefined(r.highlightColor)||e.highlightColor===r.highlightColor||(i.highlightColor=r.highlightColor),sf.base.isNullOrUndefined(r.baselineAlignment)||e.baselineAlignment===r.baselineAlignment||(i.baselineAlignment=r.baselineAlignment),sf.base.isNullOrUndefined(r.fontColor)||e.fontColor===r.fontColor||(i.fontColor=r.fontColor),sf.base.isNullOrUndefined(r.underline)||e.underline===r.underline||(i.underline=r.underline),sf.base.isNullOrUndefined(r.strikethrough)||e.strikethrough===r.strikethrough||(i.strikethrough=r.strikethrough),i},e.prototype.getResultContentControlText=function(e){for(var t=e.nextNode,i="";!(t instanceof Oa||(t instanceof Fa&&(i+=t.text),sf.base.isNullOrUndefined(t)));)if(sf.base.isNullOrUndefined(t.nextNode)){if(!t.paragraph.nextRenderedWidget)break;t=t.paragraph.nextRenderedWidget.firstChild.children[0]}else t=t.nextNode;return i},e.prototype.updateXmlMappedContentControl=function(){if(this.isXmlMapped){var e=this.getContentControl();e&&e.contentControlProperties&&this.updateCustomXml(e.contentControlProperties.xmlMapping.storeItemId,e.contentControlProperties.xmlMapping.xPath,this.getResultContentControlText(e))}},e.prototype.updateCustomXml=function(e,t,i){if(this.documentHelper.customXmlData.containsKey(e)){var r=this.documentHelper.customXmlData.get(e),n=(new DOMParser).parseFromString(r,"text/xml"),o=t.substring(t.lastIndexOf("/")+1);o=(o=(o=o.split("[")[0]).substring(o.lastIndexOf(":")+1)).substring(o.lastIndexOf("@")+1);var s=n.getElementsByTagName(o);if(s.length>0)s[0].childNodes[0].nodeValue=i;else{if(!(n.documentElement.attributes.length>0&&null!==n.documentElement.attributes.getNamedItem(o)))return;n.documentElement.attributes.getNamedItem(o).value=i}var a=(new XMLSerializer).serializeToString(n);this.documentHelper.customXmlData.set(e,a)}},e.prototype.insertText=function(e){sf.base.isNullOrUndefined(e)||""===e||this.owner.isReadOnly||"ReadOnly"===this.documentHelper.protectionType&&!this.selection.isSelectionInEditRegion()||"CommentsOnly"===this.documentHelper.protectionType&&this.owner.isReadOnly||this.insertTextInternal(e,!1)},e.prototype.insertTextInternal=function(e,t,i,r){if("number"==typeof e&&(e=String(e)),e.indexOf("\r")>=0||e.indexOf("\n")>=0)"\r"===e||"\n"===e||"\r\n"===e?this.onEnter():(this.isInsertText=!0,this.pasteContents(e),this.isInsertText=!1);else{if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()){if(!(k=this.selection.currentFormField).formFieldData.enabled)return;var n=this.getFieldResultText(k),o=new RegExp(this.owner.documentHelper.textHelper.getEnSpaceCharacter(),"gi");n.length>0&&""===n.replace(o,"")&&(n="",this.documentHelper.isTextFormEmpty=!0,this.selection.selectFieldInternal(k));var s=k.formFieldData.maxLength;if(0!==s&&n.length>=s)return void(this.documentHelper.isTextFormEmpty=!1)}t&&(this.documentHelper.layout.isReplaceAll=!sf.base.isNullOrUndefined(r)&&!r);var a,l=this.documentHelper.selection,d=!0;i=this.owner.enableTrackChanges&&sf.base.isNullOrUndefined(i)?"Insertion":i,this.isListTextSelected(),l.bookmarks.length>0&&this.extendSelectionToBookmarkStart(),(sf.base.isNullOrUndefined(i)||"Insertion"===i)&&this.initHistory("Insert");var h=this.selection.getParagraphInfo(l.start),c=h.paragraph.paragraphFormat;l.editPosition=l.getHierarchicalIndex(h.paragraph,h.offset.toString());var p=l.start.paragraph.paragraphFormat.bidi;if(!l.isEmpty&&!l.isImageSelected||this.documentHelper.isListTextSelected&&"List"===l.contextType){l.isSkipLayouting=!0,l.skipFormatRetrieval=!0;var g=void 0,f=void 0,u=0,m=0;if(this.owner.enableTrackChanges&&(this.selection.start.isExistBefore(this.selection.end)?(f=this.selection.getParagraphInfo(l.end),g=this.selection.end.clone()):(f=this.selection.getParagraphInfo(l.start),g=this.selection.start.clone()),m=f.paragraph.getLength(),u=f.offset,this.skipReplace=!0),d=this.removeSelectedContents(l),this.skipReplace=!1,!sf.base.isNullOrUndefined(g)&&this.owner.search&&this.owner.search.isRepalceTracking)this.owner.search.isRepalceTracking=!1,this.selection.start.setPositionInternal(this.selection.start),this.selection.end.setPositionInternal(g);else if(u>0&&u<=m){var y=f.paragraph.getLength();m!==y&&(u-=m-y),this.setPositionParagraph(f.paragraph,u,!0)}l.skipFormatRetrieval=!1,l.isSkipLayouting=!1}else!l.isEmpty||this.documentHelper.isListTextSelected||t||(this.documentHelper.isTextInput=!0);(h=this.selection.getParagraphInfo(l.start)).paragraph.paragraphFormat.copyFormat(c);var v=this.documentHelper.textHelper.containsSpecialCharAlone(e);if(d){if(l.owner.isShiftingEnabled=!0,this.updateInsertPosition(),(a=l.start).paragraph.isEmpty()){var w=new Fa,b=this.copyInsertFormat(a.paragraph.characterFormat,!0);w.characterFormat.copyFormat(b),w.text=e;var I=this.documentHelper.textHelper.getRtlLanguage(e).isRtl||this.selection.characterFormat.bidi;if(w.characterFormat.bidi=I,w.isRightToLeft=I,w.line=a.paragraph.childWidgets[0],w.margin=new na(0,0,0,0),w.line.children.push(w),this.owner.enableTrackChanges)if(w.paragraph.characterFormat.revisions.length>0){var F=this.getMatchedRevisionsToCombine(w.paragraph.characterFormat.revisions,i);F.length>0&&this.mapMatchedRevisions(F,w.paragraph.characterFormat,w,!0)}else this.checkToCombineRevisionWithPrevPara(w,i)||this.insertRevision(w,i);("Center"===a.paragraph.paragraphFormat.textAlignment||"Right"===a.paragraph.paragraphFormat.textAlignment||"Justify"===a.paragraph.paragraphFormat.textAlignment&&a.paragraph.paragraphFormat.bidi)&&-1===a.paragraph.paragraphFormat.listFormat.listId&&(a.paragraph.x=a.paragraph.clientX,a.paragraph.clientX=void 0,a.paragraph.hasOwnProperty("absoluteXPosition")&&delete a.paragraph.absoluteXPosition),w instanceof Fa&&w.text.length>90&&x.splitWordByMaxLength(w,w.line),this.documentHelper.layout.reLayoutParagraph(a.paragraph,0,0)}else{var C=0,W=a.currentWidget.getInline(a.offset,C,p,!t,this.documentHelper.owner.isSpellCheck),k=W.element;C=W.index,k.ischangeDetected=!0,k instanceof Fa&&" "!==e&&this.documentHelper.owner.isSpellCheck&&(this.owner.spellChecker.removeErrorsFromCollection({element:k,text:k.text}),t||(k.ignoreOnceItems=[])),k.canTrigger&&k.text.length<=1&&(k.canTrigger=!1);b=this.copyInsertFormat(k.characterFormat,!0),I=this.documentHelper.textHelper.getRtlLanguage(e).isRtl||this.selection.characterFormat.bidi,this.documentHelper.textHelper.getRtlLanguage(e).id;var S=0,P=!1,N=!1;if(k instanceof Fa&&(S=this.documentHelper.textHelper.getRtlLanguage(k.text).id,P=this.documentHelper.textHelper.getRtlLanguage(k.text).isRtl,N=this.documentHelper.textHelper.containsSpecialCharAlone(e)),(!I&&k.characterFormat.bidi&&(0!==S||N&&P)||" "===e&&this.selection.characterFormat.bidi)&&(I=!0),!I&&this.documentHelper.owner.isSpellCheck||(b.bidi=I),(!this.documentHelper.owner.isSpellCheck||" "!==e&&" "!==k.text)&&b.isSameFormat(k.characterFormat)&&this.canInsertRevision(k,i)||""===e.trim()&&!I&&k.characterFormat.bidi||P&&b.isSameFormat(k.characterFormat)&&v)this.insertTextInline(k,l,e,C);else{var O=new Fa;O.text=e,O.line=k.line,O.isRightToLeft=P,O.characterFormat.copyFormat(b),k instanceof Wa&&(O.characterFormat.baselineAlignment="Normal");var T=!1,H=k.indexInOwner,E=O.revisions.length;if(C===k.length){var R;R=H+1,!this.owner.enableTrackChanges||k instanceof Na||(T=this.checkToMapRevisionWithInlineText(k,C,O,I,i))||O.revisions.length!==E||(T=null!=k.nextNode&&1==k.nextNode.revisions.length?this.checkToMapRevisionWithNextNode(k.nextNode,O,I,i):1==k.paragraph.characterFormat.revisions.length&&"Deletion"==k.paragraph.characterFormat.revisions[0].revisionType?this.checkToMapRevisionWithNextNode(k.nextNode,O,I,i,k.paragraph):this.checkToMapRevisionWithNextNode(k.nextNode,O,I,i)),T||(k.line.children.splice(R,0,O),this.checkToCombineRevisionsinBlocks(O,E===O.revisions.length,!0,i))}else if(0===C)this.owner.enableTrackChanges&&((T=this.checkToMapRevisionWithInlineText(k,C,O,I,i))||0!==O.revisions.length||this.checkToMapRevisionWithPreviousNode(k.previousNode,O,I,i)),T||(k.line.children.splice(H,0,O),this.checkToCombineRevisionsinBlocks(O,E===O.revisions.length,!0,i));else{if(k instanceof Fa){var U=new Fa;U.line=k.line,U.characterFormat.copyFormat(k.characterFormat),U.text=k.text.substring(C),this.owner.enableTrackChanges||this.selection.isInField||this.updateRevisionForSpittedTextElement(k,U),k.text=k.text.slice(0,C),this.owner.enableTrackChanges?(T=this.checkToMapRevisionWithInlineText(k,C,O,I,i))||O.revisions.length>E?this.copyElementRevision(k,U,!0):O.revisions.length===E&&(this.updateRevisionForSpittedTextElement(k,U),this.insertRevision(O,i)):this.selection.isInField&&(this.copyElementRevision(k,U,!1),this.updateElementInFieldRevision(k,O,k.revisions,!0)),this.owner.isSpellCheck&&this.owner.spellChecker.updateSplittedElementError(k,U),k.line.children.splice(H+1,0,U)}T||k.line.children.splice(H+1,0,O)}O instanceof Fa&&O.text.length>90&&x.splitWordByMaxLength(O,O.line),(sf.base.isNullOrUndefined(i)||"Deletion"!==i||a.paragraph.isLayouted)&&this.documentHelper.layout.reLayoutParagraph(a.paragraph,k.line.indexInOwner,0)}}this.documentHelper.layout.allowLayout=!0,this.setPositionParagraph(h.paragraph,h.offset+e.length,!0),this.updateEndPosition(),sf.base.isNullOrUndefined(this.editorHistory)||sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"ListSelect"!==this.editorHistory.currentHistoryInfo.action||!this.documentHelper.isListTextSelected||(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()),(sf.base.isNullOrUndefined(i)||"Insertion"===i)&&this.reLayout(l),this.documentHelper.isTextInput=!1,this.documentHelper.isTextFormEmpty=!1}if(this.updateXmlMappedContentControl(),!t&&d&&(" "===e||"\t"===e||"\v"===e)){var B=!1;if("\v"!==e&&(B=this.checkAndConvertList(l,"\t"===e)),!B){if(!sf.base.isNullOrUndefined(l.getHyperlinkField()))return;this.checkAndConvertToHyperlink(l,!1)}}}},e.prototype.extendSelectionToBookmarkStart=function(){if(this.documentHelper.bookmarks.length>0){var e=this.selection.start;this.selection.end;this.selection.isForward||(e=this.selection.end,this.selection.start);for(var t=void 0,i=this.selection.bookmarks,r=0;r<i.length;r++)if(t=this.documentHelper.bookmarks.get(i[r]),this.selection.isElementInSelection(t.reference,!1)&&!this.selection.isElementInSelection(t,!0)){var n=t.line.paragraph,o=this.selection.getParagraphInfo(e);if(n.equals(o.paragraph)){var s=t.line.getOffset(t,t.bookmarkType);t.line===e.currentWidget&&o.offset===s+1&&e.offset--}}}},e.prototype.updateElementInFieldRevision=function(e,t,i,r){for(var n=0;n<i.length;n++){var o=i[n],s=o.range.indexOf(e);o.range.splice(r?s+1:s,0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(o)}},e.prototype.retrieveFieldResultantText=function(e){var t="";if(1===e.fieldType)for(var i=e.previousElement;!sf.base.isNullOrUndefined(i)&&i instanceof Fa;)t=i.text+t,i=sf.base.isNullOrUndefined(i.previousNode)?void 0:i.previousNode.previousValidNodeForTracking;return t},e.prototype.checkToCombineRevisionsinBlocks=function(e,t,i,r){if(t&&this.owner.enableTrackChanges&&!(e instanceof Na||e instanceof al||e instanceof _a||e instanceof qa)){(i?this.combineRevisionWithNextPara(e,r):this.combineRevisionWithPrevPara(e,r))||this.insertRevision(e,r)}},e.prototype.checkToMapRevisionWithNextNode=function(e,t,i,r,n){if(!sf.base.isNullOrUndefined(n)&&1==n.characterFormat.revisions.length){var o=n.characterFormat;return!sf.base.isNullOrUndefined(o)&&this.checkToMapRevisionWithInlineText(void 0,0,t,i,r,o)}if(sf.base.isNullOrUndefined(e))return!1;var s=e.nextValidNodeForTracking;return!sf.base.isNullOrUndefined(s)&&this.checkToMapRevisionWithInlineText(s,0,t,i,r)},e.prototype.checkToMapRevisionWithPreviousNode=function(e,t,i,r){if(sf.base.isNullOrUndefined(e))return!1;var n=e.previousValidNodeForTracking;return!sf.base.isNullOrUndefined(n)&&this.checkToMapRevisionWithInlineText(n,n.length,t,i,r)},e.prototype.checkToMapRevisionWithInlineText=function(e,t,i,r,n,o){if(sf.base.isNullOrUndefined(o)){if(!sf.base.isNullOrUndefined(e))if("Deletion"===n&&this.updateLastElementRevision(i),e.length===t&&null!=e.previousValidNodeForTracking){if(t=(e=e.previousValidNodeForTracking).length,e.revisions.length>0)return this.applyMatchedRevisionInorder(e,i,t,!1,r,n)}else if(0===t&&(e=e.nextValidNodeForTracking,!sf.base.isNullOrUndefined(e)&&e.revisions.length>0))return this.applyMatchedRevisionInorder(e,i,t,!0,r,n)}else if("Deletion"===n&&this.updateLastElementRevision(i),!sf.base.isNullOrUndefined(o)&&o.revisions.length>0)return this.applyMatchedRevisionInorder(void 0,i,t,!0,r,n,o);return!1},e.prototype.combineElementRevisions=function(e,t){if(0!==e.revisions.length&&0!==t.revisions.length)for(var i=0;i<e.revisions.length;i++)for(var r=e.revisions[i],n=0;n<t.revisions.length;n++){var o=t.revisions[i];-1===r.range.indexOf(t)&&o.revisionType===r.revisionType&&o.author===r.author&&(t.revisions.splice(n,1),r.range.push(t),t.revisions.splice(n,0,r),this.owner.trackChangesPane.updateCurrentTrackChanges(r))}},e.prototype.applyMatchedRevisionInorder=function(e,t,i,r,n,o,s){var a;return!sf.base.isNullOrUndefined(s)&&sf.base.isNullOrUndefined(e)?((a=this.getMatchedRevisionsToCombine(s.revisions,o)).length>0&&this.mapMatchedRevisions(a,s,t,r),!1):((a=this.getMatchedRevisionsToCombine(e.revisions,o)).length>0&&this.mapMatchedRevisions(a,e,t,r),!1)},e.prototype.copyElementRevision=function(e,t,i){if(!this.isTrackingFormField)for(var r=0;r<e.revisions.length;r++){var n=e.revisions[r],o=n.range.indexOf(e);t.revisions.splice(0,0,n),n.range.splice(o+(i?2:1),0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(n)}},e.prototype.mapMatchedRevisions=function(e,t,i,r){for(var n=0;n<e.length;n++){var o=e[n];if(!this.isRevisionAlreadyIn(i,o)||i instanceof T){i.revisions.splice(0,0,o),i instanceof Wa&&this.insertRevisionForFootnoteWidget(i,o);var s=o.range.indexOf(t);o.range.splice(r?s:s+1,0,i),this.owner.trackChangesPane.updateCurrentTrackChanges(o)}}},e.prototype.isRevisionAlreadyIn=function(e,t){if(e.revisions.length>0)for(var i=0;i<e.revisions.length;i++){if(e.revisions[i].revisionID===t.revisionID)return!0}return!1},e.prototype.getMatchedRevisionsToCombine=function(e,t){for(var i=[],r=0;r<e.length;r++)this.isRevisionMatched(e[r],t)&&i.push(e[r]);return i},e.prototype.decideInlineForTrackChanges=function(e,t){var i=!1;if(this.owner.enableTrackChanges&&!this.canInsertRevision(e,t)){var r=e.nextValidNodeForTracking;!sf.base.isNullOrUndefined(r)&&this.canInsertRevision(r,t)&&(e=r,i=!0)}return{element:e,isMatched:i}},e.prototype.insertIMEText=function(e,t){if(this.documentHelper.lastComposedText!==e||!t){var i=this.selection.getParagraphInfo(this.selection.start),r=this.selection.getHierarchicalIndex(i.paragraph,i.offset.toString());this.insertText(e),this.documentHelper.lastComposedText=e;var n=this.selection.start;this.setPositionForCurrentIndex(n,r);var o=new Al(this.owner);o.setPositionForLineWidget(n.currentWidget,n.offset+e.length),this.owner.enableTrackChanges?(t||this.selection.start.setPositionInternal(this.selection.end),this.selection.end.updatePhysicalPosition(!0)):this.selection.selectPosition(t?n:o,o)}},e.prototype.insertSectionBreak=function(e){sf.base.isNullOrUndefined(e)&&(e=o.NewPage);var t=this.documentHelper.selection;sf.base.isNullOrUndefined(t)||this.owner.isReadOnlyMode||t.start.paragraph.isInHeaderFooter||(e===o.Continuous?this.initHistory("SectionBreakContinuous"):this.initHistory("SectionBreak"),t.isEmpty||t.selectContent(t.isForward?t.start:t.end,!0),this.documentHelper.owner.isShiftingEnabled=!0,this.updateInsertPosition(),e===o.Continuous?(this.documentHelper.layout.isSectionBreakCont=!0,this.insertSection(t,!0,void 0,!0)):this.insertSection(t,!0,void 0,void 0,!0),this.updateEndPosition(),this.reLayout(t,!0),this.layoutWholeDocument(!0),this.documentHelper.layout.isSectionBreakCont=!1)},e.prototype.combineRevisionWithBlocks=function(e,t){if(this.owner.enableTrackChanges&&!sf.base.isNullOrUndefined(e)){for(;e instanceof Na||e instanceof al||e instanceof Va;)e=e.nextElement;if(!sf.base.isNullOrUndefined(e)){var i=e instanceof ca?e.previousRenderedWidget:e.paragraph.previousRenderedWidget;if(!(i instanceof ga)){var r,n;if(r=e instanceof ca?e.characterFormat:e,!sf.base.isNullOrUndefined(i)&&i.characterFormat.revisions.length>0){var o=i.lastChild;if(sf.base.isNullOrUndefined(o)||0===o.children.length)return;for(var s=o.children[o.children.length-1];s instanceof Na||s instanceof al||s instanceof Va;)s=s.previousElement;if(i.isEmpty()&&(s=i.characterFormat),s.revisions.length>0&&this.compareElementRevision(i.characterFormat,r)){var a=r.revisions[r.revisions.length-1];if(this.compareElementRevision(s,r))a!==(h=s.revisions[s.revisions.length-1])&&(this.clearAndUpdateRevisons(a.range,h,h.range.indexOf(s)+1),this.owner.revisions.remove(a))}}if(e instanceof ca)n=e.characterFormat;else{for(o=e.paragraph.lastChild;0==o.children.length&&!sf.base.isNullOrUndefined(o.previousLine);)o=o.previousLine;e=null==(n=o.children[o.children.length-1])?e:n}var l=e instanceof ca?e.nextRenderedWidget:e.paragraph.nextRenderedWidget;if(!(l instanceof ga)){if(!sf.base.isNullOrUndefined(l)){for(var d=l.firstChild.children[0];d instanceof Na||d instanceof al||d instanceof Va;)d=d.nextElement;if(l.isEmpty()&&(d=l.characterFormat),sf.base.isNullOrUndefined(d))return;if(d.revisions.length>0){var h,c=d.revisions[d.revisions.length-1];if(this.compareElementRevision(r,d))if(this.compareElementRevision(r,d))c!==(h=r.revisions[r.revisions.length-1])&&(this.clearAndUpdateRevisons(c.range,h,h.range.indexOf(e)+1),this.owner.revisions.remove(c))}}e instanceof ya&&0===e.revisions.length&&this.insertRevision(e,t)}}}}},e.prototype.checkToCombineRevisionWithNextPara=function(e,t){var i=e.paragraph.nextRenderedWidget;if(i instanceof ga)return!1;if(!sf.base.isNullOrUndefined(i)&&!i.isEmpty()){for(var r=i.firstChild.children[0];r instanceof Na||r instanceof al;)r=r.previousElement;if(sf.base.isNullOrUndefined(r))return!1;if(r.revisions.length>0){var n=this.getMatchedRevisionsToCombine(r.revisions,t);if(n.length>0)return this.mapMatchedRevisions(n,r,e,!0),!0}}return!1},e.prototype.checkToCombineRevisionWithPrevPara=function(e,t){var i=e.paragraph.previousRenderedWidget;if(i instanceof ga)return!1;if(!sf.base.isNullOrUndefined(i)&&i.characterFormat.revisions.length>0){if(!this.isRevisionMatched(i.characterFormat,t))return!1;var r=this.getMatchedRevisionsToCombine(i.characterFormat.revisions,t);if(r.length>0)return this.mapMatchedRevisions(r,i.characterFormat,e,!1),!0}return!1},e.prototype.combineRevisionWithNextPara=function(e,t){var i=e.line.isLastLine(),r=e.nextNode;return!(!i||!sf.base.isNullOrUndefined(r))&&this.checkToCombineRevisionWithNextPara(e,t)},e.prototype.combineRevisionWithPrevPara=function(e,t){var i=e.line.isFirstLine(),r=e.previousNode;return!(!i||!sf.base.isNullOrUndefined(r))&&this.checkToCombineRevisionWithPrevPara(e,t)},e.prototype.removeRevision=function(e){var t=this.selection.start.currentWidget.getInline(this.selection.start.offset+1,0),i=t.element;if(t.element.revisions.length>0)for(var r=0;r<i.revisions.length;r++)if(i.revisions[r].revisionType===e.revisionType)for(var n=i.revisions[r],o=n.range.indexOf(i),s=o;o<n.range.length;o++)n.range[s].revisions.splice(r,1),n.range.splice(s,1),this.owner.trackChangesPane.updateCurrentTrackChanges(n)},e.prototype.clearElementRevision=function(e){if(!sf.base.isNullOrUndefined(e))for(var t=0;t<e.range.length;t++)if(e.range[t]instanceof ya){var i=e.range[t];i.revisions.splice(i.revisions.length-1,1),e.range.splice(t,1),this.owner.trackChangesPane.updateCurrentTrackChanges(e)}},e.prototype.insertRevision=function(e,t,i,r,n){i=sf.base.isNullOrUndefined(i)?this.owner.currentUser?this.owner.currentUser:"Guest user":i;var o=sf.base.isNullOrUndefined(r)?x.getUtcDate():r;if(e instanceof ya&&!sf.base.isNullOrUndefined(e.line)&&e.line.paragraph.associatedCell||e instanceof T&&e.ownerBase instanceof ca&&e.ownerBase.associatedCell){var s=void 0;if(e instanceof ya?s=e.line.paragraph.associatedCell:e instanceof T&&(s=e.ownerBase.associatedCell),s.ownerRow.rowFormat.revisions.length>0){var a=s.ownerRow.rowFormat,l=this.getMatchedRevisionsToCombine(a.revisions,t);if(l.length>0){for(var d=0;d<l.length;d++)e.revisions.splice(0,0,l[d]),l[d].range.push(e);return}}}var h=new N(this.owner,i,o);h.revisionType=t,h.revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),!sf.base.isNullOrUndefined(n)&&n.length>0&&this.clearAndUpdateRevisons(n,h,n.indexOf(e)),sf.base.isNullOrUndefined(e)||(e instanceof Wa&&this.insertRevisionForFootnoteWidget(e,h),e.revisions.push(h),h.range.push(e)),this.updateRevisionCollection(h)},e.prototype.insertRevisionForFootnoteWidget=function(e,t){var i=e.bodyWidget.childWidgets;this.skipFootNoteDeleteTracking=!0;for(var r=0;r<i.length;r++)this.insertRevisionForBlock(i[r],t.revisionType,!1,t);this.skipFootNoteDeleteTracking=!1},e.prototype.clearAndUpdateRevisons=function(e,t,i){t.range.filter((function(e){return e instanceof T}))&&(i+=1);for(var r=0;r<e.length;r++)if(e[r]instanceof ya||e[r]instanceof T){var n=e[r];n.revisions.splice(n.revisions.length-1,1),n.revisions.push(t),t.range.splice(i+r,0,n),this.owner.trackChangesPane.updateCurrentTrackChanges(t)}},e.prototype.splitRevisionByElement=function(e,t){if(e.revisions.length>0){var i=t.range,r=i.indexOf(e);return t.range=i.splice(0,r+1),this.owner.trackChangesPane.updateCurrentTrackChanges(t),i}},e.prototype.updateRevisionForSpittedTextElement=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i],n=this.splitRevisionByElement(e,r);this.insertRevision(t,r.revisionType,r.author,r.date,n)}},e.prototype.isRevisionMatched=function(e,t){var i=this.owner.currentUser?this.owner.currentUser:"Guest user";if(e instanceof N){if((sf.base.isNullOrUndefined(t)||t===e.revisionType)&&e.author===i)return!0}else if(e.revisions.length>0)for(var r=0;r<e.revisions.length;r++){var n=e.revisions[r];if((sf.base.isNullOrUndefined(t)||t===n.revisionType)&&n.author===i)return!0}return!1},e.prototype.compareElementRevision=function(e,t){if(0===e.revisions.length||0===t.revisions.length)return!1;for(var i=0;i<e.revisions.length;i++)for(var r=e.revisions[i],n=0;n<t.revisions.length;n++)if(r.author===t.revisions[n].author&&r.revisionType===t.revisions[n].revisionType)return!0;return!1},e.prototype.canInsertRevision=function(e,t){var i=sf.base.isNullOrUndefined(t)?"Insertion":t;return"Deletion"!==i&&(this.owner.enableTrackChanges?this.isRevisionMatched(e,i):!(e.revisions.length>0))},e.prototype.insertRevisionAtEnd=function(e,t,i){return!(t instanceof Na||t instanceof al||t instanceof _a||t instanceof qa)&&(e=e.previousValidNodeForTracking,!sf.base.isNullOrUndefined(e)&&this.insertRevisionAtPosition(e,t,!0,i))},e.prototype.insertRevisionAtPosition=function(e,t,i,r){var n=t.revisions.length,o=this.checkToMapRevisionWithInlineText(e,i?e.length:0,t,!1,r);return i?o||t.revisions.length!==n||(o=this.checkToMapRevisionWithNextNode(e.nextNode,t,!1,r)):o||t.revisions.length!==n||(o=this.checkToMapRevisionWithPreviousNode(e.previousNode,t,!1,r)),o},e.prototype.insertRevisionAtBegining=function(e,t,i){return!(t instanceof Na||t instanceof al||t instanceof _a||t instanceof qa)&&(e=e.nextValidNodeForTracking,!sf.base.isNullOrUndefined(e)&&this.insertRevisionAtPosition(e,t,!1,i))},e.prototype.splitRevisionForSpittedElement=function(e,t){for(var i=e.revisions.length-1;i>=0;i--){var r=e.revisions[i],n=this.splitRevisionByElement(e,r);this.insertRevision(t,r.revisionType,r.author,r.date,n)}},e.prototype.combineElementRevision=function(e,t){for(var i=0;i<e.length;i++)for(var r=0;r<t.length;r++){var n=e[i],o=t[r];if(n.author===o.author&&n.revisionType===o.revisionType){for(var s=o.range.length,a=0;a<s;a++){var l=o.range[0];l.revisions.splice(l.revisions.indexOf(o),1),o.range.splice(0,1),this.owner.trackChangesPane.updateCurrentTrackChanges(o),n.range.push(l),this.owner.trackChangesPane.updateCurrentTrackChanges(n),l.revisions.push(n)}0===o.range.length&&this.owner.revisions.remove(o)}}},e.prototype.combineRevisions=function(e,t,i){if(this.owner.enableTrackChanges){var r=this.selection.getLineInfo(e,t.offset).line.getInline(t.offset,0).element;if(r.revisions.length>0&&this.isRevisionMatched(r,"Insertion")){var n=r.nextElement;if(!sf.base.isNullOrUndefined(n)&&n.revisions.length>0){var o=r.revisions[r.revisions.length-1],s=n.revisions[n.revisions.length-1].range;o!==n.revisions[n.revisions.length-1]&&this.clearAndUpdateRevisons(s,o,o.range.indexOf(r)+1)}}}},e.prototype.insertRevisionForBlock=function(e,t,i,r,n){if(0!==e.childWidgets.length&&this.owner.enableTrackChanges)if("Deletion"===t){var o=this.selection.editPosition,s=this.selection.start.clone(),a=this.selection.end.clone();this.documentHelper.layout.clearListElementBox(e);var l=e==this.getLastParaForBodywidgetCollection(e),d=this.selection.getNextParagraphBlock(e);l||e.isInsideTable||sf.base.isNullOrUndefined(d)&&e.isEmpty()?!l&&e.isInsideTable&&s.paragraph.isInsideTable&&a.paragraph.isInsideTable&&a.offset<=a.paragraph.getLength()&&a.paragraph.associatedCell.index===s.paragraph.associatedCell.index&&(this.addRemovedNodes(e.clone()),this.insertRevision(e.characterFormat,t)):(sf.base.isNullOrUndefined(d)||d.isInsideTable||e.bodyWidget.sectionIndex===d.bodyWidget.sectionIndex||this.addRemovedNodes(e.bodyWidget),this.addRemovedNodes(e.clone()),this.insertRevision(e.characterFormat,t));for(var h=e.childWidgets.length-1;h>-1;h--){var c=e.childWidgets[h];this.removeContent(c,0,this.documentHelper.selection.getLineLength(c),void 0,!l)}for(var p=e.lastChild;0==p.children.length&&!sf.base.isNullOrUndefined(p.previousLine);)p=p.previousLine;if(p.children.length>0){var g=p.children[p.children.length-1];this.combineElementRevision(g.revisions,e.characterFormat.revisions)}this.selection.editPosition=o,this.selection.start.setPositionInternal(s),this.selection.end.setPositionInternal(a),this.removeEmptyLine(e),n||this.documentHelper.layout.reLayoutParagraph(e,0,0)}else{var f=!1;if(sf.base.isNullOrUndefined(r)){var u=this.owner.currentUser?this.owner.currentUser:"Guest user";(r=new N(this.owner,u,x.getUtcDate())).revisionID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),r.revisionType=t}for(h=0;h<e.childWidgets.length;h++){var m=e.childWidgets[h].children;if(0===m.length){var y=e.containerWidget.childWidgets.indexOf(e),v=void 0;if(y>0&&(v=e.containerWidget.childWidgets[y-1]),!sf.base.isNullOrUndefined(v)&&v instanceof ca&&v.characterFormat.revisions.length>0&&this.isRevisionMatched(v.characterFormat,t)){var w=this.getMatchedRevisionsToCombine(v.characterFormat.revisions,t);w.length>0&&(this.mapMatchedRevisions(w,v.characterFormat,e.characterFormat,!1),f=!0,r=void 0)}}for(var b=0;b<m.length;b++)if(0!==b||i)m[b].revisions.push(r),r.range.push(m[b]);else{var I=m[h].revisions.length;this.checkToCombineRevisionsinBlocks(m[h],!0,!1,"Insertion"),m[h].revisions.length>I?r=m[h].revisions[m[h].revisions.length-1]:(m[b].revisions.push(r),r.range.push(m[b]))}}i||f||(e.characterFormat.revisions.push(r),r.range.push(e.characterFormat)),sf.base.isNullOrUndefined(r)||(this.owner.trackChangesPane.updateCurrentTrackChanges(r),this.updateRevisionCollection(r))}},e.prototype.getLastParaForBodywidgetCollection=function(e){var t=e.containerWidget;if(t.containerWidget instanceof ha)return t.childWidgets[t.childWidgets.length-1];var i=this.documentHelper.pages[this.documentHelper.pages.length-1],r=i.bodyWidgets[i.bodyWidgets.length-1];return r.childWidgets[r.childWidgets.length-1]},e.prototype.updateRevisionCollection=function(e){var t=!1,i=void 0;if(this.owner.revisions.changes.indexOf(e)<0){if(this.documentHelper.revisionsInternal.containsKey(e.revisionID)||this.documentHelper.revisionsInternal.add(e.revisionID,e),this.owner.revisions.changes.length>0)for(var r=this.owner.selection.start,n=0;n<this.owner.revisions.changes.length;n++){var o=this.owner.revisions.changes[n].range[0];if(o instanceof ya&&!sf.base.isNullOrUndefined(o.line)&&o.line.paragraph.bodyWidget)i=this.selection.getElementPosition(this.owner.revisions.changes[n].range[0]).startPosition;else if(o instanceof k){var s=o.ownerBase.childWidgets[0],a=void 0;if(this.selection.getFirstParagraph(s).bodyWidget){var l=this.documentHelper.selection;sf.base.isNullOrUndefined(l.editPosition)||(a=l.editPosition),this.updateEditPosition(s,l),i=this.selection.getTextPosBasedOnLogicalIndex(l.editPosition),sf.base.isNullOrUndefined(a)||this.selection.start.paragraph.isInsideTable||(l.editPosition=a)}}else if(o instanceof T){var d=o.ownerBase;if(d.lastChild&&d.lastChild.paragraph.bodyWidget){var h=d.getLength(),c=new Al(this.owner);c.setPositionParagraph(d.lastChild,h),i=c}}if(sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(r)){if(e.range[0]instanceof k&&o instanceof k&&e.range[0].ownerBase.containerWidget===o.ownerBase.containerWidget&&e.range[0].ownerBase.index===o.ownerBase.index){t=!0,this.owner.revisions.changes.splice(n-e.range[0].ownerBase.indexInOwner,0,e);break}if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(r)&&(r.isExistBefore(i)||r.isAtSamePosition(i)||r.paragraph.isInsideTable&&i.paragraph.isInsideTable&&r.paragraph.associatedCell===i.paragraph.associatedCell)){if(o instanceof k&&e.range[0]instanceof k&&o.ownerBase.containerWidget===e.range[0].ownerBase.containerWidget){this.owner.revisions.changes.splice(n+e.range[0].ownerBase.indexInOwner,0,e),t=!0;break}if(e.range[0]instanceof k){this.owner.revisions.changes.splice(n,0,e),t=!0;break}}}else if(r.isExistBefore(i)&&!(e.range[0]instanceof k)){t=!0,this.owner.revisions.changes.splice(n,0,e);var p=new Ds(this.owner,this.owner.trackChangesPane);sf.base.isNullOrUndefined(this.owner.trackChangesPane.changesInfoDiv)||this.owner.trackChangesPane.changesInfoDiv.insertBefore(p.createSingleChangesDiv(e),this.owner.trackChangesPane.changesInfoDiv.children[n+1]),this.owner.trackChangesPane.revisions.splice(n,0,e),sf.base.isNullOrUndefined(this.owner.trackChangesPane.changes)||this.owner.trackChangesPane.changes.add(e,p),this.owner.trackChangesPane.renderedChanges.add(e,p);break}}if(!(t||(this.owner.revisions.changes.push(e),e.range[0]instanceof k))){p=new Ds(this.owner,this.owner.trackChangesPane);sf.base.isNullOrUndefined(this.owner.trackChangesPane.changesInfoDiv)||this.owner.trackChangesPane.changesInfoDiv.appendChild(p.createSingleChangesDiv(e)),this.owner.trackChangesPane.revisions.push(e),sf.base.isNullOrUndefined(this.owner.trackChangesPane.changes)||this.owner.trackChangesPane.changes.add(e,p),this.owner.trackChangesPane.renderedChanges.add(e,p)}this.documentHelper.updateAuthorIdentity()}},e.prototype.insertSection=function(e,t,i,r,n,o){var s,a,l,d=this.selection.start.paragraph;if(r&&!i&&!d.isInsideTable&&0===e.start.offset&&e.start.currentWidget===d.firstChild&&!sf.base.isNullOrUndefined(d.previousRenderedWidget)&&d.previousRenderedWidget instanceof ca&&d.previousRenderedWidget.isEndsWithPageBreak)return this.selection.start.paragraph.bodyWidget.sectionFormat.breakCode="NoBreak",this.selection.start.paragraph.index=0,this.updateNextBlocksIndex(this.selection.start.paragraph,!0),this.updateSectionIndex(this.selection.start.paragraph.bodyWidget.sectionFormat,this.selection.start.paragraph.bodyWidget,!0),this.selection.moveToNextParagraph(),this.editorHistory.currentBaseHistoryInfo.insertPosition=void 0,void this.updateInsertPosition();if(s=sf.base.isNullOrUndefined(o)?this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat():o,e.start.paragraph.isInsideTable){var h=this.documentHelper.layout.getParentTable(e.start.paragraph);h=h.combineWidget(this.owner.viewer);var c=!1;0===e.start.paragraph.associatedCell.rowIndex&&(c=!0);var p=new ca,g=h.previousRenderedWidget;c?a=h:(a=this.splitTable(h,e.start.paragraph.associatedCell.ownerRow),this.documentHelper.layout.layoutBodyWidgetCollection(a.index,a.containerWidget,a,!1),a=a.getSplitWidgets().pop());var f=0;!sf.base.isNullOrUndefined(g)&&g.bodyWidget.equals(a.bodyWidget)||!c?(f=a.indexInOwner+1,p.index=a.index+1):(f=0,p.index=0),a.containerWidget.childWidgets.splice(f,0,p),p.containerWidget=a.containerWidget,this.updateNextBlocksIndex(p,!0),this.documentHelper.layout.layoutBodyWidgetCollection(p.index,p.containerWidget,p,!1),a=p}else{var u=this.selection.getParagraphInfo(e.start),m=this.selection.getHierarchicalIndex(u.paragraph,u.offset.toString());i||this.splitParagraphInternal(e,e.start.paragraph,e.start.currentWidget,e.start.offset),this.setPositionForCurrentIndex(e.start,m),a=e.start.paragraph.getSplitWidgets().pop(),i&&void 0!==a.previousRenderedWidget&&(a=a.previousRenderedWidget)}return(l=this.splitBodyWidget(a.bodyWidget,s,a,r,n).firstChild)instanceof ga&&l.updateRowIndex(0),this.documentHelper.layout.layoutBodyWidgetCollection(l.index,l.containerWidget,l,!1),l instanceof ga&&(l=this.documentHelper.getFirstParagraphInFirstCell(l)),t&&e.selectParagraphInternal(l,!0),l},e.prototype.splitBodyWidget=function(e,t,i,r,n){var o=this.documentHelper.layout.moveBlocksToNextPage(i,!0,void 0,r);if(this.editorHistory.isUndoing&&(i.bodyWidget.sectionFormat=t),void 0===o.page)o.page=e.page,e.page.bodyWidgets.splice(e.page.bodyWidgets.indexOf(e)+1,0,o);else if(e.page.bodyWidgets.length>1&&void 0!==o.page&&!this.editorHistory.isUndoing){for(var s=o;!sf.base.isNullOrUndefined(e.nextRenderedWidget)&&o!==e.nextRenderedWidget;){var a=e.nextRenderedWidget.page.bodyWidgets.indexOf(e.nextRenderedWidget);o.page.bodyWidgets.push(e.nextRenderedWidget),e.nextRenderedWidget.page.bodyWidgets.splice(a,1)}for(;!sf.base.isNullOrUndefined(o.nextRenderedWidget);)o.nextRenderedWidget.page=o.page,o=o.nextRenderedWidget;(o=s).sectionFormat=new h(o),this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,o.sectionFormat),o.sectionFormat.breakCode="NewPage"}return r&&(o.sectionFormat=new h(o),this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,o.sectionFormat),o.sectionFormat.breakCode="NoBreak"),n&&(o.sectionFormat=new h(o),this.viewer.owner.parser.parseSectionFormat(0,e.sectionFormat,o.sectionFormat),o.sectionFormat.breakCode="NewPage"),this.updateSectionIndex(o.sectionFormat,o,!0),o.sectionFormat.numberOfColumns>1&&this.updateColumnIndex(o,!1),this.editorHistory&&!this.editorHistory.isUndoing&&this.insertRemoveHeaderFooter(o.sectionIndex,!0),this.updateBlockIndex(0,o.firstChild),this.owner.viewer.updateClientArea(o,o.page),o},e.prototype.insertRemoveHeaderFooter=function(e,t){this.documentHelper.headersFooters[e]?this.documentHelper.headersFooters.splice(e,0,{}):this.documentHelper.headersFooters[e]={}},e.prototype.updateBlockIndex=function(e,t){var i,r=t.bodyWidget.sectionIndex;do{i=t.getSplitWidgets();for(var n=0;n<i.length;n++)i[n].index=e;e++,t=i.pop().nextRenderedWidget}while(!sf.base.isNullOrUndefined(t)&&t.bodyWidget.sectionIndex===r)},e.prototype.updateSectionIndex=function(e,t,i){var r=t.sectionIndex,n=t;do{n.index===r&&e&&(n.sectionFormat=e),i?n.index++:n.index--,n=n.nextRenderedWidget}while(n)},e.prototype.updateColumnIndex=function(e,t){var i=e;do{if(!t&&0===i.columnIndex)break;if(t?i.columnIndex++:i.columnIndex--,!sf.base.isNullOrUndefined(i.nextRenderedWidget)&&i.sectionIndex!==i.nextRenderedWidget.sectionIndex)break;i=i.nextRenderedWidget}while(i)},e.prototype.checkAndConvertList=function(e,t){var i=e.paragraphFormat.getList();if(!sf.base.isNullOrUndefined(i)||e.start.paragraph.containerWidget instanceof ha)return!1;var r=!1,n=!1,o=0,s=e.start.currentWidget.getInline(e.start.offset-1,o),a=s.element;if(o=s.index,!(a instanceof Fa))return!1;for(var l=a,d=l.text.substring(0,o),h=0,c=0;!sf.base.isNullOrUndefined(l.previousNode);){if(!(l.previousNode instanceof Fa)||"\t"!==l.previousNode.text&&0!==l.previousNode.text.trim().length)return!1;"\t"===l.previousNode.text?h+=36:c=2.5*l.previousNode.text.length,l=l.previousNode}l=a;var p=0,g=d.lastIndexOf("\t");for(p=g>=0?g+1:d.lastIndexOf(" ")+1;l.previousNode instanceof Fa&&0===p;){var f=(l=l.previousNode).text;p=(g=f.lastIndexOf("\t"))>=0?g+1:f.lastIndexOf(" ")+1,d=(d=l.text+d).substring(p)}var u=(d=x.trimStart(d)).substring(1,2),m=void 0,y=this.getListLevelPattern(d.substring(0,1));if("None"!==y&&this.checkNumberFormat(u,"Bullet"===y,d)?r=!0:this.checkLeadingZero(d)?(n=!0,r=!0):(m=this.checkNextLevelAutoList(d),sf.base.isNullOrUndefined(m)||(r=!0)),!r||"Bullet"!==y||"- "!==a.text||sf.base.isNullOrUndefined(a.paragraph.previousWidget)||a.paragraph.previousWidget.firstChild.children[0]instanceof Va||(r=!1),r){this.initComplexHistory("AutoList");var v=a.paragraph;e.start.setPositionParagraph(v.childWidgets[0],v.childWidgets[0].getOffset(a,o+1)),e.end.setPositionParagraph(v.childWidgets[0],0),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!1);var w=t?"Tab":"Space";u=n?"%1"+d.substring(d.length-1,d.length):"%1"+u;var b=d.substring(d.length-3,d.length-1);y=n?this.getListLevelPattern(b):y;var I=new H(void 0);I.listLevelPattern=y,"Bullet"===y?"*"===d?(I.numberFormat=String.fromCharCode(61623),I.characterFormat.fontFamily="Symbol"):"-"===d&&(I.numberFormat="-"):I.numberFormat=u,I.followCharacter=w;var F=e.paragraphFormat.leftIndent;I.paragraphFormat.leftIndent=0!==h||0!==c?F+18+h+c:o>2?F+2.5*(o-2)+18:F>0?F+18:36,I.paragraphFormat.firstLineIndent=-18,!n&&"0"===d.substring(0,1)||"00"===b?I.startAt=0:I.startAt=1,sf.base.isNullOrUndefined(m)?this.autoConvertList(e,I):e.paragraphFormat.setList(m),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)?this.editorHistory.updateComplexHistory():this.reLayout(e)}return r},e.prototype.checkNextLevelAutoList=function(e){for(var t=this.documentHelper.selection,i=void 0,r=!1,n=t.start.paragraph,o=t.getPreviousParagraphBlock(n);!sf.base.isNullOrUndefined(o)&&o instanceof ca;){if(o.paragraphFormat.listFormat&&-1!==o.paragraphFormat.listFormat.listId){var s=o.paragraphFormat.listFormat.listLevelNumber;if(r=this.isConvertList(e,o)){this.listLevelNumber=s,this.isAutoList=!0;break}}o=t.getPreviousParagraphBlock(o,!0)}return r&&(i=this.documentHelper.getListById(o.paragraphFormat.listFormat.listId)),i},e.prototype.isConvertList=function(e,t){var i,r=!1,n=this.documentHelper.layout.getListNumber(t.paragraphFormat.listFormat,!0),o=n.substring(0,n.length-1),s=e.substring(0,e.length-1);if(n.substring(n.length-1)!==e.substring(e.length-1))r=!1;else if(s.match(/^[0-9]+$/)&&o.match(/^[0-9]+$/))i=parseInt(s,10),parseInt(o,10)!==i&&parseInt(o,10)+1!==i&&parseInt(o,10)+2!==i||(r=!0);else if(s.match(/^[a-zA-Z]+$/)&&o.match(/^[a-zA-Z]+$/))if(o.charCodeAt(0)===e.charCodeAt(0)||o.charCodeAt(0)+1===e.charCodeAt(0)||o.charCodeAt(0)+2===e.charCodeAt(0))r=!0;else if(s.match(/^[MDCLXVImdclxvi]+$/)&&o.match(/^[MDCLXVImdclxvi]+$/)){var a=this.getNumber(o.toUpperCase()),l=this.getNumber(s.toUpperCase());a!==l&&a+1!==l&&a+2!==l||(r=!0)}return r},e.prototype.getNumber=function(e){for(var t={M:1e3,D:500,C:100,L:50,X:10,V:5,I:1},i=e.split(""),r=0,n=0;n<i.length;n++){var o=t[i[n]];o<t[i[n+1]]?r-=o:r+=o}return r},e.prototype.getListLevelPattern=function(e){switch(e){case"0":case"1":return"Arabic";case"I":return"UpRoman";case"i":return"LowRoman";case"A":return"UpLetter";case"a":return"LowLetter";case"*":case"-":return"Bullet";case"00":case"01":return"LeadingZero";default:return"None"}},e.prototype.autoConvertList=function(e,t){e.start;e.isForward||e.end;var i=new u;this.documentHelper.lists.length>0?i.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:i.listId=0;var r=new W,n=this.documentHelper;n.abstractLists.length>0?r.abstractListId=n.abstractLists[n.abstractLists.length-1].abstractListId+1:r.abstractListId=0,i.abstractListId=r.abstractListId,i.abstractList=r,n.abstractLists.push(r),r.levels.push(t),t.ownerBase=r,e.paragraphFormat.setList(i),e.paragraphFormat.listLevelNumber=0},e.prototype.checkNumberFormat=function(e,t,i){if(t)return""===e;var r=i.indexOf(e);return("."===e||")"===e||">"===e||"-"===e)&&""===i.substring(r,i.length-1)},e.prototype.checkLeadingZero=function(e){for(var t,i=!1,r=0;r<=e.length-1;r++){if("0"!==e.charAt(r)){t=r;break}i=!0}var n=void 0;return n="1"===e.charAt(t)?e.charAt(t+1):e.charAt(t),i&&this.checkNumberFormat(n,!1,e)},e.prototype.getPageFromBlockWidget=function(e){var t=void 0;return e.containerWidget instanceof aa||e.containerWidget instanceof la?t=e.containerWidget.page:e.containerWidget instanceof ua&&(t=e.containerWidget.bodyWidget.page),t},e.prototype.insertTextInline=function(e,t,i,r,n){if(e instanceof Fa){if(e.text=x.insert(e.text,r,i),this.owner.enableTrackChanges){var o=e.revisions[0];this.owner.trackChangesPane.updateCurrentTrackChanges(o)}var s=e.line.paragraph,a=s.childWidgets.indexOf(e.line),l=e.line.children.indexOf(e);e instanceof Fa&&e.text.length>90&&x.splitWordByMaxLength(e,e.line),!sf.base.isNullOrUndefined(n)&&n||this.documentHelper.layout.reLayoutParagraph(s,a,l,e.line.paragraph.bidi)}else e instanceof Da?this.insertImageText(e,t,i,r):e instanceof va?0===e.fieldType?this.insertFieldBeginText(e,t,i,r):2===e.fieldType?this.insertFieldSeparatorText(e,t,i,r):this.insertFieldEndText(e,t,i,r):(e instanceof Na||e instanceof _a||e instanceof qa)&&this.insertBookMarkText(e,i)},e.prototype.insertFieldBeginText=function(e,t,i,r){var n=new Fa;n.text=i;var o=e.line.paragraph.childWidgets.indexOf(e.line),s=e.line.children.indexOf(e);n.characterFormat.copyFormat(e.characterFormat),e.line.children.splice(s,0,n),n.line=e.line,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,o,s)},e.prototype.insertBookMarkText=function(e,t){var i=new Fa;i.text=t;var r=e.line.paragraph.childWidgets.indexOf(e.line),n=e.line.children.indexOf(e);i.characterFormat.copyFormat(e.characterFormat),e instanceof qa||e instanceof Na?e.line.children.splice(n,0,i):e.line.children.splice(n+1,0,i),i.line=e.line,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,r,n)},e.prototype.insertFieldSeparatorText=function(e,t,i,r){var n=t.getPreviousTextInline(e),o=t.getNextTextInline(e),s=new Fa;s.text=i;var a=e.line.children.indexOf(e);r===e.length&&a++,sf.base.isNullOrUndefined(n)&&sf.base.isNullOrUndefined(o)?s.characterFormat.copyFormat(e.line.paragraph.characterFormat):sf.base.isNullOrUndefined(n)?s.characterFormat.copyFormat(o.characterFormat):s.characterFormat.copyFormat(n.characterFormat),e.line.children.splice(a,0,s),s.line=e.line;var l=e.line.paragraph.childWidgets.indexOf(e.line);this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,l,a)},e.prototype.insertFieldEndText=function(e,t,i,r){var n=new Fa;n.text=i;var o=e.line.children.indexOf(e);n.characterFormat.copyFormat(e.characterFormat),t.isInlineFormFillMode()&&0==r?e.line.children.splice(o,0,n):e.line.children.splice(o+1,0,n),n.line=e.line;var s=e.line.paragraph.childWidgets.indexOf(e.line);if(this.owner.enableTrackChanges){var a=this.documentHelper.textHelper.getRtlLanguage(i).isRtl,l=this.checkToMapRevisionWithInlineText(e,r,n,a,"Insertion");l||0!==n.revisions.length||(l=this.checkToMapRevisionWithNextNode(e.nextNode,n,a,"Insertion"))}this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,s,o)},e.prototype.insertImageText=function(e,t,i,r){var n=t.getPreviousTextInline(e),o=t.getNextTextInline(e),s=e.line,a=new Fa,l=s.paragraph,d=l.childWidgets.indexOf(s);a.text=i;var h=s.children.indexOf(e);r===e.length&&h++,sf.base.isNullOrUndefined(n)&&sf.base.isNullOrUndefined(o)?a.characterFormat.copyFormat(l.characterFormat):sf.base.isNullOrUndefined(n)?a.characterFormat.copyFormat(o.characterFormat):a.characterFormat.copyFormat(n.characterFormat),s.children.splice(h,0,a),a.line=s,this.documentHelper.layout.reLayoutParagraph(l,d,h)},e.prototype.isListTextSelected=function(){this.documentHelper.isListTextSelected&&(this.initComplexHistory("ListSelect"),this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat&&-1!==this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat.listId&&this.onApplyList(void 0))},e.prototype.checkAndConvertToHyperlink=function(e,t,i){var r,n;if(t)r=(n=i.lastChild.children[i.lastChild.children.length-1]).text;else{var o=0,s=e.start.currentWidget.getInline(e.start.offset-1,o),a=s.element;if(o=s.index,!(a instanceof Fa))return;r=(n=a).text.substring(0,o)}var l=0,d=r.lastIndexOf("\t");for(l=d>=0?d+1:r.lastIndexOf(" ")+1;n.previousElement instanceof Fa&&0===l;){var h=(n=n.previousNode).text;l=(d=h.lastIndexOf("\t"))>=0?d+1:h.lastIndexOf(" ")+1,r=n.text+r}var c=(r=r.substring(l)).toLowerCase(),p=!1;if("file:///"===c.substring(0,8)||"http://"===c.substring(0,7)&&c.length>7||"https://"===c.substring(0,8)&&c.length>8||"www."===c.substring(0,4)&&c.length>4||"\\"===c.substring(0,3)&&c.length>3||"mailto:"===c.substring(0,7)&&c.length>7)p=!0,"www."===c.substring(0,4)&&c.length>4&&(r="http://"+r);else{var g=r.indexOf("@"),f=r.indexOf(".");g>0&&g<f&&f<r.length-1&&(p=!0,r="mailto:"+r)}if(p){var u=new Al(this.documentHelper.owner);u.setPositionParagraph(n.line,n.line.getOffset(n,l));var m=new Al(this.documentHelper.owner);if(t)m.setPositionParagraph(n.line,n.line.getEndOffset());else if(0===e.end.currentWidget.children.length&&0===e.end.offset){var y=e.end.currentWidget.previousLine;m.setPositionParagraph(y,y.getEndOffset())}else m.setPositionParagraph(e.end.currentWidget,e.end.offset-1);this.autoFormatHyperlink(e,r,u,m)}},e.prototype.autoFormatHyperlink=function(e,t,i,r){this.initComplexHistory("AutoFormatHyperlink");var n=this.selection.getParagraphInfo(i),o=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=o),e.start.setPositionInternal(i),e.end.setPositionInternal(r);var s=this.getCharacterFormat(e),a=new T;a.copyFormat(s);var l=this.createHyperlinkElement(t,i,r,a);e.start.setPositionParagraph(l.line,l.line.getOffset(l,1)),e.start.moveNextPosition(),e.end.setPositionInternal(e.start),n=this.selection.getParagraphInfo(e.end);var d=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=d,this.editorHistory.updateComplexHistory(),this.reLayout(e)):this.updateComplexWithoutHistory(0,o,d)},e.prototype.appylingHyperlinkFormat=function(e){this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","Single",!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),this.initHistory("FontColor"),this.isForHyperlinkFormat=!0,this.updateCharacterFormatWithUpdate(e,"fontColor","#0563c1",!1),this.isForHyperlinkFormat=!1,this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1)},e.prototype.createHyperlinkElement=function(e,t,i,r){var n=this.selection;this.documentHelper.layout.allowLayout=!1,this.documentHelper.layout.isReplaceAll=!0,this.appylingHyperlinkFormat(n);var o=new va(1);o.characterFormat.copyFormat(r),o.line=n.end.currentWidget,n.start.setPositionInternal(n.end),this.initInsertInline(o),n.start.setPositionInternal(t),n.end.setPositionInternal(n.start);var s=this.insertHyperlinkfield(n,r,e),a=n.start.paragraph.childWidgets.indexOf(s.line),l=s.line.children.indexOf(s);return o.linkFieldCharacter(this.documentHelper),this.documentHelper.layout.isReplaceAll=!1,this.documentHelper.layout.allowLayout=!0,this.documentHelper.layout.reLayoutParagraph(n.start.paragraph,a,l),o},e.prototype.insertHyperlinkfield=function(e,t,i,r){var n=new va(0);n.characterFormat.copyFormat(t),n.line=e.start.currentWidget,this.initInsertInline(n);var o=new Fa;o.characterFormat.copyFormat(t),o.text=r?' HYPERLINK \\l "'+i+'" ':' HYPERLINK "'+i+'" ',o.line=e.start.currentWidget,this.initInsertInline(o);var s=new va(2);return s.characterFormat.copyFormat(t),s.line=e.start.currentWidget,this.initInsertInline(s),n},e.prototype.unlinkRangeFromRevision=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i],n=r.range.indexOf(e);n>=0&&(r.range.splice(n,1),this.owner.trackChangesPane.updateCurrentTrackChanges(r)),0===r.range.length&&t&&(this.owner.revisions.remove(r),this.isRemoveRevision&&this.documentHelper.revisionsInternal.containsKey(r.revisionID)&&(this.documentHelper.revisionsInternal.remove(r.revisionID),this.owner.trackChangesPane.updateTrackChanges()))}},e.prototype.unlinkWholeRangeInRevision=function(e,t){var i=t;e.revisions.splice(e.revisions.indexOf(e),1);for(var r=i.range.length,n=0;n<r;n++)i.range.splice(0,1),this.owner.trackChangesPane.updateCurrentTrackChanges(i);0===i.range.length&&(this.owner.revisions.remove(i),this.isRemoveRevision&&this.documentHelper.revisionsInternal.containsKey(i.revisionID)&&(this.documentHelper.revisionsInternal.remove(i.revisionID),this.owner.trackChangesPane.updateTrackChanges()))},e.prototype.unLinkFieldCharacter=function(e){if(e instanceof va&&0===e.fieldType&&e.fieldEnd&&(this.documentHelper&&(this.documentHelper.fieldToLayout=e,this.documentHelper.fieldEndParagraph=e.line.paragraph),e.fieldEnd&&(e.fieldEnd.fieldBegin=void 0),e.fieldEnd=void 0),e instanceof va&&2===e.fieldType)sf.base.isNullOrUndefined(e.fieldEnd)||(this.documentHelper&&(this.documentHelper.fieldToLayout=e.fieldBegin,this.documentHelper.fieldEndParagraph=e.line.paragraph),e.fieldBegin.fieldSeparator=void 0,e.fieldEnd.fieldSeparator=void 0);else if(e instanceof va&&1===e.fieldType&&e.fieldBegin){sf.base.isNullOrUndefined(this.documentHelper)||(this.documentHelper.fieldToLayout=e.fieldBegin,this.documentHelper.fieldEndParagraph=e.line.paragraph);var t=this.documentHelper.fields.indexOf(e.fieldBegin);-1!==t&&this.documentHelper.fields.splice(t,1);var i=this.documentHelper.formFields.indexOf(e.fieldBegin);-1!==i&&this.documentHelper.formFields.splice(i,1),e.fieldBegin.fieldEnd=void 0,e.fieldBegin=void 0}},e.prototype.getCharacterFormat=function(e){return e.start.paragraph.isEmpty()?e.start.paragraph.characterFormat:e.start.currentWidget.getInline(e.start.offset+1,0).element.characterFormat},e.prototype.insertHyperlink=function(e,t,i){(x.startsWith(e,"http://")||x.startsWith(e,"https://"))&&(e=e.replace(/\s/g,"")),sf.base.isNullOrUndefined(t)&&(t=e),sf.base.isNullOrUndefined(i)||(e=e+'" \\o "'+i),this.insertHyperlinkInternal(e,t,this.owner.selection.text!==t,!1)},e.prototype.insertHyperlinkInternal=function(e,t,i,r){var n=this.documentHelper.selection;if(n.start.paragraph.associatedCell===n.end.paragraph.associatedCell){var o=n.start,s=n.end;if(n.isForward||(o=n.end,s=n.start),s.offset==s.paragraph.getLength()+1&&s.movePreviousPosition(),i)this.insertHyperlinkInternalInternal(n,e,t,r);else{this.documentHelper.layout.allowLayout=!1;var a=new Al(this.documentHelper.owner);a.setPositionInternal(o);var l=this.getCharacterFormat(n),d=new T(void 0);d.copyFormat(l),this.initComplexHistory("InsertHyperlink");var h=this.selection.getParagraphInfo(o),c=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString())),this.appylingHyperlinkFormat(n),o.setPositionInternal(s);var p=new va(1);p.characterFormat.copyFormat(d),p.line=n.end.currentWidget,o.setPositionInternal(s),this.initInsertInline(p),o.setPositionInternal(a),s.setPositionInternal(o);var g=this.insertHyperlinkfield(n,d,e,r);p.linkFieldCharacter(this.documentHelper);var f=n.start.paragraph.childWidgets.indexOf(g.line),u=g.line.children.indexOf(g);this.documentHelper.layout.allowLayout=!0,this.documentHelper.layout.reLayoutParagraph(n.start.paragraph,f,u);var m=p.line;n.selects(m,m.getOffset(p,p.length),!0),h=this.selection.getParagraphInfo(s);var y=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString()),this.editorHistory.updateComplexHistory()):this.updateComplexWithoutHistory(1,c,y)}}},e.prototype.insertHyperlinkInternalInternal=function(e,t,i,r){if(!sf.base.isNullOrUndefined(e.start)&&!this.editHyperlink(e,t,i)){var n=this.getCharacterFormat(e);this.initHistory("InsertHyperlink");var o=!0;if(!e.isEmpty){var s=this.owner.enableTrackChanges;this.owner.enableTrackChanges=!1,o=this.removeSelectedContents(e),this.owner.enableTrackChanges=s}if(o){var a=new T;a.copyFormat(n),this.insertHyperlinkByFormat(e,t,i,a,r)}}},e.prototype.insertHyperlinkByFormat=function(e,t,i,r,n){this.updateInsertPosition(),e.owner.isShiftingEnabled=!0;var o=[],s=new va(0);o.push(s);var a=new Fa;a.text=n?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ',o.push(a);var l=new va(2);o.push(l),sf.base.isNullOrUndefined(i)||""===i||((a=new Fa).characterFormat.copyFormat(r),a.characterFormat.underline="Single",a.characterFormat.fontColor="#0563c1",a.text=i,o.push(a));var d=new va(1);o.push(d),this.insertElement(o),d.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(s)&&this.documentHelper.fields.push(s),e.selects(d.line,d.line.getOffset(d,d.length),!0),this.updateEndPosition(),this.reLayout(e,!0)},e.prototype.initInsertInline=function(e,t,i){var r=this.selection,n=!1;!this.isInsertingTOC&&i&&e instanceof Na&&(r.start.offset--,r.end.offset--,n=!0),this.initHistory("InsertInline"),this.insertInlineInSelection(r,e),this.editorHistory&&this.editorHistory.updateHistory(),n&&(r.start.offset++,r.end.offset++)},e.prototype.insertElementInCurrentLine=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),this.updateInsertPosition(),this.insertElement([t]),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},e.prototype.editHyperlink=function(e,t,i,r){var n=e.getHyperlinkField();if(sf.base.isNullOrUndefined(n))return!1;this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=sf.base.isNullOrUndefined(this.editorHistory)||this.editorHistory&&sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo);var o="",s=!1,a=this.getCharacterFormat(e),l=new T;l.copyFormat(a);var d=void 0;if(!sf.base.isNullOrUndefined(n.fieldSeparator)){d=n.fieldSeparator;var h=e.getHyperlinkDisplayText(n.fieldSeparator.line.paragraph,n.fieldSeparator,n.fieldEnd,s,l);o=h.displayText,s=h.isNestedField,l=h.format}var c=n.line.getOffset(n,0);if(e.start.setPositionParagraph(n.line,c),c=n.fieldEnd.line.getOffset(n.fieldEnd,1),e.end.setPositionParagraph(n.fieldEnd.line,c),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(e,!1),!s&&o!==i||sf.base.isNullOrUndefined(d))this.insertHyperlinkByFormat(e,t,i,l,r),this.skipFieldDeleteTracking=!1;else{this.updateInsertPosition();var p=new va(0);p.characterFormat.copyFormat(n.characterFormat),p.line=e.start.currentWidget,this.insertInlineInternal(p);var g=new Fa;g.characterFormat.copyFormat(n.characterFormat),g.text=r?' HYPERLINK \\l "'+t+'" ':' HYPERLINK "'+t+'" ',g.line=e.start.currentWidget,this.insertInlineInternal(g);var f=this.editorHistory&&this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo.removedNodes:this.nodes;this.insertClonedFieldResult(e,f,d),e.end.currentWidget.getInline(e.end.offset,0).element.linkFieldCharacter(this.documentHelper),this.skipFieldDeleteTracking=!1;var u=p.line.paragraph,m=p.line.paragraph.childWidgets.indexOf(p.line),y=p.line.children.indexOf(p);this.documentHelper.layout.reLayoutParagraph(u,m,y),c=p.fieldEnd.line.getOffset(p.fieldEnd,1),e.selects(p.fieldEnd.line,c,!0),this.updateEndPosition(),this.reLayout(e,!0)}return this.editHyperlinkInternal=!1,this.nodes=[],!0},e.prototype.insertClonedFieldResult=function(e,t,i){for(var r=!1,n=t.length-1;n>-1;n--){var o=t[n];if(!r){if(i!==o){if(o instanceof ca&&o===i.line.paragraph){r=!0;var s=void 0;if(n===t.length-1){s=e.start.paragraph;var a=i.line.paragraph;this.getClonedFieldResultWithSel(a,e,i)}else s=this.getClonedFieldResult(i.line.paragraph,i),this.insertParagraph(s,!0);e.selectParagraphInternal(e.getNextParagraphBlock(s),!0)}continue}r=!0}o instanceof ya?this.insertInlineInternal(o.clone()):o instanceof da&&this.insertBlock(o.clone())}},e.prototype.getClonedFieldResultWithSel=function(e,t,i){for(var r=e.childWidgets.indexOf(i.line),n=e.childWidgets[r].children.indexOf(i),o=r;o<e.childWidgets.length;o++){var s=e.childWidgets[o];o!==r&&(n=0);for(var a=n;a<s.children.length;a++)this.insertInlineInternal(s.children[a].clone())}},e.prototype.getClonedFieldResult=function(e,t){var i=new ca;i.characterFormat.copyFormat(e.characterFormat),i.paragraphFormat.copyFormat(e.paragraphFormat);for(var r=e.childWidgets.indexOf(t.line),n=e.childWidgets[r].children.indexOf(t),o=r;o<e.childWidgets.length;o++){var s=e.childWidgets[o];o!==r&&(n=0);for(var a=n;a<s.children.length;a++)i.childWidgets[0].children.push(s.children[a])}return i},e.prototype.removeHyperlink=function(){if(!this.owner.isReadOnlyMode){var e=this.selection,t=e.getHyperlinkField();if(!sf.base.isNullOrUndefined(t)){var i=t.fieldEnd,r=t.fieldSeparator,n=new Al(e.owner);n.setPositionParagraph(t.line,t.line.getOffset(t,0));var o=this.selection.getParagraphInfo(n),s=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),a=new Al(e.owner);a.setPositionParagraph(r.line,r.line.getOffset(r,r.length)),o=this.selection.getParagraphInfo(a);var l=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());this.initComplexHistory("RemoveHyperlink"),e.start.setPositionParagraph(i.line,i.line.getOffset(i,0)),o=this.selection.getParagraphInfo(e.start);var d=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());e.end.setPositionInternal(e.start),this.delete(),e.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(l)),this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","None",!1),this.editorHistory&&this.editorHistory.updateHistory(),e.end.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(d)),this.initHistory("FontColor"),this.updateCharacterFormatWithUpdate(e,"fontColor",void 0,!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),e.end.setPositionInternal(e.start),e.start.setPositionInternal(this.selection.getTextPosBasedOnLogicalIndex(s)),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!0),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory()}}},e.prototype.updateHyperlinkFormat=function(e){var t=e.getHyperlinkField();if(!sf.base.isNullOrUndefined(t)){var i=t.fieldEnd,r=t.fieldSeparator;e.start.setPositionParagraph(r.line,r.line.getOffset(r,r.length)),e.end.setPositionParagraph(i.line,i.line.getOffset(i,0)),this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","Single",!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),this.initHistory("FontColor"),this.isForHyperlinkFormat=!0,this.updateCharacterFormatWithUpdate(e,"fontColor","#0563c1",!1),this.isForHyperlinkFormat=!1,this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1)}},e.prototype.pasteInternal=function(e,t){if(this.currentPasteOptions=this.owner.defaultPasteOption,this.isHtmlPaste=!1,this.documentHelper.owner.enableLocalPaste)this.paste();else{this.selection.isViewPasteOptions=!0,this.selection.pasteElement&&(this.selection.pasteElement.style.display="none"),sf.base.isNullOrUndefined(t)&&(t=window);var i,r="",n="",o=t.clipboardData?t.clipboardData:e.clipboardData;if("msie"!==sf.base.Browser.info.name&&(n=o.getData("Text/Rtf"),r=o.getData("Text/Html")),this.copiedTextContent=i=o.getData("Text"),this.previousCharFormat=new T,this.previousCharFormat.copyFormat(this.selection.start.paragraph.characterFormat),this.previousParaFormat=new ul,this.previousParaFormat.copyFormat(this.selection.start.paragraph.paragraphFormat),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()&&(r="",n=""),""!==n)this.pasteAjax(n,".rtf");else if(""!==r){this.isHtmlPaste=!0;var s=(new DOMParser).parseFromString(r,"text/html"),a=(new XMLSerializer).serializeToString(s);if(-1!==(a=(a=(a=a.replace(/<!--StartFragment-->/gi,"")).replace(/<!--EndFragment-->/gi,"")).replace('xmlns="http://www.w3.org/1999/xhtml"',"")).indexOf("iscreatedusinghtmlspantag")){var l=(new DOMParser).parseFromString(a,"text/html"),d=l.querySelectorAll(".iscreatedusinghtmlspantag"),h=l.querySelector("body > p:last-child");d.length>0&&h&&h===d[d.length-1]&&(d[d.length-1].remove(),a=l.documentElement.outerHTML)}this.pasteAjax(a,".html")}else if(null!==i&&""!==i)this.selection.currentPasteAction="TextOnly",this.pasteContents(i),this.applyPasteOptions(this.currentPasteOptions,!0),this.copiedContent=void 0,this.documentHelper.editableDiv.innerHTML="";else if("msie"!==sf.base.Browser.info.name&&void 0!==o.items&&0!==o.items.length)for(var c=0;c<o.items.length;c++){var p=o.items[c];("image/png"===p.type||"image/svg+xml"===p.type&&"string"!==p.kind)&&this.pasteImage(p.getAsFile())}else"msie"===sf.base.Browser.info.name&&void 0!==o.files&&0!==o.files.length&&"image/png"===o.files[0].type&&this.pasteImage(o.files[0])}},e.prototype.pasteImage=function(e){var t=this,i=new FileReader;i.onload=function(){t.onPasteImage(i.result)},i.readAsDataURL(e)},e.prototype.onPasteImage=function(e){var t=document.createElement("img"),i=this;t.addEventListener("load",(function(){i.insertImageInternal(e,!0,this.width,this.height,this.alt)})),t.src=e},e.prototype.pasteAjax=function(e,t){var i={content:e,type:t,dataId:this.owner.dataId};this.pasteRequestHandler=new M,this.owner.documentHelper.viewerContainer.focus(),this.pasteRequestHandler.url=this.owner.serviceUrl+this.owner.serverActionSettings.systemClipboard,this.pasteRequestHandler.responseType="json",this.pasteRequestHandler.contentType="application/json;charset=UTF-8",this.pasteRequestHandler.customHeaders=this.owner.headers,this.pasteRequestHandler.onSuccess=this.pasteFormattedContent.bind(this),this.pasteRequestHandler.onFailure=this.onPasteFailure.bind(this),this.pasteRequestHandler.onError=this.onPasteFailure.bind(this),this.pasteRequestHandler.send(i)},e.prototype.pasteFormattedContent=function(e){var t=this;this.isPasteListUpdated&&(this.isPasteListUpdated=!1),this.pasteContents(sf.base.isNullOrUndefined(e.data)?this.copiedTextContent:x.getSfdtDocument(e.data)),"KeepSourceFormatting"!==this.currentPasteOptions&&this.applyPasteOptions(this.currentPasteOptions),setTimeout((function(){sf.base.isNullOrUndefined(t.viewer)||(t.documentHelper.isScrollHandler=!0,t.isPasteContentCheck=!0,t.viewer.updateScrollBars(),t.documentHelper.isScrollHandler=!1,t.isPasteContentCheck=!1)}),0)},e.prototype.onPasteFailure=function(e){this.owner.fireServiceFailure(e),console.error(e.status,e.statusText),this.documentHelper.updateFocus()},e.prototype.paste=function(e,t){var i=this;if(sf.base.isNullOrUndefined(e)&&(e=this.owner.enableLocalPaste?this.copiedData:void 0),sf.base.isNullOrUndefined(t)||(this.currentPasteOptions=t),e){var r=x.getSfdtDocument(e);this.pasteContents(r),this.applyPasteOptions(this.currentPasteOptions),this.chartType&&(setTimeout((function(){sf.base.isNullOrUndefined(i.viewer)||i.viewer.updateScrollBars()}),30),this.chartType=!1)}},e.prototype.getUniqueListOrAbstractListId=function(e){if(e&&this.documentHelper.lists.length){var t=this.documentHelper.lists.slice().sort((function(e,t){return e.listId-t.listId}));return t[t.length-1].listId+1}if(this.documentHelper.abstractLists.length){var i=this.documentHelper.abstractLists.slice().sort((function(e,t){return e.abstractListId-t.abstractListId}));return i[i.length-1].abstractListId+1}return 0},e.prototype.checkSameLevelFormat=function(e,t,i){return t[Lo[this.keywordIndex]][e][Oo[this.keywordIndex]]===i.abstractList.levels[e].listLevelPattern&&t[Lo[this.keywordIndex]][e][Uo[this.keywordIndex]]===i.abstractList.levels[e].numberFormat&&(t[Lo[this.keywordIndex]][e][Oo[this.keywordIndex]]===(1==this.keywordIndex?10:"Bullet")||t[Lo[this.keywordIndex]][e][Ho[this.keywordIndex]]===i.abstractList.levels[e].startAt)},e.prototype.listLevelPatternInCollection=function(e,t){var i=this;return this.documentHelper.lists.filter((function(r){return r.abstractList.levels[e].listLevelPattern===t[Oo[i.keywordIndex]]&&r.abstractList.levels[e].numberFormat===t[Uo[i.keywordIndex]]&&(t[Oo[i.keywordIndex]]===(1==i.keywordIndex?10:"Bullet")||r.abstractList.levels[e].startAt===t[Ho[i.keywordIndex]])&&i.isEqualParagraphFormat(r.abstractList.levels[e].paragraphFormat,t[_[i.keywordIndex]])}))[0]},e.prototype.isEqualParagraphFormat=function(e,t){return!(sf.base.isNullOrUndefined(t[Je[this.keywordIndex]])&&0!==e.leftIndent||!sf.base.isNullOrUndefined(t[Je[this.keywordIndex]])&&Math.round(e.leftIndent)!==Math.round(t[Je[this.keywordIndex]]))&&(!(sf.base.isNullOrUndefined(t[Ye[this.keywordIndex]])&&0!==e.rightIndent||!sf.base.isNullOrUndefined(t[Ye[this.keywordIndex]])&&Math.round(e.rightIndent)!==Math.round(t[Ye[this.keywordIndex]]))&&(!(sf.base.isNullOrUndefined(t[Ze[this.keywordIndex]])&&0!==e.firstLineIndent||!sf.base.isNullOrUndefined(t[Ze[this.keywordIndex]])&&Math.round(e.firstLineIndent)!==Math.round(t[Ze[this.keywordIndex]]))&&(!(sf.base.isNullOrUndefined(t[et[this.keywordIndex]])&&0!==e.beforeSpacing||!sf.base.isNullOrUndefined(t[et[this.keywordIndex]])&&Math.round(e.beforeSpacing)!==Math.round(t[et[this.keywordIndex]]))&&(!(sf.base.isNullOrUndefined(t[$e[this.keywordIndex]])&&0!==e.afterSpacing||!sf.base.isNullOrUndefined(t.afterSpacing)&&Math.round(e.afterSpacing)!==Math.round(t[$e[this.keywordIndex]]))&&(!(sf.base.isNullOrUndefined(t[Qe[this.keywordIndex]])&&"Left"!==e.textAlignment||!sf.base.isNullOrUndefined(t[Qe[this.keywordIndex]])&&e.textAlignment!==t[Qe[this.keywordIndex]])&&(!(sf.base.isNullOrUndefined(t[Re[this.keywordIndex]])&&!1!==e.bidi||!sf.base.isNullOrUndefined(t[Re[this.keywordIndex]])&&e.bidi!==t[Re[this.keywordIndex]])&&(!(sf.base.isNullOrUndefined(t[ht[this.keywordIndex]])&&!1!==e.contextualSpacing||!sf.base.isNullOrUndefined(t.contextualSpacing)&&e.contextualSpacing!==t[ht[this.keywordIndex]])&&(!(sf.base.isNullOrUndefined(t[st[this.keywordIndex]])&&!1!==e.keepWithNext||!sf.base.isNullOrUndefined(t[st[this.keywordIndex]])&&e.keepWithNext!==t[st[this.keywordIndex]])&&(!(sf.base.isNullOrUndefined(t[lt[this.keywordIndex]])&&!1!==e.keepLinesTogether||!sf.base.isNullOrUndefined(t[lt[this.keywordIndex]])&&e.keepLinesTogether!==t[lt[this.keywordIndex]])&&(!(sf.base.isNullOrUndefined(t[at[this.keywordIndex]])&&!1!==e.widowControl||!sf.base.isNullOrUndefined(t[at[this.keywordIndex]])&&e.widowControl!==t[at[this.keywordIndex]])&&(!(sf.base.isNullOrUndefined(t[dt[this.keywordIndex]])&&"BodyText"!==e.outlineLevel||!sf.base.isNullOrUndefined(t[dt[this.keywordIndex]])&&e.outlineLevel!==t[dt[this.keywordIndex]])&&(!(sf.base.isNullOrUndefined(t[rt[this.keywordIndex]])&&1!==e.lineSpacing||!sf.base.isNullOrUndefined(t[rt[this.keywordIndex]])&&Math.round(e.lineSpacing)!==Math.round(t[rt[this.keywordIndex]]))&&!(sf.base.isNullOrUndefined(t[nt[this.keywordIndex]])&&"Multiple"!==e.lineSpacingType||!sf.base.isNullOrUndefined(t[nt[this.keywordIndex]])&&e.lineSpacingType!==t[nt[this.keywordIndex]])))))))))))))},e.prototype.getBlocksToUpdate=function(e){for(var t=[],i=0;i<e.length;i++){var r=e[i];if(r[_[this.keywordIndex]]&&r[_[this.keywordIndex]][ot[this.keywordIndex]]&&Object.keys(r[_[this.keywordIndex]][ot[this.keywordIndex]]).length>0)t.push(r);else if(r[oo[this.keywordIndex]])for(var n=0;n<r[oo[this.keywordIndex]].length;n++)for(var o=r[oo[this.keywordIndex]][n],s=0;s<o[no[this.keywordIndex]].length;s++){var a=o[no[this.keywordIndex]][s];t=t.concat(this.getBlocksToUpdate(a[xo[this.keywordIndex]]))}}return t},e.prototype.updateListIdForBlocks=function(e,t,i,r,n){for(var o=!1,s=0;s<e.length;s++){var a=e[s];if(a[_[this.keywordIndex]]&&a[_[this.keywordIndex]][ot[this.keywordIndex]]&&Object.keys(a[_[this.keywordIndex]][ot[this.keywordIndex]]).length>0){var l=a[_[this.keywordIndex]][ot[this.keywordIndex]],d=this.listLevelPatternInCollection(l[Xe[this.keywordIndex]],t[Lo[this.keywordIndex]][l[Xe[this.keywordIndex]]]);l[Ke[this.keywordIndex]]===r&&(sf.base.isNullOrUndefined(d)&&(!i||i&&!this.checkSameLevelFormat(l[Xe[this.keywordIndex]],t,i))?(o=!0,l[Ke[this.keywordIndex]]=n):!sf.base.isNullOrUndefined(d)&&this.checkSameLevelFormat(l[Xe[this.keywordIndex]],t,d)&&(l.isUpdated||(l[Ke[this.keywordIndex]]=d[Ke[this.keywordIndex]],l.isUpdated=!0),o=!1))}else if(a[oo[this.keywordIndex]])for(var h=0;h<a[oo[this.keywordIndex]].length;h++)for(var c=a[oo[this.keywordIndex]][h],p=0;p<c[no[this.keywordIndex]].length;p++){var g=c[no[this.keywordIndex]][p],f=this.updateListIdForBlocks(g[xo[this.keywordIndex]],t,i,r,n);o||(o=f)}}return o},e.prototype.updatePasteContent=function(e,t){var i=this,r=this.getUniqueListOrAbstractListId(!0);if(e[j[this.keywordIndex]].filter((function(e){return e[Ke[i.keywordIndex]]===r})).length>0){var n=e[j[this.keywordIndex]].slice().sort((function(e,t){return e[Ke[i.keywordIndex]]-t[Ke[i.keywordIndex]]}));r=n[n.length-1][Ke[this.keywordIndex]]+1}var o=this.getUniqueListOrAbstractListId(!1);if(e[G[this.keywordIndex]].filter((function(e){return e[Bo[i.keywordIndex]]===o})).length>0){var s=e[G[this.keywordIndex]].slice().sort((function(e,t){return e[Bo[i.keywordIndex]]-t[Bo[i.keywordIndex]]}));o=s[s.length-1][Bo[this.keywordIndex]]+1}for(var a,l=function(n){var s=e[j[d.keywordIndex]][n],l=e[G[d.keywordIndex]].filter((function(e){return e[Bo[i.keywordIndex]]===s[Bo[i.keywordIndex]]}))[0],h=d.documentHelper.lists.filter((function(e){return e.listId===s[Ke[i.keywordIndex]]}));if(!sf.base.isNullOrUndefined(l))if(d.updateListIdForBlocks(e[D[d.keywordIndex]][t][xo[d.keywordIndex]],l,h[0],s[Ke[d.keywordIndex]],r)){for(var c=l[Bo[d.keywordIndex]],p=0;p<e[j[d.keywordIndex]].length;p++){var g=e[j[d.keywordIndex]][p];g[Bo[d.keywordIndex]]===c&&(g[Bo[d.keywordIndex]]=o)}l[Bo[d.keywordIndex]]=o,s[Ke[d.keywordIndex]]=r,r++,o++}else e[j[d.keywordIndex]].splice(n,1),e[G[d.keywordIndex]].splice(e[G[d.keywordIndex]].indexOf(l),1),n--;a=n},d=this,h=0;h<e[j[this.keywordIndex]].length;h++)l(h),h=a;for(var c=this.getBlocksToUpdate(e[D[this.keywordIndex]][t][xo[this.keywordIndex]]),p=0;p<c.length;p++){delete c[p][_[this.keywordIndex]][ot[this.keywordIndex]].isUpdated}},e.prototype.getBlocks=function(e,t,i,r,n){var o=[];if("string"==typeof e){this.selection.currentPasteAction="TextOnly";var s=this.selection.start.paragraph;this.selection.isForward||(s=this.selection.end.paragraph);var l=[],d=e;l=(d=d.replace(/\r?\n/g,"\r")).split("\r");var c=[];(I=new aa).sectionFormat=new h(I),I.childWidgets=c;for(var p=0;p<l.length;p++)if(p!==l.length-1||0!==l[p].length||this.isInsertText){var g=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),f=this.selection.getPreviousValidElement(g.element);f!==g.element&&(f=this.selection.getNextValidElement(g.element));var u=void 0;s.isEmpty()?u=s.characterFormat:sf.base.isNullOrUndefined(f)||this.isInsertText?this.copyInsertFormat(s.characterFormat,!1):u=f.characterFormat;var m=this.documentHelper.selection.copySelectionParagraphFormat();sf.base.isNullOrUndefined(this.previousParaFormat)||(m=this.previousParaFormat);var y=new ca;y.paragraphFormat.copyFormat(m);var v=new ma(y);if(l[p].length>0)for(var w=l[p].split(/(\s+)/),b=0;b<w.length;b++){var x=new Fa;x.characterFormat.copyFormat(u),x.text=w[b],v.children.push(x),x.line=v}y.childWidgets.push(v),y.containerWidget=I,c.push(y)}o.push(I)}else{this.selection.currentPasteAction="DefaultPaste",this.viewer.owner.parser.addCustomStyles(e),!t&&e[J[this.keywordIndex]].length>0&&(this.documentHelper.owner.parser.commentsCollection=new a,this.documentHelper.owner.parser.parseComments(e,r));var I=void 0;for(p=0;p<e[D[this.keywordIndex]].length;p++){var F=this.documentHelper.owner.parser;if(F.keywordIndex=this.keywordIndex,F.images=e.images,F.isPaste=t,F.isHtmlPaste=this.isHtmlPaste,this.isPasteListUpdated||sf.base.isNullOrUndefined(e[j[this.keywordIndex]])||(this.documentHelper.lists.length>0&&this.updatePasteContent(e,p),this.isPasteListUpdated=!0,sf.base.isNullOrUndefined(e[G[this.keywordIndex]])||F.parseAbstractList(e,this.documentHelper.abstractLists),sf.base.isNullOrUndefined(e[j[this.keywordIndex]])||F.parseList(e,this.documentHelper.lists)),!sf.base.isNullOrUndefined(e[Z[this.keywordIndex]]))if(t){var C=this.viewer.owner.revisionsInternal.changes;sf.base.isNullOrUndefined(F.revisionCollection)||(F.revisionCollection=void 0),F.revisionCollection=new a;var W=F.revisionCollection;if((!this.documentHelper.owner.sfdtExportModule.copyWithTrackChange||!F.isCutPerformed)&&e[Z[this.keywordIndex]].length>=1)for(var k=0;k<e[Z[this.keywordIndex]].length;k++){var S=!0;if(W.containsKey(e[Z[this.keywordIndex]][k][xn[this.keywordIndex]])){if(C.length>0)for(var P=0;P<C.length;P++)C[P].revisionID===e[Z[this.keywordIndex]][k][xn[this.keywordIndex]]&&(S=!1);if(S){var N=W.get(e[Z[this.keywordIndex]][k][xn[this.keywordIndex]]);C.push(N)}}else F.parseRevisions(e,C)}this.documentHelper.owner.sfdtExportModule.copyWithTrackChange=!1}else F.revisionCollection=this.documentHelper.revisionsInternal,F.parseRevisions(e,n);if((I=new aa).sectionFormat=new h(I),t?o.push(I):i.unshift(I),t&&!sf.base.isNullOrUndefined(e[X[this.keywordIndex]]))for(b=0;b<e[X[this.keywordIndex]].length;b++){var O=e[X[this.keywordIndex]][b][ye[this.keywordIndex]],T=this.documentHelper.styles.findByName(O);sf.base.isNullOrUndefined(T)&&F.parseStyle(e,e[X[this.keywordIndex]][b],this.documentHelper.styles)}F.parseBody(e[D[this.keywordIndex]][p][xo[this.keywordIndex]],I.childWidgets,void 0,void 0,void 0,e[X[this.keywordIndex]]),e[ce[this.keywordIndex]]&&this.selection.start.paragraph.isEmpty()&&1==this.documentHelper.pages.length&&1==this.documentHelper.pages[0].bodyWidgets[0].childWidgets.length&&F.parseSectionFormat(this.keywordIndex,e[D[this.keywordIndex]][p][No[this.keywordIndex]],I.sectionFormat),F.isPaste=!1,F.isHtmlPaste=!1,F.images=void 0}if(e[ce[this.keywordIndex]]){var H=new ca;I.childWidgets.push(H)}}return"MergeWithExistingFormatting"===this.currentPasteOptions&&this.applyMergeFormat(o),o},e.prototype.applyMergeFormat=function(e){for(var t=this.selection.start.paragraph,i=this.selection.start.currentWidget.getInline(this.selection.start.offset,0),r=this.selection.getPreviousValidElement(i.element),n=r?r.characterFormat:this.copyInsertFormat(t.characterFormat,!1),o=this.documentHelper.selection.paragraphFormat,s=0;s<e.length;s++)for(var a=e[s].childWidgets,l=0;l<a.length;l++){var d=a[l];if(d instanceof ca)this.applyParaFormatInternal(d.paragraphFormat,o),this.applyFormatInternal(d,n);else for(var h=0;h<d.childWidgets.length;h++)for(var c=d.childWidgets[h],p=0;p<c.childWidgets.length;p++)for(var g=c.childWidgets[p],f=0;f<g.childWidgets.length;f++)this.applyFormatInternal(g.childWidgets[f],n)}},e.prototype.applyParaFormatInternal=function(e,t){sf.base.isNullOrUndefined(t.leftIndent)||(e.leftIndent=t.leftIndent),sf.base.isNullOrUndefined(t.rightIndent)||(e.rightIndent=t.rightIndent),sf.base.isNullOrUndefined(t.firstLineIndent)||(e.firstLineIndent=t.firstLineIndent),sf.base.isNullOrUndefined(t.textAlignment)?e.textAlignment="Left":e.textAlignment=t.textAlignment,sf.base.isNullOrUndefined(t.outlineLevel)?e.outlineLevel="BodyText":e.outlineLevel=t.outlineLevel,-1===t.beforeSpacing?e.beforeSpacing=0:e.beforeSpacing=t.beforeSpacing,-1===t.afterSpacing?e.afterSpacing=0:e.afterSpacing=t.afterSpacing,0===t.lineSpacing?e.lineSpacing=1:e.lineSpacing=t.lineSpacing,sf.base.isNullOrUndefined(t.lineSpacingType)||(e.lineSpacingType=t.lineSpacingType),sf.base.isNullOrUndefined(t.bidi)||(e.bidi=t.bidi),sf.base.isNullOrUndefined(t.spaceAfterAuto)||(e.spaceAfterAuto=t.spaceAfterAuto),sf.base.isNullOrUndefined(t.spaceBeforeAuto)||(e.spaceBeforeAuto=t.spaceBeforeAuto),sf.base.isNullOrUndefined(t.keepWithNext)||(e.keepWithNext=t.keepWithNext),sf.base.isNullOrUndefined(t.keepLinesTogether)||(e.keepLinesTogether=t.keepLinesTogether),sf.base.isNullOrUndefined(t.widowControl)||(e.widowControl=t.widowControl),sf.base.isNullOrUndefined(t.contextualSpacing)||(e.contextualSpacing=t.contextualSpacing),e.tabs&&(e.tabs=[])},e.prototype.applyFormatInternal=function(e,t){if(e instanceof ca)for(var i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.children.length;n++){var o=r.children[n].characterFormat.cloneFormat();o.bold&&(r.children[n].characterFormat.bold=o.bold),o.italic&&(r.children[n].characterFormat.italic=o.italic),"None"!==o.underline&&(r.children[n].characterFormat.underline=o.underline),"MergeWithExistingFormatting"!==this.currentPasteOptions||sf.base.isNullOrUndefined(t)||(t.bold&&(r.children[n].characterFormat.bold=t.bold),t.italic&&(r.children[n].characterFormat.italic=t.italic),"None"!==t.underline&&(r.children[n].characterFormat.underline=t.underline),r.children[n].characterFormat.fontColor!==t.fontColor&&(r.children[n].characterFormat.fontColor=t.fontColor),r.children[n].characterFormat.fontSize!==t.fontSize&&(r.children[n].characterFormat.fontSize=t.fontSize,r.children[n].characterFormat.fontSizeBidi=t.fontSizeBidi),r.children[n].characterFormat.fontFamily!==t.fontFamily&&(r.children[n].characterFormat.fontFamily=t.fontFamily,r.children[n].characterFormat.fontFamilyBidi=t.fontFamilyBidi),r.children[n].characterFormat.fontFamilyAscii!==t.fontFamilyAscii&&(r.children[n].characterFormat.fontFamilyAscii=t.fontFamilyAscii),r.children[n].characterFormat.fontFamilyFarEast!==t.fontFamilyFarEast&&(r.children[n].characterFormat.fontFamilyFarEast=t.fontFamilyFarEast),r.children[n].characterFormat.fontFamilyAscii!==t.fontFamilyAscii&&(r.children[n].characterFormat.fontFamilyAscii=t.fontFamilyAscii))}else for(i=0;i<e.childWidgets.length;i++){var s=e.childWidgets[i];for(n=0;n<s.childWidgets.length;n++)for(var a=s.childWidgets[n],l=0;l<a.childWidgets.length;l++)this.applyFormatInternal(a.childWidgets[l],t)}},e.prototype.applyPasteOptions=function(e,t){if(!sf.base.isNullOrUndefined(this.copiedContent)&&""!==this.copiedTextContent&&!t){this.currentPasteOptions=e;var i=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.paragraphFormat,r=this.copiedContent,n=this.copiedTextContent;switch(this.editorHistory&&this.editorHistory.canUndo()&&(this.editorHistory.undo(),this.editorHistory.redoStack.pop()),this.copiedContent=r,this.copiedTextContent=n,this.selection.isViewPasteOptions=!0,e){case"KeepSourceFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent);break;case"MergeWithExistingFormatting":this.pasteContents(""!==this.copiedContent?this.copiedContent:this.copiedTextContent,i);break;case"KeepTextOnly":this.pasteContents(this.copiedTextContent)}}},e.prototype.pasteContents=function(e,t){if(!sf.base.isNullOrUndefined(e.optimizeSfdt)&&e.optimizeSfdt&&(this.keywordIndex=1),"string"!=typeof e&&(this.copiedContent=e),"FormFieldsOnly"===this.documentHelper.protectionType&&this.documentHelper.selection.isInlineFormFillMode()){var i=this.selection.getCurrentFormField(),r=this.getFieldResultText(),n=i.formFieldData.maxLength,o=this.documentHelper.selection.text.length;if(n>0)if(0===o){var s=n-r.length;e=e.substring(0,s)}else o>0&&(e=e.substring(0,o))}if(!sf.base.isNullOrUndefined(e[Ns[this.keywordIndex]])){var l=e[Ns[this.keywordIndex]];if(this.documentHelper.images.length>0){this.pasteImageIndex=new a;var d={};for(var h in l){var c=this.documentHelper.images.length+parseInt(h);d[c]=l[h],this.pasteImageIndex.add(h,c.toString())}l=d}this.documentHelper.owner.parser.parseImages(l)}this.pasteContentsInternal(this.getBlocks(e,!0),!0,t),sf.base.isNullOrUndefined(this.pasteImageIndex)||this.pasteImageIndex.destroy(),this.pasteImageIndex=void 0,this.isInsertField=!1,this.isPasteListUpdated=!1},e.prototype.pasteContentsInternal=function(e,t,i){this.isPaste=t;var r=this.documentHelper.selection,n=!0,o=!1;if(this.initComplexHistory("Paste"),this.documentHelper.isListTextSelected){var s=r.start.paragraph;s.paragraphFormat.listFormat&&-1!==s.paragraphFormat.listFormat.listId&&this.onApplyList(void 0)}this.initHistory("Paste"),(r.isEmpty||this.owner.documentHelper.isDragging&&this.owner.selection.isImageSelected)&&!this.documentHelper.isListTextSelected||(n=this.removeSelectedContentInternal(r,r.start,r.end)),n?o=this.pasteContent(e,i):this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0),this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()):this.reLayout(r,r.isEmpty),o&&(this.selection.pasteElement&&(this.selection.pasteElement.style.display="none"),this.layoutWholeDocument(!0)),this.isPaste=!1},e.prototype.pasteContent=function(e,t){this.documentHelper.owner.isShiftingEnabled=!0;var i="";if(this.updateInsertPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo)i=this.editorHistory.currentBaseHistoryInfo.insertPosition;else{var r=this.selection.start;this.selection.isForward||(r=this.selection.end);var n=this.selection.getParagraphInfo(r);i=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())}this.documentHelper.owner.isLayoutEnabled=!0,this.documentHelper.owner.isPastingContent=!0;var o=this.pasteCopiedData(e,t),s="";if(this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo)s=this.editorHistory.currentBaseHistoryInfo.endPosition;else{n=this.selection.getParagraphInfo(this.selection.start);s=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())}this.selection.start.paragraph.isEmpty()&&this.selection.start.paragraph.paragraphFormat.bidi&&this.documentHelper.layout.reLayoutParagraph(this.selection.start.paragraph,0,0);var a=new Al(this.documentHelper.owner);this.setPositionForCurrentIndex(a,i);var l=new Al(this.documentHelper.owner);return this.setPositionForCurrentIndex(l,s),this.pasteTextPosition={startPosition:a,endPosition:l},this.documentHelper.owner.isPastingContent=!1,this.documentHelper.selection.fireSelectionChanged(!0),o},e.prototype.pasteCopiedData=function(e,t){var i=!1;if(this.documentHelper.layout.isBidiReLayout&&(this.documentHelper.layout.isBidiReLayout=!1),this.isPaste&&this.isSectionEmpty(this.selection)&&!this.selection.start.paragraph.isInHeaderFooter){if(this.previousSectionFormat=new h,this.previousSectionFormat.copyFormat(this.selection.start.paragraph.bodyWidget.sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.copyFormat(e[0].sectionFormat),this.selection.start.paragraph.bodyWidget.sectionFormat.footerDistance=this.previousSectionFormat.footerDistance,this.selection.start.paragraph.bodyWidget.sectionFormat.headerDistance=this.previousSectionFormat.headerDistance,this.owner.viewer instanceof Qs){var r=this.selection.start.paragraph.bodyWidget.page;this.owner.viewer.updatePageBoundingRectangle(this.selection.start.paragraph.bodyWidget,r,r.boundingRectangle.y),this.owner.viewer.updateClientArea(this.selection.start.paragraph.bodyWidget,r)}i=!0}for(var n=0;n<e.length;n++){0!==n&&this.insertSectionBreak(e[n].sectionFormat.breakCode);for(var o=e[n].childWidgets,s=!1,a=0;a<o.length;a++){var l=o[a];if(l instanceof ga&&(s=!0),l instanceof ca&&0===l.childWidgets.length&&(l.childWidgets[0]=new ma(l)),l instanceof ca&&!sf.base.isNullOrUndefined(t)){l.paragraphFormat.copyFormat(t);var d=this.copyInsertFormat(this.selection.start.paragraph.characterFormat,!1);l.characterFormat.mergeFormat(d)}var c=l instanceof ca&&(this.owner.enableLocalPaste?!sf.base.isNullOrUndefined(l.isCreatedUsingHtmlSpanTag)&&!l.isCreatedUsingHtmlSpanTag:l.isCreatedUsingHtmlSpanTag);if(l instanceof ca&&(c||a===o.length-1&&(this.isInsertingTOC||s||this.owner.documentHelper.isDragging))&&!sf.base.isNullOrUndefined(l.paragraphFormat.listFormat)&&sf.base.isNullOrUndefined(l.paragraphFormat.listFormat.list)&&-1===l.paragraphFormat.listFormat.listId){var p=l;if(p.childWidgets.length>0&&p.childWidgets[0].children.length>0){var g=this.selection.start;if("Center"!==g.paragraph.paragraphFormat.textAlignment&&"Right"!==g.paragraph.paragraphFormat.textAlignment||-1!==g.paragraph.paragraphFormat.listFormat.listId||(g.paragraph.x=this.owner.viewer.clientActiveArea.x),"KeepTextOnly"===this.currentPasteOptions){var f=new ul(this.selection.start.paragraph);this.selection.start.paragraph.paragraphFormat=f}this.insertElement(p.childWidgets[0].children,p.paragraphFormat)}}else if(l instanceof da){var u=this.selection.start.paragraph;if(l instanceof ga){var m=l;if(this.generateTableRevision(m),u.isInsideTable){var y=u.getContainerWidth();m.fitCellsToClientArea(y)}if(u.isEmpty()&&u.previousWidget instanceof ga&&!this.isPaste)return this.insertTableRows(m,u.previousWidget),i}this.insertBlockInternal(l)}}}return i},e.prototype.generateTableRevision=function(e){if(this.owner.enableTrackChanges&&!sf.base.isNullOrUndefined(e))for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];this.insertRevision(i.rowFormat,"Insertion");for(var r=0;r<i.childWidgets.length;r++)for(var n=i.childWidgets[r],o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];sf.base.isNullOrUndefined(s)||this.insertRevisionForBlock(s,"Insertion")}}},e.prototype.isSectionEmpty=function(e){var t=e.start.paragraph;if(t){if(t.isInsideTable||t.isInHeaderFooter||t!==e.end.paragraph)return!1;var i=t.bodyWidget;if(i){var r=i.page;if(r&&(sf.base.isNullOrUndefined(r.previousPage)||r.previousPage.sectionIndex!==r.sectionIndex)&&sf.base.isNullOrUndefined(r.nextPage)&&t.isEmpty()&&1===i.childWidgets.length){var n=!0,o=e.start.paragraph.bodyWidget.sectionIndex,s=this.documentHelper.headersFooters[o];if(s){for(var a in s){var l=s[a];if(sf.base.isNullOrUndefined(l))n=!1;else{var d=l.childWidgets[0];(d instanceof ga||d instanceof ca&&!d.isEmpty())&&(n=!1)}if(!n)break}return n}}}}return!1},e.prototype.insertTableInternal=function(e,t,i,r){var n,o=e.index,s=this.selection.start.paragraph;if(!e.isInsideTable&&t.isInsideTable&&(o=t.index,r=!0,n=s.containerWidget),i)for(var a=0,l=0;a<e.childWidgets.length;a++,l++){var d=e.childWidgets[a];t.childWidgets.splice(l,0,d),d.containerWidget=t,e.childWidgets.splice(a,1),a--}if(!s.isInsideTable&&sf.base.isNullOrUndefined(n)?(e.containerWidget=s.containerWidget,n=s.containerWidget):sf.base.isNullOrUndefined(n)&&(n=e.containerWidget),e.isInsideTable&&(n=n.combineWidget(this.owner.viewer)),this.constructRevisionsForTable(e,!1),r||this.removeBlock(e,!0),this.removeRevisionFromTable(e),n instanceof ua)n=n.combineWidget(this.owner.viewer);else{var h=this.documentHelper.layout.checkAndGetBlock(n,o);-1!==n.childWidgets.indexOf(h)&&(o=n.childWidgets.indexOf(h))}n.childWidgets.splice(o,0,t),r||(t.index=e.index,e.containerWidget=void 0),t.containerWidget=n,this.documentHelper.layout.clearTableWidget(t,!0,!0,!0),t.buildTableColumns(),this.constructRevisionsForTable(t,!0),t.isGridUpdated=!0,this.updateNextBlocksIndex(t,!0),this.documentHelper.layout.linkFieldInTable(t),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,n,t,!1)},e.prototype.removeRevisionFromTable=function(e){for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];if(i.rowFormat.revisions.length>0)for(var r=0;r<i.rowFormat.revisions.length;r++)if(0===i.rowFormat.revisions[r].range.length){var n=i.rowFormat.revisions.indexOf(i.rowFormat.revisions[r]);i.rowFormat.revisions.splice(n,1),r--}}},e.prototype.canConstructRevision=function(e){return e.revisions.length>0&&0===e.revisions[0].range.length||e.removedIds.length>0},e.prototype.constructRevisionsForTable=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i];if(t){this.canConstructRevision(r.rowFormat)&&this.constructRevisionFromID(r.rowFormat,!0);for(var n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=0;s<o.childWidgets.length;s++)o.childWidgets[s]instanceof ca&&this.constructRevisionsForBlock(o.childWidgets[s],t)}else sf.base.isNullOrUndefined(this.owner.editorHistory)||!this.owner.editorHistory.isUndoing&&!this.owner.editorHistory.isRedoing?this.removeDeletedCellRevision(r):this.deleteRevision(r)}},e.prototype.deleteRevision=function(e){if(e.rowFormat.revisions.length>0)for(var t=0;t<e.rowFormat.revisions.length;t++){for(var i=e.rowFormat.revisions[t],r=0;r<i.range.length;r++)i.range.splice(r,1),r--,this.owner.trackChangesPane.updateCurrentTrackChanges(i);0===i.range.length&&this.owner.revisions.remove(i)}},e.prototype.constructRevisionsForBlock=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.children.length;n++)t&&r.children[n]instanceof ya&&this.canConstructRevision(r.children[n])&&this.constructRevisionFromID(r.children[n],!0);this.canConstructRevision(e.characterFormat)&&this.constructRevisionFromID(e.characterFormat,!0)},e.prototype.applyRevisionForCurrentPara=function(e,t,i,r,n){var o=e.getInline(t+1,0).element,s=!1;t===e.getLength()&&(s=!0),t===i&&e.nextSplitWidget&&(i+=o.length);var a=e.getInline(i,0).element;sf.base.isNullOrUndefined(e.nextSplitWidget)||(n=!1);for(var l=0,d=e;d;)sf.base.isNullOrUndefined(d)||(l+=d.getLength()),d=d.previousSplitWidget;if(sf.base.isNullOrUndefined(e.previousSplitWidget)||0===l||t===l||(s=!1),i>l&&(n=!0),sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(a))sf.base.isNullOrUndefined(o)||s?sf.base.isNullOrUndefined(a)||(a.removedIds.push(r),this.constructRevisionFromID(a,!0)):(o.removedIds.push(r),this.constructRevisionFromID(o,!0));else if(s||o!==a){for(;!sf.base.isNullOrUndefined(o)&&o!==a;)s||(o.removedIds.push(r),this.constructRevisionFromID(o,!0)),sf.base.isNullOrUndefined(o.nextNode)||(o=o.nextNode instanceof Na?o.nextNode:o.nextNode.nextValidNodeForTracking),s=!1;sf.base.isNullOrUndefined(o)||s||(o.removedIds.push(r),this.constructRevisionFromID(o,!0))}else o.removedIds.push(r),this.constructRevisionFromID(o,!0);n&&(e.characterFormat.removedIds.push(r),this.constructRevisionFromID(e.characterFormat,!0))},e.prototype.insertBlockTable=function(e,t,i){var r=e.start.offset;e.start.paragraph.childWidgets.indexOf(e.start.currentWidget);t instanceof ca&&r>0&&(this.moveInlines(e.start.paragraph,t,0,0,e.start.paragraph.firstChild,r,e.start.currentWidget),e.selectParagraphInternal(e.start.paragraph,!0),this.checkInsertPosition(e)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(t,r.toString()),!0)),r>0&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.start,!0);var n=i.indexInOwner;if(i.containerWidget.childWidgets.splice(n,0,t),t.containerWidget=i.containerWidget,t.index=i.index,this.updateNextBlocksIndex(t,!0),t instanceof ca&&this.constructRevisionsForBlock(t,!0),this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.checkInsertPosition(e)){var o=void 0;t instanceof ca&&(o=t),t instanceof ga&&(o=this.documentHelper.getFirstParagraphInFirstCell(t)),this.updateHistoryPosition(this.selection.getHierarchicalIndex(o,"0"),!0)}},e.prototype.handleCut=function(e){var t=e.start,i=e.end;e.isForward||(t=e.end,i=e.start);var r=this.selection.getParagraphInfo(t);if(e.editPosition=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),t.paragraph===i.paragraph&&t.offset+1===i.offset)t.paragraph.getInline(i.offset,0).element;this.initHistory("Cut"),e.owner.isShiftingEnabled=!0,this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.editPosition,!0),this.deleteSelectedContent(i.paragraph,e,t,i,3);var n=new Al(e.owner);this.setPositionForCurrentIndex(n,e.editPosition),e.selectContent(n,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e)},e.prototype.insertInlineInternal=function(e,t){var i=this.selection,r=e.length,n=this.selection.getParagraphInfo(i.start);if(t=sf.base.isNullOrUndefined(t)?"Insertion":t,i.start.paragraph.isEmpty()){var o=i.start.paragraph;"Center"!==o.paragraphFormat.textAlignment&&"Right"!==o.paragraphFormat.textAlignment||-1!==o.paragraphFormat.listFormat.listId||(o.x=this.owner.viewer.clientActiveArea.x);var s=!sf.base.isNullOrUndefined(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing);o.childWidgets[0].children.push(e),e.line=o.childWidgets[0],this.owner.enableTrackChanges&&e.isValidNodeForTracking&&!s&&this.insertRevision(e,t),(e.removedIds.length>0||s)&&this.constructRevisionFromID(e,!0),e.linkFieldCharacter(this.documentHelper),e instanceof Wa&&("Footnote"===e.footnoteType&&this.updateFootnoteCollection(e),"Endnote"===e.footnoteType&&this.updateEndnoteCollection(e)),this.documentHelper.layout.reLayoutParagraph(o,0,0,void 0,void 0)}else{var a=0,l=i.start.currentWidget.getInline(i.start.offset,a),d=l.element;a=l.index,this.insertElementInternal(d,e,a,t,!0)}var h=e.revisions[0];sf.base.isNullOrUndefined(h)||this.owner.trackChangesPane.updateCurrentTrackChanges(h),this.setPositionParagraph(n.paragraph,n.offset+r,!0)},e.prototype.insertElement=function(e,t){var i=this.selection,r=0,n=void 0,o=-1,s=void 0,a=0,l=void 0,d=this.selection.getParagraphInfo(i.start),h=this.owner.enableTrackChanges,c=void 0,p=void 0,g=0;if(i.start.paragraph.isEmpty())s=(n=i.start.paragraph).childWidgets[0],o=0;else{var f=i.start.currentWidget.getInline(i.start.offset,g);c=f.element,g=f.index,o=(n=c.line.paragraph).childWidgets.indexOf(c.line),a=c.indexInOwner,s=c.line,g===c.length?(a++,l=!1):0===g?(sf.base.isNullOrUndefined(c.previousNode)&&(a=0),l=!0):(a++,(p=new Fa).characterFormat.copyFormat(c.characterFormat),p.text=c.text.substring(g),c.text=c.text.slice(0,g),c.revisions.length>0&&!this.owner.enableTrackChanges&&this.splitRevisionForSpittedElement(c,p),s.children.splice(a,0,p),p.line=c.line)}for(var u=0;u<e.length;u++){r+=e[u].length,e[u]instanceof Fa&&e[u].text.indexOf(" ")>=0&&(this.documentHelper.triggerSpellCheck=!0);var m=e[u].revisions.length;e[u].ischangeDetected=!0,s.children.splice(a,0,e[u]),e[u].line=s,e[u].linkFieldCharacter(this.documentHelper);var y=this.updateRevisionForElement(c,e[u],g,0===u,p,l);h&&!y&&e[u].revisions.length===m&&this.checkToCombineRevisionsinBlocks(e[u],m===e[u].revisions.length,u>0&&u===e.length-1,"Insertion"),c=e[u],a++}!this.isPaste&&t&&(sf.base.isNullOrUndefined(n.paragraphFormat.listFormat.list)||!sf.base.isNullOrUndefined(n.paragraphFormat.listFormat)&&-1===n.paragraphFormat.listFormat.listId)&&n.paragraphFormat.copyFormat(t),this.isPaste&&(this.viewer.updateClientAreaForBlock(n,!0),n.x=this.viewer.clientActiveArea.x),this.documentHelper.layout.reLayoutParagraph(n,o,0,this.isInsertField?void 0:n.paragraphFormat.bidi),this.setPositionParagraph(d.paragraph,d.offset+r,!0)},e.prototype.updateRevisionForElement=function(e,t,i,r,n,o){if(!this.owner.enableTrackChanges)return!1;if(sf.base.isNullOrUndefined(e)&&sf.base.isNullOrUndefined(n))return!1;var s=!!sf.base.isNullOrUndefined(o),a=t.revisions.length;return r?s?(this.checkToMapRevisionWithInlineText(e,i,t,!1,"Insertion")||t.revisions.length>a?this.copyElementRevision(e,n,!0):0===t.revisions.length&&(this.splitRevisionForSpittedElement(e,n),this.insertRevision(t,"Insertion")),!1):o?this.insertRevisionAtBegining(e,t,"Insertion"):this.insertRevisionAtEnd(e,t,"Insertion"):this.insertRevisionAtEnd(e,t,"Insertion")},e.prototype.insertElementInternal=function(e,t,i,r,n){var o=e.line,s=o.paragraph,a=o.indexInOwner,l=e.indexInOwner,d=s.paragraphFormat.bidi&&e.isRightToLeft,h=!1;r=sf.base.isNullOrUndefined(r)?"Insertion":r;var c=this.skipTracking(),p=this.owner.enableTrackChanges,g=!1,f=t.revisions.length;if(this.owner.editorHistory&&(this.owner.editorHistory.isUndoing||this.owner.editorHistory.isRedoing)&&t instanceof Fa&&(h=e.characterFormat.isEqualFormat(t.characterFormat)&&this.documentHelper.textHelper.isRTLText(t.text)),h)e.text=e.text.substring(0,i)+t.text+e.text.substring(i);else if(i===e.length)l++,t.removedIds.length>0||c?this.constructRevisionFromID(t,!0,e):!p||c||this.skipFieldDeleteTracking||(g=this.insertRevisionAtEnd(e,t,r)),o.children.splice(l,0,t);else if(0===i)t.removedIds.length>0?this.constructRevisionFromID(t,!1):!p||c||this.skipFieldDeleteTracking||(g=this.insertRevisionAtBegining(e,t,r)),sf.base.isNullOrUndefined(e.previousNode)?(e.line.children.splice(0,0,t),l=0):e.line.children.splice(l,0,t);else{l++;var u=new Fa;if(u.characterFormat.copyFormat(e.characterFormat),u.text=e.text.substring(i),e.revisions.length>0&&!p&&!c&&0===t.removedIds.length&&this.splitRevisionForSpittedElement(e,u),e.text=e.text.substr(0,i),o.children.splice(l,0,u),u.line=e.line,g=!0,this.isTrackingFormField=e.previousElement instanceof va,t.removedIds.length>0&&!this.isTrackingFormField)this.constructRevisionFromID(t,!1),this.copyElementRevision(e,u,!0);else if(this.owner.enableTrackChanges){if(t instanceof Na||t instanceof al||t instanceof _a||t instanceof qa)this.copyElementRevision(e,u,!1);else this.checkToMapRevisionWithInlineText(e,i,t,d,r)||t.revisions.length>f?this.copyElementRevision(e,u,!0):t.revisions.length===f&&(this.splitRevisionForSpittedElement(e,u),this.insertRevision(t,r))}o.children.splice(l,0,t),l-=1}if(t.line=e.line,t instanceof Na){var m=this.documentHelper.bookmarks;t.reference&&(t.reference.reference=t),m.containsKey(t.name)||m.add(t.name,t)}!sf.base.isNullOrUndefined(t.line.paragraph.containerWidget)&&!sf.base.isNullOrUndefined(t.line.paragraph.containerWidget.containerWidget)&&t.line.paragraph.containerWidget.containerWidget instanceof ha&&(t.line.paragraph.containerWidget.containerWidget.height+=t.height),t.linkFieldCharacter(this.documentHelper),t instanceof Oa&&0===t.type&&this.documentHelper.contentControlCollection.push(t),(t instanceof Da&&"Inline"!==t.textWrappingStyle||t instanceof La)&&(-1===s.floatingElements.indexOf(t)&&s.floatingElements.push(t),-1===s.bodyWidget.floatingElements.indexOf(t)&&"Inline"!==t.textWrappingStyle&&s.bodyWidget.floatingElements.push(t)),!p||g||c||this.skipFieldDeleteTracking||this.checkToCombineRevisionsinBlocks(t,f===t.revisions.length,i===e.length,r),t instanceof Wa&&(c&&(t.isLayout=!1),"Footnote"===t.footnoteType&&this.updateFootnoteCollection(t),"Endnote"===t.footnoteType&&this.updateEndnoteCollection(t)),n&&this.documentHelper.layout.reLayoutParagraph(s,a,l,void 0,void 0)},e.prototype.constructRevisionFromID=function(e,t,i){if(e.removedIds.length>0){for(var r=0;r<e.removedIds.length;r++){var n=void 0;if(this.documentHelper.revisionsInternal.containsKey(e.removedIds[r])){if(n=this.documentHelper.revisionsInternal.get(e.removedIds[r]),e.revisions.push(n),(t=!!t||this.skipTracking())&&this.editorHistory.isRedoing&&this.owner.editorHistory.currentBaseHistoryInfo&&"BackSpace"===this.owner.editorHistory.currentBaseHistoryInfo.action&&this.selection.isTOC()&&(t=!1),sf.base.isNullOrUndefined(i)){var o=void 0;if(!sf.base.isNullOrUndefined(this.owner.editorHistory)&&(this.owner.editorHistory.isUndoing||this.owner.editorHistory.isRedoing)&&!(e instanceof k)){var s=this.owner.selectionModule.start.paragraph.index,a=0;if(!this.owner.selectionModule.start.paragraph.isInsideTable)for(var l=0;l<n.range.length;l++)if(n.range[l]instanceof Fa?a=n.range[l].paragraph.index:n.range[l]instanceof T&&(a=n.range[l].ownerBase.index),s<a){o=l;break}}sf.base.isNullOrUndefined(o)&&(o=t?n.range.length:0),n.range.splice(o,0,e)}else{var d=n.range.indexOf(i);d>=0?n.range.splice(d+(t?1:0),0,e):n.range.splice(0,0,e)}this.owner.trackChangesPane.updateCurrentTrackChanges(n),this.updateRevisionCollection(n)}}e.removedIds=[]}else for(r=0;r<e.revisions.length;r++){var h=e.revisions[r];this.documentHelper.revisionsInternal.containsKey(h.revisionID)&&((h=this.documentHelper.revisionsInternal.get(h.revisionID)).range.splice(t?h.range.length:0,0,e),this.updateRevisionCollection(h))}},e.prototype.insertBlock=function(e){var t=!0,i=this.selection,r=!1;if(i.isEmpty||(t=this.removeSelectedContents(i),r=!0),t||i.selectContent(i.start,!1),this.insertBlockInternal(e,r),this.addOrRemoveCommentsInBlock(e,!0),this.checkInsertPosition(i)){var n=void 0;n=e instanceof ca?e:this.documentHelper.getFirstParagraphInFirstCell(e),this.updateHistoryPosition(this.selection.getHierarchicalIndex(n,"0"),!0)}this.fireContentChange()},e.prototype.insertBlockInternal=function(e,t){var i=this.selection,r=this.selection.start.paragraph;if(!i.start.isAtParagraphStart){if(e instanceof ca){this.isInsertingTOC||!this.owner.enableTrackChanges||this.skipTracking()||this.insertRevisionForBlock(e,"Insertion");var n=i.start.clone();return this.isInsertingTOC||!this.owner.enableTrackChanges||this.skipTracking()||this.insertRevisionForBlock(e,"Insertion"),this.insertNewParagraphWidget(e,!1),void(this.isInsertingTOC||this.combineRevisions(e,n,this.selection.end))}this.updateInsertPosition(),r=r.combineWidget(this.owner.viewer),this.splitParagraph(r,r.firstChild,0,i.start.currentWidget,i.start.offset,!1),i.selectParagraphInternal(this.selection.start.paragraph,!0)}var o=i.start.paragraph.containerWidget,s=i.start.paragraph.index;if(!sf.base.isNullOrUndefined(o)){if(!sf.base.isNullOrUndefined(this.editorHistory)&&this.editorHistory.isRedoing&&t&&o.firstChild instanceof ca&&o.firstChild.isEmpty()&&o.firstChild===o.lastChild&&e instanceof ca&&e.isEmpty())return;var a=o.childWidgets.indexOf(i.start.paragraph);o.childWidgets.splice(a,0,e),e.containerWidget=o,e.index=s,e.height=0,e instanceof ga&&(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0),this.updateNextBlocksIndex(e,!0),!this.isInsertingTOC&&this.owner.enableTrackChanges&&!this.skipTracking()&&e instanceof ca?this.insertRevisionForBlock(e,"Insertion"):e instanceof ca?this.constructRevisionsForBlock(e,!0):e instanceof ga&&this.constructRevisionsForTable(e,!0),this.documentHelper.layout.layoutBodyWidgetCollection(s,o,e,!1)}},e.prototype.insertImage=function(e,t,i,r){this.insertImageInternal(e,!1,t,i,r)},e.prototype.insertImageAsync=function(e,t,i,r){return ld(this,void 0,void 0,(function(){return dd(this,(function(n){switch(n.label){case 0:return[4,this.insertImageInternal(e,!1,t,i,r)];case 1:return n.sent(),[2]}}))}))},e.prototype.insertImageInternal=function(e,t,i,r,n){return ld(this,void 0,void 0,(function(){var o=this;return dd(this,(function(s){return[2,new Promise((function(s,a){var l=o.selection.getCurrentFormField(),d="FormFieldsOnly"===o.documentHelper.protectionType&&!sf.base.isNullOrUndefined(l)&&l.formFieldData instanceof ba;if(!o.owner.isReadOnlyMode&&o.canEditContentControl||d){if(sf.base.isNullOrUndefined(i)&&sf.base.isNullOrUndefined(r)){var h=document.createElement("img"),c=o;h.addEventListener("load",(function(){c.insertPicture(e,this.width,this.height,this.alt,!0),s()})),h.src=e}else o.insertPicture(e,i,r,n,t),s();setTimeout((function(){sf.base.isNullOrUndefined(o.viewer)||o.viewer.updateScrollBars()}),30)}else s()}))]}))}))},e.prototype.insertTable=function(e,t){var i=this.selection.start;if(!this.owner.isReadOnlyMode&&this.canEditContentControl){e=e||1,t=t||1;var r=this.createTable(e,t),n=i.paragraph.getContainerWidth()-r.tableFormat.leftIndent;r.splitWidthToTableCells(n);var o=i.paragraph.previousWidget;if(i.currentWidget.isFirstLine()&&0===i.offset&&o instanceof ga)return this.insertTableRows(r,o),void r.destroy();this.initHistory("InsertTable"),this.documentHelper.owner.isShiftingEnabled=!0,this.insertBlock(r),!sf.base.isNullOrUndefined(r.containerWidget)&&!sf.base.isNullOrUndefined(r.containerWidget.containerWidget)&&r.containerWidget.containerWidget instanceof ha&&(r.containerWidget.containerWidget.height+=r.height,this.isTableInsert=!0);var s=this.documentHelper.getFirstParagraphInFirstCell(r).childWidgets[0];i.setPosition(s,!0),this.selection.end.setPositionInternal(i);var a=this.documentHelper.getLastParagraphInLastCell(r.getSplitWidgets().pop()),l=a.getLength()+1;this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(a,l.toString())),this.reLayout(this.selection),this.isTableInsert=!1}},e.prototype.insertRow=function(e,t){var i=e?"Above":"Below";if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var r=this.selection.isForward?this.selection.start:this.selection.end;this.selection.isForward?this.selection.end:this.selection.start;if(r.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Above"===i?"InsertRowAbove":"InsertRowBelow"),this.documentHelper.owner.isShiftingEnabled=!0;var n=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],o=this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0],s=n.ownerTable.combineWidget(this.owner.viewer),a="Below"===i?o.ownerRow:n.ownerRow;if(this.editorHistory)this.cloneTableToHistoryInfo(s);var l=t||this.getRowCountToInsert(),d=[],h=a.rowIndex;if("Below"===i){h++;var c=sf.base.isNullOrUndefined(o.previousWidget)||o.columnIndex===o.previousWidget.columnIndex+1;o.cellIndex!==o.columnIndex&&c&&a.rowIndex+n.cellFormat.rowSpan-1===o.ownerRow.rowIndex||o.cellFormat.rowSpan>1&&!sf.base.isNullOrUndefined(a.nextWidget)&&a.nextWidget instanceof fa&&(o.cellFormat.rowSpan+=l,a=a.nextWidget),a.bottomBorderWidth=0}for(var p=0;p<l;p++){var g=this.updateRowspan(a,"Below"===i?o:n,i),f=this.createRowAndColumn(g.count,p,h,s);f.rowFormat=a.rowFormat.cloneFormat(),f.rowFormat.ownerBase=f,this.owner.enableTrackChanges&&this.insertRevision(f.rowFormat,"Insertion"),this.updateCellFormatForInsertedRow(f,g.cellFormats),d.push(f)}s.insertTableRowsInternal(d,h,!0);var u=void 0,m=void 0;if(s.childWidgets[h]instanceof fa)u=s.childWidgets[h].firstChild,m=this.selection.getFirstParagraph(u);else{for(var y=void 0;!(y instanceof ga);)y=s.nextRenderedWidget;m=this.documentHelper.getFirstParagraphInFirstCell(y)}this.documentHelper.layout.reLayoutTable(s),this.selection.selectParagraphInternal(m,!0)}this.reLayout(this.selection,!0)}},e.prototype.autoFitTable=function(e){if(!this.documentHelper.owner.isReadOnlyMode&&this.canEditContentControl){var t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var r=this.selection.getTable(t,i);r=r.getSplitWidgets()[0];var n=this.documentHelper.layout.getParentTable(r);sf.base.isNullOrUndefined(n)||(this.setOffsetValue(this.selection),n=n.combineWidget(this.owner.viewer),this.initHistory("FitToContents"===e?"TableAutoFitToContents":"FitToWindow"===e?"TableAutoFitToWindow":"TableFixedColumnWidth"),this.documentHelper.owner.editorHistoryModule&&this.cloneTableToHistoryInfo(n),n.updateProperties(!0,r,e),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.layout.reLayoutTable(r),this.reLayout(this.selection,!0))}},e.prototype.updateCellFormatForInsertedRow=function(e,t){for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i].cellFormat.copyFormat(t[i]),e.childWidgets[i].cellFormat.rowSpan=1},e.prototype.updateRowspan=function(e,t,i){for(var r=e.getPreviousRowSpannedCells(!0),n=0,o=[],s=0;s<e.childWidgets.length;s++){for(var a=e.childWidgets[s],l=!1,d=sf.base.isNullOrUndefined(a.previousWidget)||a.columnIndex!==a.previousWidget.columnIndex+1,h=0;h<r.length;h++)if(d){var c=r[h],p=c.ownerRow.rowIndex+c.cellFormat.rowSpan-1;if(a.columnIndex<c.columnIndex&&a.cellIndex!==a.columnIndex&&(l=!0,n++,o.push(a.cellFormat)),1===t.cellFormat.rowSpan)if(p>a.ownerRow.rowIndex){if("Above"===i&&c.ownerRow===t.ownerRow)continue;c.cellFormat.rowSpan+=1,r.splice(h,1),h--}else a.cellIndex!==a.columnIndex&&d&&p===a.ownerRow.rowIndex&&("Above"===i?(c.cellFormat.rowSpan+=1,r.splice(h,1),h--):(n++,o.push(c.cellFormat),r.splice(h,1),h--));else if(c!==t){if("Above"===i&&(c.ownerRow===t.ownerRow||c.columnIndex===t.columnIndex))continue;c.columnIndex!==t.columnIndex&&c.ownerRow.rowIndex!==a.ownerRow.rowIndex&&(p>t.ownerRow.rowIndex||"Above"===i&&p===t.ownerRow.rowIndex)&&(c.cellFormat.rowSpan+=1,r.splice(h,1),h--)}}-1===r.indexOf(a)&&a.cellFormat.rowSpan>1&&(l=!0),l||(n++,o.push(a.cellFormat))}return{count:n,cellFormats:o}},e.prototype.insertTableRows=function(e,t){this.initHistory("InsertTableBelow"),e.containerWidget=t.containerWidget;var i=(t=t.combineWidget(this.owner.viewer)).childWidgets[t.childWidgets.length-1];t.insertTableRowsInternal(e.childWidgets,t.childWidgets.length,!0);var r=this.selection.getFirstParagraph(i.nextWidget.childWidgets[0]);this.checkInsertPosition(this.selection)&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(r,"0"),!0),t.isDefaultFormatUpdated=!1,this.documentHelper.layout.reLayoutTable(t),this.selection.start.setPosition(r.firstChild,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.updateHistoryPosition(this.selection.end,!1),this.selection.end.setPosition(r.firstChild,!0),this.reLayout(this.selection)},e.prototype.insertColumn=function(e,t){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var i=e?"Left":"Right";if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Left"===i?"InsertColumnLeft":"InsertColumnRight"),this.selection.owner.isShiftingEnabled=!0;var r=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward),o=r.ownerRow.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.cloneTableToHistoryInfo(o),this.selection.owner.isLayoutEnabled=!1;var s=r.columnIndex;"Right"===i&&(s=n.columnIndex+n.cellFormat.columnSpan);for(var a=void 0,l=void 0,d=t||this.getColumnCountToInsert(),h=[],c=0;c<d;c++)for(var p=0;p<o.childWidgets.length;p++){var g=o.childWidgets[p];(l=this.createColumn(this.selection.getLastParagraph(r))).index=p,l.rowIndex=g.rowIndex,l.containerWidget=g,l.cellFormat.copyFormat(r.cellFormat),l.cellFormat.rowSpan=1,sf.base.isNullOrUndefined(a)&&(a=this.selection.getFirstParagraph(l)),0===s?g.childWidgets.splice(s,0,l):this.insertSpannedCells(g,h,l,s),this.copyCellFormats(g,s)}this.tableReLayout(o,a,l)}}},e.prototype.copyCellFormats=function(e,t){var i=e.childWidgets[t];if(!sf.base.isNullOrUndefined(i)){var r=i.childWidgets[0];t==e.childWidgets.length-1?--t:++t;var n=e.childWidgets[t].childWidgets[0],o=void 0,s=void 0;n.childWidgets.length>0&&(o=n.childWidgets[0]).children.length>0&&(s=o.children[0]),r.paragraphFormat.copyFormat(n.paragraphFormat),sf.base.isNullOrUndefined(s)?r.characterFormat.copyFormat(n.characterFormat):r.characterFormat.copyFormat(s.characterFormat)}},e.prototype.tableReLayout=function(e,t,i){e.updateRowIndex(0);var r=this.documentHelper.layout.getParentTable(e);r?r.fitChildToClientArea():e.fitChildToClientArea(),this.selection.owner.isLayoutEnabled=!0,e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.skipScrollToPosition=!0,this.documentHelper.layout.reLayoutTable(e),this.selection.start.setPosition(t.firstChild,!0),this.selection.end.setPosition(this.selection.getLastParagraph(i).firstChild,!1),(this.checkIsNotRedoing()||sf.base.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection)},e.prototype.insertSpannedCells=function(e,t,i,r){for(var n=!1,o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];if(s.cellFormat.rowSpan>1&&t.push(s),(s.columnIndex+s.cellFormat.columnSpan===r||r>s.columnIndex&&s.columnIndex+s.cellFormat.columnSpan>r&&r<s.columnIndex+s.cellFormat.columnSpan)&&(e.childWidgets.splice(s.cellIndex+1,0,i),n=!0),n)break}if(!n&&t.length>0)for(var a=0;a<t.length;a++){var l=t[a];if(l.ownerRow!==e&&e.rowIndex<=l.ownerRow.rowIndex+l.cellFormat.rowSpan-1&&(l.columnIndex+l.cellFormat.columnSpan===r?(l.cellIndex>e.childWidgets.length?e.childWidgets.push(i):e.childWidgets.splice(l.cellIndex+1,0,i),n=!0):r>l.columnIndex&&l.columnIndex+l.cellFormat.columnSpan>r&&r<l.columnIndex+l.cellFormat.columnSpan&&(e.childWidgets.splice(l.columnIndex,0,i),n=!0)),n)break}},e.prototype.createTable=function(e,t){this.selection.start.paragraph;var i=new ga;i.tableFormat.preferredWidthType="Auto",i.tableFormat.leftIndent=this.selection.start.paragraph.leftIndent,i.tableFormat.initializeTableBorders();for(var r=0;r<e;){var n=this.createRowAndColumn(t,r);n.rowFormat.heightType="Auto",this.owner.enableTrackChanges&&this.insertRevision(n.rowFormat,"Insertion"),n.containerWidget=i,i.childWidgets.push(n),r++}return i},e.prototype.createRowAndColumn=function(e,t,i,r){var n=r,o=this.selection.start.paragraph,s=new fa;s.rowFormat=new k(s),s.index=t;for(var a=0;a<e;a++){sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(n)||(i&&i>0&&n.childWidgets[i-1]&&n.childWidgets[i-1].childWidgets[a]?o=n.childWidgets[i-1].childWidgets[a].childWidgets[0]:0==i&&(o=n.childWidgets[i].childWidgets[a].childWidgets[0]));var l=this.createColumn(o,!0);l.index=a,l.rowIndex=t,l.containerWidget=s,s.childWidgets.push(l)}return s},e.prototype.createColumn=function(e,t){var i=new ua,r=new ca;if(t){r.paragraphFormat.copyFormat(e.paragraphFormat),r.paragraphFormat.leftIndent=0,r.paragraphFormat.firstLineIndent=0;var n=void 0;sf.base.isNullOrUndefined(e.childWidgets[0])||(n=e.childWidgets[0].children[0]),sf.base.isNullOrUndefined(n)?r.characterFormat.copyFormat(e.characterFormat):r.characterFormat.copyFormat(n.characterFormat)}return r.containerWidget=i,i.childWidgets.push(r),i.cellFormat=new Cl(i),i},e.prototype.getColumnCountToInsert=function(){var e=1,t=this.selection.start,i=this.selection.end;if(this.selection.isForward||(t=this.selection.end,i=this.selection.start),t&&i&&this.selection.getTable(t,i)){if(t.paragraph.associatedCell===i.paragraph.associatedCell)return 1;if(t.paragraph.associatedCell.ownerRow===i.paragraph.associatedCell.ownerRow)return e+i.paragraph.associatedCell.cellIndex-t.paragraph.associatedCell.cellIndex;e=0;for(var r=t.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(t.paragraph.associatedCell,i.paragraph.associatedCell),n=0;n<r.length;n++)t.paragraph.associatedCell.ownerRow===r[n].ownerRow&&e++}return 0===e?1:e},e.prototype.getRowCountToInsert=function(){var e=1,t=this.selection.start,i=this.selection.end;return this.selection.isForward||(t=this.selection.end,i=this.selection.start),sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(this.selection.getTable(t,i))?0===e?1:e:t.paragraph.associatedCell===i.paragraph.associatedCell||t.paragraph.associatedCell.ownerRow===i.paragraph.associatedCell.ownerRow?1:e+this.getOwnerRow(!this.selection.isForward).rowIndex-this.getOwnerRow(this.selection.isForward).rowIndex},e.prototype.getOwnerCell=function(e){for(var t=void 0,i=e?this.selection.start.paragraph.associatedCell:this.selection.end.paragraph.associatedCell,r=e?this.selection.end.paragraph.associatedCell:this.selection.start.paragraph.associatedCell,n=(t=i).ownerTable;!sf.base.isNullOrUndefined(n)&&n.containerWidget instanceof ua&&n!==r.ownerTable;)n=(t=n.containerWidget).ownerTable;return t},e.prototype.getOwnerRow=function(e){for(var t,i=e?this.selection.start.paragraph.associatedCell.ownerRow:this.selection.end.paragraph.associatedCell.ownerRow,r=e?this.selection.end.paragraph.associatedCell.ownerRow:this.selection.start.paragraph.associatedCell.ownerRow,n=(t=i).ownerTable;!sf.base.isNullOrUndefined(n)&&n.containerWidget instanceof ua&&n!==r.ownerTable;)n=(t=n.containerWidget.ownerRow).ownerTable;return t},e.prototype.getOwnerTable=function(e){var t=void 0,i=this.selection.start.paragraph.associatedCell.ownerTable,r=this.selection.end.paragraph.associatedCell.ownerTable;for(t=e?i:r;t.containerWidget instanceof ua&&t!==(e?r:i);)t=t.containerWidget.ownerTable;return t},e.prototype.mergeSelectedCellsInTable=function(){this.canMergeCells()&&(this.owner.enableTrackChanges||this.confirmCellMerge())},e.prototype.confirmCellMerge=function(){this.checkIsNotRedoing()&&this.initHistory("MergeCells"),this.selection.owner.isShiftingEnabled=!0;var e=this.selection.start,t=this.selection.end;this.selection.isForward||(e=this.selection.end,t=this.selection.start);var i=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward),n=this.selection.getContainerCellOf(i,r);if(n.ownerTable.contains(r)&&!this.selection.containsCell(n,r)){var o=i.ownerTable.combineWidget(this.owner.viewer);i=this.selection.getSelectedCell(i,n),r=this.selection.getSelectedCell(r,n);var s=this.mergeSelectedCells(o,i,r),a=this.selection.getFirstParagraph(s);e.setPosition(a.firstChild,!0);var l=this.selection.getLastParagraph(s);t.setPosition(l.lastChild,!1),this.selection.fireSelectionChanged(!1)}(this.checkIsNotRedoing()||sf.base.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection,!1)},e.prototype.mergeSelectedCells=function(e,t,i){this.cloneTableToHistoryInfo(e);this.selection.owner.isLayoutEnabled=!1;var r=this.selection.getCellLeft(t.ownerRow,t),n=r+t.cellFormat.cellWidth,o=this.selection.getCellLeft(i.ownerRow,i),s=o+i.cellFormat.cellWidth,a=this.updateSelectedCellsInTable(r,n,o,s);r=a.start,n=a.end;for(var l,d=e.childWidgets.indexOf(i.ownerRow),h=e.childWidgets.indexOf(t.ownerRow),c=void 0,p=h;p<=d;p++){for(var g=e.childWidgets[p],f=0;f<g.childWidgets.length;f++){var u=g.childWidgets[f],m=this.selection.getCellLeft(g,u);if(x.round(r,2)<=x.round(m,2)&&x.round(m,2)<x.round(n,2)){var y=u.lastChild;if(y instanceof ca&&y.isEmpty()&&u.childWidgets.pop(),sf.base.isNullOrUndefined(c))c=u,l=y;else{p===h&&(c.cellFormat.preferredWidth+=u.cellFormat.preferredWidth,c.cellFormat.columnSpan+=u.cellFormat.columnSpan,this.mergeBorders(c,u));for(var v=0;v<u.childWidgets.length;v++){(I=u.childWidgets[v].clone()).containerWidget=c,c.childWidgets.push(I)}g.childWidgets.splice(f,1),u.destroy(),f--;for(var w=this.documentHelper.contentControlCollection.length-1;w>-1;w--){var b=this.documentHelper.contentControlCollection[w];sf.base.isNullOrUndefined(b.contentControlProperties)&&this.documentHelper.contentControlCollection.splice(w)}}}}if((0===c.childWidgets.length||1===c.childWidgets.length&&c.childWidgets[0]instanceof ga)&&l){var I=l.clone();c.childWidgets.push(I),I.containerWidget=c}if(0===g.childWidgets.length){var F=e.childWidgets.indexOf(g);g.updateRowBySpannedCells(),e.childWidgets.splice(F,1),g.destroy(),d--,p--}}return!sf.base.isNullOrUndefined(c)&&h<d&&(c.cellFormat.rowSpan=d-h+1),this.updateBlockIndexAfterMerge(c),e.updateRowIndex(0),e.calculateGrid(),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e),this.selection.owner.isLayoutEnabled=!0,c},e.prototype.mergeBorders=function(e,t){var i=void 0,r=null;if(sf.base.isNullOrUndefined(e.cellFormat.borders)||(i=e.cellFormat.borders),sf.base.isNullOrUndefined(t.cellFormat.borders)||(r=t.cellFormat.borders),!sf.base.isNullOrUndefined(i)||!sf.base.isNullOrUndefined(r))if(sf.base.isNullOrUndefined(i))(i=new g(e.cellFormat)).copyFormat(r);else{if(sf.base.isNullOrUndefined(r))return;e.ownerRow.rowIndex===t.ownerRow.rowIndex&&(i.top=e.getBorderBasedOnPriority(i.top,r.bottom),i.bottom=e.getBorderBasedOnPriority(i.bottom,r.bottom))}},e.prototype.updateBlockIndexAfterMerge=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t].index=t},e.prototype.canMergeCells=function(){if(this.selection.isEmpty||!this.selection.start.paragraph.isInsideTable||!this.selection.end.paragraph.isInsideTable)return!1;this.selection.start,this.selection.end;this.selection.isForward||(this.selection.end,this.selection.start);var e=this.getOwnerCell(this.selection.isForward),t=this.getOwnerCell(!this.selection.isForward),i=this.selection.getContainerCellOf(e,t);if(i.ownerTable.contains(t)&&!this.selection.containsCell(i,t)){e=this.selection.getSelectedCell(e,i),t=this.selection.getSelectedCell(t,i);var r=1;if(e.ownerRow===t.ownerRow){for(var n=e.ownerRow.childWidgets.indexOf(e),o=n;o<=e.ownerRow.childWidgets.indexOf(t);o++){var s=e.ownerRow.childWidgets[o],a=s.previousWidget;if(o!==n){if(s.cellFormat.rowSpan!==r)return!1;if(!sf.base.isNullOrUndefined(a)&&s.columnIndex!==a.cellFormat.columnSpan+a.columnIndex)return!1}r=s.cellFormat.rowSpan}return!0}return this.canMergeSelectedCellsInTable(e.ownerTable,e,t)}return!1},e.prototype.canMergeSelectedCellsInTable=function(e,t,i){var r=e.childWidgets.indexOf(i.ownerRow),n=e.childWidgets.indexOf(t.ownerRow),o=this.selection.getCellLeft(t.ownerRow,t),s=o+t.cellFormat.cellWidth,a=this.selection.getCellLeft(i.ownerRow,i),l=a+i.cellFormat.cellWidth,d=this.updateSelectedCellsInTable(o,s,a,l);o=d.start,s=d.end;for(var h=0,c=0,p=!1,g=!1,f=[],u=n;u<=r;u++){for(var m=e.childWidgets[u],y=0,v=0,w=!1,b=0;b<m.childWidgets.length;b++){var I=m.childWidgets[b],F=this.selection.getCellLeft(m,I);if(this.checkCellWithInSelection(o,s,F)){p=!1,g=!1,I.cellFormat.rowSpan>1&&f.push(I),w||(y=F,v=F,w=!0);var C=I.previousWidget;0!==v&&x.round(v,0)!==x.round(F,0)&&(v=F),v+=x.convertPointToPixel(I.cellFormat.cellWidth);var W=this.checkPrevOrNextCellIsWithinSel(o,s,I,!0),k=this.checkPrevOrNextCellIsWithinSel(o,s,I,!1),S=0===f.length||1===f.length&&f[0]===I,P=this.checkCurrentCell(f,I,W,k);if(u===r&&!sf.base.isNullOrUndefined(C)&&I.cellFormat.rowSpan>C.cellFormat.rowSpan&&!P)return!1;if(u!==n)for(var N=0;N<f.length;N++){var O=f[N].ownerRow.rowIndex+f[N].cellFormat.rowSpan-1;if(O>=m.rowIndex){if(f[N].columnIndex>I.columnIndex?g=!0:p=!0,u===r&&f[N]!==I&&O>I.ownerRow.rowIndex+I.cellFormat.rowSpan-1)return!1;O!==m.rowIndex||this.checkPrevOrNextCellIsWithinSel(o,s,I,!1)||f.splice(f.indexOf(f[N]),1)}}if(W&&!sf.base.isNullOrUndefined(C)&&S&&I.columnIndex!==C.columnIndex+1&&this.checkCellWidth(I))return!1}}if(u===n)h=y,c=v;else{if(v>0&&y>0&&(!p&&Math.round(h)!==Math.round(y)||!g&&Math.round(c)!==Math.round(v)))return!1;if(u===r)return!0}}return!1},e.prototype.checkCellWidth=function(e){var t=e.previousWidget,i=this.documentHelper.selection.getCellLeft(e.ownerRow,e),r=this.documentHelper.selection.getCellLeft(e.ownerRow,t)+x.convertPointToPixel(t.cellFormat.cellWidth);return x.round(r,2)!==x.round(i,2)},e.prototype.checkCellWithInSelection=function(e,t,i){return x.round(e,2)<=x.round(i,2)&&x.round(i,2)<x.round(t,2)},e.prototype.checkPrevOrNextCellIsWithinSel=function(e,t,i,r){var n,o=r?i.previousWidget:i.nextWidget;return!sf.base.isNullOrUndefined(o)&&(n=this.documentHelper.selection.getCellLeft(o.ownerRow,o),this.checkCellWithInSelection(e,t,n))},e.prototype.checkCurrentCell=function(e,t,i,r){var n=t.ownerRow;if(e.length>0)for(var o=0;o<e.length;o++){var s=e[o].ownerRow,a=s.rowIndex+e[o].cellFormat.rowSpan-1;if(e[o]===t&&(1===e.length||this.checkRowSpannedCells(e,t))&&!r&&!i)return!0;if(e[o]!==t&&s.rowIndex<n.rowIndex&&a===n.rowIndex+t.cellFormat.rowSpan-1)return!0}return!1},e.prototype.checkRowSpannedCells=function(e,t){for(var i=0;i<e.length;i++)if(e[i]!==t&&e[i].columnIndex===t.columnIndex)return!0;return!1},e.prototype.insertNewParagraphWidget=function(e,t){if(this.updateInsertPosition(),this.insertParagraph(e,t),!t){var i=void 0,r=e;do{r=i=this.selection.getNextParagraphBlock(r)}while(i&&i.equals(e));sf.base.isNullOrUndefined(i)?this.selection.selectParagraphInternal(e,!0):this.selection.selectParagraphInternal(i,!0)}this.fireContentChange()},e.prototype.insertParagraph=function(e,t){var i=this.selection.start.currentWidget,r=this.selection.start.offset;this.editorHistory&&this.editorHistory.isUndoing&&this.editorHistory.currentBaseHistoryInfo&&"InsertTextParaReplace"===this.editorHistory.currentBaseHistoryInfo.action&&(r=0);var n=this.selection.start.paragraph;if(n=n.combineWidget(this.owner.viewer),t){var o=this.selection.getLineLength(n.lastChild),s=e.firstChild?e.firstChild.children.length:0;this.moveInlines(n,e,s,r,i,o,n.lastChild)}else if(r>0){var a=n.getLength();if(this.moveInlines(n,e,0,0,n.firstChild,r,i),a===r&&n.characterFormat.revisions.length>0)for(;n.characterFormat.revisions.length>0;)e.characterFormat.revisions.push(n.characterFormat.revisions.shift())}var l=n.getSplitWidgets(),d=(n=t?l[l.length-1]:l[0]).containerWidget.childWidgets.indexOf(n);t&&d++;var h=n.containerWidget;e.index=n.index,e.containerWidget=h,h.childWidgets.splice(d,0,e),this.constructRevisionsForBlock(e,!0),this.updateNextBlocksIndex(t?n:e,!0),e.height=0,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,h,e,!1)},e.prototype.moveInlines=function(e,t,i,r,n,o,s,a){if(0===t.childWidgets.length){var l=new ma(t);t.childWidgets.push(l)}var d=!1;this.documentHelper.layout.clearListElementBox(e),this.documentHelper.layout.clearListElementBox(t);for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[h];if(n===c&&s===c){i=this.moveContent(c,r,o,i,t);break}if(s===c){i=this.moveContent(c,0,o,i,t);break}n===c?(d=!0,i=this.moveContent(c,r,this.documentHelper.selection.getLineLength(c),i,t)):d&&(i=this.moveContent(c,0,this.documentHelper.selection.getLineLength(c),i,t))}this.removeEmptyLine(e),e.isInsideTable||a||(this.viewer.updateClientArea(e.bodyWidget,e.bodyWidget.page),this.documentHelper.layout.reLayoutParagraph(e,0,0))},e.prototype.moveContent=function(e,t,i,r,n){for(var o=0,s=0;s<e.children.length;s++){var a=e.children[s];if(t>=o+a.length||a instanceof Va)a instanceof Va||(o+=a.length);else{var l=0;t>o&&(l=t-o);var d=i-o;if(d>a.length&&(d=a.length),l>0&&(o+=l),0===l&&d===a.length){if(a instanceof Ba){var h=e.paragraph.floatingElements.indexOf(a);-1!==h&&e.paragraph.floatingElements.splice(h,1)}n.firstChild.children.splice(r,0,a),a.line=n.firstChild,r++,e.children.splice(s,1),s--}else if(a instanceof Fa){var c=new Fa;c.characterFormat.copyFormat(a.characterFormat),c.text=a.text.substr(l,d-l),a.ischangeDetected=!0,c.ischangeDetected=!0,n.firstChild.children.splice(r,0,c),c.line=n.firstChild,r++,this.updateRevisionForMovedContent(a,c),a.text=a.text.slice(0,l)+a.text.slice(d),a.ischangeDetected=!0}if(i<=o+d-l)break;o+=d-l}}return r},e.prototype.updateRevisionForMovedContent=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i],n=r.range.indexOf(e);t.revisions.splice(0,0,r),r.range.splice(n,0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(r)}},e.prototype.updateComplexWithoutHistory=function(e,t,i){var r=this.documentHelper.selection;if(0===e){var n=new Al(r.owner);this.setPositionForCurrentIndex(n,t),this.documentHelper.layout.reLayoutParagraph(n.paragraph,0,0),this.setPositionForCurrentIndex(r.start,i),this.setPositionForCurrentIndex(r.end,i)}if(1===e){n=new Al(r.owner);this.setPositionForCurrentIndex(n,t);var o=new Al(r.owner);this.setPositionForCurrentIndex(o,i),this.documentHelper.layout.reLayoutParagraph(n.paragraph,0,0),o.paragraph!==n.paragraph&&this.documentHelper.layout.reLayoutParagraph(o.paragraph,0,0)}r.owner.isShiftingEnabled&&(this.documentHelper.layout.shiftLayoutedItems(!1),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget()),r.owner.isShiftingEnabled=!1,r.start.updatePhysicalPosition(!0),r.isEmpty?r.end.setPositionInternal(r.start):r.end.updatePhysicalPosition(!0),r.upDownSelectionLength=r.end.location.x,r.fireSelectionChanged(!0),this.documentHelper.updateFocus(),this.owner.viewer.updateScrollBars(),this.fireContentChange(),this.isHandledComplex=!0},e.prototype.reLayout=function(e,t,i){if(!sf.base.isNullOrUndefined(this.previousBlockToLayout)){var r=this.previousBlockToLayout;this.documentHelper.layout.layoutBodyWidgetCollection(r.index,r.bodyWidget,r,!1,!1),this.previousBlockToLayout=void 0}if(this.documentHelper.isComposingIME||!this.editorHistory||!this.editorHistory.isHandledComplexHistory()||(this.editorHistory.currentHistoryInfo&&"ClearFormat"!==this.editorHistory.currentHistoryInfo.action&&"ApplyStyle"!==this.editorHistory.currentHistoryInfo.action&&("DragAndDropContent"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.layout.shiftLayoutedItems(!0),this.startParagraph=void 0,this.endParagraph=void 0),this.isHandledComplex=!1,this.editorHistory.currentHistoryInfo&&("ColumnBreak"===this.editorHistory.currentHistoryInfo.action||"PageBreak"===this.editorHistory.currentHistoryInfo.action))){if(sf.base.isNullOrUndefined(e.editRegionHighlighters)||e.editRegionHighlighters.clear(),sf.base.isNullOrUndefined(this.documentHelper.blockToShift)&&(this.documentHelper.removeEmptyPages(),this.documentHelper.layout.updateFieldElements(),this.owner.viewer.updateScrollBars(),e.owner.isShiftingEnabled&&!this.documentHelper.isRowOrCellResizing||(e.fireSelectionChanged(!0),this.startParagraph=void 0,this.endParagraph=void 0)),sf.base.isNullOrUndefined(t)&&(t=e.isEmpty),this.owner.showRevisions&&this.owner.trackChangesPane.isUpdateTrackChanges(this.owner.revisions.length)&&this.owner.trackChangesPane.updateTrackChanges(),e.owner.isShiftingEnabled){e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0;var n=e.start.paragraph.bodyWidget,o=n.getSplitWidgets();n=o[o.length-1];var s=!!(this.editorHistory&&this.editorHistory.currentHistoryInfo&&"ColumnBreak"===this.editorHistory.currentHistoryInfo.action&&this.documentHelper.layout.isMultiColumnDoc);if(!(!sf.base.isNullOrUndefined(n.nextRenderedWidget)&&"NoBreak"===n.nextRenderedWidget.sectionFormat.breakCode&&this.documentHelper.layout.isMultiColumnDoc||"NoBreak"===n.sectionFormat.breakCode&&n.sectionIndex===n.page.bodyWidgets[0].sectionIndex&&n.sectionFormat.numberOfColumns>1||s)||n instanceof la||!sf.base.isNullOrUndefined(n.containerWidget)&&n.containerWidget instanceof ha)this.documentHelper.layout.shiftLayoutedItems(!0);else{var a=this.documentHelper.selection.start,l=this.documentHelper.selection.end,d=this.selection.getParagraphInfo(a),h=this.selection.getParagraphInfo(l),c=this.selection.getHierarchicalIndex(d.paragraph,d.offset.toString()),p=this.selection.getHierarchicalIndex(h.paragraph,h.offset.toString());this.documentHelper.layout.shiftLayoutedItems(!0),this.setPositionForCurrentIndex(a,c),this.setPositionForCurrentIndex(l,p),this.documentHelper.selection.selectPosition(a,l),this.owner.viewer.updateScrollBars()}this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),this.documentHelper.isRowOrCellResizing||(sf.base.isNullOrUndefined(e.start.paragraph)||!sf.base.isNullOrUndefined(e.start.paragraph.bodyWidget.containerWidget)&&e.start.paragraph.bodyWidget.containerWidget instanceof ha&&("Footnote"===e.start.paragraph.bodyWidget.containerWidget.footNoteType?(this.documentHelper.layout.isRelayoutFootnote=!0,this.shiftFootnotePageContent(e.start.paragraph.bodyWidget.containerWidget)):(this.documentHelper.layout.isRelayoutFootnote=!1,this.shiftFootnotePageContent())),this.getOffsetValue(e),e.upDownSelectionLength=e.end.location.x,e.fireSelectionChanged(!0),this.owner.enableAutoFocus&&this.documentHelper.updateFocus(),this.startParagraph=void 0,this.endParagraph=void 0)}else this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget();this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&("RowResizing"!==this.editorHistory.currentBaseHistoryInfo.action&&"CellResizing"!==this.editorHistory.currentBaseHistoryInfo.action||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length>0&&this.editorHistory.currentBaseHistoryInfo.updateSelection(),this.editorHistory.undoStack&&this.editorHistory.undoStack.length>0&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1]instanceof od&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions&&this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions[this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].modifiedActions.length-1]===this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo=void 0:this.editorHistory.updateHistory()),i||(this.fireContentChange(),this.owner.documentHelper.layout.isRelayout=!1,this.isFootnoteElementRemoved=!1,this.isEndnoteElementRemoved=!1)}},e.prototype.updateHeaderFooterWidget=function(e){sf.base.isNullOrUndefined(e)&&(e=this.selection.start.paragraph.bodyWidget),this.updateHeaderFooterWidgetToPage(e),this.shiftPageContent(e.headerFooterType,e.sectionFormat),this.viewer.updateScrollBars()},e.prototype.updateHeaderFooterWidgetToPage=function(e){e.page;for(var t="EvenHeader"===e.headerFooterType||"EvenFooter"===e.headerFooterType,i="FirstPageHeader"===e.headerFooterType||"FirstPageFooter"===e.headerFooterType,r=0;r<this.documentHelper.pages.length;r++){var n=this.documentHelper.pages[r];!n.bodyWidgets[0].sectionFormat.differentFirstPage||!i||n.headerWidgetIn.headerFooterType!=e.headerFooterType&&n.footerWidgetIn.headerFooterType!=e.headerFooterType?n.bodyWidgets[0].sectionFormat.differentFirstPage&&(i||!i&&0==n.index||n.sectionIndex!=n.previousPage.sectionIndex)||(n.bodyWidgets[0].sectionFormat.differentOddAndEvenPages?t&&(r+1)%2==0?this.updateHeaderFooterWidgetToPageInternal(n,e,-1!==e.headerFooterType.indexOf("Header")):t||(r+1)%2==0||(r>0||!n.bodyWidgets[0].sectionFormat.differentFirstPage)&&this.updateHeaderFooterWidgetToPageInternal(n,e,-1!==e.headerFooterType.indexOf("Header")):this.updateHeaderFooterWidgetToPageInternal(n,e,-1!==e.headerFooterType.indexOf("Header"))):this.updateHeaderFooterWidgetToPageInternal(n,e,-1!==e.headerFooterType.indexOf("Header"))}},e.prototype.updateHeaderFooterWidgetToPageInternal=function(e,t,i){if(i?t!=e.headerWidgetIn&&t.page.headerWidget==e.headerWidget:t!=e.footerWidgetIn&&t.page.footerWidget==e.footerWidget){var r=t.clone();this.documentHelper.layout.clearBlockWidget(r.childWidgets,!0,!0,!0),r.page=e,r.parentHeaderFooter=t,this.owner.viewer.updateHFClientArea(r.sectionFormat,i),r=this.documentHelper.layout.layoutHeaderFooterItems(this.owner.viewer,r);var n=void 0;i?(n=e.headerWidgetIn,e.headerWidget=r):(n=e.footerWidgetIn,e.footerWidget=r),this.removeFieldInWidget(n),this.removeFieldInWidget(n,void 0,!0),n.destroy()}},e.prototype.removeFieldInWidget=function(e,t,i){sf.base.isNullOrUndefined(t)&&(t=!1);for(var r=0;r<e.childWidgets.length;r++)this.removeFieldInBlock(e.childWidgets[r],t,i)},e.prototype.removeFieldInBlock=function(e,t,i){if(e instanceof ga){if(e.wrapTextAround&&!sf.base.isNullOrUndefined(e.bodyWidget)){var r=e.bodyWidget.floatingElements.indexOf(e);-1!==r&&e.bodyWidget.floatingElements.splice(r,1)}this.removeFieldTable(e,t,i)}else if(e instanceof fa)for(var n=0;n<e.childWidgets.length;n++)this.removeFieldInWidget(e.childWidgets[n],t,i);else this.removeField(e,t,i)},e.prototype.removeFieldTable=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++)for(var n=e.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.removeFieldInWidget(n.childWidgets[o],t,i)},e.prototype.shiftFootnotePageContent=function(e){var t=this.documentHelper.pages[0].bodyWidgets[0];if(!sf.base.isNullOrUndefined(e)){var i=this.documentHelper.pages.indexOf(e.page);t=this.documentHelper.pages[i].bodyWidgets[0]}sf.base.isNullOrUndefined(t.page.footnoteWidget)||this.checkAndShiftFromBottom(t.page,t.page.footnoteWidget),sf.base.isNullOrUndefined(t.page.endnoteWidget),this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1))},e.prototype.shiftPageContent=function(e,t){var i;if(-1!==e.indexOf("First"))i=0;else if(t.differentOddAndEvenPages){var r=-1!==e.indexOf("Even");i=t.differentFirstPage?r?1:2:r?1:0}else 1===(i=t.differentFirstPage?1:0)&&1===this.documentHelper.pages.length&&(i=0);var n=this.documentHelper.pages[i].bodyWidgets[0];do{if(-1!==e.indexOf("Header")){var o=n.page.headerWidget,s=!o.isEmpty||o.isEmpty&&this.owner.enableHeaderAndFooter,a=n.firstChild,l=x.convertPointToPixel(t.topMargin),d=x.convertPointToPixel(t.headerDistance);if(s&&(l=Math.max(d+n.page.headerWidget.height,l)),a.y!==l&&"NoBreak"!==n.sectionFormat.breakCode){this.owner.viewer.updateClientArea(n,n.page);var h=(a=a.combineWidget(this.owner.viewer)).previousRenderedWidget;h&&(!a.containerWidget.equals(h.containerWidget)||h.containerWidget.lastChild instanceof ca&&(h.containerWidget.lastChild.isEndsWithPageBreak||h.containerWidget.lastChild.isEndsWithColumnBreak)||(this.owner.viewer.cutFromTop(h.y+h.height),this.documentHelper.layout.updateContainerWidget(a,h.containerWidget,h.indexInOwner+1,!1))),this.documentHelper.blockToShift=a}}else this.checkAndShiftFromBottom(n.page,n.page.footerWidget);for(this.documentHelper.blockToShift&&(this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[],this.documentHelper.layout.shiftLayoutedItems(!1));n;){var c=n;do{var p=n.getSplitWidgets();n=p[p.length-1].nextRenderedWidget}while(n&&c.page===n.page);if(n){if(0===i)break;if(n.page.index+1===0&&1===i||n.page.index+1!==0&&2===i)break;var g=n.page.nextPage;if(!sf.base.isNullOrUndefined(g)&&g.bodyWidgets[0].equals(n)){n=g.bodyWidgets[0];break}}}}while(n)},e.prototype.checkAndShiftFromBottom=function(e,t){var i,r=e.bodyWidgets[0];if(r.childWidgets.length>1){for(var n=0;n<r.childWidgets.length;n++){var o=r.childWidgets[n];if(o.y+o.height>t.y){i=o;break}if(!(t instanceof ha)&&r.childWidgets.length-1===n&&o.y+o.height<t.y){i=o;break}}sf.base.isNullOrUndefined(i)||(this.owner.viewer.updateClientArea(r,e,!0),this.owner.viewer.cutFromTop(i.y),this.documentHelper.blockToShift=i)}},e.prototype.allowFormattingInFormFields=function(e){if("FormFieldsOnly"===this.documentHelper.protectionType&&this.selection.isInlineFormFillMode()&&!sf.base.isNullOrUndefined(this.owner.documentEditorSettings.formFieldSettings.formattingExceptions))for(var t=0;t<this.owner.documentEditorSettings.formFieldSettings.formattingExceptions.length;t++)if(e.toLowerCase()===this.owner.documentEditorSettings.formFieldSettings.formattingExceptions[t].toLowerCase())return!0;return!1},e.prototype.getContentControl=function(){for(var e=0;e<this.documentHelper.contentControlCollection.length;e++){var t=this.documentHelper.contentControlCollection[e],i=this.selection.getPosition(t),r=i.startPosition,n=i.endPosition,o=this.selection.start,s=this.selection.end;if(this.selection.isForward||(o=this.selection.end,s=this.selection.start),(o.isExistAfter(r)||o.isAtSamePosition(r))&&(s.isExistBefore(n)||s.isAtSamePosition(n)))return t}},e.prototype.checkPlainTextContentControl=function(){var e=this.selection.start,t=this.selection.end;this.selection.isForward||(t=this.selection.start,e=this.selection.end);var i=0,r=0,n=e.currentWidget.getInline(e.offset,i),o=t.currentWidget.getInline(t.offset,r);i=n.index,r=o.index;var s,a,l=n.element,d=o.element;if(l&&l.contentControlProperties&&"Text"===l.contentControlProperties.type||d&&d.contentControlProperties&&"Text"===d.contentControlProperties.type){if((l=this.getContentControl()).contentControlProperties&&!sf.base.isNullOrUndefined(l)){var h=l.line.getOffset(l,1);(s=new Al(this.owner)).setPositionParagraph(l.line,h)}else s=e;if(d.contentControlProperties&&l.reference){var c=(d=l.reference).line.getOffset(d,d.length);(a=new Al(this.owner)).setPositionParagraph(d.line,c)}else a=t;this.selection.selectRange(s,a)}else e.paragraph.contentControlProperties&&"Text"===e.paragraph.contentControlProperties.type&&this.selection.selectParagraph()},e.prototype.onApplyCharacterFormat=function(e,t,i,r){var n=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(e);if(!(this.restrictFormatting&&!n||this.selection.checkContentControlLocked(!0))){this.documentHelper.layout.isBidiReLayout=!0;var o=this.documentHelper.selection;if((!o.owner.isReadOnlyMode||n)&&o.owner.isDocumentLoaded){i=!sf.base.isNullOrUndefined(i)&&i,r=!sf.base.isNullOrUndefined(r)&&r;var s=e[0].toUpperCase()+e.slice(1),a=o.start.paragraph;a.childWidgets[a.childWidgets.length-1];if(this.checkPlainTextContentControl(),o.isEmpty&&"List"!==o.contextType&&!r)return o.skipFormatRetrieval=!0,o.end.isAtParagraphEnd?(this.initHistory(s),this.documentHelper.owner.isShiftingEnabled=!0,this.applyCharFormatValue(a.characterFormat,e,t,i),this.reLayout(this.documentHelper.selection),this.documentHelper.updateFocus()):o.fireSelectionChanged(!0),void(o.skipFormatRetrieval=!1);if("highlightColor"===e&&o.start.isInSameParagraph(o.end)){var l=o.start,d=o.end;if(this.selection.isForward||(d=o.start,l=o.end),d.offset===o.getLineLength(d.currentWidget)+1&&d.offset-1===l.offset)return}this.setOffsetValue(o),this.initHistory(s),"List"===o.contextType?this.applyCharacterFormatForListText(o,e,t,i):this.updateSelectionCharacterFormatting(e,t,i),this.documentHelper.layout.isBidiReLayout=!1}}},e.prototype.applyCharacterFormatForListText=function(e,t,i,r){var n=e.getListLevel(e.start.paragraph);if(!sf.base.isNullOrUndefined(n)){var o=n.characterFormat;switch(t){case"bold":this.applyListCharacterFormatByValue(e,o,"bold",!o.bold);break;case"italic":this.applyListCharacterFormatByValue(e,o,"italic",!o.italic);break;case"fontColor":this.applyListCharacterFormatByValue(e,o,"fontColor",i);break;case"fontFamily":this.applyListCharacterFormatByValue(e,o,"fontFamily",i);break;case"fontSize":this.applyListCharacterFormatByValue(e,o,"fontSize",i);break;case"highlightColor":this.applyListCharacterFormatByValue(e,o,"highlightColor",i);break;case"baselineAlignment":o.baselineAlignment===i&&(i="Normal"),this.applyListCharacterFormatByValue(e,o,"baselineAlignment",i);break;case"strikethrough":o.strikethrough===i&&(i="None"),this.applyListCharacterFormatByValue(e,o,"strikethrough",i);break;case"underline":o.underline===i&&(i="None"),this.applyListCharacterFormatByValue(e,o,"underline",i);break;case"characterFormat":this.applyListCharacterFormatByValue(e,o,void 0,i)}}},e.prototype.applyListCharacterFormatByValue=function(e,t,i,r){this.initHistory("ListCharacterFormat"),this.applyCharFormatValue(t,i,r,!1),this.editorHistory.updateHistory(),this.reLayout(e),this.fireContentChange()},e.prototype.updateListCharacterFormat=function(e,t,i){this.updateListTextSelRange(e,t,i,!1)},e.prototype.updateListTextSelRange=function(e,t,i,r){this.documentHelper.owner.isShiftingEnabled=!0;var n=e.start,o=e.end;e.isForward||(n=e.end,o=e.start),this.initHistoryPosition(e,n);var s=e.getListLevel(e.start.paragraph);this.applyCharFormatValue(s.characterFormat,t,i,r),this.startSelectionReLayouting(n.paragraph,e,n,o)},e.prototype.updateInsertPosition=function(){var e=this.documentHelper.selection,t=e.start;e.isForward||(t=e.end),!this.editorHistory||sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&this.updateHistoryPosition(t,!0)},e.prototype.setOffsetValue=function(e){var t=this.selection.getParagraphInfo(e.start);this.startParagraph=t.paragraph,this.startOffset=t.offset,t=this.selection.getParagraphInfo(e.end),this.endParagraph=t.paragraph,this.endOffset=t.offset},e.prototype.toggleHighlightColor=function(e){var t=this.documentHelper.selection;(sf.base.isNullOrUndefined(e)||"NoColor"===e)&&(e="Yellow"),t.characterFormat.highlightColor===e&&(e="NoColor"),this.selection.characterFormat.highlightColor=e},e.prototype.toggleSubscript=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting){var e="Subscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Subscript";this.selection.characterFormat.baselineAlignment=e}},e.prototype.toggleSuperscript=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting){var e="Superscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Superscript";this.selection.characterFormat.baselineAlignment=e}},e.prototype.increaseIndent=function(){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("leftIndent",this.documentHelper.defaultTabWidth,!0,!1)},e.prototype.decreaseIndent=function(){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.onApplyParagraphFormat("leftIndent",-this.documentHelper.defaultTabWidth,!0,!1)},e.prototype.clearList=function(){this.selection.owner.editorModule.onApplyList(void 0)},e.prototype.applyBullet=function(e,t){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.applyBulletOrNumbering(e,"Bullet",t)},e.prototype.applyNumbering=function(e,t){this.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||this.applyBulletOrNumbering(e,t,"Verdana")},e.prototype.toggleBaselineAlignment=function(e){this.updateProperty(2,e)},e.prototype.clearFormattingInternal=function(e){var t=this.documentHelper.selection;this.setPreviousBlockToLayout(),this.initComplexHistory("ClearFormat"),(t.isEmpty||!sf.base.isNullOrUndefined(e)&&e)&&(t.start.moveToParagraphStartInternal(t,!1),t.end.moveToParagraphEndInternal(t,!1)),this.setOffsetValue(t),this.editorHistory&&this.editorHistory.initializeHistory("ClearCharacterFormat"),this.updateSelectionCharacterFormatting("ClearCharacterFormat",void 0,!1),this.getOffsetValue(t),this.editorHistory&&this.editorHistory.updateHistory(),this.setOffsetValue(t),this.editorHistory&&this.editorHistory.initializeHistory("ClearParagraphFormat"),this.updateParagraphFormatInternal("ClearParagraphFormat",void 0,!1),this.editorHistory&&this.editorHistory.updateHistory(),this.getOffsetValue(t),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.startParagraph=void 0,this.endParagraph=void 0},e.prototype.clearFormatting=function(){this.clearFormattingInternal()},e.prototype.updateProperty=function(e,t){var i=this.selection;if((!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())&&i.owner.isDocumentLoaded){var r=i.start;i.end;i.isForward||(r=i.end,i.start);var n=0,o=r.currentWidget.getInline(r.offset,n),s=o.element;n=o.index;var a=r.paragraph;if(sf.base.isNullOrUndefined(s)||s.length!==n||this.selection.isEmpty||(s=s.nextNode),1===e){var l="None";sf.base.isNullOrUndefined(s)?sf.base.isNullOrUndefined(a)||(l=a.characterFormat.underline):l=s.characterFormat.underline,this.selection.characterFormat.underline=t===l?"None":t}else{var d="Normal";sf.base.isNullOrUndefined(s)?sf.base.isNullOrUndefined(a)||(d=a.characterFormat.baselineAlignment):d=s.characterFormat.baselineAlignment,d===t&&(t="Normal"),this.selection.characterFormat.baselineAlignment=t}}},e.prototype.getCompleteStyles=function(){for(var e='{"styles":[',t=0,i=this.documentHelper.preDefinedStyles.keys;t<i.length;t++){var r=i[t];e+=this.documentHelper.preDefinedStyles.get(r)+","}return e.slice(0,-1)+"]}"},e.prototype.intializeDefaultStyles=function(){for(var e=this.owner.getStyleNames("Paragraph"),t=0,i=["Normal","Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6","Heading 7","Heading 8","Heading 9","Header","Footer"].filter((function(t){return-1===e.indexOf(t)}));t<i.length;t++){var r=i[t];this.createStyle(this.documentHelper.preDefinedStyles.get(r))}},e.prototype.createStyle=function(e,t){return this.createStyleIn(e,t).name},e.prototype.createStyleIn=function(e,t){var i=JSON.parse(e),r=this.documentHelper.styles.findByName(i.name),n=i.type;return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(t)||!t?(void 0!==r&&(i.name=this.getUniqueStyleName(i.name)),this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),i,this.documentHelper.styles,!0)):n===r.type?this.setStyle(r,i):(i.name=this.getUniqueStyleName(i.name),this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),i,this.documentHelper.styles,!0)),this.documentHelper.styles.findByName(i.name)},e.prototype.setStyle=function(e,t){if(!sf.base.isNullOrUndefined(t.basedOn)){var i=this.documentHelper.styles.findByName(t.basedOn);if(sf.base.isNullOrUndefined(i)){var r=this.getStyle(t.basedOn,JSON.parse(this.getCompleteStyles())),n=void 0;n=sf.base.isNullOrUndefined(r)||r.type!==t.type?"Paragraph"===t.type?JSON.parse('{"type":"Paragraph","name":"Normal","next":"Normal"}'):JSON.parse('{"type": "Character","name": "Default Paragraph Font"}'):r,e.basedOn=this.documentHelper.styles.findByName(n.name)}else i.type===t.type&&(e.basedOn=i)}if(!sf.base.isNullOrUndefined(t.next)&&"Paragraph"===t.type)if(t.next===t.name)e.next=e;else{var o=this.documentHelper.styles.findByName(t.next);sf.base.isNullOrUndefined(o)||o.type!==e.type?e.next=e:e.next=o}if(!sf.base.isNullOrUndefined(t.link)){var s=this.documentHelper.styles.findByName(t.link),a=void 0;if(sf.base.isNullOrUndefined(s)||"Character"!==s.type){var l={};l.characterFormat=t.characterFormat,void 0!==this.documentHelper.styles.findByName(t.name+" Char").name?l.name=this.getUniqueStyleName(t.name)+" Char":l.name=t.name+" Char",l.type="Character",l.basedOn="Default Paragraph Font",a=l,this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),a,this.documentHelper.styles),e.link=this.documentHelper.styles.findByName(a.name)}else this.documentHelper.owner.parser.parseCharacterFormat(0,t.characterFormat,s.characterFormat),e.link=s;if("Character"==t.type)for(var d=0;d<this.documentHelper.styles.length;d++){var h=this.documentHelper.styles.getItem(d),c=h.link,p=void 0===c?"":c.name;"Paragraph"===h.type&&p===t.link&&(sf.base.isNullOrUndefined(h.characterFormat)||this.documentHelper.owner.parser.parseCharacterFormat(0,t.characterFormat,h.characterFormat))}}sf.base.isNullOrUndefined(t.paragraphFormat)||this.documentHelper.owner.parser.parseParagraphFormat(0,t.paragraphFormat,e.paragraphFormat),sf.base.isNullOrUndefined(t.characterFormat)||this.documentHelper.owner.parser.parseCharacterFormat(0,t.characterFormat,e.characterFormat)},e.prototype.getStyle=function(e,t){for(var i=0;i<t.styles.length;i++)if(t.styles[i].name===e)return t.styles[i]},e.prototype.getUniqueStyleName=function(e){for(var t=this.getUniqueName(e),i=this.documentHelper.styles.findByName(t);!sf.base.isNullOrUndefined(i);)t=this.getUniqueStyleName(i.name),i=this.documentHelper.styles.findByName(t);return t},e.prototype.getUniqueName=function(e){var t=e.match(/\d+$/);return!sf.base.isNullOrUndefined(t)&&t.length>0?e.replace(t[0],(parseInt(t[0],10)+1).toString()):e+"_1"},e.prototype.updateSelectionCharacterFormatting=function(e,t,i){switch(sf.base.isNullOrUndefined(e)&&(e="CharacterFormat"),e){case"bold":this.updateCharacterFormat("bold",t);break;case"italic":this.updateCharacterFormat("italic",t);break;case"fontColor":this.updateCharacterFormat("fontColor",t);break;case"fontFamily":this.updateCharacterFormat("fontFamily",t);break;case"fontSize":this.documentHelper.layout.isBidiReLayout=!1,this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"fontSize",t,i);break;case"highlightColor":this.updateCharacterFormat("highlightColor",t);break;case"baselineAlignment":this.updateCharacterFormat("baselineAlignment",t);break;case"strikethrough":this.updateCharacterFormat("strikethrough",t);break;case"underline":this.updateCharacterFormat("underline",t);break;case"styleName":this.updateCharacterFormatWithUpdate(this.documentHelper.selection,"styleName",t,!0,!0);break;case"CharacterFormat":case"ClearCharacterFormat":this.updateCharacterFormat(void 0,t);break;case"allCaps":this.updateCharacterFormat("allCaps",t)}this.reLayout(this.documentHelper.selection)},e.prototype.updateCharacterFormat=function(e,t){this.updateCharacterFormatWithUpdate(this.documentHelper.selection,e,t,!1)},e.prototype.updateCharacterFormatWithUpdate=function(e,t,i,r,n){n=!sf.base.isNullOrUndefined(n)&&n,this.documentHelper.owner.isShiftingEnabled=!0;var o=e.start,s=e.end;if(e.isEmpty||e.isForward||(o=e.end,s=e.start),e.isEmpty&&n){var a=o.offset,l=o.clone(),d=s.clone();this.selection.selectCurrentWord(),a!==this.selection.start.offset&&a!==this.selection.end.offset-1||(this.selection.start=l,this.selection.end=d)}this.applyCharFormatSelectedContent(o.paragraph,e,o,s,t,i,r)},e.prototype.applyCharFormatSelectedContent=function(e,t,i,r,n,o,s){if(!i.paragraph.isInsideTable||r.paragraph.isInsideTable&&i.paragraph.associatedCell===r.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,r))this.applyCharFormat(e,t,i,r,n,o,s);else{var a;i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),a=i.paragraph.associatedCell,this.applyCharFormatCell(a,t,i,r,n,o,s);var l=a.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(l.index,l.containerWidget,l,!1)}},e.prototype.applyCharFormatForSelectedPara=function(e,t,i,r,n){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.children.length;a++){var l=s.children[a];this.applyCharFormatValue(l.characterFormat,i,r,n)}this.applyCharFormatValue(e.characterFormat,i,r,n)},e.prototype.splittedLastParagraph=function(e){var t=e.getSplitWidgets();return t[t.length-1]},e.prototype.getNextParagraphForCharacterFormatting=function(e,t,i,r,n,o){var s=e.getSplitWidgets();e=s[s.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e),sf.base.isNullOrUndefined(e)||(e instanceof ca?this.applyCharFormat(e,this.documentHelper.selection,t,i,r,n,o):this.applyCharFormatForTable(0,e,this.documentHelper.selection,t,i,r,n,o))},e.prototype.applyCharFormat=function(e,t,i,r,n,o,s){e=e.combineWidget(this.owner.viewer);var a=0,l=t.getParagraphLength(e),d=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):0,h=r.offset,c=-1!==e.childWidgets.indexOf(r.currentWidget)?e.childWidgets.indexOf(r.currentWidget):e.childWidgets.length-1;if(sf.base.isNullOrUndefined(t)||e===i.paragraph&&(a=i.offset),e.equals(r.paragraph)){p=e.childWidgets[e.childWidgets.length-1];t.isParagraphLastLine(p)&&r.currentWidget===p&&(h===t.getLineLength(p)+1||t.isEmpty&&t.end.isAtParagraphEnd)&&this.applyCharFormatValue(e.characterFormat,n,o,s)}else{var p=e.childWidgets[e.childWidgets.length-1];"highlightColor"===n&&t.isParagraphLastLine(p)&&i.currentWidget===p&&i.offset===t.getLineLength(p)||this.applyCharFormatValue(e.characterFormat,n,o,s),h=l}for(var g=d;g<=c;g++){var f=e.childWidgets[g];g!==d&&(a=t.getStartLineOffset(f)),h=f===r.currentWidget?r.offset:t.getLineLength(f);for(var u=0,m=void 0,y=-1,v=!0,w=0;w<f.children.length;v?w++:w--){var b=f.children[w];if(!(b instanceof Va))if(m===b&&(m=void 0,w=y,y=-1,v=!0),a>=u+b.length)u+=b.length;else{var x=0;a>u&&(x=a-u);var I=h-u,F=b.length;if(I>F&&(I=F),w+=this.applyCharFormatInline(b,t,x,I,n,o,s),h<=u+F)break;u+=F}}}var C=r.paragraph;this.documentHelper.layout.reLayoutParagraph(e,d,0),e.equals(C)||this.getNextParagraphForCharacterFormatting(e,i,r,n,o,s)},e.prototype.toggleBold=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("bold");this.selection.characterFormat.bold=e}},e.prototype.toggleItalic=function(){if(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("italic");this.selection.characterFormat.italic=e}},e.prototype.changeCase=function(e){if(!this.selection.isEmpty&&(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())){this.initHistory(e),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.selection,i=t.start,r=t.end;t.isForward||(i=t.end,r=t.start),this.changeSelectedTextCase(t,i,r,e),this.reLayout(t)}},e.prototype.changeSelectedTextCase=function(e,t,i,r,n){var o=this.selection.getParagraphInfo(t);e.editPosition=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(t,!0);var s=this.editorHistory.isUndoing;s&&!sf.base.isNullOrUndefined(n)&&n.length>0&&(this.removedTextNodes=n);var a=i.selection.endOffset;this.changeTextCase(t.paragraph,e,t,i,r,s),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(i.selection.endOffset!==a&&(i=e.getTextPosBasedOnLogicalIndex(a)),this.checkEndPosition(e)&&this.updateHistoryPosition(i,!1),e.selectPosition(t,i))},e.prototype.changeTextCase=function(e,t,i,r,n,o){if(!i.paragraph.isInsideTable||r.paragraph.isInsideTable&&i.paragraph.associatedCell===r.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,r))this.changeCaseParagraph(e,t,i,r,n,o);else{var s;i.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),s=i.paragraph.associatedCell,this.changeCaseParaFormatInCell(s,i,r,n,o);var a=s.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(a.index,a.containerWidget,a,!1)}},e.prototype.changeCaseParagraph=function(e,t,i,r,n,o){e=e.combineWidget(this.owner.viewer);var s=0,a=t.getParagraphLength(e),l=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):0,d=r.offset,h=-1!==e.childWidgets.indexOf(r.currentWidget)?e.childWidgets.indexOf(r.currentWidget):e.childWidgets.length-1;sf.base.isNullOrUndefined(t)||e===i.paragraph&&(s=i.offset),e.equals(r.paragraph)||(d=a);for(var c=l;c<=h;c++){var p=e.childWidgets[c];this.checkLastLetterSpaceDot="",this.checkLastLetterSpace="",c!==l&&(s=t.getStartLineOffset(p)),d=p===r.currentWidget?r.offset:t.getLineLength(p);for(var g=0,f=void 0,u=-1,m=!0,y=0;y<p.children.length;m?y++:y--){var v=p.children[y],w=!1;if((0===y||y>0&&p.children[y-1]instanceof Fa)&&(w=!0,y>0)){var b=p.children[y-1];this.checkLastLetterSpace=b.text.substr(-1),this.checkLastLetterSpaceDot=b.text.substr(-2)}if(!(v instanceof Va))if(f===v&&(f=void 0,y=u,u=-1,m=!0),s>=g+v.length)g+=v.length;else{var x=0;s>g&&(x=s-g);var I=d-g,F=v.length;if(I>F&&(I=F),y+=this.changeCaseInline(v,t,x,I,n,o,w),d<=g+F)break;g+=F}}}var C=r.paragraph;this.documentHelper.layout.reLayoutParagraph(e,l,0),e.equals(C)||this.changeCaseNextBlock(e,i,r,n,o)},e.prototype.changeCaseInline=function(e,t,i,r,n,o,s){if(e instanceof Fa){if(0!==i||r!==e.length)return this.changeCaseInlineInternal(e,t,i,r,n,o,s);this.changeCaseInlineInternal(e,t,i,r,n,o,s)}return 0},e.prototype.addRemovedTextNodes=function(e,t){if(e instanceof Fa&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){var i=this.editorHistory.currentBaseHistoryInfo.removedNodes[0];sf.base.isNullOrUndefined(i)&&((i=new Fa).text="",this.editorHistory.currentBaseHistoryInfo.removedNodes.push(i)),i.text+=t}},e.prototype.changeCaseInlineInternal=function(e,t,i,r,n,o,s){var a,l=0,d=!1,h=e.line.children.indexOf(e),c=e.paragraph,p=c.childWidgets.indexOf(e.line);if(i>0){var g=e.text.substr(i,r-i);if(this.addRemovedTextNodes(e,g),(a=new Fa).characterFormat.copyFormat(e.characterFormat),a.line=e.line,"CapitalizeEachWord"===n)d=" "===e.text.substr(i-1,1);if("SentenceCase"===n)d=". "===e.text.substr(i-2,2);a.text=this.getChangeCaseText(g,n,o,d),a.isRightToLeft=e.isRightToLeft,h++,e.line.children.splice(h,0,a),l++}r<e.length&&((a=new Fa).characterFormat.copyFormat(e.characterFormat),a.text=e.text.substring(r),a.line=e.line,a.isRightToLeft=e.isRightToLeft,h++,e.line.children.splice(h,0,a),l++);var f=e;if(0===i){var u=f.text.substr(0,r);if(this.addRemovedTextNodes(e,u),"SentenceCase"===n){if(". "===this.checkLastLetterSpaceDot)d=!0;else if(0===p&&""===this.checkLastLetterSpaceDot){if(s)d=c.childWidgets[0].children[0]===f;else d=!0}this.checkLastLetterSpaceDot=f.text.substr(-2)}else"CapitalizeEachWord"==n&&(d=!s||(0===t.getIndexInInline(e)||" "===this.checkLastLetterSpace),this.checkLastLetterSpace=f.text.charAt(f.length-1));f.text=this.getChangeCaseText(u,n,o,d)}else{var m=f.text.substr(0,i);f.text=m}return l},e.prototype.changeCaseNextBlock=function(e,t,i,r,n){e=this.getNextBlockForChangeCase(e,t,i,r,n),sf.base.isNullOrUndefined(e)||(e instanceof ca?this.changeCaseParagraph(e,this.documentHelper.selection,t,i,r,n):this.changeCaseForTable(0,e,this.documentHelper.selection,t,i,r,n))},e.prototype.getNextBlockForChangeCase=function(e,t,i,r,n){var o=e.getSplitWidgets();return e=o[o.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e)},e.prototype.getChangeCaseText=function(e,t,i,r){if(i){if(!sf.base.isNullOrUndefined(this.removedTextNodes)&&this.removedTextNodes.length>0){var n=this.removedTextNodes[0],o=n.text.substr(0,e.length);n.text=n.text.substr(o.length,n.length-o.length),e=o,""===n.text&&this.removedTextNodes.splice(0,1)}}else switch(t){case"SentenceCase":e=this.sentencecase(e,r);break;case"Uppercase":e=e.toUpperCase();break;case"Lowercase":e=e.toLowerCase();break;case"CapitalizeEachWord":e=this.capitalizeFirst(e,r);break;case"ToggleCase":e=this.togglecase(e)}return e},e.prototype.capitalizeFirst=function(e,t){for(var i=e.split(/[^\w]+/g).map((function(e,i){return 0===i?t?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e.toLowerCase():e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()})),r=e.split(/\w+/).filter(Boolean),n=[],o=0;o<Math.max(i.length,r.length);o++)i[o]&&n.push(i[o]),r[o]&&n.push(r[o]);return n.join("")},e.prototype.sentencecase=function(e,t){return e.split(". ").map((function(e,i){return 0===i?t?e.charAt(0).toUpperCase()+e.slice(1).toLowerCase():e.toLowerCase():e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()})).join(". ")},e.prototype.togglecase=function(e){return e.split("").map((function(e){return e===e.toLowerCase()?e.toUpperCase():e.toLowerCase()})).join("")},e.prototype.changeCaseForTable=function(e,t,i,r,n,o,s){t=t.combineWidget(this.owner.viewer);for(var a=e;a<t.childWidgets.length;a++){for(var l=t.childWidgets[a],d=0;d<l.childWidgets.length;d++)this.changeCaseForSelectedCell(l.childWidgets[d],i,o,s);if(n.paragraph.isInsideTable&&i.containsRow(l,n.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.changeCaseNextBlock(t,r,n,o,s)},e.prototype.changeCaseForSelectedCell=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];o instanceof ca?this.changeCaseForSelectedPara(o,t,i,r):this.changeCaseForSelTable(o,t,i,r)}},e.prototype.changeCaseForSelectedPara=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++)for(var o="",s=e.childWidgets[n],a=0;a<s.children.length;a++){var l=s.children[a],d=!1;!sf.base.isNullOrUndefined(l)&&l instanceof Fa&&(this.addRemovedTextNodes(l,l.text),"CapitalizeEachWord"===i?(d=0===a||" "===o,o=l.text.substr(l.length-1,1)):"SentenceCase"===i&&(d=". "===l.text.substr(l.length-2,2)||0===a),l.text=this.getChangeCaseText(l.text,i,r,d))}},e.prototype.changeCaseForSelTable=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.childWidgets.length;s++)this.changeCaseForSelectedCell(o.childWidgets[s],t,i,r)},e.prototype.changeCaseParaFormatInCell=function(e,t,i,r,n){var o=this.documentHelper.selection;if(i.paragraph.isInsideTable){var s=o.getContainerCellOf(e,i.paragraph.associatedCell);if(s.ownerTable.contains(i.paragraph.associatedCell)){var a=o.getSelectedCell(e,s),l=o.getSelectedCell(i.paragraph.associatedCell,s);o.containsCell(s,i.paragraph.associatedCell)?o.isCellSelected(s,t,i)?this.changeCaseParaForCellInternal(s,o,r,n):a===s?this.changeCaseParagraph(t.paragraph,o,t,i,r,n):this.changeCaseParaForRow(a.ownerRow,o,t,i,r,n):this.changeCaseParaForTableCell(s.ownerTable,s,l,r,n)}else this.changeCaseParaForRow(s.ownerRow,o,t,i,r,n)}else{var d=o.getContainerCell(e);this.changeCaseParaForRow(d.ownerRow,o,t,i,r,n)}},e.prototype.changeCaseParaForTableCell=function(e,t,i,r,n){var o=this.documentHelper.selection,s=o.getCellLeft(t.ownerRow,t),a=s+t.cellFormat.cellWidth,l=o.getCellLeft(i.ownerRow,i),d=l+i.cellFormat.cellWidth,h=this.updateSelectedCellsInTable(s,a,l,d);s=h.start,a=h.end;for(var c=e.childWidgets.indexOf(i.ownerRow),p=e.childWidgets.indexOf(t.ownerRow);p<=c;p++)for(var g=e.childWidgets[p],f=0;f<g.childWidgets.length;f++){var u=o.getCellLeft(g,g.childWidgets[f]);Math.round(s)<=Math.round(u)&&Math.round(u)<Math.round(a)&&this.changeCaseParaForCellInternal(g.childWidgets[f],o,r,n)}},e.prototype.changeCaseParaForCellInternal=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];o instanceof ca?this.changeCaseForSelectedPara(o,t,i,r):this.changeCaseParaFormatTableInternal(o,t,i,r)}},e.prototype.changeCaseParaFormatTableInternal=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.childWidgets.length;s++)this.changeCaseParaForCellInternal(o.childWidgets[s],t,i,r)},e.prototype.changeCaseParaForRow=function(e,t,i,r,n,o){for(var s=e.rowIndex;s<e.ownerTable.childWidgets.length;s++){for(var a=e.ownerTable.childWidgets[s],l=0;l<a.childWidgets.length;l++)this.changeCaseParaForCellInternal(a.childWidgets[l],t,n,o);if(r.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(a,r.paragraph.associatedCell))return}this.changeCaseNextBlock(e.ownerTable,i,r,n,o)},e.prototype.toggleAllCaps=function(){if(!this.documentHelper.owner.isReadOnlyMode||this.selection.isInlineFormFillMode()){var e=this.getCurrentSelectionValue("allCaps");this.selection.characterFormat.allCaps=e}},e.prototype.toggleChangeCase=function(){var e=["Uppercase","Lowercase","CapitalizeEachWord"];return this.casingIndex++,this.casingIndex>=e.length&&(this.casingIndex=0),e[this.casingIndex]},e.prototype.getCurrentSelectionValue=function(e){var t=!1;if("bold"===e||"italic"===e){var i=this.getSelectedCharacterFormat();"bold"===e&&(t=!i.bold),"italic"===e&&(t=!i.italic)}return t},e.prototype.getSelectedCharacterFormat=function(){var e=0,t=this.selection.start;this.selection.isForward||(t=this.selection.end);var i=t.currentWidget,r=i.getInline(t.offset,e),n=r.element;e=r.index;var o=i.paragraph.characterFormat;if(!sf.base.isNullOrUndefined(n))if(this.selection.isEmpty&&"List"===this.selection.contextType){var s=this.selection.getListLevel(this.selection.start.paragraph);s.characterFormat.uniqueCharacterFormat&&(o=s.characterFormat)}else o=this.selection.isEmpty||e!==n.length?n.characterFormat:sf.base.isNullOrUndefined(n.nextNode)?i.paragraph.characterFormat:n.nextNode.characterFormat;return o},e.prototype.toggleUnderline=function(e){(!this.owner.isReadOnlyMode&&!this.restrictFormatting||this.selection.isInlineFormFillMode())&&this.updateProperty(1,e)},e.prototype.toggleStrikethrough=function(e){if(!this.owner.isReadOnlyMode||this.selection.isInlineFormFillMode()){var t=void 0;t=sf.base.isNullOrUndefined(e)?"SingleStrike"===this.selection.characterFormat.strikethrough?"None":"SingleStrike":e,this.selection.characterFormat.strikethrough=t}},e.prototype.updateFontSize=function(e,t){if("number"==typeof t&&!(t<0&&1===e.fontSize))return e.fontSize+t;var i=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];if("string"==typeof t&&"increment"===t){if(e.fontSize<8)return e.fontSize+1;if(e.fontSize>=72&&e.fontSize<80)return 80;if(e.fontSize>=80)return e.fontSize+10;for(var r=0;r<i.length;r++)if(e.fontSize<i[r])return i[r]}else if("string"==typeof t&&"decrement"===t&&e.fontSize>1){if(e.fontSize<=8)return e.fontSize-1;if(e.fontSize>72&&e.fontSize<=80)return 72;if(e.fontSize>80)return e.fontSize-10;for(r=0;r<i.length;r++)if(e.fontSize<=i[r])return i[r-1]}return e.fontSize},e.prototype.applyCharFormatInline=function(e,t,i,r,n,o,s){return 0===i&&r===e.length?(this.applyCharFormatValue(e.characterFormat,n,o,s),0):e instanceof Fa?this.formatInline(e,t,i,r,n,o,s):0},e.prototype.formatInline=function(e,t,i,r,n,o,s){var a,l=0,d=e,h=e.line.children.indexOf(d),c=(e.paragraph,0);return i>0&&(c+=1,(a=new Fa).characterFormat.copyFormat(e.characterFormat),a.line=e.line,a.text=e.text.substr(i,r-i),a.isRightToLeft=e.isRightToLeft,this.applyCharFormatValue(a.characterFormat,n,o,s),h++,d.line.children.splice(h,0,a),l++,this.updateRevisionForFormattedContent(e,a,c)),r<d.length&&(c+=1,(a=new Fa).characterFormat.copyFormat(e.characterFormat),a.text=d.text.substring(r),a.line=e.line,a.isRightToLeft=e.isRightToLeft,h++,d.line.children.splice(h,0,a),l++,this.updateRevisionForFormattedContent(e,a,c)),0===i?(e.text=e.text.substr(0,r),this.applyCharFormatValue(e.characterFormat,n,o,s)):e.text=e.text.substr(0,i),l},e.prototype.updateRevisionForFormattedContent=function(e,t,i){for(var r=0;r<e.revisions.length;r++){var n=e.revisions[r],o=n.range.indexOf(e)+i;t.revisions.splice(0,0,n),n.range.splice(o,0,t),this.owner.trackChangesPane.updateCurrentTrackChanges(n)}},e.prototype.applyCharFormatCell=function(e,t,i,r,n,o,s){if(r.paragraph.isInsideTable){var a=t.getContainerCellOf(e,r.paragraph.associatedCell);if(a.ownerTable.contains(r.paragraph.associatedCell)){var l=t.getSelectedCell(e,a),d=t.getSelectedCell(r.paragraph.associatedCell,a);t.containsCell(a,r.paragraph.associatedCell)?t.isCellSelected(a,i,r)?(o=this.getCharacterFormatValueOfCell(e,t,o,n),this.applyCharFormatForSelectedCell(a,t,n,o,s)):l===a?this.applyCharFormat(i.paragraph,t,i,r,n,o,s):this.applyCharFormatRow(l.ownerRow,t,i,r,n,o,s):this.applyCharFormatForTableCell(a.ownerTable,t,a,d,n,o,s)}else this.applyCharFormatRow(a.ownerRow,t,i,r,n,o,s)}else{var h=t.getContainerCell(e);this.applyCharFormatRow(h.ownerRow,t,i,r,n,o,s)}},e.prototype.applyCharFormatForSelectedCell=function(e,t,i,r,n){for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];s instanceof ca?this.applyCharFormatForSelectedPara(s,t,i,r,n):this.applyCharFormatForSelTable(s,t,i,r,n)}},e.prototype.applyCharFormatRow=function(e,t,i,r,n,o,s){o=this.getCharacterFormatValueOfCell(e.childWidgets[0],t,o,n),this.applyCharFormatForTable(e.rowIndex,e.ownerTable,t,i,r,n,o,s)},e.prototype.applyCharFormatForTable=function(e,t,i,r,n,o,s,a){t=t.combineWidget(this.owner.viewer);for(var l=e;l<t.childWidgets.length;l++){for(var d=t.childWidgets[l],h=0;h<d.childWidgets.length;h++)this.applyCharFormatForSelectedCell(d.childWidgets[h],i,o,s,a);if(n.paragraph.isInsideTable&&i.containsRow(d,n.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.getNextParagraphForCharacterFormatting(t,r,n,o,s,a)},e.prototype.applyCharFormatForSelTable=function(e,t,i,r,n){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)this.applyCharFormatForSelectedCell(s.childWidgets[a],t,i,r,n)},e.prototype.applyCharFormatForTableCell=function(e,t,i,r,n,o,s){var a=t.getCellLeft(i.ownerRow,i),l=a+i.cellFormat.cellWidth,d=t.getCellLeft(r.ownerRow,r),h=d+r.cellFormat.cellWidth,c=this.updateSelectedCellsInTable(a,l,d,h);a=c.start,l=c.end;for(var p=e.childWidgets.indexOf(r.ownerRow),g=!1,f=e.childWidgets.indexOf(i.ownerRow);f<=p;f++)for(var u=e.childWidgets[f],m=0;m<u.childWidgets.length;m++){var y=t.getCellLeft(u,u.childWidgets[m]);x.round(a,2)<=x.round(y,2)&&x.round(y,2)<x.round(l,2)&&(g||(o=this.getCharacterFormatValueOfCell(u.childWidgets[m],t,o,n),g=!0),this.applyCharFormatForSelectedCell(u.childWidgets[m],t,n,o,s))}},e.prototype.updateSelectedCellsInTable=function(e,t,i,r){var n=this.documentHelper.selection;return e>i&&(e=i),t<r&&(t=r),e>n.upDownSelectionLength&&(e=n.upDownSelectionLength),t<n.upDownSelectionLength&&(t=n.upDownSelectionLength),{start:e,end:t}},e.prototype.getCharacterFormatValueOfCell=function(e,t,i,r){if("boolean"==typeof i||void 0===i&&("bold"===r||"italic"===r)){var n=t.getFirstParagraph(e),o=n.characterFormat;n.childWidgets.length>0&&n.childWidgets[0].children.length>0&&(o=n.childWidgets[0].children[0].characterFormat),i=!o.getPropertyValue(r)}return i},e.prototype.applyCharFormatValueInternal=function(e,t,i,r){this.applyCharFormatValue(t,i,r,!1)},e.prototype.copyInlineCharacterFormat=function(e,t){t.uniqueCharacterFormat=e.uniqueCharacterFormat,t.baseCharStyle=e.baseCharStyle},e.prototype.applyCharFormatValue=function(e,t,i,r){if(r&&"fontSize"===t&&(i=this.updateFontSize(e,i)),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(e,t,i)),i instanceof T)this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?this.copyInlineCharacterFormat(i,e):e.copyFormat(i);else{if(this.isForHyperlinkFormat&&this.owner.enableTrackChanges&&e.ownerBase instanceof ya){var n=e.ownerBase,o=n.previousNode;if(sf.base.isNullOrUndefined(o)){var s=n.paragraph.previousWidget;if(!sf.base.isNullOrUndefined(s)&&!s.isEmpty()){var a=s.lastChild;o=a.children[a.children.length-1]}}for(;!(sf.base.isNullOrUndefined(o)||o instanceof Fa);)o=o.previousNode;if(!sf.base.isNullOrUndefined(o)&&o.revisions.length>0){var l=o.revisions[o.revisions.length-1];this.isRevisionAlreadyIn(n,l)||(n.revisions.push(l),l.range.push(n),this.owner.trackChangesPane.updateCurrentTrackChanges(l))}else this.insertRevision(n,"Insertion")}sf.base.isNullOrUndefined(i)&&sf.base.isNullOrUndefined(t)?e.clearFormat():"bold"===t?e.bold=i:"italic"===t?e.italic=i:"fontColor"===t?e.fontColor=i:"fontFamily"===t?(e.fontFamily=i,e.fontFamilyAscii=i,e.fontFamilyFarEast=i,e.fontFamilyNonFarEast=i,e.fontFamilyBidi=i):"fontSize"===t?e.fontSize=i:"highlightColor"===t?e.highlightColor=i:"baselineAlignment"===t?e.baselineAlignment=i:"strikethrough"===t?e.strikethrough=i:"underline"===t?e.underline=i:"styleName"===t?e.baseCharStyle=i:"allCaps"===t&&(e.allCaps=i)}},e.prototype.onImageFormat=function(e,t,i,r){var n=new Dl(e);this.editorHistory&&(this.editorHistory.initializeHistory("ImageResizing"),this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(n)),this.setOffsetValue(this.selection),e.width=t,e.height=i,e.alternateText=r,this.documentHelper.layout.reLayoutParagraph(e.line.paragraph,e.line.indexInOwner,0),this.reLayout(this.selection,!1),this.documentHelper.owner.imageResizerModule&&this.documentHelper.owner.imageResizerModule.positionImageResizer(e)},e.prototype.toggleTextAlignment=function(e){this.documentHelper.owner.isReadOnlyMode&&!this.selection.isInlineFormFillMode()||!this.documentHelper.owner.isDocumentLoaded||(sf.base.isNullOrUndefined(this.documentHelper.selection.paragraphFormat.textAlignment)||this.documentHelper.selection.paragraphFormat.textAlignment!==e?this.onApplyParagraphFormat("textAlignment",e,!1,!0):"Left"===e?this.onApplyParagraphFormat("textAlignment","Justify",!1,!0):this.onApplyParagraphFormat("textAlignment","Left",!1,!0))},e.prototype.setPreviousBlockToLayout=function(){var e=this.documentHelper.selection.start;this.documentHelper.selection.isForward||(e=this.documentHelper.selection.end);var t=e.paragraph;if(t.paragraphFormat.keepWithNext){var i=t.bodyWidget;if(!sf.base.isNullOrUndefined(i)&&i instanceof aa&&i.page){var r=i.page.previousPage;r&&(this.previousBlockToLayout=r.bodyWidgets[0].lastChild)}}},e.prototype.applyParagraphBorders=function(e,t,i){var r=new p;switch(e){case"color":r.color=i;break;case"lineWidth":r.lineWidth=i;break;case"lineStyle":r.lineStyle=i;break;case"shadow":r.shadow=i;break;case"space":r.space=i}this.onApplyParagraphFormat(t,r,!1,!1)},e.prototype.applyRulerMarkerValues=function(e,t,i){var r=x.convertPixelToPoint(i-t)/this.owner.zoomFactor;if("firstLineIndent"===e){var n=this.owner.selection.start.paragraph.paragraphFormat.firstLineIndent;this.onApplyParagraphFormat(e,n+r,!1,!1)}else if("hangingIndent"===e){n=this.owner.selection.start.paragraph.paragraphFormat.firstLineIndent;this.onApplyParagraphFormat("firstLineIndent",n-r,!1,!1);var o=this.owner.selection.start.paragraph.paragraphFormat.leftIndent+n;n-=r,this.onApplyParagraphFormat("leftIndent",o-n,!1,!1,!0)}else if("leftIndent"===e){n=this.owner.selection.start.paragraph.paragraphFormat.leftIndent;this.onApplyParagraphFormat(e,n+r,!1,!1)}else if("rightIndent"===e){n=this.owner.selection.start.paragraph.paragraphFormat.rightIndent;this.onApplyParagraphFormat(e,n+r,!1,!1)}},e.prototype.onApplyParagraphFormat=function(e,t,i,r,n){var o=this.documentHelper.isFormFillProtectedMode&&this.documentHelper.selection.isInlineFormFillMode()&&this.allowFormattingInFormFields(e);if(!this.restrictFormatting||o){this.setPreviousBlockToLayout();var s="bidi"===e?"ParagraphBidi":e[0].toUpperCase()+e.slice(1);this.documentHelper.owner.isShiftingEnabled=!0;var a=this.documentHelper.selection,l=a.start.paragraph,d=!1;if(a.isForward||(l=a.end.paragraph),"leftIndent"==e&&(d=this.isFirstParaForList(a,l)),t<=0&&"leftIndent"==e&&!n){var h=x.convertPointToPixel(t);if(l.x+h<this.viewer.clientArea.x&&!l.paragraphFormat.bidi)return void(this.documentHelper.owner.isShiftingEnabled=!1)}if(this.initHistory(s),(!this.owner.isReadOnlyMode||o)&&this.owner.isDocumentLoaded)if("leftIndent"!==e||sf.base.isNullOrUndefined(a.paragraphFormat.listId)||-1===a.paragraphFormat.listId||!i){if(!(t instanceof wl&&"styleName"==e&&a.isEmpty)&&a.isEmpty){this.setOffsetValue(a),i&&"leftIndent"===e&&(t=this.getIndentIncrementValue(a.start.paragraph,t));var c=a.start.paragraph;this.documentHelper.layout;c=c.combineWidget(this.owner.viewer),this.applyParaFormatProperty(c,e,t,i),this.layoutItemBlock(c,!1)}else"ParagraphBidi"!==s&&this.setOffsetValue(a),this.updateSelectionParagraphFormatting(e,t,i);this.reLayout(a)}else d?this.updateListLevelIndent(t,l):this.updateListLevel(t>0)}},e.prototype.updateListLevelIndent=function(e,t){var i=this.documentHelper.getListById(t.paragraphFormat.listFormat.listId),r=this.documentHelper.getAbstractListById(i.abstractListId);if(this.initHistory("List"),e<0&&r.levels[0].paragraphFormat.leftIndent+e<=0&&(e=18-r.levels[0].paragraphFormat.leftIndent),0!=e){for(var n=0;n<r.levels.length;n++)this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForList(r.levels[n]),r.levels[n].paragraphFormat.leftIndent+=e;this.documentHelper.owner.isShiftingEnabled=!0,this.layoutWholeDocument(),this.documentHelper.owner.isShiftingEnabled=!1}},e.prototype.isFirstParaForList=function(e,t){var i=!1;if(!sf.base.isNullOrUndefined(e.paragraphFormat.listId)&&-1!==e.paragraphFormat.listId&&0===t.paragraphFormat.listFormat.listLevelNumber){var r=this.updateWholeListItems(t,!0,e.paragraphFormat.listId);sf.base.isNullOrUndefined(r)&&(i=!0)}return i},e.prototype.updateListLevel=function(e){var t,i=this.documentHelper,r=(this.documentHelper.selection.start.paragraph.paragraphFormat.listFormat,this.documentHelper.selection.start.paragraph.paragraphFormat),n=i.getListById(r.listFormat.listId);i.layout.getListLevel(n,r.listFormat.listLevelNumber);t=e?r.listFormat.listLevelNumber+1:r.listFormat.listLevelNumber-1;var o=i.layout.getListLevel(n,t);sf.base.isNullOrUndefined(o)||(this.onApplyListInternal(n,t),i.selection.start.updatePhysicalPosition(!0),i.selection.end.updatePhysicalPosition(!0),i.selection.updateCaretPosition())},e.prototype.onApplyListInternal=function(e,t){var i=new m;!sf.base.isNullOrUndefined(e)&&t>=0&&t<9&&(i.listId=e.listId,i.listLevelNumber=t),this.onApplyParagraphFormat("listFormat",i,!1,!1)},e.prototype.updateSelectionParagraphFormatting=function(e,t,i){var r=this.documentHelper.selection;"leftIndent"===e&&i&&(t=!sf.base.isNullOrUndefined(r.start)&&r.start.isExistBefore(r.end)?this.getIndentIncrementValue(r.start.paragraph,t):this.getIndentIncrementValue(r.end.paragraph,t)),this.updateParagraphFormatInternal(e,t,i)},e.prototype.getIndentIncrementValue=function(e,t){var i=e.paragraphFormat.leftIndent;if(i<0){if(t<0||i+t>=0)return-i;var r=-this.getIndentIncrementValueInternal(-i,-t);return r%t==0?r:r+t}return this.getIndentIncrementValueInternal(i,t)},e.prototype.getIndentIncrementValueInternal=function(e,t){var i=Math.abs(t);if(0===e||0===i)return t>0?i:0;var r=100*Math.round(e)%(100*Math.round(i))/100,n=(Math.round(e)-r)/Math.round(i)*i;return t>0&&(n+=i),n-e==0?t:n-e},e.prototype.updateParagraphFormatInternal=function(e,t,i){switch(sf.base.isNullOrUndefined(e)&&(e="ParagraphFormat"),e){case"afterSpacing":this.updateParagraphFormat("afterSpacing",t,!1);break;case"beforeSpacing":this.updateParagraphFormat("beforeSpacing",t,!1);break;case"spaceAfterAuto":this.updateParagraphFormat("spaceAfterAuto",t,!1);break;case"spaceBeforeAuto":this.updateParagraphFormat("spaceBeforeAuto",t,!1);break;case"rightIndent":this.updateParagraphFormat("rightIndent",t,!1);break;case"leftIndent":this.updateParagraphFormat("leftIndent",t,i);break;case"firstLineIndent":this.updateParagraphFormat("firstLineIndent",t,!1);break;case"lineSpacing":this.updateParagraphFormat("lineSpacing",t,!1);break;case"lineSpacingType":this.updateParagraphFormat("lineSpacingType",t,!1);break;case"textAlignment":this.updateParagraphFormat("textAlignment",t,!1);break;case"borders":case"topBorder":case"bottomBorder":case"leftBorder":case"rightBorder":case"horizontalBorder":case"verticalBorder":this.updateParagraphFormat(e,t,!1);break;case"listFormat":this.updateParagraphFormat("listFormat",t,!1);break;case"ParagraphFormat":this.updateParagraphFormat(void 0,t,!1);break;case"styleName":this.updateParagraphFormat("styleName",t,!1);break;case"ClearParagraphFormat":this.updateParagraphFormat(void 0,t,!1);break;case"bidi":var r=-1!==this.selection.paragraphFormat.listId;r||(this.documentHelper.layout.isBidiReLayout=!0),this.updateParagraphFormat("bidi",t,!1),r||(this.documentHelper.layout.isBidiReLayout=!1);break;case"contextualSpacing":this.updateParagraphFormat("contextualSpacing",t,!1);break;case"tabStop":this.updateParagraphFormat("tabStop",t,!1)}},e.prototype.updateParagraphFormat=function(e,t,i){var r=this.documentHelper.selection,n=r.start,o=r.end;r.isForward||(n=r.end,o=r.start),this.applyParaFormatSelectedContent(n,o,e,t,i)},e.prototype.applyParaFormatSelectedContent=function(e,t,i,r,n){var o=this.documentHelper.selection;if(!e.paragraph.isInsideTable||t.paragraph.isInsideTable&&e.paragraph.associatedCell===t.paragraph.associatedCell&&!o.isCellSelected(e.paragraph.associatedCell,e,t)){if(!sf.base.isNullOrUndefined(r)&&!this.selection.isEmpty&&"styleName"===i&&this.applyCharacterStyle(e.paragraph,e,t,i,r,n))return;this.applyParaFormat(e.paragraph,e,t,i,r,n)}else{var s;e.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.checkInsertPosition(o)&&this.updateHistoryPosition(e,!0),s=e.paragraph.associatedCell,this.applyParaFormatInCell(s,e,t,i,r,n);var a=s.ownerTable;this.documentHelper.layout.layoutBodyWidgetCollection(a.index,a.containerWidget,a,!1)}},e.prototype.applyParaFormatProperty=function(e,t,i,r){var n=e.paragraphFormat;if(r&&"leftIndent"===t&&(i=n.leftIndent+i),"listFormat"===t&&i instanceof m){var o=i;o.hasValue("listLevelNumber")||(o.listLevelNumber=n.listFormat.listLevelNumber)}if(this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(i=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(n,t,i)),i instanceof ul&&(sf.base.isNullOrUndefined(t)?this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?this.copyParagraphFormat(i,n):n.copyFormat(i):"listFormat"===t&&(n.listFormat=i.listFormat,n.listFormat.ownerBase=n)),sf.base.isNullOrUndefined(i))return n.clearFormat(),void this.documentHelper.layout.reLayoutParagraph(n.ownerBase,0,0);if("afterSpacing"===t)n.afterSpacing=i;else if("beforeSpacing"===t)n.beforeSpacing=i;else if("leftIndent"===t)n.leftIndent=i;else if("lineSpacingType"===t)n.lineSpacingType=i;else if("lineSpacing"===t)n.lineSpacing=i;else if("rightIndent"===t)n.rightIndent=i;else if("firstLineIndent"===t)n.firstLineIndent=i;else if("textAlignment"===t){var s=i;!n.bidi||this.editorHistory.isUndoing||this.editorHistory.isRedoing||("Left"===s?s="Right":"Right"===s&&(s="Left")),n.textAlignment=s}else if("outlineLevel"===t)n.outlineLevel=i;else if("topBorder"===t)this.applyBorder(n.borders.top,i);else if("bottomBorder"===t)this.applyBorder(n.borders.bottom,i);else if("leftBorder"===t)this.applyBorder(n.borders.left,i);else if("rightBorder"===t)this.applyBorder(n.borders.right,i);else if("horizontalBorder"===t)this.applyBorder(n.borders.horizontal,i);else if("verticalBorder"===t)this.applyBorder(n.borders.vertical,i);else if("borders"===t)n.borders.copyFormat(i);else if("styleName"===t)"string"==typeof i&&(i=this.documentHelper.styles.findByName(i)),n.applyStyle(i);else{if("listFormat"===t)return i instanceof ul&&(i=i.listFormat),n.listFormat.copyFormat(i),this.documentHelper.layout.clearListElementBox(n.ownerBase),n.listFormat.listId>=0&&n.clearIndent(),void this.layoutItemBlock(n.ownerBase,!1);if("bidi"===t)n.bidi=i;else if("keepWithNext"===t)n.keepWithNext=i;else if("keepLinesTogether"===t)n.keepLinesTogether=i;else if("widowControl"===t)n.widowControl=i;else if("contextualSpacing"===t)n.contextualSpacing=i;else if("spaceAfterAuto"===t)n.spaceAfterAuto=i;else if("spaceBeforeAuto"===t)n.spaceBeforeAuto=i;else if("tabStop"===t){var a=this.editorHistory.isUndoing||this.editorHistory.isRedoing;this.updateTabStopCollection(e,i,a)}}},e.prototype.copyParagraphFormat=function(e,t){t.uniqueParagraphFormat=e.uniqueParagraphFormat,t.listFormat=e.listFormat,t.listFormat.ownerBase=t,t.baseStyle=e.baseStyle},e.prototype.copyFromListLevelParagraphFormat=function(e,t){sf.base.isNullOrUndefined(t.leftIndent)||(e.leftIndent=t.leftIndent),sf.base.isNullOrUndefined(t.firstLineIndent)||(e.firstLineIndent=t.firstLineIndent)},e.prototype.applyContinueNumbering=function(){var e=this.selection;this.editorHistory&&this.editorHistory.initializeHistory("ContinueNumbering"),this.applyContinueNumberingInternal(e)},e.prototype.applyContinueNumberingInternal=function(e){var t=e.start.paragraph,i=this.getContinueNumberingInfo(t),r=this.getParagraphFormat(t,i.listLevelNumber,i.listPattern);this.changeListId(i.currentList,t,r,i.listLevelNumber,i.listPattern),this.reLayout(e,!1),this.owner.enableAutoFocus&&this.documentHelper.updateFocus()},e.prototype.getContinueNumberingInfo=function(e){var t=void 0,i=0,r="None";sf.base.isNullOrUndefined(e.paragraphFormat)||sf.base.isNullOrUndefined(e.paragraphFormat.listFormat)||(t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber);var n=this.documentHelper;if(0!==i&&!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(n.getAbstractListById(t.abstractListId))&&!sf.base.isNullOrUndefined(n.getAbstractListById(t.abstractListId).levels[i])){var o=this.documentHelper.layout.getListLevel(t,i);sf.base.isNullOrUndefined(o)||(r=o.listLevelPattern)}return{currentList:t,listLevelNumber:i,listPattern:r}},e.prototype.revertContinueNumbering=function(e,t){var i=e.start.paragraph,r=this.getContinueNumberingInfo(i);this.changeListId(r.currentList,i,t,r.listLevelNumber,r.listPattern),this.reLayout(e,!1),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.updateHistory()},e.prototype.changeListId=function(e,t,i,r,n){if(!sf.base.isNullOrUndefined(t)){if(t instanceof ca&&e.listId===t.paragraphFormat.listFormat.listId&&r===t.paragraphFormat.listFormat.listLevelNumber){if(this.editorHistory){var o=this.editorHistory.currentBaseHistoryInfo;sf.base.isNullOrUndefined(o)||(i=o.addModifiedPropertiesForContinueNumbering(t.paragraphFormat,i))}t.paragraphFormat.copyFormat(i),this.documentHelper.layout.reLayoutParagraph(t,0,0)}return this.changeListId(e,t.nextRenderedWidget,i,r,n)}},e.prototype.getParagraphFormat=function(e,t,i){if(!sf.base.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof ca){if(sf.base.isNullOrUndefined(e.previousRenderedWidget.paragraphFormat.listFormat)||-1===e.previousRenderedWidget.paragraphFormat.listFormat.listId)return this.getParagraphFormat(e.previousRenderedWidget,t,i);var r=this.selection.getListLevel(e.previousRenderedWidget);return 0===t||i===r.listLevelPattern||this.checkNumberArabic(i,r.listLevelPattern)?e.previousRenderedWidget.paragraphFormat:this.getParagraphFormat(e.previousRenderedWidget,t,i)}},e.prototype.checkNumberArabic=function(e,t){return"Number"===e&&"Arabic"===t||"Number"===t&&"Arabic"===e},e.prototype.applyRestartNumbering=function(e){this.editorHistory&&this.editorHistory.initializeHistory("RestartNumbering"),this.restartListAt(e)},e.prototype.restartListAt=function(e){var t=e.paragraphFormat.getList(),i=t.clone();i.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1,this.documentHelper.lists.push(i);var r=t.abstractList.clone();r.abstractListId=this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1,i.abstractListId=r.abstractListId,i.abstractList=r,this.documentHelper.abstractLists.push(r),this.restartListAtInternal(e,i.listId)},e.prototype.restartListAtInternal=function(e,t){var i=this.getContinueNumberingInfo(e.start.paragraph);this.changeRestartNumbering(i.currentList,e.start.paragraph,t),this.reLayout(e,!1),this.documentHelper.updateFocus()},e.prototype.changeRestartNumbering=function(e,t,i){if(!sf.base.isNullOrUndefined(t)){if(t instanceof ca&&e.listId===t.paragraphFormat.listFormat.listId){if(this.editorHistory){var r=this.editorHistory.currentBaseHistoryInfo;sf.base.isNullOrUndefined(r)||(i=r.addModifiedPropertiesForRestartNumbering(t.paragraphFormat.listFormat,i))}t.paragraphFormat.listFormat.listId=i,this.documentHelper.layout.reLayoutParagraph(t,0,0)}return this.changeRestartNumbering(e,t.nextRenderedWidget,i)}},e.prototype.applyParaFormat=function(e,t,i,r,n,o){this.setOffsetValue(this.selection),e=e.combineWidget(this.owner.viewer),this.applyParaFormatProperty(e,r,n,o),this.layoutItemBlock(e,!1),this.getOffsetValue(this.selection),e.equals(i.paragraph)||this.getNextParagraphForFormatting(e,t,i,r,n,o)},e.prototype.applyCharacterStyle=function(e,t,i,r,n,o){var s=e.getSplitWidgets(),a=i.owner.selection,l=i.currentWidget;if(!(0===t.offset&&(a.isParagraphLastLine(l)&&i.currentWidget===l&&i.offset===a.getLineLength(l)+1||i.isAtParagraphEnd))&&(i.paragraph===e||-1!==s.indexOf(i.paragraph))&&("Paragraph"===n.type&&n.link instanceof wl||"Character"===n.type)){var d="Character"===n.type?n:n.link;return this.updateSelectionCharacterFormatting(r,d,o),!0}return!1},e.prototype.applyParaFormatInCell=function(e,t,i,r,n,o){var s=this.documentHelper.selection;if(i.paragraph.isInsideTable){var a=s.getContainerCellOf(e,i.paragraph.associatedCell);if(a.ownerTable.contains(i.paragraph.associatedCell)){var l=s.getSelectedCell(e,a),d=s.getSelectedCell(i.paragraph.associatedCell,a);s.containsCell(a,i.paragraph.associatedCell)?s.isCellSelected(a,t,i)?(n=this.getParaFormatValueInCell(a,r,n),this.applyParaFormatCellInternal(a,r,n,o)):l===a?this.applyParaFormat(t.paragraph,t,i,r,n,o):this.applyParagraphFormatRow(l.ownerRow,t,i,r,n,o):this.applyParaFormatTableCell(a.ownerTable,a,d,r,n,o)}else this.applyParagraphFormatRow(a.ownerRow,t,i,r,n,o)}else{var h=s.getContainerCell(e);this.applyParagraphFormatRow(h.ownerRow,t,i,r,n,o)}},e.prototype.applyParaFormatCellInternal=function(e,t,i,r,n){for(var o=0;o<e.childWidgets.length;o++){var s=e.childWidgets[o];s instanceof ca?("listFormat"===t&&i instanceof m&&n&&s.paragraphFormat.listFormat.hasValue("listLevelNumber")&&i.listLevelNumber<s.paragraphFormat.listFormat.listLevelNumber&&(i.listLevelNumber=s.paragraphFormat.listFormat.listLevelNumber),this.applyParaFormatProperty(s,t,i,r)):this.applyParagraphFormatTableInternal(s,t,i,r,n)}},e.prototype.getParaFormatValueInCell=function(e,t,i){"boolean"==typeof i&&(i=!this.documentHelper.selection.getFirstParagraph(e).paragraphFormat.getPropertyValue(t));return i},e.prototype.applyParagraphFormatRow=function(e,t,i,r,n,o){n=this.getParaFormatValueInCell(e.childWidgets[0],r,n);for(var s=e.rowIndex;s<e.ownerTable.childWidgets.length;s++){for(var a=e.ownerTable.childWidgets[s],l=0;l<a.childWidgets.length;l++)this.applyParaFormatCellInternal(a.childWidgets[l],r,n,o);if(i.paragraph.isInsideTable&&this.documentHelper.selection.containsRow(a,i.paragraph.associatedCell))return}this.getNextParagraphForFormatting(e.ownerTable,t,i,r,n,o)},e.prototype.applyParaFormatTableCell=function(e,t,i,r,n,o){var s=this.documentHelper.selection,a=s.getCellLeft(t.ownerRow,t),l=a+t.cellFormat.cellWidth,d=s.getCellLeft(i.ownerRow,i),h=d+i.cellFormat.cellWidth,c=this.updateSelectedCellsInTable(a,l,d,h);a=c.start,l=c.end;for(var p=e.childWidgets.indexOf(i.ownerRow),g=!1,f=e.childWidgets.indexOf(t.ownerRow);f<=p;f++)for(var u=e.childWidgets[f],m=0;m<u.childWidgets.length;m++){var y=s.getCellLeft(u,u.childWidgets[m]);Math.round(a)<=Math.round(y)&&Math.round(y)<Math.round(l)&&(g||(n=this.getParaFormatValueInCell(u.childWidgets[m],r,n),g=!0),this.applyParaFormatCellInternal(u.childWidgets[m],r,n,o))}},e.prototype.applyParaFormatTable=function(e,t,i,r,n,o,s){e=e.combineWidget(this.owner.viewer);for(var a=this.documentHelper.selection,l=0;l<e.childWidgets.length;l++){for(var d=e.childWidgets[l],h=0;h<d.childWidgets.length;h++)this.applyParaFormatCellInternal(d.childWidgets[h],r,n,o,s);if(i.paragraph.isInsideTable&&a.containsRow(d,i.paragraph.associatedCell))return void this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1)}this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.getNextParagraphForFormatting(e,t,i,r,n,o)},e.prototype.getNextParagraphForFormatting=function(e,t,i,r,n,o){var s=e.getSplitWidgets();e=s[s.length-1],e=this.documentHelper.selection.getNextRenderedBlock(e),sf.base.isNullOrUndefined(e)||(e instanceof ca?("listFormat"===r&&n instanceof m&&e.paragraphFormat.listFormat.hasValue("listLevelNumber")&&n.listLevelNumber<e.paragraphFormat.listFormat.listLevelNumber&&(n.listLevelNumber=e.paragraphFormat.listFormat.listLevelNumber),this.applyParaFormat(e,t,i,r,n,o)):this.applyParaFormatTable(e,t,i,r,n,o,!0))},e.prototype.applyParagraphFormatTableInternal=function(e,t,i,r,n){for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)this.applyParaFormatCellInternal(s.childWidgets[a],t,i,r,n)},e.prototype.onApplyColumnFormat=function(e,t){if(!this.restrictFormatting){this.initHistory("SectionFormat");var i=this.documentHelper.selection;i.owner.isShiftingEnabled=!0;var r,n,o=i.start,s=i.end;i.isForward||(o=i.end,s=i.start),this.documentHelper.clearContent();for(var a=o.paragraph.bodyWidget.sectionIndex,l=s.paragraph.bodyWidget.sectionIndex,d=!1,h=0;h<this.documentHelper.pages.length;h++)this.documentHelper.pages[h].bodyWidgets[0].index===a?r=h:d=!0;for(h=r;h<this.documentHelper.pages.length;h++){var c=this.documentHelper.pages[h].bodyWidgets[0];if(n=h,c.index!==a&&!(c.index>=a&&c.index<=l)){n=h-1;break}}d&&"differentOddAndEvenPages"==e&&o.paragraph.isInHeaderFooter&&(r=0,n=this.documentHelper.pages.length-1);var p=!0,g=0;for(h=r;h<=n;h++)g===this.documentHelper.pages[h].bodyWidgets[0].index||p||(p=!0),this.applyPropertyValueForSection(this.documentHelper.pages[h].bodyWidgets[0].sectionFormat,e,t,p),g=this.documentHelper.pages[h].bodyWidgets[0].index,p=!1;this.layoutWholeDocument(),this.fireContentChange()}},e.prototype.onApplySectionFormat=function(e,t){if(!this.restrictFormatting){if(sf.base.isNullOrUndefined(e))this.initHistory("SectionFormat");else{var i=e[0].toUpperCase()+e.slice(1);this.initHistory(i)}this.updateSectionFormat(e,t)}},e.prototype.removeInlineHeaderFooterWidget=function(e,t,i,r){if(0!=e){var n=this.documentHelper.headersFooters[e],o=this.viewer.getHeaderFooter(t),s=this.selection.start.paragraph.containerWidget.sectionFormat.cloneFormat();if(!sf.base.isNullOrUndefined(r)){if(!sf.base.isNullOrUndefined(i)){var a=i[0].toUpperCase()+i.slice(1);this.initHistory(a);var l=this.selection.getParagraphInfo(this.selection.start);this.selection.editPosition=this.selection.getHierarchicalIndex(l.paragraph,l.offset.toString()),this.checkInsertPosition(this.selection)&&this.setPositionForHistory(this.selection.editPosition)}if(r)n&&!sf.base.isNullOrUndefined(n[o])&&(s.removedHeaderFooters.push(n[o]),this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(s,i,r),delete n[o]);else{var d=this.viewer.getCurrentHeaderFooter(t,e);if(!sf.base.isNullOrUndefined(d)&&sf.base.isNullOrUndefined(n[o])){var h=d.clone();n[o]=h,s.removedHeaderFooters.push(h),this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(s,i,r)}}this.selection.updateTextPositionForBlockContainer(this.selection.start.paragraph.containerWidget),this.layoutWholeDocument(),this.fireContentChange()}}},e.prototype.updateHeaderFooters=function(e,t,i,r){var n=this.documentHelper.headersFooters[i],o=this.viewer.getHeaderFooter(r.headerFooterType),s=n[o];(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(sf.base.isNullOrUndefined(s)?this.documentHelper.headersFooters[i][o]=r:sf.base.isNullOrUndefined(s)||delete n[o]),this.selection.updateTextPositionForBlockContainer(this.selection.start.paragraph.containerWidget),this.layoutWholeDocument()},e.prototype.updateSectionFormat=function(e,t){if(1===this.documentHelper.selection.startPage&&"differentFirstPage"===e){var i=void 0;i=this.documentHelper.selection.start.paragraph.containerWidget instanceof ua?this.getFirstChildOfTable(this.documentHelper.selection.start.paragraph.containerWidget):this.documentHelper.selection.start.paragraph.containerWidget.childWidgets[0];var r=this.selection.getHierarchicalIndex(i,"0");this.documentHelper.selection.select(r,r)}var n=this.documentHelper.selection;n.owner.isShiftingEnabled=!0;var o,s,a=n.start,l=n.end;n.isForward||(a=n.end,l=n.start),this.documentHelper.clearContent();for(var d=a.paragraph.bodyWidget.sectionIndex,h=l.paragraph.bodyWidget.sectionIndex,c=!1,p=!1,g=0;g<this.documentHelper.pages.length;g++){for(var f=0;f<this.documentHelper.pages[g].bodyWidgets.length;f++)if(this.documentHelper.pages[g].bodyWidgets[f].index===d){if(o=g,n.isForward){p=!0;break}}else c=!0;if(p)break}for(g=o;g<this.documentHelper.pages.length;g++)for(f=0;f<this.documentHelper.pages[g].bodyWidgets.length;f++){var u=this.documentHelper.pages[g].bodyWidgets[f];u.index!==d?u.index>=d&&u.index<=h&&(s=g):s=g}c&&"differentOddAndEvenPages"==e&&a.paragraph.isInHeaderFooter&&(o=0,s=this.documentHelper.pages.length-1);var m=!0,y=0;for(g=o;g<=s;g++)for(f=0;f<this.documentHelper.pages[g].bodyWidgets.length;f++)if(this.documentHelper.pages[g].bodyWidgets[f].index>=d&&this.documentHelper.pages[g].bodyWidgets[f].index<=h||!n.isForward&&this.documentHelper.pages[g].bodyWidgets[f].index<=d&&this.documentHelper.pages[g].bodyWidgets[f].index>=h){y===this.documentHelper.pages[g].bodyWidgets[f].index||m||(m=!0),this.applyPropertyValueForSection(this.documentHelper.pages[g].bodyWidgets[f].sectionFormat,e,t,m),y=this.documentHelper.pages[g].bodyWidgets[f].index,m=!1;var v=this.documentHelper.pages[g].bodyWidgets[f];sf.base.isNullOrUndefined(v.nextWidget)||v.sectionFormat.pageHeight===v.nextWidget.sectionFormat.pageHeight&&v.sectionFormat.pageWidth===v.nextWidget.sectionFormat.pageWidth||"NoBreak"!==v.nextWidget.sectionFormat.breakCode||(v.nextWidget.sectionFormat.breakCode="NewPage",v=this.documentHelper.layout.getBodyWidget(v.nextWidget,!1),sf.base.isNullOrUndefined(v.nextWidget)||(v.nextWidget.sectionFormat.breakCode="NewPage"))}this.layoutWholeDocument(),this.fireContentChange()},e.prototype.getFirstChildOfTable=function(e){return e.ownerTable.childWidgets[0].childWidgets[0].childWidgets[0]},e.prototype.onApplyTableFormat=function(e,t){if(!this.restrictFormatting){var i=this.getTableFormatAction(e);this.viewer.owner.isShiftingEnabled=!0;var r=this.documentHelper.selection,n=r.start.paragraph.associatedCell.ownerTable;n=n.combineWidget(this.owner.viewer),r.isEmpty?(this.initHistory(i),this.applyTablePropertyValue(r,e,t,n)):this.updateSelectionTableFormat(this.selection,i,t),n.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(n),this.reLayout(r,!1)}},e.prototype.getTableFormatAction=function(e){switch(e){case"tableAlignment":return"TableAlignment";case"leftIndent":return"TableLeftIndent";case"leftMargin":return"DefaultCellLeftMargin";case"rightMargin":return"DefaultCellRightMargin";case"bottomMargin":return"DefaultCellBottomMargin";case"topMargin":return"DefaultCellTopMargin";case"preferredWidth":return"TablePreferredWidth";case"preferredWidthType":return"TablePreferredWidthType";case"shading":return"Shading";case"bidi":return"TableBidi";case"title":return"TableTitle";case"description":return"TableDescription";default:return"DefaultCellSpacing"}},e.prototype.onApplyTableRowFormat=function(e,t){if(!this.restrictFormatting){var i=this.getRowAction(e);this.documentHelper.owner.isShiftingEnabled=!0;var r=this.documentHelper.selection;if(r.isEmpty){this.initHistory(i);r.start.paragraph.associatedCell.ownerRow.ownerTable;this.applyRowPropertyValue(r,e,t,r.start.paragraph.associatedCell.ownerRow)}else this.updateSelectionTableFormat(this.selection,i,t);this.reLayout(r,!1)}},e.prototype.getRowAction=function(e){switch(e){case"height":return"RowHeight";case"heightType":return"RowHeightType";case"isHeader":return"RowHeader";default:return"AllowBreakAcrossPages"}},e.prototype.onApplyTableCellFormat=function(e,t){if(!this.restrictFormatting){var i=this.getTableCellAction(e);this.documentHelper.owner.isShiftingEnabled=!0;var r=this.documentHelper.selection,n=r.start.paragraph.associatedCell.ownerTable;n=n.combineWidget(this.owner.viewer),r.isEmpty?(this.initHistory(i),this.applyCellPropertyValue(r,e,t,r.start.paragraph.associatedCell.cellFormat),n.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(n)):this.updateSelectionTableFormat(this.selection,i,t),this.reLayout(r,!1)}},e.prototype.getTableCellAction=function(e){switch(e){case"verticalAlignment":return"CellContentVerticalAlignment";case"leftMargin":return"CellLeftMargin";case"rightMargin":return"CellRightMargin";case"bottomMargin":return"CellBottomMargin";case"topMargin":return"CellTopMargin";case"preferredWidth":return"CellPreferredWidth";case"shading":return"Shading";default:return"CellPreferredWidthType"}},e.prototype.applyPropertyValueForSection=function(e,t,i,r){r&&this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&("columns"===t&&(e.numberOfColumns=i.length),i=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(e,t,i)),sf.base.isNullOrUndefined(i)||(i instanceof h?sf.base.isNullOrUndefined(t)&&e.copyFormat(i,this.editorHistory):"pageHeight"===t?e.pageHeight=i:"pageWidth"===t?e.pageWidth=i:"leftMargin"===t?e.leftMargin=i:"rightMargin"===t?e.rightMargin=i:"topMargin"===t?e.topMargin=i:"bottomMargin"===t?e.bottomMargin=i:"differentFirstPage"===t?e.differentFirstPage=i:"differentOddAndEvenPages"===t?e.differentOddAndEvenPages=i:"headerDistance"===t?e.headerDistance=i:"footerDistance"===t?e.footerDistance=i:"pageStartingNumber"===t?e.pageStartingNumber=i:"restartPageNumbering"===t?e.restartPageNumbering=i:"endnoteNumberFormat"===t?e.endnoteNumberFormat=i:"footNoteNumberFormat"===t?e.footNoteNumberFormat=i:"restartIndexForEndnotes"===t?e.restartIndexForEndnotes=i:"restartIndexForFootnotes"===t?e.restartIndexForFootnotes=i:"initialFootNoteNumber"===t?e.initialFootNoteNumber=i:"initialEndNoteNumber"===t?e.initialEndNoteNumber=i:"numberOfColumns"==t?e.numberOfColumns=i:"equalWidth"==t?e.equalWidth=i:"lineBetweenColumns"==t?e.lineBetweenColumns=i:"columns"==t&&(e.columns=i))},e.prototype.layoutWholeDocument=function(e){this.documentHelper.layout.isInitialLoad=!0,this.documentHelper.layout.isLayoutWhole=!0;var t=this.documentHelper.selection.start,i=this.documentHelper.selection.end;t.isExistAfter(i)&&(t=this.documentHelper.selection.end,i=this.documentHelper.selection.start),"Continuous"==this.owner.layoutType&&(this.documentHelper.selection.isinEndnote||this.documentHelper.selection.isinFootnote)&&(this.documentHelper.selection.footnoteReferenceElement(t,i),t=i);var r=this.selection.getParagraphInfo(t),n=this.selection.getParagraphInfo(i),o=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),s=this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString());this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[];var a=this.combineSection();this.documentHelper.clearContent(),this.documentHelper.layout.layoutItems(a,!0),this.documentHelper.owner.isShiftingEnabled=!1,this.setPositionForCurrentIndex(t,o),this.setPositionForCurrentIndex(i,s),this.documentHelper.selection.selectPosition(t,i),this.reLayout(this.documentHelper.selection,void 0,e),this.documentHelper.layout.isLayoutWhole=!1,this.documentHelper.layout.isInitialLoad=!1},e.prototype.combineSection=function(){var e=[],t=this.documentHelper.pages[0].bodyWidgets[0];do{t=this.combineSectionChild(t,e,!1)}while(t);for(var i=0;i<this.documentHelper.pages.length;i++)this.documentHelper.pages[i].destroy(),i--;return e},e.prototype.combineFollowingSection=function(){var e=[],t=this.documentHelper.selection.start.paragraph.bodyWidget.getSplitWidgets()[0];if(t.childWidgets[0]instanceof ca)this.updateWholeListItems(t.childWidgets[0]);else{var i=this.documentHelper.getFirstParagraphInFirstCell(t.childWidgets[0]);this.viewer.owner.editorModule.updateWholeListItems(i)}var r=this.documentHelper.pages.indexOf(t.page),n=0===t.indexInOwner?r:r+1;do{t=this.combineSectionChild(t,e,!1)}while(t);for(var o=n;o<this.documentHelper.pages.length;o++)this.documentHelper.pages[o].destroy(),o--;for(var s=r;s<this.documentHelper.pages.length;s++)for(var a=0;a<this.documentHelper.pages[s].bodyWidgets.length;a++)0===this.documentHelper.pages[s].bodyWidgets[a].childWidgets.length&&(this.documentHelper.pages[s].bodyWidgets.splice(a,1),a--);return e},e.prototype.combineSectionChild=function(e,t,i){var r=e,n=new aa,o=!1;n.sectionFormat=e.sectionFormat,n.index=r.index;do{o=!1,r=e,e.lastChild&&e.lastChild.combineWidget(this.owner.viewer),e=e.nextRenderedWidget;for(var s=0;s<r.childWidgets.length;s++){var a=r.childWidgets[s];a instanceof ga?this.documentHelper.layout.clearTableWidget(a,!0,!0,!0):(a.x=0,a.y=0,a.width=0,a.height=0),n.childWidgets.push(a),r.childWidgets.splice(s,1),s--,a.containerWidget=n}for(var l=0;l<r.page.bodyWidgets.length;l++){if(0!==r.page.bodyWidgets[l].childWidgets.length){o=!1;break}o=!0}o&&i&&r.page.destroy()}while(e&&r.index===e.index);return t.push(n),e},e.prototype.updateSelectionTableFormat=function(e,t,i){switch(t){case"TableAlignment":this.editorHistory.initializeHistory("TableAlignment"),this.updateTableFormat(e,"tableAlignment",i);break;case"TableLeftIndent":this.editorHistory.initializeHistory("TableLeftIndent"),this.updateTableFormat(e,"leftIndent",i);break;case"DefaultCellSpacing":this.editorHistory.initializeHistory("DefaultCellSpacing"),this.updateTableFormat(e,"cellSpacing",i);break;case"DefaultCellLeftMargin":this.editorHistory.initializeHistory("DefaultCellLeftMargin"),this.updateTableFormat(e,"leftMargin",i);break;case"DefaultCellRightMargin":this.editorHistory.initializeHistory("DefaultCellRightMargin"),this.updateTableFormat(e,"rightMargin",i);break;case"DefaultCellTopMargin":this.editorHistory.initializeHistory("DefaultCellTopMargin"),this.updateTableFormat(e,"topMargin",i);break;case"TablePreferredWidth":this.editorHistory.initializeHistory("TablePreferredWidth"),this.updateTableFormat(e,"preferredWidth",i);break;case"TablePreferredWidthType":this.editorHistory.initializeHistory("TablePreferredWidthType"),this.updateTableFormat(e,"preferredWidthType",i);break;case"DefaultCellBottomMargin":this.editorHistory.initializeHistory("DefaultCellBottomMargin"),this.updateTableFormat(e,"bottomMargin",i);break;case"CellContentVerticalAlignment":this.editorHistory.initializeHistory("CellContentVerticalAlignment"),this.updateCellFormat(e,"verticalAlignment",i);break;case"CellLeftMargin":this.editorHistory.initializeHistory("CellLeftMargin"),this.updateCellFormat(e,"leftMargin",i);break;case"CellRightMargin":this.editorHistory.initializeHistory("CellRightMargin"),this.updateCellFormat(e,"rightMargin",i);break;case"CellTopMargin":this.editorHistory.initializeHistory("CellTopMargin"),this.updateCellFormat(e,"topMargin",i);break;case"CellBottomMargin":this.editorHistory.initializeHistory("CellBottomMargin"),this.updateCellFormat(e,"bottomMargin",i);break;case"CellPreferredWidth":this.editorHistory.initializeHistory("CellPreferredWidth"),this.updateCellFormat(e,"preferredWidth",i);break;case"CellPreferredWidthType":this.editorHistory.initializeHistory("CellPreferredWidthType"),this.updateCellFormat(e,"preferredWidthType",i);break;case"Shading":this.editorHistory.initializeHistory("Shading"),this.updateCellFormat(e,"shading",i);break;case"RowHeight":this.editorHistory.initializeHistory("RowHeight"),this.updateRowFormat(e,"height",i);break;case"RowHeightType":this.editorHistory.initializeHistory("RowHeightType"),this.updateRowFormat(e,"heightType",i);break;case"RowHeader":this.editorHistory.initializeHistory("RowHeader"),this.updateRowFormat(e,"isHeader",i);break;case"AllowBreakAcrossPages":this.editorHistory.initializeHistory("AllowBreakAcrossPages"),this.updateRowFormat(e,"allowBreakAcrossPages",i);break;case"TableBidi":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"bidi",i);break;case"TableTitle":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"title",i);break;case"TableDescription":this.editorHistory.initializeHistory(t),this.updateTableFormat(e,"description",i)}},e.prototype.updateTableFormat=function(e,t,i){var r=e.start;e.end;e.isForward||(r=e.end,e.start),this.initHistoryPosition(e,r),this.applyTablePropertyValue(e,t,i,r.paragraph.associatedCell.ownerTable),this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&this.documentHelper.layout.reLayoutTable(r.paragraph.associatedCell.ownerTable)},e.prototype.updateCellFormat=function(e,t,i){e.owner.isShiftingEnabled=!0;var r=e.start;e.end;e.isForward||(r=e.end,e.start),this.initHistoryPosition(e,r),this.updateFormatForCell(e,t,i)},e.prototype.updateRowFormat=function(e,t,i){var r=e.start,n=e.end;e.isForward||(r=e.end,n=e.start),this.initHistoryPosition(e,r),this.applyRowFormat(r.paragraph.associatedCell.ownerRow,r,n,t,i)},e.prototype.initHistoryPosition=function(e,t){this.documentHelper.owner.editorHistoryModule&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(sf.base.isNullOrUndefined(t)?sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.start.getHierarchicalIndexInternal()):sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=t.getHierarchicalIndexInternal()))},e.prototype.startSelectionReLayouting=function(e,t,i,r){if(t.owner.isLayoutEnabled=!0,i.paragraph.isInsideTable){for(var n=i.paragraph.associatedCell.ownerTable;n.isInsideTable;)n=n.associatedCell.ownerTable;this.reLayoutSelectionOfTable(n,t,i,r)}else this.reLayoutSelection(e,t,i,r)},e.prototype.reLayoutSelectionOfTable=function(e,t,i,r){var n=!1;if(this.documentHelper.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),!sf.base.isNullOrUndefined(r.paragraph.associatedCell)&&e.contains(r.paragraph.associatedCell))return!0;var o=t.getNextRenderedBlock(e);return sf.base.isNullOrUndefined(o)||(n=this.reLayoutSelectionOfBlock(o,t,i,r)),n},e.prototype.reLayoutSelection=function(e,t,i,r){if(i.paragraph===e){i.offset,t.getParagraphLength(e);var n=0,o=0,s=e.getInline(i.offset,n),a=s.element;n=s.index,sf.base.isNullOrUndefined(a)||(n!==a.length||sf.base.isNullOrUndefined(a.nextNode)||(a=a.nextNode),o=a.line.children.indexOf(a));var l=0;i.currentWidget.paragraph===e&&(l=e.childWidgets.indexOf(i.currentWidget),o=i.currentWidget.children.indexOf(a)),a instanceof Fa&&!a.line&&o>0?this.documentHelper.layout.reLayoutParagraph(e,l,o-1):this.documentHelper.layout.reLayoutParagraph(e,l,o)}else this.documentHelper.layout.reLayoutParagraph(e,0,0);if(r.paragraph===e)return!0;var d=t.getNextRenderedBlock(e);return!sf.base.isNullOrUndefined(d)&&this.reLayoutSelectionOfBlock(d,t,i,r)},e.prototype.reLayoutSelectionOfBlock=function(e,t,i,r){return e instanceof ca?this.reLayoutSelection(e,t,i,r):void 0},e.prototype.layoutItemBlock=function(e,t){var i=void 0;if(e.containerWidget instanceof sa||e.containerWidget instanceof Aa)!sf.base.isNullOrUndefined(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&(i=(e=e.combineWidget(this.viewer)).containerWidget,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,i,e,!1));else if(e.containerWidget instanceof ua){var r=e.containerWidget;r=this.documentHelper.selection.getContainerCell(r),!sf.base.isNullOrUndefined(this.documentHelper.owner)&&this.documentHelper.owner.isLayoutEnabled&&this.documentHelper.layout.reLayoutTable(e)}},e.prototype.removeSelectedContents=function(e){return this.removeSelectedContentInternal(e,e.start,e.end)},e.prototype.removeSelectedContentInternal=function(e,t,i){var r=t,n=i;if(t.isExistBefore(i)||(r=i,n=t),r.paragraph===n.paragraph&&r.paragraph.childWidgets.indexOf(r.currentWidget)===r.paragraph.childWidgets.length-1&&r.offset===e.getParagraphLength(r.paragraph)&&r.offset+1===n.offset)return e.owner.isShiftingEnabled=!0,e.selectContent(r,!0),!0;var o=this.selection.getParagraphInfo(r);e.editPosition=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString());var s=r.clone(),a=s.paragraph.containerWidget,l=s.currentWidget.isFirstLine(),d=this.checkMultipleSectionSelected(s,n),h=this.removeSelectedContent(n.paragraph,e,r,n),c=new Al(e.owner);if(d&&"DefaultPaste"==this.selection.currentPasteAction&&l&&s.offset<1){var p=s.paragraph,g=new ca,f=new ma(g);f.paragraph=g,g.containerWidget=a,g.childWidgets.push(f),a.childWidgets.push(g),g.index=p.index,g.x=s.location.x,g.y=s.location.y}return this.setPositionForCurrentIndex(c,e.editPosition),e.selectContent(c,!0),h},e.prototype.checkMultipleSectionSelected=function(e,t){return this.getBodyWidgetIndex(e)!=this.getBodyWidgetIndex(t)},e.prototype.getBodyWidgetIndex=function(e){var t=e.hierarchicalPosition,i=t.indexOf(";"),r=t.substring(0,i);return i=(t=t.substring(i).replace(";","")).indexOf(";"),r=t.substring(0,i),parseInt(r,10)},e.prototype.removeSelectedContent=function(e,t,i,r){return!(r.paragraph.isInsideTable&&r.paragraph!==this.documentHelper.getLastParagraphInLastCell(r.paragraph.associatedCell.ownerTable)&&(!i.paragraph.isInsideTable||i.paragraph.associatedCell.ownerTable.index!==r.paragraph.associatedCell.ownerTable.index))&&(t.owner.isShiftingEnabled=!0,this.deleteSelectedContent(e,t,i,r,2),!0)},e.prototype.deleteSelectedContent=function(e,t,i,r,n,o){var s=0,a=i.currentWidget.getInline(i.offset,s);a.element;if(s=a.index,s=0,(a=r.currentWidget.getInline(r.offset,s)).element,s=a.index,r.paragraph===e){if(r.paragraph.isInsideTable&&(!i.paragraph.isInsideTable||i.paragraph.associatedCell!==r.paragraph.associatedCell||t.isCellSelected(r.paragraph.associatedCell,i,r)&&o))r.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer),this.deleteTableCell(r.paragraph.associatedCell,t,i,r,n,o);else{var l=void 0;if(this.owner.viewer instanceof Qs&&e.bodyWidget.sectionFormat.numberOfColumns>1&&e===e.bodyWidget.lastChild&&!sf.base.isNullOrUndefined(e.bodyWidget.nextRenderedWidget)&&e.bodyWidget.index!==e.bodyWidget.nextRenderedWidget.index&&e.bodyWidget.page===e.bodyWidget.nextRenderedWidget.page&&(l=e.nextRenderedWidget),this.deletePara(e,i,r,n),this.delBlockContinue&&this.delBlock){if(this.delSection){var d=e.bodyWidget instanceof aa?e.bodyWidget:void 0;this.deleteSection(t,this.delSection,d,n),this.delSection=void 0}this.deleteBlock(this.delBlock,t,i,r,n),this.delBlockContinue=!1,this.delBlock=void 0}this.owner.viewer instanceof Qs&&void 0!==l&&(this.documentHelper.blockToShift=l)}if(this.removeCommentCharacters.length>0&&!this.isCmtDeleteStarted){for(var h=0;h<this.removeCommentCharacters.length;h++){var c=this.editorHistory.currentBaseHistoryInfo,p=this.removeCommentCharacters[h];this.isCmtDeleteStarted=!0,p.commentMark&&p.removeCommentMark(),p.line&&p.line.paragraph&&p.line.paragraph.bodyWidget&&c&&(this.removeInline(p),this.selection.editPosition=c.insertPosition,this.isCmtDeleteStarted=!1,this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=c.insertPosition,this.editorHistory.currentHistoryInfo.endPosition=c.insertPosition,this.editorHistory.currentHistoryInfo.selectionStart=c.selectionStart,this.editorHistory.currentHistoryInfo.selectionEnd=c.selectionEnd,c.endPosition=c.insertPosition,this.editorHistory.updateComplexHistory(),this.editorHistory.currentBaseHistoryInfo=void 0))}this.isCmtDeleteStarted=!1,this.removeCommentCharacters=[],this.editorHistory.currentHistoryInfo&&(this.editorHistory.updateComplexHistory(),this.editorHistory.currentBaseHistoryInfo=void 0),this.selection.owner.isShiftingEnabled=!1}}else this.deleteSelectedContent(r.paragraph,t,i,r,n)},e.prototype.mergeCells=function(){!this.owner.isReadOnlyMode&&this.canEditContentControl&&this.owner.isDocumentLoaded&&(sf.base.isNullOrUndefined(this.documentHelper)||this.selection.isEmpty||this.mergeSelectedCellsInTable())},e.prototype.deleteTable=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var e=this.selection.isForward?this.selection.start:this.selection.end;if(e.paragraph.isInsideTable){var t=this.getOwnerTable(this.selection.isForward).combineWidget(this.owner.viewer);this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&(this.initHistory("DeleteTable"),this.updateHistoryPosition(e,!0));var i=!0;if(!this.skipTracking()){for(var r=0,n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n];1===o.rowFormat.revisions.length&&"Insertion"===o.rowFormat.revisions[0].revisionType&&o.rowFormat.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)&&(this.isRemoveRevision=!0,this.unlinkRangeFromRevision(o.rowFormat,!0),this.isRemoveRevision=!1,0===o.rowFormat.revisions[0].range.length&&o.rowFormat.revisions.splice(0,1),r++)}r===t.childWidgets.length&&(i=!1)}var s=this.getParagraphForSelection(t);if(this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(t.clone()),this.owner.enableTrackChanges&&i)for(n=0;n<t.childWidgets.length;n++){if(0===n){var a=t.childWidgets[0];s=this.selection.getFirstParagraph(a)}this.trackRowDeletion(t.childWidgets[n])}else this.removeBlock(t);this.selection.selectParagraphInternal(s,!0),(this.checkIsNotRedoing()||sf.base.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection)}}},e.prototype.deleteColumn=function(){!this.owner.isReadOnlyMode&&this.canEditContentControl&&(this.owner.enableTrackChanges||this.onDeleteColumnConfirmed())},e.prototype.onDeleteColumnConfirmed=function(){var e=this.selection.isForward?this.selection.start:this.selection.end;this.selection.isForward?this.selection.end:this.selection.start;if(e.paragraph.isInsideTable){this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&this.initHistory("DeleteColumn");var t=this.getOwnerCell(this.selection.isForward),i=this.getOwnerCell(!this.selection.isForward),r=t.ownerTable.combineWidget(this.owner.viewer);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(r);var n=void 0;if(i.nextWidget){var o=i.nextWidget;n=this.selection.getFirstParagraph(o)}else if(t.previousWidget){var s=t.previousWidget;n=this.selection.getFirstParagraph(s)}sf.base.isNullOrUndefined(n)&&(n=this.getParagraphForSelection(r));for(var a=r.getColumnCellsForSelection(t,i),l=0;l<r.childWidgets.length;l++){var d=r.childWidgets[l];if(1===d.childWidgets.length)a.indexOf(d.childWidgets[0])>=0&&(this.removeFieldInWidget(d.childWidgets[0],!0),r.childWidgets.splice(r.childWidgets.indexOf(d),1),d.destroy(),l--);else{for(var h=0;h<d.childWidgets.length;h++){var c=d.childWidgets[h];a.indexOf(c)>=0&&(this.removeFieldInWidget(c,!0),d.childWidgets.splice(h,1),c.destroy(),h--)}0===d.childWidgets.length&&(r.childWidgets.splice(r.childWidgets.indexOf(d),1),d.destroy(),l--)}}0===r.childWidgets.length?(n=this.getParagraphForSelection(r),this.removeBlock(r),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),r.destroy()):this.updateTable(r),this.selection.selectParagraphInternal(n,!0),(sf.base.isNullOrUndefined(this.editorHistory)||this.checkIsNotRedoing())&&this.reLayout(this.selection,!0)}},e.prototype.deleteRow=function(){if(!this.owner.isReadOnlyMode&&this.canEditContentControl){var e=this.selection.isForward?this.selection.start:this.selection.end,t=(this.selection.isForward?this.selection.end:this.selection.start,this.selection.getParagraphInfo(e)),i=this.selection.getHierarchicalIndex(t.paragraph,t.offset.toString());if(e.paragraph.isInsideTable){var r=this.getOwnerCell(this.selection.isForward),n=this.getOwnerCell(!this.selection.isForward);this.checkIsNotRedoing()&&this.initHistory("DeleteRow"),this.selection.owner.isShiftingEnabled=!0;var o=r.ownerTable.combineWidget(this.owner.viewer),s=this.getOwnerRow(!0);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(o);var a=void 0;if(s.nextWidget){var l=s.nextWidget.childWidgets[0];a=this.selection.getFirstParagraph(l)}if(sf.base.isNullOrUndefined(a)&&(a=this.getParagraphForSelection(o)),e=e.clone(),this.selection.isEmpty)this.owner.enableTrackChanges?this.trackRowDeletion(s,!0,!1):this.removeRow(s);else{var d=this.selection.getContainerCellOf(r,n);if(d.ownerTable.contains(n))if(r=this.selection.getSelectedCell(r,d),n=this.selection.getSelectedCell(n,d),this.selection.containsCell(d,n))s=r.ownerRow,this.removeRow(s);else{s=r.ownerRow;var h=n.ownerRow;if(a=void 0,h.nextWidget){l=h.nextWidget.childWidgets[0];a=this.selection.getFirstParagraph(l)}sf.base.isNullOrUndefined(a)&&(a=this.getParagraphForSelection(o));for(var c=0;c<o.childWidgets.length;c++){var p=o.childWidgets[c];p.rowIndex>=s.rowIndex&&p.rowIndex<=h.rowIndex&&(this.owner.enableTrackChanges&&this.checkIsNotRedoing()?this.trackRowDeletion(p,!0,!1):(this.removeFieldInBlock(p,!0),o.childWidgets.splice(c,1),p.destroy(),c--))}0===o.childWidgets.length?(this.removeBlock(o),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),o.destroy()):this.updateTable(o)}}if(!this.owner.enableTrackChanges||sf.base.isNullOrUndefined(o.childWidgets))this.selection.selectParagraphInternal(a,!0);else{var g=this.selection.getTextPosBasedOnLogicalIndex(i);this.selection.selectContent(g,!0)}(sf.base.isNullOrUndefined(this.editorHistory)||this.checkIsNotRedoing())&&this.reLayout(this.selection,!0)}}},e.prototype.trackRowDeletion=function(e,t,i){var r=e.rowFormat;if(!sf.base.isNullOrUndefined(r)){if(r.revisions.length>0){var n=this.retrieveRevisionInOder(r);if("Insertion"===n.revisionType){if(this.isRevisionMatched(r,void 0))return sf.base.isNullOrUndefined(t)||t?this.removeRow(e):this.removeRevisionsInRow(e),!0}else"Deletion"===n.revisionType&&this.unlinkWholeRangeInRevision(r,n)}(sf.base.isNullOrUndefined(i)||i)&&this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="RemoveRowTrack"),this.insertRevision(r,"Deletion");for(var o=0;o<e.childWidgets.length;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)if(s.childWidgets[a]instanceof ga)this.trackInnerTable(s.childWidgets[o],t,i);else{var l=s.childWidgets[a];this.skipTableElements=!0,this.insertRevisionForBlock(l,"Deletion",void 0,void 0,!0),this.skipTableElements=!1}}return!1},e.prototype.trackInnerTable=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++)this.trackRowDeletion(e.childWidgets[r],t,i)},e.prototype.returnDeleteRevision=function(e){for(var t=0;t<e.length;t++)if("Deletion"===e[t].revisionType)return e[t]},e.prototype.removeRow=function(e){var t=e.ownerTable;e.rowFormat.revisions.length>0&&this.removeRevisionsInRow(e),1===t.childWidgets.length?(this.removeBlock(t),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="Delete"),t.destroy()):(this.removeFieldInBlock(e,!0),t.childWidgets.splice(t.childWidgets.indexOf(e),1),e.destroy(),this.updateTable(t))},e.prototype.updateTable=function(e,t){t||(e=e.combineWidget(this.viewer)),e.updateRowIndex(0),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e)},e.prototype.getParagraphForSelection=function(e){var t=void 0,i=e.nextWidget?e.nextWidget:e.nextRenderedWidget,r=e.previousWidget?e.previousWidget:e.previousRenderedWidget;return i?t=i instanceof ca?i:this.documentHelper.getFirstParagraphInFirstCell(i):r&&(t=r instanceof ca?r:this.documentHelper.getLastParagraphInLastCell(r)),t},e.prototype.deletePara=function(e,t,i,r){e=e.combineWidget(this.owner.viewer);var n,o=this.documentHelper.selection,s=o.getStartOffset(e),a=o.getStartOffset(i.paragraph),l=s,d=0,h=!1,c=this.selection.getLineLength(e.lastChild),p=e,g=e.bodyWidget instanceof aa?e.bodyWidget:void 0,f=void 0,u=void 0,m=this.combineLastBlock;e===t.paragraph?(l=t.offset,f=t.currentWidget,n=l,l+1===this.documentHelper.selection.getLineLength(e.lastChild)&&l++,!i.paragraph.isInsideTable||this.owner.enableTrackChanges&&!this.skipTracking()||(h=this.isEndInAdjacentTable(e,i.paragraph)),h||(h=this.combineLastBlock),this.combineLastBlock=!1):f=e.firstChild,e!==t.paragraph&&o.isSkipLayouting&&(o.isSkipLayouting=!1),e===i.paragraph?(u=i.currentWidget,d=i.offset):(u=e.lastChild,d=this.documentHelper.selection.getLineLength(e.lastChild));var y=sf.base.isNullOrUndefined(e.previousRenderedWidget)||t.paragraph===e?void 0:e.previousRenderedWidget.combineWidget(this.documentHelper.viewer);if(this.owner.enableTrackChanges&&!sf.base.isNullOrUndefined(y)&&y instanceof ga&&e.isEmpty()&&sf.base.isNullOrUndefined(e.nextRenderedWidget))return this.delBlockContinue=!0,void(this.delBlock=y);(l>s&&t.currentWidget===e.lastChild&&l===c&&(e===i.paragraph&&i.offset===l+1||e.nextRenderedWidget===i.paragraph&&i.offset===a)||this.editorHistory&&this.editorHistory.isUndoing&&this.editorHistory.currentHistoryInfo&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&y&&y.isPageBreak()&&(0===l&&!t.currentWidget.isFirstLine||l>0)||t.paragraph!==i.paragraph&&2===r&&t.paragraph===e&&t.paragraph.nextWidget===i.paragraph||!(e.nextRenderedWidget instanceof ga)&&!sf.base.isNullOrUndefined(this.editorHistory)&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&("Reject Change"===this.editorHistory.currentBaseHistoryInfo.action&&t.paragraph===e&&i.paragraph!=e&&l>=s||"Accept Change"===this.editorHistory.currentBaseHistoryInfo.action&&t.currentWidget.isLastLine()&&(t.currentWidget==i.currentWidget&&t.offset+1>=i.paragraph.getLength()||t.currentWidget!==i.currentWidget&&t.paragraph===e)))&&(h=!0),n+1===this.documentHelper.selection.getLineLength(e.lastChild)&&l--;var v=i.clone();v.offset=v.offset-1;var w=t.paragraph===e&&t.isAtParagraphStart&&v.isAtParagraphEnd&&this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&"Insert"===this.editorHistory.currentBaseHistoryInfo.action;w&&(this.editorHistory.currentBaseHistoryInfo.action="InsertTextParaReplace");var b=t.paragraph===e;if(i.paragraph===e&&i.currentWidget!==e.lastChild||i.currentWidget===e.lastChild&&i.offset<=o.getLineLength(e.lastChild)||w){if((i.currentWidget.isFirstLine()&&i.offset>s||!i.currentWidget.isFirstLine()||w)&&this.removeInlines(e,f,l,u,d,r),sf.base.isNullOrUndefined(y)||b||w)this.delBlockContinue=!1,this.delBlock=void 0;else this.delBlockContinue=!0,this.delBlock=y,(H=y.bodyWidget instanceof aa?y.bodyWidget:void 0)&&!g.equals(H)&&g.index!==H.index?this.delSection=H:this.delSection=void 0}else{if(t.paragraph===e&&(t.currentWidget!==e.firstChild||t.currentWidget===e.firstChild&&l>s)){if(this.delBlockContinue=!1,this.delBlock=void 0,4===r)return;if(this.skipTracking()&&"ParaMarkTrack"===this.editorHistory.currentBaseHistoryInfo.action)this.addRemovedNodes(e.characterFormat.cloneFormat()),e.characterFormat.revisions.length>0&&this.unlinkRangeFromRevision(e.characterFormat,!0),e.characterFormat.revisions=[];else if(this.owner.enableTrackChanges&&!this.skipTracking()&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action&&"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action)if(h)p=this.splitParagraph(e,e.firstChild,0,f,l,!0),this.deleteParagraphMark(p,o,r,!0),this.addRemovedNodes(e);else{if(t.paragraph!==i.paragraph&&l!==e.getLength()){var x=new ca;x.childWidgets=void 0,this.addRemovedNodes(x),this.insertRevision(e.characterFormat,"Deletion")}if(this.removeInlines(e,f,l,u,d,r),l!==e.getLength()){var I=e.lastChild;if(I.children.length>0){var F=I.children[I.children.length-1];this.combineElementRevision(F.revisions,e.characterFormat.revisions)}e.isEmpty()?this.combineRevisionWithBlocks(e):this.combineRevisionWithBlocks(e.lastChild.children[e.lastChild.children.length-1])}}else if(t.currentWidget.isFirstLine()||e.lastChild!==i.currentWidget||h){!sf.base.isNullOrUndefined(this.editorHistory)&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&"Reject Change"===this.editorHistory.currentBaseHistoryInfo.action&&t.paragraph===e&&i.paragraph!=e&&l>=s&&h&&(m=!0),p=this.splitParagraph(e,e.firstChild,0,f,l,!0),sf.base.isNullOrUndefined(p)||sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.deletaRevisionIDs(p.characterFormat);var C=!1;i.paragraph.isEmpty()||!h||this.editorHistory&&this.editorHistory.currentHistoryInfo&&"PageBreak"===this.editorHistory.currentHistoryInfo.action||(C=!0),this.insertParagraphPaste(e,p,t,i,h,r,m,C),this.removeRevisionForBlock(e,void 0,!1,!0),this.addRemovedNodes(e),m=!1}else this.removeInlines(e,f,l,u,d,r);return}i.paragraph===e&&i.paragraph.isInsideTable&&(t.currentWidget.isFirstLine()&&t.offset>o.getStartOffset(t.paragraph)||!t.currentWidget.isFirstLine())&&i.offset>=o.getLineLength(i.paragraph.lastChild)&&i.paragraph.nextRenderedWidget&&(this.combineLastBlock=!0);var W=void 0,k=e.previousWidget,S=k instanceof ca?k:void 0,P=e.nextRenderedWidget;if(r<4){if(this.owner.enableTrackChanges&&!this.skipTracking()&&this.editorHistory.currentBaseHistoryInfo&&"TOC"!==this.editorHistory.currentBaseHistoryInfo.action){var N=-1;this.editorHistory.currentBaseHistoryInfo&&(N=this.editorHistory.currentBaseHistoryInfo.removedNodes.length),this.insertRevisionForBlock(e,"Deletion");var O=e.characterFormat.revisions;if(!(i.paragraph.previousRenderedWidget instanceof ga)&&O.length>1&&"Insertion"==O[O.length-2].revisionType)if(e.isEmpty())W=this.checkAndInsertBlock(e,t,i,r,S),this.removeBlock(e),-1===N?this.addRemovedNodes(e):this.editorHistory.currentBaseHistoryInfo.removedNodes.splice(N,0,e),this.removeRevisionForBlock(e,void 0,!1,!0);else{for(;0!==e.characterFormat.revisions.length;)this.removePrevParaMarkRevision(e,!0);this.deleteParagraphMark(e,o,r,!1),P=e.nextRenderedWidget}else e.isEmpty()?this.combineRevisionWithBlocks(e):this.combineRevisionWithBlocks(e.firstChild.children[0]);if("Delete"===this.editorHistory.currentBaseHistoryInfo.action&&!this.isInsertingTOC&&(e===i.paragraph&&e.containerWidget&&!e.isEmpty()||sf.base.isNullOrUndefined(t.paragraph.containerWidget)&&!sf.base.isNullOrUndefined(i.paragraph.containerWidget)&&!i.paragraph.isEmpty())){var T=this.selection.getParagraphInfo(i);this.selection.editPosition=this.selection.getHierarchicalIndex(T.paragraph,T.offset.toString())}if(t.paragraph!==e&&!sf.base.isNullOrUndefined(y))return this.delBlockContinue=!0,void(this.delBlock=y)}else{W=this.checkAndInsertBlock(e,t,i,r,S),this.removeRevisionForBlock(e,void 0,!1,!0);var H,E=e==this.getLastParaForBodywidgetCollection(e);if(this.owner.enableTrackChanges&&E)for(var R=e.childWidgets.length-1;R>-1;R--){var U=e.childWidgets[R];this.removeContent(U,0,this.documentHelper.selection.getLineLength(U),void 0,!1)}else{var B=this.selection.getNextParagraphBlock(e);E||e.isInsideTable||sf.base.isNullOrUndefined(B)||B.isInsideTable||e.bodyWidget.sectionIndex===B.bodyWidget.sectionIndex||(this.deleteSection(o,e.bodyWidget,B.bodyWidget,r),b=!0),this.addRemovedNodes(e)}if(!sf.base.isNullOrUndefined(y)&&!b&&!w)if(this.delBlock=y,(H=y.bodyWidget instanceof aa?y.bodyWidget:void 0)&&g.index!==H.index){var L=e.bodyWidget instanceof aa?e.bodyWidget:void 0;this.deleteSection(o,H,L,r)}this.removeBlock(e)}if(this.documentHelper.blockToShift===e&&(this.documentHelper.blockToShift=void 0),sf.base.isNullOrUndefined(W)){if(e===t.paragraph&&(sf.base.isNullOrUndefined(P)||!sf.base.isNullOrUndefined(P)&&!sf.base.isNullOrUndefined(g)&&g.index!==P.bodyWidget.index)&&!sf.base.isNullOrUndefined(S)){A=this.selection.getParagraphLength(S);o.editPosition=this.selection.getHierarchicalIndex(S,A.toString()),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(o.editPosition,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=o.editPosition)}}else{o.editPosition=this.selection.getHierarchicalIndex(W,"0");var A=o.getParagraphLength(W)+1;this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(W,A.toString()))}}t.paragraph===e||sf.base.isNullOrUndefined(y)?(this.delBlockContinue=!1,this.delBlock=void 0):(this.delBlockContinue=!0,this.delBlock=y)}this.insertParagraphPaste(e,p,t,i,h,r,m)},e.prototype.deletaRevisionIDs=function(e){if(e.removedIds.length>0)for(;e.removedIds.length>0;)e.removedIds.splice(0,1)},e.prototype.deleteSection=function(e,t,i,r){r<4&&this.combineSectionInternal(e,t,i),r>2&&t.sectionFormat.copyFormat(i.sectionFormat)},e.prototype.combineSectionInternal=function(e,t,i){var r=t.getSplitWidgets()[0],n=[],o=r.y;this.combineSectionChild(r,n,!0);var s=(r=n[0]).lastChild.index;this.updateBlockIndex(s+1,i.firstChild);var a=0,l=i;l.y=o;for(var d=0;d<r.childWidgets.length;d++){var h=r.childWidgets.splice(d,1)[0];l.childWidgets.splice(a,0,h),h.containerWidget=l,this.documentHelper.layout.layoutBodyWidgetCollection(h.index,h.bodyWidget,h,!1),l=(h=h.getSplitWidgets().pop()).containerWidget,a=h.indexInOwner+1,d--}if(r.sectionIndex>0&&this.documentHelper.headersFooters[r.sectionIndex]){r.removedHeaderFooters=[];var c=this.documentHelper.headersFooters.splice(r.sectionIndex,1)[0],p=Object.keys(c);for(d=0;d<p.length;d++){var g=c[p[d]];this.removeFieldInWidget(g),this.removeFieldInWidget(g,!1,!0),g.page=void 0}r.removedHeaderFooters.push(c)}this.updateSectionIndex(void 0,i,!1),this.addRemovedNodes(r),this.documentHelper.removeEmptyPages(),this.editorHistory&&this.editorHistory.isUndoing&&(i.sectionFormat=t.sectionFormat);var f=i.page;do{this.documentHelper.layout.layoutHeaderFooter(f.bodyWidgets[0],this.viewer,f),f=f.nextPage}while(f)},e.prototype.checkAndInsertBlock=function(e,t,i,r,n){if(e instanceof ca&&e===t.paragraph||e instanceof ga){var o=void 0;if(sf.base.isNullOrUndefined(e.nextRenderedWidget)&&(sf.base.isNullOrUndefined(n)||n.nextRenderedWidget instanceof ga)){if(o=new ca,1===r&&e instanceof ca&&!sf.base.isNullOrUndefined(e.paragraphFormat.baseStyle)&&"Normal"===e.paragraphFormat.baseStyle.name){if(o.characterFormat.copyFormat(e.characterFormat),sf.base.isNullOrUndefined(e.previousRenderedWidget)&&0!==o.characterFormat.removedIds.length)for(;o.characterFormat.removedIds.length>0;)o.characterFormat.removedIds.splice(0,1);o.paragraphFormat.copyFormat(e.paragraphFormat)}if(o.index=e.index+1,o.containerWidget=e.containerWidget,e instanceof ca){o.paragraphFormat.lineSpacing=e.paragraphFormat.lineSpacing,o.paragraphFormat.lineSpacingType=e.paragraphFormat.lineSpacingType;var s=this.documentHelper.styles.findByName("Normal");sf.base.isNullOrUndefined(s)||(o.paragraphFormat.baseStyle=new vl,o.paragraphFormat.baseStyle.copyStyle(s))}this.documentHelper.layout.layoutBodyWidgetCollection(o.index,o.bodyWidget,o,!1),e.containerWidget instanceof oa&&e.containerWidget.childWidgets.push(o)}return o}},e.prototype.splitParagraph=function(e,t,i,r,n,o){var s=new ca;s.paragraphFormat=new ul(s),s.characterFormat=new T(s),s.paragraphFormat.copyFormat(e.paragraphFormat),s.characterFormat.copyFormat(e.characterFormat);var a=new ma(s);s.childWidgets.push(a);var l=e.index,d=e.indexInOwner;if(this.moveInlines(e,s,0,i,t,n,r,o),e.containerWidget.childWidgets[d])for(var h=e.containerWidget.childWidgets[d],c=0;c<h.childWidgets.length;c++)for(var p=h.childWidgets[c],g=0;g<p.children.length;g++){var f=p.children[g];f instanceof Wa&&this.removeFootnote(f)}return e.containerWidget.childWidgets.splice(d,0,s),s.index=l,s.containerWidget=e.containerWidget,this.updateNextBlocksIndex(s,!0),o&&this.removeBlock(e),this.documentHelper.layout.layoutBodyWidgetCollection(l,s.containerWidget,s,!1),s},e.prototype.addOrRemoveCommentsInBlock=function(e,t){if(e instanceof ga)for(var i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];this.addOrRemoveCommentsInBlock(a,t)}else this.addOrRemoveCommentInPara(e,t)},e.prototype.addOrRemoveCommentInPara=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.children.length;n++)this.addOrRemoveCommentsInline(r.children[n],t)},e.prototype.addOrRemoveCommentsInline=function(e,t){if(e instanceof al&&0===e.commentType&&!sf.base.isNullOrUndefined(e.comment)){var i=e.comment.ownerComment?e.comment.ownerComment:e.comment;t?this.addCommentWidget(i,!1,!1,!1):(e.commentMark&&e.removeCommentMark(),this.deleteCommentWidget(i))}},e.prototype.removeBlock=function(e,t,i){var r,n;if(i||(this.removeFieldInBlock(e),this.removeFieldInBlock(e,!0),this.removeFieldInBlock(e,void 0,!0)),this.addOrRemoveCommentsInBlock(e),e.isInsideTable)n=e.associatedCell,r=e.associatedCell.childWidgets.indexOf(e),e.associatedCell.childWidgets,this.updateNextBlocksIndex(e,!1),e.associatedCell.childWidgets.splice(r,1),e.containerWidget=void 0,this.documentHelper.layout.layoutBodyWidgetCollection(e.index,n,e,!1);else{n=e.containerWidget;for(var o=0;o<e.childWidgets.length;o++){var s=void 0;if(this.isPasteRevertAction()||(s=this.skipTracking()),e.childWidgets[o]instanceof fa&&!s){var a=e.childWidgets[o];this.removeDeletedCellRevision(a)}if(e.childWidgets[o]instanceof ma)for(var l=e.childWidgets[o],d=0;d<l.children.length;d++){var h=l.children[d];h instanceof Wa&&!this.selection.isEmpty&&this.removeFootnote(h)}}r=n.childWidgets.indexOf(e),n.childWidgets,this.updateNextBlocksIndex(e,!1),n.childWidgets.splice(r,1),e.containerWidget=void 0,n.height-=e.height,!sf.base.isNullOrUndefined(n.containerWidget)&&n.containerWidget instanceof ha&&(n.containerWidget.height-=e.height),this.documentHelper.layout.layoutBodyWidgetCollection(e.index,n,e,!1,t)}},e.prototype.removePrevParaMarkRevision=function(e,t){if(t=!sf.base.isNullOrUndefined(t)&&t,this.owner.enableTrackChanges||0!=e.characterFormat.revisions.length){var i=-1,r=void 0,n=e;if(t||sf.base.isNullOrUndefined(n.previousRenderedWidget)||(n=n.previousRenderedWidget),n.characterFormat.revisions.length>0&&(i=(r=n.characterFormat.revisions[n.characterFormat.revisions.length-1]).range.indexOf(n.characterFormat)),i>=0&&!sf.base.isNullOrUndefined(r))r.range[i]instanceof T&&(r.range.splice(i,1),this.owner.trackChangesPane.updateCurrentTrackChanges(r),n.characterFormat&&n.characterFormat.revisions.indexOf(r)>-1&&n.characterFormat.revisions.splice(n.characterFormat.revisions.indexOf(r),1),0==r.range.length&&this.owner.revisionsInternal.remove(r))}},e.prototype.isPasteRevertAction=function(){return!(sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Paste"!==this.editorHistory.currentBaseHistoryInfo.action)},e.prototype.toCheckForTrack=function(e){if(this.owner.enableTrackChanges&&!this.skipTracking()&&e instanceof ga&&e.childWidgets.length>0){var t=e.childWidgets[0].rowFormat;if(t.revisions.length>0&&"Insertion"!==t.revisions[0].revisionType&&t.revisions[0].author===(""===this.owner.currentUser?"Guest user":this.owner.currentUser)||0===t.revisions.length)return!0}return!1},e.prototype.removeFootnote=function(e,t){if(e.paragraph.bodyWidget.page.footnoteWidget){for(var i=e.paragraph.bodyWidget.page.footnoteWidget,r=0;r<i.bodyWidgets.length;r++)if(e===i.bodyWidgets[r].footNoteReference){if(i.height-=i.bodyWidgets[r].childWidgets[0].height,this.owner.enableTrackChanges)for(var n=0;n<i.bodyWidgets[r].childWidgets.length;n++)this.removeRevisionForBlock(i.bodyWidgets[r].childWidgets[n],void 0,!1,!0);i.bodyWidgets.splice(r,1),r--,this.isFootnoteElementRemoved=!0}0===i.bodyWidgets.length&&(e.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(this.documentHelper.footnoteCollection.indexOf(e),1),this.updateFootNoteIndex()},e.prototype.removeEndnote=function(e,t){var i=this.documentHelper.pages.length,r=this.documentHelper.pages[i-1].bodyWidgets[0];if(r.page.endnoteWidget){for(var n=r.page.endnoteWidget,o=0;o<n.bodyWidgets.length;o++)e===n.bodyWidgets[o].footNoteReference&&(n.height-=n.bodyWidgets[o].childWidgets[0].height,n.bodyWidgets.splice(o,1),this.isEndnoteElementRemoved=!0,o--);0===n.bodyWidgets.length&&(r.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(this.documentHelper.endnoteCollection.indexOf(e),1),this.updateEndNoteIndex()},e.prototype.removeAutoShape=function(e){var t=e.line.paragraph.floatingElements.indexOf(e),i=e.line.paragraph.bodyWidget.floatingElements.indexOf(e);i>-1&&e.line.paragraph.bodyWidget.floatingElements.splice(i,1),e.line.paragraph.floatingElements.splice(t,1)},e.prototype.removeField=function(e,t,i){var r=this.documentHelper.fields;if(t?r=this.documentHelper.bookmarks.keys:i&&(r=this.documentHelper.contentControlCollection),e.floatingElements.length>0)for(var n=0;n<e.floatingElements.length;n++){var o=e.floatingElements[n];this.removeAutoShape(o),n--}for(var s=0;s<r.length;s++){if((c=t?this.documentHelper.bookmarks.get(r[s]):r[s]).line.paragraph===e||c instanceof Na&&c.reference&&c.reference.line.paragraph===e){if(t){if(this.documentHelper.bookmarks.remove(r[s]),c.line.children.splice(c.indexInOwner,1),!sf.base.isNullOrUndefined(c.line.paragraph.associatedCell))(a=c.line.paragraph.associatedCell).isRenderBookmarkStart?a.isRenderBookmarkStart=!1:a.isRenderBookmarkEnd=!1;var a,l=c.reference;if(l&&l.line.children.splice(l.indexInOwner,1),l&&!sf.base.isNullOrUndefined(l.line.paragraph.associatedCell))(a=l.line.paragraph.associatedCell).isRenderBookmarkStart?a.isRenderBookmarkStart=!1:a.isRenderBookmarkEnd=!1}else i?this.documentHelper.contentControlCollection.splice(s,1):(this.documentHelper.fields.splice(s,1),-1!==this.documentHelper.formFields.indexOf(c)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(c),1));s--}}if(this.documentHelper.footnoteCollection.length>0)for(s=0;s<this.documentHelper.footnoteCollection.length;s++){if((c=this.documentHelper.footnoteCollection[s]).line.paragraph===e){if(c.paragraph.bodyWidget.page.footnoteWidget){for(var d=c.paragraph.bodyWidget.page.footnoteWidget,h=0;h<d.bodyWidgets.length;h++)c===d.bodyWidgets[h].footNoteReference&&(d.height-=d.bodyWidgets[h].height,d.bodyWidgets.splice(h,1),h--);0===d.bodyWidgets.length&&(c.paragraph.bodyWidget.page.footnoteWidget=void 0)}this.documentHelper.footnoteCollection.splice(s,1),s--}}if(this.documentHelper.endnoteCollection.length>0)for(s=0;s<this.documentHelper.endnoteCollection.length;s++){var c;if((c=this.documentHelper.endnoteCollection[s]).line.paragraph===e){if(c.paragraph.bodyWidget.page.endnoteWidget){var p=c.paragraph.bodyWidget.page.endnoteWidget;for(h=0;h<p.bodyWidgets.length;h++)c===p.bodyWidgets[h].footNoteReference&&(p.height-=p.bodyWidgets[h].height,p.bodyWidgets.splice(h,1),h--);0===p.bodyWidgets.length&&(c.paragraph.bodyWidget.page.endnoteWidget=void 0)}this.documentHelper.endnoteCollection.splice(s,1),s--}}},e.prototype.getTabsInSelection=function(){var e=[],t=this.owner.selection,i=[];if(0===t.selectedWidgets.keys.length)return t.start.paragraph.paragraphFormat.getUpdatedTabs();if(t.start.paragraph===t.end.paragraph)return t.start.paragraph.paragraphFormat.getUpdatedTabs();t.start.paragraph!==t.end.paragraph&&(i=this.owner.selection.getParagraphsInSelection());for(var r=i.length>0?i[0]:void 0,n=sf.base.isNullOrUndefined(r)?[]:r.paragraphFormat.getUpdatedTabs(),o=!0,s=0;s<n.length;s++)e.push(n[s]);for(var a=1;a<i.length;a++){var l=i[a].paragraphFormat.getUpdatedTabs(),d=[];o=!0;for(var h=0;h<e.length;h++){for(s=0;s<l.length;s++)if(l[s].equals(e[h])){o=!1;break}o&&d.push(e[h])}for(h=0;h<d.length;h++)e.splice(e.indexOf(d[h]),1)}return e},e.prototype.updateTabStopCollection=function(e,t,i){var r=e.paragraphFormat.tabs;if(i){e.paragraphFormat.tabs=[];for(var n=0;n<t.length;n++)e.paragraphFormat.tabs.push(t[n])}else for(n=0;n<t.length;n++){for(var o=x.getTabStopFromObject(t[n]),s=-1,a=0;a<r.length;a++){var l=r[a];if(o.position===l.position){s=a;break}if(o.position<l.position)break}s>=0?this.modifyTabStop(r[s],o):this.addTabStopToCollection(r,o)}},e.prototype.modifyTabStop=function(e,t){e.deletePosition=t.deletePosition,e.tabJustification=t.tabJustification,e.tabLeader=t.tabLeader},e.prototype.removeTabStops=function(e,t){for(var i=0;i<e.length;i++)for(var r=e[i].paragraphFormat.tabs,n=0;n<t.length;n++)for(var o=x.getTabStopFromObject(t[n]),s=0;s<r.length;s++)if(r[s].equals(o)){r.splice(s,1);break}},e.prototype.addTabStopToCollection=function(e,t,i){for(var r=-1,n=0;n<e.length;n++){if(e[n].position>t.position){r=n;break}}return r=-1===r?e.length:r,i||e.splice(r,0,x.getTabStopFromObject(t)),r},e.prototype.addRemovedNodes=function(e,t){e instanceof al&&0===e.commentType&&e.commentMark&&e.removeCommentMark(),e instanceof Oa&&0===e.type&&this.documentHelper.contentControlCollection.splice(this.documentHelper.contentControlCollection.indexOf(e),1),e instanceof va&&0===e.fieldType&&(-1!==this.documentHelper.fields.indexOf(e)&&this.documentHelper.fields.splice(this.documentHelper.fields.indexOf(e),1),-1!==this.documentHelper.formFields.indexOf(e)&&this.documentHelper.formFields.splice(this.documentHelper.formFields.indexOf(e),1)),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)?t?this.editorHistory.currentBaseHistoryInfo.removedNodes.splice(0,0,e):this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e):this.editHyperlinkInternal&&this.nodes.push(e)},e.prototype.deleteBlock=function(e,t,i,r,n){if(e instanceof ca){if(this.deletePara(e,i,r,n),this.delBlockContinue&&this.delBlock){if(this.delSection){var o=e.bodyWidget instanceof aa?e.bodyWidget:void 0;this.deleteSection(t,this.delSection,o,n),this.delSection=void 0}-1!==this.delBlock.indexInOwner&&this.deleteBlock(this.delBlock,t,i,r,n),this.delBlockContinue=!1,this.delBlock=void 0}}else this.deleteTableBlock(e,t,i,r,n),this.owner.enableTrackChanges&&!this.skipTracking()&&this.documentHelper.layout.reLayoutTable(e)},e.prototype.deleteTableCell=function(e,t,i,r,n,o){var s=!(i.paragraph.isInsideTable&&e.ownerTable.contains(i.paragraph.associatedCell)),a=e.ownerTable.previousRenderedWidget;if(i.paragraph.isInsideTable){var l=t.getContainerCellOf(e,i.paragraph.associatedCell);if(l.ownerTable.contains(i.paragraph.associatedCell)){var d=t.getSelectedCell(e,l);t.getSelectedCell(i.paragraph.associatedCell,l);if(t.containsCell(l,i.paragraph.associatedCell))if(t.isCellSelected(l,i,r))if(this.updateEditPosition(l,t),1===n||o)this.deleteCellsInTable(e.ownerRow.ownerTable,t,i,r,n);else{var h=this.deleteCell(l,t,n,!0);!h&&2!==n&&this.editorHistory?this.editorHistory.currentBaseHistoryInfo=void 0:h&&this.documentHelper.layout.reLayoutTable(l.ownerRow.ownerTable)}else if(d===l){if(this.deletePara(r.paragraph,i,r,n),this.delBlockContinue&&this.delBlock){if(this.delSection){var c=r.paragraph,p=c.bodyWidget instanceof aa?c.bodyWidget:void 0;this.deleteSection(t,this.delSection,p,n),this.delSection=void 0}this.deleteBlock(this.delBlock,t,i,r,n),this.delBlockContinue=!1,this.delBlock=void 0}}else this.deleteContainer(d,t,i,r,n);else 2===n?this.deleteCell(e,t,2,!1):this.deleteCellsInTable(l.ownerTable,t,i,r,n)}else this.deleteContainer(l,t,i,r,n)}else{var g=t.getContainerCell(e);sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing?this.deleteContainer(g,t,i,r,n):(this.deleteTableBlock(g.ownerTable,t,i,r,n),s=!1)}if(s){a.bodyWidget instanceof aa&&a.bodyWidget;sf.base.isNullOrUndefined(a)||this.deleteBlock(a,t,i,r,n)}},e.prototype.deleteCellsInTable=function(e,t,i,r,n,o){var s="Delete",a=!1,l=i.paragraph.associatedCell,d=r.paragraph.associatedCell;sf.base.isNullOrUndefined(o)||(d=o);var h=l.columnIndex,c=d.columnIndex+d.cellFormat.columnSpan-1,p=l.rowIndex,g=d.rowIndex,f=this.isWholeRowSelected(l.ownerRow,h,c);if(this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){if(s=this.editorHistory.currentBaseHistoryInfo.action,a="BackSpace"===this.editorHistory.currentBaseHistoryInfo.action||"DeleteCells"===this.editorHistory.currentBaseHistoryInfo.action||"InsertTable"===this.editorHistory.currentBaseHistoryInfo.action||"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action||sf.base.isNullOrUndefined(l.ownerRow.previousWidget)&&sf.base.isNullOrUndefined(d.ownerRow.nextWidget)&&"Cut"===this.editorHistory.currentBaseHistoryInfo.action,this.cloneTableToHistoryInfo(e),this.editorHistory.isRedoing&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)for(var u=0;u<e.childWidgets.length;u++){var m=e.childWidgets[u];m.index>=p&&m.index<=g&&f&&this.trackRowDeletion(m,!1)}if("RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)return;this.editorHistory.currentBaseHistoryInfo.action=a?"DeleteCells":"ClearCells",t.owner.isLayoutEnabled=!1}this.owner.enableTrackChanges&&!this.skipTracking()?f&&this.onConfirmedTableCellsDeletion(e,t,p,g,h,c,a,n,f,s):this.onConfirmedTableCellsDeletion(e,t,p,g,h,c,a,n,f,s)},e.prototype.removeDeletedCellRevision=function(e){e.rowFormat.revisions.length>0&&this.unlinkRangeFromRevision(e.rowFormat,!0);for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.childWidgets.length;r++){var n=i.childWidgets[r];if(!sf.base.isNullOrUndefined(n)&&n instanceof ca){for(var o=0;o<n.childWidgets.length;o++){var s=n.childWidgets[o];if(!sf.base.isNullOrUndefined(s.children))for(var a=0;a<s.children.length;a++){var l=s.children[a];l.revisions.length>0&&this.unlinkRangeFromRevision(l,!0)}}this.unlinkRangeFromRevision(n.characterFormat,!0)}}},e.prototype.onConfirmedTableCellsDeletion=function(e,t,i,r,n,o,s,a,l,d){for(var h=0;h<e.childWidgets.length;h++){var c=e.childWidgets[h],p=!1;if(c.index>=i&&c.index<=r&&(this.owner.enableTrackChanges&&!this.skipTracking()&&l?(p=this.trackRowDeletion(c,!1))&&this.onConfirmedCellDeletion(c,t,i,r,n,o,s,a):this.onConfirmedCellDeletion(c,t,i,r,n,o,s,a)),!p&&0===c.childWidgets.length){for(var g=e.childWidgets[h],f=g.previousRenderedWidget;!sf.base.isNullOrUndefined(f);){for(var u=0;u<f.childWidgets.length;u++){var m=f.childWidgets[u];g.rowIndex<m.ownerRow.rowIndex+m.cellFormat.rowSpan&&m.cellFormat.rowSpan--}f=f.previousRenderedWidget}this.updateNextBlocksIndex(g,!1),e.childWidgets.splice(h,1),h--,r--}}t.owner.isLayoutEnabled=!0,0===e.childWidgets.length?(t.editPosition=this.selection.getHierarchicalIndex(e,"0"),this.setActionInternal(t,d),this.removeBlock(e)):(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.layout.reLayoutTable(e))},e.prototype.onConfirmedCellDeletion=function(e,t,i,r,n,o,s,a){var l=!1;this.removeDeletedCellRevision(e);for(var d=0;d<e.childWidgets.length;d++){var h=e.childWidgets[d];if(h.columnIndex>=n&&h.columnIndex<=o)if(l||(this.updateEditPosition(h,t),l=!0),s){var c=e.childWidgets[d];this.updateNextBlocksIndex(c,!1);for(var p=0;p<c.childWidgets.length;p++)for(var g=c.childWidgets[p],f=0;f<g.childWidgets.length;f++){var u=g.childWidgets[f];if(u instanceof ma)for(var m=u,y=0;y<m.children.length;y++){var v=m.children[y];v instanceof Wa&&this.removeFootnote(v)}}e.childWidgets.splice(d,1),d--}else a<4&&this.deleteCell(h,t,a,!1)}},e.prototype.removeRevisionForRow=function(e){e.rowFormat.revisions.length>0&&this.skipTracking()&&(this.unlinkRangeFromRevision(e.rowFormat,!0),this.addRemovedRevisionInfo(e.rowFormat,void 0))},e.prototype.removeRevisionsInRow=function(e){if(e.rowFormat.revisions.length>0)for(var t=0;t<e.rowFormat.revisions.length;t++){var i=e.rowFormat.revisions[t];this.unlinkWholeRangeInRevision(e.rowFormat,i)}},e.prototype.removeRevisionForCell=function(e,t){for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i]instanceof ca)for(var r=e.childWidgets[i],n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],s=0;s<o.children.length;s++){var a=o.children[s];!sf.base.isNullOrUndefined(a)&&a.revisions.length>0&&(this.unlinkRangeFromRevision(a,t),this.addRemovedRevisionInfo(a,void 0))}else e.childWidgets[i]instanceof ga&&this.removeRevisionForInnerTable(e.childWidgets[i])},e.prototype.removeRevisionForInnerTable=function(e){if(e.childWidgets.length>0)for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t];sf.base.isNullOrUndefined(i)||this.removeRevisionForRow(i)}},e.prototype.removeRevisionForBlock=function(e,t,i,r){if(e.characterFormat.revisions.length>0&&!i&&(r&&this.addRemovedRevisionInfo(e.characterFormat,void 0,!1),sf.base.isNullOrUndefined(t)?this.unlinkRangeFromRevision(e.characterFormat,!0):this.unlinkRangeByRevision(e.characterFormat,t),e.characterFormat.revisions=[]),!sf.base.isNullOrUndefined(e))for(var n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.children.length;s++){var a=o.children[s];!sf.base.isNullOrUndefined(a)&&a.revisions.length>0&&(r&&this.addRemovedRevisionInfo(a,void 0,!1),sf.base.isNullOrUndefined(t)?this.unlinkRangeFromRevision(a,!0):this.unlinkRangeByRevision(a,t),a.revisions=[])}},e.prototype.unlinkRangeByRevision=function(e,t){for(var i=0;i<e.revisions.length;i++){var r=e.revisions[i];if(r.author===t.author&&r.revisionType===t.revisionType){e.revisions.splice(e.revisions.indexOf(t),1);var n=t.range.indexOf(e);t.range.splice(n,1),this.owner.trackChangesPane.updateCurrentTrackChanges(t)}}},e.prototype.isWholeRowSelected=function(e,t,i){var r=t+i;return 0===t&&e.childWidgets.length-1===r},e.prototype.deleteCell=function(e,t,i,r){var n=e.childWidgets[0];if(1===e.childWidgets.length&&n instanceof ca&&n.isEmpty())return!1;for(var o=e.childWidgets.length-1,s=e.childWidgets.length-1;s>-1;s--)if(n=e.childWidgets[s],i<4){if(n instanceof ca&&s===o){var a=n;if(this.checkClearCells(t))a.isEmpty()||this.removeInlines(a,a.firstChild,0,a.lastChild,a.lastChild.getEndOffset(),i);else for(var l=a.childWidgets.length-1;l>=0;l--){for(var d=a.childWidgets[l],h=d.children.length-1;h>=0;h--){var c=d.children[h];c instanceof Wa?this.removeFootnote(c):c instanceof Na&&0===c.bookmarkType&&this.documentHelper.bookmarks.containsKey(c.name)&&this.documentHelper.bookmarks.remove(c.name),this.unLinkFieldCharacter(c),d.children.splice(h,1)}a.childWidgets.length>1&&a.childWidgets.splice(l,1)}continue}this.removeBlock(n),this.checkClearCells(t)&&(this.addRemovedNodes(n),1===e.childWidgets.length&&(t.editPosition=this.selection.getHierarchicalIndex(e.childWidgets[0],"0"),this.updateHistoryPosition(t.editPosition,!0)))}return!0},e.prototype.paragrapghBookmarkCollection=function(e,t){for(var i=this.documentHelper.bookmarks,r=0;r<i.length;r++){var n=this.documentHelper.bookmarks.get(i.keys[r]);n.paragraph===e&&t.push(n)}return t},e.prototype.deleteContainer=function(e,t,i,r,n){var o=e.ownerTable;if(t.containsRow(o.lastChild,r.paragraph.associatedCell)&&!this.owner.enableTrackChanges)this.deleteContent(o,t,n);else if(this.toCheckForTrack(o)){this.cloneTableToHistoryInfo(o);for(var s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];if(this.trackRowDeletion(a),r.paragraph.isInsideTable&&t.containsRow(a,r.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(o)}}else for(s=0;s<o.childWidgets.length;s++){var l=o.childWidgets[s];if(n<4&&(this.updateNextBlocksIndex(l,!1),o.childWidgets.splice(s,1),this.addRemovedNodes(l),s--),r.paragraph.isInsideTable&&t.containsRow(l,r.paragraph.associatedCell))return void this.documentHelper.layout.reLayoutTable(o)}},e.prototype.deleteTableBlock=function(e,t,i,r,n){if(e=e.combineWidget(this.owner.viewer),i.paragraph.isInsideTable&&e.contains(i.paragraph.associatedCell)){var o=e.previousRenderedWidget,s=this.checkAndInsertBlock(e,i,r,n,o instanceof ca?o:void 0);if(t.containsRow(e.firstChild,i.paragraph.associatedCell))if(this.owner.enableTrackChanges){this.cloneTableToHistoryInfo(e);for(var a=0;a<e.childWidgets.length;a++)this.trackRowDeletion(e.childWidgets[a]);sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.removeBlock(e)}else this.deleteContent(e,t,n);else if(this.owner.enableTrackChanges){if(sf.base.isNullOrUndefined(r.paragraph.associatedCell)&&!r.paragraph.isInsideTable){var l=r.paragraph.previousRenderedWidget.lastChild.lastChild;this.deleteCellsInTable(e,t,i,r,n,l)}}else{var d=this.splitTable(e,i.paragraph.associatedCell.ownerRow);this.deleteContent(e,t,n),this.documentHelper.layout.layoutBodyWidgetCollection(d.index,d.containerWidget,d,!1)}sf.base.isNullOrUndefined(s)||(t.editPosition=this.selection.getHierarchicalIndex(s,"0"),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=t.editPosition))}else{var h=e.previousRenderedWidget;e.bodyWidget instanceof aa&&e.bodyWidget;if(this.owner.enableTrackChanges){this.cloneTableToHistoryInfo(e);for(a=0;a<e.childWidgets.length;a++)this.trackRowDeletion(e.childWidgets[a]);sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing||this.removeBlock(e)}else this.deleteContent(e,t,n);sf.base.isNullOrUndefined(h)||this.deleteBlock(h,t,i,r,n)}},e.prototype.splitTable=function(e,t){var i=new ga;i.tableFormat.copyFormat(e.tableFormat),i.index=e.index;for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];if(n===t)break;i.childWidgets.push(n),n.containerWidget=i,e.childWidgets.splice(r,1),r--}var o=e.getIndex();return e.containerWidget.childWidgets.splice(o,0,i),i.containerWidget=e.containerWidget,this.updateNextBlocksIndex(i,!0),i},e.prototype.updateEditPosition=function(e,t){var i=this.documentHelper.getFirstParagraphInCell(e);t.editPosition=this.selection.getHierarchicalIndex(i,"0")},e.prototype.deleteContent=function(e,t,i){i<4&&(this.removeBlock(e),this.addRemovedNodes(e))},e.prototype.setActionInternal=function(e,t){this.documentHelper.owner.enableHistoryMode&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.action=t)},e.prototype.checkClearCells=function(e){return this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"ClearCells"!==this.editorHistory.currentBaseHistoryInfo.action},e.prototype.isEndInAdjacentTable=function(e,t){var i=this.selection.getHierarchicalIndex(e,""),r=this.selection.getHierarchicalIndex(t,""),n=i.split(";"),o=r.split(";");return n.length<o.length},e.prototype.cloneTableToHistoryInfo=function(e){if(this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){var t=e.clone();return t.index=e.index,this.editorHistory.currentBaseHistoryInfo.removedNodes.push(t),this.documentHelper.selection.start.paragraph.isInsideTable&&this.documentHelper.selection.start.paragraph.associatedCell.ownerTable===e&&this.updateHistoryPosition(this.selection.getHierarchicalIndex(e,"0"),!0),t}},e.prototype.insertParagraphPaste=function(e,t,i,r,n,o,s,a){if(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var l=this.selection.getNextParagraphBlock(t);if(l&&i.offset>0&&l===r.paragraph&&e===i.paragraph&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var d=0;this.removeBlock(t),this.documentHelper.layout.clearListElementBox(l),this.documentHelper.layout.clearListElementBox(t);for(var h=0;h<t.childWidgets.length;h++){var c=t.childWidgets[h];l.childWidgets.splice(d,0,c),t.childWidgets.splice(h,1),h--,d++,c.paragraph=l}this.documentHelper.layout.reLayoutParagraph(l,0,0),n=!1;var p=this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(";")+1);this.selection.editPosition=this.selection.getHierarchicalIndex(l,p)}}n&&this.deleteParagraphMark(t,this.selection,o,!1,s,a)},e.prototype.removeInlines=function(e,t,i,r,n,o){var s=!1;this.documentHelper.layout.clearListElementBox(e);e.childWidgets.indexOf(t);for(var a=this.selection.start.clone(),l=this.selection.end.clone(),d=this.selection.editPosition,h=e.childWidgets.length-1;h>=0;h--){var c=e.childWidgets[h];if(t===c&&r===c){this.removeContent(c,i,n,o),s=!0;break}if(r===c)e.isLayouted=!1,s=!0,this.removeContent(c,0,n,o);else{if(t===c){this.removeContent(c,i,this.documentHelper.selection.getLineLength(c),o);break}s&&this.removeContent(c,0,this.documentHelper.selection.getLineLength(c),o)}}this.owner.enableTrackChanges&&!this.skipTracking()&&(this.selection.start.setPositionInternal(a),this.selection.end.setPositionInternal(l),this.skipReplace&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=void 0,this.updateInsertPosition()),this.selection.editPosition=d),s&&(e.isLayouted=!0,this.removeEmptyLine(e),this.documentHelper.layout.reLayoutParagraph(e,0,0))},e.prototype.skipTracking=function(){return!(sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing)||!(sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"Reject Change"!==this.editorHistory.currentBaseHistoryInfo.action&&"Accept Change"!==this.editorHistory.currentBaseHistoryInfo.action)},e.prototype.canHandleDeletion=function(){return!(sf.base.isNullOrUndefined(this.editorHistory)||!this.editorHistory.currentBaseHistoryInfo||"DeleteRow"!==this.editorHistory.currentBaseHistoryInfo.action)},e.prototype.removeContent=function(e,t,i,r,n){for(var o=this.selection.getLineLength(e),s=(e.paragraph.paragraphFormat.bidi,void 0),a=0,l=void 0,d=e.children.length-1;d>=0;d--){var h=e.children[d];if(sf.base.isNullOrUndefined(r)||2!==r&&1!==r)for(var c=0;c<e.children.length;c++){var p=e.children[c];if(p instanceof Fa){var g=p.text;g.length+a>t&&!(a>t)&&(s=g[t-a-1],sf.base.isNullOrUndefined(s)&&t-a==0&&(s=l)),g.length+a>i&&(" "===g[i-a]&&0===t||" "===s&&" "===g[i-a])&&(i+=1),l=g[g.length-1]}a+=p.length}if(i<=o-h.length)o-=h.length;else{var f=h.length;o>i&&o-f<i&&(f=i-(o-h.length));var u=0;if(o-h.length<t&&(u=t-(o-h.length)),o>i&&(o-=h.length-f),0===u&&f===h.length){if((!this.owner.enableTrackChanges||this.owner.enableTrackChanges&&this.skipTracking())&&(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||h instanceof Na&&this.removedBookmarkElements.push(h),h instanceof Na&&this.documentHelper.bookmarks.containsKey(h.name)&&this.documentHelper.bookmarks.remove(h.name)),h instanceof al&&0===h.commentType&&(h.comment.ownerComment?this.deleteCommentWidget(h.comment.ownerComment):this.deleteCommentWidget(h.comment)),(h instanceof Da&&"Inline"!==h.textWrappingStyle||h instanceof La)&&this.removeAutoShape(h),this.skipFieldDeleteTracking&&h.revisions.length>0){var m=h;m instanceof va&&(1!==m.fieldType&&2!==m.fieldType||(m=m.fieldBegin),this.clearFieldElementRevisions(m,h.revisions))}this.canHandleDeletion()||this.owner.enableTrackChanges&&(!this.skipTracking()||h.paragraph.isInsideTable&&!sf.base.isNullOrUndefined(this.editorHistory)&&this.editorHistory.isRedoing&&this.editorHistory.currentBaseHistoryInfo&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)&&!this.skipFieldDeleteTracking&&!this.isInsertingTOC?(this.skipTableElements||this.skipFootNoteDeleteTracking||n||this.addRemovedNodes(h.clone()),this.handleDeleteTracking(h,t,i,d)):(h instanceof Wa&&(h.isLayout=!1),this.unLinkFieldCharacter(h),this.unlinkRangeFromRevision(h,!0),this.addRemovedRevisionInfo(h,void 0),!sf.base.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action&&h.paragraph.isInsideTable||this.addRemovedNodes(h),h instanceof _a?this.removedEditRangeStartElements.push(h):h instanceof qa&&this.removedEditRangeEndElements.push(h),e.children.splice(d,1),!sf.base.isNullOrUndefined(e.layoutedElements)&&e.layoutedElements.length>0&&e.layoutedElements.splice(d,1))}else if(h instanceof Fa){var y=this.handleDeleteTracking(h,u,f);sf.base.isNullOrUndefined(y)||this.skipTableElements||(h.revisions.length>0&&this.addRemovedRevisionInfo(h,y),this.addRemovedNodes(y))}if((!this.owner.enableTrackChanges||this.editorHistory.isUndoing)&&h instanceof Wa&&("Footnote"===h.footnoteType?this.removeFootnote(h):this.removeEndnote(h)),t>=o-(f-u))break;o-=f-u,this.documentHelper.layout.clearListElementBox(e.paragraph)}}},e.prototype.skipCommentCharacter=function(e){var t=this.editorHistory.currentBaseHistoryInfo,i=t.insertPosition,r=t.selectionStart,n=t.selectionEnd;if(!this.editorHistory.currentBaseHistoryInfo||this.editorHistory.currentHistoryInfo||this.editorHistory.isUndoing||this.editorHistory.isRedoing||(this.initComplexHistory("SkipCommentInline"),this.editorHistory.updateHistory(),this.initHistory(t.action)),this.editorHistory.currentHistoryInfo&&"DeleteComment"!==this.editorHistory.currentHistoryInfo.action&&!this.editorHistory.isUndoing&&!this.editorHistory.isRedoing){var o=e.line.getOffset(e,1),s=new Al(this.owner);s.setPositionParagraph(e.line,o);var a=this.selection.getHierarchicalIndexByPosition(s);this.selection.isForward?(this.editorHistory.currentBaseHistoryInfo.selectionEnd=a,t.selectionStart=a,this.editorHistory.currentHistoryInfo.selectionEnd=t.selectionEnd):(this.editorHistory.currentBaseHistoryInfo.selectionStart=a,t.selectionEnd=a,this.editorHistory.currentHistoryInfo.selectionStart=t.selectionStart),t.insertPosition=this.selection.isForward?t.selectionStart:t.selectionEnd,t.endPosition=t.insertPosition,this.editorHistory.currentHistoryInfo.insertPosition=t.insertPosition;var l=this.editorHistory.currentBaseHistoryInfo;l.insertPosition=this.selection.isForward?l.selectionStart:l.selectionEnd,l.endPosition=l.insertPosition,this.editorHistory.currentHistoryInfo.addModifiedAction(l),this.editorHistory.currentBaseHistoryInfo.insertPosition=i,this.editorHistory.currentBaseHistoryInfo.selectionStart=r,this.editorHistory.currentBaseHistoryInfo.selectionEnd=n}},e.prototype.clearFieldElementRevisions=function(e,t){for(var i=t,r=0;r<i.length;r++)for(var n=i[r],o=0;o<n.range.length;o++)if(n.range[o]===e)for(var s=o;s<n.range.length;s){if(n.range[o]instanceof va&&1===n.range[o].fieldType&&n.range[o].fieldBegin===e){n.removeRangeRevisionForItem(n.range[o]),0===n.range.length&&this.owner.revisions.remove(n);break}n.removeRangeRevisionForItem(n.range[o])}},e.prototype.addRemovedRevisionInfo=function(e,t,i){for(var r=0;r<e.revisions.length;r++){var n=e.revisions[r].revisionID;sf.base.isNullOrUndefined(t)?e.removedIds.push(n):t.removedIds.push(n)}sf.base.isNullOrUndefined(t)&&(sf.base.isNullOrUndefined(i)||i)&&(e.revisions=[])},e.prototype.removeEmptyLine=function(e){if(e.childWidgets.length>1)for(var t=0;t<e.childWidgets.length;t++){0===e.childWidgets[t].children.length&&e.childWidgets.length>1&&(e.childWidgets.splice(t,1),t--)}},e.prototype.cloneListLevel=function(e){var t=new H(void 0);return this.copyListLevel(t,e),t},e.prototype.copyListLevel=function(e,t){sf.base.isNullOrUndefined(t.paragraphFormat)||(e.paragraphFormat=new ul(e),e.paragraphFormat.copyFormat(t.paragraphFormat)),sf.base.isNullOrUndefined(t.characterFormat)||(e.characterFormat=new T(e),e.characterFormat.copyFormat(t.characterFormat)),sf.base.isNullOrUndefined(t.followCharacter)||(e.followCharacter=t.followCharacter),sf.base.isNullOrUndefined(t.listLevelPattern)||(e.listLevelPattern=t.listLevelPattern),sf.base.isNullOrUndefined(t.numberFormat)||(e.numberFormat=t.numberFormat),sf.base.isNullOrUndefined(t.restartLevel)||(e.restartLevel=t.restartLevel),sf.base.isNullOrUndefined(t.startAt)||(e.startAt=t.startAt)},e.prototype.cloneLevelOverride=function(e){var t=new f;return sf.base.isNullOrUndefined(e.startAt)||(t.startAt=e.startAt),sf.base.isNullOrUndefined(e.overrideListLevel)||(t.overrideListLevel=e.overrideListLevel),sf.base.isNullOrUndefined(e.levelNumber)||(t.levelNumber=e.levelNumber),t},e.prototype.updateListParagraphs=function(){this.documentHelper.listParagraphs=[];for(var e=0;e<this.documentHelper.pages.length;e++)for(var t=this.documentHelper.pages[e].bodyWidgets[0],i=0;i<t.childWidgets.length;i++)this.updateListParagraphsInBlock(t.childWidgets[i])},e.prototype.updateListParagraphsInBlock=function(e){if(e instanceof ca)sf.base.isNullOrUndefined(e.paragraphFormat)||sf.base.isNullOrUndefined(e.paragraphFormat.listFormat)||sf.base.isNullOrUndefined(e.paragraphFormat.listFormat.listId)||(e.paragraphFormat.listFormat.listId>=0&&e.paragraphFormat.clearIndent(),sf.base.isNullOrUndefined(this.documentHelper.listParagraphs)&&(this.documentHelper.listParagraphs=[]),this.documentHelper.listParagraphs.push(e));else if(e instanceof ga)for(var t=0;t<e.childWidgets.length;t++)for(var i=0;i<e.childWidgets[t].childWidgets.length;i++)for(var r=e.childWidgets[t].childWidgets[i],n=0;n<r.childWidgets.length;n++)this.updateListParagraphsInBlock(r.childWidgets[n])},e.prototype.onApplyList=function(e){var t=this.documentHelper.selection;this.setOffsetValue(this.documentHelper.selection),this.initHistory("ListFormat");var i=new m;sf.base.isNullOrUndefined(e)||(i.listId=e.listId),this.documentHelper.owner.isShiftingEnabled=!0,t.isEmpty?(this.applyParaFormatProperty(t.start.paragraph,"listFormat",i,!1),this.layoutItemBlock(t.start.paragraph,!1)):this.updateSelectionParagraphFormatting("listFormat",i,!1),this.documentHelper.owner.isShiftingEnabled=!0,this.layoutWholeDocument(),this.documentHelper.owner.isShiftingEnabled=!1,this.startParagraph=void 0,this.endParagraph=void 0},e.prototype.applyBulletOrNumbering=function(e,t,i){var r=this.documentHelper.selection,n=r.paragraphFormat.getList(),o=!1,s=r.start;r.isForward||(s=r.end);var a=s.paragraph;if(sf.base.isNullOrUndefined(n)){for(;!sf.base.isNullOrUndefined(a.previousWidget)&&a.previousWidget instanceof ca&&a.previousWidget.isEmpty()&&-1===a.previousWidget.paragraphFormat.listFormat.listId;)a=a.previousWidget;if(a.previousWidget&&a.previousWidget instanceof ca&&-1!==a.previousWidget.paragraphFormat.listFormat.listId&&(a=a.previousWidget,n=this.documentHelper.getListById(a.paragraphFormat.listFormat.listId),o=!0),!o){for(;!sf.base.isNullOrUndefined(a.nextWidget)&&a.nextWidget instanceof ca&&a.nextWidget.isEmpty()&&-1===a.nextWidget.paragraphFormat.listFormat.listId;)a=a.nextWidget;if(a.nextWidget&&a.nextWidget instanceof ca&&-1!==a.nextWidget.paragraphFormat.listFormat.listId){for(var l=!1;!sf.base.isNullOrUndefined(a.previousWidget)&&a.previousWidget instanceof ca&&-1!==a.previousWidget.paragraphFormat.listFormat.listId&&s.paragraph.paragraphFormat.firstLineIndent<Math.abs(a.previousWidget.paragraphFormat.firstLineIndent);)a=a.previousWidget,l=!0;l||(a=a.previousWidget),n=this.documentHelper.getListById(a.paragraphFormat.listFormat.listId),o=!0}}}var d=void 0,h=-1,c=void 0,p=!1;if(-1===a.paragraphFormat.listFormat.listId||sf.base.isNullOrUndefined(a.paragraphFormat.listFormat.listLevel)||(this.listNumberFormat=a.paragraphFormat.listFormat.listLevel.numberFormat,this.listLevelPattern=a.paragraphFormat.listFormat.listLevel.listLevelPattern,this.listLevelNumber=a.paragraphFormat.listFormat.listLevelNumber),!sf.base.isNullOrUndefined(n)){h=a.paragraphFormat.listFormat.listLevelNumber;var g=this.documentHelper.getListById(a.paragraphFormat.listFormat.listId);if(d=this.documentHelper.layout.getListLevel(g,h),h>0&&(c=this.documentHelper.layout.getListLevel(g,0),p=!sf.base.isNullOrUndefined(c)&&h>0&&r.start.isInSameListParagraph(r.end)),(f=g.abstractList)||(f=this.documentHelper.getAbstractListById(n.abstractListId)),0===f.levels.length&&(d=this.documentHelper.layout.getListLevel(g,a.paragraphFormat.listFormat.listLevelNumber)),o){if("Bullet"!==t&&d.listLevelPattern===t&&(d.numberFormat===e||-1!==d.numberFormat.indexOf(e)))return r.paragraphFormat.listId=n.listId,r.paragraphFormat.listLevelNumber=h,void r.paragraphFormat.setList(n);d=f.levels[0]}}if(sf.base.isNullOrUndefined(n)||!sf.base.isNullOrUndefined(n)&&0===h&&(d.listLevelPattern!==t||d.numberFormat!==e||d.characterFormat.fontFamily!==i&&"Bullet"===d.listLevelPattern)){o=!1,n=new u,this.documentHelper.lists.length>0?n.listId=this.documentHelper.lists[this.documentHelper.lists.length-1].listId+1:n.listId=0;var f=new W;if(this.documentHelper.abstractLists.length>0?f.abstractListId=this.documentHelper.abstractLists[this.documentHelper.abstractLists.length-1].abstractListId+1:f.abstractListId=0,n.abstractListId=f.abstractListId,n.abstractList=f,this.documentHelper.abstractLists.push(f),"bullet"===e||"multiLevel"===e||"numbering"===e)this.addListLevels(f,e,r);else(m=new H(f)).listLevelPattern=t,m.numberFormat=e,"Bullet"!==t?m.startAt=1:m.characterFormat.fontFamily=i,m.paragraphFormat.leftIndent=36,m.paragraphFormat.firstLineIndent=-18,f.levels.push(m),r.paragraphFormat.listLevelNumber=0;r.paragraphFormat.setList(n)}else if(!p||sf.base.isNullOrUndefined(n)||o)!sf.base.isNullOrUndefined(n)&&o?r.paragraphFormat.setList(n):r.paragraphFormat.setList(void 0);else{g=this.documentHelper.getListById(a.paragraphFormat.listFormat.listId);var m=this.documentHelper.layout.getListLevel(g,h);if("Bullet"===t)m.numberFormat=e,m.characterFormat.fontFamily=i;else{m.listLevelPattern=t,m.characterFormat.fontFamily=i;var y=m.numberFormat.substring(m.numberFormat.length-1);m.numberFormat.length!==e.length&&h>0?m.numberFormat=e:e.substring(e.length-1)!==m.numberFormat.substring(m.numberFormat.length-1)&&(m.numberFormat=m.numberFormat.replace(y,e.substring(e.length-1)))}r.paragraphFormat.setList(g)}},e.prototype.addListLevels=function(e,t,i){for(var r=[String.fromCharCode(61558),String.fromCharCode(61656),String.fromCharCode(61607),String.fromCharCode(61623),String.fromCharCode(61608)],n=e.levels.length;n<9;n++){var o=new H(e);if(t.match("bullet"))o.listLevelPattern="Bullet",o.numberFormat=r[n<5?n%5:n%5+1],o.characterFormat.fontFamily=n<3||5===n?"Wingdings":"Symbol";else{if(t.match("multiLevel")){for(var s=0;s<n+1;s++)o.numberFormat+="%"+(s+1).toString()+".";o.listLevelPattern="Number"}else o.numberFormat="%"+(n+1).toString()+")",o.listLevelPattern=n%3==0?"Number":n%3==1?"LowLetter":"LowRoman";o.startAt=1,o.restartLevel=n}o.paragraphFormat.leftIndent=0===n?36:36*n,o.paragraphFormat.firstLineIndent=-18,e.levels.push(o),i.paragraphFormat.listLevelNumber=n}},e.prototype.insertPageBreak=function(){if(!this.owner.isReadOnlyMode){if(this.documentHelper.selection.start.paragraph.isInsideTable||this.documentHelper.selection.start.paragraph.isInHeaderFooter)return;this.initComplexHistory("PageBreak"),this.onEnter("PageBreak"),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.owner.enableAutoFocus&&this.selection.checkForCursorVisibility()}},e.prototype.insertColumnBreak=function(){if(!this.owner.isReadOnlyMode){if(this.documentHelper.selection.start.paragraph.isInsideTable||this.documentHelper.selection.start.paragraph.isInHeaderFooter)return;this.initComplexHistory("ColumnBreak");var e=this.documentHelper.selection.start.paragraph;if(this.viewer instanceof Qs&&e.bodyWidget.sectionFormat.columns.length>1){var t=this.documentHelper.layout.getBodyWidget(e.bodyWidget,!1);sf.base.isNullOrUndefined(t.nextRenderedWidget)||t.page!==t.nextRenderedWidget.page||this.documentHelper.layout.combineMultiColumn(t)}this.onEnter("ColumnBreak"),this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.selection.checkForCursorVisibility()}},e.prototype.onEnter=function(e){this.handledEnter=!0;var t,i=this.documentHelper.selection;(sf.base.isNullOrUndefined(i.start.paragraph.paragraphFormat.baseStyle)||"Normal"===i.start.paragraph.paragraphFormat.baseStyle.name||"Normal (Web)"===i.start.paragraph.paragraphFormat.baseStyle.name)&&((t=new kl(void 0)).cloneFormat(this.selection.characterFormat),i.start.paragraph.lastChild.children[i.start.paragraph.lastChild.children.length-1]instanceof Wa&&(t.baselineAlignment="Normal"));if(!this.isXmlMapped){if(i.isEmpty){var r=i.getHyperlinkField();if(!sf.base.isNullOrUndefined(r))return void i.fireRequestNavigate(r);if((m=i.start.paragraph).isEmpty()&&-1!==m.paragraphFormat.listFormat.listId)return void this.onApplyListInternal(this.documentHelper.getListById(m.paragraphFormat.listFormat.listId),m.paragraphFormat.listFormat.listLevelNumber-1)}this.initHistory("Enter");var n=!0;if(i.isEmpty||i.isImageSelected||(n=this.removeSelectedContents(i)),n){if(i.isImageSelected&&!i.isForward){var o=i.start;i.start=i.end,i.end=o}i.owner.isShiftingEnabled=!0,this.updateInsertPosition();var s=this.selection.getParagraphInfo(i.start),a=this.selection.getHierarchicalIndex(s.paragraph,s.offset.toString());if(this.splitParagraphInternal(i,i.start.paragraph,i.start.currentWidget,i.start.offset),this.setPositionForCurrentIndex(i.start,a),!sf.base.isNullOrUndefined(e)&&("PageBreak"===e||"ColumnBreak"===e)){var l=i.start.paragraph,d=new ca;d.characterFormat.copyFormat(l.characterFormat),d.paragraphFormat.copyFormat(l.paragraphFormat);var h=new Fa;switch(e){case"PageBreak":h.text="\f";break;case"ColumnBreak":h.text=String.fromCharCode(14)}var c=new ma(d);if(c.children.push(h),h.line=c,d.childWidgets.push(c),this.owner.enableTrackChanges&&l.characterFormat.revisions.length>0){var p=this.retrieveRevisionInOder(l.characterFormat);p.range.push(d.characterFormat),d.characterFormat.revisions.push(p),this.owner.trackChangesPane.updateCurrentTrackChanges(p),d.characterFormat.removedIds=[]}this.insertParagraph(d,!0),i.selectParagraphInternal(d,!0)}var g=i.start.paragraph.nextWidget;sf.base.isNullOrUndefined(g)&&(g=i.getNextRenderedBlock(i.start.paragraph)),i.selectParagraphInternal(g,!0),this.updateEndPosition(),!sf.base.isNullOrUndefined(e)&&this.editorHistory&&this.owner.editorHistory.updateHistory(),this.reLayout(i);var f=this.selection.start.paragraph.containerWidget.firstChild;if(!sf.base.isNullOrUndefined(f)){f.isChangeDetected=!1;for(var u=f.nextRenderedWidget;this.owner.isSpellCheck&&!sf.base.isNullOrUndefined(u);)(f=u).isChangeDetected=!1,u=f.nextRenderedWidget}var m=i.start.paragraph.previousWidget;!sf.base.isNullOrUndefined(m)&&!m.isEmpty()&&m.lastChild.children[m.lastChild.children.length-1]instanceof Fa&&this.checkAndConvertToHyperlink(i,!0,m)}sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(i.start.paragraph)||!i.start.paragraph.isEmpty()||(this.selection.isRetrieveFormatting=!0,this.selection.characterFormat.cloneFormat(t),this.selection.isRetrieveFormatting=!1),this.documentHelper.layout.islayoutFootnote=!1,this.handledEnter=!1}},e.prototype.splitParagraphInternal=function(e,t,i,r){var n=0,o=t.index,s=t,a=!1;for(s.isChangeDetected=0===r;this.owner.isSpellCheck&&!sf.base.isNullOrUndefined(s.nextRenderedWidget);)(s=s.nextRenderedWidget).isChangeDetected=!0;var l=new ca,d=new ma(l);if(l.childWidgets.push(d),l.paragraphFormat.ownerBase=l,i!==t.lastChild||r!==e.getLineLength(i)||t.isContainsShapeAlone()){if(l.paragraphFormat.copyFormat(t.paragraphFormat),l.characterFormat.copyFormat(t.characterFormat),!(r>0)&&i.isFirstLine()||t.isContainsShapeAlone()){var h=t.previousRenderedWidget,c=!1;if(!sf.base.isNullOrUndefined(h)&&h instanceof ca&&(c=h.characterFormat.revisions.length>0),this.owner.enableTrackChanges)if(c)this.checkToMatchEmptyParaMark(t,l)||this.insertParaRevision(t);else{var p=t.firstChild.children[0].previousValidNodeForTracking;sf.base.isNullOrUndefined(p)||this.checkParaMarkMatchedWithElement(p,l.characterFormat,!0,"Insertion")?sf.base.isNullOrUndefined(p)&&(n++,o++):this.insertParaRevision(l)}}else t=t.combineWidget(this.owner.viewer),this.moveInlines(t,l,0,0,t.firstChild,r,i),this.owner.enableTrackChanges&&this.insertParaRevision(l,t.firstChild);t=t.getSplitWidgets()[0]}else{if(t.paragraphFormat.baseStyle&&"Normal"!==t.paragraphFormat.baseStyle.name&&t.paragraphFormat.baseStyle.next instanceof vl?(t.paragraphFormat.baseStyle.name===t.paragraphFormat.baseStyle.next.name?(l.paragraphFormat.copyFormat(t.paragraphFormat),l.characterFormat.copyFormat(t.characterFormat)):l.paragraphFormat.baseStyle=t.paragraphFormat.baseStyle.next,this.selection.skipFormatRetrieval=!1):(l.paragraphFormat.copyFormat(t.paragraphFormat),l.characterFormat.copyFormat(t.characterFormat)),t.lastChild.children.length>0&&t.characterFormat.copyFormat(t.lastChild.children[t.lastChild.children.length-1].characterFormat),this.handledEnter&&this.selection.isEmpty&&this.selection.start.isAtParagraphEnd&&t.characterFormat.revisions.length>0&&(a=!0),this.owner.enableTrackChanges){var g=t.lastChild;if(!sf.base.isNullOrUndefined(g)&&g.children.length>0){var f=g.children[g.children.length-1].previousValidNodeForTracking;0!==f.revisions.length&&(a=!1),sf.base.isNullOrUndefined(f)||this.checkParaMarkMatchedWithElement(f,t.characterFormat,!1,"Insertion")||(a?this.insertParaRevision(l):this.insertParaRevision(t))}}n++,o++}n+=t.getIndex();var u=t.containerWidget;if(u.childWidgets.splice(n,0,l),l.containerWidget=u,l.index=o,this.updateNextBlocksIndex(l,!0),!sf.base.isNullOrUndefined(u.containerWidget)&&u.containerWidget instanceof ha||u instanceof ua&&!sf.base.isNullOrUndefined(u.bodyWidget)&&u.bodyWidget.containerWidget instanceof ha){var m=this.documentHelper.textHelper.getParagraphMarkSize(l.characterFormat).Height;u instanceof ua?(u.bodyWidget.height+=m,u.bodyWidget.containerWidget.height+=m):(u.containerWidget.height+=m,u.height+=m)}if(this.owner.enableTrackChanges&&0===l.characterFormat.revisions.length){var y=void 0;0===t.characterFormat.revisions.length?y=t:a&&(y=l),sf.base.isNullOrUndefined(y)||this.checkToMatchEmptyParaMark(y)||this.insertParaRevision(y)}this.documentHelper.layout.layoutBodyWidgetCollection(o,u,l,!1)},e.prototype.insertParaRevision=function(e,t){if(this.owner.enableTrackChanges&&sf.base.isNullOrUndefined(t)&&!this.isRevisionMatched(e.characterFormat,"Insertion")&&(e.characterFormat.revisions=[],this.insertRevision(e.characterFormat,"Insertion")),!sf.base.isNullOrUndefined(t)){if(t.paragraph.isInsideTable)return void this.insertRevision(e.characterFormat,"Insertion");this.applyRevisionForParaMark(e,t,"Insertion",!0)}},e.prototype.applyRevisionForParaMark=function(e,t,i,r){var n=t.children[0];if(!sf.base.isNullOrUndefined(n)){n=n.nextValidNodeForTracking;var o=e.lastChild,s=0===o.children.length?void 0:o.children[o.children.length-1].previousValidNodeForTracking,a=!1,l=e.characterFormat.revisions.length;if(sf.base.isNullOrUndefined(s)||(a=this.checkParaMarkMatchedWithElement(s,e.characterFormat,!1,i)),!sf.base.isNullOrUndefined(n))if(e.characterFormat.revisions.length>l){if(this.isRevisionMatched(n,i))for(var d=e.characterFormat.revisions[0],h=this.getMatchedRevisionsToCombine(n.revisions,i),c=0;c<h.length;c++)h[c]!==d&&(a=!0,this.clearAndUpdateRevisons(h[c].range,d,d.range.indexOf(e.characterFormat)+1))}else a=this.checkParaMarkMatchedWithElement(n,e.characterFormat,!0,i);!a&&(this.owner.enableTrackChanges||t.paragraph.characterFormat.revisions.length>0)&&(this.insertRevision(e.characterFormat,i),r&&s.revisions.length>0&&n.revisions.length>0&&this.updateRevisionForSpittedTextElement(s,n))}},e.prototype.checkParaMarkMatchedWithElement=function(e,t,i,r){var n=this.getMatchedRevisionsToCombine(e.revisions,r);return n.length>0&&(this.mapMatchedRevisions(n,e,t,i),!0)},e.prototype.checkToMatchEmptyParaMark=function(e,t){var i=e.previousRenderedWidget;if(!sf.base.isNullOrUndefined(i)&&i instanceof ca&&i.characterFormat.revisions.length>0){var r=this.getMatchedRevisionsToCombine(i.characterFormat.revisions,"Insertion");if(r.length>0)return sf.base.isNullOrUndefined(t)?this.mapMatchedRevisions(r,i.characterFormat,e.characterFormat,!1):this.mapMatchedRevisions(r,i.characterFormat,t.characterFormat,!1),!0}return!1},e.prototype.checkToMatchEmptyParaMarkBack=function(e){var t=e.nextRenderedWidget,i=t.childWidgets[0],r=i.children[0];if(!sf.base.isNullOrUndefined(t)&&t instanceof ca&&t.characterFormat.revisions.length>0){if((n=this.getMatchedRevisionsToCombine(t.characterFormat.revisions,"Deletion")).length>0)return null!=t&&null!=i&&null!=r&&1==r.revisions.length?(this.mapMatchedRevisions(n,r,e.characterFormat,!0),!0):(this.mapMatchedRevisions(n,t.characterFormat,e.characterFormat,!0),!0)}else if(null!=r&&1==r.revisions.length){var n;if((n=this.getMatchedRevisionsToCombine(r.revisions,"Deletion")).length>0)return this.mapMatchedRevisions(n,r,e.characterFormat,!0),!0}return!1},e.prototype.updateNextBlocksIndex=function(e,t){if(!(sf.base.isNullOrUndefined(e.nextRenderedWidget)||e.nextRenderedWidget instanceof ca&&e.bodyWidget.index!==e.nextRenderedWidget.bodyWidget.index)){var i=e.containerWidget.childWidgets.indexOf(e)+1;if(e.containerWidget instanceof aa&&!(e.containerWidget.containerWidget instanceof ha))if(e.containerWidget.page.bodyWidgets.length>1&&e.containerWidget.sectionFormat.numberOfColumns>1)for(var r=e.containerWidget.indexInOwner,n=this.documentHelper.pages.indexOf(e.containerWidget.page);n<this.documentHelper.pages.length;n++){for(var o=this.documentHelper.pages[n],s=0;s<o.bodyWidgets.length;s++)if(o.bodyWidgets[s].indexInOwner===r){for(var a=i;a<o.bodyWidgets[s].childWidgets.length;a++){var l=o.bodyWidgets[s].childWidgets[a];this.updateIndex(l,t)}i=0,sf.base.isNullOrUndefined(o.bodyWidgets[s].nextRenderedWidget)||o.bodyWidgets[s].nextRenderedWidget.sectionIndex!==o.bodyWidgets[s].sectionIndex||r++}r!==e.containerWidget.indexInOwner&&!sf.base.isNullOrUndefined(o.bodyWidgets[o.bodyWidgets.length-1].nextRenderedWidget)&&o.bodyWidgets[o.bodyWidgets.length-1].nextRenderedWidget.sectionFormat.columns.length>1&&(r=0)}else if(e.containerWidget.page.bodyWidgets.length>1){var d=e.containerWidget.index;for(n=this.documentHelper.pages.indexOf(e.containerWidget.page);n<this.documentHelper.pages.length;n++)for(o=this.documentHelper.pages[n],s=0;s<o.bodyWidgets.length;s++)if(o.bodyWidgets[s].index===d){for(a=i;a<o.bodyWidgets[s].childWidgets.length;a++){l=o.bodyWidgets[s].childWidgets[a];this.updateIndex(l,t)}i=0}}else for(d=e.containerWidget.index,s=this.documentHelper.pages.indexOf(e.containerWidget.page);s<this.documentHelper.pages.length;s++){if((o=this.documentHelper.pages[s]).bodyWidgets[0].index!==d)return;for(a=i;a<o.bodyWidgets[0].childWidgets.length;a++){l=o.bodyWidgets[0].childWidgets[a];this.updateIndex(l,t)}i=0}else if(e.containerWidget instanceof ua)for(var h=e.containerWidget.getSplitWidgets(),c=h.indexOf(e.containerWidget),p=c;p<h.length;p++){for(var g=h[p].childWidgets,f=i;f<g.length;f++)this.updateIndex(g[f],t);c=0,i=0}else if(e.containerWidget instanceof fa)for(n=i;n<e.containerWidget.childWidgets.length;n++){var u=e.containerWidget.childWidgets[n];u.rowIndex===e.containerWidget.index&&this.updateIndex(u,t)}else if(e.containerWidget instanceof ga)for(n=i;n<e.containerWidget.childWidgets.length;n++){var m=e.containerWidget.childWidgets[n];this.updateIndex(m,t);for(s=0;s<m.childWidgets.length;s++)m.childWidgets[s].rowIndex=m.index}else if(e.containerWidget instanceof la||e.containerWidget instanceof Aa||!sf.base.isNullOrUndefined(e.containerWidget)&&e.containerWidget.containerWidget instanceof ha)for(n=i;n<e.containerWidget.childWidgets.length;n++){var y=e.containerWidget.childWidgets[n];this.updateIndex(y,t)}}},e.prototype.updateIndex=function(e,t){t?e.index++:e.index--},e.prototype.updateEndPosition=function(){var e=this.documentHelper.selection;this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.updateHistoryPosition(e.start,!1)},e.prototype.onBackSpace=function(){this.removeEditRange=!0;var e=this.documentHelper.selection;if(this.documentHelper.triggerSpellCheck=!0,e.bookmarks.length>0&&this.extendSelectionToBookmarkStart(),e.isEmpty)this.singleBackspace(e,!1);else{this.initHistory("BackSpace");var t=this.deleteSelectedContents(e,!0);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(t?this.editorHistory.currentBaseHistoryInfo=void 0:(this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e),this.insertSpaceInFormField()),this.editorHistory.updateComplexHistory()),this.owner.isSpellCheck&&(this.documentHelper.triggerSpellCheck=!1)}this.documentHelper.layout.islayoutFootnote=!1,this.removeEditRange=!1,this.updateXmlMappedContentControl()},e.prototype.insertRemoveBookMarkElements=function(e){for(var t=!1,i=0;i<this.removedBookmarkElements.length;i++){var r=this.removedBookmarkElements[i];if(0===r.bookmarkType){this.documentHelper.bookmarks.containsKey(r.name)||this.documentHelper.bookmarks.add(r.name,r);var n=r;if(n&&n.reference&&-1!==this.removedBookmarkElements.indexOf(n.reference)){var o=this.removedBookmarkElements.indexOf(n.reference),s=this.removedBookmarkElements.indexOf(n);this.removedBookmarkElements.splice(o,1),this.removedBookmarkElements.splice(s,1),i--}else this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(n.clone(),void 0,!0),this.editorHistory.currentHistoryInfo&&i===this.removedBookmarkElements.length-1&&0===this.removedEditRangeStartElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}else{var a=r;if(a&&a.reference&&-1!==this.removedBookmarkElements.indexOf(a.reference)){o=this.removedBookmarkElements.indexOf(a.reference),s=this.removedBookmarkElements.indexOf(a);this.removedBookmarkElements.splice(o,1),this.removedBookmarkElements.splice(s,1),i--}else this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(a.clone(),void 0,!0),this.editorHistory.currentHistoryInfo&&i===this.removedBookmarkElements.length-1&&0===this.removedEditRangeStartElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}}return this.removedBookmarkElements=[],t},e.prototype.insertRemovedEditRangeEndElements=function(e){for(var t=!1,i=this.removedEditRangeEndElements.length-1;i>=0;i--){var r=this.removedEditRangeEndElements[i];if(r&&-1!==this.removedEditRangeStartElements.indexOf(r.editRangeStart)){var n=this.removedEditRangeEndElements.indexOf(r),o=this.removedEditRangeStartElements.indexOf(r.editRangeStart);this.removedEditRangeEndElements.splice(n,1),this.removedEditRangeStartElements.splice(o,1),i--}else{this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(r.clone(),void 0,!0);var s=this.selection.start.paragraph.getInline(this.selection.start.offset,0);s.element.editRangeStart.editRangeEnd=s.element,this.editorHistory.currentHistoryInfo&&0===i&&0===this.removedEditRangeStartElements.length&&0===this.removedBookmarkElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}}return this.removedEditRangeEndElements=[],t},e.prototype.insertRemovedEditRangeStartElements=function(e){for(var t=!1,i=0;i<this.removedEditRangeStartElements.length;i++){var r=this.removedEditRangeStartElements[i];if(r&&-1!==this.removedEditRangeEndElements.indexOf(r.editRangeEnd)){var n=this.removedEditRangeEndElements.indexOf(r.editRangeEnd),o=this.removedEditRangeStartElements.indexOf(r);this.removedEditRangeEndElements.splice(n,1),this.removedEditRangeStartElements.splice(o,1),i--}else{this.editorHistory.currentBaseHistoryInfo&&!e&&(this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory()),this.initInsertInline(r.clone(),void 0,!0);var s=this.selection.start.paragraph.getInline(this.selection.start.offset,0);s.element.editRangeEnd.editRangeStart=s.element,this.editorHistory.currentHistoryInfo&&i===this.removedEditRangeStartElements.length-1&&0===this.removedBookmarkElements.length&&0===this.removedEditRangeEndElements.length&&(this.editorHistory.updateComplexHistory(),t=!0)}}return this.removedEditRangeStartElements=[],t},e.prototype.deleteSelectedContents=function(e,t,i){var r=this.deleteSelectedContentInternal(e,t,e.start,e.end,i),n=e.getTextPosBasedOnLogicalIndex(e.editPosition);return e.selectContent(n,!0),r},e.prototype.removeWholeElement=function(e){this.initHistory("BackSpace"),this.deleteSelectedContents(e,!0),this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e)},e.prototype.singleBackspace=function(e,t){var i=this.editorHistory;if(i&&!t&&!i.canRedo()&&i.canUndo()){var r=i.undoStack[i.undoStack.length-1],n=this.selection.getParagraphInfo(e.start),o=this.selection.getParagraphInfo(e.end);if("AutoFormatHyperlink"===r.action&&r.insertPosition===this.selection.getHierarchicalIndex(n.paragraph,n.offset.toString())&&r.endPosition===this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()))return void i.undo()}var s=!1,a=e.start.paragraph,l=e.start.currentWidget,d=e.start.offset,h=0,c=l.getInline(d,h),p=c.element;if(this.selection.isInlineFormFillMode()){if(p instanceof va&&2===p.fieldType)return;if(1===this.getFieldResultText().length)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField())}if(h=c.index,p instanceof Fa&&(p.ignoreOnceItems=[]),p instanceof Fa&&(p.ignoreOnceItems=[]),p instanceof va&&2===p.fieldType&&x.isLinkedFieldCharacter(p)){var g=p.fieldBegin,f=p.fieldEnd;return g.nextNode instanceof Na&&g.nextNode.reference&&(f=g.nextNode.reference),e.start.setPositionParagraph(g.line,g.line.getOffset(g,0)),e.end.setPositionParagraph(f.line,f.line.getOffset(f,0)+1),void e.fireSelectionChanged(!0)}if(!this.owner.enableTrackChanges&&p instanceof Wa&&("Footnote"===p.footnoteType?this.removeFootnote(p):this.removeEndnote(p)),p&&(p instanceof Oa||p.previousNode instanceof Oa)&&(p instanceof Oa&&p.previousNode&&!(p.previousElement instanceof Va)&&(a=(p=p.previousNode).line.paragraph,d=p.line.getOffset(p,p.length)),p&&1===p.length&&p.nextNode instanceof Oa&&p.previousNode instanceof Oa)){var u=p.previousNode;f=p.nextNode;if(!u.contentControlProperties.lockContentControl)return e.start.setPositionParagraph(u.line,u.line.getOffset(u,0)),e.end.setPositionParagraph(f.line,f.line.getOffset(f,0)+1),void this.removeWholeElement(e)}if(p instanceof al&&1===p.commentType){var m=p.comment;for(m.isReply&&(m=m.ownerComment);p instanceof al;)p=p.previousNode;this.deleteCommentInternal(m),a=p.line.paragraph,d=p.line.getOffset(p,p.length),e.start.setPositionParagraph(p.line,d),e.end.setPositionParagraph(p.line,d),s=!0}if(p instanceof va&&1===p.fieldType&&!this.selection.isInlineFormFillMode()){var y=e.getPreviousValidElement(p);if(y instanceof va){if(a=(p=y.fieldBegin).line.paragraph,d=p.line.getOffset(p,0),p.nextNode instanceof Na&&p.nextNode.reference){var v=p.nextNode.reference;e.start.setPositionParagraph(v.line,v.line.getOffset(v,1))}return e.end.setPositionParagraph(p.line,d),void e.fireSelectionChanged(!0)}y!==p&&(a=(p=y).line.paragraph,d=p.line.getOffset(p,p.length))}if(p instanceof _a||p instanceof qa){if(p.nextNode instanceof qa&&p.editRangeEnd===p.nextNode||p.previousNode instanceof _a&&p.editRangeStart===p.previousNode)return;if(p instanceof _a&&!(p.previousNode instanceof qa))return;if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType&&(p instanceof _a||p instanceof qa))return;if(p instanceof qa)do{if(sf.base.isNullOrUndefined(p.previousNode))break;a=(p=p.previousNode).line.paragraph,d=p.line.getOffset(p,p.length)}while(p instanceof qa);if(1===p.length&&p.nextNode instanceof qa&&p.previousNode instanceof _a){var w=p.previousNode;f=p.nextNode;return e.start.setPositionParagraph(w.line,w.line.getOffset(w,0)),e.end.setPositionParagraph(f.line,f.line.getOffset(f,0)+1),void this.removeWholeElement(e)}}if(p&&(p instanceof Na||p.previousNode instanceof Na)){if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType&&(p.previousNode&&p.previousNode instanceof _a||p.previousNode instanceof qa))return;if(p instanceof Na&&1===p.bookmarkType){if(p.previousNode){if((p=p.previousNode)instanceof va&&!this.selection.isInlineFormFillMode()){if(a=(p=p.fieldBegin).line.paragraph,d=p.line.getOffset(p,0),p.nextNode instanceof Na&&p.nextNode.reference){var b=p.nextNode.reference;e.start.setPositionParagraph(b.line,b.line.getOffset(b,1))}return e.end.setPositionParagraph(p.line,d),void e.fireSelectionChanged(!0)}a=p.line.paragraph,d=p.line.getOffset(p,p.length)}else if(a.previousRenderedWidget instanceof ca){var I=(k=a.previousRenderedWidget).lastChild;return e.start.setPositionParagraph(p.line,p.line.getOffset(p,0)),e.end.setPositionParagraph(I,I.getEndOffset()),void this.removeWholeElement(e)}}else if(p.nextNode instanceof Na&&p instanceof Na&&0===p.bookmarkType&&p.reference===p.nextNode)return void this.deleteBookmark(p.name);if(1===p.length&&p.nextNode instanceof Na&&p.previousNode instanceof Na){g=p.previousNode,f=p.nextNode;return e.start.setPositionParagraph(g.line,g.line.getOffset(g,0)),e.end.setPositionParagraph(f.line,f.line.getOffset(f,0)+1),void this.removeWholeElement(e)}}if(t||this.initHistory("BackSpace"),d===e.getStartOffset(a)&&e.start.currentWidget.isFirstLine()){if(a.paragraphFormat.listFormat&&-1!==a.paragraphFormat.listFormat.listId)return void(sf.base.isNullOrUndefined(this.editorHistory)||sf.base.isNullOrUndefined(this.editorHistory.undoStack)||"ListFormat"!==this.editorHistory.undoStack[this.editorHistory.undoStack.length-1].action?this.onApplyList(void 0):this.onApplyListInternal(this.documentHelper.getListById(a.paragraphFormat.listFormat.listId),a.paragraphFormat.listFormat.listLevelNumber-1));if(0!==a.paragraphFormat.firstLineIndent)return void this.onApplyParagraphFormat("firstLineIndent",0,!1,!1);if(0!==a.paragraphFormat.leftIndent)return void this.onApplyParagraphFormat("leftIndent",0,!1,!1);if(!a.paragraphFormat.bidi&&"Left"!==a.paragraphFormat.textAlignment)return void this.onApplyParagraphFormat("textAlignment","Left",!1,!0);if(a.previousRenderedWidget instanceof ca){e.owner.isShiftingEnabled=!0;var F=a.previousRenderedWidget;if(this.owner.enableTrackChanges&&null!=a.previousRenderedWidget&&0==a.previousRenderedWidget.characterFormat.revisions.length)if(this.checkToMatchEmptyParaMarkBack(F)){C=this.documentHelper.selection.getLineLength(F.lastChild),W=F.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(F,W,0),e.selects(F.childWidgets[W],C,!0),this.addRemovedNodes(a)}else{this.insertRevision(F.characterFormat,"Deletion");var C=this.documentHelper.selection.getLineLength(F.lastChild),W=F.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(F,W,0),e.selects(F.childWidgets[W],C,!0),this.addRemovedNodes(a)}else if(F.isEmpty()&&!this.owner.enableTrackChanges)if(this.removePrevParaMarkRevision(a),a!==a.bodyWidget.lastChild||F.bodyWidget.index===a.bodyWidget.index){this.removeBlock(F),this.addRemovedNodes(F);var k=a.previousRenderedWidget;!sf.base.isNullOrUndefined(k)&&k instanceof ca&&k.isEmpty()&&k.bodyWidget.index!==a.bodyWidget.index&&e.moveToPreviousCharacter()}else{C=this.documentHelper.selection.getLineLength(F.lastChild),W=F.childWidgets.length-1;e.selects(F.childWidgets[W],C,!0)}else if(this.owner.enableTrackChanges&&null!=F.characterFormat.revisions&&"Deletion"==F.characterFormat.revisions[0].revisionType){C=this.documentHelper.selection.getLineLength(F.lastChild),W=F.childWidgets.length-1;this.documentHelper.layout.reLayoutParagraph(F,W,0),e.selects(F.childWidgets[W],C,!0),this.addRemovedNodes(a)}else{var S=!1;a===a.bodyWidget.lastChild&&F.bodyWidget.index!==a.bodyWidget.index||"NoBreak"===a.bodyWidget.sectionFormat.breakCode||(this.removePrevParaMarkRevision(a),this.removeBlock(a,!1,!0),S=!0);C=this.documentHelper.selection.getLineLength(F.lastChild),W=F.childWidgets.length-1;var P=void 0;if(!a.isEmpty()&&S)for(var N=0;N<a.childWidgets.length;N++){P=a.childWidgets[N],F.childWidgets.push(P);for(var O=0;O<P.children.length;O++){if(P.children[O]instanceof Wa)if(-1===this.documentHelper.footnoteCollection.indexOf(P.children[O])){P.children[O].isLayout=!1;var T=parseInt(P.children[O].text);this.documentHelper.footnoteCollection.splice(T-1,0,P.children[O])}}a.childWidgets.splice(N,1),N--,P.paragraph=F}this.documentHelper.layout.reLayoutParagraph(F,W,0),e.selects(F.childWidgets[W],C,!0),S&&this.addRemovedNodes(a)}if(this.setPositionForHistory(),this.documentHelper.layout.getFootNoteWidgetsOf(a).length>0){var H=this.documentHelper.layout,E=a.bodyWidget;H.layoutfootNote(E.page.footnoteWidget)}this.reLayout(e)}else this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0)}else{t||(e.owner.isShiftingEnabled=!0);var R=this.selection.getParagraphInfo(e.start),U=(P=e.start.currentWidget,d-1);U<0&&(P=P.previousLine,U=this.documentHelper.selection.getLineLength(P)+U),this.removeAtOffset(P,e,U),this.setPositionParagraph(R.paragraph,R.offset-1,!1),this.setPositionForHistory(),t?this.fireContentChange():(this.reLayout(e),s&&(this.owner.editorHistory.undoStack[this.owner.editorHistory.undoStack.length-2].modifiedActions.push(this.owner.editorHistory.undoStack[this.owner.editorHistory.undoStack.length-1]),this.owner.editorHistory.undoStack.splice(this.owner.editorHistory.undoStack.length-1,1),s=!1))}},e.prototype.setPositionForHistory=function(e){var t=this.documentHelper.selection;this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(sf.base.isNullOrUndefined(e)?(this.updateHistoryPosition(t.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition):(this.editorHistory.currentBaseHistoryInfo.insertPosition=e,this.editorHistory.currentBaseHistoryInfo.endPosition=e))},e.prototype.removeAtOffset=function(e,t,i){for(var r=0,n=e.paragraph.childWidgets.indexOf(e),o=e.children.length,s=0;s<o;s++){var a=e.children[s];if(!(a instanceof Va)){if(this.removeCharacter(a,i,r,e,n,s))break;r+=a.length}}},e.prototype.removeCharacter=function(e,t,i,r,n,o,s){var a=!1;if(e instanceof Na&&e.reference&&e.line!==e.reference.line&&!(r.children[o]instanceof Na))return sf.base.isNullOrUndefined(e.line.previousLine)?sf.base.isNullOrUndefined(e.line.paragraph.previousRenderedWidget)?sf.base.isNullOrUndefined(e.line.paragraph.nextRenderedWidget)||(e.line.paragraph.nextRenderedWidget.firstChild.children.splice(e.line.paragraph.nextRenderedWidget.firstChild.children.length,0,e),e.line=e.line.paragraph.nextRenderedWidget.firstChild):(e.line.paragraph.previousRenderedWidget.lastChild.children.splice(e.line.paragraph.previousRenderedWidget.lastChild.children.length,0,e),e.line=e.line.paragraph.previousRenderedWidget.lastChild):(e.line.previousLine.children.splice(e.line.previousLine.children.length,0,e),e.line=e.line.previousLine),r.children.splice(o,1),!sf.base.isNullOrUndefined(r.layoutedElements)&&r.layoutedElements.length>0&&r.layoutedElements.splice(o,1),!0;if(t<i+e.length){var l=t-i;if(e.ischangeDetected=!0,this.owner.isSpellCheck){var d=e.nextElement,h=e.previousElement;this.owner.spellChecker.removeErrorsFromCollection({element:e,text:e.text}),!sf.base.isNullOrUndefined(d)&&d instanceof Fa&&(d.ischangeDetected=!0,this.owner.spellChecker.removeErrorsFromCollection({element:d,text:d.text})),!sf.base.isNullOrUndefined(h)&&h instanceof Fa&&(h.ischangeDetected=!0,this.owner.spellChecker.removeErrorsFromCollection({element:h,text:h.text})),e.canTrigger||(this.documentHelper.triggerSpellCheck=!1)}if(t===i&&1===e.length)this.owner.enableTrackChanges&&!this.skipTracking()?(this.addRemovedNodes(e.clone()),this.handleDeleteTracking(e,l,1,o)):(this.unLinkFieldCharacter(e),this.unlinkRangeFromRevision(e,!0),this.addRemovedRevisionInfo(e,void 0),this.addRemovedNodes(e),this.owner.enableTrackChanges&&this.editorHistory.isRedoing&&e instanceof Wa&&("Footnote"===e.footnoteType?this.removeFootnote(e):this.removeEndnote(e)),r.children.splice(o,1),!sf.base.isNullOrUndefined(r.layoutedElements)&&r.layoutedElements.length>0&&r.layoutedElements.splice(o,1)),this.documentHelper.layout.reLayoutParagraph(r.paragraph,n,o,void 0,s);else{var c=this.handleDeleteTracking(e,l,1);this.documentHelper.layout.reLayoutParagraph(r.paragraph,n,o,void 0,s),sf.base.isNullOrUndefined(c)||(e.revisions.length>0&&this.addRemovedRevisionInfo(e,c),this.addRemovedNodes(c))}a=!0}return a},e.prototype.removeCharacterInLine=function(e,t,i){var r=new Fa;if(e instanceof Fa){r.characterFormat.copyFormat(e.characterFormat);var n=1===i?1:i-t;r.text=e.text.substr(t,n);var o=e.text;e.text=o.substring(0,t)+o.substring(t+n,o.length),e.contentControlProperties&&(r.contentControlProperties=e.contentControlProperties.clone())}return r},e.prototype.removeRevisionsInformation=function(e,t,i,r){var n=e.previousElement;"Insertion"===this.retrieveRevisionInOder(n).revisionType&&this.isRevisionMatched(n,void 0)&&e.line.children.splice(r,1)},e.prototype.handleDeleteTracking=function(e,t,i,r,n,o){var s=this.owner.enableTrackChanges,a=(!sf.base.isNullOrUndefined(this.editorHistory)&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing),void 0);if(this.canHandleDeletion()||s&&(!this.skipTracking()||e.paragraph.isInsideTable&&!sf.base.isNullOrUndefined(this.editorHistory)&&this.editorHistory.isRedoing&&this.editorHistory.currentBaseHistoryInfo&&"RemoveRowTrack"===this.editorHistory.currentBaseHistoryInfo.action)){if(e instanceof Na||e instanceof al||e instanceof _a||e instanceof qa)return void(e instanceof Na&&e.previousElement instanceof va&&e.previousElement.formFieldData?e.previousElement.revisions.length>0&&this.removeRevisionsInformation(e,t,i,r):s&&e instanceof Na?(this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e)):e.line.children.splice(e.indexInOwner,1));var l=!1;if(this.owner.editorHistory&&(l=!sf.base.isNullOrUndefined(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),this.skipTableElements||this.updateEndRevisionIndex(),e.revisions.length>0){var d=this.retrieveRevisionInOder(e),h=this.owner.revisions.changes.indexOf(d);if("Insertion"===d.revisionType)if(this.isRevisionMatched(e,void 0)){if(sf.base.isNullOrUndefined(r)){a=this.removeCharacterInLine(e,t,i);var c=e.revisions[0];sf.base.isNullOrUndefined(c)||this.owner.trackChangesPane.updateCurrentTrackChanges(c)}else{var p=d.range.indexOf(e);d.range.splice(p,1),this.owner.trackChangesPane.updateCurrentTrackChanges(d),0===d.range.length&&this.owner.revisionsInternal.remove(d),this.unLinkFieldCharacter(e),e.line.children.splice(r,1)}e instanceof Wa&&("Footnote"===e.footnoteType?this.removeFootnote(e):this.removeEndnote(e))}else if(sf.base.isNullOrUndefined(r)){var g=this.removeCharacterInLine(e,t,i),f=e.revisions[0];if(sf.base.isNullOrUndefined(f)||this.owner.trackChangesPane.updateCurrentTrackChanges(f),0===t){var u=e.previousElement;this.handleDeletionForInsertRevision(u,e,g,i,t,!0)}else if(e.length!==t)for(var m=e.revisions.length-1;m>=0;m--){var y=e.revisions[m],v=y.range.indexOf(e),w=new Fa;w.characterFormat.copyFormat(e.characterFormat),w.line=e.line,w.text=e.text.substr(t),w.revisions.splice(0,0,y),y.range.splice(v+1,0,w),g.revisions.splice(0,0,y),g.line=e.line,y.range.splice(v+1,0,g),this.owner.trackChangesPane.updateCurrentTrackChanges(y),e.text=e.text.substr(0,t);var b=e.indexInOwner;e.line.children.splice(b+1,0,w),e.line.children.splice(b+1,0,g),this.addRemovedNodes(g.clone()),this.insertRevision(g,"Deletion"),this.updateLastElementRevision(g)}else if(e.length===t){var x=e.nextElement;this.handleDeletionForInsertRevision(x,e,g,i,t,!1)}else 1===i?l||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)):this.updateCursorForInsertRevision(e,t,i),this.addRemovedNodes(g.clone()),this.insertInlineInternal(g,"Deletion")}else this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.updateLastElementRevision(e);else if("Deletion"===d.revisionType){if(-1!==h&&d.author!==this.owner.currentUser&&d.range.length>0){var I=d.range,F=I[0]instanceof T?0:I[0].line.getOffset(I[0],0),C=I[I.length-1]instanceof T?I[I.length-2]:I[I.length-1],W=C.line.getOffset(C,C.length),k=!1;F===t&&W===i&&(I.splice(I.indexOf(e),1),this.owner.trackChangesPane.updateCurrentTrackChanges(d),e.revisions.splice(e.revisions.indexOf(d),1),this.checkToCombineRevisionsInSides(e,"Deletion")?this.combineElementRevision(e.revisions,e.revisions):(this.insertRevision(e,"Deletion"),k=!0,this.updateLastElementRevision(e)),k&&e.line.getOffset(e,0)===F&&-1!==this.owner.revisions.changes.indexOf(d)&&this.owner.revisions.changes.splice(h,1))}if(1===i)l?(this.selection.start.moveNextPosition(),this.selection.end.setPositionInternal(this.selection.start)):(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start));else if(this.isRevisionMatched(e,"Deletion"))this.updateCursorForInsertRevision(e,t,i);else{var S=d.range.indexOf(e);(W=e.line.getOffset(e,e.length))>=i&&d.range.length>S+1?(this.updateRevisionForSpittedTextElement(e,d.range[S+1]),d.range.splice(d.range.indexOf(e),1),this.toCombineOrInsertRevision(e,"Deletion"),this.owner.trackChangesPane.updateCurrentTrackChanges(d)):1===d.range.length||0===t?(this.handleDeleteBySplitting(e,t,i),S>0&&1!==d.range.length&&(this.updateRevisionForSpittedTextElement(d.range[S-1],d.range[S]),(d=this.retrieveRevisionInOder(e)).range.splice(d.range.indexOf(e),1))):(d.range.splice(d.range.indexOf(e),1),this.toCombineOrInsertRevision(e,"Deletion"))}this.updateLastElementRevision(e)}}else sf.base.isNullOrUndefined(r)?this.handleDeleteBySplitting(e,t,i):(this.checkToCombineRevisionsInSides(e,"Deletion")||this.insertRevision(e,"Deletion"),this.skipFootNoteDeleteTracking||this.updateLastElementRevision(e))}else{a=this.removeCharacterInLine(e,t,i);d=e.revisions[0];sf.base.isNullOrUndefined(d)||this.owner.trackChangesPane.updateCurrentTrackChanges(d)}return a},e.prototype.toCombineOrInsertRevision=function(e,t){this.checkToCombineRevisionsInSides(e,t)?this.combineElementRevision(e.revisions,e.revisions):(this.insertRevision(e,t),this.updateLastElementRevision(e))},e.prototype.updateLastElementRevision=function(e){this.skipTableElements||!this.editorHistory||!this.editorHistory.currentBaseHistoryInfo||this.skipReplace||!sf.base.isNullOrUndefined(this.owner.search)&&this.owner.search.isRepalceTracking||(sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.lastElementRevision)&&(this.editorHistory.currentBaseHistoryInfo.lastElementRevision=e),e.isMarkedForRevision=!0)},e.prototype.updateEndRevisionIndex=function(){if(!sf.base.isNullOrUndefined(this.editorHistory.undoStack)&&this.editorHistory.undoStack.length>0){var e=this.editorHistory.undoStack[this.editorHistory.undoStack.length-1];e.lastElementRevision&&sf.base.isNullOrUndefined(e.endRevisionLogicalIndex)&&e.updateEndRevisionInfo()}},e.prototype.retrieveRevisionInOder=function(e){if(1===e.revisions.length)return e.revisions[0];for(var t=0;t<e.revisions.length;t++)if("Deletion"===e.revisions[t].revisionType)return e.revisions[t];return e.revisions[e.revisions.length-1]},e.prototype.handleDeletionForInsertRevision=function(e,t,i,r,n,o){if(!sf.base.isNullOrUndefined(e)&&0===t.revisions.length&&this.isRevisionMatched(e,"Deletion"))this.addRemovedNodes(i.clone()),this.insertTextInline(e,this.selection,i.text,0);else{var s=t.revisions[t.revisions.length-1],a=s.range.indexOf(t);s.range.splice(o?a:a+1,0,i),this.owner.trackChangesPane.updateCurrentTrackChanges(s),i.revisions.splice(0,0,s);var l=!1;this.owner.editorHistory&&(l=!sf.base.isNullOrUndefined(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),1!==r||l?this.updateCursorForInsertRevision(t,n,r):(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start)),this.addRemovedNodes(i.clone()),this.insertInlineInternal(i,"Deletion")}},e.prototype.handleDeleteBySplitting=function(e,t,i){var r=!1;if(this.owner.editorHistory&&(r=!sf.base.isNullOrUndefined(this.owner.editorHistory.currentBaseHistoryInfo)&&"Delete"===this.owner.editorHistory.currentBaseHistoryInfo.action),1===i){var n=e.line.getOffset(e,0);if(n>0){var o=new Al(this.owner);o.setPositionForLineWidget(e.line,n+t),this.selection.start.setPositionInternal(o),this.selection.end.setPositionInternal(this.selection.start)}else r||(this.selection.start.movePreviousPosition(),this.selection.end.setPositionInternal(this.selection.start))}else this.updateCursorForInsertRevision(e,t,i);var s=this.removeCharacterInLine(e,t,i),a=e.revisions[0];sf.base.isNullOrUndefined(a)||this.owner.trackChangesPane.updateCurrentTrackChanges(a),this.addRemovedNodes(s.clone()),""===s.text?this.deleteParagraphMark(e.paragraph,this.selection,0,!0):this.insertTextInternal(s.text,!1,"Deletion")},e.prototype.updateCursorForInsertRevision=function(e,t,i){var r=e.line.getOffset(e,0);r>0&&(t=r+t,i=r+i);var n=new Al(this.owner);n.setPositionFromLine(e.line,t);var o=new Al(this.owner);o.setPositionFromLine(e.line,i),n.isExistBefore(o)?(this.selection.end.setPositionInternal(n),this.selection.start.setPositionInternal(n)):(this.selection.start.setPositionInternal(o),this.selection.end.setPositionInternal(o))},e.prototype.checkToCombineRevisionsInSides=function(e,t){var i,r=e.previousNode,n=e.nextNode,o=!1;sf.base.isNullOrUndefined(r)||(r instanceof Na||(r=r.previousValidNodeForTracking),sf.base.isNullOrUndefined(r)||(i=this.getMatchedRevisionsToCombine(r.revisions,t)).length>0&&(this.mapMatchedRevisions(i,r,e,!1),o=!0));sf.base.isNullOrUndefined(n)||(n instanceof Na||(n=n.nextValidNodeForTracking),sf.base.isNullOrUndefined(n)||(i=this.getMatchedRevisionsToCombine(n.revisions,t)).length>0&&(o?this.combineElementRevision(e.revisions,n.revisions):this.mapMatchedRevisions(i,n,e,!0),o=!0));return o},e.prototype.delete=function(){this.removeEditRange=!0;var e=this.documentHelper.selection;if(e.bookmarks.length>0&&this.extendSelectionToBookmarkStart(),e.isEmpty)this.singleDelete(e,!1);else{this.initHistory("Delete"),this.deleteSelectedContentInternal(e,!1,e.start,e.end);var t=new Al(e.owner);this.setPositionForCurrentIndex(t,e.editPosition),e.selectContent(t,!0),this.reLayout(e),this.insertSpaceInFormField()}this.documentHelper.layout.islayoutFootnote=!1,this.removeEditRange=!1,this.updateXmlMappedContentControl()},e.prototype.deleteEditElement=function(e){this.initHistory("Delete"),this.deleteSelectedContentInternal(e,!1,e.start,e.end);var t=new Al(e.owner);this.setPositionForCurrentIndex(t,e.editPosition),e.selectContent(t,!0),this.reLayout(e)},e.prototype.removeContentControlMark=function(e,t){return!e.contentControlProperties.lockContentControl&&(this.selection.start.setPositionParagraph(e.line,e.line.getOffset(e,0)),this.selection.end.setPositionParagraph(t.line,t.line.getOffset(t,0)+1),this.deleteEditElement(this.selection),!0)},e.prototype.singleDelete=function(e,t){var i=e.start.currentWidget,r=e.start.paragraph,n=e.start.offset,o=0,s=i.getInline(e.start.offset,o),a=s.element;if(this.selection.isInlineFormFillMode()){if(a instanceof va&&1===a.fieldType)return;var l=this.getFieldResultText();if(a instanceof Fa||(a=a.nextElement),1===l.length&&a instanceof Fa)return this.selection.selectFieldInternal(this.selection.getCurrentFormField()),this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),void this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField());if(a instanceof va&&1===a.fieldType)return}if(o=s.index,r.paragraphFormat.listFormat&&-1!==r.paragraphFormat.listFormat.listId&&this.documentHelper.isListTextSelected&&"List"===e.contextType)this.onApplyList(void 0);else{if(!sf.base.isNullOrUndefined(a)&&o===a.length&&!sf.base.isNullOrUndefined(a.nextNode)){if((a=a.nextNode)instanceof va&&1===a.fieldType&&!sf.base.isNullOrUndefined(a.fieldBegin.formFieldData))return;if(a instanceof Wa)return;o=0}for(var d=a instanceof al;a instanceof al;){if(!a.nextNode){o=1;break}a=a.nextNode,o=0}if(d&&(r=a.line.paragraph,n=a.line.getOffset(a,o),e.start.setPositionParagraph(a.line,n),e.end.setPositionParagraph(a.line,n)),!this.owner.enableTrackChanges&&a instanceof Wa&&("Footnote"===a.footnoteType?this.removeFootnote(a):this.removeEndnote(a)),!sf.base.isNullOrUndefined(a)){var h=void 0,c=e.getNextValidElement(a);if(c instanceof ya&&(h=c),!sf.base.isNullOrUndefined(h)&&h instanceof va&&0===h.fieldType){if(r=(a=h.fieldEnd).line.paragraph,n=a.line.getOffset(a,1),e.end.setPositionParagraph(a.line,n),a.nextNode instanceof Na){var p=a.nextNode;e.end.setPositionParagraph(p.line,p.line.getOffset(p,1))}return void e.fireSelectionChanged(!0)}a!==h&&(r=(a=h).line.paragraph,n=a.line.getOffset(a,0),a instanceof va&&1===a.fieldType&&n++)}if(a instanceof _a||a instanceof qa){if(a.nextNode instanceof qa&&a.editRangeEnd===a.nextNode||a.previousNode instanceof _a&&a.editRangeStart===a.previousNode)return;if(this.documentHelper.isDocumentProtected&&"ReadOnly"===this.documentHelper.protectionType){if(a instanceof _a||a instanceof qa)return}else a instanceof _a?(n=(a=a.nextNode).line.getOffset(a,0),r=a.line.paragraph):a instanceof qa&&n++;if(1===a.length&&a.nextNode instanceof qa&&a.previousNode instanceof _a){var g=a.previousNode,f=a.nextNode;return e.start.setPositionParagraph(g.line,g.line.getOffset(g,0)),e.end.setPositionParagraph(f.line,f.line.getOffset(f,0)+1),void this.deleteEditElement(e)}}if(a&&(a instanceof Oa||a.nextNode instanceof Oa)){if(a instanceof Oa&&a.nextNode)return r=(a=a.nextNode).line.paragraph,n=a.line.getOffset(a,0),e.start.setPositionParagraph(a.line,n),void e.end.setPositionParagraph(a.line,n);if(a&&1===a.length&&a.nextNode instanceof Oa&&a.previousNode instanceof Oa&&this.removeContentControlMark(a.previousNode,a.nextNode))return;if(a instanceof Oa&&a.previousNode instanceof Oa&&a.previousNode.reference===a&&this.removeContentControlMark(a.previousNode,a))return}if(a&&(a instanceof Na&&0===a.bookmarkType||a.nextNode instanceof Na)){if(a.nextNode&&a instanceof Na&&(r=(a=a.nextNode).line.paragraph,n=a.line.getOffset(a,0),e.start.setPositionParagraph(a.line,n),e.end.setPositionParagraph(a.line,n)),1===a.length&&a.nextNode instanceof Na&&a.previousNode instanceof Na){var u=a.previousNode,m=a.nextNode;return e.start.setPositionParagraph(u.line,u.line.getOffset(u,0)),e.end.setPositionParagraph(m.line,m.line.getOffset(m,0)+1),void this.deleteEditElement(e)}a instanceof Na&&(n=a.line.getOffset(a,1))}if(e.start.currentWidget.isLastLine()&&n===this.documentHelper.selection.getLineLength(e.start.currentWidget)){if(r.isInsideTable&&sf.base.isNullOrUndefined(r.nextWidget))return;var y=void 0,v=e.getNextParagraphBlock(r);if(sf.base.isNullOrUndefined(v)){if(n>0)return;if(r.previousWidget instanceof ca&&(y=r.previousWidget),r.previousWidget instanceof ha)return;if(r.previousWidget instanceof ga)return;if(sf.base.isNullOrUndefined(y)||r.isEmpty()&&y.characterFormat.revisions.length>0)return}if(t||this.initHistory("Delete"),r.isEndsWithPageBreak||r.isEndsWithColumnBreak){var w=r.lastChild,b=w.children[w.children.length-1];this.selection.start.setPositionForSelection(w,b,0,this.selection.start.location)}var x=this.selection.getParagraphInfo(e.start);if(e.editPosition=this.selection.getHierarchicalIndex(x.paragraph,x.offset.toString()),this.checkInsertPosition(e)&&this.setPositionForHistory(e.editPosition),e.owner.isShiftingEnabled=!0,r.isEmpty()){this.removePrevParaMarkRevision(r,!0);var I=e.getNextParagraphBlock(r);if(!sf.base.isNullOrUndefined(I)&&I instanceof ca&&I.bodyWidget.index!==r.bodyWidget.index&&this.deleteSection(e,r.bodyWidget,I.bodyWidget,0),this.removeBlock(r,!1,!0),this.addRemovedNodes(r),sf.base.isNullOrUndefined(v))if(sf.base.isNullOrUndefined(y)){var F=e.getParagraphLength(void 0)+1;this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.selection.getHierarchicalIndex(void 0,F.toString()))}else e.selectParagraphInternal(y,!1),this.setPositionForHistory();else e.selectParagraphInternal(v,!0)}else if(this.owner.enableTrackChanges&&r.nextRenderedWidget instanceof ca){var C=r.nextRenderedWidget,W=C.childWidgets.length-1;r=r.combineWidget(this.owner.viewer);var k=this.splitParagraph(r,r.firstChild,0,e.start.currentWidget,e.start.offset,!0);null!=r&&0!=r.characterFormat.revisions.length&&"Insertion"==r.characterFormat.revisions[0].revisionType?(this.removePrevParaMarkRevision(r,!0),this.deleteParagraphMark(k,e,0),this.addRemovedNodes(r),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0)):(this.removePrevParaMarkRevision(r,!0),this.deleteParagraphMark(k,e,0,!0),this.addRemovedNodes(r),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selects(C.childWidgets[W],0,!0))}else{r=r.combineWidget(this.owner.viewer);k=this.splitParagraph(r,r.firstChild,0,e.start.currentWidget,e.start.offset,!0);this.removePrevParaMarkRevision(r,!0),this.deleteParagraphMark(k,e,0),this.addRemovedNodes(r),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0)}this.reLayout(e)}else this.singleDeleteInternal(e,t,r);e.start.currentWidget.getInline(e.start.offset+1,0).element instanceof Na&&(e.start.offset++,e.end.offset++)}},e.prototype.singleDeleteInternal=function(e,t,i){t||(e.owner.isShiftingEnabled=!0,this.initHistory("Delete")),this.checkInsertPosition(e)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition);var r=this.selection.getParagraphInfo(e.start),n=e.start.currentWidget,o=e.start.offset,s=e.getLineLength(e.start.currentWidget);o>=s&&(n=n.nextLine,o-=s),this.removeAtOffset(n,e,o),this.owner.enableTrackChanges&&!sf.base.isNullOrUndefined(this.editorHistory)&&this.editorHistory.currentBaseHistoryInfo&&"Delete"===this.editorHistory.currentBaseHistoryInfo.action&&s!==e.getLineLength(e.start.currentWidget)?this.setPositionParagraph(r.paragraph,r.offset,!1):this.owner.enableTrackChanges&&!this.skipTracking()?this.setPositionParagraph(r.paragraph,r.offset+1,!1):this.setPositionParagraph(r.paragraph,r.offset,!1),t?this.fireContentChange():this.reLayout(e)},e.prototype.deleteParagraphMark=function(e,t,i,r,n,o){if(!sf.base.isNullOrUndefined(e.containerWidget)){e=e.combineWidget(this.owner.viewer);var s=t.getNextParagraphBlock(e);if(!(e.isInsideTable&&sf.base.isNullOrUndefined(e.nextWidget)||sf.base.isNullOrUndefined(s))){e.containerWidget instanceof aa&&e.containerWidget;var a=void 0;if(a=t.getNextRenderedBlock(e)instanceof ga?t.getNextRenderedBlock(e):void 0,s.isInsideTable&&!sf.base.isNullOrUndefined(a)&&a.contains(s.associatedCell)){if(i<4){var l=0;this.removeBlock(e),this.documentHelper.layout.clearListElementBox(s),this.documentHelper.layout.clearListElementBox(e);for(var d=e.childWidgets.length-1;d>=0;d--)for(var h=e.childWidgets[d],c=h.children.length-1;c>=0;c--){var p=h.children[c];l+=p.length,s.firstChild.children.unshift(p),p.line=s.firstChild}this.documentHelper.layout.reLayoutParagraph(s,0,0),l>0&&(t.editPosition=this.selection.getHierarchicalIndex(s,l.toString()))}}else if(i<4){e.childWidgets.length;var g=s.getSplitWidgets();if(s=s.combineWidget(this.owner.viewer),this.documentHelper.layout.clearListElementBox(s),this.documentHelper.layout.clearListElementBox(e),this.updateEditPositionOnMerge(e,s),!(!sf.base.isNullOrUndefined(r)&&r)||this.handleDeleteParaMark(e,g[0])){var f=e.childWidgets.length-1;for(e.childWidgets[f].children.length,d=0;d<s.childWidgets.length;d++){var u=s.childWidgets[d];if(s.characterFormat.revisions.length>0)for(var m=0;m<s.characterFormat.revisions.length;m++){for(c=0;c<s.characterFormat.revisions[m].range.length;c++)s.characterFormat.revisions[m].range[c].ownerBase=e;e.characterFormat.revisions.push(s.characterFormat.revisions[m])}s.childWidgets.splice(d,1),e.childWidgets.push(u),u.paragraph=e,d--}for(d=0;d<s.floatingElements.length;d++){var y=s.floatingElements[d];s.floatingElements.splice(d,1),e.floatingElements.push(y),d--}s.bodyWidget.index!==e.bodyWidget.index&&this.deleteSection(t,e.bodyWidget,s.bodyWidget,i),0===s.childWidgets.length&&s.childWidgets.push(new ma(s)),this.documentHelper.layout.reLayoutParagraph(e,0,0),this.removeBlock(s),"Insert"!==this.editorHistory.currentBaseHistoryInfo.action&&(sf.base.isNullOrUndefined(this.editorHistory)||sf.base.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"Accept All"!=this.editorHistory.currentHistoryInfo.action||this.removeRevisionForBlock(s,void 0,!1,!0),o||this.addRemovedNodes(s,n))}}}}},e.prototype.handleDeleteParaMark=function(e,t){if(!this.owner.enableTrackChanges&&e.characterFormat.revisions.length>0)for(var i=0;i<e.characterFormat.revisions.length;i++){var r=e.characterFormat.revisions[i],n=r.range.indexOf(e.characterFormat);return r.range.splice(n,1),this.owner.trackChangesPane.updateCurrentTrackChanges(r),0===r.range.length&&this.owner.revisions.remove(r),!0}if(this.owner.enableTrackChanges){var o=!1;if(e.characterFormat.revisions.length>0){var s=this.retrieveRevisionByType(e.characterFormat,"Deletion");if(!sf.base.isNullOrUndefined(s)&&this.isRevisionMatched(s,"Deletion")){var a=e.characterFormat.revisions.indexOf(s);e.characterFormat.revisions.splice(a,1),s.range.splice(s.range.indexOf(e.characterFormat),1),this.owner.trackChangesPane.updateCurrentTrackChanges(s),0===s.range.length&&this.owner.revisions.remove(s),o=!0}var l=this.retrieveRevisionByType(e.characterFormat,"Insertion");if(!sf.base.isNullOrUndefined(l)&&this.isRevisionMatched(e.characterFormat,"Insertion")){n=l.range.indexOf(e.characterFormat);l.range.splice(n,1),this.owner.trackChangesPane.updateCurrentTrackChanges(l),0===l.range.length&&this.owner.revisions.remove(l),o=!0}return!!o||(this.applyRevisionForParaMark(e,t.firstChild,"Deletion",!1),!1)}return this.applyRevisionForParaMark(e,t.firstChild,"Deletion",!1),!1}return!0},e.prototype.insertDeleteParaMarkRevision=function(e,t){var i=e.lastChild,r=i.children.length>0?i.children[i.children.length-1].previousValidNodeForTracking:void 0;if(!sf.base.isNullOrUndefined(r)){var n=this.getMatchedRevisionsToCombine(r.revisions,"Deletion");n.length>0&&this.mapMatchedRevisions(n,r,e.characterFormat,!1)}t.firstChild.children[0].nextValidNodeForTracking},e.prototype.retrieveRevisionByType=function(e,t){for(var i=0;i<e.revisions.length;i++)if(e.revisions[i].revisionType===t)return e.revisions[i]},e.prototype.combineRevisionOnDeleteParaMark=function(e,t,i){var r=e.childWidgets[t].children[i],n=r.nextNode;n=n.nextValidNodeForTracking,r=r.nextValidNodeForTracking,n.revisions.length>0&&r.revisions.length>0&&this.combineElementRevisions(r,n)},e.prototype.updateEditPositionOnMerge=function(e,t){this.documentHelper.selection.editPosition===this.selection.getHierarchicalIndex(t,"0")&&void 0===t.nextRenderedWidget&&(this.documentHelper.selection.editPosition=this.selection.getHierarchicalIndex(e,this.documentHelper.selection.getLineLength(e.lastChild).toString()))},e.prototype.checkEndPosition=function(e){return this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.endPosition)},e.prototype.checkInsertPosition=function(e){return this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)},e.prototype.checkIsNotRedoing=function(){return this.documentHelper.owner.enableHistoryMode&&!this.editorHistory.isRedoing},e.prototype.deleteSelectedContentInternal=function(e,t,i,r,n){var o=i,s=r;i.isExistBefore(r)||(o=r,s=i);var a=this.selection.getParagraphInfo(o);e.editPosition=this.selection.getHierarchicalIndex(a.paragraph,a.offset.toString());var l=!1;if(t&&o.isInSameParagraph(s)){if(o.offset<s.offset&&o.offset===e.getParagraphLength(s.paragraph))l=e.getNextRenderedBlock(o.paragraph)instanceof ga;!(1===s.offset&&s.offset>e.getParagraphLength(s.paragraph))||s.paragraph.isInsideTable&&sf.base.isNullOrUndefined(s.paragraph.nextWidget)||(t=!1)}if(!l){e.owner.isShiftingEnabled=!0,this.checkInsertPosition(e)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.editPosition);var d=t?1:0;this.deleteSelectedContent(s.paragraph,e,o,s,d,n)}return l},e.prototype.initHistory=function(e){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initializeHistory(e)},e.prototype.initComplexHistory=function(e){this.documentHelper.owner.enableHistoryMode&&this.editorHistory.initComplexHistory(this.documentHelper.selection,e)},e.prototype.insertPicture=function(e,t,i,r,n){var o=this,s=new Da(!0);".svg"===x.formatClippedString(e).extension?(s.metaFileImageString=e,s.isMetaFile=!0,this.generateFallBackImage(e,t,i,s)):(s.imageString=e,s.element.crossOrigin="Anonymous"),s.width=t,s.height=i,sf.base.isNullOrUndefined(r)&&""==r||(s.alternateText=r),s.textWrappingStyle="Inline",this.documentHelper.addBase64StringInCollection(s);var a=this.documentHelper.getImageString(s);sf.base.isNullOrUndefined(a)||!x.startsWith(a,"http://")&&!x.startsWith(a,"https://")||(a+="?t="+(new Date).getTime(),this.viewer.documentHelper.getBase64(e,t,i).then((function(e){o.viewer.documentHelper.images.get(parseInt(s.imageString))[1]=e}))),s.element.src=a,this.insertPictureInternal(s,n)},e.prototype.generateFallBackImage=function(e,t,i,r){var n=new Image;n.onload=function(){var e=Math.max(1,window.devicePixelRatio||1),o=document.createElement("canvas");o.width=t*e,o.height=i*e;var s=o.getContext("2d");s.scale(e,e),s.drawImage(n,0,0,t,i),r.imageString=o.toDataURL("image/png",1)},n.src=e},e.prototype.insertPictureInternal=function(e,t){var i=this.documentHelper.selection;this.initHistory("InsertInline"),t&&this.fitImageToPage(i,e),this.insertInlineInSelection(i,e),this.reLayout(i)},e.prototype.fitImageToPage=function(e,t){var i=e.start.paragraph.bodyWidget,r=i.sectionFormat.pageHeight-i.sectionFormat.topMargin-i.sectionFormat.topMargin,n=0;if(i instanceof aa&&i.sectionFormat.columns.length>1){var o=i.columnIndex;n=i.sectionFormat.columns[o].width}else n=x.convertPointToPixel(i.sectionFormat.pageWidth-i.sectionFormat.leftMargin-i.sectionFormat.rightMargin);t.width>n&&(t.height=t.height*n/t.width,t.width=n),t.height>r&&(t.width=t.width*r/t.height,t.height=r)},e.prototype.insertInlineInSelection=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),this.updateInsertPosition(),this.insertInlineInternal(t),this.addOrRemoveCommentsInline(t,!0),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},e.prototype.onPortrait=function(){var e=new h,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t>i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},e.prototype.onLandscape=function(){var e=new h,t=this.documentHelper.selection.sectionFormat.pageWidth,i=this.documentHelper.selection.sectionFormat.pageHeight;t<i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},e.prototype.copyValues=function(){var e=new h;return e.bottomMargin=this.documentHelper.selection.sectionFormat.bottomMargin,e.topMargin=this.documentHelper.selection.sectionFormat.topMargin,e.leftMargin=this.documentHelper.selection.sectionFormat.leftMargin,e.rightMargin=this.documentHelper.selection.sectionFormat.rightMargin,e.pageHeight=this.documentHelper.selection.sectionFormat.pageHeight,e.pageWidth=this.documentHelper.selection.sectionFormat.pageWidth,e.footerDistance=this.documentHelper.selection.sectionFormat.footerDistance,e.headerDistance=this.documentHelper.selection.sectionFormat.headerDistance,e},e.prototype.changeMarginValue=function(e){var t=this.copyValues();"lastCustomSetting"===e||"normal"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=72,t.rightMargin=72):"narrow"===e?(t.topMargin=36,t.bottomMargin=36,t.leftMargin=36,t.rightMargin=36):"moderate"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=54,t.rightMargin=54):"wide"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=144,t.rightMargin=144):"mirrored"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=72):"office2003Default"===e&&(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=90),this.onApplySectionFormat(void 0,t)},e.prototype.onPaperSize=function(e){var t=this.copyValues(),i=this.documentHelper.selection.sectionFormat.pageWidth,r=this.documentHelper.selection.sectionFormat.pageHeight;"letter"===e?i<r?(t.pageWidth=612,t.pageHeight=792):(t.pageWidth=792,t.pageHeight=612):"tabloid"===e?i<r?(t.pageWidth=792,t.pageHeight=1224):(t.pageWidth=1224,t.pageHeight=792):"legal"===e?i<r?(t.pageWidth=612,t.pageHeight=1008):(t.pageWidth=1008,t.pageHeight=612):"statement"===e?i<r?(t.pageWidth=396,t.pageHeight=612):(t.pageWidth=612,t.pageHeight=396):"executive"===e?i<r?(t.pageWidth=522,t.pageHeight=756):(t.pageWidth=756,t.pageHeight=522):"a3"===e?i<r?(t.pageWidth=841.9,t.pageHeight=1190.55):(t.pageWidth=1190.55,t.pageHeight=841.9):"a4"===e?i<r?(t.pageWidth=595.3,t.pageHeight=841.9):(t.pageWidth=841.9,t.pageHeight=595.3):"a5"===e?i<r?(t.pageWidth=419.55,t.pageHeight=595.3):(t.pageWidth=595.3,t.pageHeight=419.55):"b4"===e?i<r?(t.pageWidth=728.5,t.pageHeight=1031.8):(t.pageWidth=1031.8,t.pageHeight=728.5):"b5"===e&&(i<r?(t.pageWidth=515.9,t.pageHeight=728.5):(t.pageWidth=728.5,t.pageHeight=515.9)),this.onApplySectionFormat(void 0,t)},e.prototype.updateListItemsTillEnd=function(e,t){for(var i=t?this.documentHelper.selection.getNextRenderedBlock(e):e;!sf.base.isNullOrUndefined(i)&&!this.documentHelper.isTextInput;)this.updateRenderedListItems(i),i=i.getSplitWidgets().pop().nextRenderedWidget},e.prototype.updateWholeListItems=function(e,t,i){this.documentHelper.renderedLists.clear(),this.documentHelper.renderedLevelOverrides=[];e.bodyWidget.index;for(var r,n=0;n<this.documentHelper.pages.length;n++){for(var o=this.documentHelper.pages[n],s=0;s<o.bodyWidgets.length&&(r=this.getNextBlockForList(o.bodyWidgets[s].firstChild),sf.base.isNullOrUndefined(r));s++);if(!sf.base.isNullOrUndefined(r))break}do{if(!r)break;var a=null;if(t&&(a={paragraph:null,listId:i}),this.updateListItems(r,e,a)){if(!sf.base.isNullOrUndefined(a))return a.paragraph==e?null:a.paragraph;break}r=r.getSplitWidgets().pop().nextRenderedWidget,sf.base.isNullOrUndefined(r)||(r=this.getNextBlockForList(r))}while(r);return null},e.prototype.getNextBlockForList=function(e){if(e instanceof ca&&this.documentHelper.layout.isFirstElementWithPageBreak(e)){var t=e.nextRenderedWidget;if(!sf.base.isNullOrUndefined(t)&&t.equals(e))return t}return e},e.prototype.updateListItems=function(e,t,i){return e instanceof ca?this.updateListItemsForPara(e,t,i):this.updateListItemsForTable(e,t,i)},e.prototype.updateListItemsForTable=function(e,t,i){if(sf.base.isNullOrUndefined(i)&&t instanceof ga&&e.equals(t))return!0;var r=e.firstChild;do{if(this.updateListItemsForRow(r,t,i))return!0;r=r.getSplitWidgets().pop().nextRenderedWidget}while(r);return!1},e.prototype.updateListItemsForRow=function(e,t,i){if(sf.base.isNullOrUndefined(i)&&t.isInsideTable&&-1!==e.childWidgets.indexOf(this.documentHelper.selection.getContainerCell(t.associatedCell)))return!0;var r=e.firstChild;do{if(this.updateListItemsForCell(r,t,i),!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.paragraph))return!0;r=r.nextRenderedWidget}while(r);return!1},e.prototype.updateListItemsForCell=function(e,t,i){if(0!==e.childWidgets.length){var r=e.firstChild;do{if(this.updateListItems(r,t,i),!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.paragraph))break;r=r.getSplitWidgets().pop().nextRenderedWidget}while(r)}},e.prototype.updateRenderedListItems=function(e){e instanceof ca?(e.isEndsWithColumnBreak&&(e=e.nextRenderedWidget),this.updateRenderedListItemsForPara(e)):this.updateRenderedListItemsForTable(e)},e.prototype.updateRenderedListItemsForTable=function(e){var t=e.firstChild;do{this.updateRenderedListItemsForRow(t),t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)},e.prototype.updateRenderedListItemsForRow=function(e){var t=e.firstChild;do{this.updateRenderedListItemsForCell(t),t=t.nextRenderedWidget}while(t)},e.prototype.updateRenderedListItemsForCell=function(e){if(0!==e.childWidgets.length){var t=e.firstChild;do{this.updateRenderedListItems(t),t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)}},e.prototype.updateListItemsForPara=function(e,t,i){if(e.equals(t))return sf.base.isNullOrUndefined(i)||(i.paragraph=e),!0;var r=void 0,n=0;if(!sf.base.isNullOrUndefined(e.paragraphFormat)&&!sf.base.isNullOrUndefined(e.paragraphFormat.listFormat)){if(!sf.base.isNullOrUndefined(i)&&e.paragraphFormat.listFormat.listId===i.listId)return i.paragraph=e,!0;r=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),n=e.paragraphFormat.listFormat.listLevelNumber}if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(r.abstractListId))&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(r.abstractListId).levels[n])){var o=this.documentHelper.layout.getListLevel(r,n);this.updateListNumber(o,e,!1)}return!1},e.prototype.updateRenderedListItemsForPara=function(e){if(!sf.base.isNullOrUndefined(this.documentHelper.getListById(e.paragraphFormat.listFormat.listId))){var t=this.documentHelper.getListById(e.paragraphFormat.listFormat.listId),i=e.paragraphFormat.listFormat.listLevelNumber;if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId))&&!sf.base.isNullOrUndefined(this.documentHelper.getAbstractListById(t.abstractListId).levels[e.paragraphFormat.listFormat.listLevelNumber])){var r=this.documentHelper.layout.getListLevel(t,i);this.updateListNumber(r,e,!0)}}},e.prototype.updateListNumber=function(e,t,i){var r,n=void 0;if(t.childWidgets.length>0){var o=t.childWidgets[0];o.children.length>0&&(n=o.children[0])}if(!sf.base.isNullOrUndefined(n)&&n.nextElement instanceof Va&&(r=n.width+n.nextElement.width),!sf.base.isNullOrUndefined(n)&&n instanceof Va){var s=this.documentHelper.layout.getListNumber(t.paragraphFormat.listFormat);if(i){var a=n.width;n.text=s;var l=this.documentHelper.textHelper.getTextSize(n,n.characterFormat);l>a&&(n.width=l),this.documentHelper.textHelper.updateTextSize(n,t),!sf.base.isNullOrUndefined(r)&&n.width<r&&(n.nextElement.width=r-n.width)}}},e.prototype.getOffsetValue=function(e){if(this.startParagraph){var t=e.getLineInfoBasedOnParagraph(this.startParagraph,this.startOffset);e.start.setPositionFromLine(t.line,t.offset)}if(e.start.updatePhysicalPosition(!0),e.isEmpty)e.end.setPositionInternal(e.start);else{if(this.endParagraph){t=e.getLineInfoBasedOnParagraph(this.endParagraph,this.endOffset);e.end.setPositionFromLine(t.line,t.offset)}e.end.updatePhysicalPosition(!0)}},e.prototype.setPositionParagraph=function(e,t,i){var r=this.documentHelper.selection,n=r.getLineInfoBasedOnParagraph(e,t);r.start.setPositionFromLine(n.line,n.offset),r.end.setPositionInternal(r.start),i||r.fireSelectionChanged(!0)},e.prototype.setPositionForCurrentIndex=function(e,t){var i=this.selection.getParagraph({index:t}),r=this.selection.getLineInfoBasedOnParagraph(i.paragraph,i.offset);e.setPositionForLineWidget(r.line,r.offset)},e.prototype.insertPageNumber=function(e){var t="PAGE "+(e=sf.base.isNullOrUndefined(e)?"":" \\*"+e)+" \\* MERGEFORMAT";this.createFields(t)},e.prototype.insertPageCount=function(e){var t="NUMPAGES "+(e=sf.base.isNullOrUndefined(e)?"":" *"+e)+" * MERGEFORMAT";this.createFields(t)},e.prototype.createFields=function(e){var t=new ca,i=new ma(t),r=new va(0);i.children.push(r);var n=new Sa;n.fieldBegin=r,n.text="1";var o=new Fa;o.text=e,i.children.push(o);var s=new va(2);s.fieldBegin=r,r.fieldSeparator=s,i.children.push(s),i.children.push(n);var a=new va(1);a.fieldBegin=r,a.fieldSeparator=s,s.fieldEnd=a,r.fieldEnd=a,i.children.push(a),r.line=i,t.childWidgets.push(i),this.documentHelper.fields.push(r);var l=new aa;l.sectionFormat=new h(l),l.childWidgets.push(t),t.isCreatedUsingHtmlSpanTag=!0,this.pasteContentsInternal([l],!1)},e.prototype.insertBookmark=function(e){if(this.documentHelper.bookmarks.containsKey(e)){var t=this.documentHelper.bookmarks.get(e);if(t.line.children.splice(t.line.children.indexOf(t),1),t.reference&&t.reference.line.children.splice(t.reference.line.children.indexOf(t.reference),1),this.documentHelper.bookmarks.remove(e),sf.base.isNullOrUndefined(t.reference)||sf.base.isNullOrUndefined(t.reference.paragraph.associatedCell)){r=parseInt(t.properties.columnFirst),o=(i=t.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(i.rowIndex,r);!sf.base.isNullOrUndefined(o)&&o.isRenderBookmarkStart&&(o.isRenderBookmarkStart=!1)}else{var i;if((i=t.reference.paragraph.associatedCell.ownerRow).isRenderBookmarkEnd&&(i.isRenderBookmarkEnd=!1),!sf.base.isNullOrUndefined(t.properties)){var r=parseInt(t.properties.columnFirst),n=t.paragraph.associatedCell.ownerRow,o=n.getCellUsingColumnIndex(n.rowIndex,r);sf.base.isNullOrUndefined(o)||(o.isRenderBookmarkStart=!1);for(var s=parseInt(t.properties.columnLast),a=t.reference.paragraph.associatedCell.ownerRow,l=void 0,d=s;sf.base.isNullOrUndefined(l)&&d>-1;)l=a.getCell(a.rowIndex,d),sf.base.isNullOrUndefined(l)&&d--;l.isRenderBookmarkEnd&&(l.isRenderBookmarkEnd=!1)}}}var h=new Na(0);h.name=e;var c=new Na(1);if(c.name=e,h.reference=c,c.reference=h,h.properties=this.selection.getBookmarkProperties(h),c.properties=this.selection.getBookmarkProperties(c),this.owner.isShiftingEnabled=!0,this.initComplexHistory("InsertBookmark"),this.insertElements([c],[h],!0),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal(),this.documentHelper.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),this.documentHelper.bookmarks.add(e,h),sf.base.isNullOrUndefined(h.properties)){this.selection.start.setPositionForSelection(h.line,h,1,this.selection.start.location);var p=0;sf.base.isNullOrUndefined(c.properties)||c.properties.isAfterParagraphMark&&(p=2),this.selection.end.setPositionForSelection(c.line,c,p,this.selection.end.location);var g=this.documentHelper.blockToShift;if(!sf.base.isNullOrUndefined(g)&&this.viewer instanceof Qs&&g.bodyWidget.sectionFormat.columns.length>1){var f=this.documentHelper.layout.getBodyWidget(g.bodyWidget,!1);sf.base.isNullOrUndefined(f.nextRenderedWidget)||"NoBreak"!==f.nextRenderedWidget.sectionFormat.breakCode||f.page!==f.nextRenderedWidget.page||this.reLayout(this.selection)}this.owner.isShiftingEnabled=!1,this.selection.fireSelectionChanged(!0),this.fireContentChange()}else this.selection.selectBookmarkInTable(h);1==this.owner.documentEditorSettings.showBookmarks&&this.viewer.updateScrollBars()},e.prototype.deleteBookmark=function(e){var t=this.documentHelper.bookmarks.get(e);t instanceof Na&&(this.initHistory("DeleteBookmark"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(t),this.editorHistory.updateHistory()),this.deleteBookmarkInternal(t)),this.fireContentChange(),1==this.owner.documentEditorSettings.showBookmarks&&this.viewer.updateScrollBars()},e.prototype.deleteBookmarkInternal=function(e){var t=e.previousNode;if(t instanceof va&&0===t.fieldType&&!sf.base.isNullOrUndefined(t.formFieldData)&&(t.formFieldData.name=""),sf.base.isNullOrUndefined(e.properties)){if(this.documentHelper.selection.isRenderBookmarkAtEnd(e))(i=e.paragraph.associatedCell.ownerRow).isRenderBookmarkEnd&&(i.isRenderBookmarkEnd=!1)}else{var i,r=parseInt(e.properties.columnFirst),n=(i=e.paragraph.associatedCell.ownerRow).getCellUsingColumnIndex(i.rowIndex,r);sf.base.isNullOrUndefined(n)||(n.isRenderBookmarkStart=!1)}this.documentHelper.bookmarks.remove(e.name),e.line.children.splice(e.indexInOwner,1),sf.base.isNullOrUndefined(e.reference)||e.reference.line.children.splice(e.reference.indexInOwner,1);var o=e.line.paragraph;if(e.line.paragraph.isInHeaderFooter){var s=void 0;o.containerWidget instanceof ua?s=o.containerWidget.getContainerTable().containerWidget:o.containerWidget instanceof la&&(s=o.containerWidget),this.updateHeaderFooterWidget(s)}},e.prototype.getSelectionInfo=function(e){var t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start),i.offset===this.selection.getLineLength(i.currentWidget)+1&&this.selection.isParagraphLastLine(i.currentWidget)||this.owner.documentHelper.isDragging||(i.offset+=1);var r=this.selection.getParagraphInfo(t),n=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString());r=this.selection.getParagraphInfo(i);var o=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString()),s=this.selection.selectedWidgets.keys;if(sf.base.isNullOrUndefined(e)||1!=e||this.selection.hasMergedCells()){if(s[0]instanceof ua&&t.paragraph.isInsideTable){var a=this.selection.getCellFromSelectionInTable(0);!sf.base.isNullOrUndefined(a)&&a instanceof ua&&(n=this.selection.getActualOffset(a,0))}if(s[s.length-1]instanceof ua&&i.paragraph.isInsideTable){var l=this.selection.getCellFromSelectionInTable(1);!sf.base.isNullOrUndefined(l)&&l instanceof ua&&(o=this.selection.getActualOffset(l,1))}}else{if(t.paragraph.isInsideTable){var d=this.selection.getCellFromSelection(0);!sf.base.isNullOrUndefined(d)&&d instanceof ua&&(n=this.selection.getActualOffset(d,0))}if(i.paragraph.isInsideTable){var h=this.selection.getCellFromSelection(1);!sf.base.isNullOrUndefined(h)&&h instanceof ua&&(o=this.selection.getActualOffset(h,1))}}return{start:n,end:o}},e.prototype.insertElements=function(e,t,i){var r=this.getSelectionInfo(i);i&&(sf.base.isNullOrUndefined(t[0].properties)||0!=t[0].bookmarkType||(r=this.owner.selection.updateSelectionInfo(r))),sf.base.isNullOrUndefined(t)||this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(r.start),t),sf.base.isNullOrUndefined(e)||this.insertElementsInternal(this.selection.getTextPosBasedOnLogicalIndex(r.end),e)},e.prototype.insertElementsInternal=function(e,t,i){this.selection.selectPosition(e,e),this.initHistory("InsertElements"),this.updateInsertPosition();var r=0,n=this.selection.getParagraphInfo(this.selection.start);if(this.selection.start.paragraph.isEmpty()){var o=this.selection.start.paragraph;o.childWidgets[0].children.push(t[0]),t[0].line=o.childWidgets[0],t[0].linkFieldCharacter(this.documentHelper),this.documentHelper.layout.reLayoutParagraph(o,0,0),this.setPositionParagraph(n.paragraph,n.offset+length,!0),e.setPositionForSelection(t[0].line,t[0],t[0].length,this.selection.start.location),this.selection.selectPosition(e,e)}else{var s=this.selection.start.currentWidget.getInline(this.documentHelper.selection.start.offset,r),a=s.element;r=s.index;var l=t[0];this.insertElementInternal(a,l,r,void 0,!0);for(var d=l.indexInOwner,h=l,c=1;c<t.length;c++)h=t[c],l.line.children.splice(d+c,0,h);e.setPositionForSelection(h.line,h,h.length,this.selection.start.location),this.selection.selectPosition(e,e)}this.editorHistory&&(this.checkEndPosition()&&this.updateHistoryPosition(this.selection.start,!1),this.editorHistory.updateHistory())},e.prototype.getCommentElementBox=function(e){var t=e.split(";"),i=this.documentHelper.comments[parseInt(t[1],10)];return t.length>2&&""!==t[2]?i.replyComments[parseInt(t[2],10)]:i},e.prototype.getBlock=function(e){var t=this.selection.getBodyWidget(e);return this.getBlockInternal(t,e)},e.prototype.getBlockInternal=function(e,t){if(""!==t.index&&!sf.base.isNullOrUndefined(t)){var i=t.index.indexOf(";"),r=t.index.substring(0,i);t.index=t.index.substring(i).replace(";","");var n=e;i=parseInt(r,10);var o=this.selection.getBlockByIndex(e,i);if(!o)return{node:n,position:t};var s=o;if(!(t.index.indexOf(";")>=0))return{node:s,position:t};if(s instanceof ca)return t.index.indexOf(";")>=0&&(t.index="0"),{node:s,position:t};if(s instanceof oa){var a=this.getBlockInternal(s,t);return{node:sf.base.isNullOrUndefined(a)?void 0:a.node,position:sf.base.isNullOrUndefined(a)?void 0:a.position}}return{node:n,position:t}}},e.prototype.updateHistoryPosition=function(e,t){if(this.editorHistory&&!sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){var i=void 0;if(e instanceof Al){var r=this.selection.getParagraphInfo(e);i=this.selection.getHierarchicalIndex(r.paragraph,r.offset.toString())}else i=e;t?this.editorHistory.currentBaseHistoryInfo.insertPosition=i:this.editorHistory.currentBaseHistoryInfo.endPosition=i}},e.prototype.applyBorders=function(e){this.initHistory("Borders");var t=this.selection.isForward?this.selection.start:this.selection.end,i=this.selection.isForward?this.selection.end:this.selection.start,r=t.paragraph.associatedCell.ownerTable;if(r=r.combineWidget(this.owner.viewer),this.editorHistory)this.cloneTableToHistoryInfo(r);t.paragraph.associatedCell;var n,o=i.paragraph.associatedCell,s=this.getBorder(e.borderColor,e.lineWidth,e.borderStyle);if(this.selection.isEmpty)"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"LeftBorder"!==e.type||o.cellFormat.borders.left.copyFormat(s),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"TopBorder"!==e.type||o.cellFormat.borders.top.copyFormat(s),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"RightBorder"!==e.type||o.cellFormat.borders.right.copyFormat(s),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"BottomBorder"!==e.type||o.cellFormat.borders.bottom.copyFormat(s),"AllBorders"!==e.type&&"InsideBorders"!==e.type&&"InsideVerticalBorder"!==e.type||o.cellFormat.borders.vertical.copyFormat(s),"AllBorders"!==e.type&&"InsideBorders"!==e.type&&"InsideHorizontalBorder"!==e.type||o.cellFormat.borders.horizontal.copyFormat(s),"NoBorder"===e.type&&this.clearAllBorderValues(o.cellFormat.borders);else{if("OutsideBorders"===e.type||"TopBorder"===e.type)for(var a=this.getTopBorderCellsOnSelection(),l=0;l<a.length;l++)a[l].cellFormat.borders.top.copyFormat(s);if("OutsideBorders"===e.type||"LeftBorder"===e.type)for(a=this.getLeftBorderCellsOnSelection(),l=0;l<a.length;l++)a[l].cellFormat.borders.left.copyFormat(s);if("OutsideBorders"===e.type||"RightBorder"===e.type)for(a=this.getRightBorderCellsOnSelection(),l=0;l<a.length;l++)a[l].cellFormat.borders.right.copyFormat(s);if("OutsideBorders"===e.type||"BottomBorder"===e.type)for(a=this.getBottomBorderCellsOnSelection(),l=0;l<a.length;l++)a[l].cellFormat.borders.bottom.copyFormat(s)}if("BottomBorder"===e.type||"AllBorders"===e.type||"OutsideBorders"===e.type||"NoBorder"===e.type){n=this.getAdjacentCellToApplyBottomBorder();for(l=0;l<n.length;l++){var d=n[l];"NoBorder"===e.type?d.cellFormat.borders.top.copyFormat(this.clearBorder()):d.cellFormat.borders.top.copyFormat(s)}}if("AllBorders"===e.type||"OutsideBorders"===e.type||"RightBorder"===e.type||"NoBorder"===e.type){n=this.getAdjacentCellToApplyRightBorder();for(l=0;l<n.length;l++){d=n[l];"NoBorder"===e.type?d.cellFormat.borders.left.copyFormat(this.clearBorder()):d.cellFormat.borders.left.copyFormat(s)}}"AllBorders"!==e.type&&"NoBorder"!==e.type||this.applyAllBorders(s,e.type),"InsideBorders"!==e.type&&"InsideVerticalBorder"!==e.type&&"InsideHorizontalBorder"!==e.type&&"NoBorder"!==e.type||this.applyInsideBorders(s,e.type,r),this.updateGridForTableDialog(r,!1),this.reLayout(this.selection,!1),this.editorHistory.updateHistory()},e.prototype.applyAllBorders=function(e,t){for(var i=this.selection.getSelectedCells(),r=0;r<i.length;r++)"NoBorder"===t?(i[r].cellFormat.borders.left.copyFormat(this.clearBorder()),i[r].cellFormat.borders.right.copyFormat(this.clearBorder()),i[r].cellFormat.borders.top.copyFormat(this.clearBorder()),i[r].cellFormat.borders.bottom.copyFormat(this.clearBorder())):(i[r].cellFormat.borders.left.copyFormat(e),i[r].cellFormat.borders.right.copyFormat(e),i[r].cellFormat.borders.top.copyFormat(e),i[r].cellFormat.borders.bottom.copyFormat(e))},e.prototype.applyInsideBorders=function(e,t,i){for(var r=this.selection.getSelectedCells(),n=0;n<r.length;n++){var o=r[n],s=o.ownerRow===r[r.length-1].ownerRow,a=o.columnIndex+o.cellFormat.columnSpan-1===r[r.length-1].columnIndex;if("NoBorder"===t?(o.cellFormat.borders.right.copyFormat(this.clearBorder()),o.cellFormat.borders.bottom.copyFormat(this.clearBorder())):(a||"InsideHorizontalBorder"===t||o.cellFormat.borders.right.copyFormat(e),s||"InsideVerticalBorder"===t||o.cellFormat.borders.bottom.copyFormat(e)),!s&&"InsideVerticalBorder"!==t){var l=o.ownerRow.rowIndex+o.cellFormat.rowSpan,d=i.childWidgets[l];if(d)for(var h=this.getAdjacentBottomBorderOnEmptyCells(d,o,!0),c=0;c<h.length;c++)"NoBorder"===t?h[c].cellFormat.borders.top.copyFormat(this.clearBorder()):h[c].cellFormat.borders.top.copyFormat(e)}if(!a&&"InsideHorizontalBorder"!==t)for(var p=this.getSelectedCellsNextWidgets(o,i),g=0;g<p.length;g++)"NoBorder"===t?p[g].cellFormat.borders.left.copyFormat(this.clearBorder()):p[g].cellFormat.borders.left.copyFormat(e)}},e.prototype.getTopBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,t=[],i=this.selection.getSelectedCells(),r=0;r<i.length;r++)i[r].ownerRow===e.ownerRow&&t.push(i[r]);return t},e.prototype.getLeftBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,t=this.selection.getSelectedCells(),i=[],r=0;r<t.length;r++)t[r].columnIndex===e.columnIndex&&i.push(t[r]);return i},e.prototype.getRightBorderCellsOnSelection=function(){for(var e=this.selection.getSelectedCells(),t=[],i=0;i<e.length;i++)e[i].columnIndex+e[i].cellFormat.columnSpan-1===e[e.length-1].columnIndex&&t.push(e[i]);return t},e.prototype.getBottomBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.end:this.selection.start).paragraph.associatedCell,t=this.selection.getSelectedCells(),i=[],r=0;r<t.length;r++)t[r].ownerRow===e.ownerRow&&i.push(t[r]);return i},e.prototype.clearAllBorderValues=function(e){var t=this.clearBorder();e.bottom.copyFormat(t),e.left.copyFormat(t),e.right.copyFormat(t),e.top.copyFormat(t),e.vertical.copyFormat(t),e.horizontal.copyFormat(t)},e.prototype.clearBorder=function(){var e=new p;return e.lineStyle="Cleared",e},e.prototype.getAdjacentCellToApplyBottomBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var r=t.paragraph.associatedCell.ownerTable;r=r.combineWidget(this.owner.viewer);var n=t.paragraph.associatedCell,o=i.paragraph.associatedCell,s=o.ownerRow.rowIndex+o.cellFormat.rowSpan,a=r.childWidgets[s];if(a)if(o.cellFormat.columnSpan>1)for(var l=o.columnIndex;l<o.columnIndex+o.cellFormat.columnSpan;l++)e.push(a.childWidgets[l]);else if(e=this.getAdjacentBottomBorderOnEmptyCells(a,o),!this.selection.isEmpty)for(l=0;l<a.childWidgets.length;l++){var d=a.childWidgets[l].columnIndex;d>=n.columnIndex&&d<=o.columnIndex&&e.push(a.childWidgets[l])}return e},e.prototype.getAdjacentBottomBorderOnEmptyCells=function(e,t,i){var r=[];if(t.cellFormat.columnSpan>1)for(var n=t.columnIndex;n<t.columnIndex;n++)r.push(e.childWidgets[n]);else if(this.selection.isEmpty||i)for(n=0;n<e.childWidgets.length;n++)e.childWidgets[n].columnIndex===t.columnIndex&&r.push(e.childWidgets[n]);return r},e.prototype.getAdjacentCellToApplyRightBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var r=t.paragraph.associatedCell.ownerTable;r=r.combineWidget(this.owner.viewer);t.paragraph.associatedCell,i.paragraph.associatedCell;if(this.selection.isEmpty){var n=t.paragraph.associatedCell;e=this.getSelectedCellsNextWidgets(n,r)}else for(var o=this.getRightBorderCellsOnSelection(),s=0;s<o.length;s++){var a=o[s];e=e.concat(this.getSelectedCellsNextWidgets(a,r))}return e},e.prototype.getSelectedCellsNextWidgets=function(e,t){var i=[];if(!sf.base.isNullOrUndefined(e.nextWidget)&&(i.push(e.nextWidget),e.cellFormat.rowSpan>1))for(var r=e.ownerRow.rowIndex+e.cellFormat.rowSpan,n=e.ownerRow.rowIndex+1;n<r;n++){var o=t.childWidgets[n];if(o)for(var s=0;s<o.childWidgets.length;s++)o.childWidgets[s].columnIndex===e.nextWidget.columnIndex&&i.push(o.childWidgets[s])}return i},e.prototype.getBorder=function(e,t,i){var r=new p;return r.color=e||"#000000",r.lineWidth=t||1,r.lineStyle=i||"Single",r},e.prototype.applyBordersInternal=function(e,t){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(e.top)||this.applyBorder(e.top,t.top),sf.base.isNullOrUndefined(e.bottom)||this.applyBorder(e.bottom,t.bottom),sf.base.isNullOrUndefined(e.left)||this.applyBorder(e.left,t.left),sf.base.isNullOrUndefined(e.right)||this.applyBorder(e.right,t.right),sf.base.isNullOrUndefined(e.horizontal)||this.applyBorder(e.horizontal,t.horizontal),sf.base.isNullOrUndefined(e.vertical)||this.applyBorder(e.vertical,t.vertical),sf.base.isNullOrUndefined(e.diagonalUp)||this.applyBorder(e.diagonalUp,t.diagonalUp),sf.base.isNullOrUndefined(e.diagonalDown)||this.applyBorder(e.diagonalDown,t.diagonalDown))},e.prototype.applyShading=function(e,t){sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(e)||(sf.base.isNullOrUndefined(t.backgroundColor)||e.backgroundColor===t.backgroundColor||(e.backgroundColor=t.backgroundColor),sf.base.isNullOrUndefined(t.foregroundColor)||e.foregroundColor===t.foregroundColor||(e.foregroundColor=t.foregroundColor),sf.base.isNullOrUndefined(t.textureStyle)||e.textureStyle===t.textureStyle||(e.textureStyle=t.textureStyle))},e.prototype.applyBorder=function(e,t){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t)||(sf.base.isNullOrUndefined(t.color)||e.color===t.color||(e.color=t.color),sf.base.isNullOrUndefined(t.lineStyle)||e.lineStyle===t.lineStyle||(e.lineStyle=t.lineStyle),sf.base.isNullOrUndefined(t.lineWidth)||e.lineWidth===t.lineWidth||(e.lineWidth=t.lineWidth),sf.base.isNullOrUndefined(t.shadow)||e.shadow===t.shadow||(e.shadow=t.shadow),sf.base.isNullOrUndefined(t.space)||e.space===t.space||(e.space=t.space))},e.prototype.onTableFormat=function(e,t){if(!sf.base.isNullOrUndefined(this.selection.tableFormat)){sf.base.isNullOrUndefined(t)&&(t=!1),this.documentHelper.owner.isShiftingEnabled=!0,this.editorHistory.initializeHistory("TableFormat");var i=this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer);if(t)for(var r=0;r<i.childWidgets.length;r++)for(var n=i.childWidgets[r],o=0;o<n.childWidgets.length;o++){n.childWidgets[o].cellFormat.shading.copyFormat(e.shading)}if(!sf.base.isNullOrUndefined(t)&&!this.isCellFormatApplied&&!sf.base.isNullOrUndefined(e.borders))for(r=0;r<i.childWidgets.length;r++){(n=i.childWidgets[r]).rowFormat.borders.copyFormat(e.borders);for(o=0;o<n.childWidgets.length;o++){n.childWidgets[o].cellFormat.borders.copyFormat(e.borders)}}this.applyTableFormat(i,void 0,e),this.reLayout(this.selection,!1)}},e.prototype.applyTableFormat=function(e,t,i){this.applyTablePropertyValue(this.documentHelper.selection,void 0,i,e)},e.prototype.applyTablePropertyValue=function(e,t,i,r){var n=r.tableFormat;sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(n,t,i)),i instanceof Fl?sf.base.isNullOrUndefined(t)&&this.handleTableFormat(n,i):("preferredWidth"===t?n.preferredWidth=i:"leftIndent"===t?n.leftIndent=i:"tableAlignment"===t?n.tableAlignment=i:"cellSpacing"===t?n.cellSpacing=i:"leftMargin"===t?n.leftMargin=i:"rightMargin"===t?n.rightMargin=i:"topMargin"===t?n.topMargin=i:"bottomMargin"===t?n.bottomMargin=i:"preferredWidthType"===t?n.preferredWidthType=i:"bidi"===t?n.bidi=i:"title"===t?n.title=i:"description"===t&&(n.description=i),"shading"===t?n.shading=i:"borders"===t&&(n.borders=i))},e.prototype.handleTableFormat=function(e,t){(this.isBordersAndShadingDialog||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(sf.base.isNullOrUndefined(e.borders)||this.applyBordersInternal(e.borders,t.borders),sf.base.isNullOrUndefined(e.shading)||this.applyShading(e.shading,t.shading)),this.isBordersAndShadingDialog||(t.hasValue("bidi")&&t.bidi!==e.bidi&&(e.bidi=t.bidi),t.hasValue("preferredWidth")&&t.preferredWidth!==e.preferredWidth&&(e.preferredWidth=t.preferredWidth),t.hasValue("preferredWidthType")&&t.preferredWidthType!==e.preferredWidthType&&(e.preferredWidthType=t.preferredWidthType),t.hasValue("tableAlignment")&&t.tableAlignment!==e.tableAlignment&&(e.tableAlignment=t.tableAlignment),t.hasValue("leftIndent")&&t.leftIndent!==e.leftIndent&&(e.leftIndent=t.leftIndent),t.hasValue("topMargin")&&t.topMargin!==e.topMargin&&(e.topMargin=t.topMargin),t.hasValue("bottomMargin")&&t.bottomMargin!==e.bottomMargin&&(e.bottomMargin=t.bottomMargin),t.hasValue("leftMargin")&&t.leftMargin!==e.leftMargin&&(e.leftMargin=t.leftMargin),t.hasValue("rightMargin")&&t.rightMargin!==e.rightMargin&&(e.rightMargin=t.rightMargin),t.hasValue("cellSpacing")&&t.cellSpacing!==e.cellSpacing&&(e.cellSpacing=t.cellSpacing)),this.updateGridForTableDialog(e.ownerBase,!1),sf.base.isNullOrUndefined(t.title)||t.title===e.title||(e.title=t.title),sf.base.isNullOrUndefined(t.description)||t.description===e.description||(e.description=t.description)},e.prototype.updateGridForTableDialog=function(e,t){e.tableHolder&&(e.updateRowIndex(0),e.isGridUpdated=!1),this.documentHelper.layout.reLayoutTable(e)},e.prototype.onRowFormat=function(e){if(!sf.base.isNullOrUndefined(this.selection)&&!sf.base.isNullOrUndefined(e)){this.editorHistory.initializeHistory("RowFormat"),this.documentHelper.owner.isShiftingEnabled=!0;var t=this.selection.isForward?this.selection.start:this.selection.end,i=this.selection.isForward?this.selection.end:this.selection.start;t.paragraph.associatedCell.ownerTable.combineWidget(this.owner.viewer);this.applyRowFormat(t.paragraph.associatedCell.ownerRow,t,i,void 0,e),this.reLayout(this.selection,!1)}},e.prototype.applyRowFormat=function(e,t,i,r,n){if(this.applyRowPropertyValue(this.documentHelper.selection,r,n,e),i.paragraph.associatedCell.ownerRow!==e){var o=e.nextWidget;sf.base.isNullOrUndefined(o)||this.applyRowFormat(o,t,i,r,n)}},e.prototype.applyRowPropertyValue=function(e,t,i,r){var n=r.rowFormat;sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(n,t,i)),i instanceof k?sf.base.isNullOrUndefined(t)&&this.handleRowFormat(i,n):("heightType"===t?n.heightType=i:"height"===t?n.height=i:"isHeader"===t?n.isHeader=i:"allowBreakAcrossPages"===t&&(n.allowBreakAcrossPages=i),sf.base.isNullOrUndefined(r.ownerTable)||this.layoutItemBlock(r.ownerTable,!0))},e.prototype.handleRowFormat=function(e,t){e.hasValue("allowBreakAcrossPages")&&e.allowBreakAcrossPages!==t.allowBreakAcrossPages&&(t.allowBreakAcrossPages=e.allowBreakAcrossPages),e.hasValue("isHeader")&&e.isHeader!==t.isHeader&&(t.isHeader=e.isHeader),e.hasValue("heightType")&&e.heightType!==t.heightType&&(t.heightType=e.heightType),e.hasValue("height")&&e.height!==t.height&&(t.height=e.height),this.updateGridForTableDialog(t.ownerBase.ownerTable,!0)},e.prototype.onCellFormat=function(e){sf.base.isNullOrUndefined(this.selection)||sf.base.isNullOrUndefined(e)||(this.editorHistory.initializeHistory("CellFormat"),this.updateFormatForCell(this.selection,void 0,e),this.reLayout(this.selection,!1))},e.prototype.updateCellMargins=function(e,t){var i=e.start;e.end;e.isForward||(i=e.end,e.start),this.initHistoryPosition(e,i)},e.prototype.updateFormatForCell=function(e,t,i){var r=e.start,n=e.end;e.isForward||(r=e.end,n=e.start);for(var o,s=r.paragraph.associatedCell,a=n.paragraph.associatedCell,l=s.ownerTable.combineWidget(this.owner.viewer),d=s.columnIndex;d<=a.columnIndex;d++){o=this.getSelectedCellInColumn(s.ownerTable,s.ownerRow.rowIndex,d,a.ownerRow.rowIndex);for(var h=0;h<o.length;h++)this.applyCellPropertyValue(this.documentHelper.selection,t,i,o[h].cellFormat)}this.updateGridForTableDialog(l,!1)},e.prototype.getSelectedCellInColumn=function(e,t,i,r){for(var n=[],o=t;o<=r;o++)for(var s=e.childWidgets[o],a=0;a<s.childWidgets.length;a++)s.childWidgets[a].columnIndex===i&&n.push(s.childWidgets[a]);return n},e.prototype.getColumnCells=function(e,t,i){for(var r=[],n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],s=0;s<o.childWidgets.length;s++){var a=o.childWidgets[s];i?a.columnIndex+a.cellFormat.columnSpan===t&&r.push(a):a.columnIndex===t&&r.push(a)}return r},e.prototype.getTableWidth=function(e){return 0!==e.tableFormat.preferredWidth||"Percent"===e.tableFormat.preferredWidthType?"Auto"===e.tableFormat.preferredWidthType||"Point"===e.tableFormat.preferredWidthType?e.tableFormat.preferredWidth:0===e.tableFormat.preferredWidth?0:x.convertPixelToPoint(this.owner.viewer.clientArea.width)/100*e.tableFormat.preferredWidth:x.convertPixelToPoint(this.documentHelper.layout.getTableWidth(e))},e.prototype.applyCellPropertyValue=function(e,t,i,r){if(sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(i=this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(r,t,i)),i instanceof Cl)return sf.base.isNullOrUndefined(t)&&this.handleCellFormat(i,r),i;"leftMargin"===t?r.leftMargin=i:"topMargin"===t?r.topMargin=i:"rightMargin"===t?r.rightMargin=i:"bottomMargin"===t?r.bottomMargin=i:"preferredWidth"===t?(r.preferredWidth=i,r.cellWidth=i):"cellWidth"===t?r.cellWidth=i:"columnSpan"===t?r.columnSpan=i:"rowSpan"===t?r.rowSpan=i:"preferredWidthType"===t?r.preferredWidthType=i:"verticalAlignment"===t&&(r.verticalAlignment=i),"shading"===t?r.shading=i:"borders"===t&&(r.borders=i)},e.prototype.handleCellFormat=function(e,t){sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(t)||(this.isBordersAndShadingDialog?(sf.base.isNullOrUndefined(e.borders)||this.applyBordersInternal(t.borders,e.borders),sf.base.isNullOrUndefined(e.shading)||this.applyShading(t.shading,e.shading)):(e.hasValue("preferredWidth")&&t.preferredWidth!==e.preferredWidth&&(t.preferredWidth=e.preferredWidth),e.hasValue("preferredWidthType")&&t.preferredWidthType!==e.preferredWidthType&&(t.preferredWidthType=e.preferredWidthType),e.hasValue("verticalAlignment")&&t.verticalAlignment!==e.verticalAlignment&&(t.verticalAlignment=e.verticalAlignment),e.hasValue("leftMargin")&&t.leftMargin!==e.leftMargin&&(t.leftMargin=e.leftMargin),e.hasValue("rightMargin")&&t.rightMargin!==e.rightMargin&&(t.rightMargin=e.rightMargin),e.hasValue("topMargin")&&t.topMargin!==e.topMargin&&(t.topMargin=e.topMargin),e.hasValue("bottomMargin")&&t.bottomMargin!==e.bottomMargin&&(t.bottomMargin=e.bottomMargin)))},e.prototype.destroy=function(){this.documentHelper=void 0,this.nodes=[],this.isCellFormatApplied=void 0,this.isCopying=void 0},e.prototype.updateToc=function(e){if(sf.base.isNullOrUndefined(e)&&(e=this.selection.getTocFieldInternal()),this.documentHelper.layout.isTocField(e)){var t=this.selection.getFieldCode(e);-1!==t.toLocaleLowerCase().indexOf("toc")&&this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(t,e)))}},e.prototype.getTocSettings=function(e,t){var i={includePageNumber:!0,rightAlign:!0};if("toc \\mergeformat"===e.toLowerCase())i.startLevel=1,i.endLevel=3;else for(var r=e.split("\\"),n=0;n<r.length;n++){var o=r[n];if(0!==o.length)switch(o[0]){case"o":if(sf.base.isNullOrUndefined(o.match(/\d+/g)))i.startLevel=1,i.endLevel=9;else{var s=o.match(/\d+/g).map(Number);i.startLevel=s[0],i.endLevel=s[1]}break;case"h":i.includeHyperlink=!0;break;case"n":i.includePageNumber=!1;break;case"p":i.rightAlign=!1;break;case"u":i.includeOutlineLevels=!0;break;case"t":this.decodeTSwitch(i,o)}}var a=t.paragraph.paragraphFormat.getUpdatedTabs();return a.length>0&&(i.tabLeader=a[a.length-1].tabLeader),i.rightAlign&&sf.base.isNullOrUndefined(i.tabLeader)&&(i.tabLeader="Dot"),i},e.prototype.decodeTSwitch=function(e,t){e.levelSettings={};for(var i=(t=(t=(t=(t=t.replace("t","")).replace('"',"")).replace('"',"")).trim()).split(","),r=0;r<i.length;r++)e.levelSettings[i[r]]=parseInt(i[r+1],10),r++},e.prototype.insertTableOfContents=function(e){this.isInsertingTOC=!0,this.initComplexHistory("TOC"),sf.base.isNullOrUndefined(e)&&((e={}).startLevel=1,e.endLevel=3,e.includeHyperlink=!0,e.includeOutlineLevels=!0,e.includePageNumber=!0,e.rightAlign=!0,e.tabLeader="Dot");var t,i=void 0;if("TableOfContents"===this.selection.contextType&&(i=this.selection.getTocFieldInternal()),i instanceof va){this.selection.start.setPositionForSelection(i.line,i,0,this.selection.start.location);var r=2;i.fieldEnd.paragraph===i.fieldEnd.paragraph.bodyWidget.lastChild&&r--,this.selection.end.setPositionForSelection(i.fieldEnd.line,i.fieldEnd,r,this.selection.end.location),this.delete()}t=this.constructTocFieldCode(e);var n=this.selection.start.isAtParagraphStart,o=this.selection.getParagraphInfo(this.selection.start),s=this.selection.getHierarchicalIndex(o.paragraph,o.offset.toString()),a=this.buildToc(this.validateTocSettings(e),t,!0,n);if(a.length>0){var l=new ca,d=new ma(l);l.childWidgets.push(d);var c=0;n||(c=1);var p=a[c].childWidgets[0].children[0];this.appendEndField(p,d),a.push(l),this.appendEmptyPara(a)}this.setPositionForCurrentIndex(this.selection.start,s),this.selection.end.setPositionInternal(this.selection.start);var g=new aa;g.sectionFormat=new h(g),g.childWidgets=a,this.pasteContentsInternal([g],!1),this.isInsertingTOC=!1,this.updatePageRef(),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal(),0===a.length&&(this.owner.editorHistory.undo(),this.owner.editorHistory.redoStack.pop())},e.prototype.appendEmptyPara=function(e){var t=new ca,i=new ma(t);t.childWidgets.push(i),e.push(t)},e.prototype.constructTocFieldCode=function(e){var t="TOC";sf.base.isNullOrUndefined(e.startLevel)||0===e.startLevel||sf.base.isNullOrUndefined(e.endLevel)||0===e.endLevel||(t=t+' \\o "'+e.startLevel+"-"+e.endLevel+'"'),e.includePageNumber&&!e.rightAlign&&(t+=' \\p " "'),e.includePageNumber||(t+=" \\n"),e.includeHyperlink&&(t+=" \\h \\z"),e.includeOutlineLevels&&(t+=" \\u");var i=this.constructTSwitch(e);return i.length>6&&(t+=i),t},e.prototype.constructTSwitch=function(e){var t="";if(!sf.base.isNullOrUndefined(e.levelSettings))for(var i=0,r=Object.keys(e.levelSettings);i<r.length;i++){var n=r[i];t=t+n+","+e.levelSettings[n].toString()+","}return t=' \\t "'+(t=t.slice(0,-1))+'"'},e.prototype.appendEndField=function(e,t){var i=new va(1);if(i.fieldSeparator=e.fieldSeparator,e.fieldSeparator.fieldEnd=i,i.fieldBegin=e,i.fieldBegin.fieldEnd=i,i.line=t,e.revisions.length>0){var r=e.revisions[e.revisions.length-1];r.range.push(i),this.owner.trackChangesPane.updateCurrentTrackChanges(r),i.revisions.push(r)}t.children.push(i)},e.prototype.validateTocSettings=function(e){return(sf.base.isNullOrUndefined(e.startLevel)||e.startLevel<1)&&(e.startLevel=1),(sf.base.isNullOrUndefined(e.endLevel)||e.endLevel<e.endLevel)&&(e.endLevel=e.startLevel>3?e.startLevel:3),sf.base.isNullOrUndefined(e.includeHyperlink)&&(e.includeHyperlink=!1),sf.base.isNullOrUndefined(e.includePageNumber)&&(e.includePageNumber=!1),sf.base.isNullOrUndefined(e.rightAlign)&&(e.rightAlign=!1),sf.base.isNullOrUndefined(e.levelSettings)&&(e.levelSettings={}),e},e.prototype.dataForTreeview=function(){var e=this.createDataSourceForTreeview(),t=[],i=1;if(!sf.base.isNullOrUndefined(e)&&e.length>0)for(var r=0;r<e.length;r++){var n=null;if("Level1"!==e[r].paragraphFormat.outlineLevel&&r>0){var o=r-1;if(e[r].paragraphFormat.outlineLevel===e[r-1].paragraphFormat.outlineLevel)n=t[o].pid;else if(Number(e[r].paragraphFormat.outlineLevel.substr(5,1))>Number(e[o].paragraphFormat.outlineLevel.substr(5,1)))n=t[o].id,t[o].hasChild=!0,t[o].expanded=!0;else for(o--;o>0;){if(Number(e[r].paragraphFormat.outlineLevel.substr(5,1))>Number(e[o].paragraphFormat.outlineLevel.substr(5,1))){n=t[o].id,t[o].hasChild=!0,t[o].expanded=!0;break}if(Number(e[r].paragraphFormat.outlineLevel.substr(5,1))===Number(e[o].paragraphFormat.outlineLevel.substr(5,1))){n=t[o].pid;break}o--}}var s=e[r].childWidgets[0],a=void 0,l=void 0,d=void 0;if(sf.base.isNullOrUndefined(s.children[3]))a=l=s.children[0].text,d="Toc00000000"+i,i++;else a=l=s.children[3].text,d=s.children[1].text;var h={pid:n,id:r+1,name:a,tooltipText:l,hyperlink:d.length>15?d.substring(15,d.length-2):d};t.push(h)}return t},e.prototype.createDataSourceForTreeview=function(){var e,t={startLevel:1,endLevel:9,includeOutlineLevels:!0,includeHyperlink:!0};return e=this.constructTocFieldCode(t),this.documentHelper.owner.editor.buildToc(this.validateTocSettings(t),e,!1,!0,!0)},e.prototype.buildToc=function(e,t,i,r,n){var o=this.documentHelper.pages[0].bodyWidgets[0],s=[];this.createHeadingLevels(e),e.includeOutlineLevels&&this.createOutlineLevels(e);for(var a=this.selection.start.paragraph.bodyWidget.sectionFormat,l=o.childWidgets[0];void 0!==l;){if(l instanceof ca&&(this.isHeadingStyle(l)||e.includeOutlineLevels&&this.isOutlineLevelStyle(l))){var d=this.insertTocBookmark(l);this.createTOCWidgets(l,s,t,d,e,i,r,a,n),i=!1}l=this.selection.getNextParagraphBlock(l.getSplitWidgets().pop())}return this.tocStyles={},s},e.prototype.createOutlineLevels=function(e){for(var t=e.startLevel;t<=e.endLevel;t++){var i="Level"+t.toString();sf.base.isNullOrUndefined(this.tocStyles[i])&&(this.tocStyles[i]=t)}},e.prototype.createHeadingLevels=function(e){for(var t=e.startLevel;t<=e.endLevel;t++){var i="Heading "+t.toString();sf.base.isNullOrUndefined(this.tocStyles[i])&&(this.tocStyles[i]=t)}if(!sf.base.isNullOrUndefined(e.levelSettings))for(var r=0,n=Object.keys(e.levelSettings);r<n.length;r++){var o=n[r];this.tocStyles[o]=e.levelSettings[o]}},e.prototype.isHeadingStyle=function(e){var t=e.paragraphFormat.baseStyle;return void 0!==t&&!sf.base.isNullOrUndefined(this.tocStyles[t.name])},e.prototype.isOutlineLevelStyle=function(e){var t=e.paragraphFormat.outlineLevel;return!sf.base.isNullOrUndefined(this.tocStyles[t])},e.prototype.createTocFieldElement=function(e,t,i){var r=new va(0);r.hasFieldEnd=!0,r.line=e,e.children.push(r);var n=new Fa;n.text=t,n.line=e,e.children.push(n);var o=new va(2);return o.fieldBegin=r,o.fieldBegin.fieldSeparator=o,o.line=e,e.children.push(o),r},e.prototype.createTOCWidgets=function(e,t,i,r,n,o,s,a,l){var d=void 0,h=void 0,c=void 0,p=!1;if(1!==t.length||3!==t[0].childWidgets[0].children.length||sf.base.isNullOrUndefined(o)||o){h=new ca;var g=void 0,f=e.paragraphFormat.baseStyle.name;g=n.includeOutlineLevels&&sf.base.isNullOrUndefined(this.tocStyles[f])?e.paragraphFormat.outlineLevel:f;var u="TOC "+this.tocStyles[g],m="Heading "+this.tocStyles[g],y=void 0;if(l?(y=this.documentHelper.styles.findByName(m,"Paragraph"),sf.base.isNullOrUndefined(y)&&(this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(m)),this.documentHelper.styles,!0),y=this.documentHelper.styles.findByName(m,"Paragraph"))):(y=this.documentHelper.styles.findByName(u,"Paragraph"),sf.base.isNullOrUndefined(y)&&(this.documentHelper.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.documentHelper.preDefinedStyles.get(u)),this.documentHelper.styles,!0),y=this.documentHelper.styles.findByName(u,"Paragraph"))),h.paragraphFormat.applyStyle(y),n.rightAlign&&n.includePageNumber){var v=new fl;v.position=a.pageWidth-(a.leftMargin+a.rightMargin),v.tabLeader=n.tabLeader,v.deletePosition=0,v.tabJustification="Right",h.paragraphFormat.tabs.push(v)}c=new ma(h),h.childWidgets.push(c)}else c=t[0].childWidgets[0];void 0!==o&&o&&(sf.base.isNullOrUndefined(s)||s||(this.appendEmptyPara(t),p=!0),this.createTocFieldElement(c,i));for(var w="",b=!1,x=e;x instanceof ca;){for(var I=0;I<x.childWidgets.length;I++)for(var F=x.childWidgets[I],C=0;C<F.children.length;C++){var W=F.children[C];if(!W.isPageBreak&&!W.isColumnBreak)if(W instanceof va||W instanceof Na||b)W instanceof va&&(0===W.fieldType?b=!0:2===W.fieldType&&(b=!1));else if(W instanceof Fa||W instanceof Va){var k=W.text;-1!==k.indexOf("\t")&&(k=k.replace(new RegExp("\t","g")," ")),w+=k}}x=x.nextSplitWidget}if(""!==w){if(n.includeHyperlink&&void 0!==r)d=this.insertTocHyperlink(c,r,w,e);else{var S=new Fa;S.text=w,S.line=c,c.children.push(S)}if(n.includePageNumber&&void 0!==r){if(n.rightAlign){var P=new Pa;P.text="\t",P.line=c,c.children.push(P)}var N=this.insertTocPageNumber(r,c,n.rightAlign,e);this.appendEndField(N,c)}n.includeHyperlink&&void 0!==d&&this.appendEndField(d,c)}if(sf.base.isNullOrUndefined(h)||""===w&&!o||t.push(h),this.owner.enableTrackChanges&&!sf.base.isNullOrUndefined(h))if(1===t.length||p)this.insertRevisionForBlock(h,"Insertion",!0);else{var O=this.owner.revisionsInternal.changes[0];this.insertRevisionForBlock(h,"Insertion",!0,O)}},e.prototype.insertTocHyperlink=function(e,t,i,r){var n=' HYPERLINK \\l "'+t+'" ',o=this.createTocFieldElement(e,n,!0),s=new Fa;s.text=i;var a=r.paragraphFormat.baseStyle.name;if(this.documentHelper.styles.findByName(a,"Paragraph").characterFormat.isEqualTocFormat(r.characterFormat)){var l=this.documentHelper.styles.findByName("Normal","Paragraph");s.characterFormat.copyTocFormat(l.characterFormat)}else s.characterFormat.copyTocFormat(r.characterFormat);return s.line=e,e.children.push(s),o},e.prototype.getPageNumber=function(e){return e.bodyWidget.sectionFormat.restartPageNumbering?e.bodyWidget.page.currentPageNum:this.documentHelper.pages.indexOf(e.bodyWidget.page)+1},e.prototype.insertTocPageNumber=function(e,t,i,r){var n=" PAGEREF"+e+" \\h ",o=this.createTocFieldElement(t,n,!0),s=this.getPageNumber(r).toString(),a=new Sa;return a.fieldBegin=o,i||(s=" "+s),a.text=s,a.line=t,t.children.push(a),this.pageRefFields[e]=a,o},e.prototype.updatePageRef=function(){for(var e=0,t=Object.keys(this.pageRefFields);e<t.length;e++){var i=t[e];if(this.documentHelper.bookmarks.containsKey(i)){var r=this.documentHelper.bookmarks.get(i),n=this.getPageNumber(r.paragraph).toString(),o=this.pageRefFields[i];if(n!==o.text){o.text=n;var s=o.paragraph,a=s.childWidgets.indexOf(o.line),l=o.line.children.indexOf(o);sf.base.isNullOrUndefined(s.containerWidget)||this.documentHelper.layout.reLayoutParagraph(s,a,l)}}}},e.prototype.insertTocBookmark=function(e){var t=void 0;if(e.childWidgets.length>0){var i=e.getSplitWidgets(),r=i[0],n=i.pop(),o=r.childWidgets[0],s=n.childWidgets[n.childWidgets.length-1];if(void 0!==o&&void 0!==s){var a=o.children[0];if(a instanceof Va||a instanceof al)do{a=a.nextNode}while(a instanceof Va||a instanceof al);if(!sf.base.isNullOrUndefined(a)&&a instanceof Na&&0===a.bookmarkType&&a.name.toLowerCase().match("^_toc"))return a.name;var l=s.children[s.children.length-1];void 0!==a&&void 0!==l&&(this.selection.start.setPositionForSelection(o,a,0,this.selection.start.location),this.selection.end.setPositionForSelection(s,l,l.length,this.selection.end.location),t=this.generateBookmarkName(),this.insertBookmark(t))}}return t},e.prototype.generateBookmarkName=function(){this.tocBookmarkId++;for(var e=10-this.tocBookmarkId.toString().length,t="";e-1>0;)t="0"+t,e--;return"_Toc"+t+this.tocBookmarkId},e.prototype.onCellContentAlignment=function(e,t){this.owner.isShiftingEnabled=!0;var i=this.owner.selection;if(i.isEmpty&&i.start.paragraph.isInsideTable){this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(i,"MultiSelection"),i.selectTableCell(),this.initHistory("CellContentVerticalAlignment");var r=i.start.paragraph.associatedCell.cellFormat;this.applyCellPropertyValue(i,"verticalAlignment",e,r),this.reLayout(i,!1),this.initHistory("TextAlignment"),this.updateParagraphFormat("textAlignment",t,!1),this.reLayout(this.owner.selection,!1),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()}else this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(i,"MultiSelection"),sf.base.isNullOrUndefined(i.getTable(i.start,i.end))||(this.updateSelectionTableFormat(i,"CellContentVerticalAlignment",e),this.reLayout(this.owner.selection,!1),this.initHistory("TextAlignment"),this.updateSelectionParagraphFormatting("textAlignment",t,!1),this.reLayout(i,!1)),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()},e.prototype.insertEditRangeElement=function(e){if(!this.documentHelper.isDocumentProtected&&!this.documentHelper.selection.isEmpty){this.initComplexHistory("RestrictEditing"),this.selection.skipEditRangeRetrieval=!0;var t=this.documentHelper.selection;this.selection.start,this.selection.end;if(this.selection.isForward||(this.selection.end,this.selection.start),t.start.paragraph.isInsideTable&&t.end.paragraph.isInsideTable&&t.start.paragraph.associatedCell.ownerTable.contains(t.end.paragraph.associatedCell)){var i=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward);if(i.rowIndex===r.rowIndex){for(var n=i.ownerRow.childWidgets.indexOf(i),o=i.ownerRow.childWidgets.indexOf(r),s=[],a=[],l=n;l<=o;l++){var d=this.addEditElement(e);l==n&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=d),d.columnFirst=l,d.columnLast=l,d.line=t.start.currentWidget;var h=d.editRangeEnd;h.line=t.end.currentWidget,s.push(d),a.push(h)}this.insertElements(a,s),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var c=s[0].line.getOffset(s[0],1);this.selection.start.setPositionParagraph(s[0].line,c),c=a[0].line.getOffset(a[0],1),this.selection.end.setPositionParagraph(a[0].line,c),this.selection.fireSelectionChanged(!0),this.fireContentChange()}else{this.insertEditRangeInsideTable(i,r,e),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var p=this.documentHelper.getFirstParagraphInCell(i).childWidgets[0],g=this.selection.getLastParagraph(r).childWidgets[0];c=p.getOffset(p.children[0],1);this.selection.start.setPositionParagraph(p,c),c=g.getOffset(g.children[0],1),this.selection.end.setPositionParagraph(g,c),this.selection.fireSelectionChanged(!0),this.fireContentChange()}}else this.addRestrictEditingForSelectedArea(e);this.selection.skipEditRangeRetrieval=!1}},e.prototype.insertEditRangeInsideTable=function(e,t,i){var r=e.ownerTable,n=r.childWidgets.indexOf(t.ownerRow),o=r.childWidgets.indexOf(e.ownerRow),s=this.selection.getCellLeft(e.ownerRow,e),a=s+e.cellFormat.cellWidth,l=this.selection.getCellLeft(t.ownerRow,t),d=l+t.cellFormat.cellWidth,h=this.updateSelectedCellsInTable(s,a,l,d);s=h.start,a=h.end;for(var c=[],p=o;p<=n;p++){for(var g=r.childWidgets[p],f=-1,u=-1,m=0;m<g.childWidgets.length;m++){var y=g.childWidgets[m],v=this.selection.getCellLeft(g,y);this.checkCellWithInSelection(s,a,v)&&(-1===f&&(f=m),u=m)}for(var w=[],b=f;b<=u;b++){var x=0,I=void 0,F=void 0;b===f&&(I=g.childWidgets[f],F=this.documentHelper.getFirstParagraphInCell(I).childWidgets[0]);var C=this.addEditElement(i);b===f&&this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=C),C.columnFirst=b,C.columnLast=b,C.line=F,C.line.children.splice(x,0,C),x++;var W=C.editRangeEnd;if(w.push(W),c.length>0&&b===u){for(var k=0;k<c.length;k++)c[k].line=C.line,C.line.children.splice(x,0,c[k]),x++;c=[]}}if(c=w,p===n&&c.length>0){var S=g.childWidgets[u],P=this.selection.getLastParagraph(S).lastChild;for(x=P.children.length-1,k=0;k<c.length;k++)c[k].line=P,P.children.splice(x,0,c[k]),x++}}},e.prototype.addRestrictEditingForSelectedArea=function(e){var t=this.addEditElement(e),i=t.editRangeEnd;this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.editRangeStart=t),this.owner.isShiftingEnabled=!0,this.insertElements([i],[t]),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal();var r=t.line.getOffset(t,1);this.selection.start.setPositionParagraph(t.line,r),r=i.line.getOffset(i,1),this.selection.end.setPositionParagraph(i.line,r);var n=this.documentHelper.blockToShift;if(!sf.base.isNullOrUndefined(n)&&this.viewer instanceof Qs&&n.bodyWidget.sectionFormat.columns.length>1){var o=this.documentHelper.layout.getBodyWidget(n.bodyWidget,!1);sf.base.isNullOrUndefined(o.nextRenderedWidget)||"NoBreak"!==o.nextRenderedWidget.sectionFormat.breakCode||o.page!==o.nextRenderedWidget.page||this.reLayout(this.selection)}this.owner.isShiftingEnabled=!1,this.selection.fireSelectionChanged(!0),this.fireContentChange()},e.prototype.addEditElement=function(e){var t=new _a;"everyone"===e.toLocaleLowerCase()?t.group=e:t.user=e;var i=new qa;return i.editRangeStart=t,t.editRangeEnd=i,this.editStartRangeCollection.push(t),this.addEditCollectionToDocument(),this.editStartRangeCollection=[],t},e.prototype.protect=function(e){this.documentHelper.isDocumentProtected=!0,this.documentHelper.protectionType=e,this.selection.highlightEditRegion(),this.editorHistory&&this.editorHistory.destroy()},e.prototype.addEditCollectionToDocument=function(){for(var e=0;e<this.editStartRangeCollection.length;e++){var t=this.editStartRangeCollection[e],i=""===t.user?t.group:t.user;if(this.documentHelper.editRanges.length>0&&this.documentHelper.editRanges.containsKey(i))this.documentHelper.editRanges.get(i).push(t);else{var r=[];r.push(t),this.documentHelper.editRanges.add(i,r)}}this.selection.updateEditRangeCollection()},e.prototype.updateRangeCollection=function(e,t){if(this.documentHelper.editRanges.length>0&&this.documentHelper.editRanges.containsKey(t))this.documentHelper.editRanges.get(t).push(e);else{var i=[];i.push(e),this.documentHelper.editRanges.add(t,i)}},e.prototype.removeUserRestrictions=function(e){if(this.selection.checkSelectionIsAtEditRegion()){this.selection.skipEditRangeRetrieval=!0;var t=this.selection.getEditRangeStartElement();this.initHistory("RemoveEditRange"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setEditRangeInfo(t),this.editorHistory.updateHistory()),t.user!==e&&t.group!==e||this.removeUserRestrictionsInternal(t,e),this.selection.updateEditRangeCollection(),this.fireContentChange(),this.selection.skipEditRangeRetrieval=!1}},e.prototype.removeUserRestrictionsInternal=function(e,t){var i=t;sf.base.isNullOrUndefined(t)&&(i=""===e.user?e.group:e.user);var r=this.documentHelper.editRanges.get(i).indexOf(e);if(this.documentHelper.editRanges.get(i).splice(r,1),0===this.documentHelper.editRanges.get(i).length&&this.documentHelper.editRanges.remove(i),-1!=e.columnFirst&&-1!=e.columnLast){var n=e.paragraph.associatedCell.ownerRow;if(n.editRangeID.containsKey(e.editRangeId)){var o=n.getCellUsingColumnIndex(n.rowIndex,e.columnFirst);sf.base.isNullOrUndefined(o)||o.isRenderEditRangeStart&&o.isRenderEditRangeEnd&&(o.isRenderEditRangeEnd=!1,o.isRenderEditRangeStart=!1,n.editRangeID.remove(e.editRangeId))}else for(var s=e.paragraph.associatedCell.ownerTable,a=n.rowIndex-1;a>=0;a--){var l=s.childWidgets[a];if(l.editRangeID.containsKey(e.editRangeId)){var d=l.getCellUsingColumnIndex(l.rowIndex,e.columnFirst);if(!sf.base.isNullOrUndefined(d)&&d.isRenderEditRangeStart&&d.isRenderEditRangeEnd){d.isRenderEditRangeEnd=!1,d.isRenderEditRangeStart=!1,l.editRangeID.remove(e.editRangeId);break}}}}e.removeEditRangeMark(),e.editRangeEnd.line.children.splice(e.editRangeEnd.indexInOwner,1),e.line.children.splice(e.indexInOwner,1)},e.prototype.removeAllEditRestrictions=function(){this.selection.skipEditRangeRetrieval=!0;for(var e=this.selection.start,t=this.selection.end,i=[],r=this.documentHelper.editRanges.keys,n=0;n<r.length;n++){i=this.documentHelper.editRanges.get(r[n]);for(var o=0;o<i.length;o++)i[o].editRangeEnd.line.children.splice(i[o].editRangeEnd.indexInOwner,1),i[o].line.children.splice(i[o].indexInOwner,1)}this.documentHelper.editRanges.clear(),this.selection.updateEditRangeCollection(),this.selection.start.setPositionInternal(e),this.selection.end.setPositionInternal(t),this.selection.editRegionHighlighters.clear(),this.owner.viewer.updateScrollBars(),this.selection.fireSelectionChanged(!1),this.selection.skipEditRangeRetrieval=!1},e.prototype.insertFormField=function(e){if(!sf.base.isNullOrUndefined(this.selection.start)&&!this.owner.enableHeaderAndFooter){this.initHistory("InsertHyperlink");var t=!0;this.selection.isEmpty||(t=this.removeSelectedContents(this.selection)),t&&this.insertFormFieldInternal(e)}},e.prototype.insertFormFieldInternal=function(e){this.updateInsertPosition();var t=[],i=this.getCharacterFormat(this.selection),r=new T(void 0);r.copyFormat(i);var n=new va(0);n.formFieldData=this.getFormFieldData(e),n.characterFormat.copyFormat(r),t.push(n);var o=new Na(0);o.characterFormat.copyFormat(r),n.formFieldData.name=this.getBookmarkName(e,"Insert",this.formFieldCounter),o.name=n.formFieldData.name,t.push(o);var s=new Fa;s.text=this.getFormFieldCode(e),t.push(s);var a=new va(2);t.push(a);var l=new Fa;l.text="CheckBox"===e?String.fromCharCode(9744):this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),l.characterFormat.copyFormat(r),t.push(l);var d=new va(1);d.characterFormat.copyFormat(r),t.push(d);var h=new Na(1);h.characterFormat.copyFormat(r),h.name=n.formFieldData.name,h.reference=o,o.reference=h,t.push(h),this.documentHelper.layout.isInsertFormField=!0,this.insertElement(t),this.documentHelper.layout.isInsertFormField=!1;this.selection.start.paragraph;d.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(n)&&this.documentHelper.fields.push(n),this.addFormFieldWidget(n);var c=h.line.getOffset(h,1);this.selection.selects(h.line,c,!0),this.updateEndPosition(),this.reLayout(this.selection,!0)},e.prototype.addFormFieldWidget=function(e){if(-1===this.documentHelper.formFields.indexOf(e)){var t=!1;if(this.documentHelper.formFields.length>0)for(var i=this.selection.getElementPosition(e).startPosition,r=0;r<this.documentHelper.formFields.length;r++){var n=this.selection.getElementPosition(this.documentHelper.formFields[r]).startPosition;if(i.isExistBefore(n)){t=!0,this.documentHelper.formFields.splice(r,0,e);break}}t||this.documentHelper.formFields.push(e)}},e.prototype.getFormFieldData=function(e){switch(e){case"Text":return new ba;case"CheckBox":return new xa;case"DropDown":return new Ia}},e.prototype.setFormField=function(e,t){var i,r;sf.base.isNullOrUndefined(t.format)?sf.base.isNullOrUndefined(t.sizeType)?sf.base.isNullOrUndefined(t.dropdownItems)||(i="DropDown",r=new Ia):(i="CheckBox",r=new xa):(i="Text",r=new ba),sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(r)||(r.name=sf.base.isNullOrUndefined(t.name)?e.formFieldData.name:t.name,r.copyFieldInfo(t),this.editFormField(i,r))},e.prototype.editFormField=function(e,t){var i,r,n=this.selection.getCurrentFormField();if(sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.formFieldData))return!1;this.initComplexHistory("FormField"),""!==t.name&&(n.formFieldData.name!==t.name&&this.documentHelper.bookmarks.containsKey(t.name)&&this.deleteBookmark(t.name),(i=new Na(0)).name=t.name,(r=new Na(1)).name=t.name,i.reference=r,r.reference=i),this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=sf.base.isNullOrUndefined(this.editorHistory)||this.editorHistory&&sf.base.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo);var o=n.characterFormat.cloneFormat(),s=new T;s.copyFormat(o);var a=n.fieldSeparator.nextElement.characterFormat.cloneFormat(),l=n.line.getOffset(n,0);this.selection.start.setPositionParagraph(n.line,l);var d=n.fieldEnd;n.nextNode&&n.nextNode instanceof Na&&(d=n.nextNode.reference),l=d.line.getOffset(d,1),this.selection.end.setPositionParagraph(d.line,l),this.skipFieldDeleteTracking=!0,this.deleteSelectedContents(this.selection,!1),this.skipFieldDeleteTracking=!1,this.updateInsertPosition();var h=[],c=new va(0);c.formFieldData=t,h.push(c),c.characterFormat.copyFormat(s),sf.base.isNullOrUndefined(i)||h.push(i);var p=new Fa;p.text=this.getFormFieldCode(e),h.push(p);var g=new va(2);g.characterFormat.copyFormat(s),h.push(g),(p=new Fa).characterFormat.copyFormat(a),p.text=this.getDefaultText(t),"CheckBox"===e?(p.characterFormat.copyFormat(c.characterFormat),"Exactly"===t.sizeType&&(p.characterFormat.fontSize=t.size)):t instanceof ba&&""!==t.defaultValue&&("Text"===t.type?p.text=x.formatText(t.format,t.defaultValue):"Number"===t.type?p.text=x.formatNumber(t.format,t.defaultValue):p.text=x.formatDate(t.format,t.defaultValue)),h.push(p);var f=new va(1);f.characterFormat.copyFormat(s),h.push(f);var u=f;sf.base.isNullOrUndefined(r)||(u=r,h.push(r)),this.documentHelper.layout.isInsertFormField=!0,this.insertElement(h),this.documentHelper.layout.isInsertFormField=!1;this.selection.start.paragraph;f.linkFieldCharacter(this.documentHelper),-1===this.documentHelper.fields.indexOf(c)&&this.documentHelper.fields.push(c),this.addFormFieldWidget(c);var m=u.line.getOffset(u,1);return this.selection.selects(u.line,m,!0),this.updateEndPosition(),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.updateHistory(),this.editorHistory&&this.editorHistory.currentHistoryInfo&&this.editorHistory.updateComplexHistory(),this.reLayout(this.selection,!0),this.editHyperlinkInternal=!1,this.nodes=[],!0},e.prototype.getDefaultText=function(e){var t="";return e instanceof xa?t=e.defaultValue?String.fromCharCode(9745):String.fromCharCode(9744):e instanceof Ia?t=e.dropdownItems.length>0?e.dropdownItems[0]:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5):e instanceof ba&&(t=""!==e.defaultValue?e.defaultValue:this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5)),t},e.prototype.getFormFieldCode=function(e){switch(e){case"Text":return"FORMTEXT";case"CheckBox":return"FORMCHECKBOX";case"DropDown":return"FORMDROPDOWN"}},e.prototype.toggleCheckBoxFormField=function(e,t,i){var r=e.formFieldData;if(r instanceof xa&&r.enabled){if(this.initHistory("UpdateFormField"),this.editorHistory){var n=void 0;r instanceof xa&&(n=r.checked),this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(e,n),this.editorHistory.updateHistory()}r.checked=t?i:!r.checked;var o=e.fieldSeparator.nextNode;r.checked?o.text=String.fromCharCode(9745):o.text=String.fromCharCode(9744),this.owner.documentHelper.layout.reLayoutParagraph(e.line.paragraph,0,0),this.reLayout(this.selection,!1)}},e.prototype.updateFormField=function(e,t,i){var r=e.formFieldData;r&&this.updateFormFieldInternal(e,r,t,i)},e.prototype.updateFormFieldInternal=function(e,t,i,r){if(t instanceof ba){""===i&&(i=r?this.getDefaultText(t):this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5));var n=i;"Text"===t.type&&""!==t.format&&(n=x.formatText(t.format,i)),this.updateFormFieldResult(e,n)}else if(t instanceof Ia){var o=t.dropdownItems[i];t.selectedIndex=i,this.updateFormFieldResult(e,o)}var s=e.fieldEnd.line.getOffset(e.fieldEnd,1),a=new Al(this.owner);a.setPositionParagraph(e.fieldEnd.line,s),this.documentHelper.selection.selectRange(a,a),this.reLayout(this.selection,!1)},e.prototype.updateFormFieldResult=function(e,t){this.selection.selectFieldInternal(e,!1,!0),this.insertText(t)},e.prototype.checkBookmarkAvailability=function(e,t){for(var i=this.documentHelper.bookmarks,r=0;r<i.length;r++)if(i.containsKey(e))return!1;return!0},e.prototype.getBookmarkName=function(e,t,i){for(var r,n=!1;!1===n;)r=e+i,n=this.checkBookmarkAvailability(r,t),i+=1;return r},e.prototype.applyFormTextFormat=function(e){if(!sf.base.isNullOrUndefined(e)){var t=this.getFieldResultText(e),i=t;t=x.formatText(e.formFieldData.format,t),null!=e.fieldSeparator&&this.applyTextFormatInternal(e,t),this.initHistory("FormTextFormat"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setFormFieldInfo(e,i),this.editorHistory.updateHistory())}},e.prototype.insertSpaceInFormField=function(){if(this.documentHelper.isInlineFormFillProtectedMode&&this.selection.isInlineFormFillMode()){var e=this.getFieldResultText();0!==e.length&&"\r"!==e||(this.insertTextInternal(this.documentHelper.textHelper.repeatChar(this.documentHelper.textHelper.getEnSpaceCharacter(),5),!0),this.selection.selectTextElementStartOfField(this.selection.getCurrentFormField()))}},e.prototype.getFieldResultText=function(e){sf.base.isNullOrUndefined(e)&&(e=this.selection.getCurrentFormField());var t=this.selection.startOffset,i=this.selection.endOffset;this.selection.isModifyingSelectionInternally=!0,this.selection.selectFieldInternal(e,!1,!0);var r=this.selection.getText(!1);return this.selection.select(t,i),this.selection.isModifyingSelectionInternally=!1,r},e.prototype.applyTextFormatInternal=function(e,t){var i=e.fieldSeparator.nextElement,r=0;t=t.replace(/\r/g,"");do{if(!sf.base.isNullOrUndefined(i)&&i instanceof Fa&&(i.text=t.slice(r,r+i.text.length),r+=i.length),sf.base.isNullOrUndefined(i.nextElement))if(sf.base.isNullOrUndefined(i.line.nextLine)){this.documentHelper.layout.layoutBodyWidgetCollection(i.paragraph.index,i.paragraph.bodyWidget,i.paragraph,!0);var n=i.paragraph.nextRenderedWidget;if(sf.base.isNullOrUndefined(n))break;for(n instanceof ga&&(n=this.documentHelper.getFirstParagraphBlock(n));n.isEmpty();)n=n.nextRenderedWidget;i=n.childWidgets[0].children[0]}else i=i.line.nextLine.children[0];else i=i.nextElement}while(!(i instanceof va&&1===i.fieldType&&i.fieldBegin.formFieldData instanceof ba));this.documentHelper.layout.layoutBodyWidgetCollection(i.paragraph.index,i.paragraph.bodyWidget,i.paragraph,!0),this.selection.isFormatUpdated=!0,this.reLayout(this.selection,!1),this.selection.isFormatUpdated=!1},e.prototype.constructCommentInitial=function(e){for(var t=e.split(" "),i="",r=0;r<t.length;r++)t[r].length>0&&""!==t[r]&&(i+=t[r][0]);return i},e.prototype.insertFootnote=function(){if(!this.selection.isinFootnote&&!this.selection.isinEndnote){this.isFootNoteInsert=!0,this.isFootNote=!0;var e=new Wa;e.characterFormat.baselineAlignment="Superscript",e.footnoteType="Footnote",e.text="s";var t=new ca,i=new ma(t),r=new Fa;t.paragraphFormat.afterSpacing=0,r.characterFormat.baselineAlignment="Superscript",r.line=i,r.text="?",i.children.push(r);var n,o=new Fa;if(o.text=" ",o.line=i,i.children.push(o),t.childWidgets.push(i),e.bodyWidget.childWidgets.push(t),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(e),e.paragraph.bodyWidget.page.footnoteWidget)for(var s=0;s<e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets.length;s++)e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets[s].footNoteReference===e&&(n=e.paragraph.bodyWidget.page.footnoteWidget.bodyWidgets[s].childWidgets[0]);this.selection.start.setPositionForLineWidget(n.childWidgets[0],o.line.getOffset(o,e.text.length)),this.selection.end.setPositionInternal(this.selection.start),this.updateFootNoteIndex(),this.reLayout(this.selection,!1),this.separator("footnote"),this.continuationSeparator("footnote"),this.isFootNote=!1,this.isFootNoteInsert=!1}},e.prototype.updateFootnoteCollection=function(e){if(-1===this.documentHelper.footnoteCollection.indexOf(e)){var t=!1;if(this.documentHelper.footnoteCollection.length>0)for(var i=this.selection.getElementPosition(e).startPosition,r=0;r<this.documentHelper.footnoteCollection.length;r++){var n=this.selection.getElementPosition(this.documentHelper.footnoteCollection[r]).startPosition;if(i.isExistBefore(n)){t=!0,this.documentHelper.footnoteCollection.splice(r,0,e);break}}t||this.documentHelper.footnoteCollection.push(e)}},e.prototype.insertEndnote=function(){if(!this.selection.isinFootnote&&!this.selection.isinEndnote){this.documentHelper.layout.isEndnoteContentChanged=!0;var e=new Wa;e.characterFormat.baselineAlignment="Superscript",e.footnoteType="Endnote",e.text="s";var t=new ca,i=new ma(t),r=new Fa;t.paragraphFormat.afterSpacing=0,r.characterFormat.baselineAlignment="Superscript",r.line=i,r.text="?",i.children.push(r);var n=new Fa;n.text=" ",n.line=i,i.children.push(n),t.childWidgets.push(i),e.bodyWidget.childWidgets.push(t),this.selection.isEmpty||this.selection.handleRightKey(),this.initInsertInline(e);var o,s=this.documentHelper.pages.length,a=this.documentHelper.pages[s-1].bodyWidgets[0];if(a.page.endnoteWidget)for(var l=0;l<a.page.endnoteWidget.bodyWidgets.length;l++)a.page.endnoteWidget.bodyWidgets[l].footNoteReference===e&&(o=a.page.endnoteWidget.bodyWidgets[l].childWidgets[0]);this.selection.start.setPositionForLineWidget(o.childWidgets[0],r.line.getOffset(n,e.text.length)),this.selection.end.setPositionInternal(this.selection.start),this.updateEndNoteIndex(),this.documentHelper.layout.isLayoutWhole=!0,this.layoutWholeDocument(),this.documentHelper.layout.isLayoutWhole=!1,this.reLayout(this.selection,!1),this.owner.focusIn(),this.owner.documentHelper.blockToShift=void 0,this.separator("endnote"),this.continuationSeparator("endnote"),this.documentHelper.layout.isEndnoteContentChanged=!1}},e.prototype.updateEndnoteCollection=function(e){if(-1===this.documentHelper.endnoteCollection.indexOf(e)){var t=!1;if(this.documentHelper.endnoteCollection.length>0)for(var i=this.selection.getElementPosition(e).startPosition,r=0;r<this.documentHelper.endnoteCollection.length;r++){var n=this.selection.getElementPosition(this.documentHelper.endnoteCollection[r]).startPosition;if(i.isExistBefore(n)){t=!0,this.documentHelper.endnoteCollection.splice(r,0,e);break}}t||this.documentHelper.endnoteCollection.push(e);var o=this.documentHelper.pages.length;if(this.documentHelper.endnoteCollection.length>0){var s,a=!1,l=void 0,d=this.documentHelper.endnoteCollection.indexOf(e),h=1,c=void 0,p=this.documentHelper.pages[o-1].bodyWidgets[0];if(p.page.endnoteWidget)for(var g=0;g<p.page.endnoteWidget.bodyWidgets.length;g++){var f=this.documentHelper.endnoteCollection.indexOf(p.page.endnoteWidget.bodyWidgets[g].footNoteReference);if(f>d&&f-d==1){h=g,a=!0;break}}if(s=e,p.page.endnoteWidget instanceof ha&&"Endnote"===p.page.endnoteWidget.footNoteType)l=p.page.endnoteWidget;else{c=!0,(l=new ha).footNoteType="Endnote",l.page=p.page;var u=new ca;u.characterFormat=new T,u.paragraphFormat=new ul,u.index=0;var m=new ma(u);u.childWidgets.push(m),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+18)}var y=s.bodyWidget;for(g=0;g<s.bodyWidget.childWidgets.length;g++){var v=s.bodyWidget.childWidgets[g];this.documentHelper.layout.isLayoutWhole?v.containerWidget=void 0:(v.containerWidget=y,y.page=p.page,y.sectionFormat=l.sectionFormat,v.containerWidget.containerWidget=l),a?l.bodyWidgets.splice(h,0,y):l.bodyWidgets.push(y)}h++,c&&(p.page.endnoteWidget=l),l.height+=0}}},e.prototype.updateEndNoteIndex=function(){for(var e=this.documentHelper.endnoteCollection,t=0;t<e.length;t++)e[t].text=this.documentHelper.layout.getFootEndNote(e[t].paragraph.bodyWidget.sectionFormat.endnoteNumberFormat,t+1),sf.base.isNullOrUndefined(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0])||(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0].text=e[t].text)},e.prototype.separator=function(e){var t=new ca,i=new ma(t),r=new Fa;r.characterFormat.fontColor="#00000000",r.line=i,r.text=String.fromCharCode(3),i.children.push(r),t.childWidgets.push(i),"footnote"===e&&this.documentHelper.footnotes.separator.length<1?this.documentHelper.footnotes.separator.push(t):"endnote"===e&&this.documentHelper.endnotes.separator.length<1&&this.documentHelper.endnotes.separator.push(t)},e.prototype.continuationSeparator=function(e){var t=new ca,i=new ma(t),r=new Fa;r.characterFormat.fontColor="#00000000",r.line=i,r.text=String.fromCharCode(4),i.children.push(r),t.childWidgets.push(i),"footnote"===e&&this.documentHelper.footnotes.continuationSeparator.length<1?this.documentHelper.footnotes.continuationSeparator.push(t):"endnote"===e&&this.documentHelper.endnotes.continuationSeparator.length<1&&this.documentHelper.endnotes.continuationSeparator.push(t)},e.prototype.updateFootNoteIndex=function(){for(var e=this.documentHelper.footnoteCollection,t=0;t<e.length;t++)e[t].text=(t+1).toString(),sf.base.isNullOrUndefined(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0])||(e[t].bodyWidget.childWidgets[0].childWidgets[0].children[0].text=(t+1).toString())},e.prototype.onParagraphFormat=function(e){var t=this.documentHelper.selection,i=e.bidi&&-1!==t.paragraphFormat.listId;i||(this.documentHelper.layout.isBidiReLayout=!0),this.setPreviousBlockToLayout(),this.initHistory("ParagraphFormat"),this.documentHelper.owner.isShiftingEnabled=!0,this.documentHelper.selection.isEmpty?(this.applyParaFormatProperty(t.start.paragraph,void 0,e,!1),this.layoutItemBlock(t.start.paragraph,!1)):this.updateSelectionParagraphFormatting("ParagraphFormat",e,!1),this.reLayout(t),i||(this.documentHelper.layout.isBidiReLayout=!1)},e.prototype.clear=function(){this.pageRefFields&&(this.pageRefFields={})},e}(),cd=function(){function e(e,t){this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.topLeftRectParent=void 0,this.topMiddleRectParent=void 0,this.topRightRectParent=void 0,this.bottomLeftRectParent=void 0,this.bottomMiddleRectParent=void 0,this.bottomRightRectParent=void 0,this.leftMiddleRectParent=void 0,this.rightMiddleRectParent=void 0,this.resizeMarkSizeIn=7,this.selectedImageWidget=void 0,this.baseHistoryInfo=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.isImageMoveToNextPage=!1,this.selectedResizeElement=void 0,this.topValue=void 0,this.leftValue=void 0,this.owner=e,this.selectedImageWidget=new a,this.documentHelper=t,this.imageResizerPoints=new pd,sf.base.isNullOrUndefined(this.imageResizerDiv)&&this.viewer&&this.documentHelper.pageContainer&&this.initializeImageResizer()}return Object.defineProperty(e.prototype,"currentImageElementBox",{get:function(){return this.currentImageElementBoxIn},set:function(e){this.currentImageElementBoxIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resizeMarkSize",{get:function(){return this.resizeMarkSizeIn},set:function(e){this.resizeMarkSizeIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShapeResize",{get:function(){return this.currentImageElementBox instanceof La},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"ImageResizer"},e.prototype.setImageResizerPositions=function(e,t,i,r){this.imageResizerDivElement.style.top=t.toString()+"px",this.imageResizerDivElement.style.left=e.toString()+"px",this.imageResizerDivElement.style.borderWidth="0px",this.imageResizerDivElement.style.height=r+"px",this.owner.viewer instanceof $s?this.imageResizerDivElement.style.width=i-e-this.documentHelper.scrollbarWidth+"px":this.imageResizerDivElement.style.width=i+"px",this.imageResizerDivElement.style.backgroundColor="transparent",this.imageResizerDivElement.style.overflow="hidden",this.imageResizerDivElement.style.position="absolute"},e.prototype.initializeImageResizer=function(){this.imageResizerDivElement=document.createElement("div"),this.imageResizerDivElement.style.zIndex="1",this.imageResizerDivElement.style.display="none",this.documentHelper.pageContainer.appendChild(this.imageResizerDivElement)},e.prototype.positionImageResizer=function(e){var t;this.selectedImageWidget.clear(),sf.base.isNullOrUndefined(this.documentHelper.currentPage)||(t=this.imageResizerDivElement),sf.base.isNullOrUndefined(t)||t.contains(this.imageResizerDiv)||(this.imageResizerDiv=this.initResizeMarks(t,this)),this.imageResizerDiv.style.width=e.width+"px",this.imageResizerDiv.style.height=e.height+"px",this.currentImageElementBox=e;var i,r,n=e.line;e instanceof Da&&"Inline"!==e.textWrappingStyle?(i=e.y,r=e.x):(i=this.documentHelper.selection.getTop(n)+e.margin.top,r=this.documentHelper.selection.getLeftInternal(n,e,0));var o=this.documentHelper.selection.getPage(n.paragraph);this.currentPage=o;sf.base.isNullOrUndefined(t)||(this.owner.viewer instanceof $s&&(this.imageResizerDivElement.style.width=o.boundingRectangle.width-o.boundingRectangle.x-r-this.documentHelper.scrollbarWidth+"px"),this.imageResizerDivElement.style.display="block",this.owner.viewer instanceof $s?t.style.width=o.boundingRectangle.width-this.documentHelper.scrollbarWidth-o.boundingRectangle.x-r+"px":t.style.width=o.boundingRectangle.width+"px",t.style.height=o.boundingRectangle.height+"px",t.style.left=o.boundingRectangle.x+"px",t.style.top=o.boundingRectangle.y+"px",t.style.borderWidth="0px",t.style.backgroundColor="transparent",t.style.overflow="hidden",t.style.position="absolute");var s,a=this.documentHelper.getPageWidth(o);s=parseFloat(this.imageResizerDivElement.style.width),this.documentHelper.visibleBounds.width,this.documentHelper.zoomFactor,a<s&&this.documentHelper.zoomFactor;var l=this.imageResizerDivElement,d=parseFloat(l.style.width),h=parseFloat(l.style.height),c=parseFloat(this.imageResizerDiv.style.width),p=parseFloat(this.imageResizerDiv.style.height),g=(this.resizeMarkSize-1)/2,f=c+2*g,u=p+2*g;if(f>(d-r)*this.documentHelper.zoomFactor+g&&(f=(d-r)*this.documentHelper.zoomFactor),u>(h-i)*this.documentHelper.zoomFactor+g&&(u=(h-i)*this.documentHelper.zoomFactor),this.imageResizerDivElement.style.width=parseInt(this.imageResizerDivElement.style.width.replace("px",""),10)*this.documentHelper.zoomFactor+"px",this.imageResizerDivElement.style.height=parseInt(this.imageResizerDivElement.style.height.replace("px",""),10)*this.documentHelper.zoomFactor+"px",u=this.documentHelper.render.getScaledValue(e.height),f=this.documentHelper.render.getScaledValue(e.width),e instanceof Da?(r=this.documentHelper.render.getScaledValue(r),i=this.documentHelper.render.getScaledValue(i)):(r=e.x*this.documentHelper.zoomFactor,i=e.y*this.documentHelper.zoomFactor),this.setImageResizerPosition(r,i,f,u,this),this.owner.selection.isInShape?this.resizeContainerDiv.style.borderStyle="dashed":this.resizeContainerDiv.style.borderStyle="solid",!this.selectedImageWidget.containsKey(n)){var m=new gd(e.height,e.width);this.selectedImageWidget.add(n,m)}},e.prototype.showImageResizer=function(){sf.base.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display=""),sf.base.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display=""),sf.base.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.style.display="",this.bottomLeftRectParent.style.display=""),sf.base.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.style.display="",this.bottomRightRectParent.style.display=""),sf.base.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="",this.bottomMiddleRectParent.style.display=""),sf.base.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.style.display="",this.rightMiddleRectParent.style.display=""),sf.base.isNullOrUndefined(this.topRightRect)||(this.topRightRect.style.display="",this.topRightRectParent.style.display=""),sf.base.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.style.display="",this.topLeftRectParent.style.display=""),sf.base.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.style.display="",this.leftMiddleRectParent.style.display=""),sf.base.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.style.display="",this.topMiddleRectParent.style.display=""),this.isImageResizerVisible=!0},e.prototype.hideImageResizer=function(){sf.base.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display="none"),sf.base.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display="none"),sf.base.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.style.display="none",this.bottomLeftRectParent.style.display="none"),sf.base.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.style.display="none",this.bottomRightRectParent.style.display="none"),sf.base.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="none",this.bottomMiddleRectParent.style.display="none"),sf.base.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.style.display="none",this.rightMiddleRectParent.style.display="none"),sf.base.isNullOrUndefined(this.topRightRect)||(this.topRightRect.style.display="none",this.topRightRectParent.style.display="none"),sf.base.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.style.display="none",this.topLeftRectParent.style.display="none"),sf.base.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.style.display="none",this.leftMiddleRectParent.style.display="none"),sf.base.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.style.display="none",this.topMiddleRectParent.style.display="none"),this.isImageResizerVisible=!1,this.currentPage=void 0},e.prototype.initResizeMarks=function(e,t){return this.initResizeContainerDiv(t),e.appendChild(t.resizeContainerDiv),t.topRightRectParent=document.createElement("div"),t.topRightRectParent.style.cursor="ne-resize",t.topRightRectParent.id=this.documentHelper.owner.containerId+"_TopRightRectParent",this.applyProperties(t.topRightRectParent),t.topRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topRightRectParent.style.opacity="-1",e.appendChild(t.topRightRectParent),t.topRightRect=document.createElement("div"),t.topRightRect.id=this.documentHelper.owner.containerId+"_TopRightRect",t.topRightRect.style.cursor="ne-resize",this.applyProperties(t.topRightRect),e.appendChild(t.topRightRect),t.topLeftRectParent=document.createElement("div"),t.topLeftRectParent.style.cursor="nw-resize",t.topLeftRectParent.id=this.documentHelper.owner.containerId+"_TopLeftRectParent",this.applyProperties(t.topLeftRectParent),t.topLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topLeftRectParent.style.opacity="-1",e.appendChild(t.topLeftRectParent),t.topLeftRect=document.createElement("div"),t.topLeftRect.id=this.documentHelper.owner.containerId+"_TopLeftRect",t.topLeftRect.style.cursor="nw-resize",this.applyProperties(t.topLeftRect),e.appendChild(t.topLeftRect),t.topMiddleRectParent=document.createElement("div"),t.topMiddleRectParent.style.cursor="n-resize",t.topMiddleRectParent.id=this.documentHelper.owner.containerId+"_TopMiddleRectParent",this.applyProperties(t.topMiddleRectParent),t.topMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.opacity="-1",e.appendChild(t.topMiddleRectParent),t.topMiddleRect=document.createElement("div"),t.topMiddleRect.id=this.documentHelper.owner.containerId+"_TopMiddleRect",t.topMiddleRect.style.cursor="n-resize",this.applyProperties(t.topMiddleRect),e.appendChild(t.topMiddleRect),t.bottomRightRectParent=document.createElement("div"),t.bottomRightRectParent.style.cursor="se-resize",t.bottomRightRectParent.id=this.documentHelper.owner.containerId+"_BottomRightRectParent",this.applyProperties(t.bottomRightRectParent),t.bottomRightRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.opacity="-1",e.appendChild(t.bottomRightRectParent),t.bottomRightRect=document.createElement("div"),t.bottomRightRect.id=this.documentHelper.owner.containerId+"_BottomRightRect",t.bottomRightRect.style.cursor="se-resize",this.applyProperties(t.bottomRightRect),e.appendChild(t.bottomRightRect),t.bottomLeftRectParent=document.createElement("div"),t.bottomLeftRectParent.style.cursor="sw-resize",t.bottomLeftRectParent.id=this.documentHelper.owner.containerId+"_BottomLeftRectParent",this.applyProperties(t.bottomLeftRectParent),t.bottomLeftRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.opacity="-1",e.appendChild(t.bottomLeftRectParent),t.bottomLeftRect=document.createElement("div"),t.bottomLeftRect.id=this.documentHelper.owner.containerId+"_BottomLeftRect",t.bottomLeftRect.style.cursor="sw-resize",this.applyProperties(t.bottomLeftRect),e.appendChild(t.bottomLeftRect),t.bottomMiddleRectParent=document.createElement("div"),t.bottomMiddleRectParent.style.cursor="s-resize",t.bottomMiddleRectParent.id=this.documentHelper.owner.containerId+"_BottomMiddleRectParent",this.applyProperties(t.bottomMiddleRectParent),t.bottomMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.opacity="-1",e.appendChild(t.bottomMiddleRectParent),t.bottomMiddleRect=document.createElement("div"),t.bottomMiddleRect.id=this.documentHelper.owner.containerId+"_BottomMiddleRect",t.bottomMiddleRect.style.cursor="s-resize",this.applyProperties(t.bottomMiddleRect),e.appendChild(t.bottomMiddleRect),t.rightMiddleRectParent=document.createElement("div"),t.rightMiddleRectParent.style.cursor="e-resize",t.rightMiddleRectParent.id=this.documentHelper.owner.containerId+"_RightMiddleRectParent",this.applyProperties(t.rightMiddleRectParent),t.rightMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.opacity="-1",e.appendChild(t.rightMiddleRectParent),t.rightMiddleRect=document.createElement("div"),t.rightMiddleRect.id=this.documentHelper.owner.containerId+"_RightMiddleRect",t.rightMiddleRect.style.cursor="e-resize",this.applyProperties(t.rightMiddleRect),e.appendChild(t.rightMiddleRect),t.leftMiddleRectParent=document.createElement("div"),t.leftMiddleRectParent.style.cursor="w-resize",t.leftMiddleRectParent.id=this.documentHelper.owner.containerId+"_LeftMiddleRectParent",this.applyProperties(t.leftMiddleRectParent),t.leftMiddleRectParent.style.width=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.height=this.documentHelper.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.opacity="-1",e.appendChild(t.leftMiddleRectParent),t.leftMiddleRect=document.createElement("div"),t.leftMiddleRect.id=this.documentHelper.owner.containerId+"_LeftMiddleRect",t.leftMiddleRect.style.cursor="w-resize",this.applyProperties(t.leftMiddleRect),e.appendChild(t.leftMiddleRect),t.resizeContainerDiv},e.prototype.setImageResizerPosition=function(e,t,i,r,n){n.resizeContainerDiv.style.width=i+"px",n.resizeContainerDiv.style.height=r+"px",n.resizeContainerDiv.style.left=e+"px",n.resizeContainerDiv.style.top=t+"px",n.topRightRect.style.left=e+i-5+"px",n.topRightRect.style.top=t-4+"px",n.topLeftRect.style.left=e-5+"px",n.topLeftRect.style.top=t-4+"px",n.topMiddleRect.style.left=parseFloat(n.topLeftRect.style.left)+i/2-4+"px",n.topMiddleRect.style.top=t-4+"px",n.bottomRightRect.style.left=n.topRightRect.style.left,n.bottomRightRect.style.top=parseFloat(n.topRightRect.style.top)+r+"px",n.bottomLeftRect.style.left=n.topLeftRect.style.left,n.bottomLeftRect.style.top=parseFloat(n.topLeftRect.style.top)+r+"px",n.bottomMiddleRect.style.left=n.topMiddleRect.style.left,n.bottomMiddleRect.style.top=parseFloat(n.topMiddleRect.style.top)+r+"px",n.rightMiddleRect.style.left=e+i-4+"px",n.rightMiddleRect.style.top=parseFloat(n.topRightRect.style.top)+r/2+"px",n.leftMiddleRect.style.left=n.topLeftRect.style.left,n.leftMiddleRect.style.top=parseFloat(n.topLeftRect.style.top)+r/2+"px",n.topRightRectParent.style.left=this.documentHelper.isTouchInput?e+i-15+"px":e+i-8+"px",n.topRightRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",n.topLeftRectParent.style.left=this.documentHelper.isTouchInput?e-15+"px":e-8+"px",n.topLeftRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",n.topMiddleRectParent.style.left=parseFloat(n.topLeftRectParent.style.left)+i/2-4+"px",n.topMiddleRectParent.style.top=this.documentHelper.isTouchInput?t-15+"px":t-7+"px",n.bottomRightRectParent.style.left=n.topRightRectParent.style.left,n.bottomRightRectParent.style.top=parseFloat(n.topRightRectParent.style.top)+r+"px",n.bottomLeftRectParent.style.left=n.topLeftRectParent.style.left,n.bottomLeftRectParent.style.top=parseFloat(n.topLeftRectParent.style.top)+r+"px",n.bottomMiddleRectParent.style.left=n.topMiddleRectParent.style.left,n.bottomMiddleRectParent.style.top=parseFloat(n.topMiddleRectParent.style.top)+r+"px",n.rightMiddleRectParent.style.left=this.documentHelper.isTouchInput?e+i-15+"px":e+i-7+"px",n.rightMiddleRectParent.style.top=parseFloat(n.topRightRectParent.style.top)+r/2+"px",n.leftMiddleRectParent.style.left=n.topLeftRectParent.style.left,n.leftMiddleRectParent.style.top=parseFloat(n.topLeftRectParent.style.top)+r/2+"px",this.setImageResizingPoints(n),this.documentHelper.isTouchInput?this.applyPropertiesForTouch():this.applyPropertiesForMouse()},e.prototype.setImageResizingPoints=function(e){this.imageResizerPoints.resizeContainerDiv.x=parseFloat(e.resizeContainerDiv.style.left),this.imageResizerPoints.resizeContainerDiv.y=parseFloat(e.resizeContainerDiv.style.top),this.imageResizerPoints.bottomLeftRectParent.x=parseFloat(e.bottomLeftRectParent.style.left),this.imageResizerPoints.bottomLeftRectParent.y=parseFloat(e.bottomLeftRectParent.style.top),this.imageResizerPoints.bottomRightRectParent.x=parseFloat(e.bottomRightRectParent.style.left),this.imageResizerPoints.bottomRightRectParent.y=parseFloat(e.bottomRightRectParent.style.top),this.imageResizerPoints.bottomMiddleRectParent.x=parseFloat(e.bottomMiddleRectParent.style.left),this.imageResizerPoints.bottomMiddleRectParent.y=parseFloat(e.bottomMiddleRectParent.style.top),this.imageResizerPoints.topLeftRectParent.x=parseFloat(e.topLeftRectParent.style.left),this.imageResizerPoints.topLeftRectParent.y=parseFloat(e.topLeftRectParent.style.top),this.imageResizerPoints.topRightRectParent.x=parseFloat(e.topRightRectParent.style.left),this.imageResizerPoints.topRightRectParent.y=parseFloat(e.topRightRectParent.style.top),this.imageResizerPoints.topMiddleRectParent.x=parseFloat(e.topMiddleRectParent.style.left),this.imageResizerPoints.topMiddleRectParent.y=parseFloat(e.topMiddleRectParent.style.top),this.imageResizerPoints.leftMiddleRectParent.x=parseFloat(e.leftMiddleRectParent.style.left),this.imageResizerPoints.leftMiddleRectParent.y=parseFloat(e.leftMiddleRectParent.style.top),this.imageResizerPoints.rightMiddleRectParent.x=parseFloat(e.rightMiddleRectParent.style.left),this.imageResizerPoints.rightMiddleRectParent.y=parseFloat(e.rightMiddleRectParent.style.top)},e.prototype.initResizeContainerDiv=function(e){e.resizeContainerDiv=document.createElement("div"),e.resizeContainerDiv.id=this.documentHelper.owner.containerId+"_ResizeDivElement",e.resizeContainerDiv.style.position="absolute",e.resizeContainerDiv.style.border="1px solid #bfbfbf",e.resizeContainerDiv.style.zIndex="30",e.resizeContainerDiv.style.backgroundColor="transparent",e.resizeContainerDiv.style.display="block"},e.prototype.applyProperties=function(e){e.style.position="absolute",e.style.width="8px",e.style.height="8px",e.style.fontSize="0px",e.style.zIndex=" 551",e.style.backgroundColor="#ffffff",e.style.border="1px solid #bfbfbf",e.style.boxShadow="0 1px 2px 0 #bfbfbf 0.35",e.style.color="#000000"},e.prototype.handleImageResizing=function(e,t,i){var r;t/=this.documentHelper.zoomFactor,i/=this.documentHelper.zoomFactor,this.leftValue=sf.base.isNullOrUndefined(this.leftValue)?t:this.leftValue,this.topValue=sf.base.isNullOrUndefined(this.topValue)?i:this.topValue;var n=this.selectedResizeElement.id.split("_"),o=n[n.length-1];switch(o){case"TopRightRectParent":t=(r=this.topRightResizing(e)).left,i=r.top;break;case"TopLeftRectParent":t=-(r=this.topLeftResizing(e)).left,i=-r.top;break;case"TopMiddleRectParent":t=0,i=this.topMiddleResizing(e);break;case"BottomRightRectParent":t=(r=this.bottomRightResizing(e)).left,i=r.top;break;case"BottomLeftRectParent":t=-(r=this.bottomLeftResizing(e)).left,i=-r.top;break;case"BottomMiddleRectParent":i=e.y-i,t=0;break;case"RightMiddleRectParent":t=e.x-t,i=0;break;case"LeftMiddleRectParent":t=this.leftMiddleResizing(e),i=0}if(0!==t||0!==i){var s=this.currentImageElementBox.line.paragraph,a=this.currentImageElementBox;if(!sf.base.isNullOrUndefined(s)&&s.isInsideTable){var l=s.containerWidget;if(!sf.base.isNullOrUndefined(l)){var d=l.containerWidget,h=x.convertPointToPixel(a.height),c=d.height-h;i>0&&d.y+c+h+i>this.viewer.clientArea.bottom&&(this.isImageMoveToNextPage=!0)}}if(this.owner.enableHistoryMode&&this.initHistoryForImageResizer(this.currentImageElementBox),!sf.base.isNullOrUndefined(this.currentImageElementBox)){var p=this.currentImageElementBox.width+t>10?this.currentImageElementBox.width+t:10,g=this.currentImageElementBox.height+i>10?this.currentImageElementBox.height+i:10;"BottomRightRectParent"!==o&&"TopRightRectParent"!==o&&"BottomLeftRectParent"!==o&&"TopLeftRectParent"!==o||(g=this.currentImageElementBox.height/this.currentImageElementBox.width*p,p=this.currentImageElementBox.width/this.currentImageElementBox.height*g),this.currentImageElementBox.width=p,this.currentImageElementBox.height=g;this.currentImageElementBox.line.paragraph;this.positionImageResizer(this.currentImageElementBox)}this.isImageResizing=!0}},e.prototype.handleImageResizingOnMouse=function(e){if(!sf.base.isNullOrUndefined(this.selectedResizeElement)){var t=parseFloat(this.selectedResizeElement.style.left),i=parseFloat(this.selectedResizeElement.style.top),r=new I(e.offsetX,e.offsetY),n=this.viewer.findFocusedPage(r,!0);this.handleImageResizing(n,t,i)}},e.prototype.topMiddleResizing=function(e){var t;return this.topValue>=e.y?(t=this.topValue/e.y,this.topValue=e.y,this.viewer instanceof Qs&&this.topValue<=this.viewer.pageGap&&(t=1)):(t=-e.y/this.topValue,this.topValue=e.y,0===this.topValue&&(t=-1)),t},e.prototype.leftMiddleResizing=function(e){var t;return this.leftValue>=e.x?(t=this.leftValue/e.x,this.leftValue=e.x,0===this.leftValue&&(t=1,this.leftValue=parseFloat(this.selectedResizeElement.style.left))):(t=-e.x/this.leftValue,this.leftValue=e.x),t},e.prototype.topRightResizing=function(e){return this.leftValue<=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.topLeftResizing=function(e){return this.leftValue>=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.bottomRightResizing=function(e){return this.leftValue<=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.bottomLeftResizing=function(e){return this.leftValue>=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.getOuterResizingPoint=function(e){var t,i;return t=e.x-this.leftValue,this.leftValue=e.x,i=e.y-this.topValue,this.topValue=e.y,{left:t,top:i}},e.prototype.getInnerResizingPoint=function(e){var t,i;return t=-(this.leftValue-e.x),this.leftValue=e.x,i=-(this.topValue-e.y),this.topValue=e.y,{left:t,top:i}},e.prototype.handleImageResizingOnTouch=function(e){if(!sf.base.isNullOrUndefined(this.selectedResizeElement)){var t=parseFloat(this.selectedResizeElement.style.left)+24,i=parseFloat(this.selectedResizeElement.style.top)+24,r=e.touches,n=new I(r[0].clientX,r[0].clientY),o=this.viewer.findFocusedPage(n,!0);if(sf.base.isNullOrUndefined(this.currentImageElementBox)||sf.base.isNullOrUndefined(this.currentImageElementBox))return;this.handleImageResizing(o,t,i)}},e.prototype.getImagePoint=function(e){var t=this.documentHelper.render.getScaledValue(e.x,1),i=this.documentHelper.render.getScaledValue(e.y,2);e=new I(t,i);var r=this.imageResizerPoints,n="",o=void 0,s=r.bottomMiddleRectParent,a=r.bottomRightRectParent,l=r.bottomLeftRectParent,d=r.topMiddleRectParent,h=r.topRightRectParent,c=r.topLeftRectParent,p=r.rightMiddleRectParent,g=r.leftMiddleRectParent;return sf.base.isNullOrUndefined(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(e.x>s.x&&e.x<=s.x+15&&e.y>s.y&&e.y<=s.y+15?(o=this.bottomMiddleRectParent,n="s-resize"):e.x>a.x&&e.x<=a.x+15&&e.y>a.y&&e.y<=a.y+15?(o=this.bottomRightRectParent,n="se-resize"):e.x>l.x&&e.x<=l.x+15&&e.y>l.y&&e.y<=l.y+15?(o=this.bottomLeftRectParent,n="sw-resize"):e.x>d.x&&e.x<=d.x+15&&e.y>d.y&&e.y<=d.y+15?(o=this.topMiddleRectParent,n="n-resize"):e.x>h.x&&e.x<=h.x+15&&e.y>h.y&&e.y<=h.y+15?(o=this.topRightRectParent,n="ne-resize"):e.x>c.x&&e.x<=c.x+15&&e.y>c.y&&e.y<=c.y+15?(o=this.topLeftRectParent,n="nw-resize"):e.x>g.x&&e.x<=g.x+15&&e.y>g.y&&e.y<=g.y+15?(o=this.leftMiddleRectParent,n="w-resize"):e.x>p.x&&e.x<=p.x+15&&e.y>p.y&&e.y<=p.y+15?(o=this.rightMiddleRectParent,n="e-resize"):!sf.base.isNullOrUndefined(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(n="move")),{selectedElement:o,resizePosition:n}},e.prototype.applyPropertiesForMouse=function(){sf.base.isNullOrUndefined(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="14px",this.bottomMiddleRectParent.style.height="14px",this.bottomRightRectParent.style.width="14px",this.bottomRightRectParent.style.height="14px",this.bottomLeftRectParent.style.width="14px",this.bottomLeftRectParent.style.height="14px",this.topMiddleRectParent.style.width="14px",this.topMiddleRectParent.style.height="14px",this.topRightRectParent.style.width="14px",this.topRightRectParent.style.height="14px",this.topLeftRectParent.style.width="14px",this.topLeftRectParent.style.height="14px",this.leftMiddleRectParent.style.width="14px",this.leftMiddleRectParent.style.height="14px",this.rightMiddleRectParent.style.width="14px",this.rightMiddleRectParent.style.height="14px")},e.prototype.getImagePointOnTouch=function(e){var t=this.documentHelper.render.getScaledValue(e.x,1),i=this.documentHelper.render.getScaledValue(e.y,2);e=new I(t,i);var r=this.imageResizerPoints,n="",o=void 0,s=r.bottomMiddleRectParent,a=r.bottomRightRectParent,l=r.bottomLeftRectParent,d=r.topMiddleRectParent,h=r.topRightRectParent,c=r.topLeftRectParent,p=r.rightMiddleRectParent,g=r.leftMiddleRectParent;return sf.base.isNullOrUndefined(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(e.x>s.x&&e.x<=s.x+25&&e.y>s.y&&e.y<=s.y+25?(o=this.bottomMiddleRectParent,n="s-resize"):e.x>a.x&&e.x<=a.x+25&&e.y>a.y&&e.y<=a.y+25?(o=this.bottomRightRectParent,n="se-resize"):e.x>l.x&&e.x<=l.x+25&&e.y>l.y&&e.y<=l.y+25?(o=this.bottomLeftRectParent,n="sw-resize"):e.x>d.x&&e.x<=d.x+25&&e.y>d.y&&e.y<=d.y+25?(o=this.topMiddleRectParent,n="n-resize"):e.x>h.x&&e.x<=h.x+25&&e.y>h.y&&e.y<=h.y+25?(o=this.topRightRectParent,n="ne-resize"):e.x>c.x&&e.x<=c.x+25&&e.y>c.y&&e.y<=c.y+25?(o=this.topLeftRectParent,n="nw-resize"):e.x>g.x&&e.x<=g.x+25&&e.y>g.y&&e.y<=g.y+25?(o=this.leftMiddleRectParent,n="w-resize"):e.x>p.x&&e.x<=p.x+25&&e.y>p.y&&e.y<=p.y+25?(o=this.rightMiddleRectParent,n="e-resize"):!sf.base.isNullOrUndefined(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(n="move")),{selectedElement:o,resizePosition:n}},e.prototype.applyPropertiesForTouch=function(){sf.base.isNullOrUndefined(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="30px",this.bottomMiddleRectParent.style.height="30px",this.bottomRightRectParent.style.width="30px",this.bottomRightRectParent.style.height="30px",this.bottomLeftRectParent.style.width="30px",this.bottomLeftRectParent.style.height="30px",this.topMiddleRectParent.style.width="30px",this.topMiddleRectParent.style.height="30px",this.topRightRectParent.style.width="30px",this.topRightRectParent.style.height="30px",this.topLeftRectParent.style.width="30px",this.topLeftRectParent.style.height="30px",this.leftMiddleRectParent.style.width="30px",this.leftMiddleRectParent.style.height="30px",this.rightMiddleRectParent.style.width="30px",this.rightMiddleRectParent.style.height="30px")},e.prototype.mouseUpInternal=function(){this.currentImageElementBox.width=parseFloat(this.imageResizerDiv.style.width)/this.documentHelper.zoomFactor,this.currentImageElementBox.height=parseFloat(this.imageResizerDiv.style.height)/this.documentHelper.zoomFactor,this.owner.isShiftingEnabled=!0,this.owner.editorModule.setOffsetValue(this.owner.selection),this.documentHelper.layout.layoutBodyWidgetCollection(this.currentImageElementBox.line.paragraph.index,this.currentImageElementBox.line.paragraph.containerWidget,this.currentImageElementBox.line.paragraph,!1),this.updateHistoryForImageResizer(),this.owner.editorModule.reLayout(this.owner.selection,!0),this.viewer.updateScrollBars()},e.prototype.initHistoryForImageResizer=function(e){!sf.base.isNullOrUndefined(this.owner)&&sf.base.isNullOrUndefined(this.baseHistoryInfo)&&(this.baseHistoryInfo=new rd(this.owner),this.baseHistoryInfo.action="ImageResizing",this.baseHistoryInfo.updateSelection(),this.baseHistoryInfo.modifiedProperties.push(new Dl(e)))},e.prototype.updateHistoryForImageResizer=function(){if(!sf.base.isNullOrUndefined(this.owner)&&!sf.base.isNullOrUndefined(this.baseHistoryInfo)){var e=this.baseHistoryInfo.modifiedProperties[0];this.currentImageElementBox.width===e.width&&this.currentImageElementBox.height===e.height?this.baseHistoryInfo.modifiedProperties.pop():this.owner.editorHistory.recordChanges(this.baseHistoryInfo),this.baseHistoryInfo=void 0}},e.prototype.updateImageResizerPosition=function(){if(!sf.base.isNullOrUndefined(this.currentImageElementBox)){var e,t=(this.currentImageElementBox,this.currentImageElementBox),i=t.line,r=void 0,n=void 0,o=void 0;this.currentImageElementBox instanceof Da?(e=this.documentHelper.selection.getTop(i)+t.margin.top,r=this.documentHelper.selection.getLeftInternal(i,t,0),n=e*this.documentHelper.zoomFactor,o=r*this.documentHelper.zoomFactor):(o=t.x*this.documentHelper.zoomFactor,n=t.y*this.documentHelper.zoomFactor);var s=this.documentHelper.render.getScaledValue(t.height,2),a=this.documentHelper.render.getScaledValue(t.width,1);this.setImageResizerPosition(o,n,a,s,this)}},e.prototype.destroy=function(){sf.base.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.innerHTML=""),sf.base.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.innerHTML=""),sf.base.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.innerHTML=""),sf.base.isNullOrUndefined(this.topRightRect)||(this.topRightRect.innerHTML=""),sf.base.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.innerHTML=""),sf.base.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.innerHTML=""),sf.base.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.innerHTML=""),sf.base.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.innerHTML=""),sf.base.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.innerHTML=""),sf.base.isNullOrUndefined(this.imageResizerDiv)||(this.imageResizerDiv.innerHTML=""),sf.base.isNullOrUndefined(this.selectedImageWidget)||this.selectedImageWidget.destroy(),sf.base.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.innerHTML=""),this.imageResizerDivElement=void 0,this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.imageResizerDiv=void 0,this.selectedImageWidget=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.currentImageElementBoxIn=void 0,this.resizeMarkSizeIn=void 0,this.documentHelper=void 0,this.owner=void 0},e}(),pd=function(){this.resizeContainerDiv=new I(0,0),this.topLeftRectParent=new I(0,0),this.topMiddleRectParent=new I(0,0),this.topRightRectParent=new I(0,0),this.bottomLeftRectParent=new I(0,0),this.bottomMiddleRectParent=new I(0,0),this.bottomRightRectParent=new I(0,0),this.leftMiddleRectParent=new I(0,0),this.rightMiddleRectParent=new I(0,0)},gd=function(){function e(e,t){this.heightIn=0,this.widthIn=0,this.heightIn=e,this.widthIn=t}return Object.defineProperty(e.prototype,"height",{get:function(){return this.heightIn},set:function(e){this.heightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),e}(),fd=function(){function e(){this.customXMLItemsPath="customXml/item",this.customXMLItemsPropspath="customXml/itemProps",this.itemPropsPath="itemProps",this.documentPath="word/document.xml",this.stylePath="word/styles.xml",this.chartPath="word/charts",this.numberingPath="word/numbering.xml",this.settingsPath="word/settings.xml",this.headerPath="word/header",this.footerPath="word/footer",this.imagePath="word/media/image",this.footnotesPath="word/footnotes.xml",this.endnotesPath="word/endnotes.xml",this.appPath="docProps/app.xml",this.corePath="docProps/core.xml",this.contentTypesPath="[Content_Types].xml",this.defaultEmbeddingPath="word/embeddings/",this.commentsPath="word/comments.xml",this.commentsExtendedPath="word/commentsExtended.xml",this.themePath="word/theme/theme1.xml",this.generalRelationPath="_rels/.rels",this.wordRelationPath="word/_rels/document.xml.rels",this.customXMLRelPath="customXml/_rels/item",this.excelRelationPath="xl/_rels/workbook.xml.rels",this.footnotesRelationPath="word/_rels/footnotes.xml.rels",this.endnotesRelationPath="word/_rels/endnotes.xml.rels",this.headerRelationPath="word/_rels/header",this.footerRelationPath="word/_rels/footer",this.xmlContentType="application/xml",this.fontContentType="application/vnd.openxmlformats-officedocument.obfuscatedFont",this.documentContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml",this.TemplateContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml",this.settingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",this.commentsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml",this.commentsExContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.commentsExtended+xml",this.endnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml",this.footerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",this.footnoteContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml",this.headerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",this.numberingContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml",this.stylesContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml",this.webSettingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml",this.appContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml",this.coreContentType="application/vnd.openxmlformats-package.core-properties+xml",this.customContentType="application/vnd.openxmlformats-officedocument.custom-properties+xml",this.customXmlContentType="application/vnd.openxmlformats-officedocument.customXmlProperties+xml",this.relationContentType="application/vnd.openxmlformats-package.relationships+xml",this.chartsContentType="application/vnd.openxmlformats-officedocument.drawingml.chart+xml",this.themeContentType="application/vnd.openxmlformats-officedocument.theme+xml",this.tableStyleContentType="application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml",this.chartColorStyleContentType="application/vnd.ms-office.chartcolorstyle+xml",this.commentsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",this.commentsExRelType="http://schemas.microsoft.com/office/2011/relationships/commentsExtended",this.settingsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",this.endnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes",this.footerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",this.footnoteRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes",this.headerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",this.documentRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",this.numberingRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",this.stylesRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",this.chartRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",this.ThemeRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",this.fontRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",this.tableStyleRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles",this.coreRelType="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",this.appRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",this.customRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",this.imageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",this.hyperlinkRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",this.controlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/control",this.packageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/package",this.customXmlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",this.customUIRelType="http://schemas.microsoft.com/office/2006/relationships/ui/extensibility",this.attachedTemplateRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate",this.chartColorStyleRelType="http://schemas.microsoft.com/office/2011/relationships/chartColorStyle",this.wNamespace="http://schemas.openxmlformats.org/wordprocessingml/2006/main",this.wpNamespace="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",this.pictureNamespace="http://schemas.openxmlformats.org/drawingml/2006/picture",this.aNamespace="http://schemas.openxmlformats.org/drawingml/2006/main",this.a14Namespace="http://schemas.microsoft.com/office/drawing/2010/main",this.svgNamespace="http://schemas.microsoft.com/office/drawing/2016/SVG/main",this.rNamespace="http://schemas.openxmlformats.org/officeDocument/2006/relationships",this.rpNamespace="http://schemas.openxmlformats.org/package/2006/relationships",this.vNamespace="urn:schemas-microsoft-com:vml",this.oNamespace="urn:schemas-microsoft-com:office:office",this.xmlNamespace="http://www.w3.org/XML/1998/namespace",this.w10Namespace="urn:schemas-microsoft-com:office:word",this.cpNamespace="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",this.dcNamespace="http://purl.org/dc/elements/1.1/",this.docPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",this.veNamespace="http://schemas.openxmlformats.org/markup-compatibility/2006",this.mNamespace="http://schemas.openxmlformats.org/officeDocument/2006/math",this.wneNamespace="http://schemas.microsoft.com/office/word/2006/wordml",this.customPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",this.vtNamespace="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",this.chartNamespace="http://schemas.openxmlformats.org/drawingml/2006/chart",this.slNamespace="http://schemas.openxmlformats.org/schemaLibrary/2006/main",this.dtNamespace="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",this.wmlNamespace="http://schemas.microsoft.com/office/word/2003/wordml",this.w14Namespace="http://schemas.microsoft.com/office/word/2010/wordml",this.wpCanvasNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",this.wpDrawingNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",this.wpGroupNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",this.wpInkNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingInk",this.wpShapeNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingShape",this.w15Namespace="http://schemas.microsoft.com/office/word/2012/wordml",this.diagramNamespace="http://schemas.openxmlformats.org/drawingml/2006/diagram",this.eNamespace="http://schemas.microsoft.com/office/2006/encryption",this.pNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/password",this.certNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/certificate",this.cxNamespace="http://schemas.microsoft.com/office/drawing/2014/chartex",this.c15Namespace="http://schemas.microsoft.com/office/drawing/2015/06/chart",this.c7Namespace="http://schemas.microsoft.com/office/drawing/2007/8/2/chart",this.csNamespace="http://schemas.microsoft.com/office/drawing/2012/chartStyle",this.spreadSheetNamespace="http://schemas.openxmlformats.org/spreadsheetml/2006/main",this.spreadSheet9="http://schemas.microsoft.com/office/spreadsheetml/2009/9/main",this.cRelationshipsTag="Relationships",this.cRelationshipTag="Relationship",this.cIdTag="Id",this.cTypeTag="Type",this.cTargetTag="Target",this.cUserShapesTag="userShapes",this.cExternalData="externalData",this.twipsInOnePoint=20,this.twentiethOfPoint=20,this.borderMultiplier=8,this.percentageFactor=50,this.emusPerPoint=12700,this.cConditionalTableStyleTag="tblStylePr",this.cTableFormatTag="tblPr",this.cTowFormatTag="trPr",this.cCellFormatTag="tcPr",this.cParagraphFormatTag="pPr",this.cCharacterFormatTag="rPr",this.packageType="http://schemas.microsoft.com/office/2006/xmlPackage",this.relsPartPath="/_rels/.rels",this.documentRelsPartPath="/word/_rels/document.xml.rels",this.webSettingsPath="/word/webSettings.xml",this.wordMLDocumentPath="/word/document.xml",this.wordMLStylePath="/word/styles.xml",this.wordMLNumberingPath="/word/numbering.xml",this.wordMLSettingsPath="/word/settings.xml",this.wordMLHeaderPath="/word/header",this.wordMLFooterPath="/word/footer",this.wordMLCommentsPath="/word/comments.xml",this.wordMLImagePath="/word/media/image",this.wordMLFootnotesPath="/word/footnotes.xml",this.wordMLEndnotesPath="/word/endnotes.xml",this.wordMLAppPath="/docProps/app.xml",this.wordMLCorePath="/docProps/core.xml",this.wordMLCustomPath="/docProps/custom.xml",this.wordMLFontTablePath="/word/fontTable.xml",this.wordMLChartsPath="/word/charts/",this.wordMLDefaultEmbeddingPath="/word/embeddings/",this.wordMLEmbeddingPath="/word/embeddings/",this.wordMLDrawingPath="/word/drawings/",this.wordMLThemePath="/word/theme/theme1.xml",this.wordMLFontsPath="/word/fonts/",this.wordMLDiagramPath="/word/diagrams/",this.wordMLControlPath="/word/activeX/",this.wordMLVbaProject="/vbaProject.bin",this.wordMLVbaData="/vbaData.xml",this.wordMLVbaProjectPath="/word/vbaProject.bin",this.wordMLVbaDataPath="/word/vbaData.xml",this.wordMLWebSettingsPath="/word/webSettings.xml",this.wordMLCustomItemProp1Path="/customXml/itemProps1.xml",this.wordMLFootnoteRelPath="/word/_rels/footnotes.xml.rels",this.wordMLEndnoteRelPath="/word/_rels/endnotes.xml.rels",this.wordMLSettingsRelPath="/word/_rels/settings.xml.rels",this.wordMLNumberingRelPath="/word/_rels/numbering.xml.rels",this.wordMLFontTableRelPath="/word/_rels/fontTable.xml.rels",this.wordMLCustomXmlPropsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",this.wordMLControlRelType="http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary",this.wordMLDiagramContentType="application/vnd.ms-office.drawingml.diagramDrawing+xml",this.dsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/customXml",this.excelFiles=void 0,this.lastSection=!1,this.mRelationShipID=0,this.cRelationShipId=0,this.eRelationShipId=0,this.efRelationShipId=0,this.mDocPrID=1,this.chartCount=0,this.seriesCount=0,this.chartStringCount=0,this.mDifferentFirstPage=!1,this.mBookmarks=void 0,this.mComments=[],this.revisions=[],this.customXMLProps=[],this.paraID=0,this.commentParaID=0,this.commentParaIDInfo={},this.isInsideComment=!1,this.commentId={},this.currentCommentId=0,this.trackChangesId=0,this.prevRevisionIds=[],this.isRevisionContinuous=!1,this.isBookmarkAtEnd=!1,this.isBookmarkAtRowEnd=!1,this.keywordIndex=0,this.isHeaderFooter=!1,this.isSerializeFootEndNote=void 0,this.containerWidth=0}return e.prototype.getModuleName=function(){return"WordExport"},Object.defineProperty(e.prototype,"bookmarks",{get:function(){return sf.base.isNullOrUndefined(this.mBookmarks)&&(this.mBookmarks=[]),this.mBookmarks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentImages",{get:function(){return void 0===this.mDocumentImages&&(this.mDocumentImages=new a),this.mDocumentImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"svgImages",{get:function(){return void 0===this.mSvgImages&&(this.mSvgImages=new a),this.mSvgImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"externalImages",{get:function(){return void 0===this.mExternalLinkImages&&(this.mExternalLinkImages=new a),this.mExternalLinkImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerFooterImages",{get:function(){return void 0===this.mHeaderFooterImages&&(this.mHeaderFooterImages=new a),this.mHeaderFooterImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerFooterSvgImages",{get:function(){return void 0===this.mHeaderFooterSvgImages&&(this.mHeaderFooterSvgImages=new a),this.mHeaderFooterSvgImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentCharts",{get:function(){return void 0===this.mDocumentCharts&&(this.mDocumentCharts=new a),this.mDocumentCharts},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headersFooters",{get:function(){return void 0===this.mHeaderFooterColl&&(this.mHeaderFooterColl=new a),this.mHeaderFooterColl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endnotesFootnotes",{get:function(){return void 0===this.mFootEndnotesColl&&(this.mFootEndnotesColl=new a),this.mFootEndnotesColl},enumerable:!0,configurable:!0}),e.prototype.save=function(e,t,i){var r=this;this.fileName=t,this.serialize(e,i);var n=this.serializeExcelFiles();n&&n.length>0?Promise.all(n).then((function(){r.saveInternal(t,i)})):this.saveInternal(t,i),this.close()},e.prototype.saveInternal=function(e,t){"Docx"==t?this.mArchive.save(e+".docx").then((function(e){e.destroy()})):"Dotx"==t&&this.mArchive.save(e+".dotx").then((function(e){e.destroy()}))},e.prototype.saveAsBlob=function(e,t){var i=this;this.serialize(e,t);var r=this.serializeExcelFiles();return new Promise((function(e,t){r.length>0?Promise.all(r).then((function(){i.mArchive.saveAsBlob().then((function(t){i.mArchive.destroy(),t=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),e(t)}))})):i.mArchive.saveAsBlob().then((function(t){i.mArchive.destroy(),t=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),e(t)}))}))},e.prototype.serializeExcelFiles=function(){var e=this,t=this.excelFiles,i=[];if(t&&t.length>0){for(var r=function(r){var n=t.keys[parseInt(r.toString(),10)],o=t.get(n).saveAsBlob();i.push(o),o.then((function(t){var i=new sf.compression.ZipArchiveItem(t,n);e.mArchive.addItem(i)}))},n=0;n<t.length;n++)r(n);this.excelFiles.clear()}return i},e.prototype.saveExcel=function(){var e=this.defaultEmbeddingPath+"Microsoft_Excel_Worksheet"+this.chartCount+".xlsx";this.excelFiles.add(e,this.mArchiveExcel),this.mArchiveExcel=void 0},e.prototype.destroy=function(){this.clearDocument(),this.mRelationShipID=void 0,this.mDocPrID=void 0,this.mDifferentFirstPage=void 0,this.fileName=void 0,this.imageRelationIds=void 0,this.svgImageRelationIds=void 0,this.mArchive&&(this.mArchive.destroy(),this.mArchive=void 0),this.mArchiveExcel&&(this.mArchiveExcel.destroy(),this.mArchiveExcel=void 0)},e.prototype.serialize=function(e,t){this.keywordIndex=e.owner.documentEditorSettings.optimizeSfdt?1:0;var i=e.owner.sfdtExportModule.write(this.keywordIndex);this.setDocument(i),this.mComments=e.comments,this.mCustomXML=e.customXmlData,this.mImages=e.images,this.revisions=e.owner.revisions.changes,this.mArchive=new sf.compression.ZipArchive,this.mArchive.compressionLevel="Normal",this.commentParaIDInfo={},this.commentParaID=0,this.currentCommentId=0,this.commentId={},this.mVerticalMerge=new a,this.mGridSpans=new a,this.imageRelationIds=new a,this.svgImageRelationIds=new a,this.serializeDocument(),this.serializeStyles(),this.serializeNumberings(),this.serializeComments(),this.serializeCommentsExtended(),this.serializeThemes(),this.serializeSettings(),this.serializeCoreProperties(),this.serializeAppProperties(),this.serializeFontTable(void 0),this.serializeSettingsRelation(),this.serializeHeaderFooters(),this.serializeFootnotes(),this.serializeEndnotes(),this.serializeDocumentRelations(),this.serializeGeneralRelations(),this.serializeContentTypes(void 0,t),this.clearDocument()},e.prototype.setDocument=function(e,t){sf.base.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=t),this.document=e,this.mSections=e[D[this.keywordIndex]],this.mLists=e[j[this.keywordIndex]],this.mAbstractLists=e[G[this.keywordIndex]],this.defCharacterFormat=e[q[this.keywordIndex]],this.defParagraphFormat=e[_[this.keywordIndex]],this.defaultTabWidthValue=e[$[this.keywordIndex]],this.themeFontLang=e[ue[this.keywordIndex]],this.dontUseHtmlParagraphAutoSpacing=x.parseBoolValue(e[ae[this.keywordIndex]]),this.mStyles=e[X[this.keywordIndex]],this.mThemes=e[me[this.keywordIndex]],this.formatting=x.parseBoolValue(e[ee[this.keywordIndex]]),this.enforcement=x.parseBoolValue(e[re[this.keywordIndex]]),this.hashValue=e[ne[this.keywordIndex]],this.saltValue=e[oe[this.keywordIndex]],this.protectionType=e[ie[this.keywordIndex]],this.formFieldShading=x.parseBoolValue(e[he[this.keywordIndex]]),this.trackChanges=x.parseBoolValue(e[te[this.keywordIndex]]),this.compatibilityMode=e[fe[this.keywordIndex]],this.allowSpaceOfSameStyleInTable=x.parseBoolValue(e[Fs[this.keywordIndex]])},e.prototype.clearDocument=function(){this.section=void 0,this.lastSection=void 0,this.blockOwner=void 0,this.paragraph=void 0,this.table=void 0,this.row=void 0,this.headerFooter=void 0,this.commentParaIDInfo={},this.commentParaID=0,this.currentCommentId=0,this.commentId={},this.document=void 0,this.mSections=void 0,this.mLists=void 0,this.mAbstractLists=void 0,this.defCharacterFormat=void 0,this.defParagraphFormat=void 0,this.defaultTabWidthValue=void 0,this.trackChanges=void 0,this.customXMLProps=[],this.mRelationShipID=0,this.eRelationShipId=0,this.cRelationShipId=0,this.efRelationShipId=0,this.mDocPrID=1,this.chartCount=0,this.keywordIndex=void 0,this.mDifferentFirstPage=!1,this.mHeaderFooterColl&&(this.mHeaderFooterColl.destroy(),this.mHeaderFooterColl=void 0),this.mVerticalMerge&&(this.mVerticalMerge.destroy(),this.mVerticalMerge=void 0),this.mGridSpans&&(this.mGridSpans.destroy(),this.mGridSpans=void 0),this.mDocumentImages&&(this.mDocumentImages.destroy(),this.mDocumentImages=void 0),this.mExternalLinkImages&&(this.mExternalLinkImages.destroy(),this.mExternalLinkImages=void 0),this.mHeaderFooterImages&&(this.mHeaderFooterImages.destroy(),this.mHeaderFooterImages=void 0),this.mDocumentCharts&&(this.mDocumentCharts.destroy(),this.mDocumentCharts=void 0),this.mFootEndnotesColl&&(this.mFootEndnotesColl.destroy(),this.mFootEndnotesColl=void 0)},e.prototype.serializeDocument=function(){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","document",this.wNamespace),this.writeCommonAttributeStrings(e),e.writeStartElement("w","background",this.wNamespace),e.writeAttributeString("w","color",void 0,this.getColor(this.document[K[this.keywordIndex]][Br[this.keywordIndex]])),e.writeEndElement(),this.serializeDocumentBody(e),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.documentPath);this.mArchive.addItem(t)},e.prototype.writeCommonAttributeStrings=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15 wp14")},e.prototype.writeDup=function(e){e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","wpg",void 0,this.wpGroupNamespace),e.writeAttributeString("xmlns","wpi",void 0,this.wpInkNamespace)},e.prototype.writeCustom=function(e){e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace)},e.prototype.serializeDocumentBody=function(e){e.writeStartElement(void 0,"body",this.wNamespace);for(var t=this.document[D[this.keywordIndex]].length,i=0;i<t;i++)this.section=this.document[D[this.keywordIndex]][parseInt(i.toString(),10)],this.lastSection=i===t-1,this.containerWidth=this.section[No[this.keywordIndex]][yt[this.keywordIndex]]-(this.section[No[this.keywordIndex]][wt[this.keywordIndex]]+this.section[No[this.keywordIndex]][bt[this.keywordIndex]]),this.serializeSection(e,this.section,i===t-1),this.section=void 0;e.writeEndElement()},e.prototype.serializeSection=function(e,t,i){this.blockOwner=t,sf.base.isNullOrUndefined(t[xo[this.keywordIndex]])||this.serializeBodyItems(e,t[xo[this.keywordIndex]],i),i&&this.serializeSectionProperties(e,t),this.blockOwner=void 0},e.prototype.serializeComments=function(){if(0!==this.mComments.length&&(1!==this.mComments.length||""!==this.mComments[0].text)){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","comments",this.wNamespace),this.serializeCommentCommonAttribute(e),this.serializeCommentInternal(e,this.mComments),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.commentsPath);this.mArchive.addItem(t)}},e.prototype.serializeThemes=function(){if(!sf.base.isNullOrUndefined(this.mThemes)){var e=new sf.fileutils.XmlWriter;e.writeStartElement("a","theme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,"Office Theme"),e.writeStartElement(void 0,"themeElements",this.aNamespace),e.writeRaw('<a:clrScheme name="Office"><a:dk1><a:sysClr val="windowText" lastClr="000000" /></a:dk1><a:lt1><a:sysClr val="window" lastClr="FFFFFF" /></a:lt1><a:dk2><a:srgbClr val="44546A" /></a:dk2><a:lt2><a:srgbClr val="E7E6E6" /></a:lt2><a:accent1><a:srgbClr val="4472C4" /></a:accent1><a:accent2><a:srgbClr val="ED7D31" /></a:accent2><a:accent3><a:srgbClr val="A5A5A5" /></a:accent3><a:accent4><a:srgbClr val="FFC000" /></a:accent4><a:accent5><a:srgbClr val="5B9BD5" /></a:accent5><a:accent6><a:srgbClr val="70AD47" /></a:accent6><a:hlink><a:srgbClr val="0563C1" /></a:hlink><a:folHlink><a:srgbClr val="954F72" /></a:folHlink></a:clrScheme>'),e.writeStartElement(void 0,"fontScheme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,this.mThemes[rs[this.keywordIndex]]),e.writeStartElement(void 0,"majorFont",this.aNamespace);for(var t=0;t<this.mThemes[is[this.keywordIndex]][ns[this.keywordIndex]][ss[this.keywordIndex]].length;t++){var i=this.mThemes[is[this.keywordIndex]][ns[this.keywordIndex]][ss[this.keywordIndex]][parseInt(t.toString(),10)];this.themeFont(e,i)}for(var r=Object.keys(this.mThemes[is[this.keywordIndex]][ns[this.keywordIndex]][as[this.keywordIndex]]),n=0,o=r;n<o.length;n++){var s=o[n];this.themeType(e,s,this.mThemes[is[this.keywordIndex]][ns[this.keywordIndex]][as[this.keywordIndex]][""+s])}e.writeEndElement(),e.writeStartElement(void 0,"minorFont",this.aNamespace);for(t=0;t<this.mThemes[is[this.keywordIndex]][os[this.keywordIndex]][ss[this.keywordIndex]].length;t++){i=this.mThemes[is[this.keywordIndex]][os[this.keywordIndex]][ss[this.keywordIndex]][parseInt(t.toString(),10)];this.themeFont(e,i)}for(var a=0,l=r=Object.keys(this.mThemes[is[this.keywordIndex]][os[this.keywordIndex]][as[this.keywordIndex]]);a<l.length;a++){s=l[a];this.themeType(e,s,this.mThemes[is[this.keywordIndex]][os[this.keywordIndex]][as[this.keywordIndex]][""+s])}e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"fmtScheme",this.aNamespace),e.writeAttributeString(void 0,"name",void 0,"Office"),e.writeRaw('<a:fillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:lumMod val="110000" /><a:satMod val="105000" /><a:tint val="67000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:lumMod val="105000" /><a:satMod val="103000" /><a:tint val="73000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:lumMod val="105000" /><a:satMod val="109000" /><a:tint val="81000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:satMod val="103000" /><a:lumMod val="102000" /><a:tint val="94000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:satMod val="110000" /><a:lumMod val="100000" /><a:shade val="100000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:lumMod val="99000" /><a:satMod val="120000" /><a:shade val="78000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill></a:fillStyleLst><a:lnStyleLst><a:ln w="6350" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln><a:ln w="12700" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln><a:ln w="19050" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:prstDash val="solid" /><a:miter lim="800000" /></a:ln></a:lnStyleLst><a:effectStyleLst><a:effectStyle><a:effectLst /></a:effectStyle><a:effectStyle><a:effectLst /></a:effectStyle><a:effectStyle><a:effectLst><a:outerShdw blurRad="57150" dist="19050" dir="5400000" algn="ctr" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="63000" /></a:srgbClr></a:outerShdw></a:effectLst></a:effectStyle></a:effectStyleLst><a:bgFillStyleLst><a:solidFill><a:schemeClr val="phClr" /></a:solidFill><a:solidFill><a:schemeClr val="phClr"><a:tint val="95000" /><a:satMod val="170000" /></a:schemeClr></a:solidFill><a:gradFill rotWithShape="1"><a:gsLst><a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="93000" /><a:satMod val="150000" /><a:shade val="98000" /><a:lumMod val="102000" /></a:schemeClr></a:gs><a:gs pos="50000"><a:schemeClr val="phClr"><a:tint val="98000" /><a:satMod val="130000" /><a:shade val="90000" /><a:lumMod val="103000" /></a:schemeClr></a:gs><a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="63000" /><a:satMod val="120000" /></a:schemeClr></a:gs></a:gsLst><a:lin ang="5400000" scaled="0" /></a:gradFill></a:bgFillStyleLst>'),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();var d=new sf.compression.ZipArchiveItem(e.buffer,this.themePath);this.mArchive.addItem(d)}},e.prototype.themeFont=function(e,t){"latin"!=t[ye[this.keywordIndex]]&&"ea"!=t[ye[this.keywordIndex]]&&"cs"!=t[ye[this.keywordIndex]]||(e.writeStartElement(void 0,t[ye[this.keywordIndex]],this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t[ls[this.keywordIndex]]),e.writeAttributeString(void 0,"panose",void 0,t[ds[this.keywordIndex]]),e.writeEndElement())},e.prototype.themeType=function(e,t,i){e.writeStartElement(void 0,"font",this.aNamespace),e.writeAttributeString(void 0,"script",void 0,t),e.writeAttributeString(void 0,"typeface",void 0,i),e.writeEndElement()},e.prototype.serializeCommentCommonAttribute=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","cx",void 0,this.cxNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},e.prototype.serializeCommentInternal=function(e,t){for(var i=0;i<t.length;i++){var r=t[parseInt(i.toString(),10)];e.writeStartElement("w","comment",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,this.commentId[r.commentId].toString()),r.author&&" "!==r.author&&e.writeAttributeString("w","author",this.wNamespace,r.author),r.date&&e.writeAttributeString("w","date",this.wNamespace,r.date),r.initial&&""!==r.initial&&e.writeAttributeString("w","initials",this.wNamespace,r.initial);for(var n=this.retrieveCommentText(r.text),o=0;o<n.length;o++)this.isInsideComment=!0,this.commentParaID++,this.serializeBodyItem(e,n[parseInt(o.toString(),10)],!0),this.isInsideComment=!1;0===n.length&&(this.isInsideComment=!0,this.commentParaID++),this.commentParaIDInfo[r.commentId]=this.commentParaID,this.isInsideComment=!1,e.writeEndElement(),r.replyComments.length>0&&this.serializeCommentInternal(e,r.replyComments)}},e.prototype.retrieveCommentText=function(e){for(var t=[],i=e.split("\n");i.length>0;){var r={};r[Pn[this.keywordIndex]]=[];var n={};n[gr[this.keywordIndex]]=i[0],r[Pn[this.keywordIndex]].push(n),t.push(r),i.splice(0,1)}return t},e.prototype.serializeCommentsExtended=function(){if(0!==this.mComments.length&&(1!==this.mComments.length||""!==this.mComments[0].text)){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w15","commentsEx",this.wNamespace),this.serializeCommentCommonAttribute(e),this.serializeCommentsExInternal(e,this.mComments,!1),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.commentsExtendedPath);this.mArchive.addItem(t)}},e.prototype.serializeCommentsExInternal=function(e,t,i){for(var r=0;r<t.length;r++){var n=t[parseInt(r.toString(),10)];e.writeStartElement("w15","commentEx",this.wNamespace);var o=this.commentParaIDInfo[n.commentId];if(i){var s=this.commentParaIDInfo[n.ownerComment.commentId];e.writeAttributeString("w15","paraIdParent",this.wNamespace,s.toString())}e.writeAttributeString("w15","paraId",this.wNamespace,o.toString());var a=n.done?1:0;e.writeAttributeString("w15","done",this.wNamespace,a.toString()),e.writeEndElement(),n.replyComments.length>0&&this.serializeCommentsExInternal(e,n.replyComments,!0)}},e.prototype.serializeSectionProperties=function(e,t){sf.base.isNullOrUndefined(this.document.optimizeSfdt)||(this.keywordIndex=this.document.optimizeSfdt?1:0),e.writeStartElement("w","sectPr",this.wNamespace),t[Po[this.keywordIndex]]&&this.serializeHFReference(e,t[Po[this.keywordIndex]]),"NoBreak"===t[No[this.keywordIndex]][Bt[this.keywordIndex]]?this.serializeSectionType(e,"continuous"):this.serializeSectionType(e,"nextPage"),this.serializePageSetup(e,t[No[this.keywordIndex]]),this.serializeColumns(e,t[No[this.keywordIndex]]),this.serializeFootNotesPr(e,t[No[this.keywordIndex]]),this.serializeEndNotesPr(e,t[No[this.keywordIndex]]),void 0!==t[No[this.keywordIndex]]&&x.parseBoolValue(t[No[this.keywordIndex]][ut[this.keywordIndex]])&&(e.writeStartElement(void 0,"titlePg",this.wNamespace),e.writeEndElement()),!sf.base.isNullOrUndefined(t[No[this.keywordIndex]])&&x.parseBoolValue(t[No[this.keywordIndex]][Re[this.keywordIndex]])&&(e.writeStartElement(void 0,"bidi",this.wNamespace),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeFootNotesPr=function(e,t){(t[kt[this.keywordIndex]]||t[St[this.keywordIndex]])&&(e.writeStartElement(void 0,"footnotePr",this.wNamespace),e.writeStartElement(void 0,"pos",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"pageBottom"),e.writeEndElement(),void 0!==t.footNoteNumberFormat&&(e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t[kt[this.keywordIndex]])),e.writeEndElement()),void 0!==t.restartIndexForFootnotes&&(e.writeStartElement(void 0,"numRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t[St[this.keywordIndex]])),e.writeEndElement()),void 0!==t.initialFootNoteNumber&&(e.writeStartElement(void 0,"numStart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Nt[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement())},e.prototype.getFootNoteNumberFormat=function(e){var t;switch(e){case"UpperCaseRoman":case 1:t="upperRoman";break;case"LowerCaseRoman":case 2:t="lowerRoman";break;case"UpperCaseLetter":case 3:t="upperLetter";break;case"LowerCaseLetter":case 4:t="lowerLetter";break;default:t="decimal"}return t},e.prototype.getFootNoteNumberRestart=function(e){switch(e){case"RestartForEachSection ":case 1:return"eachSect";case"RestartForEachPage":case 2:return"eachPage";default:return"continuous"}},e.prototype.getPageNumberFormat=function(e){var t;switch(e){case"RomanUpper":t="upperRoman";break;case"RomanLower":t="lowerRoman";break;case"LetterUpper":t="upperLetter";break;case"LetterLower":t="lowerLetter";break;default:t="Arabic"}return t},e.prototype.serializeEndNotesPr=function(e,t){(t[Wt[this.keywordIndex]]||t[Pt[this.keywordIndex]])&&(e.writeStartElement(void 0,"endnotePr",this.wNamespace),e.writeStartElement(void 0,"pos",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"docEnd"),e.writeEndElement(),void 0!==t[Wt[this.keywordIndex]]&&(e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberFormat(t[Wt[this.keywordIndex]])),e.writeEndElement()),void 0!==t[Pt[this.keywordIndex]]&&(e.writeStartElement(void 0,"numRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getFootNoteNumberRestart(t[Pt[this.keywordIndex]])),e.writeEndElement()),void 0!==t[Ot[this.keywordIndex]]&&(e.writeStartElement(void 0,"numStart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Ot[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement())},e.prototype.serializeColumns=function(e,t){if(void 0!==t[Et[this.keywordIndex]]&&t[Et[this.keywordIndex]]>1){if(e.writeStartElement(void 0,"cols",this.wNamespace),e.writeAttributeString(void 0,"num",this.wNamespace,t[Et[this.keywordIndex]].toString()),x.parseBoolValue(t[Ut[this.keywordIndex]])&&e.writeAttributeString(void 0,"sep",this.wNamespace,"1"),x.parseBoolValue(t[Rt[this.keywordIndex]]))e.writeAttributeString(void 0,"equalWidth",this.wNamespace,"1");else if(e.writeAttributeString(void 0,"equalWidth",this.wNamespace,"0"),void 0!==t[Ht[this.keywordIndex]]&&t[Ht[this.keywordIndex]].length>0)for(var i=0;i<t[Ht[this.keywordIndex]].length;i++)e.writeStartElement(void 0,"col",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[Ht[this.keywordIndex]][parseInt(i.toString(),10)][wr[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"space",this.wNamespace,this.roundToTwoDecimal(t[Ht[this.keywordIndex]][parseInt(i.toString(),10)][ts[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeEndElement();e.writeEndElement()}},e.prototype.serializePageSetup=function(e,t){void 0!==t&&(this.serializePageSize(e,t),this.serializePageMargins(e,t),this.serializePageNumberType(e,t)),x.parseBoolValue(t[Ft[this.keywordIndex]])&&(e.writeStartElement(void 0,"pgNumType",this.wNamespace),e.writeAttributeString(void 0,"start",this.wNamespace,t[Ct[this.keywordIndex]].toString()),e.writeEndElement()),e.writeStartElement(void 0,"pgBorders",this.wNamespace),e.writeEndElement()},e.prototype.serializePageSize=function(e,t){e.writeStartElement(void 0,"pgSz",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[yt[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"h",this.wNamespace,this.roundToTwoDecimal(t[vt[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeEndElement()},e.prototype.serializePageMargins=function(e,t){e.writeStartElement(void 0,"pgMar",this.wNamespace);var i=Math.round(t[xt[this.keywordIndex]]*this.twentiethOfPoint);e.writeAttributeString(void 0,"top",this.wNamespace,i.toString()),i=Math.round(t[bt[this.keywordIndex]]*this.twentiethOfPoint),e.writeAttributeString(void 0,"right",this.wNamespace,i.toString()),i=Math.round(t[It[this.keywordIndex]]*this.twentiethOfPoint),e.writeAttributeString(void 0,"bottom",this.wNamespace,i.toString()),i=Math.round(t[wt[this.keywordIndex]]*this.twentiethOfPoint),e.writeAttributeString(void 0,"left",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"header",this.wNamespace,this.roundToTwoDecimal(t[gt[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"footer",this.wNamespace,this.roundToTwoDecimal(t[ft[this.keywordIndex]]*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"gutter",this.wNamespace,"0"),e.writeEndElement()},e.prototype.serializeSectionType=function(e,t){e.writeStartElement("w","type",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t),e.writeEndElement()},e.prototype.serializeHFReference=function(e,t){var i="";if(void 0!==t){this.mDifferentFirstPage=x.parseBoolValue(this.section[No[this.keywordIndex]][mt[this.keywordIndex]]);var r=t[ko[this.keywordIndex]];r&&r[xo[this.keywordIndex]]&&r[xo[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"FirstPageHeader",i),e.writeEndElement()),(r=t[So[this.keywordIndex]])&&r[xo[this.keywordIndex]]&&r[xo[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"FirstPageFooter",i),e.writeEndElement()),(r=t[Co[this.keywordIndex]])&&r[xo[this.keywordIndex]]&&r[xo[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"EvenHeader",i),e.writeEndElement()),(r=t[Wo[this.keywordIndex]])&&r[xo[this.keywordIndex]]&&r[xo[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"EvenFooter",i),e.writeEndElement()),(r=t[Io[this.keywordIndex]])&&r[xo[this.keywordIndex]]&&r[xo[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"OddHeader",i),e.writeEndElement()),(r=t[Fo[this.keywordIndex]])&&r[xo[this.keywordIndex]]&&r[xo[this.keywordIndex]].length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"OddFooter",i),e.writeEndElement())}},e.prototype.addHeaderFooter=function(e,t,i){var r=new a;this.headersFooters.add(t,r),this.headersFooters.get(t).add(i,e)},e.prototype.serializeBodyItems=function(e,t,i){for(var r=0;r<t.length;r++)this.serializeBodyItem(e,t[parseInt(r.toString(),10)],i)},e.prototype.serializeContentControl=function(e,t,i,r,n){if(sf.base.isNullOrUndefined(t))throw new Error("contentCOntrol should not be undefined");e.writeStartElement("w","sdt",this.wNamespace),e.writeStartElement(void 0,"sdtPr",this.wNamespace),sf.base.isNullOrUndefined(t)||this.serializeContentProperties(e,t,i,r,n)},e.prototype.serializeContentProperties=function(e,t,i,r,n){if(sf.base.isNullOrUndefined(t[En[this.keywordIndex]])||(e.writeStartElement(void 0,"alias",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[En[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement(void 0,"tag",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[Hn[this.keywordIndex]]),e.writeEndElement()),sf.base.isNullOrUndefined(t[q[this.keywordIndex]])||this.serializeCharacterFormat(e,i[Nn[this.keywordIndex]][q[this.keywordIndex]]),(x.parseBoolValue(t[Tn[this.keywordIndex]])||x.parseBoolValue(t[On[this.keywordIndex]]))&&(e.writeStartElement(void 0,"lock",this.wNamespace),x.parseBoolValue(t[On[this.keywordIndex]])&&x.parseBoolValue(t[Tn[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,"sdtContentLocked"):x.parseBoolValue(t[On[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,"sdtLocked"):x.parseBoolValue(t[Tn[this.keywordIndex]])&&e.writeAttributeString("w","val",this.wNamespace,"contentLocked"),e.writeEndElement()),x.parseBoolValue(t[Rn[this.keywordIndex]])&&sf.base.isNullOrUndefined(void 0)&&(e.writeStartElement("w","placeholder",void 0),e.writeAttributeString("w","docPart",this.wNamespace,void 0),e.writeEndElement(),e.writeStartElement("w","showingPlcHdr",void 0),e.writeEndElement()),x.parseBoolValue(t[Bn[this.keywordIndex]])&&(e.writeStartElement("w","temporary",void 0),e.writeEndElement()),sf.base.isNullOrUndefined(t[xs[this.keywordIndex]])||(e.writeStartElement("w15","appearance",void 0),e.writeAttributeString("w15","val",void 0,1==this.keywordIndex?this.getContentControlAppearance(t[xs[this.keywordIndex]]).toLowerCase():t[xs[this.keywordIndex]].toLowerCase()),e.writeEndElement()),sf.base.isNullOrUndefined(t[Br[this.keywordIndex]])||(e.writeStartElement("w15","color",void 0),e.writeAttributeString("w","val",void 0,this.getColor(t[Br[this.keywordIndex]])),e.writeEndElement()),x.parseBoolValue(t[Un[this.keywordIndex]])&&(e.writeStartElement(void 0,"text",this.wNamespace),e.writeAttributeString("w","multiLine",this.wNamespace,"1"),e.writeEndElement()),sf.base.isNullOrUndefined(t[jn[this.keywordIndex]])||x.parseBoolValue(t[jn[this.keywordIndex]][Jn[this.keywordIndex]])&&(e.writeStartElement("w","dataBinding",this.wNamespace),e.writeAttributeString("w","xpath",void 0,t[jn[this.keywordIndex]][Qn[this.keywordIndex]]),e.writeAttributeString("w","storeItemID",void 0,t[jn[this.keywordIndex]][$n[this.keywordIndex]]),e.writeEndElement()),t.picture&&(e.writeStartElement("w","picture",this.wNamespace),e.writeEndElement()),sf.base.isNullOrUndefined(t[Vn[this.keywordIndex]]||t[qn[this.keywordIndex]])||(e.writeStartElement("w14","checkbox",void 0),x.parseBoolValue(t[Dn[this.keywordIndex]])?(e.writeStartElement("w14","checked",void 0),e.writeAttributeString("w14","val",void 0,"1"),e.writeEndElement()):(e.writeStartElement("w14","checked",void 0),e.writeAttributeString("w14","val",void 0,"0"),e.writeEndElement()),t[Vn[this.keywordIndex]]&&(e.writeStartElement("w14","uncheckedState",void 0),e.writeAttributeString("w14","val",void 0,this.toUnicode(t[Vn[this.keywordIndex]][Kn[this.keywordIndex]])),e.writeAttributeString("w14","font",void 0,t[Vn[this.keywordIndex]][Gn[this.keywordIndex]]),e.writeEndElement()),t[qn[this.keywordIndex]]&&(e.writeStartElement("w14","checkedState",void 0),e.writeAttributeString("w14","val",void 0,this.toUnicode(t[qn[this.keywordIndex]][Kn[this.keywordIndex]])),e.writeAttributeString("w14","font",void 0,t[qn[this.keywordIndex]][Gn[this.keywordIndex]]),e.writeEndElement()),e.writeEndElement()),!sf.base.isNullOrUndefined(t[_n[this.keywordIndex]])&&t[hs[this.keywordIndex]]===(1==this.keywordIndex?5:"DropDownList")){var o=t[_n[this.keywordIndex]];e.writeStartElement(void 0,"dropDownList",this.wNamespace),this.serializeContentControlList(e,o),e.writeEndElement()}if(!sf.base.isNullOrUndefined(t[_n[this.keywordIndex]])&&t[hs[this.keywordIndex]]===(1==this.keywordIndex?3:"ComboBox")){var s=t[_n[this.keywordIndex]];e.writeStartElement(void 0,"comboBox",this.wNamespace),this.serializeContentControlList(e,s),e.writeEndElement()}if(this.serializeContentControlDate(e,t),sf.base.isNullOrUndefined(t[hs[this.keywordIndex]])||t[hs[this.keywordIndex]]===(1==this.keywordIndex?7:"Picture")&&(e.writeStartElement(void 0,"picture",this.wNamespace),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("w","sdtContent",this.wNamespace),!n){if(i.hasOwnProperty(xo[this.keywordIndex])&&sf.base.isNullOrUndefined(i[io[this.keywordIndex]]))for(var l=0;l<i[xo[this.keywordIndex]].length;l++){var d=i[xo[this.keywordIndex]][l];if(d.hasOwnProperty(Pn[this.keywordIndex]))this.paragraph=d,this.serializeParagraph(e,d,r),this.paragraph=void 0;else if(d.hasOwnProperty(ro[this.keywordIndex])){var h=new a;this.serializeRow(e,d,h)}else if(d.hasOwnProperty(Nn[this.keywordIndex]))this.serializeContentControl(e,d[Nn[this.keywordIndex]],d,r);else{var c=d;this.serializeTable(e,c)}}else if(i.hasOwnProperty(ro[this.keywordIndex])){if(i[no[this.keywordIndex]].length>0){h=new a;this.serializeRow(e,i,h)}}else if(i.hasOwnProperty(io[this.keywordIndex])){h=new a;this.serializeCell(e,i,h)}e.writeEndElement(),e.writeEndElement()}},e.prototype.toUnicode=function(e){return e.charCodeAt(0).toString(16)},e.prototype.serializeContentControlList=function(e,t){for(var i=0;i<t.length;i++)e.writeStartElement(void 0,"listItem",this.wNamespace),sf.base.isNullOrUndefined(t[i][Xn[this.keywordIndex]])||e.writeAttributeString("w","displayText",this.wNamespace,t[i][Xn[this.keywordIndex]]),e.writeAttributeString("w","value",this.wNamespace,t[i][Kn[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeContentParagraph=function(e,t){for(var i=0;i<t[xo[this.keywordIndex]].length;i++){var r=t[xo[this.keywordIndex]][i];if(r.hasOwnProperty(Pn[this.keywordIndex]))for(var n=0;n<r[Pn[this.keywordIndex]].length;n++){var o=r[Pn[this.keywordIndex]][n];sf.base.isNullOrUndefined(o[q[this.keywordIndex]])||this.serializeCharacterFormat(e,o[q[this.keywordIndex]])}}},e.prototype.serializeContentControlDate=function(e,t){t[hs[this.keywordIndex]]===(1==this.keywordIndex?4:"Date")&&(e.writeStartElement("w","date",this.wNamespace),sf.base.isNullOrUndefined(t[Ln[this.keywordIndex]])||(e.writeStartElement("w","calender",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex?this.getDateCalendarType(t[Ln[this.keywordIndex]]):t[Ln[this.keywordIndex]]),e.writeEndElement()),sf.base.isNullOrUndefined(t[Mn[this.keywordIndex]])||(e.writeStartElement("w","lid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Mn[this.keywordIndex]]),e.writeEndElement()),sf.base.isNullOrUndefined(t[An[this.keywordIndex]])||(e.writeStartElement("w","storeMappedDataAs",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex?this.getDateStorageFormat(t[An[this.keywordIndex]]):t[An[this.keywordIndex]]),e.writeEndElement()),sf.base.isNullOrUndefined(t[zn[this.keywordIndex]])||(e.writeStartElement("w","dateFormat",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[zn[this.keywordIndex]]),e.writeEndElement()),e.writeEndElement())},e.prototype.serializeBodyItem=function(e,t,i){if(sf.base.isNullOrUndefined(t))throw new Error("BodyItem should not be undefined");if(t.hasOwnProperty(Nn[this.keywordIndex]))this.serializeContentControl(e,t[Nn[this.keywordIndex]],t,i);else if(t.hasOwnProperty(Pn[this.keywordIndex]))this.paragraph=t,this.serializeParagraph(e,t,i),this.paragraph=void 0;else{for(var r=t,n=0;n<r[oo[this.keywordIndex]].length;n++)if(r[oo[this.keywordIndex]][n][no[this.keywordIndex]].length>0){this.serializeTable(e,r);break}var o=this.blockOwner;!i&&o.hasOwnProperty(No[this.keywordIndex])&&o[xo[this.keywordIndex]].indexOf(r)===o[xo[this.keywordIndex]].length-1&&(e.writeStartElement("w","p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeSectionProperties(e,o),e.writeEndElement(),e.writeEndElement())}},e.prototype.serializeParagraph=function(e,t,i){if(sf.base.isNullOrUndefined(t))throw new Error("Paragraph should not be undefined");sf.base.isNullOrUndefined(this.document.optimizeSfdt)||(this.keywordIndex=this.document.optimizeSfdt?1:0),e.writeStartElement("w","p",this.wNamespace),this.isInsideComment&&e.writeAttributeString("w14","paraId",void 0,this.commentParaID.toString()),e.writeStartElement(void 0,"pPr",this.wNamespace),sf.base.isNullOrUndefined(t[_[this.keywordIndex]])||this.serializeParagraphFormat(e,t[_[this.keywordIndex]],t),sf.base.isNullOrUndefined(t[q[this.keywordIndex]])||this.serializeCharacterFormat(e,t[q[this.keywordIndex]]);var r=this.blockOwner;!i&&r.hasOwnProperty(No[this.keywordIndex])&&r[xo[this.keywordIndex]].indexOf(t)===r[xo[this.keywordIndex]].length-1&&this.serializeSectionProperties(e,r),e.writeEndElement(),this.prevRevisionIds=[],this.serializeParagraphItems(e,t[Pn[this.keywordIndex]]),this.isBookmarkAtEnd||this.isBookmarkAtRowEnd||e.writeEndElement(),this.isBookmarkAtEnd=!1},e.prototype.serializeRevisionStart=function(e,t,i){if(t.hasOwnProperty(Ge[this.keywordIndex])){if(!sf.base.isNullOrUndefined(i)&&i.hasOwnProperty(qo[this.keywordIndex])&&0===i[qo[this.keywordIndex]]&&!(i[ye[this.keywordIndex]].indexOf("_Toc")>=0)&&sf.base.isNullOrUndefined(t[Ge[this.keywordIndex]]))return;for(var r=t[Ge[this.keywordIndex]],n=0;n<r.length;n++){var o=this.retrieveRevision(r[n]);"Insertion"===o.revisionType&&this.serializeTrackChanges(e,"ins",o.author,o.date),"Deletion"===o.revisionType&&this.serializeTrackChanges(e,"del",o.author,o.date)}}},e.prototype.serializeTrackChanges=function(e,t,i,r){e.writeStartElement("w",t,this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,(this.trackChangesId++).toString()),"Unknown"!=i&&e.writeAttributeString("w","author",this.wNamespace,i),e.writeAttributeString("w","date",this.wNamespace,r)},e.prototype.retrieveRevision=function(e){for(var t=0;t<this.revisions.length;t++)if(this.revisions[t].revisionID===e)return this.revisions[t]},e.prototype.serializeParagraphItems=function(e,t){if(sf.base.isNullOrUndefined(t))throw new Error("Paragraph should not be undefined");for(var i,r=void 0,n=!1,o=0;o<t.length;o++){var s=t[o];s.hasOwnProperty(Nn[this.keywordIndex])&&(i=!0,this.serializeContentControl(e,s[Nn[this.keywordIndex]],s,void 0,i),this.serializeParagraphItems(e,s[Pn[this.keywordIndex]])),s.hasOwnProperty(Pn[this.keywordIndex])&&this.serializeParagraphItems(e,s),this.serializeRevisionStart(e,s,r);var a=!1;if(s[q[this.keywordIndex]]&&(a=!sf.base.isNullOrUndefined(s[q[this.keywordIndex]][Ue[this.keywordIndex]])&&"None"!==s[q[this.keywordIndex]][Ue[this.keywordIndex]])&&!n&&(this.serializeBiDirectionalOverride(e,s[q[this.keywordIndex]]),n=!0),n&&!a&&(e.writeEndElement(),n=!1),s.hasOwnProperty(Zr[this.keywordIndex]))this.serializeFieldCharacter(e,s);else if(s.hasOwnProperty(Mr[this.keywordIndex]))this.serializePicture(e,s);else if(s.hasOwnProperty(fr[this.keywordIndex])){var l=this.paragraph;this.serializeShape(e,s),this.paragraph=l}else s.hasOwnProperty(qo[this.keywordIndex])?this.serializeBookMark(e,s):s.hasOwnProperty(Jo[this.keywordIndex])?this.serializeEditRange(e,s):s.hasOwnProperty(dr[this.keywordIndex])?(this.chart=s,this.serializeChart(e,s),this.serializeChartStructure()):s.hasOwnProperty(fn[this.keywordIndex])?this.serializeComment(e,s):s.hasOwnProperty(Cn[this.keywordIndex])?this.serializeEFReference(e,s):this.serializeTextRange(e,s,r);this.serializeRevisionEnd(e,s,r),r=s,i&&(e.writeEndElement(),e.writeEndElement(),i=!1)}n&&e.writeEndElement()},e.prototype.serializeEFReference=function(e,t){var i="",r=t[xo[this.keywordIndex]];t[Cn[this.keywordIndex]]===(1==this.keywordIndex?0:"Footnote")?(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[q[this.keywordIndex]]),e.writeStartElement(void 0,"footnoteReference",this.wNamespace),this.document[pe[this.keywordIndex]][Vo[this.keywordIndex]]&&0===this.efRelationShipId&&(this.efRelationShipId=1),i=this.getEFNextRelationShipID(),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(r,"footnote",i),e.writeEndElement(),e.writeEndElement()):(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[q[this.keywordIndex]]),e.writeStartElement(void 0,"endnoteReference",this.wNamespace),i=this.getEFNextRelationShipID(),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.addFootnotesEndnotes(r,"endnote",i),e.writeEndElement(),e.writeEndElement())},e.prototype.addFootnotesEndnotes=function(e,t,i){var r=new a;this.endnotesFootnotes.add(t,r),this.endnotesFootnotes.get(t).add(i,e)},e.prototype.serializeEndnotesFootnote=function(e,t){if(0!==this.endnotesFootnotes.length&&this.endnotesFootnotes.containsKey(t))for(var i=this.endnotesFootnotes.get(t),r=void 0,n=0;n<i.keys.length;n++){var o=i.keys[n];r=i.get(o),"endnote"===t?(this.endnotesPath,this.endnotesRelationPath,this.serializeInlineEndnotes(e,r,o)):(this.footnotesPath,this.footnotesRelationPath,this.serializeInlineFootnotes(e,r,o))}},e.prototype.serializeInlineEndnotes=function(e,t,i){this.isSerializeFootEndNote="Endnote",this.endNoteFootnote=t;var r=this.blockOwner;this.blockOwner=t,e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.serializeBodyItems(e,t,!0),e.writeEndElement(),this.blockOwner=r,this.endNoteFootnote=void 0,this.isSerializeFootEndNote=void 0},e.prototype.serializeInlineFootnotes=function(e,t,i){this.isSerializeFootEndNote="Footnote",this.endNoteFootnote=t;var r=this.blockOwner;this.blockOwner=t,e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,i),this.serializeBodyItems(e,t,!0),e.writeEndElement(),this.blockOwner=r,this.endNoteFootnote=void 0,this.isSerializeFootEndNote=void 0},e.prototype.writeEFCommonAttributes=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","cx",void 0,this.cxNamespace),e.writeAttributeString("xmlns","aink",void 0,"http://schemas.microsoft.com/office/drawing/2016/ink"),e.writeAttributeString("xmlns","am3d",void 0,"http://schemas.microsoft.com/office/drawing/2017/,odel3d"),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15")},e.prototype.serializeFootnotes=function(){if(!sf.base.isNullOrUndefined(this.document[pe[this.keywordIndex]])){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","footnotes",this.wNamespace),this.writeEFCommonAttributes(e),e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"separator"),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(e,this.document[pe[this.keywordIndex]][zo[this.keywordIndex]],!0),e.writeEndElement(),e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(e,this.document[pe[this.keywordIndex]][Do[this.keywordIndex]],!0),e.writeEndElement(),this.document[pe[this.keywordIndex]][Vo[this.keywordIndex]]&&(e.writeStartElement("w","footnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),e.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(e,this.document[pe[this.keywordIndex]][Vo[this.keywordIndex]],!0),e.writeEndElement()),this.serializeEndnotesFootnote(e,"footnote"),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.footnotesPath);this.mArchive.addItem(t)}},e.prototype.serializeEndnotes=function(){if(!sf.base.isNullOrUndefined(this.document[ge[this.keywordIndex]])){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","endnotes",this.wNamespace),this.writeEFCommonAttributes(e),e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"separator"),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),this.serializeBodyItems(e,this.document[ge[this.keywordIndex]][zo[this.keywordIndex]],!0),e.writeEndElement(),e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationSeparator"),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),this.serializeBodyItems(e,this.document[ge[this.keywordIndex]][Do[this.keywordIndex]],!0),e.writeEndElement(),this.document[ge[this.keywordIndex]][Vo[this.keywordIndex]]&&(e.writeStartElement("w","endnote",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"continuationNotice"),e.writeAttributeString(void 0,"id",this.wNamespace,"1"),this.serializeBodyItems(e,this.document[ge[this.keywordIndex]][Vo[this.keywordIndex]],!0),e.writeEndElement()),this.serializeEndnotesFootnote(e,"endnote"),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.endnotesPath);this.mArchive.addItem(t)}},e.prototype.serializeRevisionEnd=function(e,t,i){if(t.hasOwnProperty(Ge[this.keywordIndex])){if(!sf.base.isNullOrUndefined(i)&&i.hasOwnProperty(Zr[this.keywordIndex])&&0===i[Zr[this.keywordIndex]]&&t[gr[this.keywordIndex]].indexOf("TOC")>=0)return;for(var r=0;r<t[Ge[this.keywordIndex]].length;r++){var n=this.retrieveRevision(t[Ge[this.keywordIndex]][r]);"Insertion"!==n.revisionType&&"Deletion"!==n.revisionType||e.writeEndElement()}}},e.prototype.serializeComment=function(e,t){if(1!==this.mComments.length||""!==this.mComments[0].text){0===t[fn[this.keywordIndex]]?e.writeStartElement("w","commentRangeStart",this.wNamespace):1===t[fn[this.keywordIndex]]&&e.writeStartElement("w","commentRangeEnd",this.wNamespace);var i=this.commentId[t[gn[this.keywordIndex]]];sf.base.isNullOrUndefined(i)&&(i=this.commentId[t[gn[this.keywordIndex]]]=this.currentCommentId++),e.writeAttributeString("w","id",this.wNamespace,i.toString()),e.writeEndElement(),1===t[fn[this.keywordIndex]]&&this.serializeCommentItems(e,i)}},e.prototype.serializeCommentItems=function(e,t){e.writeStartElement("w","r",this.wNamespace),e.writeStartElement("w","commentReference",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,t.toString()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeBiDirectionalOverride=function(e,t){e.writeStartElement(void 0,"bdo",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex?this.getBiDirectionalOverride(t[Ue[this.keywordIndex]]).toLowerCase():t[Ue[this.keywordIndex]].toLowerCase())},e.prototype.serializeEditRange=function(e,t){t.hasOwnProperty(es[this.keywordIndex])?e.writeStartElement("w","permEnd",this.wNamespace):(e.writeStartElement("w","permStart",this.wNamespace),t[Qo[this.keywordIndex]]&&""!==t[Qo[this.keywordIndex]]&&e.writeAttributeString("w","ed",this.wNamespace,t[Qo[this.keywordIndex]]),t[$o[this.keywordIndex]]&&""!==t[$o[this.keywordIndex]]&&e.writeAttributeString("w","edGrp",this.wNamespace,t[$o[this.keywordIndex]].toLowerCase()),t[Yo[this.keywordIndex]]&&-1!==t[Yo[this.keywordIndex]]&&e.writeAttributeString("w","colFirst",this.wNamespace,t[Yo[this.keywordIndex]].toString()),t[Zo[this.keywordIndex]]&&-1!==t[Zo[this.keywordIndex]]&&e.writeAttributeString("w","colLast",this.wNamespace,t[Zo[this.keywordIndex]].toString())),e.writeAttributeString("w","id",this.wNamespace,t[Jo[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeBookMark=function(e,t){var i=this.getBookmarkId(t[ye[this.keywordIndex]]),r=t[ye[this.keywordIndex]];0===t[qo[this.keywordIndex]]?(e.writeStartElement("w","bookmarkStart",this.wNamespace),e.writeAttributeString("w","name",this.wNamespace,r),sf.base.isNullOrUndefined(t[_o[this.keywordIndex]])||(e.writeAttributeString("w","colFirst",this.wNamespace,t[_o[this.keywordIndex]][Yo[this.keywordIndex]].toString()),e.writeAttributeString("w","colLast",this.wNamespace,t[_o[this.keywordIndex]][Zo[this.keywordIndex]].toString()))):1===t[qo[this.keywordIndex]]&&(sf.base.isNullOrUndefined(t[_o[this.keywordIndex]])||this.isBookmarkAtEnd||this.isBookmarkAtRowEnd||(x.parseBoolValue(t[_o[this.keywordIndex]][Os[this.keywordIndex]])?(e.writeEndElement(),this.isBookmarkAtEnd=!0):x.parseBoolValue(t[_o[this.keywordIndex]][Hs[this.keywordIndex]])&&(e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),this.isBookmarkAtRowEnd=!0)),e.writeStartElement("w","bookmarkEnd",this.wNamespace)),e.writeAttributeString("w","id",this.wNamespace,i.toString()),e.writeEndElement()},e.prototype.getBookmarkId=function(e){var t=this.bookmarks.indexOf(e);return t<0&&(t=this.bookmarks.length,this.bookmarks.push(e)),t},e.prototype.serializePicture=function(e,t){t[wr[this.keywordIndex]]>=0&&t[br[this.keywordIndex]]>=0&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[q[this.keywordIndex]]),this.serializeDrawing(e,t),e.writeEndElement())},e.prototype.serializeShape=function(e,t){t[wr[this.keywordIndex]]>=0&&t[br[this.keywordIndex]]>=0&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[q[this.keywordIndex]]),t[vr[this.keywordIndex]]>0?this.serializeHorizontalRule(e,t):this.serializeDrawing(e,t),e.writeEndElement())},e.prototype.serializeHorizontalRule=function(e,t){e.writeStartElement(void 0,"pict",this.wNamespace),e.writeStartElement("v","rect",void 0);var i=Math.round(t[wr[this.keywordIndex]]),r=Math.round(t[br[this.keywordIndex]]);if(e.writeAttributeString(void 0,"style",void 0,"width:"+i.toString()+";height:"+r.toString()),t[wo[this.keywordIndex]]>0){var n=1==this.keywordIndex?this.getShapeHorizontalAlignment(t[wo[this.keywordIndex]]):t[wo[this.keywordIndex]].toString();e.writeAttributeString("o","hralign",void 0,n.toLowerCase())}e.writeAttributeString("o","hrstd",void 0,"t"),e.writeAttributeString("o","hr",void 0,"t"),e.writeAttributeString(void 0,"fillcolor",void 0,this.getColor(t[Cr[this.keywordIndex]][Br[this.keywordIndex]])),e.writeAttributeString(void 0,"stroked",void 0,"f"),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDrawing=function(e,t){e.writeStartElement(void 0,"drawing",this.wNamespace),t.hasOwnProperty(dr[this.keywordIndex])?this.serializeInlineCharts(e,t):t[Wr[this.keywordIndex]]===(1==this.keywordIndex?0:"Inline")?this.serializeInlinePictureAndShape(e,t):this.serializeWrappingPictureAndShape(e,t),e.writeEndElement()},e.prototype.serializeWrappingPictureAndShape=function(e,t){sf.base.isNullOrUndefined(this.document.optimizeSfdt)||(this.keywordIndex=this.document.optimizeSfdt?1:0),e.writeStartElement("wp","anchor",this.wpNamespace),this.serializePictureAndShapeDistance(e,t),e.writeAttributeString(void 0,"simplePos",void 0,"0"),e.writeAttributeString(void 0,"relativeHeight",void 0,t[Tr[this.keywordIndex]]?Math.abs(t[Tr[this.keywordIndex]]).toString():"0");var i=t[Wr[this.keywordIndex]]&&t[Wr[this.keywordIndex]]===(1==this.keywordIndex?4:"Behind");e.writeAttributeString(void 0,"behindDoc",void 0,i?"1":"0");var r=1==this.keywordIndex?sf.base.isNullOrUndefined(t[Er[this.keywordIndex]])?"0":t[Er[this.keywordIndex]].toString():t[Er[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"locked",void 0,r);var n=1==this.keywordIndex?sf.base.isNullOrUndefined(t[Hr[this.keywordIndex]])?"0":t[Hr[this.keywordIndex]].toString():t[Hr[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"layoutInCell",void 0,n);var o=1==this.keywordIndex?sf.base.isNullOrUndefined(t[co[this.keywordIndex]])?"0":t[co[this.keywordIndex]].toString():t[co[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"allowOverlap",void 0,o),e.writeStartElement("wp","simplePos",this.wpNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("wp","positionH",this.wpNamespace);var s=1==this.keywordIndex?this.getHorizontalOrigin(t[vo[this.keywordIndex]]):t[vo[this.keywordIndex]].toString();if(e.writeAttributeString(void 0,"relativeFrom",void 0,x.formatText("firstlower",s)),t[wo[this.keywordIndex]]===(1==this.keywordIndex?0:"None")){e.writeStartElement("wp","posOffset",this.wpNamespace);var a=Math.round(t[bo[this.keywordIndex]]*this.emusPerPoint);e.writeString(a.toString()),e.writeEndElement()}else{e.writeStartElement("wp","align",this.wpNamespace);var l=1==this.keywordIndex?this.getShapeHorizontalAlignment(t[wo[this.keywordIndex]]):t[wo[this.keywordIndex]].toString();e.writeString(l.toLowerCase()),e.writeEndElement()}e.writeEndElement(),e.writeStartElement("wp","positionV",this.wpNamespace);var d=1==this.keywordIndex?this.getVerticalOrigin(t[mo[this.keywordIndex]]):t[mo[this.keywordIndex]].toString();if(e.writeAttributeString(void 0,"relativeFrom",void 0,x.formatText("firstlower",d)),t[zt[this.keywordIndex]]===(1==this.keywordIndex?0:"None")){e.writeStartElement("wp","posOffset",this.wpNamespace);var h=Math.round(t[yo[this.keywordIndex]]*this.emusPerPoint);e.writeString(h.toString()),e.writeEndElement()}else{e.writeStartElement("wp","align",this.wpNamespace);var c=1==this.keywordIndex?this.getShapeVerticalAlignment(t[zt[this.keywordIndex]]):t[zt[this.keywordIndex]];e.writeString(c.toLowerCase()),e.writeEndElement()}e.writeEndElement(),e.writeStartElement(void 0,"extent",this.wpNamespace);var p=Math.round(t[wr[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,p.toString());var g=Math.round(t[br[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,g.toString()),e.writeEndElement(),sf.base.isNullOrUndefined(t[Mr[this.keywordIndex]])?this.serializeShapeDrawingGraphics(e,t):(this.serializeShapeWrapStyle(e,t),this.serializeDrawingGraphics(e,t)),e.writeEndElement()},e.prototype.serializeInlinePictureAndShape=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),this.writeDefaultDistAttribute(e),e.writeStartElement(void 0,"extent",this.wpNamespace);var i=Math.round(t[wr[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,i.toString());var r=Math.round(t[br[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,r.toString()),e.writeEndElement(),sf.base.isNullOrUndefined(t[Mr[this.keywordIndex]])?this.serializeShapeDrawingGraphics(e,t):(this.serializeShapeWrapStyle(e,t),this.serializeDrawingGraphics(e,t)),e.writeEndElement()},e.prototype.serializePictureAndShapeDistance=function(e,t){var i=t[po[this.keywordIndex]]?Math.round(t[po[this.keywordIndex]]*this.emusPerPoint).toString():"0";e.writeAttributeString(void 0,"distT",void 0,i);var r=t[uo[this.keywordIndex]]?Math.round(t[uo[this.keywordIndex]]*this.emusPerPoint).toString():"0";e.writeAttributeString(void 0,"distB",void 0,r);var n=t[fo[this.keywordIndex]]?Math.round(t[fo[this.keywordIndex]]*this.emusPerPoint).toString():"114300";e.writeAttributeString(void 0,"distL",void 0,n);var o=t[go[this.keywordIndex]]?Math.round(t[go[this.keywordIndex]]*this.emusPerPoint).toString():"114300";e.writeAttributeString(void 0,"distR",void 0,o)},e.prototype.writeDefaultDistAttribute=function(e){e.writeAttributeString(void 0,"distT",void 0,"0"),e.writeAttributeString(void 0,"distB",void 0,"0"),e.writeAttributeString(void 0,"distL",void 0,"0"),e.writeAttributeString(void 0,"distR",void 0,"0")},e.prototype.serializeInlineCharts=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),this.writeDefaultDistAttribute(e),e.writeStartElement(void 0,"extent",this.wpNamespace);var i=Math.round(t[wr[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,i.toString());var r=Math.round(t[br[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,r.toString()),e.writeEndElement(),e.writeStartElement(void 0,"effectExtent",this.wpNamespace),e.writeAttributeString(void 0,"l",void 0,"0"),e.writeAttributeString(void 0,"t",void 0,"0"),e.writeAttributeString(void 0,"r",void 0,"0"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeEndElement(),this.serializeDrawingGraphicsChart(e,t),e.writeEndElement()},e.prototype.serializeDrawingGraphicsChart=function(e,t){var i;i=this.updatechartId(t),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,this.getNextChartName()),e.writeEndElement(),e.writeStartElement("wp","cNvGraphicFramePr",this.wpNamespace),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.chartNamespace),e.writeStartElement("c","chart",this.chartNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("r","id",void 0,i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.getBase64ImageString=function(e){var t=sf.base.isNullOrUndefined(e[zr[this.keywordIndex]])?this.mImages.get(parseInt(e[Mr[this.keywordIndex]])):this.mImages.get(parseInt(e[zr[this.keywordIndex]])),i=t[x.parseBoolValue(e[Vr[this.keywordIndex]])?1:0];return{imageString:i,metaFileImageString:t[this.startsWith(i,"https://")||this.startsWith(i,"http://")||this.startsWith(i,"file://")?1:0]}},e.prototype.getNextChartName=function(){return"Chart"+ ++this.chartCount},e.prototype.serializeChart=function(e,t){e.writeStartElement("w","r",this.wNamespace),this.serializeCharacterFormat(e,t[q[this.keywordIndex]]),this.serializeDrawing(e,t),e.writeEndElement()},e.prototype.serializeChartStructure=function(){this.serializeChartXML(),this.serializeChartColors(),this.serializeChartExcelData(),this.serializeChartRelations(),this.chart=void 0,this.saveExcel()},e.prototype.serializeChartXML=function(){var e,t=new sf.fileutils.XmlWriter;t.writeStartElement("c","chartSpace",this.chartNamespace),t.writeAttributeString("xmlns","a",void 0,this.aNamespace),t.writeAttributeString("xmlns","r",void 0,this.rNamespace),t.writeAttributeString("xmlns","c16r2",void 0,this.c15Namespace),this.serializeChartData(t,this.chart),t.writeStartElement("c","externalData",this.chartNamespace),t.writeAttributeString("r","id",void 0,"rId1"),t.writeStartElement("c","autoUpdate",this.chartNamespace),t.writeAttributeString(void 0,"val",void 0,"0"),t.writeEndElement(),t.writeEndElement(),t.writeEndElement(),e=this.chartPath+"/chart"+this.chartCount+".xml";var i=new sf.compression.ZipArchiveItem(t.buffer,e);this.mArchive.addItem(i)},e.prototype.serializeChartColors=function(){var e=new sf.fileutils.XmlWriter,t="";e.writeStartElement("cs","colorStyle",this.csNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString(void 0,"meth",void 0,"cycle"),e.writeAttributeString(void 0,"id",void 0,"10"),this.serializeChartColor(e),t=this.chartPath+"/colors"+this.chartCount+".xml",e.writeEndElement();var i=new sf.compression.ZipArchiveItem(e.buffer,t);this.mArchive.addItem(i),t=""},e.prototype.serializeChartColor=function(e){for(var t=1;t<=6;t++)e.writeStartElement("a","schemeClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"accent"+t),e.writeEndElement();e.writeStartElement("cs","variation",this.csNamespace),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"60000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"80000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"20000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"80000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"60000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"40000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"70000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"30000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"70000"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("cs","variation",this.csNamespace),e.writeStartElement("a","lumMod",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeStartElement("a","lumOff",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"50000"),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartExcelData=function(){sf.base.isNullOrUndefined(this.excelFiles)&&(this.excelFiles=new a),this.mArchiveExcel=new sf.compression.ZipArchive,this.mArchiveExcel.compressionLevel="Normal";var e=this.chart[dr[this.keywordIndex]],t="Scatter_Markers"===e||"Bubble"===e;this.serializeWorkBook(),this.serializeSharedString(t),this.serializeExcelContentTypes(),this.serializeExcelData(t),this.serializeExcelStyles(),this.serializeExcelRelation(),this.serializeExcelGeneralRelations(),this.chartStringCount=0},e.prototype.serializeWorkBook=function(){var e=new sf.fileutils.XmlWriter;this.resetExcelRelationShipId(),e.writeStartElement(void 0,"workbook",void 0),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),e.writeStartElement(void 0,"sheets",void 0),e.writeStartElement(void 0,"sheet",void 0),e.writeAttributeString(void 0,"name",void 0,"Sheet1"),e.writeAttributeString(void 0,"sheetId",void 0,"1"),e.writeAttributeString("r","id",void 0,this.getNextExcelRelationShipID()),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,"xl/workbook.xml");this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelStyles=function(){var e=new sf.fileutils.XmlWriter;e.writeStartElement(void 0,"styleSheet",void 0),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("mc","Ignorable",void 0,"x14ac"),e.writeAttributeString("xmlns","x14ac",void 0,"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"),e.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,"xl/styles.xml");this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelData=function(e){var t=new sf.fileutils.XmlWriter;t.writeStartElement(void 0,"worksheet",void 0),t.writeAttributeString("xmlns","r",void 0,this.rNamespace),t.writeAttributeString("xmlns","x14",void 0,this.spreadSheet9),t.writeAttributeString("xmlns","mc",void 0,this.veNamespace),t.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),this.serializeExcelSheet(t,e),t.writeEndElement();var i=new sf.compression.ZipArchiveItem(t.buffer,"xl/worksheets/sheet1.xml");this.mArchiveExcel.addItem(i)},e.prototype.serializeSharedString=function(e){for(var t=this.chart,i=new sf.fileutils.XmlWriter,r=[],n=this.chart[dr[this.keywordIndex]],o=t[tr[this.keywordIndex]].length,s=0;s<o;s++){var a=t[tr[this.keywordIndex]][s],l=a[Ri[this.keywordIndex]].match(/[a-z]/i);e&&0===s&&r.push("X-Values"),l&&(r.push(a[Ri[this.keywordIndex]]),this.chartStringCount++)}"Bubble"===n&&r.push("Size");for(var d=0;d<t[er[this.keywordIndex]].length;d++){var h=t[er[this.keywordIndex]][d],c=t[sr[this.keywordIndex]].numberFormat;((l=h[vi[this.keywordIndex]].match(/[a-z]/i))||"m/d/yyyy"===c)&&(r.push(h[vi[this.keywordIndex]]),this.chartStringCount++)}var p=this.chartStringCount+1;i.writeStartElement(void 0,"sst",void 0),i.writeAttributeString("xmlns",void 0,void 0,this.spreadSheetNamespace),i.writeAttributeString(void 0,"count",void 0,p.toString()),i.writeAttributeString(void 0,"uniqueCount",void 0,p.toString());for(var g=0;g<=r.length;g++)i.writeStartElement(void 0,"si",void 0),i.writeStartElement(void 0,"t",void 0),g!==r.length?i.writeString(r[g]):e||(i.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),i.writeString(" ")),i.writeEndElement(),i.writeEndElement();i.writeEndElement();var f=new sf.compression.ZipArchiveItem(i.buffer,"xl/sharedStrings.xml");this.mArchiveExcel.addItem(f)},e.prototype.serializeExcelSheet=function(e,t){var i,r=this.chart,n="s",o="Bubble"===r[dr[this.keywordIndex]],s=r[er[this.keywordIndex]].length+1,a=r[sr[this.keywordIndex]][Uo[this.keywordIndex]],l=r[tr[this.keywordIndex]].length+1;o&&(i=l,l+=1);var d=void 0,h=void 0,c=0;e.writeStartElement(void 0,"sheetData",void 0);for(var p=0;p<s;p++){e.writeStartElement(void 0,"row",void 0),e.writeAttributeString(void 0,"r",void 0,(p+1).toString());for(var g=0;g<l;g++){var f=String.fromCharCode("A".charCodeAt(0)+g)+(p+1).toString();if(e.writeStartElement(void 0,"c",void 0),e.writeAttributeString(void 0,"r",void 0,f),0!==p&&0===g){var u=(d=r[er[this.keywordIndex]][p-1])[vi[this.keywordIndex]].match(/[a-z]/i);n=sf.base.isNullOrUndefined(u)&&"m/d/yyyy"===a?"s":!u||t?"n":"s"}else if(0===p&&0!==g&&g!==i){n=(u=(h=r[tr[this.keywordIndex]][g-1])[Ri[this.keywordIndex]].match(/[a-z]/i))?"s":"n"}else n=0===p&&o&&g===i||0===p&&0===g?"s":"n";if(e.writeAttributeString(void 0,"t",void 0,n),e.writeStartElement(void 0,"v",void 0),0!==p||0!==g||t){if("s"===n&&c<this.chartStringCount)e.writeString(c.toString()),c++;else if(0!==p&&"s"!==n&&0===g&&g!==i)e.writeString(d[vi[this.keywordIndex]]);else if(0!==g&&"s"!==n&&0===p&&g!==i)e.writeString(h[Ri[this.keywordIndex]]);else if(0!==g&&g!==i){var m=d[yi[this.keywordIndex]][g-1][mi[this.keywordIndex]];e.writeString(m.toString())}else if(o&&g===i){var y=d[yi[this.keywordIndex]][g-2][dn[this.keywordIndex]];e.writeString(y.toString())}}else e.writeString(this.chartStringCount.toString());e.writeEndElement(),e.writeEndElement(),n=""}e.writeEndElement()}e.writeEndElement()},e.prototype.serializeExcelContentTypes=function(){var e=new sf.fileutils.XmlWriter;e.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(e,"xml",this.xmlContentType),this.serializeDefaultContentType(e,"rels",this.relationContentType),this.serializeOverrideContentType(e,"xl/styles.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"),this.serializeOverrideContentType(e,"xl/workbook.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"),this.serializeOverrideContentType(e,"xl/sharedStrings.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"),this.serializeOverrideContentType(e,"xl/worksheets/sheet1.xml","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.contentTypesPath);this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelRelation=function(){var e=new sf.fileutils.XmlWriter;this.resetExcelRelationShipId();e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","worksheets/sheet1.xml"),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedStrings.xml"),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.excelRelationPath);this.mArchiveExcel.addItem(t)},e.prototype.serializeExcelGeneralRelations=function(){var e=new sf.fileutils.XmlWriter;this.resetExcelRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextExcelRelationShipID(),this.documentRelType,"xl/workbook.xml"),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.generalRelationPath);this.mArchiveExcel.addItem(t)},e.prototype.getNextExcelRelationShipID=function(){return"rId"+ ++this.eRelationShipId},e.prototype.getNextChartRelationShipID=function(){return"rId"+ ++this.cRelationShipId},e.prototype.serializeChartData=function(e,t){e.writeStartElement("c","date1904",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","lang",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"en-US"),e.writeEndElement(),e.writeStartElement("c","roundedCorners",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("mc","AlternateContent",this.veNamespace),e.writeStartElement("mc","Choice",this.veNamespace),e.writeAttributeString("xmlns","c14",void 0,this.c7Namespace),e.writeAttributeString(void 0,"Requires",void 0,"c14"),e.writeStartElement("c14","style",void 0),e.writeAttributeString(void 0,"val",void 0,"102"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("mc","Fallback",this.veNamespace),e.writeStartElement("c","style",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"2"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","chart",this.chartNamespace),sf.base.isNullOrUndefined(this.chart[lr[this.keywordIndex]])||(e.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(e,this.chart[rr[this.keywordIndex]],this.chart[lr[this.keywordIndex]]),e.writeEndElement()),this.serializeChartPlotArea(e,t),e.writeEndElement(),this.serializeShapeProperties(e,"D9D9D9",!0),e.writeStartElement("c","txPr",this.chartNamespace),e.writeAttributeString("xmlns","c",void 0,this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeStartElement("a","pPr",this.aNamespace),e.writeStartElement("a","defRPr",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","endParaRPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartPlotArea=function(e,t){e.writeStartElement("c","autoTitleDeleted",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","plotArea",this.chartNamespace),e.writeStartElement("c","layout",this.chartNamespace),e.writeEndElement();var i=this.chartType(t),r="pieChart"===i||"doughnutChart"===i,n="scatterChart"===i||"bubbleChart"===i;if(e.writeStartElement("c",i,this.chartNamespace),"barChart"===i){var o="";o="Column_Clustered"===t[dr[this.keywordIndex]]||"Column_Stacked"===t[dr[this.keywordIndex]]||"Column_Stacked_100"===t[dr[this.keywordIndex]]?"col":"bar",e.writeStartElement("c","barDir",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o),e.writeEndElement()}if(!r&&!n){var s=this.chartGrouping(t[dr[this.keywordIndex]]);e.writeStartElement("c","grouping",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s),e.writeEndElement()}"scatterChart"===i&&(e.writeStartElement("c","scatterStyle",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"marker"),e.writeEndElement()),e.writeStartElement("c","varyColors",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement();for(var a="",l=0;l<t[tr[this.keywordIndex]].length;l++){var d=t[tr[this.keywordIndex]][l];this.seriesCount=l,e.writeStartElement("c","ser",this.chartNamespace),e.writeStartElement("c","idx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement(),e.writeStartElement("c","order",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement(),e.writeStartElement("c","tx",this.chartNamespace),e.writeStartElement("c","strRef",this.chartNamespace),e.writeStartElement("c","f",this.chartNamespace);var h=String.fromCharCode("B".charCodeAt(0)+l);if(a="Sheet1!$"+h,e.writeString(a+"$1"),a=a+"$2:$"+h+"$",e.writeEndElement(),e.writeStartElement("c","strCache",this.chartNamespace),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,"0"),e.writeStartElement("c","v",this.chartNamespace),e.writeString(d[Ri[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),"Pie"===t[dr[this.keywordIndex]]||"Doughnut"===t[dr[this.keywordIndex]]?(this.parseChartDataPoint(e,d),e.writeStartElement("c","explosion",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()):n||this.parseChartSeriesColor(e,d[Mi[this.keywordIndex]],i),"scatterChart"===i){var c=d[Mi[this.keywordIndex]][0][Lr[this.keywordIndex]][bi[this.keywordIndex]];e.writeStartElement("c","marker",this.chartNamespace),e.writeStartElement("c","symbol",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"circle"),e.writeEndElement(),e.writeStartElement("c","size",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"5"),e.writeEndElement(),this.serializeShapeProperties(e,c,!1),e.writeEndElement()}d[Ui[this.keywordIndex]]&&this.parseChartDataLabels(e,d[Ui[this.keywordIndex]]),d[Ai[this.keywordIndex]]&&this.parseChartTrendLines(e,d),d[Bi[this.keywordIndex]]&&this.serializeChartErrorBar(e,d),"scatterChart"===i?this.serializeDefaultShapeProperties(e):"bubbleChart"===i&&this.serializeShapeProperties(e,d[Mi[this.keywordIndex]][l][Lr[this.keywordIndex]][bi[this.keywordIndex]],!1);var p="cat",g="strRef",f="strCache";"scatterChart"===i&&(p="xVal",g="numRef",f="numCache"),e.writeStartElement("c",p,this.chartNamespace),e.writeStartElement("c",g,this.chartNamespace),this.serializeChartCategory(e,t,f),e.writeEndElement(),e.writeEndElement(),this.serializeChartValue(e,a,i),e.writeEndElement()}if(e.writeStartElement("c","dLbls",this.chartNamespace),r&&(e.writeStartElement("c","dLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"bestFit"),e.writeEndElement()),e.writeStartElement("c","showLegendKey",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showVal",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showCatName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showSerName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showPercent",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showBubbleSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","showLeaderLines",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeEndElement(),r){var u=0,m=0;(d=this.chart[tr[this.keywordIndex]][0]).hasOwnProperty(zi[this.keywordIndex])&&(u=d[zi[this.keywordIndex]]),e.writeStartElement("c","firstSliceAng",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,u.toString()),e.writeEndElement(),"Doughnut"===t[dr[this.keywordIndex]]&&(m=d[Di[this.keywordIndex]],e.writeStartElement("c","holeSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,m.toString()),e.writeEndElement())}"lineChart"===i||n?"bubbleChart"!==i&&(e.writeStartElement("c","smooth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()):(e.writeStartElement("c","gapWidth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,this.chart[hr[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement("c","overlap",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,this.chart[cr[this.keywordIndex]].toString()),e.writeEndElement()),"bubbleChart"===i&&(e.writeStartElement("c","sizeRepresents",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"area"),e.writeEndElement());var y=this.chart[dr[this.keywordIndex]];r||(e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"),e.writeEndElement(),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335263360"),e.writeEndElement()),e.writeEndElement();var v="Column_Stacked_100"===y||"Area_Stacked_100"===y||"Bar_Stacked_100"===y||"Line_Stacked_100"===y||"Line_Markers_Stacked_100"===y,w=this.chart[sr[this.keywordIndex]][$i[this.keywordIndex]];if(r||(this.serializeCategoryAxis(e,w,v),this.serializeValueAxis(e,w,v)),this.chart.hasOwnProperty(pr[this.keywordIndex])){var b=this.chart.chartDataTable,I=0,F=0,C=0,W=0;x.parseBoolValue(b[Ji[this.keywordIndex]])&&(W=1),x.parseBoolValue(b[Yi[this.keywordIndex]])&&(I=1),x.parseBoolValue(b[Zi[this.keywordIndex]])&&(F=1),x.parseBoolValue(b[Qi[this.keywordIndex]])&&(C=1),e.writeStartElement("c","dTable",this.chartNamespace),e.writeStartElement("c","showHorzBorder",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,I.toString()),e.writeEndElement(),e.writeStartElement("c","showVertBorder",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,F.toString()),e.writeEndElement(),e.writeStartElement("c","showOutline",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,C.toString()),e.writeEndElement(),e.writeStartElement("c","showKeys",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,W.toString()),e.writeEndElement(),e.writeEndElement()}this.serializeDefaultShapeProperties(e),e.writeEndElement(),sf.base.isNullOrUndefined(this.chart[or[this.keywordIndex]][Go[this.keywordIndex]])||this.serializeChartLegend(e),e.writeStartElement("c","plotVisOnly",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","dispBlanksAs",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"gap"),e.writeEndElement()},e.prototype.serializeChartLegend=function(e){var t=this.chartLegendPosition(this.chart[or[this.keywordIndex]]),i=this.chart[or[this.keywordIndex]][rr[this.keywordIndex]],r=i[ui[this.keywordIndex]][Lr[this.keywordIndex]][bi[this.keywordIndex]];e.writeStartElement("c","legend",this.chartNamespace),e.writeStartElement("c","legendPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),e.writeStartElement("c","overlay",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,i[Oe[this.keywordIndex]],r,i[ks[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartErrorBar=function(e,t){var i=t[Bi[this.keywordIndex]],r=this.errorBarValueType(i[hs[this.keywordIndex]]),n=0;"Cap"!==i[Ci[this.keywordIndex]]&&(n=1),e.writeStartElement("c","errBars",this.chartNamespace),e.writeStartElement("c","errBarType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[Fi[this.keywordIndex]].toLowerCase()),e.writeEndElement(),e.writeStartElement("c","errValType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r),e.writeEndElement(),e.writeStartElement("c","noEndCap",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement(),e.writeStartElement("c","val",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[Wi[this.keywordIndex]].toString()),e.writeEndElement(),this.serializeShapeProperties(e,"595959",!0),e.writeEndElement()},e.prototype.errorBarValueType=function(e){var t="";switch(e){case"StandardError":t="stdErr";break;case"StandardDeviation":t="stdDev";break;case"Percentage":t="percentage";break;case"Fixed":t="fixedVal";break;default:t="stdErr"}return t},e.prototype.serializeCategoryAxis=function(e,t,i){var r="catAx",n=this.chart[sr[this.keywordIndex]][Uo[this.keywordIndex]],o=this.chart[dr[this.keywordIndex]],s="Scatter_Markers"===o||"Bubble"===o;"Time"===t&&(r="dateAx"),s&&(r="valAx"),e.writeStartElement("c",r,this.chartNamespace),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335265000"),e.writeEndElement(),this.serializeAxis(e,"335263360",this.chart[sr[this.keywordIndex]],n,i),s||(e.writeStartElement("c","auto",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","lblAlgn",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"ctr"),e.writeEndElement(),e.writeStartElement("c","lblOffset",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"100"),e.writeEndElement()),"Time"===t?(e.writeStartElement("c","baseTimeUnit",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"days"),e.writeEndElement()):"Bubble"!==this.chart[dr[this.keywordIndex]]&&(e.writeStartElement("c","noMultiLvlLbl",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeValueAxis=function(e,t,i){var r=this.chart[ar[this.keywordIndex]],n="between";"Time"===t&&(n="midCat"),e.writeStartElement("c","valAx",this.chartNamespace),e.writeStartElement("c","axId",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"335263360"),e.writeEndElement(),this.serializeAxis(e,"335265000",r,"General",i),e.writeStartElement("c","crossBetween",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n),e.writeEndElement(),0===r[cs[this.keywordIndex]]||i||(e.writeStartElement("c","majorUnit",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r[cs[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeAxis=function(e,t,i,r,n){e.writeStartElement("c","scaling",this.chartNamespace),e.writeStartElement("c","orientation",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"minMax"),e.writeEndElement(),0===i[gs[this.keywordIndex]]||n||(e.writeStartElement("c","max",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[gs[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement("c","min",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i[fs[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement(),e.writeStartElement("c","delete",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),e.writeStartElement("c","axPos",this.chartNamespace),"335265000"===t?e.writeAttributeString(void 0,"val",void 0,"l"):e.writeAttributeString(void 0,"val",void 0,"b"),e.writeEndElement(),x.parseBoolValue(i[us[this.keywordIndex]])&&(e.writeStartElement("c","majorGridlines",this.chartNamespace),this.serializeShapeProperties(e,"D9D9D9",!0),e.writeEndElement()),x.parseBoolValue(i[ms[this.keywordIndex]])&&(e.writeStartElement("c","minorGridlines",this.chartNamespace),this.serializeShapeProperties(e,"F2F2F2",!0),e.writeEndElement()),i[lr[this.keywordIndex]]&&(e.writeStartElement("c","title",this.chartNamespace),this.serializeTextProperties(e,i[rr[this.keywordIndex]],i[lr[this.keywordIndex]]),e.writeEndElement()),e.writeStartElement("c","numFmt",this.chartNamespace),e.writeAttributeString(void 0,"formatCode",void 0,r),e.writeAttributeString(void 0,"sourceLinked",void 0,"1"),e.writeEndElement(),e.writeStartElement("c","majorTickMark",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"none"),e.writeEndElement(),e.writeStartElement("c","minorTickMark",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"none"),e.writeEndElement(),e.writeStartElement("c","tickLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"nextTo"),e.writeEndElement(),"Bubble"===this.chart.chartType?this.serializeShapeProperties(e,"BFBFBF",!0):this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,i[Oe[this.keywordIndex]],"595959",i[ks[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","crossAx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,t),e.writeEndElement(),e.writeStartElement("c","crosses",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"autoZero"),e.writeEndElement()},e.prototype.parseChartTrendLines=function(e,t){for(var i=0;i<t[Ai[this.keywordIndex]].length;i++){var r=t[Ai[this.keywordIndex]][i],n=this.chartTrendLineType(r[hs[this.keywordIndex]]),o=0,s=0;x.parseBoolValue(r[Ei[this.keywordIndex]])?s=1:x.parseBoolValue(r[Hi[this.keywordIndex]])&&(o=1);var a=t[Mi[this.keywordIndex]][i];e.writeStartElement("c","trendline",this.chartNamespace),e.writeStartElement("c","spPr",this.chartNamespace),e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"19050"),this.serializeChartSolidFill(e,a[Lr[this.keywordIndex]][bi[this.keywordIndex]],!1),e.writeStartElement("a","prstDash",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"sysDot"),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","trendlineType",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n),e.writeEndElement(),e.writeStartElement("c","forward",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r[Ni[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement("c","backward",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r[Oi[this.keywordIndex]].toString()),e.writeEndElement(),"NaN"!==r[Ti[this.keywordIndex]]&&(e.writeStartElement("c","intercept",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r[Ti[this.keywordIndex]].toString()),e.writeEndElement()),e.writeStartElement("c","dispRSqr",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","dispEq",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s.toString()),e.writeEndElement(),e.writeEndElement()}},e.prototype.chartTrendLineType=function(e){var t="";switch(e){case"Linear":t="linear";break;case"Exponential":t="exp"}return t},e.prototype.parseChartDataLabels=function(e,t){var i="",r=0,n=0,o=0,s=0,a=0,l=0,d=0;switch(t[Go[this.keywordIndex]]){case"Center":i="ctr";break;case"Left":i="l";break;case"Right":i="r";break;case"Outside":i="outEnd";break;case"BestFit":i="bestFit";break;case"Bottom":case"OutsideBase":i="inBase";break;case"Inside":i="inEnd";break;case"Above":i="t";break;case"Below":i="b";break;default:i="Automatic"}e.writeStartElement("c","dLbls",this.chartNamespace),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,t[Oe[this.keywordIndex]],t[Te[this.keywordIndex]],t[ks[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement(),x.parseBoolValue(t[Vi[this.keywordIndex]])?r=1:x.parseBoolValue(t[qi[this.keywordIndex]])?n=1:x.parseBoolValue(t[_i[this.keywordIndex]])?o=1:x.parseBoolValue(t[ji[this.keywordIndex]])?s=1:x.parseBoolValue(t[Gi[this.keywordIndex]])?a=1:x.parseBoolValue(t[Ki[this.keywordIndex]])?l=1:x.parseBoolValue(t[Xi[this.keywordIndex]])&&(d=1),"Automatic"!==i&&(e.writeStartElement("c","dLblPos",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,i),e.writeEndElement()),e.writeStartElement("c","showLegendKey",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,r.toString()),e.writeEndElement(),e.writeStartElement("c","showVal",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,a.toString()),e.writeEndElement(),e.writeStartElement("c","showCatName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toString()),e.writeEndElement(),e.writeStartElement("c","showSerName",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s.toString()),e.writeEndElement(),e.writeStartElement("c","showPercent",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,l.toString()),e.writeEndElement(),e.writeStartElement("c","showBubbleSize",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement(),e.writeStartElement("c","showLeaderLines",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,d.toString()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeShapeProperties=function(e,t,i){var r=this.chart[dr[this.keywordIndex]],n="Scatter_Markers"===r||"Bubble"===r;e.writeStartElement("c","spPr",this.chartNamespace),!n||i?(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"9525"),this.serializeChartSolidFill(e,t,!1),e.writeStartElement("a","prstDash",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"solid"),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement()):"Scatter_Markers"===r?(this.serializeChartSolidFill(e,t,!1),this.serializeDefaultLineProperties(e)):"Bubble"===r&&(this.serializeChartSolidFill(e,t,!0),this.serializeDefaultLineProperties(e)),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDefaultShapeProperties=function(e){e.writeStartElement("c","spPr",this.chartNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),this.serializeDefaultLineProperties(e),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDefaultLineProperties=function(e){e.writeStartElement("a","ln",this.aNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeTextProperties=function(e,t,i){var r=t[ui[this.keywordIndex]][Lr[this.keywordIndex]][bi[this.keywordIndex]],n=100*t[Oe[this.keywordIndex]];e.writeStartElement("c","tx",this.chartNamespace),e.writeStartElement("c","rich",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeAttributeString(void 0,"rot",void 0,"0"),e.writeAttributeString(void 0,"vert",void 0,"horz"),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),this.serializeChartTitleFont(e,t[Oe[this.keywordIndex]],r,t[ks[this.keywordIndex]]),e.writeStartElement("a","r",this.aNamespace),e.writeStartElement("a","rPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeAttributeString(void 0,"sz",void 0,n.toString()),e.writeAttributeString(void 0,"baseline",void 0,"0"),this.serializeChartSolidFill(e,r,!1),this.serializeFont(e,t[ks[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement("a","t",this.aNamespace),e.writeString(i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("c","layout",this.chartNamespace),e.writeEndElement(),e.writeStartElement("c","overlay",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.serializeDefaultShapeProperties(e),e.writeStartElement("c","txPr",this.chartNamespace),e.writeStartElement("a","bodyPr",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","lstStyle",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","p",this.aNamespace),e.writeEndElement(),this.serializeChartTitleFont(e,t[Oe[this.keywordIndex]],r,t[ks[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeChartTitleFont=function(e,t,i,r){var n=100*t;e.writeStartElement("a","pPr",this.aNamespace),e.writeStartElement("a","defRPr",this.aNamespace),e.writeAttributeString(void 0,"lang",void 0,"en-US"),e.writeAttributeString(void 0,"b",void 0,"0"),e.writeAttributeString(void 0,"sz",void 0,n.toString()),e.writeAttributeString(void 0,"baseline",void 0,"0"),this.serializeChartSolidFill(e,i,!1),this.serializeFont(e,r),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeChartSolidFill=function(e,t,i){e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),"000000"!==t?e.writeAttributeString(void 0,"val",void 0,t):e.writeAttributeString(void 0,"val",void 0,"595959"),"Bubble"===this.chart[dr[this.keywordIndex]]&&i&&(e.writeStartElement("a","alpha",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,"75000"),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeFont=function(e,t){e.writeStartElement("a","latin",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement(),e.writeStartElement("a","ea",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement(),e.writeStartElement("a","cs",this.aNamespace),e.writeAttributeString(void 0,"typeface",void 0,t),e.writeEndElement()},e.prototype.parseChartSeriesColor=function(e,t,i){for(var r=0;r<t.length;r++){var n=t[r];if(e.writeStartElement("c","spPr",this.chartNamespace),"lineChart"===i&&(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,"28575"),e.writeAttributeString(void 0,"cap",void 0,"rnd")),"lineChart"!==i?this.serializeChartSolidFill(e,this.getColor(n[Lr[this.keywordIndex]][bs[this.keywordIndex]]),!0):this.serializeChartSolidFill(e,n[wi[this.keywordIndex]][Br[this.keywordIndex]],!0),"lineChart"!==i&&(e.writeStartElement("a","ln",this.aNamespace),e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement()),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","effectLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),"lineChart"===i){var o="none",s=0;this.chart[tr[this.keywordIndex]][r].hasOwnProperty(Li[this.keywordIndex])&&(o=this.chart[tr[this.keywordIndex]][r][Li[this.keywordIndex]][ki[this.keywordIndex]],s=this.chart[tr[this.keywordIndex]][r][Li[this.keywordIndex]][Pi[this.keywordIndex]]),e.writeStartElement("c","marker",this.chartNamespace),e.writeStartElement("c","symbol",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,o.toLowerCase()),e.writeEndElement(),this.chart[tr[this.keywordIndex]][r].hasOwnProperty(Li[this.keywordIndex])&&(e.writeStartElement("c","size",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,s.toString()),e.writeEndElement()),e.writeEndElement()}}},e.prototype.parseChartDataPoint=function(e,t){for(var i=t[Mi[this.keywordIndex]],r=[],n=0;n<i.length;n++)r.push(i[n]),e.writeStartElement("c","dPt",this.chartNamespace),e.writeStartElement("c","idx",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement(),e.writeStartElement("c","bubble3D",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement(),this.parseChartSeriesColor(e,r,this.chart[dr[this.keywordIndex]]),e.writeEndElement(),r=[]},e.prototype.serializeChartCategory=function(e,t,i){var r=t[er[this.keywordIndex]],n=r.length;e.writeStartElement("c","f",this.chartNamespace),e.writeString("Sheet1!$A$2:$A$"+(n+1).toString()),e.writeEndElement(),e.writeStartElement("c",i,this.chartNamespace),"numCache"===i&&(e.writeStartElement("c","formatCode",this.chartNamespace),e.writeString("General"),e.writeEndElement()),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement();for(var o=0;o<r.length;o++){var s=r[o];e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,o.toString()),e.writeStartElement("c","v",this.chartNamespace),""!==s[vi[this.keywordIndex]]&&e.writeString(s[vi[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement()}e.writeEndElement()},e.prototype.serializeChartValue=function(e,t,i){var r="val";("scatterChart"===i||"bubbleChart"===i)&&(r="yVal"),this.serializeChartYValue(e,r,t),"bubbleChart"===i&&(r="bubbleSize",t="Sheet1!$C$2:$C$",this.serializeChartYValue(e,r,t)),"lineChart"!==i&&"scatterChart"!==i||(e.writeStartElement("c","smooth",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,"0"),e.writeEndElement())},e.prototype.serializeChartYValue=function(e,t,i){var r=this.chart[er[this.keywordIndex]],n=r.length;e.writeStartElement("c",t,this.chartNamespace),e.writeStartElement("c","numRef",this.chartNamespace),e.writeStartElement("c","f",this.chartNamespace),e.writeString(i+(n+1).toString()),e.writeEndElement(),e.writeStartElement("c","numCache",this.chartNamespace),e.writeStartElement("c","formatCode",this.chartNamespace),e.writeString("General"),e.writeEndElement(),e.writeStartElement("c","ptCount",this.chartNamespace),e.writeAttributeString(void 0,"val",void 0,n.toString()),e.writeEndElement();for(var o=0;o<n;o++)for(var s=r[o],a=0;a<s[yi[this.keywordIndex]].length;a++)if(a===this.seriesCount){var l=s[yi[this.keywordIndex]][this.seriesCount];e.writeStartElement("c","pt",this.chartNamespace),e.writeAttributeString(void 0,"idx",void 0,o.toString()),e.writeStartElement("c","v",this.chartNamespace),"bubbleSize"!==t?e.writeString(l[mi[this.keywordIndex]].toString()):e.writeString(l[dn[this.keywordIndex]].toString()),e.writeEndElement(),e.writeEndElement()}e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.chartType=function(e){var t=e[dr[this.keywordIndex]];switch(t){case"Pie":t="pieChart";break;case"Doughnut":t="doughnutChart";break;case"Scatter_Markers":t="scatterChart";break;case"Bubble":t="bubbleChart"}return"Area"!==t&&"Area_Stacked"!==t&&"Area_Stacked_100"!==t||(t="areaChart"),"Bar_Stacked_100"!==t&&"Bar_Stacked"!==t&&"Bar_Clustered"!==t&&"Column_Clustered"!==t&&"Column_Stacked"!==t&&"Column_Stacked_100"!==t||(t="barChart"),"Line"!==t&&"Line_Markers"!==t&&"Line_Markers_Stacked"!==t&&"Line_Stacked"!==t&&"Line_Markers_Stacked_100"!==t&&"Line_Stacked_100"!==t||(t="lineChart"),t},e.prototype.chartGrouping=function(e){var t="standard";return"Bar_Stacked"===e||"Column_Stacked"===e||"Area_Stacked"===e||"Line_Stacked"===e||"Line_Markers_Stacked"===e?t="stacked":"Bar_Stacked_100"===e||"Column_Stacked_100"===e||"Area_Stacked_100"===e||"Line_Stacked_100"===e||"Line_Markers_Stacked_100"===e?t="percentStacked":"Bar_Clustered"!==e&&"Column_Clustered"!==e||(t="clustered"),t},e.prototype.chartLegendPosition=function(e){var t=e.position;switch(t){case"Top":t="t";break;case"Bottom":t="b";break;case"Left":t="l";break;case"Right":t="r";break;case"Corner":t="tr";break;default:t="b"}return t},e.prototype.updatechartId=function(e){var t="";return""===t&&(t=this.addChartRelation(this.documentCharts,e)),t},e.prototype.addChartRelation=function(e,t){var i;return i=this.getNextRelationShipID(),e.add(i,t),i},e.prototype.startsWith=function(e,t){return t.length>0&&e.substring(0,t.length)===t},e.prototype.serializeShapeDrawingGraphics=function(e,t){var i=t[Rr[this.keywordIndex]];t[fr[this.keywordIndex]];this.serializeShapeWrapStyle(e,t),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,t[ye[this.keywordIndex]]),e.writeAttributeString(void 0,"title",void 0,t[En[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.wpShapeNamespace),e.writeStartElement("wps","wsp",this.wpShapeNamespace),e.writeStartElement("wps","cNvCnPr",this.wpShapeNamespace),e.writeStartElement("a","cxnSpLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeShapeType",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("wps","spPr",this.wpShapeNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace);var r=Math.round(t[wr[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,r.toString());var n=Math.round(t[br[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,n.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),i===(1==this.keywordIndex?3:"StraightConnector")?e.writeAttributeString(void 0,"prst",void 0,"straightConnector1"):i===(1==this.keywordIndex?2:"RoundedRectangle")?e.writeAttributeString(void 0,"prst",void 0,"roundRect"):e.writeAttributeString(void 0,"prst",void 0,"rect"),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),t[Cr[this.keywordIndex]]&&t[Cr[this.keywordIndex]][Br[this.keywordIndex]]&&x.parseBoolValue(t[Cr[this.keywordIndex]][Lr[this.keywordIndex]])?(e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,this.getColor(t[Cr[this.keywordIndex]][Br[this.keywordIndex]])),e.writeEndElement(),e.writeEndElement()):(e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement());var o=t[Fr[this.keywordIndex]][Cs[this.keywordIndex]]?t[Fr[this.keywordIndex]][Cs[this.keywordIndex]]*this.emusPerPoint:this.emusPerPoint;if(e.writeStartElement("a","ln",this.aNamespace),e.writeAttributeString(void 0,"w",void 0,o.toString()),!sf.base.isNullOrUndefined(t[Fr[this.keywordIndex]][Is[this.keywordIndex]])&&t[Fr[this.keywordIndex]][Is[this.keywordIndex]]!==(1==this.keywordIndex?3:"None")&&x.parseBoolValue(t[Fr[this.keywordIndex]][wi[this.keywordIndex]])?(e.writeStartElement("a","solidFill",this.aNamespace),e.writeStartElement("a","srgbClr",this.aNamespace),e.writeAttributeString(void 0,"val",void 0,this.getColor(t[Fr[this.keywordIndex]][Br[this.keywordIndex]])),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","round",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","headEnd",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","tailEnd",this.aNamespace),e.writeEndElement()):(e.writeStartElement("a","noFill",this.aNamespace),e.writeEndElement()),e.writeEndElement(),e.writeEndElement(),i!==(1==this.keywordIndex?1:"Rectangle")&&i!==(1==this.keywordIndex?2:"RoundedRectangle")||(e.writeStartElement("wps","txbx",this.wpShapeNamespace),e.writeStartElement(void 0,"txbxContent",this.wNamespace),this.serializeBodyItems(e,t[Ur[this.keywordIndex]][xo[this.keywordIndex]],!0),e.writeEndElement(),e.writeEndElement()),e.writeStartElement("wps","bodyPr",this.wpShapeNamespace),!sf.base.isNullOrUndefined(t[Ur[this.keywordIndex]])){var s=void 0;if(t[Ur[this.keywordIndex]][wt[this.keywordIndex]]>=0&&(s=Math.round(t[Ur[this.keywordIndex]][wt[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"lIns",void 0,s)),t[Ur[this.keywordIndex]][xt[this.keywordIndex]]>=0&&(s=Math.round(t[Ur[this.keywordIndex]][xt[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"tIns",void 0,s)),t[Ur[this.keywordIndex]][bt[this.keywordIndex]]>=0&&(s=Math.round(t[Ur[this.keywordIndex]][bt[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"rIns",void 0,s)),t[Ur[this.keywordIndex]][It[this.keywordIndex]]>=0&&(s=Math.round(t[Ur[this.keywordIndex]][It[this.keywordIndex]]*this.emusPerPoint).toString(),e.writeAttributeString(void 0,"bIns",void 0,s)),t[Ur[this.keywordIndex]][Ar[this.keywordIndex]]){var a=void 0;a=1==this.keywordIndex?x.getTextVerticalAlignment(t[Ur[this.keywordIndex]][Ar[this.keywordIndex]]).toString().toLowerCase():t[Ur[this.keywordIndex]][Ar[this.keywordIndex]].toString().toLowerCase(),e.writeAttributeString(void 0,"anchor",void 0,this.getTextVerticalAlignmentProperty(a))}e.writeAttributeString(void 0,"anchorCtr",void 0,"0")}e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.getTextVerticalAlignmentProperty=function(e){switch(e){case"top":return"t";case"middle":case"center":return"ctr";case"bottom":return"b";default:return e}},e.prototype.serializeShapeWrapStyle=function(e,t){var i=1==this.keywordIndex?this.getTextWrappingStyle(t[Wr[this.keywordIndex]]):t[Wr[this.keywordIndex]];if("Inline"!==i){var r="wrapNone";if(i&&"InFrontOfText"!==i&&"Behind"!==i&&(r="wrap"+i,"Tight"===i&&(r="wrapSquare")),e.writeStartElement("wp",r,this.wpNamespace),i&&"InFrontOfText"!==i&&"Behind"!==i&&!sf.base.isNullOrUndefined(t[kr[this.keywordIndex]])){var n=1==this.keywordIndex?this.getTextWrappingType(t[kr[this.keywordIndex]]):"Both"===t[kr[this.keywordIndex]]?"bothSides":t[kr[this.keywordIndex]].toLowerCase();e.writeAttributeString(void 0,"wrapText",void 0,n)}e.writeEndElement()}},e.prototype.serializeDrawingGraphics=function(e,t){var i,r,n=this.getBase64ImageString(t),o=n.imageString;if(x.parseBoolValue(t[Vr[this.keywordIndex]])&&".svg"!==(r=x.formatClippedString(n.metaFileImageString).extension)&&(o=n.metaFileImageString),i=this.updateShapeId(t,!1),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),sf.base.isNullOrUndefined(t[ur[this.keywordIndex]])||e.writeAttributeString(void 0,"descr",void 0,t[ur[this.keywordIndex]]),e.writeAttributeString(void 0,"name",void 0,sf.base.isNullOrUndefined(t[ye[this.keywordIndex]])?"":t[ye[this.keywordIndex]]),sf.base.isNullOrUndefined(t[En[this.keywordIndex]])||e.writeAttributeString(void 0,"title",void 0,t[En[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.pictureNamespace),e.writeStartElement("pic","pic",this.pictureNamespace),e.writeStartElement("pic","nvPicPr",this.pictureNamespace),e.writeStartElement("pic","cNvPr",this.pictureNamespace),e.writeAttributeString(void 0,"id",void 0,"0"),e.writeAttributeString(void 0,"name",void 0,""),e.writeAttributeString(void 0,"descr",void 0,""),e.writeEndElement(),e.writeStartElement("pic","cNvPicPr",this.pictureNamespace),e.writeStartElement("a","picLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeAspect",void 0,"1"),e.writeAttributeString(void 0,"noChangeArrowheads",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","blipFill",this.pictureNamespace),e.writeStartElement("a","blip",this.aNamespace),this.startsWith(o,"data:image"))e.writeAttributeString("r","embed",this.rNamespace,i);else if(this.documentImages.containsKey(i)&&(this.documentImages.remove(i),this.externalImages.add(i,o),e.writeAttributeString(void 0,"link",this.rNamespace,i),!sf.base.isNullOrUndefined(n.metaFileImageString)&&(this.startsWith(o,"https://")||this.startsWith(o,"http://")||this.startsWith(o,"file://")))){var s=this.getNextRelationShipID();this.documentImages.add(s,n.metaFileImageString),e.writeAttributeString("r","embed",this.rNamespace,s)}if(".svg"===r&&this.serializeBlipExtensions(e,t),e.writeEndElement(),!sf.base.isNullOrUndefined(t[qr[this.keywordIndex]])&&0!==t[qr[this.keywordIndex]]||!sf.base.isNullOrUndefined(t[_r[this.keywordIndex]])&&0!==t[_r[this.keywordIndex]]||!sf.base.isNullOrUndefined(t[Gr[this.keywordIndex]])&&0!==t[Gr[this.keywordIndex]]||!sf.base.isNullOrUndefined(t[jr[this.keywordIndex]])&&0!==t[jr[this.keywordIndex]]){e.writeStartElement("a","srcRect",this.aNamespace);var a=Math.round(1e3*t[Gr[this.keywordIndex]]);e.writeAttributeString(void 0,"l",void 0,a.toString());var l=Math.round(1e3*t[qr[this.keywordIndex]]);e.writeAttributeString(void 0,"t",void 0,l.toString());var d=Math.round(1e3*t[jr[this.keywordIndex]]);e.writeAttributeString(void 0,"r",void 0,d.toString());var h=Math.round(1e3*t[_r[this.keywordIndex]]);e.writeAttributeString(void 0,"b",void 0,h.toString()),e.writeEndElement()}e.writeStartElement("a","stretch",this.aNamespace),e.writeStartElement("a","fillRect",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","spPr",this.pictureNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace);var c=Math.round(t[wr[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,c.toString());var p=Math.round(t[br[this.keywordIndex]]*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,p.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),e.writeAttributeString(void 0,"prst",void 0,"rect"),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeBlipExtensions=function(e,t){e.writeStartElement("a","extLst",this.aNamespace),e.writeStartElement("a","ext",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"),e.writeStartElement("asvg","svgBlip",this.svgNamespace);var i=this.updateShapeId(t,!0);e.writeAttributeString("r","embed",void 0,i),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.updateShapeId=function(e,t){var i="",r=this.paragraph;return this.headerFooter?i=this.updateHFImageRels(this.headerFooter,e,t):""===i&&(r.hasOwnProperty(No[this.keywordIndex])||r.hasOwnProperty(Pn[this.keywordIndex]))&&(i=this.addImageRelation(t?this.svgImages:this.documentImages,e,t)),i},e.prototype.addImageRelation=function(e,t,i){var r="";return(i?this.svgImageRelationIds.keys.indexOf(parseInt(t[Mr[this.keywordIndex]])):this.imageRelationIds.keys.indexOf(parseInt(t[Mr[this.keywordIndex]])))<0||this.isHeaderFooter?(r=this.getNextRelationShipID(),i?this.svgImageRelationIds.add(parseInt(t[Mr[this.keywordIndex]]),r):this.imageRelationIds.add(parseInt(t[Mr[this.keywordIndex]]),r)):r=i?this.svgImageRelationIds.get(parseInt(t[Mr[this.keywordIndex]])):this.imageRelationIds.get(parseInt(t[Mr[this.keywordIndex]])),e.add(r,t),r},e.prototype.updateHFImageRels=function(e,t,i){for(var r="",n="",o=this.headersFooters.keys,s=0;s<o.length;s++)for(var l=this.headersFooters.get(o[s]),d=l.keys,h=0;h<d.length;h++)if(l.get(d[h])===e){n=d[h];var c=void 0;i?this.headerFooterSvgImages.containsKey(n)?(c=this.headerFooterSvgImages.get(n),r=this.addImageRelation(c,t,!0)):(c=new a,r=this.addImageRelation(c,t,!0),this.headerFooterSvgImages.add(n,c)):this.headerFooterImages.containsKey(n)?(c=this.headerFooterImages.get(n),r=this.addImageRelation(c,t,!1)):(c=new a,r=this.addImageRelation(c,t,!1),this.headerFooterImages.add(n,c))}return r},e.prototype.serializeTable=function(e,t){if(sf.base.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=0),!(t[oo[this.keywordIndex]].length<=0)){var i=this.table;this.table=t,e.writeStartElement(void 0,"tbl",this.wNamespace);var r=t[oo[this.keywordIndex]][0][ro[this.keywordIndex]];this.serializeTableFormat(e,r,t),this.serializeTableGrid(e,t);var n=new a,o=new a,s=new a,l=t[oo[this.keywordIndex]];if(l.length>0)for(var d=0;d<l.length;d++){var h=l[d];if(h[no[this.keywordIndex]].length>0){if(h.hasOwnProperty(Nn[this.keywordIndex])){this.serializeContentControl(e,h[Nn[this.keywordIndex]],h);continue}var c=this.row;this.row=h,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,h);for(var p=h[no[this.keywordIndex]],g=p.length,f=0,u=0;u<g;u++){var m=p[u],y=m[Ps[this.keywordIndex]];if(m.hasOwnProperty(Nn[this.keywordIndex]))this.serializeContentControl(e,m[Nn[this.keywordIndex]],m);else{var v=m[io[this.keywordIndex]];if(y-f>0)for(var w=0===u?0:f+1;w<y;w++)if(n.containsKey(w)){var b=this.getMergeCellFormat(v,s.get(w),w<m[Ps[this.keywordIndex]]);this.serializeTableCell(e,m,b,!1),n.set(w,n.get(w)-1),1===n.get(w)&&(n.remove(w),s.remove(w),o.containsKey(w)&&o.remove(w)),o.containsKey(w)&&(f+=o.get(w)-1,(w+=o.get(w))>0&&w--)}f=y,v[Mt[this.keywordIndex]]>1&&(n.add(y,v[Mt[this.keywordIndex]]),s.add(y,v)),this.serializeTableCell(e,m,v,!0),v[At[this.keywordIndex]]>1&&v[Mt[this.keywordIndex]]>1&&o.add(y,v[At[this.keywordIndex]]);for(var x=y+1;;x++)if(n.containsKey(x)){var I=this.getMergeCellFormat(v,s.get(x),x<m[Ps[this.keywordIndex]]);this.serializeTableCell(e,m,I,!1),n.set(x,n.get(x)-1),f++,1===n.get(x)&&(n.remove(x),s.remove(x),o.containsKey(x)&&o.remove(x)),o.containsKey(x)&&(f+=o.get(x)-1,x+=o.get(x))}else if(!(u===g-1&&x<t[Rs[this.keywordIndex]]))break}}this.isBookmarkAtRowEnd||e.writeEndElement(),this.isBookmarkAtRowEnd=!1,this.row=c}}e.writeEndElement(),this.table=i}},e.prototype.getMergeCellFormat=function(e,t,i){var r=t;return i?r[ct[this.keywordIndex]][jr[this.keywordIndex]]=e[ct[this.keywordIndex]][Gr[this.keywordIndex]]:r[ct[this.keywordIndex]][Gr[this.keywordIndex]]=e[ct[this.keywordIndex]][jr[this.keywordIndex]],r},e.prototype.serializeTableCell=function(e,t,i,r){var n=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i),this.serializeCellMargins(e,i),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,i[ct[this.keywordIndex]],8,!1),e.writeEndElement(),this.serializeShading(e,t[io[this.keywordIndex]][Qt[this.keywordIndex]]),this.serializeTableCellDirection(e,i),this.serializeCellVerticalAlign(e,i[zt[this.keywordIndex]]),i[At[this.keywordIndex]]>1){var o=i[At[this.keywordIndex]];e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,o.toString()),e.writeEndElement()}if(i[Mt[this.keywordIndex]]>1&&(e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,r?"restart":"continue"),e.writeEndElement()),e.writeEndElement(),t&&t[xo[this.keywordIndex]].length>0)for(var s=0,a=void 0;s<t[xo[this.keywordIndex]].length;)a=t[xo[this.keywordIndex]][s],this.serializeBodyItem(e,a,!1),s+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();this.isBookmarkAtRowEnd||e.writeEndElement(),this.blockOwner=n},e.prototype.serializeTableGrid=function(e,t){e.writeStartElement(void 0,"tblGrid",this.wNamespace),0!==t[Es[this.keywordIndex]].length&&this.serializeGridColumns(e,t[Es[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeTableRows=function(e,t){var i=new a;if(t.length>0)for(var r=0;r<t.length;r++){var n=t[r];if(n[no[this.keywordIndex]].length>0){if(n.hasOwnProperty(Nn[this.keywordIndex])){this.serializeContentControl(e,n[Nn[this.keywordIndex]],n);continue}this.serializeRow(e,n,i)}}},e.prototype.serializeRow=function(e,t,i){var r=this.row;this.row=t,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,t),this.serializeCells(e,t[no[this.keywordIndex]],i),e.writeEndElement(),this.row=r},e.prototype.serializeRowFormat=function(e,t){if(this.serializeRowMargins(e,t[ro[this.keywordIndex]]),e.writeStartElement(void 0,"trPr",this.wNamespace),t[ro[this.keywordIndex]][br[this.keywordIndex]]>0){e.writeStartElement(void 0,"trHeight",this.wNamespace),t[ro[this.keywordIndex]][qt[this.keywordIndex]]===(1==this.keywordIndex?1:"Exactly")?e.writeAttributeString("w","hRule",this.wNamespace,"exact"):t[ro[this.keywordIndex]][qt[this.keywordIndex]]===(1==this.keywordIndex?0:"AtLeast")&&e.writeAttributeString("w","hRule",this.wNamespace,"atLeast");var i=this.roundToTwoDecimal(t[ro[this.keywordIndex]][br[this.keywordIndex]]*this.twentiethOfPoint).toString();e.writeAttributeString("w","val",this.wNamespace,i),e.writeEndElement()}var r=t[ro[this.keywordIndex]],n=r[_t[this.keywordIndex]];n>0&&(e.writeStartElement(void 0,"gridBefore",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,n.toString()),e.writeEndElement());var o=r[Kt[this.keywordIndex]];if(o>0&&(e.writeStartElement(void 0,"gridAfter",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,o.toString()),e.writeEndElement()),n>0){switch(e.writeStartElement(void 0,"wBefore",this.wNamespace),r[Gt[this.keywordIndex]]){case"Percent":case 1:var s=this.roundToTwoDecimal(r[jt[this.keywordIndex]]*this.percentageFactor).toString();e.writeAttributeString("w","w",this.wNamespace,s),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":case 2:var a=this.roundToTwoDecimal(r[jt[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","w",this.wNamespace,a),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}if(o>0){switch(e.writeStartElement(void 0,"wAfter",this.wNamespace),r[Jt[this.keywordIndex]]){case"Percent":case 1:s=this.roundToTwoDecimal(r[Xt[this.keywordIndex]]*this.percentageFactor).toString();e.writeAttributeString("w","val",this.wNamespace,s),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":case 2:a=this.roundToTwoDecimal(r[Xt[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","val",this.wNamespace,a),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}x.parseBoolValue(r[Dt[this.keywordIndex]])||(e.writeStartElement(void 0,"cantSplit",this.wNamespace),e.writeEndElement()),x.parseBoolValue(r[Vt[this.keywordIndex]])&&(e.writeStartElement(void 0,"tblHeader",this.wNamespace),e.writeEndElement()),!sf.base.isNullOrUndefined(r[Ge[this.keywordIndex]])&&r[Ge[this.keywordIndex]].length>0&&(this.serializeRevisionStart(e,r,void 0),this.serializeRevisionEnd(e,r,void 0)),e.writeEndElement()},e.prototype.serializeCells=function(e,t,i){for(var r=0;r<t.length;r++)t[r].hasOwnProperty(Nn[this.keywordIndex])?this.serializeContentControl(e,t[r][Nn[this.keywordIndex]],t[r]):this.serializeCell(e,t[r],i)},e.prototype.serializeCell=function(e,t,i){var r=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),i=this.serializeCellFormat(e,t[io[this.keywordIndex]],!0,!0,i),t[xo[this.keywordIndex]].length>0)for(var n=0,o=void 0;n<t[xo[this.keywordIndex]].length;)o=t[xo[this.keywordIndex]][n],this.serializeBodyItem(e,o,!1),n+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();e.writeEndElement();var s=1;if(i.containsKey(t[Ps[this.keywordIndex]]+t[io[this.keywordIndex]][At[this.keywordIndex]]-1+s)&&1===this.row[no[this.keywordIndex]].length)for(var a=i.keys[i.keys.length-1];s<=a;)s=this.createCellForMerge(e,t,i,s),s++;else this.createCellForMerge(e,t,i,s);this.blockOwner=r},e.prototype.createCellForMerge=function(e,t,i,r){for(;i.containsKey(t[Ps[this.keywordIndex]]+t[io[this.keywordIndex]][At[this.keywordIndex]]-1+r)&&(this.row.cells.indexOf(t)===this.row.cells.length-1||this.row.cells.indexOf(t)===t[Ps[this.keywordIndex]])&&void 0===t.nextNode;){var n=t[Ps[this.keywordIndex]]+t[io[this.keywordIndex]][At[this.keywordIndex]]-1+r;e.writeStartElement(void 0,"tc",this.wNamespace);var o=!0;sf.base.isNullOrUndefined(this.spanCellFormat)?(e.writeStartElement(void 0,"tcPr",this.wNamespace),o=!1):(o=!1,i=this.serializeCellFormat(e,this.spanCellFormat,!1,o,i)),this.serializeColumnSpan(n,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),sf.base.isNullOrUndefined(this.spanCellFormat)&&(e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t[io[this.keywordIndex]][ct[this.keywordIndex]],8,!1),e.writeEndElement()),o||e.writeEndElement(),i=this.checkMergeCell(n,i),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),r++}return r},e.prototype.serializeCellFormat=function(e,t,i,r,n){var o=this.blockOwner;this.table[ho[this.keywordIndex]],this.row[ro[this.keywordIndex]];return e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,t),this.serializeCellMargins(e,t),i&&(n=this.serializeCellMerge(e,t,n),this.serializeGridSpan(e,o)),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t[ct[this.keywordIndex]],8,!1),e.writeEndElement(),this.serializeShading(e,o[io[this.keywordIndex]][Qt[this.keywordIndex]]),this.serializeTableCellDirection(e,t),this.serializeCellVerticalAlign(e,t[zt[this.keywordIndex]]),r&&e.writeEndElement(),n},e.prototype.serializeCellWidth=function(e,t){e.writeStartElement(void 0,"tcW",this.wNamespace),t[ti[this.keywordIndex]]===(1==this.keywordIndex?1:"Percent")?(e.writeAttributeString(void 0,"type",this.wNamespace,"pct"),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[ei[this.keywordIndex]]*this.percentageFactor).toString())):t[ti[this.keywordIndex]]===(1==this.keywordIndex?0:"Auto")?(e.writeAttributeString(void 0,"type",this.wNamespace,"auto"),e.writeAttributeString(void 0,"w",this.wNamespace,"0")):(e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[ei[this.keywordIndex]]*this.twipsInOnePoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")),e.writeEndElement()},e.prototype.serializeCellMerge=function(e,t,i){var r,n=this.blockOwner,o=!1,s=n[Ps[this.keywordIndex]],a=this.row[no[this.keywordIndex]].indexOf(n),l=a>0?this.row[no[this.keywordIndex]][a-1].columnIndex:n[Ps[this.keywordIndex]];if(n[Ps[this.keywordIndex]]===a?(r=n[Ps[this.keywordIndex]],o=!0):o=!1,!o){0===a&&(s=n[Ps[this.keywordIndex]],l=-1);for(var d=l;d<s;d++)r=l+1,l+=1,0===r&&i.containsKey(r)&&(i=this.createMerge(e,r,n,i))}return t[Mt[this.keywordIndex]]>1?(e.writeStartElement(void 0,"vMerge",this.wNamespace),this.spanCellFormat=t,i.add(r,t[Mt[this.keywordIndex]]-1),t[At[this.keywordIndex]]>1&&this.mGridSpans.add(r,t[At[this.keywordIndex]]),e.writeAttributeString("w","val",this.wNamespace,"restart"),e.writeEndElement()):i.containsKey(r)&&o&&(i=this.createMerge(e,r,n,i)),i},e.prototype.createMerge=function(e,t,i,r){return this.serializeColumnSpan(t,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,i[io[this.keywordIndex]][ct[this.keywordIndex]],8,!1),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i[io[this.keywordIndex]]),r=this.checkMergeCell(t,r)},e.prototype.serializeColumnSpan=function(e,t){this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(e)&&(t.writeStartElement(void 0,"gridSpan",this.wNamespace),t.writeAttributeString("w","val",this.wNamespace,this.mGridSpans.get(e).toString()),t.writeEndElement())},e.prototype.checkMergeCell=function(e,t){return t.get(e)-1==0?(t.remove(e),this.spanCellFormat=void 0,this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(e)&&this.mGridSpans.remove(e)):t.set(e,t.get(e)-1),t},e.prototype.serializeGridSpan=function(e,t){if(t[io[this.keywordIndex]][At[this.keywordIndex]]>1){var i=t[io[this.keywordIndex]][At[this.keywordIndex]];e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.toString()),e.writeEndElement()}},e.prototype.serializeTableCellDirection=function(e,t){},e.prototype.serializeCellVerticalAlign=function(e,t){switch(e.writeStartElement(void 0,"vAlign",this.wNamespace),t){case"Center":case 1:e.writeAttributeString("w","val",this.wNamespace,"center");break;case"Bottom":case 2:e.writeAttributeString("w","val",this.wNamespace,"bottom");break;default:e.writeAttributeString("w","val",this.wNamespace,"top")}e.writeEndElement()},e.prototype.serializeGridColumns=function(e,t){for(var i=0,r=t.length;i<r;i++){var n=Math.round(20*t[i]);e.writeStartElement(void 0,"gridCol",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,n.toString()),e.writeEndElement()}},e.prototype.serializeTableFormat=function(e,t,i){e.writeStartElement(void 0,"tblPr",this.wNamespace),sf.base.isNullOrUndefined(i[ho[this.keywordIndex]][Ee[this.keywordIndex]])||(e.writeStartElement(void 0,"tblStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i[ho[this.keywordIndex]][Ee[this.keywordIndex]]),e.writeEndElement()),this.serializeTablePositioning(e,i),this.serializeTableWidth(e,i),this.serializeTableAlignment(e,i[ho[this.keywordIndex]]),this.serializeCellSpacing(e,i[ho[this.keywordIndex]]),this.serializeTableIndentation(e,i[ho[this.keywordIndex]]),this.serializeTableMargins(e,i[ho[this.keywordIndex]]),this.serializeTableBorders(e,i[ho[this.keywordIndex]]),this.serializeShading(e,i[ho[this.keywordIndex]][Qt[this.keywordIndex]]),x.parseBoolValue(i[ho[this.keywordIndex]][Re[this.keywordIndex]])&&(e.writeStartElement(void 0,"bidiVisual",this.wNamespace),e.writeEndElement()),this.serializeTblLayout(e,i[ho[this.keywordIndex]]),sf.base.isNullOrUndefined(i)||e.writeEndElement()},e.prototype.serializeTablePositioning=function(e,t){if(x.parseBoolValue(t[ao[this.keywordIndex]])){if(e.writeStartElement("w","tblpPr",this.wNamespace),t[lo[this.keywordIndex]][fo[this.keywordIndex]]>0){var i=Math.round(t[lo[this.keywordIndex]][fo[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","leftFromText",this.wNamespace,i)}if(t[lo[this.keywordIndex]][go[this.keywordIndex]]>0){var r=Math.round(t[lo[this.keywordIndex]][go[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","rightFromText",this.wNamespace,r)}if(t[lo[this.keywordIndex]][po[this.keywordIndex]]>0){var n=Math.round(t[lo[this.keywordIndex]][po[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","topFromText",this.wNamespace,n)}if(t[lo[this.keywordIndex]][uo[this.keywordIndex]]>0){var o=Math.round(t[lo[this.keywordIndex]][uo[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","bottomFromText",this.wNamespace,o)}if(!sf.base.isNullOrUndefined(t[lo[this.keywordIndex]][mo[this.keywordIndex]])){var s=t[lo[this.keywordIndex]][mo[this.keywordIndex]]===(1==this.keywordIndex?0:"Paragraph")?"text":this.getTableVerticalRelation(t[lo[this.keywordIndex]][mo[this.keywordIndex]]).toLowerCase();e.writeAttributeString("w","vertAnchor",this.wNamespace,s)}if(!sf.base.isNullOrUndefined(t[lo[this.keywordIndex]][vo[this.keywordIndex]])&&t[lo[this.keywordIndex]][vo[this.keywordIndex]]!==(1==this.keywordIndex?0:"Column")){var a=1==this.keywordIndex?this.getTableHorizontalRelation(t[lo[this.keywordIndex]][vo[this.keywordIndex]]).toLowerCase():t[lo[this.keywordIndex]][vo[this.keywordIndex]].toLowerCase();e.writeAttributeString("w","horzAnchor",this.wNamespace,a)}if(!sf.base.isNullOrUndefined(t[lo[this.keywordIndex]][wo[this.keywordIndex]])&&t[lo[this.keywordIndex]][wo[this.keywordIndex]]!==(1==this.keywordIndex?0:"Left")){var l=1==this.keywordIndex?this.getTableHorizontalAlignment(t[lo[this.keywordIndex]][wo[this.keywordIndex]]):t[lo[this.keywordIndex]][wo[this.keywordIndex]].toLowerCase();e.writeAttributeString("w","tblpXSpec",this.wNamespace,l)}if(!sf.base.isNullOrUndefined(t[lo[this.keywordIndex]][zt[this.keywordIndex]])&&t[lo[this.keywordIndex]][zt[this.keywordIndex]]!==(1==this.keywordIndex?0:"None")){s=t[lo[this.keywordIndex]][mo[this.keywordIndex]]===(1==this.keywordIndex?0:"Paragraph")?"text":1==this.keywordIndex?this.getTableVerticalRelation(t[lo[this.keywordIndex]][mo[this.keywordIndex]]).toLowerCase():this.getTableVerticalRelation(this.getTableVerticalRelationEnumValue(t[lo[this.keywordIndex]][mo[this.keywordIndex]])).toLowerCase();e.writeAttributeString("w","vertAnchor",this.wNamespace,s)}if((!sf.base.isNullOrUndefined(t[lo[this.keywordIndex]][wo[this.keywordIndex]])&&t[lo[this.keywordIndex]][wo[this.keywordIndex]]===(1==this.keywordIndex?0:"Left")||!t[lo[this.keywordIndex]][wo[this.keywordIndex]])&&t[lo[this.keywordIndex]][bo[this.keywordIndex]]>0){var d=Math.round(t[lo[this.keywordIndex]][bo[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","tblpX",this.wNamespace,d)}if(!sf.base.isNullOrUndefined(t[lo[this.keywordIndex]][zt[this.keywordIndex]])&&t[lo[this.keywordIndex]][zt[this.keywordIndex]]===(1==this.keywordIndex?0:"None")){var h=Math.round(t[lo[this.keywordIndex]][yo[this.keywordIndex]]*this.twipsInOnePoint).toString();e.writeAttributeString("w","tblpY",this.wNamespace,h)}e.writeEndElement(),x.parseBoolValue(t[lo[this.keywordIndex]][co[this.keywordIndex]])||(e.writeStartElement("w","tblOverlap",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"never"),e.writeEndElement())}sf.base.isNullOrUndefined(t[so[this.keywordIndex]])||(e.writeStartElement("w","tblDescription",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[so[this.keywordIndex]]),e.writeEndElement()),sf.base.isNullOrUndefined(t[En[this.keywordIndex]])||(e.writeStartElement("w","tblCaption",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[En[this.keywordIndex]]),e.writeEndElement())},e.prototype.serializeTableMargins=function(e,t){this.serializeMargins(e,t,"tblCellMar")},e.prototype.serializeRowMargins=function(e,t){e.writeStartElement(void 0,"tblPrEx",this.wNamespace),e.writeStartElement(void 0,"tblBorders",this.wNamespace),this.serializeBorders(e,t[ct[this.keywordIndex]],8,!1),e.writeEndElement(),this.serializeMargins(e,t,"tblCellMar"),e.writeEndElement()},e.prototype.serializeCellMargins=function(e,t){this.serializeMargins(e,t,"tcMar")},e.prototype.serializeMargins=function(e,t,i){if(e.writeStartElement(void 0,i,this.wNamespace),!sf.base.isNullOrUndefined(t[xt[this.keywordIndex]])){var r=Math.round(20*t[xt[this.keywordIndex]]);e.writeStartElement(void 0,"top",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,r.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!sf.base.isNullOrUndefined(t[wt[this.keywordIndex]])){var n=Math.round(20*t[wt[this.keywordIndex]]);e.writeStartElement(void 0,"left",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,n.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!sf.base.isNullOrUndefined(t[It[this.keywordIndex]])){var o=Math.round(20*t[It[this.keywordIndex]]);e.writeStartElement(void 0,"bottom",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,o.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}if(!sf.base.isNullOrUndefined(t[bt[this.keywordIndex]])){var s=Math.round(20*t[bt[this.keywordIndex]]);e.writeStartElement(void 0,"right",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,s.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}e.writeEndElement()},e.prototype.serializeShading=function(e,t){e.writeStartElement(void 0,"shd",this.wNamespace),t[ni[this.keywordIndex]]&&"empty"!==t[ni[this.keywordIndex]]?e.writeAttributeString(void 0,"fill",this.wNamespace,this.getColor(t[ni[this.keywordIndex]])):e.writeAttributeString(void 0,"fill",this.wNamespace,"auto"),"empty"===t[oi[this.keywordIndex]]||sf.base.isNullOrUndefined(t[oi[this.keywordIndex]])?e.writeAttributeString(void 0,"color",this.wNamespace,"auto"):e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t[oi[this.keywordIndex]])),sf.base.isNullOrUndefined(t[ri[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,this.getTextureStyle(t[ri[this.keywordIndex]])),e.writeEndElement()},e.prototype.getTextureStyle=function(e){switch(e){case"Texture5Percent":case"Texture2Pt5Percent":case"Texture7Pt5Percent":case 1:case 2:case 3:return"pct5";case"Texture10Percent":case 4:return"pct10";case"Texture12Pt5Percent":case 5:return"pct12";case"Texture15Percent":case"Texture17Pt5Percent":case 6:case 7:return"pct15";case"Texture20Percent":case"Texture22Pt5Percent":case 8:case 9:return"pct20";case"Texture25Percent":case"Texture27Pt5Percent":case 10:case 11:return"pct25";case"Texture30Percent":case"Texture32Pt5Percent":case 12:case 13:return"pct30";case"Texture35Percent":case 14:return"pct35";case"Texture37Pt5Percent":case 15:return"pct37";case"Texture40Percent":case"Texture42Pt5Percent":case 16:case 17:return"pct40";case"Texture45Percent":case"Texture47Pt5Percent":case 18:case 19:return"pct45";case"Texture50Percent":case"Texture52Pt5Percent":case 20:case 21:return"pct50";case"Texture55Percent":case"Texture57Pt5Percent":case 22:case 23:return"pct55";case"Texture60Percent":case 24:return"pct60";case"Texture62Pt5Percent":case 25:return"pct62";case"Texture65Percent":case"Texture67Pt5Percent":case 26:case 27:return"pct65";case"Texture70Percent":case"Texture72Pt5Percent":case 28:case 29:return"pct70";case"Texture75Percent":case"Texture77Pt5Percent":case 30:case 31:return"pct75";case"Texture80Percent":case"Texture82Pt5Percent":case 32:case 33:return"pct80";case"Texture85Percent":case 34:return"pct85";case"Texture87Pt5Percent":case 35:return"pct87";case"Texture90Percent":case"Texture92Pt5Percent":case 36:case 37:return"pct90";case"Texture95Percent":case"Texture97Pt5Percent":case 38:case 39:return"pct95";case 40:return"solid";case"TextureCross":return"thinHorzCross";case"TextureDarkCross":return"horzCross";case"TextureDarkDiagonalCross":return"diagCross";case"TextureDarkDiagonalDown":return"reverseDiagStripe";case"TextureDarkDiagonalUp":return"diagStripe";case"TextureDarkHorizontal":case 41:return"horzStripe";case"TextureDarkVertical":case 42:return"vertStripe";case 43:return"reverseDiagStripe";case 44:return"diagStripe";case 45:return"horzCross";case 46:return"diagCross";case"TextureDiagonalCross":return"thinDiagCross";case"TextureDiagonalDown":return"thinReverseDiagStripe";case"TextureDiagonalUp":return"thinDiagStripe";case"TextureHorizontal":case 47:return"thinHorzStripe";case"TextureSolid":return"solid";case"TextureVertical":case 48:return"thinVertStripe";case 49:return"thinReverseDiagStripe";case 50:return"thinDiagStripe";case 51:return"thinHorzCross";case 52:return"thinDiagCross";default:return"clear"}},e.prototype.serializeParagraphBorders=function(e,t){var i=t[ct[this.keywordIndex]];sf.base.isNullOrUndefined(i)||(e.writeStartElement(void 0,"pBdr",this.wNamespace),this.serializeBorders(e,t[ct[this.keywordIndex]],8,!0),e.writeEndElement())},e.prototype.serializeTableBorders=function(e,t){var i=t[ct[this.keywordIndex]];sf.base.isNullOrUndefined(i)||(e.writeStartElement(void 0,"tblBorders",this.wNamespace),this.serializeBorders(e,t[ct[this.keywordIndex]],8,!1),e.writeEndElement())},e.prototype.serializeBorders=function(e,t,i,r){this.serializeBorder(e,t[qr[this.keywordIndex]],"top",i),this.serializeBorder(e,t[Gr[this.keywordIndex]],"left",i),this.serializeBorder(e,t[_r[this.keywordIndex]],"bottom",i),this.serializeBorder(e,t[jr[this.keywordIndex]],"right",i),r?(this.serializeBorder(e,t[di[this.keywordIndex]],"between",i),this.serializeBorder(e,t[li[this.keywordIndex]],"bar",i)):(this.serializeBorder(e,t[di[this.keywordIndex]],"insideH",i),this.serializeBorder(e,t[li[this.keywordIndex]],"insideV",i),this.serializeBorder(e,t[ci[this.keywordIndex]],"tl2br",i),this.serializeBorder(e,t[hi[this.keywordIndex]],"tr2bl",i))},e.prototype.serializePageNumberType=function(e,t){void 0!==t[Tt[this.keywordIndex]]&&(e.writeStartElement(void 0,"pgNumType",this.wNamespace),e.writeAttributeString(void 0,"fmt",this.wNamespace,this.getPageNumberFormat(t[Tt[this.keywordIndex]])),e.writeEndElement())},e.prototype.serializeTblLayout=function(e,t){(!x.parseBoolValue(t[Yt[this.keywordIndex]])||t[ei[this.keywordIndex]]>this.containerWidth)&&(e.writeStartElement(void 0,"tblLayout",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"fixed"),e.writeEndElement())},e.prototype.serializeBorder=function(e,t,i,r){var n=t[pi[this.keywordIndex]],o=(t[gi[this.keywordIndex]]?t[gi[this.keywordIndex]]:0)*r,s=t[ts[this.keywordIndex]]?t[ts[this.keywordIndex]]:0;if(n===(1==this.keywordIndex?26:"Cleared"))return e.writeStartElement(void 0,i,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"nil"),void e.writeEndElement();(n===(1==this.keywordIndex?1:"None")||sf.base.isNullOrUndefined(n))&&!x.parseBoolValue(t[ai[this.keywordIndex]])||o<0&&!x.parseBoolValue(t[ai[this.keywordIndex]])||(e.writeStartElement(void 0,i,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getBorderStyle(n)),t[Br[this.keywordIndex]]&&e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t[Br[this.keywordIndex]])),e.writeAttributeString(void 0,"sz",this.wNamespace,this.roundToTwoDecimal(o).toString()),e.writeAttributeString(void 0,"space",this.wNamespace,s.toString()),x.parseBoolValue(t[si[this.keywordIndex]])&&e.writeAttributeString(void 0,"shadow",this.wNamespace,"on"),e.writeEndElement())},e.prototype.getBorderStyle=function(e){switch(e){case"Cleared":return"cleared";case"None":case 1:return"None";case"DashSmallGap":return"dashSmallGap";case"Triple":return"triple";case"Dot":case 2:return"dotted";case 3:return"dashSmallGap";case"DashDot":return"dotDash";case"DashLargeGap":case 4:return"dashed";case 5:return"dotDash";case"DashDotDot":case 6:return"dotDotDash";case"Double":case 7:return"double";case 8:return"triple";case"ThinThickSmallGap":case 9:return"thinThickSmallGap";case"ThickThinSmallGap":case 10:return"thickThinSmallGap";case"ThinThickThinSmallGap":case 11:return"thinThickThinSmallGap";case"ThickThinMediumGap":case 12:return"thickThinMediumGap";case"ThinThickMediumGap":case 13:return"thinThickMediumGap";case"ThinThickThinMediumGap":case 14:return"thinThickThinMediumGap";case"ThickThinLargeGap":return"thickThinLargeGap";case"ThinThickLargeGap":case 15:return"thinThickLargeGap";case 16:return"thickThinLargeGap";case"ThinThickThinLargeGap":case 17:return"thinThickThinLargeGap";case"Thick":return"thick";case"SingleWavy":case 18:return"wave";case"DoubleWavy":case 19:return"doubleWave";case"DashDotStroked":case 20:return"dashDotStroked";case"Engrave3D":return"threeDEngrave";case"Emboss3D":case 21:return"threeDEmboss";case 22:return"threeDEngrave";case"Outset":case 23:return"outset";case"Inset":case 24:return"inset";case 25:return"thick";case 26:return"cleared";default:return"single"}},e.prototype.serializeTableIndentation=function(e,t){if(!sf.base.isNullOrUndefined(t[Je[this.keywordIndex]])){e.writeStartElement(void 0,"tblInd",this.wNamespace);var i=Math.round(t[Je[this.keywordIndex]]*this.twipsInOnePoint);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()}},e.prototype.serializeCellSpacing=function(e,t){!sf.base.isNullOrUndefined(t[Zt[this.keywordIndex]])&&t[Zt[this.keywordIndex]]>0&&(e.writeStartElement(void 0,"tblCellSpacing",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t[Zt[this.keywordIndex]]/2*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement())},e.prototype.serializeTableWidth=function(e,t){if(e.writeStartElement(void 0,"tblW",this.wNamespace),t[ho[this.keywordIndex]][ti[this.keywordIndex]]===(1==this.keywordIndex?1:"Percent")){var i=Math.round(t[ho[this.keywordIndex]][ei[this.keywordIndex]]*this.percentageFactor);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"pct")}else if(t[ho[this.keywordIndex]][ti[this.keywordIndex]]===(1==this.keywordIndex?2:"Point")){i=Math.round(t[ho[this.keywordIndex]][ei[this.keywordIndex]]*this.twipsInOnePoint);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")}else e.writeAttributeString(void 0,"w",this.wNamespace,"0"),e.writeAttributeString(void 0,"type",this.wNamespace,"auto");e.writeEndElement()},e.prototype.serializeTableAlignment=function(e,t){switch(e.writeStartElement(void 0,"jc",this.wNamespace),t[$t[this.keywordIndex]]){case"Center":case 1:e.writeAttributeString("w","val",this.wNamespace,"center");break;case"Right":case 2:e.writeAttributeString("w","val",this.wNamespace,"right");break;default:e.writeAttributeString("w","val",this.wNamespace,"left")}e.writeEndElement()},e.prototype.serializeFieldCharacter=function(e,t){e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t[q[this.keywordIndex]]),e.writeStartElement(void 0,"fldChar",this.wNamespace);var i=0===t[Zr[this.keywordIndex]]?"begin":1===t[Zr[this.keywordIndex]]?"end":"separate";if(e.writeAttributeString(void 0,"fldCharType",this.wNamespace,i),"begin"===i&&!sf.base.isNullOrUndefined(t[Yr[this.keywordIndex]])){var r=t[Yr[this.keywordIndex]];if(e.writeStartElement(void 0,"ffData",this.wNamespace),e.writeStartElement(void 0,"name",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[ye[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement(void 0,"enabled",this.wNamespace),e.writeEndElement(),r.hasOwnProperty(tn[this.keywordIndex])){e.writeStartElement(void 0,"textInput",this.wNamespace);var n=1==this.keywordIndex?this.getTextFormFieldType(r[tn[this.keywordIndex]][hs[this.keywordIndex]]):r[tn[this.keywordIndex]][hs[this.keywordIndex]].toString();e.writeStartElement(void 0,"type",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"Calculation"==n?"calculated":n.toLowerCase()),e.writeEndElement(),e.writeStartElement(void 0,"default",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[tn[this.keywordIndex]][sn[this.keywordIndex]]),e.writeEndElement(),e.writeStartElement(void 0,"format",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,1==this.keywordIndex&&"Text"===n?this.getTextFormFieldFormat(r[tn[this.keywordIndex]][an[this.keywordIndex]]):r[tn[this.keywordIndex]][an[this.keywordIndex]]),e.writeEndElement(),e.writeEndElement()}else if(r.hasOwnProperty(rn[this.keywordIndex]))e.writeStartElement(void 0,"checkBox",this.wNamespace),r[rn[this.keywordIndex]][ln[this.keywordIndex]]===(1==this.keywordIndex?0:"Auto")?(e.writeStartElement(void 0,"sizeAuto",this.wNamespace),e.writeEndElement()):(e.writeStartElement(void 0,"size",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.roundToTwoDecimal(2*r[rn[this.keywordIndex]][dn[this.keywordIndex]]).toString()),e.writeEndElement()),e.writeStartElement(void 0,"defalut",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[rn[this.keywordIndex]][sn[this.keywordIndex]]?"1":"0"),e.writeEndElement(),r[rn[this.keywordIndex]][hn[this.keywordIndex]]&&(e.writeStartElement(void 0,"checked",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[rn[this.keywordIndex]][hn[this.keywordIndex]]?"1":"0"),e.writeEndElement()),e.writeEndElement();else{e.writeStartElement(void 0,"ddList",this.wNamespace),0!==r[nn[this.keywordIndex]][pn[this.keywordIndex]]&&(e.writeStartElement(void 0,"result",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[nn[this.keywordIndex]][pn[this.keywordIndex]].toString()),e.writeEndElement());for(var o=0;o<r[nn[this.keywordIndex]][cn[this.keywordIndex]].length;o++)e.writeStartElement(void 0,"listEntry",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[nn[this.keywordIndex]][cn[this.keywordIndex]][o].toString()),e.writeEndElement();e.writeEndElement()}e.writeEndElement()}e.writeEndElement(),e.writeEndElement(),0===t[Zr[this.keywordIndex]]&&"FieldFormTextInput"===t[Zr[this.keywordIndex]]&&(e.writeStartElement("w","r",this.wNamespace),e.writeStartElement(void 0,"instrText",this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString("FORMTEXT"),e.writeEndElement(),e.writeEndElement())},e.prototype.serializeTextRange=function(e,t,i,r){if(e.writeStartElement("w","r",this.wNamespace),sf.base.isNullOrUndefined(t[q[this.keywordIndex]])||this.serializeCharacterFormat(e,t[q[this.keywordIndex]]),"\t"===t[gr[this.keywordIndex]])e.writeElementString(void 0,"tab",this.wNamespace,void 0);else if("\v"===t[gr[this.keywordIndex]])e.writeElementString(void 0,"br",this.wNamespace,void 0);else if(sf.base.isNullOrUndefined(t[Be[this.keywordIndex]]))if("\f"===t[gr[this.keywordIndex]])e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"page"),e.writeEndElement();else if("\r"===t[gr[this.keywordIndex]])e.writeStartElement("w","cr",this.wNamespace),e.writeEndElement();else if(t[gr[this.keywordIndex]]===String.fromCharCode(14))e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"column"),e.writeEndElement();else if("%02"===encodeURI(t[gr[this.keywordIndex]]))e.writeStartElement(void 0,"footnoteRef",this.wNamespace),e.writeEndElement();else if("%02"===encodeURI(t[gr[this.keywordIndex]])&&"endnote"===r)e.writeStartElement(void 0,"endnoteRef",this.wNamespace),e.writeEndElement();else if("%03"===encodeURI(t[gr[this.keywordIndex]]))e.writeStartElement(void 0,"separator",this.wNamespace),e.writeEndElement();else if("%04"===encodeURI(t[gr[this.keywordIndex]]))e.writeStartElement(void 0,"continuationSeparator",this.wNamespace),e.writeEndElement();else{var n=this.retrieveDeleteRevision(t),o=!sf.base.isNullOrUndefined(i)&&i.hasOwnProperty(Zr[this.keywordIndex])&&2!==i[Zr[this.keywordIndex]]?n?"delInstrText":"instrText":n?"delText":"t";e.writeStartElement(void 0,o,this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString(t[gr[this.keywordIndex]]),e.writeEndElement()}else e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"textWrapping"),e.writeAttributeString("w","clear",this.wNamespace,this.getBreakClearType(t[Be[this.keywordIndex]]).toString().toLowerCase()),e.writeEndElement();e.writeEndElement()},e.prototype.retrieveDeleteRevision=function(e){if(e.hasOwnProperty(Ge[this.keywordIndex])&&e[Ge[this.keywordIndex]].length>0)for(var t=0;t<e[Ge[this.keywordIndex]].length;t++)if("Deletion"===this.retrieveRevision(e[Ge[this.keywordIndex]][t]).revisionType)return!0;return!1},e.prototype.serializeParagraphFormat=function(e,t,i){sf.base.isNullOrUndefined(t)||(this.serializeParagraphBorders(e,t),sf.base.isNullOrUndefined(t[Ee[this.keywordIndex]])||(e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[Ee[this.keywordIndex]]),e.writeEndElement()),sf.base.isNullOrUndefined(i)?this.serializeListFormat(e,t[ot[this.keywordIndex]]):this.serializeListFormat(e,i[_[this.keywordIndex]][ot[this.keywordIndex]]),x.parseBoolValue(t[Re[this.keywordIndex]])&&(e.writeStartElement(void 0,"bidi",this.wNamespace),e.writeEndElement()),sf.base.isNullOrUndefined(t[st[this.keywordIndex]])||(e.writeStartElement(void 0,"keepNext",this.wNamespace),x.parseBoolValue(t[st[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),sf.base.isNullOrUndefined(t[lt[this.keywordIndex]])||(e.writeStartElement(void 0,"keepLines",this.wNamespace),x.parseBoolValue(t[lt[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),sf.base.isNullOrUndefined(t[dt[this.keywordIndex]])||(e.writeStartElement(void 0,"outlineLvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getOutlineLevelValue(t[dt[this.keywordIndex]]).toString()),e.writeEndElement()),this.serializeParagraphSpacing(e,t),sf.base.isNullOrUndefined(t[ht[this.keywordIndex]])||(e.writeStartElement("w","contextualSpacing",this.wNamespace),x.parseBoolValue(t[ht[this.keywordIndex]])||e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),sf.base.isNullOrUndefined(t[at[this.keywordIndex]])||(e.writeStartElement("w","widowControl",this.wNamespace),x.parseBoolValue(t[at[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,"1"):e.writeAttributeString("w","val",this.wNamespace,"0"),e.writeEndElement()),this.serializeIndentation(e,t),this.serializeParagraphAlignment(e,t[Qe[this.keywordIndex]],x.parseBoolValue(t[Re[this.keywordIndex]])),!sf.base.isNullOrUndefined(t[pt[this.keywordIndex]])&&t[pt[this.keywordIndex]].length>0&&this.serializeTabs(e,t[pt[this.keywordIndex]]))},e.prototype.getOutlineLevelValue=function(e){if(1==this.keywordIndex){if(e>0)return e-1}else if(-1!==e.toString().indexOf("Level")){var t=parseInt(e.toString().substring(5),10);if(t>0)return t-1}return 9},e.prototype.serializeTabs=function(e,t){e.writeStartElement("w","tabs",this.wNamespace);for(var i=0;i<t.length;i++)this.serializeTab(e,t[i]);e.writeEndElement()},e.prototype.serializeTab=function(e,t){var i=0;e.writeStartElement("w","tab",this.wNamespace),0===t[Go[this.keywordIndex]]&&0!==t[Ko[this.keywordIndex]]?(i=t[Ko[this.keywordIndex]]*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,"clear")):(i=t[Go[this.keywordIndex]]*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,this.getTabJustification(t[jo[this.keywordIndex]]))),sf.base.isNullOrUndefined(t[Xo[this.keywordIndex]])||t[Xo[this.keywordIndex]]===(1==this.keywordIndex?0:"None")||e.writeAttributeString("w","leader",this.wNamespace,this.getTabLeader(t[Xo[this.keywordIndex]])),isNaN(i)||e.writeAttributeString("w","pos",this.wNamespace,i.toString()+""),e.writeEndElement()},e.prototype.getTextWrappingType=function(e){switch(e){case 0:return"bothSides";case 1:return"left";case 2:return"right";case 3:return"largest";default:return"bothSides"}},e.prototype.getTextWrappingStyle=function(e){switch(e){case 1:return"InFrontOfText";case 2:return"Square";case 3:return"TopAndBottom";case 4:return"Behind";default:return"Inline"}},e.prototype.getDateStorageFormat=function(e){switch(e){case 2:return"DateStorageDateTime";case 3:return"DateStorageText";default:return"DateStorageDate"}},e.prototype.getDateCalendarType=function(e){switch(e){case 1:return"GregorianArabic";case 2:return"GregorianEnglish";case 3:return"GregorianMiddleEastFrench";case 4:return"GregorianTransliteratedEnglish";case 5:return"GregorianTransliteratedFrench";case 6:return"Hebrew";case 7:return"Hijri";case 8:return"Japan";case 9:return"Korean";case 10:return"Saka";case 11:return"Taiwan";case 12:return"Thai";default:return"Gregorian"}},e.prototype.getContentControlAppearance=function(e){switch(e){case 2:return"Hidden";case 3:return"Tags";default:return"BoundingBox"}},e.prototype.getTextFormFieldFormat=function(e){switch(e){case 1:return"FirstCapital";case 2:return"Lowercase";case 3:return"Uppercase";case 4:return"Titlecase";default:return"None"}},e.prototype.getTextFormFieldType=function(e){switch(e){case 1:return"Number";case 2:return"Date";case 3:return"Calculation";default:return"Text"}},e.prototype.getTabLeader=function(e){switch(e){case"Dot":case 2:return"dot";case"Hyphen":case 3:return"hyphen";case"Underscore":case 4:return"underscore";default:return"none"}},e.prototype.getTabJustification=function(e){switch(e){case"Bar":case 0:return"left";case 1:return"bar";case"Center":case 2:return"center";case"Decimal":case 3:return"decimal";case"Left":return"left";case"List":case 4:return"num";case"Right":case 5:return"right";default:return"clear"}},e.prototype.getTableVerticalAlignment=function(e){switch(e){case 1:return"top";case 2:return"center";case 3:return"bottom";case 4:return"inside";case 5:return"outside";default:return"none"}},e.prototype.getTableHorizontalAlignment=function(e){switch(e){case 1:return"center";case 2:return"inside";case 3:return"outside";case 4:return"right";default:return"left"}},e.prototype.getTableVerticalRelation=function(e){switch(e){case 1:return"Margin";case 2:return"Page";default:return"Paragraph"}},e.prototype.getTableVerticalRelationEnumValue=function(e){switch(e){case"Paragraph":return 0;case"Margin":return 1;case"Page":return 2;default:return 0}},e.prototype.getTableHorizontalRelation=function(e){switch(e){case 1:return"Margin";case 2:return"Page";default:return"Column"}},e.prototype.getVerticalOrigin=function(e){switch(e){case 1:return"BottomMargin";case 2:return"InsideMargin";case 3:return"Line";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"TopMargin";default:return"Paragraph"}},e.prototype.getHorizontalOrigin=function(e){switch(e){case 1:return"Character";case 2:return"InsideMargin";case 3:return"LeftMargin";case 4:return"Margin";case 5:return"OutsideMargin";case 6:return"Page";case 7:return"RightMargin";default:return"Column"}},e.prototype.getShapeVerticalAlignment=function(e){switch(e){case 1:return"Top";case 2:return"Center";case 3:return"Bottom";case 4:return"Inline";case 5:return"Inside";case 6:return"Outside";default:return"None"}},e.prototype.getShapeHorizontalAlignment=function(e){switch(e){case 1:return"Center";case 2:return"Inside";case 3:return"Left";case 4:return"Outside";case 5:return"Right";default:return"None"}},e.prototype.getBiDirectionalOverride=function(e){switch(e){case 1:return"LTR";case 2:return"RTL";default:return"None"}},e.prototype.getBreakClearType=function(e){switch(e){case 0:return"None";case 1:return"Left";case 2:return"Right";case 3:return"All";default:return e}},e.prototype.serializeListFormat=function(e,t){if(!sf.base.isNullOrUndefined(t[Ke[this.keywordIndex]])||!sf.base.isNullOrUndefined(t[Xe[this.keywordIndex]])){if(e.writeStartElement(void 0,"numPr",this.wNamespace),sf.base.isNullOrUndefined(t[Xe[this.keywordIndex]])||-1===t[Xe[this.keywordIndex]]||(e.writeStartElement(void 0,"ilvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[Xe[this.keywordIndex]].toString()),e.writeEndElement()),!sf.base.isNullOrUndefined(t[Ke[this.keywordIndex]])){e.writeStartElement(void 0,"numId",this.wNamespace);var i=(t[Ke[this.keywordIndex]]+1).toString();e.writeAttributeString("w","val",this.wNamespace,i),e.writeEndElement()}e.writeEndElement()}},e.prototype.serializeParagraphAlignment=function(e,t,i){if(!sf.base.isNullOrUndefined(t)){e.writeStartElement(void 0,"jc",this.wNamespace);var r=void 0;switch(t){case"Center":case 1:r="center";break;case"Right":case 2:r="right";break;case"Justify":case 3:r="both";break;default:r="left"}e.writeAttributeString("w","val",this.wNamespace,r),e.writeEndElement()}},e.prototype.serializeParagraphSpacing=function(e,t){if(e.writeStartElement(void 0,"spacing",this.wNamespace),sf.base.isNullOrUndefined(t[et[this.keywordIndex]])||e.writeAttributeString(void 0,"before",this.wNamespace,this.roundToTwoDecimal(t[et[this.keywordIndex]]*this.twentiethOfPoint).toString()),!sf.base.isNullOrUndefined(t[it[this.keywordIndex]])){var i=1==this.keywordIndex?t[it[this.keywordIndex]].toString():t[it[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"beforeAutospacing",this.wNamespace,i)}if(sf.base.isNullOrUndefined(t[$e[this.keywordIndex]])||e.writeAttributeString(void 0,"after",this.wNamespace,this.roundToTwoDecimal(t[$e[this.keywordIndex]]*this.twentiethOfPoint).toString()),!sf.base.isNullOrUndefined(t[tt[this.keywordIndex]])){i=1==this.keywordIndex?t[tt[this.keywordIndex]].toString():t[tt[this.keywordIndex]]?"1":"0";e.writeAttributeString(void 0,"afterAutospacing",this.wNamespace,i)}if(!sf.base.isNullOrUndefined(t[rt[this.keywordIndex]])){var r=t[nt[this.keywordIndex]]===(1==this.keywordIndex?1:"AtLeast")||t[nt[this.keywordIndex]]===(1==this.keywordIndex?2:"Exactly")?this.roundToTwoDecimal(t[rt[this.keywordIndex]]*this.twentiethOfPoint):this.roundToTwoDecimal(240*t[rt[this.keywordIndex]]);e.writeAttributeString(void 0,"line",this.wNamespace,r.toString())}if(!sf.base.isNullOrUndefined(t[nt[this.keywordIndex]])){var n="auto";t[nt[this.keywordIndex]]===(1==this.keywordIndex?1:"AtLeast")?n="atLeast":t[nt[this.keywordIndex]]===(1==this.keywordIndex?2:"Exactly")&&(n="exact"),e.writeAttributeString(void 0,"lineRule",this.wNamespace,n)}e.writeEndElement()},e.prototype.serializeIndentation=function(e,t){e.writeStartElement(void 0,"ind",this.wNamespace),sf.base.isNullOrUndefined(t[Je[this.keywordIndex]])||e.writeAttributeString(void 0,"left",this.wNamespace,this.roundToTwoDecimal(t[Je[this.keywordIndex]]*this.twipsInOnePoint).toString()),sf.base.isNullOrUndefined(t[Ye[this.keywordIndex]])||e.writeAttributeString(void 0,"right",this.wNamespace,this.roundToTwoDecimal(t[Ye[this.keywordIndex]]*this.twipsInOnePoint).toString()),sf.base.isNullOrUndefined(t[Ze[this.keywordIndex]])||(t[Ze[this.keywordIndex]]<0?e.writeAttributeString(void 0,"hanging",this.wNamespace,this.roundToTwoDecimal(-1*t[Ze[this.keywordIndex]]*this.twipsInOnePoint).toString()):e.writeAttributeString(void 0,"firstLine",this.wNamespace,this.roundToTwoDecimal(t[Ze[this.keywordIndex]]*this.twipsInOnePoint).toString())),e.writeEndElement()},e.prototype.serializeCustomXMLMapping=function(e,t){if(e.length>0)for(var i=e.keys,r=0;r<i.length;r++){var n=new sf.fileutils.XmlWriter;n.writeStartElement(void 0,"Relationships",this.rpNamespace);var o=this.mCustomXML.get(i[r]),s=i[r],a=this.getNextRelationShipID(),l=r+1,d=this.createXMLItem(o,a,l),h=this.createXMLItemProps(s,l);this.serializeRelationShip(t,a,this.customXmlRelType,"../"+d),this.customXMLRelation(n,l,h),n.writeEndElement();var c=new sf.compression.ZipArchiveItem(n.buffer,this.customXMLRelPath+l+".xml.rels");this.mArchive.addItem(c)}},e.prototype.customXMLRelation=function(e,t,i){this.serializeRelationShip(e,"rId1",this.wordMLCustomXmlPropsRelType,i)},e.prototype.createXMLItem=function(e,t,i){var r=new Blob([e],{type:"text/plain"}),n=this.customXMLItemsPath+i+".xml",o=new sf.compression.ZipArchiveItem(r,n);return this.mArchive.addItem(o),n},e.prototype.createXMLItemProps=function(e,t){var i=new sf.fileutils.XmlWriter,r=this.customXMLItemsPropspath+t+".xml",n=this.itemPropsPath+t+".xml";i.writeStartElement("ds","datastoreItem",this.wNamespace),i.writeAttributeString("ds","itemID",void 0,e),i.writeAttributeString("xmlns","ds",void 0,this.dsNamespace),i.writeEndElement(),this.customXMLProps.push(r);var o=new sf.compression.ZipArchiveItem(i.buffer,r);return this.mArchive.addItem(o),n},e.prototype.serializeStyles=function(){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","styles",this.wNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDefaultStyles(e),this.serializeDocumentStyles(e),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.stylePath);this.mArchive.addItem(t)},e.prototype.serializeDefaultStyles=function(e){e.writeStartElement(void 0,"docDefaults",this.wNamespace),e.writeStartElement(void 0,"rPrDefault",this.wNamespace),this.serializeCharacterFormat(e,this.defCharacterFormat),e.writeEndElement(),e.writeStartElement(void 0,"pPrDefault",this.wNamespace),sf.base.isNullOrUndefined(this.defParagraphFormat)||(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,this.defParagraphFormat,void 0),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDocumentStyles=function(e){for(var t=0;t<this.mStyles.length;t++){var i=this.mStyles[t];e.writeStartElement(void 0,"style",this.wNamespace);var r=this.getStyleType(i[hs[this.keywordIndex]]);e.writeAttributeString("w","type",this.wNamespace,r),e.writeAttributeString("w","styleId",this.wNamespace,i[ye[this.keywordIndex]]),e.writeStartElement(void 0,"name",this.wNamespace);-1!=["TOC 1","TOC 2","TOC 3","TOC 4","TOC 5","TOC 6","TOC 7","TOC 8","TOC 9"].indexOf(i[ye[this.keywordIndex]])?e.writeAttributeString("w","val",this.wNamespace,i[ye[this.keywordIndex]].toLowerCase()):e.writeAttributeString("w","val",this.wNamespace,i[ye[this.keywordIndex]]),e.writeEndElement(),sf.base.isNullOrUndefined(i[ve[this.keywordIndex]])||(e.writeStartElement(void 0,"basedOn",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i[ve[this.keywordIndex]]),e.writeEndElement()),sf.base.isNullOrUndefined(i[we[this.keywordIndex]])||(e.writeStartElement(void 0,"next",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i[we[this.keywordIndex]]),e.writeEndElement()),sf.base.isNullOrUndefined(i[be[this.keywordIndex]])||(e.writeStartElement(void 0,"link",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i[be[this.keywordIndex]]),e.writeEndElement()),i[hs[this.keywordIndex]]===(1==this.keywordIndex?0:"Paragraph")&&(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,i[_[this.keywordIndex]],void 0),e.writeEndElement()),i[hs[this.keywordIndex]]!==(1==this.keywordIndex?2:"Table")&&this.serializeCharacterFormat(e,i[q[this.keywordIndex]]),e.writeEndElement()}},e.prototype.serializeCharacterFormat=function(e,t){if(sf.base.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=0),e.writeStartElement(void 0,"rPr",this.wNamespace),sf.base.isNullOrUndefined(t[Ee[this.keywordIndex]])||(e.writeStartElement(void 0,"rStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[Ee[this.keywordIndex]]),e.writeEndElement()),!sf.base.isNullOrUndefined(t[He[this.keywordIndex]])||!sf.base.isNullOrUndefined(t[Ae[this.keywordIndex]])){if(e.writeStartElement(void 0,"rFonts",this.wNamespace),!sf.base.isNullOrUndefined(t[qe[this.keywordIndex]])){var i=x.isThemeFont(t[qe[this.keywordIndex]])?"asciiTheme":"ascii";e.writeAttributeString(void 0,i,this.wNamespace,t[qe[this.keywordIndex]])}if(!sf.base.isNullOrUndefined(t[_e[this.keywordIndex]])){i=x.isThemeFont(t[_e[this.keywordIndex]])?"eastAsiaTheme":"eastAsia";e.writeAttributeString(void 0,i,this.wNamespace,t[_e[this.keywordIndex]])}if(!sf.base.isNullOrUndefined(t[je[this.keywordIndex]])){i=x.isThemeFont(t[je[this.keywordIndex]])?"hAnsiTheme":"hAnsi";e.writeAttributeString(void 0,i,this.wNamespace,t[je[this.keywordIndex]])}if(!sf.base.isNullOrUndefined(t[Ae[this.keywordIndex]])){i=x.isThemeFont(t[Ae[this.keywordIndex]])?"cstheme":"cs";e.writeAttributeString(void 0,i,this.wNamespace,t[Ae[this.keywordIndex]])}e.writeEndElement()}if(sf.base.isNullOrUndefined(t[Ce[this.keywordIndex]])||this.serializeBoolProperty(e,"b",x.parseBoolValue(t[Ce[this.keywordIndex]])),x.parseBoolValue(t[Me[this.keywordIndex]])&&this.serializeBoolProperty(e,"bCs",x.parseBoolValue(t[Me[this.keywordIndex]])),sf.base.isNullOrUndefined(t[We[this.keywordIndex]])||this.serializeBoolProperty(e,"i",x.parseBoolValue(t[We[this.keywordIndex]])),sf.base.isNullOrUndefined(t[ze[this.keywordIndex]])||this.serializeBoolProperty(e,"iCs",x.parseBoolValue(t[ze[this.keywordIndex]])),x.parseBoolValue(t[Re[this.keywordIndex]])&&(e.writeStartElement(void 0,"rtl",this.wNamespace),e.writeEndElement()),x.parseBoolValue(t[De[this.keywordIndex]])&&this.serializeBoolProperty(e,"caps",x.parseBoolValue(t[De[this.keywordIndex]])),x.parseBoolValue(t[Ve[this.keywordIndex]])&&this.serializeBoolProperty(e,"cs",x.parseBoolValue(t[Ve[this.keywordIndex]])),!sf.base.isNullOrUndefined(t[Pe[this.keywordIndex]]))switch(t[Pe[this.keywordIndex]]){case"SingleStrike":case 1:this.serializeBoolProperty(e,"strike",!0);break;case"DoubleStrike":case 2:this.serializeBoolProperty(e,"dstrike",!0);break;default:this.serializeBoolProperty(e,"strike",!1),this.serializeBoolProperty(e,"dstrike",!1)}if(sf.base.isNullOrUndefined(t[Te[this.keywordIndex]])||(e.writeStartElement(void 0,"color",this.wNamespace),"empty"===t[Te[this.keywordIndex]]||"#00000000"===t[Te[this.keywordIndex]]?e.writeAttributeString("w","val",this.wNamespace,"auto"):e.writeAttributeString("w","val",this.wNamespace,this.getColor(t[Te[this.keywordIndex]])),e.writeEndElement()),sf.base.isNullOrUndefined(t[Oe[this.keywordIndex]])||(e.writeStartElement(void 0,"sz",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t[Oe[this.keywordIndex]]).toString()),e.writeEndElement()),sf.base.isNullOrUndefined(t[Bs[this.keywordIndex]])||(e.writeStartElement(void 0,"spacing",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,(20*t[Bs[this.keywordIndex]]).toString()),e.writeEndElement()),sf.base.isNullOrUndefined(t[Ls[this.keywordIndex]])||(e.writeStartElement(void 0,"w",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t[Ls[this.keywordIndex]].toString()),e.writeEndElement()),sf.base.isNullOrUndefined(t[Le[this.keywordIndex]])||(e.writeStartElement(void 0,"szCs",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*t[Le[this.keywordIndex]]).toString()),e.writeEndElement()),sf.base.isNullOrUndefined(t[Ne[this.keywordIndex]])||t[Ne[this.keywordIndex]]===(1==this.keywordIndex?0:"NoColor")||(e.writeStartElement(void 0,"highlight",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getHighlightColor(t[Ne[this.keywordIndex]])),e.writeEndElement()),!sf.base.isNullOrUndefined(t[Ge[this.keywordIndex]])&&t[Ge[this.keywordIndex]].length>0&&(this.serializeRevisionStart(e,t,void 0),this.serializeRevisionEnd(e,t,void 0)),sf.base.isNullOrUndefined(t[ke[this.keywordIndex]])||(e.writeStartElement(void 0,"u",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getUnderlineStyle(t[ke[this.keywordIndex]])),e.writeEndElement()),!sf.base.isNullOrUndefined(t[Se[this.keywordIndex]])){switch(e.writeStartElement(void 0,"vertAlign",this.wNamespace),t[Se[this.keywordIndex]]){case"Superscript":case 1:e.writeAttributeString("w","val",this.wNamespace,"superscript");break;case"Subscript":case 2:e.writeAttributeString("w","val",this.wNamespace,"subscript");break;default:e.writeAttributeString("w","val",this.wNamespace,"baseline")}e.writeEndElement()}e.writeEndElement()},e.prototype.getColor=function(e){return e.length>0&&("#"===e[0]&&(e=e.substr(1)),e.length>6&&(e=e.substr(0,6))),e},e.prototype.getStyleType=function(e){switch(e){case"Character":case 1:return"character";case"Table":case 2:return"table";default:return"paragraph"}},e.prototype.getUnderlineStyle=function(e){switch(e){case"None":case 0:return"none";case"Single":case 1:return"single";case"Words":case 2:return"words";case"Double":case 3:return"double";case"Dotted":case 4:return"dotted";case"Thick":case 5:return"thick";case 6:return"dash";case"DashLong":case 7:return"dashLong";case"DotDash":case 8:return"dotDash";case"DotDotDash":case 9:return"dotDotDash";case"Wavy":case 10:return"wave";case"DottedHeavy":case 11:return"dottedHeavy";case"DashHeavy":case 12:return"dashedHeavy";case"DashLongHeavy":case 13:return"dashLongHeavy";case"DotDashHeavy":case 14:return"dashDotHeavy";case"DotDotDashHeavy":case 15:return"dashDotDotHeavy";case"WavyHeavy":case 16:return"wavyHeavy";case"WavyDouble":case 17:return"wavyDouble";default:return"dash"}},e.prototype.getHighlightColor=function(e){switch(e){case"BrightGreen":case 2:return"green";case"Turquoise":case 3:return"cyan";case"Pink":case 4:return"magenta";case"Blue":case 5:return"blue";case"Red":case 6:return"red";case"DarkBlue":case 7:return"darkBlue";case"Teal":case 8:return"darkCyan";case"Green":case 9:return"darkGreen";case"Violet":case 10:return"darkMagenta";case"DarkRed":case 11:return"darkRed";case"DarkYellow":case 12:return"darkYellow";case"Gray50":case 13:return"darkGray";case"Gray25":case 14:return"lightGray";case"Black":case 15:return"black";default:return"yellow"}},e.prototype.serializeBoolProperty=function(e,t,i){e.writeStartElement(void 0,t,this.wNamespace),i||e.writeAttributeString(void 0,"val",this.wNamespace,"0"),e.writeEndElement()},e.prototype.serializeNumberings=function(){if(0!==this.document[j[this.keywordIndex]].length){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","numbering",this.wNamespace),this.writeCommonAttributeStrings(e),this.serializeAbstractListStyles(e,this.document[G[this.keywordIndex]]),this.serializeListInstances(e,this.document[j[this.keywordIndex]]),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.numberingPath);this.mArchive.addItem(t)}},e.prototype.serializeAbstractListStyles=function(e,t){for(var i=0;i<t.length;i++){var r=t[i];e.writeStartElement(void 0,"abstractNum",this.wNamespace),e.writeAttributeString(void 0,"abstractNumId",this.wNamespace,r[Bo[this.keywordIndex]].toString()),e.writeStartElement(void 0,"nsid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.generateHex()),e.writeEndElement();for(var n=0,o=r[Lo[this.keywordIndex]].length;n<o;n++)this.serializeListLevel(e,r[Lo[this.keywordIndex]][n],n);e.writeEndElement()}},e.prototype.serializeListInstances=function(e,t){for(var i=0;i<t.length;i++){var r=t[i];e.writeStartElement(void 0,"num",this.wNamespace),e.writeAttributeString(void 0,"numId",this.wNamespace,(r[Ke[this.keywordIndex]]+1).toString()),e.writeStartElement(void 0,"abstractNumId",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r[Bo[this.keywordIndex]].toString()),e.writeEndElement();for(var n=0,o=r[Mo[this.keywordIndex]].length;n<o;n++)this.serializeLevelOverrides(e,r[Mo[this.keywordIndex]][n],r[Mo[this.keywordIndex]][n][Ro[this.keywordIndex]]);e.writeEndElement()}},e.prototype.generateHex=function(){return(Math.floor(373e7*Math.random())+27e7).toString(16).toUpperCase()},e.prototype.roundToTwoDecimal=function(e){return Math.round(e)},e.prototype.serializeListLevel=function(e,t,i){e.writeStartElement(void 0,"lvl",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,i.toString()),!sf.base.isNullOrUndefined(t[le[this.keywordIndex]])&&t[le[this.keywordIndex]]&&e.writeElementString(void 0,"isLgl",this.wNamespace,void 0),e.writeStartElement(void 0,"start",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Ho[this.keywordIndex]].toString()),e.writeEndElement(),e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getLevelPattern(t[Oo[this.keywordIndex]])),e.writeEndElement(),sf.base.isNullOrUndefined(t[Y[this.keywordIndex]])||""===t[Y[this.keywordIndex]].toString()||(e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Y[this.keywordIndex]].toString()),e.writeEndElement()),this.serializeLevelFollow(e,t),this.serializeLevelText(e,t,i+1),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,t[_[this.keywordIndex]],void 0),e.writeEndElement(),this.serializeCharacterFormat(e,t[q[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeLevelOverrides=function(e,t,i){e.writeStartElement(void 0,"lvlOverride",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,i.toString()),sf.base.isNullOrUndefined(t[Ao[this.keywordIndex]])||this.serializeListLevel(e,t[Ao[this.keywordIndex]],i),sf.base.isNullOrUndefined(t[Ho[this.keywordIndex]])||(e.writeStartElement(void 0,"startOverride",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Ho[this.keywordIndex]].toString()),e.writeEndElement()),e.writeEndElement()},e.prototype.getLevelPattern=function(e){var t;switch(e){case"None":case 0:t="none";break;case"Arabic":case 1:t="decimal";break;case"UpRoman":case 2:t="upperRoman";break;case"LowRoman":case 3:t="lowerRoman";break;case"UpLetter":case 4:t="upperLetter";break;case"LowLetter":case 5:t="lowerLetter";break;case"Ordinal":case 6:t="ordinal";break;case"Number":case 7:t="cardinalText";break;case"OrdinalText":case 8:t="ordinalText";break;case"LeadingZero":case 9:t="decimalZero";break;case"FarEast":case 11:t="aiueoFullWidth";break;case"Special":case 12:t="russianLower";break;default:t="bullet"}return t},e.prototype.serializeLevelText=function(e,t,i){e.writeStartElement(void 0,"lvlText",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t[Uo[this.keywordIndex]]),e.writeEndElement()},e.prototype.serializeLevelFollow=function(e,t){var i;i=t[To[this.keywordIndex]]===(1==this.keywordIndex?0:"Tab")?"tab":t[To[this.keywordIndex]]===(1==this.keywordIndex?1:"Space")?"space":"nothing",e.writeStartElement(void 0,"suff",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,i),e.writeEndElement()},e.prototype.serializeDocumentProtectionSettings=function(e){if(e.writeStartElement("w","documentProtection",this.wNamespace),this.formatting&&e.writeAttributeString("w","formatting",this.wNamespace,"1"),this.protectionType&&"NoProtection"!==this.protectionType){var t=void 0;switch(this.protectionType){case"ReadOnly":case 1:t="readOnly";break;case"FormFieldsOnly":case 2:t="forms";break;case"CommentsOnly":case 3:t="comments";break;case"RevisionsOnly":case 4:t="trackedChanges"}e.writeAttributeString("w","edit",this.wNamespace,t)}e.writeAttributeString("w","cryptProviderType",this.wNamespace,"rsaAES"),e.writeAttributeString("w","cryptAlgorithmClass",this.wNamespace,"hash"),e.writeAttributeString("w","cryptAlgorithmType",this.wNamespace,"typeAny"),e.writeAttributeString("w","cryptAlgorithmSid",this.wNamespace,"14"),e.writeAttributeString("w","cryptSpinCount",this.wNamespace,"100000"),this.enforcement&&e.writeAttributeString("w","enforcement",this.wNamespace,"1"),this.hashValue&&e.writeAttributeString("w","hash",this.wNamespace,this.hashValue),this.saltValue&&e.writeAttributeString("w","salt",this.wNamespace,this.saltValue),e.writeEndElement()},e.prototype.serializeSettings=function(){var e=new sf.fileutils.XmlWriter;e.writeStartElement("w","settings",this.wNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","sl",void 0,this.slNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDocumentProtectionSettings(e),e.writeStartElement("w","zoom",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"none"),e.writeAttributeString("w","percent",this.wNamespace,"100"),e.writeEndElement(),this.serializeThemeFontLang(e),e.writeStartElement(void 0,"displayBackgroundShape",this.wNamespace),e.writeEndElement(),e.writeStartElement(void 0,"defaultTabStop",this.wNamespace);var t=Math.round(this.defaultTabWidthValue*this.twipsInOnePoint);e.writeAttributeString(void 0,"val",this.wNamespace,t.toString()),e.writeEndElement(),this.trackChanges&&(e.writeStartElement(void 0,"trackRevisions",this.wNamespace),e.writeEndElement()),this.mDifferentFirstPage&&(e.writeStartElement(void 0,"evenAndOddHeaders",this.wNamespace),e.writeEndElement()),this.formFieldShading||(e.writeStartElement(void 0,"doNotShadeFormData",this.wNamespace),e.writeEndElement()),e.writeStartElement(void 0,"compat",this.wNamespace),this.dontUseHtmlParagraphAutoSpacing&&this.serializeBoolProperty(e,"doNotUseHTMLParagraphAutoSpacing",this.dontUseHtmlParagraphAutoSpacing),this.allowSpaceOfSameStyleInTable&&this.serializeBoolProperty(e,"allowSpaceOfSameStyleInTable",this.allowSpaceOfSameStyleInTable),e.writeStartElement(void 0,"compatSetting",this.wNamespace),e.writeAttributeString(void 0,"name",this.wNamespace,"compatibilityMode"),e.writeAttributeString(void 0,"uri",this.wNamespace,"http://schemas.microsoft.com/office/word");var i=1===this.keywordIndex?x.getCompatibilityModeValue(this.compatibilityMode):x.getCompatibilityModeValue(this.getCompatibilityModeEnumValue(this.compatibilityMode.toString()));e.writeAttributeString(void 0,"val",this.wNamespace,i),e.writeEndElement(),e.writeEndElement(),this.document[pe[this.keywordIndex]]&&(e.writeStartElement(void 0,"footnotePr",this.wNamespace),e.writeStartElement(void 0,"footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),e.writeEndElement(),e.writeStartElement(void 0,"footnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),e.writeEndElement(),e.writeEndElement()),this.document[ge[this.keywordIndex]]&&(e.writeStartElement(void 0,"endnotePr",this.wNamespace),e.writeStartElement(void 0,"endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"-1"),e.writeEndElement(),e.writeStartElement(void 0,"endnote",this.wNamespace),e.writeAttributeString(void 0,"id",this.wNamespace,"0"),e.writeEndElement(),e.writeEndElement()),e.writeEndElement();var r=new sf.compression.ZipArchiveItem(e.buffer,this.settingsPath);this.mArchive.addItem(r)},e.prototype.serializeThemeFontLang=function(e){var t=this.themeFontLang[Fe[this.keywordIndex]]>0,i=this.themeFontLang[xe[this.keywordIndex]]>0,r=this.themeFontLang[Ie[this.keywordIndex]]>0;if(i||r||t){if(e.writeStartElement("w","themeFontLang",void 0),i){var o=n[this.themeFontLang[xe[this.keywordIndex]]];e.writeAttributeString("w","val",void 0,o.replace("_","-"))}if(t){var s=n[this.themeFontLang[Fe[this.keywordIndex]]];e.writeAttributeString("w","bidi",void 0,s.replace("_","-"))}if(r){var a=n[this.themeFontLang[Ie[this.keywordIndex]]];e.writeAttributeString("w","eastAsia",void 0,a.replace("_","-"))}e.writeEndElement()}},e.prototype.serializeCoreProperties=function(){},e.prototype.serializeAppProperties=function(){},e.prototype.serializeFontTable=function(e){},e.prototype.serializeSettingsRelation=function(){},e.prototype.getCompatibilityModeEnumValue=function(e){switch(e){case"Word2013":return 0;case"Word2003":return 1;case"Word2007":return 2;case"Word2010":return 3}},e.prototype.serializeHeaderFooters=function(){this.isHeaderFooter=!0,this.serializeHeaderFooter("EvenFooter"),this.serializeHeaderFooter("EvenHeader"),this.serializeHeaderFooter("FirstPageFooter"),this.serializeHeaderFooter("FirstPageHeader"),this.serializeHeaderFooter("OddFooter"),this.serializeHeaderFooter("OddHeader"),this.isHeaderFooter=!1},e.prototype.serializeHeaderFooter=function(e){var t,i;if(0!==this.headersFooters.length&&this.headersFooters.containsKey(e))for(var r=this.headersFooters.get(e),n=void 0,o=0;o<r.keys.length;o++){var s=r.keys[o];n=r.get(s),"EvenHeader"===e||"FirstPageHeader"===e||"OddHeader"===e?(t=this.headerPath+s.replace("rId","")+".xml",i=this.headerRelationPath+s.replace("rId","")+".xml.rels",this.serializeHeader(n,s,t,i)):(t=this.footerPath+s.replace("rId","")+".xml",i=this.footerRelationPath+s.replace("rId","")+".xml.rels",this.serializeFooter(n,s,t,i))}},e.prototype.serializeHeader=function(e,t,i,r){this.headerFooter=e;var n=new sf.fileutils.XmlWriter;n.writeStartElement("w","hdr",this.wNamespace),this.writeHFCommonAttributes(n);var o=this.blockOwner;this.blockOwner=e,this.serializeBodyItems(n,e[xo[this.keywordIndex]],!0),this.blockOwner=o,n.writeEndElement();var s=new sf.compression.ZipArchiveItem(n.buffer,i);this.mArchive.addItem(s),this.serializeHFRelations(t,r),this.headerFooter=void 0},e.prototype.serializeHFRelations=function(e,t){if(this.headerFooterImages.containsKey(e)){var i=new sf.fileutils.XmlWriter;i.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeImagesRelations(this.headerFooterImages.get(e),i,!1),this.headerFooterSvgImages.containsKey(e)&&this.serializeSvgImageRelation(this.headerFooterSvgImages.get(e),i),i.writeEndElement();var r=new sf.compression.ZipArchiveItem(i.buffer,t);this.mArchive.addItem(r)}},e.prototype.writeHFCommonAttributes=function(e){e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","ve",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString("xmlns","pic",void 0,this.pictureNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("ve","Ignorable",void 0,"w14 w15 wp14")},e.prototype.serializeFooter=function(e,t,i,r){this.headerFooter=e;var n=new sf.fileutils.XmlWriter;n.writeStartElement("w","ftr",this.wNamespace),this.writeHFCommonAttributes(n),this.serializeBodyItems(n,e[xo[this.keywordIndex]],!0),n.writeEndElement();var o=new sf.compression.ZipArchiveItem(n.buffer,i);this.mArchive.addItem(o),this.serializeHFRelations(t,r)},e.prototype.serializeDocumentRelations=function(){var e=new sf.fileutils.XmlWriter;e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.settingsRelType,"settings.xml"),this.document[ge[this.keywordIndex]]&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.endnoteRelType,"endnotes.xml"),this.document[pe[this.keywordIndex]]&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.footnoteRelType,"footnotes.xml"),this.mComments.length>0&&(1===this.mComments.length&&""===this.mComments[0].text||(this.serializeRelationShip(e,this.getNextRelationShipID(),this.commentsRelType,"comments.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.commentsExRelType,"commentsExtended.xml"))),sf.base.isNullOrUndefined(this.mThemes)||this.serializeRelationShip(e,this.getNextRelationShipID(),this.ThemeRelType,"theme/theme1.xml"),this.document[j[this.keywordIndex]].length>0&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.numberingRelType,"numbering.xml"),this.serializeHeaderFooterRelations(e),this.serializeImagesRelations(this.documentImages,e,!1),this.serializeSvgImageRelation(this.svgImages,e),this.serializeCustomXMLMapping(this.mCustomXML,e),this.serializeChartDocumentRelations(this.documentCharts,e),this.serializeExternalLinkImages(e),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.wordRelationPath);this.mArchive.addItem(t),this.headerFooter=void 0},e.prototype.serializeChartDocumentRelations=function(e,t){if(e.length>0)for(var i=e.keys,r=1;r<=i.length;r++)this.serializeRelationShip(t,i[r-1],this.chartRelType,"charts/chart"+r+".xml")},e.prototype.serializeChartRelations=function(){var e=new sf.fileutils.XmlWriter;this.resetChartRelationShipId(),e.writeStartElement(void 0,"Relationships",this.rpNamespace);var t="colors"+this.chartCount+".xml",i=this.chartPath+"/_rels/chart"+this.chartCount+".xml.rels",r="../embeddings/Microsoft_Excel_Worksheet"+this.chartCount+".xlsx";this.serializeRelationShip(e,this.getNextChartRelationShipID(),this.packageRelType,r),this.serializeRelationShip(e,this.getNextChartRelationShipID(),this.chartColorStyleRelType,t),e.writeEndElement();var n=new sf.compression.ZipArchiveItem(e.buffer,i);this.mArchive.addItem(n)},e.prototype.serializeImagesRelations=function(e,t,i){if(e.length>0)for(var r="",n=void 0,o=e.keys,s=0;s<o.length;s++){var a=e.get(o[s]),l=void 0;if("string"==typeof a&&this.startsWith(a,"data"))n=a;else if(n=(l=this.getBase64ImageString(a)).imageString,x.parseBoolValue(a[Vr[this.keywordIndex]]))(".svg"!==x.formatClippedString(l.metaFileImageString).extension||i)&&(n=l.metaFileImageString);if(sf.base.isNullOrUndefined(n))r=this.imagePath+"/0.jpeg",this.serializeRelationShip(t,o[s],this.imageRelType,r.replace("word/",""));else{var d=x.formatClippedString(n),h=d.extension,c=d.formatClippedString;r=this.imagePath+o[s]+h,this.serializeRelationShip(t,o[s],this.imageRelType,r.replace("word/",""));var p=void 0;p=this.startsWith(n,"data:image/svg+xml;utf8,")?new Blob([c]):new Blob([this.encodedString(c)]);var g=new sf.compression.ZipArchiveItem(p,r);this.mArchive.addItem(g)}}},e.prototype.serializeSvgImageRelation=function(e,t){this.serializeImagesRelations(e,t,!0)},e.prototype.encodedString=function(e){var t,i,r,n,o,s,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,d=0,h=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&h--,e.charAt(e.length-2)===a.charAt(64)&&h--,h%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var c=new Uint8Array(0|h);l<e.length;)t=a.indexOf(e.charAt(l++))<<2|(n=a.indexOf(e.charAt(l++)))>>4,i=(15&n)<<4|(o=a.indexOf(e.charAt(l++)))>>2,r=(3&o)<<6|(s=a.indexOf(e.charAt(l++))),c[d++]=t,64!==o&&(c[d++]=i),64!==s&&(c[d++]=r);return c},e.prototype.serializeExternalLinkImages=function(e){for(var t=this.externalImages.keys,i=0;i<this.externalImages.keys.length;i++)this.serializeRelationShip(e,t[i],this.imageRelType,this.externalImages.get(t[i]))},e.prototype.serializeHeaderFooterRelations=function(e){this.serializeHFRelation(e,"EvenFooter"),this.serializeHFRelation(e,"EvenHeader"),this.serializeHFRelation(e,"FirstPageFooter"),this.serializeHFRelation(e,"FirstPageHeader"),this.serializeHFRelation(e,"OddFooter"),this.serializeHFRelation(e,"OddHeader")},e.prototype.serializeHFRelation=function(e,t){var i,r="";if(this.headersFooters.containsKey(t))for(var n=this.headersFooters.get(t),o=0;o<n.keys.length;o++){var s=n.keys[o];"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(r="header"+s.replace("rId","")+".xml",i=this.headerRelType):(r="footer"+s.replace("rId","")+".xml",i=this.footerRelType),this.serializeRelationShip(e,s,i,r)}},e.prototype.serializeRelationShip=function(e,t,i,r){e.writeStartElement(void 0,"Relationship",void 0),e.writeAttributeString(void 0,"Id",void 0,t),e.writeAttributeString(void 0,"Type",void 0,i),e.writeAttributeString(void 0,"Target",void 0,r.replace("\\","/").replace("\v","")),(i===this.hyperlinkRelType||this.startsWith(r,"http://")||this.startsWith(r,"https://")||this.startsWith(r,"file:///"))&&e.writeAttributeString(void 0,"TargetMode",void 0,"External"),e.writeEndElement()},e.prototype.getNextRelationShipID=function(){return"rId"+ ++this.mRelationShipID},e.prototype.getEFNextRelationShipID=function(){return(++this.efRelationShipId).toString()},e.prototype.serializeGeneralRelations=function(){var e=new sf.fileutils.XmlWriter;this.resetRelationShipID(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.documentRelType,this.documentPath),e.writeEndElement();var t=new sf.compression.ZipArchiveItem(e.buffer,this.generalRelationPath);this.mArchive.addItem(t)},e.prototype.serializeContentTypes=function(e,t){var i=new sf.fileutils.XmlWriter;if(i.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(i,"rels",this.relationContentType),this.serializeDefaultContentType(i,"xml",this.xmlContentType),(this.documentImages.length>0||this.externalImages.length>0||this.headerFooterImages.length>0)&&(this.serializeDefaultContentType(i,"png","image/png"),this.serializeDefaultContentType(i,"bmp","image/bmp"),this.serializeDefaultContentType(i,"emf","image/x-emf"),this.serializeDefaultContentType(i,"wmf","image/x-wmf"),this.serializeDefaultContentType(i,"gif","image/gif"),this.serializeDefaultContentType(i,"ico","image/x-icon"),this.serializeDefaultContentType(i,"tif","image/tiff"),this.serializeDefaultContentType(i,"tiff","image/tiff"),this.serializeDefaultContentType(i,"jpeg","image/jpeg"),this.serializeDefaultContentType(i,"jpg","image/jpeg"),this.serializeDefaultContentType(i,"svg","image/svg+xml")),"Docx"==t?this.serializeOverrideContentType(i,this.documentPath,this.documentContentType):"Dotx"==t&&this.serializeOverrideContentType(i,this.documentPath,this.TemplateContentType),this.serializeOverrideContentType(i,this.numberingPath,this.numberingContentType),this.serializeOverrideContentType(i,this.stylePath,this.stylesContentType),this.serializeOverrideContentType(i,this.settingsPath,this.settingsContentType),this.serializeOverrideContentType(i,this.commentsPath,this.commentsContentType),this.serializeOverrideContentType(i,this.themePath,this.themeContentType),this.serializeOverrideContentType(i,this.commentsExtendedPath,this.commentsExContentType),this.chartCount>0){var r=1;for(this.serializeDefaultContentType(i,"xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet");r<=this.chartCount;)this.serializeOverrideContentType(i,"word/charts/chart"+r+".xml",this.chartsContentType),this.serializeOverrideContentType(i,"word/charts/colors"+r+".xml",this.chartColorStyleContentType),r++}if(this.customXMLProps.length>0)for(var n=0;n<this.customXMLProps.length;n++)this.serializeOverrideContentType(i,this.customXMLProps[n],this.customXmlContentType);this.serializeHFContentTypes(i),this.SerializeEFContentTypes(i),i.writeEndElement();var o=new sf.compression.ZipArchiveItem(i.buffer,this.contentTypesPath);this.mArchive.addItem(o)},e.prototype.serializeHFContentTypes=function(e){this.serializeHeaderFootersContentType(e,"EvenFooter"),this.serializeHeaderFootersContentType(e,"EvenHeader"),this.serializeHeaderFootersContentType(e,"FirstPageFooter"),this.serializeHeaderFootersContentType(e,"FirstPageHeader"),this.serializeHeaderFootersContentType(e,"OddFooter"),this.serializeHeaderFootersContentType(e,"OddHeader")},e.prototype.serializeHeaderFootersContentType=function(e,t){var i,r;if(this.headersFooters.containsKey(t))for(var n=this.headersFooters.get(t),o=0;o<n.keys.length;o++){var s=n.keys[o];"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(r=this.headerPath+s.replace("rId","")+".xml",i=this.headerContentType):(r=this.footerPath+s.replace("rId","")+".xml",i=this.footerContentType),this.serializeOverrideContentType(e,r,i)}},e.prototype.SerializeEFContentTypes=function(e){this.serializeEFContentType(e)},e.prototype.serializeEFContentType=function(e){var t,i;i=this.endnotesPath,t=this.endnoteContentType,this.serializeOverrideContentType(e,i,t),i=this.footnotesPath,t=this.footnoteContentType,this.serializeOverrideContentType(e,i,t)},e.prototype.serializeOverrideContentType=function(e,t,i){e.writeStartElement(void 0,"Override",void 0),e.writeAttributeString(void 0,"PartName",void 0,"/"+t.replace("\\","/")),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},e.prototype.serializeDefaultContentType=function(e,t,i){e.writeStartElement(void 0,"Default",void 0),e.writeAttributeString(void 0,"Extension",void 0,t),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},e.prototype.resetRelationShipID=function(){this.mRelationShipID=0},e.prototype.resetExcelRelationShipId=function(){this.eRelationShipId=0},e.prototype.resetChartRelationShipId=function(){this.cRelationShipId=0},e.prototype.close=function(){},e}(),ud=function(){function e(){this.pageContent="",this.curSectionIndex=0,this.inField=!1}return e.prototype.getModuleName=function(){return"TextExport"},e.prototype.save=function(e,t){this.serialize(e);var i=new sf.fileutils.StreamWriter;this.writeInternal(i),i.save(t+".txt")},e.prototype.saveAsBlob=function(e){this.serialize(e);var t=new sf.fileutils.StreamWriter;this.writeInternal(t);var i=t.buffer;return t.destroy(),new Promise((function(e,t){e(i)}))},e.prototype.serialize=function(e){var t=e.owner.sfdtExportModule.write(0);this.setDocument(t)},e.prototype.setDocument=function(e){this.document=e,this.mSections=e.sections},e.prototype.writeInternal=function(e){var t=void 0,i=this.document.sections.length-1,r=!1;this.updateLastParagraph();for(var n=0;n<=i;n++)t=this.document.sections[n],r=n===i,this.writeBody(e,t.blocks,!1),this.writeNewLine(e),this.writeSectionEnd(t,r);for(var o=0;o<=i;o++)t=this.document.sections[o],this.writeHeadersFooters(e,t)},e.prototype.writeBody=function(e,t,i){for(var r=t.length-1,n=void 0,o=0;o<=r;o++)if((n=t[o]).hasOwnProperty("inlines")){var s=n===this.lastPara;this.writeParagraph(e,n,s,i)}else n.blocks?this.writeBody(e,n.blocks,i):this.writeTable(e,n)},e.prototype.writeParagraph=function(e,t,i,r){for(var n=0;n<t.inlines.length;n++){var o=t.inlines[n];o.hasOwnProperty("fieldType")?this.inField=0===o.fieldType:o.hasOwnProperty("text")&&!this.inField&&this.writeText(e,o.text)}(!r||t.inlines.length>0)&&(i||this.writeNewLine(e))},e.prototype.writeTable=function(e,t){for(var i=0;i<t.rows.length;i++)for(var r=t.rows[i],n=0;n<r.cells.length;n++){var o=r.cells[n];this.writeBody(e,o.blocks,!1)}},e.prototype.writeHeadersFooters=function(e,t){var i=t.headersFooters;sf.base.isNullOrUndefined(i)||(this.writeHeaderFooter(e,t.headersFooters.header),this.writeHeaderFooter(e,t.headersFooters.footer),this.writeHeaderFooter(e,t.headersFooters.evenFooter),this.writeHeaderFooter(e,t.headersFooters.evenHeader),this.writeHeaderFooter(e,t.headersFooters.firstPageHeader),this.writeHeaderFooter(e,t.headersFooters.firstPageFooter))},e.prototype.writeHeaderFooter=function(e,t){t&&t.blocks&&this.writeBody(e,t.blocks,!0)},e.prototype.writeSectionEnd=function(e,t){this.curSectionIndex++},e.prototype.writeNewLine=function(e){sf.base.isNullOrUndefined(e)?this.pageContent=this.pageContent+" ":e.writeLine("")},e.prototype.writeText=function(e,t){sf.base.isNullOrUndefined(e)?this.pageContent+=t:e.write(t)},e.prototype.updateLastParagraph=function(){var e,t=this.document.sections.length;if(t>0&&(e=this.document.sections[t-1]),!sf.base.isNullOrUndefined(e)){for(var i=[],r=0;r<e.blocks.length;r++)e.blocks[r].hasOwnProperty("inlines")&&i.push(e.blocks[r]);var n=i.length;n>0&&(this.lastPara=i[n-1])}},e.prototype.destroy=function(){this.document=void 0,this.lastPara=void 0,this.mSections=void 0,this.sections=void 0},e}(),md=function(){function e(e){this.startLine=void 0,this.endLine=void 0,this.endOffset=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.lists=void 0,this.images=void 0,this.document=void 0,this.writeInlineStyles=void 0,this.blockContent=!1,this.startContent=!1,this.multipleLineContent=!1,this.nestedContent=!1,this.editRangeId=-1,this.selectedCommentsId=[],this.selectedRevisionId=[],this.nestedBlockContent=!1,this.nestedBlockEnabled=!1,this.blocks=[],this.contentInline=[],this.isContentControl=!1,this.isBlockClosed=!0,this.isWriteInlinesFootNote=!1,this.isWriteEndFootNote=!1,this.keywordIndex=0,this.isExport=!0,this.isWordExport=!1,this.isPartialExport=!1,this.checkboxOrDropdown=!1,this.copyWithTrackChange=!1,this.documentHelper=e}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.documentHelper.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this.documentHelper.owner},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"SfdtExport"},e.prototype.clear=function(){this.writeInlineStyles=void 0,this.startLine=void 0,this.endLine=void 0,this.lists=void 0,this.images=void 0,this.document=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.selectedCommentsId=[],this.selectedRevisionId=[],this.startBlock=void 0,this.endBlock=void 0,this.isPartialExport=!1,this.keywordIndex=void 0},e.prototype.serialize=function(){return this.seralizeInternal(this.owner.documentEditorSettings.optimizeSfdt?1:0)},e.prototype.seralizeInternal=function(e){return JSON.stringify(this.write(e))},e.prototype.saveAsBlobNonOptimized=function(e){var t=new Blob([this.serialize()],{type:"text/plain"});return new Promise((function(e,i){e(t)}))},e.prototype.saveAsBlob=function(e){var t=this.serialize(),i=new Blob([t],{type:"application/json"}),r=new sf.compression.ZipArchiveItem(i,"sfdt"),n=new sf.compression.ZipArchive;return n.addItem(r),n.saveAsBlob()},e.prototype.updateEditRangeId=function(){for(var e=-1,t=0;t<this.documentHelper.editRanges.keys.length;t++)for(var i=this.documentHelper.editRanges.keys,r=0;r<i[t].length;r++)for(var n=this.documentHelper.editRanges.get(i[t]),o=0;o<n.length;o++)e++,n[o].editRangeId=e,n[o].editRangeEnd.editRangeId=e},e.prototype.write=function(e,t,i,r,n,o,s){var a;if(o&&(this.writeInlineStyles=!0),sf.base.isNullOrUndefined(e)?this.keywordIndex=this.owner.documentEditorSettings.optimizeSfdt?1:0:this.keywordIndex=e,this.Initialize(),this.updateEditRangeId(),t instanceof ma&&r instanceof ma){this.isExport=!1,sf.base.isNullOrUndefined(s)||(this.isExport=s);var l=t.paragraph,d=r.paragraph;this.isPartialExport&&(this.startBlock=this.getParentBlock(l),this.endBlock=this.getParentBlock(d));var h=l.associatedCell,c=d.associatedCell,p=(l.bodyWidget,this.createSection(t.paragraph.bodyWidget));this.document[D[this.keywordIndex]].push(p);var g=h,f=c;h instanceof ua&&(g=this.getParentCell(g)),c instanceof ua&&(f=this.getParentCell(f));var u=g instanceof ua&&f instanceof ua&&g.equals(f);if(u||sf.base.isNullOrUndefined(c))this.startLine=t,this.endLine=r,this.endOffset=n;else if(h instanceof ua){var m=h.getContainerTable(),y=c.getContainerTable();m.tableFormat===y.tableFormat&&(this.endCell=c,this.endCell.ownerTable!==h.ownerTable&&h.ownerTable.associatedCell&&h.ownerTable.associatedCell.ownerTable===this.endCell.ownerTable&&0===h.ownerTable.associatedCell.childWidgets.indexOf(h.ownerTable)&&(h=h.ownerTable.associatedCell),this.endColumnIndex=this.endCell.columnIndex+this.endCell.cellFormat.columnSpan,this.startColumnIndex=h.columnIndex)}else this.endCell=c;var v=void 0;if(u&&!this.isPartialExport||sf.base.isNullOrUndefined(h)){var w=this.createParagraph(t.paragraph);p[xo[this.keywordIndex]].push(w);var b=t.paragraph;for(v=this.writeParagraph(t.paragraph,w,p[xo[this.keywordIndex]],t.indexInOwner,i),this.isPartialExport&&(v=this.getNextBlock(v,b),p=this.document[D[this.keywordIndex]][this.document[D[this.keywordIndex]].length-1]);v;)b=v,v=this.writeBlock(v,0,p[xo[this.keywordIndex]]),this.isPartialExport&&sf.base.isNullOrUndefined(v)&&(v=this.getNextBlock(v,b),p=this.document[D[this.keywordIndex]][this.document[D[this.keywordIndex]].length-1])}else{if(sf.base.isNullOrUndefined(c)&&h.ownerTable.associatedCell){var x=(m=h.getContainerTable()).childWidgets[m.childWidgets.length-1],I=x.childWidgets[x.childWidgets.length-1];if(I.ownerTable!==h.ownerTable&&h.ownerTable.associatedCell&&0===h.ownerTable.associatedCell.childWidgets.indexOf(h.ownerTable))for(;h.ownerTable!==I.ownerTable;)h=h.ownerTable.associatedCell;this.endColumnIndex=I.columnIndex+I.cellFormat.columnSpan,this.startColumnIndex=h.columnIndex}var F=this.createTable(h.ownerTable);p[xo[this.keywordIndex]].push(F);b=h.ownerTable;for(v=this.writeTable(h.ownerTable,F,h.ownerRow.indexInOwner,p[xo[this.keywordIndex]]),this.isPartialExport&&(v=this.getNextBlock(v,b),p=this.document[D[this.keywordIndex]][this.document[D[this.keywordIndex]].length-1]);v;)b=v,v=this.writeBlock(v,0,p[xo[this.keywordIndex]]),this.isPartialExport&&(v=this.getNextBlock(v,b),p=this.document[D[this.keywordIndex]][this.document[D[this.keywordIndex]].length-1])}}else if(this.isExport=!0,this.documentHelper.pages.length>0){var C=this.documentHelper.pages[0];this.writePage(C)}this.document[K[this.keywordIndex]]=((a={})[Br[this.keywordIndex]]=this.documentHelper.backgroundColor,a),this.writeStyles(this.documentHelper),this.writeLists(this.documentHelper),this.writeComments(this.documentHelper),this.writeRevisions(this.documentHelper),this.writeCustomXml(this.documentHelper),this.writeImages(this.documentHelper),this.footnotes(this.documentHelper),this.endnotes(this.documentHelper);var W=this.document;return this.clear(),W},e.prototype.getNextBlock=function(e,t){if(sf.base.isNullOrUndefined(e)&&this.isPartialExport&&this.endBlock&&!this.endBlock.equals(t))if((e=t.getSplitWidgets().pop().nextRenderedWidget)&&t.bodyWidget.index!==e.bodyWidget.index){var i=this.createSection(e.bodyWidget);this.document[D[this.keywordIndex]].push(i)}else e=void 0;return e},e.prototype.Initialize=function(){this.lists=[],this.images=[],this.document={},this.document.optimizeSfdt=this.owner.documentEditorSettings.optimizeSfdt,this.document[D[this.keywordIndex]]=[],this.document[q[this.keywordIndex]]=this.writeCharacterFormat(this.documentHelper.characterFormat),this.document[_[this.keywordIndex]]=this.writeParagraphFormat(this.documentHelper.paragraphFormat),sf.base.isNullOrUndefined(this.documentHelper.fontSubstitutionTable)||(this.document[V[this.keywordIndex]]=this.writeFontSubsitutionTable(this.documentHelper)),this.document[ue[this.keywordIndex]]=this.writeCharacterFormat(this.documentHelper.themeFontLanguage),this.document[$[this.keywordIndex]]=this.documentHelper.defaultTabWidth,this.document[te[this.keywordIndex]]=x.getBoolInfo(this.owner.enableTrackChanges,this.keywordIndex),this.document[re[this.keywordIndex]]=x.getBoolInfo(this.documentHelper.isDocumentProtected,this.keywordIndex),this.document[ne[this.keywordIndex]]=this.documentHelper.hashValue,this.document[oe[this.keywordIndex]]=this.documentHelper.saltValue,this.document[ee[this.keywordIndex]]=x.getBoolInfo(this.documentHelper.restrictFormatting,this.keywordIndex),this.document[ie[this.keywordIndex]]=1==this.keywordIndex?this.getProtectionTypeEnumValue(this.documentHelper.protectionType):this.documentHelper.protectionType,this.document[ae[this.keywordIndex]]=x.getBoolInfo(this.documentHelper.dontUseHtmlParagraphAutoSpacing,this.keywordIndex),this.document[he[this.keywordIndex]]=x.getBoolInfo(this.documentHelper.owner.documentEditorSettings.formFieldSettings.applyShading,this.keywordIndex),this.document[fe[this.keywordIndex]]=1==this.keywordIndex?this.getCompatibilityModeEnumValue(this.documentHelper.compatibilityMode):this.documentHelper.compatibilityMode,this.document[Fs[this.keywordIndex]]=x.getBoolInfo(this.documentHelper.allowSpaceOfSameStyleInTable,this.keywordIndex),this.documentHelper.hasThemes&&(this.document[me[this.keywordIndex]]=this.writeThemes(this.documentHelper.themes))},e.prototype.writeFontSubsitutionTable=function(e){for(var t={},i=0;i<e.fontSubstitutionTable.length;i++){var r=e.fontSubstitutionTable.keys[i];t[r]=this.documentHelper.fontSubstitutionTable.get(r)}return t},e.prototype.writePage=function(e){if(e.bodyWidgets.length>0){var t=e.bodyWidgets[0];do{t=this.writeBodyWidget(t,0)}while(!sf.base.isNullOrUndefined(t))}return this.document},e.prototype.writeBodyWidget=function(e,t){if(e instanceof aa){var i=this.createSection(e);this.document[D[this.keywordIndex]].push(i),this.writeHeaderFooters(this.documentHelper.headersFooters[e.index],i);var r=e.childWidgets[t];sf.base.isNullOrUndefined(r)&&e.nextRenderedWidget&&(r=e.nextRenderedWidget.childWidgets[t]);do{r=this.writeBlock(r,0,i[xo[this.keywordIndex]])}while(r);var n,o=e;do{e=o,o=o.nextRenderedWidget,!sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(e.page.nextPage)||sf.base.isNullOrUndefined(e.page.nextPage)||(o=e.page.nextPage.bodyWidgets[0])}while(o instanceof aa&&o.index===e.index);if(!sf.base.isNullOrUndefined(e.lastChild)&&e.lastChild instanceof ca&&(n=e.lastChild.isEmpty(),e.lastChild.isSectionBreak&&!sf.base.isNullOrUndefined(e.lastChild.previousRenderedWidget)&&e.lastChild.previousRenderedWidget instanceof ga&&(n=!1)),!sf.base.isNullOrUndefined(o)&&o instanceof aa&&e.sectionIndex!==o.sectionIndex&&n&&!this.isWordExport){var s={};s[Pn[this.keywordIndex]]=[],i[xo[this.keywordIndex]].push(s)}return o}},e.prototype.writeHeaderFooters=function(e,t){if(!sf.base.isNullOrUndefined(e)){var i=t[Po[this.keywordIndex]];sf.base.isNullOrUndefined(e[0])||e[0].isEmpty||(i[Io[this.keywordIndex]]=this.writeHeaderFooter(e[0]),"{}"==JSON.stringify(i[Io[this.keywordIndex]])&&delete i[Io[this.keywordIndex]]),sf.base.isNullOrUndefined(e[1])||e[1].isEmpty||(i[Fo[this.keywordIndex]]=this.writeHeaderFooter(e[1]),"{}"==JSON.stringify(i[Fo[this.keywordIndex]])&&delete i[Fo[this.keywordIndex]]),sf.base.isNullOrUndefined(e[2])||e[2].isEmpty||(i[Co[this.keywordIndex]]=this.writeHeaderFooter(e[2]),"{}"==JSON.stringify(i[Co[this.keywordIndex]])&&delete i[Co[this.keywordIndex]]),sf.base.isNullOrUndefined(e[3])||e[3].isEmpty||(i[Wo[this.keywordIndex]]=this.writeHeaderFooter(e[3]),"{}"==JSON.stringify(i[Wo[this.keywordIndex]])&&delete i[Wo[this.keywordIndex]]),sf.base.isNullOrUndefined(e[4])||e[4].isEmpty||(i[ko[this.keywordIndex]]=this.writeHeaderFooter(e[4]),"{}"==JSON.stringify(i[ko[this.keywordIndex]])&&delete i[ko[this.keywordIndex]]),sf.base.isNullOrUndefined(e[5])||e[5].isEmpty||(i[So[this.keywordIndex]]=this.writeHeaderFooter(e[5]),"{}"==JSON.stringify(i[So[this.keywordIndex]])&&delete i[So[this.keywordIndex]])}},e.prototype.writeHeaderFooter=function(e){if(!sf.base.isNullOrUndefined(e)&&!e.isEmpty){var t={};if(e&&e.childWidgets&&e.childWidgets.length>0){t[xo[this.keywordIndex]]=[];var i=e.firstChild;do{i=this.writeBlock(i,0,t[xo[this.keywordIndex]])}while(i)}return t}},e.prototype.createSection=function(e){var t={};if(t[No[this.keywordIndex]]={},t[No[this.keywordIndex]][yt[this.keywordIndex]]=e.sectionFormat.pageWidth,t[No[this.keywordIndex]][vt[this.keywordIndex]]=e.sectionFormat.pageHeight,t[No[this.keywordIndex]][wt[this.keywordIndex]]=e.sectionFormat.leftMargin,t[No[this.keywordIndex]][bt[this.keywordIndex]]=e.sectionFormat.rightMargin,t[No[this.keywordIndex]][xt[this.keywordIndex]]=e.sectionFormat.topMargin,t[No[this.keywordIndex]][It[this.keywordIndex]]=e.sectionFormat.bottomMargin,t[No[this.keywordIndex]][ut[this.keywordIndex]]=x.getBoolInfo(e.sectionFormat.differentFirstPage,this.keywordIndex),t[No[this.keywordIndex]][mt[this.keywordIndex]]=x.getBoolInfo(e.sectionFormat.differentOddAndEvenPages,this.keywordIndex),t[No[this.keywordIndex]][gt[this.keywordIndex]]=e.sectionFormat.headerDistance,t[No[this.keywordIndex]][ft[this.keywordIndex]]=e.sectionFormat.footerDistance,t[No[this.keywordIndex]][Re[this.keywordIndex]]=x.getBoolInfo(e.sectionFormat.bidi,this.keywordIndex),sf.base.isNullOrUndefined(e.sectionFormat.breakCode)||(t[No[this.keywordIndex]][Bt[this.keywordIndex]]=e.sectionFormat.breakCode),e.sectionFormat.restartPageNumbering&&(t[No[this.keywordIndex]][Ft[this.keywordIndex]]=x.getBoolInfo(e.sectionFormat.restartPageNumbering,this.keywordIndex),t[No[this.keywordIndex]][Ct[this.keywordIndex]]=e.sectionFormat.pageStartingNumber),sf.base.isNullOrUndefined(e.page.endnoteWidget||e.page.footnoteWidget)||(t[No[this.keywordIndex]][Wt[this.keywordIndex]]=1==this.keywordIndex?this.getFootEndNoteNumberFormatEnumValue(e.sectionFormat.endnoteNumberFormat):e.sectionFormat.endnoteNumberFormat,t[No[this.keywordIndex]][kt[this.keywordIndex]]=1==this.keywordIndex?this.getFootEndNoteNumberFormatEnumValue(e.sectionFormat.footNoteNumberFormat):e.sectionFormat.footNoteNumberFormat,t[No[this.keywordIndex]][St[this.keywordIndex]]=1==this.keywordIndex?this.getFootnoteRestartIndexEnumValue(e.sectionFormat.restartIndexForFootnotes):e.sectionFormat.restartIndexForFootnotes,t[No[this.keywordIndex]][Pt[this.keywordIndex]]=1==this.keywordIndex?this.getFootnoteRestartIndexEnumValue(e.sectionFormat.restartIndexForEndnotes):e.sectionFormat.restartIndexForEndnotes,t[No[this.keywordIndex]][Nt[this.keywordIndex]]=e.sectionFormat.initialFootNoteNumber,t[No[this.keywordIndex]][Ot[this.keywordIndex]]=e.sectionFormat.initialEndNoteNumber),sf.base.isNullOrUndefined(e.sectionFormat.pageNumberStyle)||(t[No[this.keywordIndex]][Tt[this.keywordIndex]]=e.sectionFormat.pageNumberStyle),!sf.base.isNullOrUndefined(e.sectionFormat.columns)&&!sf.base.isNullOrUndefined(e.sectionFormat.numberOfColumns&&e.sectionFormat.numberOfColumns>1)){var i=e.sectionFormat.columns;t[No[this.keywordIndex]][Et[this.keywordIndex]]=e.sectionFormat.numberOfColumns,t[No[this.keywordIndex]][Rt[this.keywordIndex]]=x.getBoolInfo(e.sectionFormat.equalWidth,this.keywordIndex),t[No[this.keywordIndex]][Ut[this.keywordIndex]]=x.getBoolInfo(e.sectionFormat.lineBetweenColumns,this.keywordIndex),t[No[this.keywordIndex]][Ht[this.keywordIndex]]=[];for(var r=0;r<i.length;r++){var n={};n[wr[this.keywordIndex]]=x.convertPixelToPoint(i[r].width),n[ts[this.keywordIndex]]=x.convertPixelToPoint(i[r].space),t[No[this.keywordIndex]][Ht[this.keywordIndex]].push(n)}}return t[xo[this.keywordIndex]]=[],t[Po[this.keywordIndex]]={},t},e.prototype.writeBlock=function(e,t,i){if(e instanceof da){if(e instanceof ca){if(e.hasOwnProperty("contentControlProperties")&&"BuildingBlockGallery"!==e.contentControlProperties.type){var r=this.blockContentControl(e);return this.blockContent=!1,sf.base.isNullOrUndefined(r)||!this.isBlockClosed&&this.nestedBlockContent||(this.nestedBlockEnabled=!1,i.push(r),this.blocks=[]),this.nextBlock}var n=this.createParagraph(e);return i.push(n),this.writeParagraph(e,n,i)}var o=e;if(o.hasOwnProperty("contentControlProperties")&&"BuildingBlockGallery"!==o.contentControlProperties.type){r=this.tableContentControl(o);return!sf.base.isNullOrUndefined(r)&&this.isBlockClosed&&i.push(r),this.nextBlock}var s=this.createTable(o);return i.push(s),this.writeTable(o,s,0,i)}},e.prototype.writeParagraphs=function(e){var t=this.blocks,i=e.childWidgets[0],r=i.children[0],n=i.children[1];if((r instanceof Va||n instanceof Va)&&(r=i.children[2],n=i.children[3]),!sf.base.isNullOrUndefined(e.contentControlProperties)&&e.containerWidget instanceof ua&&!sf.base.isNullOrUndefined(e.containerWidget.containerWidget)&&!sf.base.isNullOrUndefined(e.containerWidget.containerWidget.containerWidget.contentControlProperties)&&(t=[]),this.nestedBlockEnabled&&(t=[]),r instanceof Oa&&n instanceof Oa&&!this.nestedBlockContent||this.blockContent&&r instanceof Oa&&!this.nestedBlockContent){var o=!1;if(n instanceof Oa&&"Block"===n.contentControlWidgetType&&(o=!0),o||this.blockContent&&r instanceof Oa&&!this.nestedBlockContent&&0===r.type&&n instanceof Oa&&"Block"===r.contentControlWidgetType){this.nestedBlockContent=!0,this.nestedBlockEnabled=!0;var s=this.blockContentControl(e);sf.base.isNullOrUndefined(s)||this.blocks.push(s)}else{var a=this.createParagraph(e);t.push(a),this.nextBlock=this.writeParagraph(e,a,t)}}else{a=this.createParagraph(e);t.push(a),this.nextBlock=this.writeParagraph(e,a,t)}return!this.nestedBlockContent&&this.nestedBlockEnabled&&(this.nestedBlockEnabled=!1),t},e.prototype.contentControlProperty=function(e){var t={},i=[];if(t[On[this.keywordIndex]]=x.getBoolInfo(e.lockContentControl,this.keywordIndex),t[Tn[this.keywordIndex]]=x.getBoolInfo(e.lockContents,this.keywordIndex),t[Hn[this.keywordIndex]]=e.tag,t[Br[this.keywordIndex]]=e.color,t[En[this.keywordIndex]]=e.title,sf.base.isNullOrUndefined(e.appearance)||(t[xs[this.keywordIndex]]=1==this.keywordIndex?this.getContentControlAppearanceEnumValue(e.appearance):e.appearance),t[hs[this.keywordIndex]]=1==this.keywordIndex?this.getContentControlTypeEnumValue(e.type):e.type,t[Rn[this.keywordIndex]]=x.getBoolInfo(e.hasPlaceHolderText,this.keywordIndex),t[Un[this.keywordIndex]]=x.getBoolInfo(e.multiline,this.keywordIndex),t[Bn[this.keywordIndex]]=x.getBoolInfo(e.isTemporary,this.keywordIndex),sf.base.isNullOrUndefined(e.isChecked)||(t[Dn[this.keywordIndex]]=x.getBoolInfo(e.isChecked,this.keywordIndex)),sf.base.isNullOrUndefined(e.uncheckedState)||(t[Vn[this.keywordIndex]]=this.tounCheckedState(e.uncheckedState)),sf.base.isNullOrUndefined(e.checkedState)||(t[qn[this.keywordIndex]]=this.toCheckedState(e.checkedState)),sf.base.isNullOrUndefined(e.dateCalendarType)||(t[Ln[this.keywordIndex]]=1==this.keywordIndex?this.getDateCalendarTypeEnumValue(e.dateCalendarType):e.dateCalendarType),sf.base.isNullOrUndefined(e.dateStorageFormat)||(t[An[this.keywordIndex]]=1==this.keywordIndex?this.getDateStorageFormatEnumValue(e.dateStorageFormat):e.dateStorageFormat),sf.base.isNullOrUndefined(e.dateDisplayLocale)||(t[Mn[this.keywordIndex]]=e.dateDisplayLocale),sf.base.isNullOrUndefined(e.dateDisplayFormat)||(t[zn[this.keywordIndex]]=e.dateDisplayFormat),!sf.base.isNullOrUndefined(e.xmlMapping)){var r={},n={};r[Jn[this.keywordIndex]]=x.getBoolInfo(e.xmlMapping.isMapped,this.keywordIndex),r[Yn[this.keywordIndex]]=x.getBoolInfo(e.xmlMapping.isWordMl,this.keywordIndex),sf.base.isNullOrUndefined(e.xmlMapping.prefixMapping)||(r[Zn[this.keywordIndex]]=e.xmlMapping.prefixMapping),r[Qn[this.keywordIndex]]=e.xmlMapping.xPath,r[$n[this.keywordIndex]]=e.xmlMapping.storeItemId,sf.base.isNullOrUndefined(e.xmlMapping.customXmlPart)||(n[to[this.keywordIndex]]=e.xmlMapping.customXmlPart.id,n[Fn[this.keywordIndex]]=e.xmlMapping.customXmlPart.xml,r[eo[this.keywordIndex]]=n),t[jn[this.keywordIndex]]=r}if(sf.base.isNullOrUndefined(e.characterFormat)||(t[q[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat)),!sf.base.isNullOrUndefined(e.contentControlListItems))for(var o=0;o<e.contentControlListItems.length;o++){var s={};s[Xn[this.keywordIndex]]=e.contentControlListItems[o].displayText,s[Kn[this.keywordIndex]]=e.contentControlListItems[o].value,i.push(s)}return t[_n[this.keywordIndex]]=i,t},e.prototype.tounCheckedState=function(e){var t={};return t[Gn[this.keywordIndex]]=e.font,t[Kn[this.keywordIndex]]=e.value,t},e.prototype.toCheckedState=function(e){var t={};return t[Gn[this.keywordIndex]]=e.font,t[Kn[this.keywordIndex]]=e.value,t},e.prototype.blockContentControl=function(e){var t={};if(0!==e.childWidgets.length){if(t[xo[this.keywordIndex]]=this.writeParagraphs(e),sf.base.isNullOrUndefined(this.nextBlock))this.isBlockClosed=!0;else{if(e.contentControlProperties===this.nextBlock.contentControlProperties)return this.isBlockClosed=!1,this.nestedBlockContent=!0,this.blocks=t[xo[this.keywordIndex]];this.isBlockClosed=!0}if(!sf.base.isNullOrUndefined(t[xo[this.keywordIndex]])){var i=e.childWidgets[0],r=i.children[0],n=i.children[1];if((r instanceof Va||n instanceof Va)&&(r=i.children[2],n=i.children[3]),r instanceof Oa&&n instanceof Oa&&!this.nestedBlockContent||this.blockContent&&r instanceof Oa&&!this.nestedBlockContent){if(!(n instanceof Oa))return t[Nn[this.keywordIndex]]=this.contentControlProperty(r.contentControlProperties),t;"Block"===n.contentControlWidgetType?t[Nn[this.keywordIndex]]=this.contentControlProperty(n.contentControlProperties):t[Nn[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties)}else t[Nn[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties);return t}}else this.nextBlock=e.nextWidget},e.prototype.tableContentControl=function(e){var t={};if(t[xo[this.keywordIndex]]=this.tableContentControls(e),!sf.base.isNullOrUndefined(this.nextBlock)){if(e.contentControlProperties===this.nextBlock.contentControlProperties)return this.isBlockClosed=!1,this.blocks=t[xo[this.keywordIndex]];this.isBlockClosed=!0}return t[Nn[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties),t},e.prototype.tableContentControls=function(e){var t=[];this.isBlockClosed||(t=this.blocks);var i=this.createTable(e);return t.push(i),this.nextBlock=this.writeTable(e,i,0,t),t},e.prototype.writeParagraph=function(e,t,i,r,n){sf.base.isNullOrUndefined(r)&&(r=0),sf.base.isNullOrUndefined(n)&&(n=0);for(var o=e;o instanceof ca;){var s=this.owner.selection,a=void 0,l=void 0,d=void 0;if(sf.base.isNullOrUndefined(s)||(l=s.getElementInfo(s.end.currentWidget,s.end.offset),d=s.getParagraphLength(e,s.isForward?s.end.currentWidget:s.start.currentWidget,l)),!sf.base.isNullOrUndefined(this.owner.editor)&&this.owner.editor.isCopying&&s.getParagraphLength(e)+1===Math.abs(d)&&s.start.paragraph===s.end.paragraph&&(a=s.getParagraphsInSelection()),this.writeLines(o,r,n,t[Pn[this.keywordIndex]]))return void(sf.base.isNullOrUndefined(a)||1!==a.length||a[0]!==e||(t[se[this.keywordIndex]]=!0));r=0,n=0,sf.base.isNullOrUndefined(a)||1!==a.length||a[0]!==e||(t[se[this.keywordIndex]]=!0),o=(e=o).nextSplitWidget}return o=e.nextRenderedWidget,"Continuous"!==this.documentHelper.owner.layoutType&&sf.base.isNullOrUndefined(o)&&e.containerWidget instanceof aa&&!sf.base.isNullOrUndefined(e.containerWidget.page.nextPage)&&!sf.base.isNullOrUndefined(e.containerWidget.page.nextPage.bodyWidgets)&&(o=e.containerWidget.page.nextPage.bodyWidgets[0].childWidgets[0]),this.isExport?o instanceof da&&e.containerWidget.index===o.containerWidget.index?o:void 0:o},e.prototype.writeInlines=function(e,t,i){this.contentInline=[];for(var r=t,n=!1,o=0;o<r.children.length;o++){var s=r.children[o];if(this.isExport&&this.checkboxOrDropdown){if(n&&s instanceof Fa)continue;s instanceof va&&2===s.fieldType&&(n=!0)}if(!(s instanceof Va))if(s instanceof Wa)i.push(this.writeInlinesFootNote(e,s,t,i));else{if(s instanceof Oa||this.startContent||this.blockContent)this.writeInlinesContentControl(s,t,i,o);else{var a=this.writeInline(s);sf.base.isNullOrUndefined(a)||i.push(a)}this.isExport&&s instanceof va&&1===s.fieldType&&(n=!1,this.checkboxOrDropdown=!1)}}},e.prototype.inlineContentControl=function(e,t,i){var r={},n=[];if(sf.base.isNullOrUndefined(i))if(this.nestedContent){r[Pn[this.keywordIndex]]=this.inlineContentControls(e,void 0,n);o=this.nestedContentProperty(t,r);sf.base.isNullOrUndefined(o)&&!this.multipleLineContent||(this.contentInline.push(r),n=[])}else r[Pn[this.keywordIndex]]=this.inlineContentControls(e,this.contentInline);else if(this.nestedContent){i=i[i.length-1][Pn[this.keywordIndex]],r=this.inlineContentControls(e,i[i.length-1][Pn[this.keywordIndex]]);var o=this.nestedContentProperty(t,i[i.length-1]);sf.base.isNullOrUndefined(o)||(this.contentInline.push(r),n=[])}else this.inlineContentControls(e,i[i.length-1][Pn[this.keywordIndex]]);return t instanceof Oa&&1===t.type&&!this.nestedContent?this.multipleLineContent&&!sf.base.isNullOrUndefined(i)?(i[i.length-1].contentControlProperties=this.contentControlProperty(t.contentControlProperties),void(this.multipleLineContent=!1)):(r[Nn[this.keywordIndex]]=this.contentControlProperty(t.contentControlProperties),r):this.startContent?(this.multipleLineContent=!0,r):void 0},e.prototype.nestedContentProperty=function(e,t,i){if(sf.base.isNullOrUndefined(e)){if(this.startContent)return this.multipleLineContent=!0,t}else{if(1===e.type)return t[Nn[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties),t;if(this.startContent)return this.multipleLineContent=!0,t}},e.prototype.inlineContentControls=function(e,t,i){var r=this.writeInline(e);return sf.base.isNullOrUndefined(i)?(t.push(r),t):(i.push(r),i)},e.prototype.writeInline=function(e){var t={};if(e.removedIds.length>0)for(var i=0;i<e.removedIds.length;i++)e.revisions[i]=this.documentHelper.revisionsInternal.get(e.removedIds[i]);if(t[q[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat),e instanceof va)t[Zr[this.keywordIndex]]=e.fieldType,0===e.fieldType&&(t[Jr[this.keywordIndex]]=e.hasFieldEnd,e.formFieldData&&(t[Yr[this.keywordIndex]]={},t[Yr[this.keywordIndex]][ye[this.keywordIndex]]=e.formFieldData.name,t[Yr[this.keywordIndex]][Qr[this.keywordIndex]]=x.getBoolInfo(e.formFieldData.enabled,this.keywordIndex),t[Yr[this.keywordIndex]][$r[this.keywordIndex]]=e.formFieldData.helpText,t[Yr[this.keywordIndex]][en[this.keywordIndex]]=e.formFieldData.statusText,e.formFieldData instanceof ba?(t[Yr[this.keywordIndex]][tn[this.keywordIndex]]={},t[Yr[this.keywordIndex]][tn[this.keywordIndex]][hs[this.keywordIndex]]=1==this.keywordIndex?this.getTextFormFieldTypeEnumValue(e.formFieldData.type):e.formFieldData.type,t[Yr[this.keywordIndex]][tn[this.keywordIndex]][on[this.keywordIndex]]=e.formFieldData.maxLength,t[Yr[this.keywordIndex]][tn[this.keywordIndex]][sn[this.keywordIndex]]=e.formFieldData.defaultValue,t[Yr[this.keywordIndex]][tn[this.keywordIndex]][an[this.keywordIndex]]=1==this.keywordIndex&&"Text"===e.formFieldData.type?this.getTextFormFieldFormatEnumValue(e.formFieldData.format):e.formFieldData.format):e.formFieldData instanceof xa?(t[Yr[this.keywordIndex]][rn[this.keywordIndex]]={},this.checkboxOrDropdown=!0,t[Yr[this.keywordIndex]][rn[this.keywordIndex]][ln[this.keywordIndex]]=1==this.keywordIndex?this.getCheckBoxSizeTypeEnumValue(e.formFieldData.sizeType):e.formFieldData.sizeType,t[Yr[this.keywordIndex]][rn[this.keywordIndex]][dn[this.keywordIndex]]=e.formFieldData.size,t[Yr[this.keywordIndex]][rn[this.keywordIndex]][sn[this.keywordIndex]]=x.getBoolInfo(e.formFieldData.defaultValue,this.keywordIndex),t[Yr[this.keywordIndex]][rn[this.keywordIndex]][hn[this.keywordIndex]]=x.getBoolInfo(e.formFieldData.checked,this.keywordIndex)):(t[Yr[this.keywordIndex]][nn[this.keywordIndex]]={},this.checkboxOrDropdown=!0,t[Yr[this.keywordIndex]][nn[this.keywordIndex]][cn[this.keywordIndex]]=e.formFieldData.dropdownItems,t[Yr[this.keywordIndex]][nn[this.keywordIndex]][pn[this.keywordIndex]]=e.formFieldData.selectedIndex))),e.fieldCodeType&&""!==e.fieldCodeType&&(t.fieldCodeType=e.fieldCodeType);else if(e instanceof ja)this.writeChart(e,t);else if(e instanceof Da)t[Mr[this.keywordIndex]]=e.imageString,this.images.push(parseInt(e.imageString,10)),t[zr[this.keywordIndex]]=e.metaFileImageString,t[Vr[this.keywordIndex]]=x.getBoolInfo(e.isMetaFile,this.keywordIndex),t[Ss[this.keywordIndex]]=e.isCompressed,t[wr[this.keywordIndex]]=x.convertPixelToPoint(e.width),t[br[this.keywordIndex]]=x.convertPixelToPoint(e.height),e.isCrop&&(t[_r[this.keywordIndex]]=e.bottom,t[jr[this.keywordIndex]]=e.right,t[Gr[this.keywordIndex]]=e.left,t[qr[this.keywordIndex]]=e.top,t[Xr[this.keywordIndex]]=e.cropWidthScale,t[Kr[this.keywordIndex]]=e.cropHeightScale),t[ye[this.keywordIndex]]=e.name,t[ur[this.keywordIndex]]=e.alternateText,t[En[this.keywordIndex]]=e.title,t[mr[this.keywordIndex]]=x.getBoolInfo(e.visible,this.keywordIndex),t[xr[this.keywordIndex]]=e.widthScale,t[Ir[this.keywordIndex]]=e.heightScale,t[yo[this.keywordIndex]]=x.convertPixelToPoint(e.verticalPosition),t[mo[this.keywordIndex]]=1==this.keywordIndex?this.getVerticalOriginEnumValue(e.verticalOrigin):e.verticalOrigin,t[zt[this.keywordIndex]]=1==this.keywordIndex?this.getShapeVerticalAlignmentEnumValue(e.verticalAlignment):e.verticalAlignment,t[bo[this.keywordIndex]]=x.convertPixelToPoint(e.horizontalPosition),t[vo[this.keywordIndex]]=1==this.keywordIndex?this.getHorizontalOriginEnumValue(e.horizontalOrigin):e.horizontalOrigin,t[wo[this.keywordIndex]]=1==this.keywordIndex?this.getShapeHorizontalAlignmentEnumValue(e.horizontalAlignment):e.horizontalAlignment,t[co[this.keywordIndex]]=x.getBoolInfo(e.allowOverlap,this.keywordIndex),t[Wr[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingStyleEnumValue(e.textWrappingStyle):e.textWrappingStyle,t[kr[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingTypeEnumValue(e.textWrappingType):e.textWrappingType,t[yr[this.keywordIndex]]=x.getBoolInfo(e.isBelowText,this.keywordIndex),sf.base.isNullOrUndefined(e.distanceBottom)||(t[uo[this.keywordIndex]]=x.convertPixelToPoint(e.distanceBottom)),sf.base.isNullOrUndefined(e.distanceLeft)||(t[fo[this.keywordIndex]]=x.convertPixelToPoint(e.distanceLeft)),sf.base.isNullOrUndefined(e.distanceRight)||(t[go[this.keywordIndex]]=x.convertPixelToPoint(e.distanceRight)),sf.base.isNullOrUndefined(e.distanceTop)||(t[po[this.keywordIndex]]=x.convertPixelToPoint(e.distanceTop)),t[Hr[this.keywordIndex]]=x.getBoolInfo(e.layoutInCell,this.keywordIndex),t[Tr[this.keywordIndex]]=e.zOrderPosition;else if(e instanceof Na){if(t[qo[this.keywordIndex]]=e.bookmarkType,t[ye[this.keywordIndex]]=e.name,!sf.base.isNullOrUndefined(e.properties)){var r={};sf.base.isNullOrUndefined(e.properties.isAfterParagraphMark)||(r[Os[this.keywordIndex]]=x.getBoolInfo(e.properties.isAfterParagraphMark,this.keywordIndex)),sf.base.isNullOrUndefined(e.properties.isAfterTableMark)||(r[Us[this.keywordIndex]]=x.getBoolInfo(e.properties.isAfterTableMark,this.keywordIndex)),sf.base.isNullOrUndefined(e.properties.isAfterRowMark)||(r[Hs[this.keywordIndex]]=x.getBoolInfo(e.properties.isAfterRowMark,this.keywordIndex)),sf.base.isNullOrUndefined(e.properties.isAfterCellMark)||(r[Ts[this.keywordIndex]]=x.getBoolInfo(e.properties.isAfterCellMark,this.keywordIndex)),sf.base.isNullOrUndefined(e.properties.columnFirst)||(r[Yo[this.keywordIndex]]=e.properties.columnFirst),sf.base.isNullOrUndefined(e.properties.columnLast)||(r[Zo[this.keywordIndex]]=e.properties.columnLast),t[_o[this.keywordIndex]]=r}}else if(e instanceof gl)t[Be[this.keywordIndex]]=1==this.keywordIndex?x.getBreakClearType(e.breakClearType):e.breakClearType;else if(e instanceof Fa){var n=e.text;if(this.isWriteEndFootNote||!sf.base.isNullOrUndefined(this.owner.editorModule)&&this.owner.editorModule.isPaste||(n=x.removeInvalidXmlChars(n)),this.isWriteInlinesFootNote&&0===e.indexInOwner&&0===e.line.indexInOwner&&0==e.paragraph.indexInOwner&&x.checkTextFormat(n)&&(n=""),-1!==n.indexOf(String.fromCharCode(30)))t[gr[this.keywordIndex]]=n.replace(/\u001e/g,"-");else if(-1!==n.indexOf(String.fromCharCode(31)))t[gr[this.keywordIndex]]=n.replace(/\u001f/g,"");else if(0!==e.revisions.length)if(this.isExport||!this.owner.enableTrackChanges||this.isPartialExport)t[gr[this.keywordIndex]]=n;else{this.copyWithTrackChange=!0;for(var o=0;o<e.revisions.length;o++){var s=e.revisions[o];-1===this.selectedRevisionId.indexOf(s.revisionID)&&this.selectedRevisionId.push(s.revisionID),"Deletion"!==e.revisions[o].revisionType&&(t[gr[this.keywordIndex]]=n)}}else t[gr[this.keywordIndex]]=n}else e instanceof _a?(""!==e.user&&(t[Qo[this.keywordIndex]]=e.user),t[$o[this.keywordIndex]]=e.group,t[Yo[this.keywordIndex]]=e.columnFirst,t[Zo[this.keywordIndex]]=e.columnLast,t[Jo[this.keywordIndex]]=e.editRangeId.toString()):e instanceof qa?(t[es[this.keywordIndex]]={},t[es[this.keywordIndex]][Qo[this.keywordIndex]]=e.editRangeStart.user,t[es[this.keywordIndex]][$o[this.keywordIndex]]=e.editRangeStart.group,t[es[this.keywordIndex]][Yo[this.keywordIndex]]=e.editRangeStart.columnFirst,t[es[this.keywordIndex]][Zo[this.keywordIndex]]=e.editRangeStart.columnLast,t[Jo[this.keywordIndex]]=e.editRangeId.toString()):e instanceof al?(this.isExport||0!==e.commentType||this.selectedCommentsId.push(e.commentId),t[fn[this.keywordIndex]]=e.commentType,t[gn[this.keywordIndex]]=e.commentId):e instanceof La?this.writeShape(e,t):t=void 0;return this.writeInlineRevisions(t,e),t},e.prototype.writeInlineRevisions=function(e,t){if(t.revisions.length>0&&(this.isExport||!this.isExport&&!this.owner.enableTrackChanges)){e[Ge[this.keywordIndex]]=[];for(var i=0;i<t.revisions.length;i++)-1===this.selectedRevisionId.indexOf(t.revisions[i].revisionID)&&this.selectedRevisionId.push(t.revisions[i].revisionID),e[Ge[this.keywordIndex]].push(t.revisions[i].revisionID)}},e.prototype.writeShape=function(e,t){if(t[fr[this.keywordIndex]]=e.shapeId,t[ye[this.keywordIndex]]=e.name,t[ur[this.keywordIndex]]=e.alternateText,t[En[this.keywordIndex]]=e.title,t[mr[this.keywordIndex]]=x.getBoolInfo(e.visible,this.keywordIndex),t[wr[this.keywordIndex]]=x.convertPixelToPoint(e.width),e.isZeroHeight?t[br[this.keywordIndex]]=0:t[br[this.keywordIndex]]=x.convertPixelToPoint(e.height),t[xr[this.keywordIndex]]=e.widthScale,t[Ir[this.keywordIndex]]=e.heightScale,t[yo[this.keywordIndex]]=x.convertPixelToPoint(e.verticalPosition),t[mo[this.keywordIndex]]=1==this.keywordIndex?this.getVerticalOriginEnumValue(e.verticalOrigin):e.verticalOrigin,t[zt[this.keywordIndex]]=1==this.keywordIndex?this.getShapeVerticalAlignmentEnumValue(e.verticalAlignment):e.verticalAlignment,t[Sr[this.keywordIndex]]=e.verticalRelativePercent,t[bo[this.keywordIndex]]=x.convertPixelToPoint(e.horizontalPosition),t[vo[this.keywordIndex]]=1==this.keywordIndex?this.getHorizontalOriginEnumValue(e.horizontalOrigin):e.horizontalOrigin,t[wo[this.keywordIndex]]=1==this.keywordIndex?this.getShapeHorizontalAlignmentEnumValue(e.horizontalAlignment):e.horizontalAlignment,t[Pr[this.keywordIndex]]=e.horizontalRelativePercent,t[Nr[this.keywordIndex]]=e.heightRelativePercent,t[Or[this.keywordIndex]]=e.widthRelativePercent,t[Tr[this.keywordIndex]]=e.zOrderPosition,t[co[this.keywordIndex]]=x.getBoolInfo(e.allowOverlap,this.keywordIndex),t[Wr[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingStyleEnumValue(e.textWrappingStyle):e.textWrappingStyle,t[kr[this.keywordIndex]]=1==this.keywordIndex?this.getTextWrappingTypeEnumValue(e.textWrappingType):e.textWrappingType,t[yr[this.keywordIndex]]=x.getBoolInfo(e.isBelowText,this.keywordIndex),t[vr[this.keywordIndex]]=x.getBoolInfo(e.isHorizontalRule,this.keywordIndex),sf.base.isNullOrUndefined(e.distanceBottom)||(t[uo[this.keywordIndex]]=x.convertPixelToPoint(e.distanceBottom)),sf.base.isNullOrUndefined(e.distanceLeft)||(t[fo[this.keywordIndex]]=x.convertPixelToPoint(e.distanceLeft)),sf.base.isNullOrUndefined(e.distanceRight)||(t[go[this.keywordIndex]]=x.convertPixelToPoint(e.distanceRight)),sf.base.isNullOrUndefined(e.distanceTop)||(t[po[this.keywordIndex]]=x.convertPixelToPoint(e.distanceTop)),t[Hr[this.keywordIndex]]=x.getBoolInfo(e.layoutInCell,this.keywordIndex),t[Er[this.keywordIndex]]=x.getBoolInfo(e.lockAnchor,this.keywordIndex),t[Rr[this.keywordIndex]]=1==this.keywordIndex?this.getAutoShapeTypeEnumValue(e.autoShapeType):e.autoShapeType,e.fillFormat&&(t[Cr[this.keywordIndex]]={},t[Cr[this.keywordIndex]][Br[this.keywordIndex]]=e.fillFormat.color,t[Cr[this.keywordIndex]][Lr[this.keywordIndex]]=x.getBoolInfo(e.fillFormat.fill,this.keywordIndex)),e.lineFormat&&(t[Fr[this.keywordIndex]]={},t[Fr[this.keywordIndex]][Is[this.keywordIndex]]=1==this.keywordIndex?this.getLineFormatTypeEnumValue(e.lineFormat.lineFormatType):e.lineFormat.lineFormatType,t[Fr[this.keywordIndex]][Br[this.keywordIndex]]=e.lineFormat.color,t[Fr[this.keywordIndex]][Cs[this.keywordIndex]]=e.lineFormat.weight,t[Fr[this.keywordIndex]][pi[this.keywordIndex]]=1==this.keywordIndex?this.getLineDashStyleEnumValue(e.lineFormat.dashStyle):e.lineFormat.dashStyle,t[Fr[this.keywordIndex]][wi[this.keywordIndex]]=x.getBoolInfo(e.lineFormat.line,this.keywordIndex)),e.textFrame){t[Ur[this.keywordIndex]]={},t[Ur[this.keywordIndex]][Ar[this.keywordIndex]]=1==this.keywordIndex?this.getTextVerticalAlignmentEnumValue(e.textFrame.textVerticalAlignment):e.textFrame.textVerticalAlignment,t[Ur[this.keywordIndex]][wt[this.keywordIndex]]=x.convertPixelToPoint(e.textFrame.marginLeft),t[Ur[this.keywordIndex]][bt[this.keywordIndex]]=x.convertPixelToPoint(e.textFrame.marginRight),t[Ur[this.keywordIndex]][xt[this.keywordIndex]]=x.convertPixelToPoint(e.textFrame.marginTop),t[Ur[this.keywordIndex]][It[this.keywordIndex]]=x.convertPixelToPoint(e.textFrame.marginBottom),t[Ur[this.keywordIndex]][xo[this.keywordIndex]]=[];for(var i=0;i<e.textFrame.childWidgets.length;i++){var r=e.textFrame.childWidgets[i];r.hasOwnProperty("contentControlProperties")&&!sf.base.isNullOrUndefined(e.paragraph)&&e.paragraph.hasOwnProperty("contentControlProperties")&&(this.blocks=[]),this.writeBlock(r,0,t[Ur[this.keywordIndex]][xo[this.keywordIndex]])}}},e.prototype.writeChart=function(e,t){t[or[this.keywordIndex]]={},t[rr[this.keywordIndex]]={},t[ir[this.keywordIndex]]={},t[nr[this.keywordIndex]]={},t[er[this.keywordIndex]]=[],t[tr[this.keywordIndex]]=[],t[sr[this.keywordIndex]]={},t[ar[this.keywordIndex]]={},this.writeChartTitleArea(e.chartTitleArea,t[rr[this.keywordIndex]]),this.writeChartArea(e.chartArea,t[ir[this.keywordIndex]]),this.writeChartArea(e.chartPlotArea,t[nr[this.keywordIndex]]),this.writeChartCategory(e,t[er[this.keywordIndex]]),this.createChartSeries(e,t[tr[this.keywordIndex]]),this.writeChartLegend(e.chartLegend,t[or[this.keywordIndex]]),this.writeChartCategoryAxis(e.chartPrimaryCategoryAxis,t[sr[this.keywordIndex]]),this.writeChartCategoryAxis(e.chartPrimaryValueAxis,t[ar[this.keywordIndex]]),void 0!==e.chartDataTable.showSeriesKeys&&(t[pr[this.keywordIndex]]={},this.writeChartDataTable(e.chartDataTable,t[pr[this.keywordIndex]])),t[lr[this.keywordIndex]]=e.title,t[dr[this.keywordIndex]]=e.type,t[hr[this.keywordIndex]]=e.chartGapWidth,t[cr[this.keywordIndex]]=e.chartOverlap,t[br[this.keywordIndex]]=x.convertPixelToPoint(e.height),t[wr[this.keywordIndex]]=x.convertPixelToPoint(e.width)},e.prototype.writeChartTitleArea=function(e,t){t[ks[this.keywordIndex]]=e.chartfontName,t[Oe[this.keywordIndex]]=e.chartFontSize,t[fi[this.keywordIndex]]={},t[ui[this.keywordIndex]]=this.writeChartDataFormat(e.dataFormat),this.writeChartLayout(e.layout,t[fi[this.keywordIndex]])},e.prototype.writeChartDataFormat=function(e){var t={};return t[Lr[this.keywordIndex]]={},t[wi[this.keywordIndex]]={},sf.base.isNullOrUndefined(e.fill.color)||(e.fill.color.length>6?t[Lr[this.keywordIndex]][bi[this.keywordIndex]]=e.fill.color.substring(2):t[Lr[this.keywordIndex]][bi[this.keywordIndex]]=e.fill.color),t[Lr[this.keywordIndex]][bs[this.keywordIndex]]=e.fill.rgb,t[wi[this.keywordIndex]][Br[this.keywordIndex]]=e.line.color,t[wi[this.keywordIndex]][bs[this.keywordIndex]]=e.line.rgb,t},e.prototype.writeChartLayout=function(e,t){t[xi[this.keywordIndex]]=e.chartLayoutLeft,t[Ii[this.keywordIndex]]=e.chartLayoutTop},e.prototype.writeChartArea=function(e,t){t[bi[this.keywordIndex]]=e.chartForeColor},e.prototype.writeChartLegend=function(e,t){t[Go[this.keywordIndex]]=e.chartLegendPostion,t[rr[this.keywordIndex]]={},this.writeChartTitleArea(e.chartTitleArea,t[rr[this.keywordIndex]])},e.prototype.writeChartCategoryAxis=function(e,t){t[lr[this.keywordIndex]]=e.categoryAxisTitle,t[rr[this.keywordIndex]]={},this.writeChartTitleArea(e.chartTitleArea,t[rr[this.keywordIndex]]),t[$i[this.keywordIndex]]=e.categoryAxisType,t[Oe[this.keywordIndex]]=e.axisFontSize,t[ks[this.keywordIndex]]=e.axisFontName,t[Uo[this.keywordIndex]]=e.categoryNumberFormat,t[gs[this.keywordIndex]]=e.max,t[fs[this.keywordIndex]]=e.min,t[ps[this.keywordIndex]]=x.getBoolInfo(e.isAutoInternal,this.keywordIndex),t[cs[this.keywordIndex]]=e.interval,t[us[this.keywordIndex]]=x.getBoolInfo(e.majorGridLines,this.keywordIndex),t[ms[this.keywordIndex]]=x.getBoolInfo(e.minorGridLines,this.keywordIndex),t[ys[this.keywordIndex]]=e.majorTick,t[vs[this.keywordIndex]]=e.minorTick,t[ws[this.keywordIndex]]=e.tickPosition},e.prototype.writeChartDataTable=function(e,t){t[Ji[this.keywordIndex]]=x.getBoolInfo(e.showSeriesKeys,this.keywordIndex),t[Yi[this.keywordIndex]]=x.getBoolInfo(e.hasHorzBorder,this.keywordIndex),t[Zi[this.keywordIndex]]=x.getBoolInfo(e.hasVertBorder,this.keywordIndex),t[Qi[this.keywordIndex]]=x.getBoolInfo(e.hasBorders,this.keywordIndex)},e.prototype.writeChartCategory=function(e,t){var i=e.chartCategory;t[yi[this.keywordIndex]]=[];for(var r=0;r<i.length;r++){var n=i[r],o=this.createChartCategory(n,e.chartType);t.push(o)}},e.prototype.createChartCategory=function(e,t){var i={};return i[yi[this.keywordIndex]]=[],this.writeChartData(e,i[yi[this.keywordIndex]],t),i[vi[this.keywordIndex]]=e.categoryXName,i},e.prototype.writeChartData=function(e,t,i){for(var r=e.chartData,n=0;n<r.length;n++){var o=r[n],s=this.createChartData(o,i);t.push(s)}},e.prototype.createChartData=function(e,t){var i={};return i[mi[this.keywordIndex]]=e.yValue,"Bubble"===t&&(i[dn[this.keywordIndex]]=e.size),i},e.prototype.createChartSeries=function(e,t){for(var i=e.chartSeries,r=e.chartType,n=0;n<i.length;n++){var o=i[n],s=this.writeChartSeries(o,r);t.push(s)}},e.prototype.writeChartSeries=function(e,t){var i="Pie"===t||"Doughnut"===t,r={},n={},o=e.errorBar;if(r[Mi[this.keywordIndex]]=[],r[Ri[this.keywordIndex]]=e.seriesName,i&&(sf.base.isNullOrUndefined(e.firstSliceAngle)||(r[zi[this.keywordIndex]]=e.firstSliceAngle),"Doughnut"===t&&(r[Di[this.keywordIndex]]=e.doughnutHoleSize)),!sf.base.isNullOrUndefined(e.dataLabels.labelPosition)){var s=this.writeChartDataLabels(e.dataLabels);r[Ui[this.keywordIndex]]=s}if(!sf.base.isNullOrUndefined(e.seriesFormat.markerStyle)){var a={},l=e.seriesFormat;a[ki[this.keywordIndex]]=l.markerStyle,a[Pi[this.keywordIndex]]=l.numberValue,a[Si[this.keywordIndex]]=l.markerColor,r[Li[this.keywordIndex]]=a}if(sf.base.isNullOrUndefined(o.type)||(n[hs[this.keywordIndex]]=o.type,n[Fi[this.keywordIndex]]=o.direction,n[Ci[this.keywordIndex]]=o.endStyle,n[Wi[this.keywordIndex]]=o.numberValue,r[Bi[this.keywordIndex]]=n),e.trendLines.length>0){r[Ai[this.keywordIndex]]=[];for(var d=0;d<e.trendLines.length;d++){var h=this.writeChartTrendLines(e.trendLines[d]);r[Ai[this.keywordIndex]].push(h)}}for(d=0;d<e.chartDataFormat.length;d++){l=this.writeChartDataFormat(e.chartDataFormat[d]);r[Mi[this.keywordIndex]].push(l)}return r},e.prototype.writeChartDataLabels=function(e){var t={};return t[Go[this.keywordIndex]]=e.position,t[ks[this.keywordIndex]]=e.fontName,t[Te[this.keywordIndex]]=x.convertArgbToRgb(e.fontColor),t[Oe[this.keywordIndex]]=e.fontSize,t[Vi[this.keywordIndex]]=x.getBoolInfo(e.isLegendKey,this.keywordIndex),t[qi[this.keywordIndex]]=x.getBoolInfo(e.isBubbleSize,this.keywordIndex),t[_i[this.keywordIndex]]=x.getBoolInfo(e.isCategoryName,this.keywordIndex),t[ji[this.keywordIndex]]=x.getBoolInfo(e.isSeriesName,this.keywordIndex),t[Gi[this.keywordIndex]]=x.getBoolInfo(e.isValue,this.keywordIndex),t[Ki[this.keywordIndex]]=x.getBoolInfo(e.isPercentage,this.keywordIndex),t[Xi[this.keywordIndex]]=x.getBoolInfo(e.isLeaderLines,this.keywordIndex),t},e.prototype.writeChartTrendLines=function(e){var t={};return t[ye[this.keywordIndex]]=e.trendLineName,t[hs[this.keywordIndex]]=e.trendLineType,t[Ni[this.keywordIndex]]=e.forwardValue,t[Oi[this.keywordIndex]]=e.backwardValue,t[Ti[this.keywordIndex]]=e.interceptValue,t[Ei[this.keywordIndex]]=x.getBoolInfo(e.isDisplayEquation,this.keywordIndex),t[Hi[this.keywordIndex]]=x.getBoolInfo(e.isDisplayRSquared,this.keywordIndex),t},e.prototype.writeLines=function(e,t,i,r){for(var n=t,o=this.endLine instanceof ma&&this.endLine.paragraph===e,s=o?this.endLine.indexInOwner:e.childWidgets.length-1,a=n;a<=s;a++){var l=e.childWidgets[a];this.endLine===l||t===a&&0!==i?(this.endLine===l&&e.paragraphFormat.bidi&&this.startLine!==this.endLine&&(this.endOffset=l.getEndOffset()),this.writeLine(l,this.startLine!==this.endLine&&l!==this.startLine?0:i,r)):this.writeInlines(e,l,r)}return o},e.prototype.writeLine=function(e,t,i){this.contentInline=[];for(var r=!1,n=!1,o=e===this.endLine,s=e,a=!1,l=!1,d=0,h=0;h<s.children.length;h++){var c=s.children[h];if(!(c instanceof Va)){var p=void 0;if(a=(d+=c.length)>t,c instanceof Oa&&(a||(r=0===c.type),n=!0),c instanceof Fa&&c.hasOwnProperty("contentControlProperties")&&a&&!n&&(r=!0),c instanceof Oa&&(r&&1===c.type&&(r=!1),n&&1===c.type&&(n=!1)),l=o&&d>=this.endOffset,a&&!r)if(c instanceof Oa||this.startContent||this.blockContent){if(l){this.startContent=!1;break}this.writeInlinesContentControl(c,e,i,h)}else{if(p=this.writeInline(c),i[i.length]=p,d>t||l){if(p.hasOwnProperty(gr[this.keywordIndex])){var g=d-c.length,f=t-g,u=l?this.endOffset-g:c.length;p[gr[this.keywordIndex]]=p[gr[this.keywordIndex]].substring(f,u)}t=-1}if(l)break}}}},e.prototype.writeInlinesFootNote=function(e,t,i,r){this.isWriteInlinesFootNote=!0;var n={};n[Cn[this.keywordIndex]]=1==this.keywordIndex?this.getFootnoteTypeEnumValue(t.footnoteType):t.footnoteType,n[q[this.keywordIndex]]={},n[q[this.keywordIndex]]=this.writeCharacterFormat(t.characterFormat),n[xo[this.keywordIndex]]=[];for(var o=0;o<t.bodyWidget.childWidgets.length;o++)this.writeBlock(t.bodyWidget.childWidgets[o],0,n[xo[this.keywordIndex]]);return n[Wn[this.keywordIndex]]=t.symbolCode,n[kn[this.keywordIndex]]=t.symbolFontName,n[Sn[this.keywordIndex]]=t.customMarker,this.writeInlineRevisions(n,t),this.isWriteInlinesFootNote=!1,n},e.prototype.writeInlinesContentControl=function(e,t,i,r){if(e instanceof Oa&&"Block"===e.contentControlWidgetType)return this.isBlockClosed=!1,this.blockContent&&0===e.type?(this.nestedBlockContent=!0,!0):this.nestedBlockContent&&1===e.type?(this.nestedBlockContent=!1,!0):(this.blockContent=0===e.type,t.children[r-1]instanceof Oa&&"Block"===t.children[r-1].contentControlWidgetType&&(this.blockContent=!0),this.blockContent||(this.isBlockClosed=!0),!0);if(e instanceof Oa){if(this.startContent&&0===e.type)return this.nestedContent=!0,!0;if(this.startContent&&this.nestedContent){if((s={})[Pn[this.keywordIndex]]=this.contentInline,this.contentInline.length>0){var n=this.nestedContentProperty(t.children[r+1],s);i.push(n),this.contentInline=[]}return this.multipleLineContent&&(s=i[i.length-1],this.nestedContentProperty(t.children[r+1],s),this.multipleLineContent=!1),this.nestedContent=!1,!0}return this.contentType=e.contentControlWidgetType,this.startContent=0===e.type,!0}if(this.startContent&&"Inline"===this.contentType)if(this.multipleLineContent)this.inlineContentControl(e,t.children[r+1],i),this.contentInline=[];else{var o=this.inlineContentControl(e,t.children[r+1]);if(!sf.base.isNullOrUndefined(o)){if(!this.nestedContent||!this.multipleLineContent)return i.push(o),this.contentInline=[],!1;(s={}).inlines=this.contentInline,i.push(s),this.contentInline=[]}}else{var s=this.writeInline(e);sf.base.isNullOrUndefined(s)||i.push(s)}},e.prototype.createParagraph=function(e){var t={},i=!1,r=!1;if(!this.documentHelper.selection||this.documentHelper.selection.isEmpty||this.isExport)i=!0;else{var n=this.documentHelper.selection.end;this.documentHelper.selection.isForward||(n=this.documentHelper.selection.start);var o=n.paragraph.childWidgets[n.paragraph.childWidgets.length-1];r=!sf.base.isNullOrUndefined(e.paragraphFormat.listFormat.list),i=this.documentHelper.selection.isParagraphLastLine(o)&&n.currentWidget===o&&(n.offset===this.documentHelper.selection.getLineLength(o)+1||!(e.indexInOwner==n.paragraph.indexInOwner)&&r)}return t[_[this.keywordIndex]]=this.writeParagraphFormat(i?e.paragraphFormat:new ul(e)),t[q[this.keywordIndex]]=this.writeCharacterFormat(i?e.characterFormat:new T(e)),t[Pn[this.keywordIndex]]=[],t},e.prototype.writeCharacterFormat=function(e,t){var i={};if(x.writeCharacterFormat(i,t,e,this.keywordIndex),i[Me[this.keywordIndex]]=t?x.getBoolInfo(e.boldBidi,this.keywordIndex):e.getValue("boldBidi"),i[ze[this.keywordIndex]]=t?x.getBoolInfo(e.italicBidi,this.keywordIndex):e.getValue("italicBidi"),i[Le[this.keywordIndex]]=t?e.fontSizeBidi:e.getValue("fontSizeBidi"),e.revisions.length>0){i[Ge[this.keywordIndex]]=[];for(var r=0;r<e.revisions.length;r++)i[Ge[this.keywordIndex]].push(e.revisions[r].revisionID)}return this.writeInlineStyles&&!t&&(i[Ws[this.keywordIndex]]=this.writeCharacterFormat(e,!0)),i},e.prototype.writeParagraphFormat=function(e,t){var i={};return x.writeParagraphFormat(i,t,e,this.keywordIndex),i[ot[this.keywordIndex]]=this.writeListFormat(e.listFormat,t),i[pt[this.keywordIndex]]=this.writeTabs(e.tabs),this.writeInlineStyles&&!t&&(i[Ws[this.keywordIndex]]=this.writeParagraphFormat(e,!0)),i},e.prototype.writeThemes=function(e){var t={};return t[is[this.keywordIndex]]={},t[is[this.keywordIndex]][rs[this.keywordIndex]]=e.fontScheme.fontSchemeName,t[is[this.keywordIndex]][ns[this.keywordIndex]]=this.writeMajorMinorFontScheme(e.fontScheme.majorFontScheme),t[is[this.keywordIndex]][os[this.keywordIndex]]=this.writeMajorMinorFontScheme(e.fontScheme.minorFontScheme),t},e.prototype.writeMajorMinorFontScheme=function(e){var t={};t[ss[this.keywordIndex]]=this.writeFontSchemeList(e.fontSchemeList);for(var i={},r=0,n=e.fontTypeface.keys;r<n.length;r++){var o=n[r];i[o]=e.fontTypeface.get(o)}return t[as[this.keywordIndex]]=i,t},e.prototype.writeFontSchemeList=function(e){var t=this,i=[];return e.forEach((function(e){var r={};r[ye[t.keywordIndex]]=e.name,r[ls[t.keywordIndex]]=e.typeface,r[ds[t.keywordIndex]]=e.panose,i.push(r)})),i},e.prototype.writeTabs=function(e){if(!(sf.base.isNullOrUndefined(e)||e.length<1)){for(var t=[],i=0;i<e.length;i++){var r=e[i],n={};n[Go[this.keywordIndex]]=r.position,n[Ko[this.keywordIndex]]=r.deletePosition,n[jo[this.keywordIndex]]=1==this.keywordIndex?this.getTabJustificationEnumValue(r.tabJustification):r.tabJustification,n[Xo[this.keywordIndex]]=1==this.keywordIndex?this.getTabLeaderEnumValue(r.tabLeader):r.tabLeader,t.push(n)}return t}},e.prototype.writeListFormat=function(e,t){var i={},r=e.getValue("listId");sf.base.isNullOrUndefined(r)||(i[Ke[this.keywordIndex]]=r,this.lists.indexOf(e.listId)<0&&this.lists.push(e.listId));var n=e.getValue("listLevelNumber");return sf.base.isNullOrUndefined(n)||(i[Xe[this.keywordIndex]]=n),i},e.prototype.writeTable=function(e,t,i,r){var n=e.childWidgets[i];if(!(n instanceof fa&&this.writeRow(n,t[oo[this.keywordIndex]]))){var o=e;do{o=(e=o).nextSplitWidget}while(o instanceof da);return(o=e.nextRenderedWidget)instanceof da&&o.containerWidget.index===e.containerWidget.index?o:void 0}},e.prototype.writeRow=function(e,t){var i=e;do{if((e=i)===(i=this.writeRowInternal(i,t)))return!0}while(i instanceof fa);return!1},e.prototype.writeRowInternal=function(e,t){if(!(e instanceof fa))return e;e.isCellsHaveSameWidthUnit()||e.updateUniformWidthUnitForCells();var i=this.createRow(e);t.push(i);for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];if(n instanceof ua&&e.index===n.rowIndex&&(sf.base.isNullOrUndefined(this.startColumnIndex)||n.columnIndex>=this.startColumnIndex)&&(sf.base.isNullOrUndefined(this.endColumnIndex)||n.columnIndex<this.endColumnIndex)&&this.writeCell(n,i[no[this.keywordIndex]]))return e}var o=e,s=!1;do{o=(e=o).nextRenderedWidget,!sf.base.isNullOrUndefined(e.ownerTable.bodyWidget)&&o&&(e.ownerTable.index!==o.ownerTable.index&&e.ownerTable.bodyWidget.sectionIndex===o.ownerTable.bodyWidget.sectionIndex||e.ownerTable.bodyWidget.sectionIndex!==o.ownerTable.bodyWidget.sectionIndex)&&(o=void 0),s=!sf.base.isNullOrUndefined(e.nextSplitWidget)&&e.childWidgets.length!==o.childWidgets.length}while(o instanceof fa&&o.index===e.index&&!s);return o},e.prototype.writeCell=function(e,t){var i=this.createCell(e);t.push(i);var r=e.firstChild;do{r=this.writeBlock(r,0,i[xo[this.keywordIndex]])}while(r);return this.endCell instanceof ua&&this.endCell.cellFormat===e.cellFormat},e.prototype.createTable=function(e){var t={};sf.base.isNullOrUndefined(this.keywordIndex)&&(this.keywordIndex=0),t[oo[this.keywordIndex]]=[],t[Es[this.keywordIndex]]=[];for(var i=0;i<e.tableHolder.columns.length;i++)t[Es[this.keywordIndex]][i]=e.tableHolder.columns[i].preferredWidth;return t[ho[this.keywordIndex]]=this.writeTableFormat(e.tableFormat),t[so[this.keywordIndex]]=e.tableFormat.description,t[En[this.keywordIndex]]=e.tableFormat.title,t[Rs[this.keywordIndex]]=e.tableHolder.columns.length,this.writeTablePositioning(t,e),t},e.prototype.writeTablePositioning=function(e,t){t.wrapTextAround&&(e[ao[this.keywordIndex]]=x.getBoolInfo(t.wrapTextAround,this.keywordIndex),e[lo[this.keywordIndex]]={},e[lo[this.keywordIndex]][co[this.keywordIndex]]=x.getBoolInfo(t.positioning.allowOverlap,this.keywordIndex),sf.base.isNullOrUndefined(t.positioning.distanceBottom)||(e[lo[this.keywordIndex]][uo[this.keywordIndex]]=x.convertPixelToPoint(t.positioning.distanceBottom)),sf.base.isNullOrUndefined(t.positioning.distanceLeft)||(e[lo[this.keywordIndex]][fo[this.keywordIndex]]=x.convertPixelToPoint(t.positioning.distanceLeft)),sf.base.isNullOrUndefined(t.positioning.distanceRight)||(e[lo[this.keywordIndex]][go[this.keywordIndex]]=x.convertPixelToPoint(t.positioning.distanceRight)),sf.base.isNullOrUndefined(t.positioning.distanceTop)||(e[lo[this.keywordIndex]][po[this.keywordIndex]]=x.convertPixelToPoint(t.positioning.distanceTop)),sf.base.isNullOrUndefined(t.positioning.verticalAlignment)||(e[lo[this.keywordIndex]][zt[this.keywordIndex]]=1==this.keywordIndex?this.getTableVerticalPositionEnumValue(t.positioning.verticalAlignment):t.positioning.verticalAlignment),sf.base.isNullOrUndefined(t.positioning.verticalOrigin)||(e[lo[this.keywordIndex]][mo[this.keywordIndex]]=1==this.keywordIndex?this.getTableVerticalRelationEnumValue(t.positioning.verticalOrigin):t.positioning.verticalOrigin),e[lo[this.keywordIndex]][yo[this.keywordIndex]]=t.positioning.verticalPosition,sf.base.isNullOrUndefined(t.positioning.horizontalAlignment)||(e[lo[this.keywordIndex]][wo[this.keywordIndex]]=1==this.keywordIndex?this.getTableHorizontalPositionEnumValue(t.positioning.horizontalAlignment):t.positioning.horizontalAlignment),sf.base.isNullOrUndefined(t.positioning.horizontalOrigin)||(e[lo[this.keywordIndex]][vo[this.keywordIndex]]=1==this.keywordIndex?this.getTableHorizontalRelationEnumValue(t.positioning.horizontalOrigin):t.positioning.horizontalOrigin),e[lo[this.keywordIndex]][bo[this.keywordIndex]]=t.positioning.horizontalPosition)},e.prototype.createRow=function(e){var t={};return t[no[this.keywordIndex]]=[],t[ro[this.keywordIndex]]=this.writeRowFormat(e.rowFormat),e.hasOwnProperty("contentControlProperties")&&(t[Nn[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties)),t},e.prototype.createCell=function(e){var t={};return t[xo[this.keywordIndex]]=[],t[io[this.keywordIndex]]=this.writeCellFormat(e.cellFormat),t[Ps[this.keywordIndex]]=e.columnIndex,e.hasOwnProperty("contentControlProperties")&&(t[Nn[this.keywordIndex]]=this.contentControlProperty(e.contentControlProperties)),t},e.prototype.writeShading=function(e){var t={};return t[ni[this.keywordIndex]]=e.hasValue("backgroundColor")?e.backgroundColor:void 0,t[oi[this.keywordIndex]]=e.hasValue("foregroundColor")?e.foregroundColor:void 0,t[ri[this.keywordIndex]]=e.hasValue("textureStyle")?1==this.keywordIndex?this.getTextureStyleEnumValue(e.textureStyle):e.textureStyle:void 0,t},e.prototype.writeBorders=function(e){var t={};return t[qr[this.keywordIndex]]=x.writeBorder(e.top,this.keywordIndex),t[Gr[this.keywordIndex]]=x.writeBorder(e.left,this.keywordIndex),t[jr[this.keywordIndex]]=x.writeBorder(e.right,this.keywordIndex),t[_r[this.keywordIndex]]=x.writeBorder(e.bottom,this.keywordIndex),t[ci[this.keywordIndex]]=x.writeBorder(e.diagonalDown,this.keywordIndex),t[hi[this.keywordIndex]]=x.writeBorder(e.diagonalUp,this.keywordIndex),t[di[this.keywordIndex]]=x.writeBorder(e.horizontal,this.keywordIndex),t[li[this.keywordIndex]]=x.writeBorder(e.vertical,this.keywordIndex),t},e.prototype.writeCellFormat=function(e){var t={};return t[ct[this.keywordIndex]]=this.writeBorders(e.borders),t[Qt[this.keywordIndex]]=this.writeShading(e.shading),t[xt[this.keywordIndex]]=e.hasValue("topMargin")?e.topMargin:void 0,t[bt[this.keywordIndex]]=e.hasValue("rightMargin")?e.rightMargin:void 0,t[wt[this.keywordIndex]]=e.hasValue("leftMargin")?e.leftMargin:void 0,t[It[this.keywordIndex]]=e.hasValue("bottomMargin")?e.bottomMargin:void 0,t[ei[this.keywordIndex]]=e.hasValue("preferredWidth")?e.preferredWidth:void 0,t[ti[this.keywordIndex]]=e.hasValue("preferredWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(e.preferredWidthType):e.preferredWidthType:void 0,t[Lt[this.keywordIndex]]=e.hasValue("cellWidth")?e.cellWidth:void 0,t[At[this.keywordIndex]]=e.columnSpan,t[Mt[this.keywordIndex]]=e.rowSpan,t[zt[this.keywordIndex]]=e.hasValue("verticalAlignment")?1==this.keywordIndex?this.getCellVerticalAlignmentEnumValue(e.verticalAlignment):e.verticalAlignment:void 0,t},e.prototype.writeRowFormat=function(e){var t={},i=[];t[br[this.keywordIndex]]=e.hasValue("height")?e.height:void 0,t[Dt[this.keywordIndex]]=e.hasValue("allowBreakAcrossPages")?x.getBoolInfo(e.allowBreakAcrossPages,this.keywordIndex):void 0,t[qt[this.keywordIndex]]=e.hasValue("heightType")?1==this.keywordIndex?this.getHeighTypeEnumValue(e.heightType):e.heightType:void 0,t[Vt[this.keywordIndex]]=e.hasValue("isHeader")?x.getBoolInfo(e.isHeader,this.keywordIndex):void 0,t[ct[this.keywordIndex]]=this.writeBorders(e.borders),t[_t[this.keywordIndex]]=e.gridBefore,t[jt[this.keywordIndex]]=e.hasValue("gridBeforeWidth")?e.gridBeforeWidth:void 0,t[Gt[this.keywordIndex]]=e.hasValue("gridBeforeWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(e.gridBeforeWidthType):e.gridBeforeWidthType:void 0,t[Kt[this.keywordIndex]]=e.gridAfter,t[Xt[this.keywordIndex]]=e.hasValue("gridAfterWidth")?e.gridAfterWidth:void 0,t[Jt[this.keywordIndex]]=e.hasValue("gridAfterWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(e.gridAfterWidthType):e.gridAfterWidthType:void 0,t[wt[this.keywordIndex]]=e.hasValue("leftMargin")?e.leftMargin:void 0,t[xt[this.keywordIndex]]=e.hasValue("topMargin")?e.topMargin:void 0,t[bt[this.keywordIndex]]=e.hasValue("rightMargin")?e.rightMargin:void 0,t[It[this.keywordIndex]]=e.hasValue("bottomMargin")?e.bottomMargin:void 0,t[Je[this.keywordIndex]]=e.hasValue("leftIndent")?e.leftIndent:void 0;for(var r=0;r<e.revisions.length;r++)t[Ge[this.keywordIndex]]=this.writeRowRevisions(e.revisions[r],i);return t},e.prototype.writeRowRevisions=function(e,t){return-1===this.selectedRevisionId.indexOf(e.revisionID)&&this.selectedRevisionId.push(e.revisionID),t.push(e.revisionID),t},e.prototype.writeTableFormat=function(e){var t={};return t[ct[this.keywordIndex]]=this.writeBorders(e.borders),t[Qt[this.keywordIndex]]=this.writeShading(e.shading),t[Zt[this.keywordIndex]]=e.hasValue("cellSpacing")?e.cellSpacing:void 0,t[Je[this.keywordIndex]]=e.hasValue("leftIndent")?e.leftIndent:void 0,t[$t[this.keywordIndex]]=e.hasValue("tableAlignment")?1==this.keywordIndex?this.getTableAlignmentEnumValue(e.tableAlignment):e.tableAlignment:void 0,t[xt[this.keywordIndex]]=e.hasValue("topMargin")?e.topMargin:void 0,t[bt[this.keywordIndex]]=e.hasValue("rightMargin")?e.rightMargin:void 0,t[wt[this.keywordIndex]]=e.hasValue("leftMargin")?e.leftMargin:void 0,t[It[this.keywordIndex]]=e.hasValue("bottomMargin")?e.bottomMargin:void 0,t[ei[this.keywordIndex]]=e.hasValue("preferredWidth")?e.preferredWidth:void 0,t[ti[this.keywordIndex]]=e.hasValue("preferredWidthType")?1==this.keywordIndex?this.getWidthTypeEnumValue(e.preferredWidthType):e.preferredWidthType:void 0,t[Re[this.keywordIndex]]=e.hasValue("bidi")?x.getBoolInfo(e.bidi,this.keywordIndex):void 0,t[Yt[this.keywordIndex]]=e.hasValue("allowAutoFit")?x.getBoolInfo(e.allowAutoFit,this.keywordIndex):void 0,t[Ee[this.keywordIndex]]=sf.base.isNullOrUndefined(e.styleName)?void 0:e.styleName,t},e.prototype.footnotes=function(e){this.isWriteEndFootNote=!0;for(var t=0;t<e.footnotes.separator.length;t++)this.seprators(e);this.isWriteEndFootNote=!1},e.prototype.seprators=function(e){if(e.footnotes.separator.length>0){this.document[pe[this.keywordIndex]]={},this.document[pe[this.keywordIndex]][zo[this.keywordIndex]]=[];for(var t=0;t<e.footnotes.separator.length;t++)this.writeBlock(e.footnotes.separator[t],0,this.document[pe[this.keywordIndex]][zo[this.keywordIndex]])}if(e.footnotes.continuationSeparator.length>0){this.document[pe[this.keywordIndex]][Do[this.keywordIndex]]=[];for(t=0;t<e.footnotes.continuationSeparator.length;t++)this.writeBlock(e.footnotes.continuationSeparator[t],0,this.document[pe[this.keywordIndex]][Do[this.keywordIndex]])}if(e.footnotes.continuationNotice.length>0){this.document[pe[this.keywordIndex]][Vo[this.keywordIndex]]=[];for(t=0;t<e.footnotes.continuationNotice.length;t++)this.writeBlock(e.footnotes.continuationNotice[t],0,this.document[pe[this.keywordIndex]][Vo[this.keywordIndex]])}},e.prototype.endnotes=function(e){this.isWriteEndFootNote=!0;for(var t=0;t<this.documentHelper.endnotes.separator.length;t++)this.endnoteSeparator(e);this.isWriteEndFootNote=!1},e.prototype.endnoteSeparator=function(e){if(e.endnotes.separator.length>0){this.document[ge[this.keywordIndex]]={},this.document[ge[this.keywordIndex]][zo[this.keywordIndex]]=[];for(var t=0;t<e.endnotes.separator.length;t++)this.writeBlock(e.endnotes.separator[t],0,this.document[ge[this.keywordIndex]][zo[this.keywordIndex]])}if(e.endnotes.continuationSeparator.length>0){this.document[ge[this.keywordIndex]][Do[this.keywordIndex]]=[];for(t=0;t<e.endnotes.continuationSeparator.length;t++)this.writeBlock(e.endnotes.continuationSeparator[t],0,this.document[ge[this.keywordIndex]][Do[this.keywordIndex]])}if(e.endnotes.continuationNotice.length>0){this.document[ge[this.keywordIndex]][Vo[this.keywordIndex]]=[];for(t=0;t<e.endnotes.continuationNotice.length;t++)this.writeBlock(e.endnotes.continuationNotice[t],0,this.document[ge[this.keywordIndex]][Vo[this.keywordIndex]])}},e.prototype.writeStyles=function(e){this.document[X[this.keywordIndex]]=[];for(var t=0;t<e.styles.length;t++)this.document[X[this.keywordIndex]].push(this.writeStyle(e.styles.getItem(t)))},e.prototype.writeStyle=function(e){var t={};return t[ye[this.keywordIndex]]=e.name,"Paragraph"===e.type&&(t[hs[this.keywordIndex]]=1==this.keywordIndex?this.getStyleTypeEnumValue(e.type):e.type,t[_[this.keywordIndex]]=this.writeParagraphFormat(e.paragraphFormat),t[q[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat)),"Character"===e.type&&(t[hs[this.keywordIndex]]=1==this.keywordIndex?this.getStyleTypeEnumValue(e.type):e.type,t[q[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat)),"Table"===e.type&&(t[hs[this.keywordIndex]]=1==this.keywordIndex?this.getStyleTypeEnumValue(e.type):e.type),sf.base.isNullOrUndefined(e.basedOn)||(t[ve[this.keywordIndex]]=e.basedOn.name),sf.base.isNullOrUndefined(e.link)||(t[be[this.keywordIndex]]=e.link.name),sf.base.isNullOrUndefined(e.next)||(t[we[this.keywordIndex]]=e.next.name),t},e.prototype.writeRevisions=function(e){this.document[Z[this.keywordIndex]]=[];for(var t=0;t<e.owner.revisions.changes.length;t++)(this.isExport||!this.isExport&&!this.owner.enableTrackChanges&&-1!==this.selectedRevisionId.indexOf(e.owner.revisions.changes[t].revisionID))&&this.document[Z[this.keywordIndex]].push(this.writeRevision(e.owner.revisions.changes[t]))},e.prototype.writeRevision=function(e){var t={};return t[un[this.keywordIndex]]=e.author,t[yn[this.keywordIndex]]=e.date,t[bn[this.keywordIndex]]=1==this.keywordIndex?this.getRevisionTypeEnumValue(e.revisionType):e.revisionType,t[xn[this.keywordIndex]]=e.revisionID,t},e.prototype.writeComments=function(e){this.document[J[this.keywordIndex]]=[];for(var t=0;t<e.comments.length;t++)(this.isExport||!this.isExport&&-1!==this.selectedCommentsId.indexOf(this.documentHelper.comments[t].commentId))&&this.document[J[this.keywordIndex]].push(this.writeComment(this.documentHelper.comments[t]))},e.prototype.writeCustomXml=function(e){this.document[Q[this.keywordIndex]]=[];for(var t=0;t<e.customXmlData.length;t++){var i={},r=e.customXmlData.keys[t];i[In[this.keywordIndex]]=r;var n=this.documentHelper.customXmlData.get(r);i[Fn[this.keywordIndex]]=n,this.document[Q[this.keywordIndex]].push(i)}},e.prototype.writeImages=function(e){this.document[Ns[this.keywordIndex]]={};for(var t=0;t<this.images.length;t++){var i=this.images[t],r=e.images.get(i);this.document[Ns[this.keywordIndex]][i]=r}},e.prototype.writeComment=function(e){var t={};t[gn[this.keywordIndex]]=e.commentId,t[un[this.keywordIndex]]=e.author,t[yn[this.keywordIndex]]=e.date,t[xo[this.keywordIndex]]=[],t[xo[this.keywordIndex]].push(this.commentInlines(e.text)),t[vn[this.keywordIndex]]=x.getBoolInfo(e.isResolved,this.keywordIndex),t[wn[this.keywordIndex]]=[];for(var i=0;i<e.replyComments.length;i++)t[wn[this.keywordIndex]].push(this.writeComment(e.replyComments[i]));return t},e.prototype.commentInlines=function(e){var t={};t[Pn[this.keywordIndex]]=[];var i={};return i[gr[this.keywordIndex]]=e,t[Pn[this.keywordIndex]].push(i),t},e.prototype.writeLists=function(e){var t=[];this.document[j[this.keywordIndex]]=[];for(var i=0;i<e.lists.length;i++){var r=e.lists[i];this.lists.indexOf(r.listId)>-1&&(this.document[j[this.keywordIndex]].push(this.writeList(r)),t.indexOf(r.abstractListId)<0&&t.push(r.abstractListId))}this.document[G[this.keywordIndex]]=[];for(i=0;i<e.abstractLists.length;i++){var n=e.abstractLists[i];t.indexOf(n.abstractListId)>-1&&this.document[G[this.keywordIndex]].push(this.writeAbstractList(n))}},e.prototype.writeAbstractList=function(e){var t={};t[Bo[this.keywordIndex]]=e.abstractListId,t[Lo[this.keywordIndex]]=[];for(var i=0;i<e.levels.length;i++)t[Lo[this.keywordIndex]][i]=this.writeListLevel(e.levels[i]);return t},e.prototype.writeList=function(e){var t={};t[Bo[this.keywordIndex]]=e.abstractListId,t[Mo[this.keywordIndex]]=[];for(var i=0;i<e.levelOverrides.length;i++)t[Mo[this.keywordIndex]].push(this.writeLevelOverrides(e.levelOverrides[i]));return t[Ke[this.keywordIndex]]=e.listId,t},e.prototype.writeLevelOverrides=function(e){var t={};return t[Ro[this.keywordIndex]]=e.levelNumber,e.overrideListLevel&&(t[Ao[this.keywordIndex]]=this.writeListLevel(e.overrideListLevel)),t[Ho[this.keywordIndex]]=e.startAt,t},e.prototype.writeListLevel=function(e){var t={};return t[q[this.keywordIndex]]=this.writeCharacterFormat(e.characterFormat),t[_[this.keywordIndex]]=this.writeParagraphFormat(e.paragraphFormat),t[le[this.keywordIndex]]=x.getBoolInfo(e.isLegalStyleNumbering,this.keywordIndex),t[To[this.keywordIndex]]=1==this.keywordIndex?this.getFollowCharacterType(e.followCharacter):e.followCharacter,t[Oo[this.keywordIndex]]=1==this.keywordIndex?this.getListLevelPatternEnumValue(e.listLevelPattern):e.listLevelPattern,t[Uo[this.keywordIndex]]=e.numberFormat,t[Y[this.keywordIndex]]=e.paraStyleName,t[Eo[this.keywordIndex]]=e.restartLevel,t[Ho[this.keywordIndex]]=e.startAt,t},e.prototype.getParentBlock=function(e){return e.isInsideTable&&(e=this.owner.documentHelper.layout.getParentTable(e)),e},e.prototype.getParentCell=function(e){for(;e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},e.prototype.getWidthTypeEnumValue=function(e){switch(e){case"Auto":return 0;case"Percent":return 1;case"Point":return 2}},e.prototype.getTableAlignmentEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Right":return 2}},e.prototype.getTextureStyleEnumValue=function(e){switch(e){case"TextureNone":return 0;case"Texture2Pt5Percent":return 1;case"Texture5Percent":return 2;case"Texture7Pt5Percent":return 3;case"Texture10Percent":return 4;case"Texture12Pt5Percent":return 5;case"Texture15Percent":return 6;case"Texture17Pt5Percent":return 7;case"Texture20Percent":return 8;case"Texture22Pt5Percent":return 9;case"Texture25Percent":return 10;case"Texture27Pt5Percent":return 11;case"Texture30Percent":return 12;case"Texture32Pt5Percent":return 13;case"Texture35Percent":return 14;case"Texture37Pt5Percent":return 15;case"Texture40Percent":return 16;case"Texture42Pt5Percent":return 17;case"Texture45Percent":return 18;case"Texture47Pt5Percent":return 19;case"Texture50Percent":return 20;case"Texture52Pt5Percent":return 21;case"Texture55Percent":return 22;case"Texture57Pt5Percent":return 23;case"Texture60Percent":return 24;case"Texture62Pt5Percent":return 25;case"Texture65Percent":return 26;case"Texture67Pt5Percent":return 27;case"Texture70Percent":return 28;case"Texture72Pt5Percent":return 29;case"Texture75Percent":return 30;case"Texture77Pt5Percent":return 31;case"Texture80Percent":return 32;case"Texture82Pt5Percent":return 33;case"Texture85Percent":return 34;case"Texture87Pt5Percent":return 35;case"Texture90Percent":return 36;case"Texture92Pt5Percent":return 37;case"Texture95Percent":return 38;case"Texture97Pt5Percent":return 39;case"TextureSolid":return 40;case"TextureDarkHorizontal":return 41;case"TextureDarkVertical":return 42;case"TextureDarkDiagonalDown":return 43;case"TextureDarkDiagonalUp":return 44;case"TextureDarkCross":return 45;case"TextureDarkDiagonalCross":return 46;case"TextureHorizontal":return 47;case"TextureVertical":return 48;case"TextureDiagonalDown":return 49;case"TextureDiagonalUp":return 50;case"TextureCross":return 51;case"TextureDiagonalCross":return 52}},e.prototype.getHeighTypeEnumValue=function(e){switch(e){case"AtLeast":return 0;case"Exactly":return 1;default:return 0}},e.prototype.getCellVerticalAlignmentEnumValue=function(e){switch(e){case"Top":return 0;case"Center":return 1;case"Bottom":return 2}},e.prototype.getListLevelPatternEnumValue=function(e){switch(e){case"None":return 0;case"Arabic":case"KanjiDigit":return 1;case"UpRoman":return 2;case"LowRoman":return 3;case"UpLetter":return 4;case"LowLetter":return 5;case"Ordinal":return 6;case"Number":return 7;case"OrdinalText":return 8;case"LeadingZero":return 9;case"Bullet":return 10;case"FarEast":return 11;case"Special":return 12}},e.prototype.getStyleTypeEnumValue=function(e){switch(e){case"Paragraph":return 0;case"Character":return 1;case"Table":return 2}},e.prototype.getProtectionTypeEnumValue=function(e){switch(e){case"NoProtection":return 0;case"ReadOnly":return 1;case"FormFieldsOnly":return 2;case"CommentsOnly":return 3;case"RevisionsOnly":return 4}},e.prototype.getRevisionTypeEnumValue=function(e){switch(e){case"Insertion":return 1;case"Deletion":return 2;case"MoveTo":return 3;case"MoveFrom":return 4}},e.prototype.getFootnoteTypeEnumValue=function(e){switch(e){case"Footnote":return 0;case"Endnote":return 1}},e.prototype.getFootnoteRestartIndexEnumValue=function(e){switch(e){case"DoNotRestart":return 0;case"RestartForEachSection":return 1;case"RestartForEachPage":return 2}},e.prototype.getFootEndNoteNumberFormatEnumValue=function(e){switch(e){case"Arabic":return 0;case"UpperCaseRoman":return 1;case"LowerCaseRoman":return 2;case"UpperCaseLetter":return 3;case"LowerCaseLetter":return 4}},e.prototype.getTextVerticalAlignmentEnumValue=function(e){switch(e){case"Top":return 0;case"Center":return 1;case"Bottom":return 2;default:return 0}},e.prototype.getShapeVerticalAlignmentEnumValue=function(e){switch(e){case"None":return 0;case"Top":return 1;case"Center":return 2;case"Bottom":return 3;case"Inline":return 4;case"Inside":return 5;case"Outside":return 6}},e.prototype.getShapeHorizontalAlignmentEnumValue=function(e){switch(e){case"None":return 0;case"Center":return 1;case"Inside":return 2;case"Left":return 3;case"Outside":return 4;case"Right":return 5}},e.prototype.getVerticalOriginEnumValue=function(e){switch(e){case"Paragraph":return 0;case"BottomMargin":return 1;case"InsideMargin":return 2;case"Line":return 3;case"Margin":return 4;case"OutsideMargin":return 5;case"Page":return 6;case"TopMargin":return 7}},e.prototype.getHorizontalOriginEnumValue=function(e){switch(e){case"Column":return 0;case"Character":return 1;case"InsideMargin":return 2;case"LeftMargin":return 3;case"Margin":return 4;case"OutsideMargin":return 5;case"Page":return 6;case"RightMargin":return 7}},e.prototype.getTableVerticalRelationEnumValue=function(e){switch(e){case"Paragraph":return 0;case"Margin":return 1;case"Page":return 2;default:return 0}},e.prototype.getTableHorizontalRelationEnumValue=function(e){switch(e){case"Column":return 0;case"Margin":return 1;case"Page":return 2;default:return 0}},e.prototype.getTableVerticalPositionEnumValue=function(e){switch(e){case"None":return 0;case"Top":return 1;case"Center":return 2;case"Bottom":return 3;case"Inside":return 4;case"Outside":return 5;default:return 0}},e.prototype.getTableHorizontalPositionEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Inside":return 2;case"Outside":return 3;case"Right":return 4;default:return 0}},e.prototype.getLineDashStyleEnumValue=function(e){switch(e){case"Solid":return 0;case"Dash":return 1;case"DashDot":return 2;case"DashDotDot":return 3;case"DashDotGEL":return 4;case"DashGEL":return 5;case"Dot":return 6;case"DotGEL":return 7;case"LongDashDotDotGEL":return 8;case"LongDashDotGEL":return 9;case"LongDashGEL":return 10}},e.prototype.getHorizontalPositionAbsEnumValue=function(e){switch(e){case"Left":return 0;case"Center":return 1;case"Right":return 2;case"Inside":return 3;case"Outside":return 4;default:return 0}},e.prototype.getTabJustificationEnumValue=function(e){switch(e){case"Left":return 0;case"Bar":return 1;case"Center":return 2;case"Decimal":return 3;case"List":return 4;case"Right":return 5}},e.prototype.getTabLeaderEnumValue=function(e){switch(e){case"None":return 0;case"Single":return 1;case"Dot":return 2;case"Hyphen":return 3;case"Underscore":return 4}},e.prototype.getTextFormFieldTypeEnumValue=function(e){switch(e){case"Text":return 0;case"Number":return 1;case"Date":return 2;case"Calculation":return 3}},e.prototype.getTextFormFieldFormatEnumValue=function(e){switch(e){case"None":return 0;case"FirstCapital":return 1;case"Lowercase":return 2;case"Uppercase":return 3;case"Titlecase":return 4;default:return 0}},e.prototype.getCheckBoxSizeTypeEnumValue=function(e){switch(e){case"Auto":return 0;case"Exactly":return 1}},e.prototype.getContentControlAppearanceEnumValue=function(e){switch(e){case"BoundingBox":return 1;case"Hidden":return 2;case"Tags":return 3;default:return 1}},e.prototype.getContentControlTypeEnumValue=function(e){switch(e){case"RichText":return 0;case"BuildingBlockGallery":return 1;case"CheckBox":return 2;case"ComboBox":return 3;case"Date":return 4;case"DropDownList":return 5;case"Group":return 6;case"Picture":return 7;case"RepeatingSection":return 8;case"Text":return 9}},e.prototype.getDateCalendarTypeEnumValue=function(e){switch(e){case"Gregorian":return 0;case"GregorianArabic":return 1;case"GregorianEnglish":return 2;case"GregorianMiddleEastFrench":return 3;case"GregorianTransliteratedEnglish":return 4;case"GregorianTransliteratedFrench":return 5;case"Hebrew":return 6;case"Hijri":return 7;case"Japan":return 8;case"Korean":return 9;case"Saka":return 10;case"Taiwan":return 11;case"Thai":return 12;default:return 0}},e.prototype.getDateStorageFormatEnumValue=function(e){switch(e){case"DateStorageDate":return 1;case"DateStorageDateTime":return 2;case"DateStorageText":return 3;default:return 0}},e.prototype.getTextWrappingStyleEnumValue=function(e){switch(e){case"Inline":return 0;case"InFrontOfText":return 1;case"Square":return 2;case"TopAndBottom":return 3;case"Behind":return 4;default:return 0}},e.prototype.getTextWrappingTypeEnumValue=function(e){switch(e){case"Both":return 0;case"Left":return 1;case"Right":return 2;case"Largest":return 3}},e.prototype.getCompatibilityModeEnumValue=function(e){switch(e){case"Word2013":return 0;case"Word2003":return 1;case"Word2007":return 2;case"Word2010":return 3}},e.prototype.getLineFormatTypeEnumValue=function(e){switch(e){case"Solid":return 0;case"Patterned":return 1;case"Gradient":return 2;case"None":return 3}},e.prototype.getAutoShapeTypeEnumValue=function(e){switch(e){case"Rectangle":return 1;case"RoundedRectangle":return 2;case"StraightConnector":return 3;default:return 1}},e.prototype.getFollowCharacterType=function(e){switch(e){case"Tab":return 0;case"Space":return 1;case"None":return 2}},e.prototype.destroy=function(){this.lists=void 0,this.images=void 0,this.endLine=void 0,this.startLine=void 0,this.endOffset=void 0,this.documentHelper=void 0},e}(),yd=function(){function e(e){this.documentHelper=e,this.optimizedHeightCollection={}}return e.prototype.getModuleName=function(){return"Optimized"},e.prototype.getkeyFromCharFormat=function(e){var t=e.fontFamily.toLocaleLowerCase();return e.bold&&(t+=";bold"),e.italic&&(t+=";italic"),t},e.prototype.getFontInfo=function(e){var t=sf.base.createElement("iframe");document.body.appendChild(t);sf.base.isNullOrUndefined(t.contentDocument)||(t.contentDocument.open(),t.contentDocument.write("<!DOCTYPE html><html><head></head><body></body></html>"),t.contentDocument.close());var i=document.createElement("div");i.setAttribute("style","position:absolute;top:-1000px;left:-1000px;opacity:0;font-size:0px;line-height:normal;");var r=1/window.devicePixelRatio;i.style.transform="scale("+r.toString()+","+r.toString()+")",i.innerHTML='<span class="e-de-font-info" style="font-size:0; font-family: '+e.fontFamily+'; display: inline-block;">m</span><span class="e-de-font-info" style="font-size:288pt; font-family: '+e.fontFamily+";"+(e.bold?"font-weight:bold;":"")+(e.italic?"font-style:italic;":"")+' display: inline-block;">m</span>',t.contentDocument.body.appendChild(i);var n=i.firstChild.offsetTop/i.lastChild.offsetHeight,o=parseFloat((i.lastChild.offsetHeight/288).toFixed(2));return document.body.removeChild(t),{HeightFactor:o,BaselineFactor:n}},e.prototype.getHeightInternal=function(e){var t=this.getkeyFromCharFormat(e);if(sf.base.isNullOrUndefined(this.optimizedHeightCollection[""+t])){var i=this.getFontInfo(e);return this.optimizedHeightCollection[""+t]=i,{Height:r=i.HeightFactor*e.fontSize,BaselineOffset:i.BaselineFactor*r}}var r,n=this.optimizedHeightCollection[""+t];return{Height:r=n.HeightFactor*e.fontSize,BaselineOffset:n.BaselineFactor*r}},e.prototype.destroy=function(){this.documentHelper=void 0,this.optimizedHeightCollection=void 0},e}(),vd=function(){function e(e){this.documentHelper=e}return e.prototype.getModuleName=function(){return"Regular"},e.prototype.getHeightInternal=function(e,t){var i,r,n=document.createElement("span");n.innerText="m";var o=sf.base.createElement("iframe");document.body.appendChild(o);sf.base.isNullOrUndefined(o.contentDocument)||(o.contentDocument.open(),o.contentDocument.write("<!DOCTYPE html><html><head></head><body></body></html>"),o.contentDocument.close()),this.applyStyle(n,e,t);var s=document.createElement("div");s.setAttribute("style","display:inline-block;position:absolute;");var a=document.createElement("div");a.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),s.appendChild(n),s.appendChild(a),o.contentDocument.body.appendChild(s),i=n.offsetHeight;var l=n.offsetTop;return r=a.offsetTop-l,document.body.removeChild(o),{Height:i,BaselineOffset:r}},e.prototype.applyStyle=function(e,t,i){if(!sf.base.isNullOrUndefined(e)&&!sf.base.isNullOrUndefined(t)){var r="white-space:nowrap;";sf.base.isNullOrUndefined(i)||""===i?r+="font-family:"+t.fontFamily+";":r+="font-family:"+i+";";var n=t.fontSize;n<=.5&&(n=.5),r+="font-size:"+n.toString()+"pt;",t.bold&&(r+="font-weight:bold;"),t.italic&&(r+="font-style:italic;"),e.setAttribute("style",r)}},e.prototype.destroy=function(){this.documentHelper=void 0},e}(),wd=function(){function e(e,t){this.width=e,this.height=t}return e.prototype.isEmpty=function(){return 0===this.height&&0===this.width},e.prototype.clone=function(){return new e(this.width,this.height)},e}(),bd=function(){function e(e,t){this.interval=4,this.segmentWidth=47.9988,this.orientation="Horizontal",this.tickAlignment="RightOrBottom",this.markerColor="red",this.thickness=15,this.arrangeTick=null,this.length=400,this.offset=0,this.scale=1,this.rulerStartValue=1584,this.zeroPosition=x.convertPointToPixel(1584),this.addSegmentWidth=!1,this.element=e,this.rulerHelper=t}return e.prototype.appendTo=function(){this.preRender(),this.render()},e.prototype.preRender=function(){this.unWireEvents(),this.wireEvents()},e.prototype.render=function(){this.updateRulerGeometry()},e.prototype.getModuleName=function(){return"Ruler"},e.prototype.destroy=function(){this.unWireEvents(),this.element.classList.remove("e-ruler")},e.prototype.showHideRuler=function(e){this.element.style.display=e?"block":"none"},e.prototype.updateRulerGeometry=function(){this.element.style.textAlign="left",this.renderRulerSpace(),this.updateRuler()},e.prototype.renderRulerSpace=function(){var e=this.getRulerGeometry(),t=document.getElementById(this.element.id+"_ruler_space");return t||(t=this.rulerHelper.createHtmlElement("div",{id:this.element.id+"_ruler_space",style:"height:"+e.height+"px;width:"+e.width+"px;cssFloat:left;"}),this.element.appendChild(t)),t},e.prototype.updateRuler=function(){var e=this.getRulerSize(),t=this.getRulerGeometry(),i=0,r=0,n=new wd,o=this.getRulerSVG(t);if(o&&(i=this.length,n.height=e,r=this.offset,i&&i!==1/0)){var s=i,a=r;this.updateSegments(a,s+Math.abs(a),o,e)}},e.prototype.updateSegments=function(e,t,i,r){var n=e,o={trans:0};for(this.rulerStartValue=x.convertPixelToPoint(this.zeroPosition);n<t;){var s=this.getNewSegment(n,i);s&&(i.appendChild(s.segment),n=this.updateSegment(e,t,s,n,o,r))}this.addSegmentWidth=!1},e.prototype.updateSegment=function(e,t,i,r,n,o){var s=this.updateSegmentWidth(this.scale);if(r===e)this.startValue=Math.floor(e/s)*s/this.scale,this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue,i.label.textContent=this.rulerStartValue.toString(),this.defStartValue=r=this.startValue*this.scale,"Horizontal"===this.orientation?this.hRulerOffset=e-r:this.vRulerOffset=e-r;else{this.startValue=x.convertPixelToPoint(r),this.startValue=this.startValue%1!=0?Number(this.startValue.toFixed(1)):this.startValue;var a=void 0;0==this.rulerStartValue&&(this.addSegmentWidth=!0),a=this.addSegmentWidth?Math.abs(this.rulerStartValue+36):Math.abs(this.rulerStartValue-36),i.label.textContent=a.toString(),this.rulerStartValue=a}this.updateTickLabel(i,o);var l="Horizontal"===this.orientation?n.trans+.5+",0.5":"0.5,"+(n.trans+.5);return i.segment.setAttribute("transform","translate("+l+") scale(1,1)"),n.trans+=s*this.scale,r+=s},e.prototype.updateTickLabel=function(e,t){var i=e.segment.lastChild.getBBox(),r="Horizontal"===this.orientation,n="RightOrBottom"===this.tickAlignment,o=r?-4:0,s=r?n?t/2+5.5-5.5:t/2+5.5:i.height;r&&(s+=2),r||(o+=10,s+=2);var a=n?-(i.width+2)+","+(t/2-i.height):-(i.width+2)+","+(t/2-i.height/2),l=r?{x:o,y:s}:{x:o,y:s,transform:"rotate(270)translate("+a+")"};this.rulerHelper.setAttributeSvg(e.segment.lastChild,l)},e.prototype.getNewSegment=function(e,t){var i=this.createNewTicks(e,t);return{segment:i,label:this.createTickLabel(t,i)}},e.prototype.createNewTicks=function(e,t){var i,r,n=this.updateSegmentWidth(this.scale),o=this.rulerHelper.createSvgElement("g",{class:"e-de-ruler-segment"}),s=this.rulerHelper.createSvgElement("rect",{class:"e-de-ruler-segment1"}),a="Horizontal"===this.orientation?n*this.scale:15,l="Horizontal"===this.orientation?15:n;s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("width",a.toString()),s.setAttribute("height",l.toString()),s.setAttribute("fill","lightgrey");for(var d=0;d<this.interval;d++)r=n/this.interval,(i=this.createTick(t,r,d+1,e))&&o.appendChild(i);return o},e.prototype.getLinePoint=function(e,t,i){var r=this.updateSegmentWidth(this.scale),n=this.getRulerSize();return i=(t*=i-1)%r==0?n:.3*n},e.prototype.createTick=function(e,t,i,r){var n,o=this.getLinePoint(e,t,i),s=this.getRulerSize(),a="Horizontal"===this.orientation,l="RightOrBottom"===this.tickAlignment,d=t*(i-1)*this.scale,h=a?d:l?s:0,c=a?d:l?s-o:s-(s-o),p=a?l?s:s-(s-o):d,g=a?l?s-o:0:d;if(0!==g){a||(h-=6,c-=6);var f={x1:h,y1:p-=6,x2:c,y2:g-=6,"stroke-width":"0.25",stroke:"black"};(n=this.rulerHelper.createSvgElement("line",f)).setAttribute("class","e-de-ruler-tick")}return n},e.prototype.createTickLabel=function(e,t){var i;if(t){i=this.rulerHelper.createSvgElement("text",{class:"e-de-ruler-tick-label",style:"font-weight: 400"}),t.appendChild(i)}return i},e.prototype.updateSegmentWidth=function(e){if(100!==this.segmentWidth)return this.segmentWidth;var t,i=1;for(t=100,t=100/Math.pow(2,Math.round(Math.log(e)/Math.log(2)));t>100;)i/=10,t/=10;for(;t<25;)i*=10,t*=10;return t>=25&&t%25!=0&&(t=25*Math.round(t/25)),t*e/i},e.prototype.createMarkerLine=function(e,t,i){var r;return t&&((r=e.getElementById(t.id+"_marker"))&&r.parentNode.removeChild(r),r=this.rulerHelper.createSvgElement("line",i)),r},e.prototype.drawRulerMarker=function(e,t,i){var r,n,o,s,a,l,d,h="Horizontal"===this.orientation,c=e.getElementsByTagName("svg");for(a=0;a<c.length;a++){c[parseInt(a.toString(),10)]&&(r=c[parseInt(a.toString(),10)]);break}if(r){n=this.getRulerSize(),l={id:e.id+"_marker",x1:0,y1:0,x2:h?0:n,y2:h?n:0,stroke:this.markerColor,"stroke-width":1.5,class:"e-d-ruler-marker"},d=this.createMarkerLine(r,e,l),o=this.scale,s=this.offset-this.defStartValue;var p=(h?t.x:t.y)*o+i+s;d.setAttribute("transform","translate("+(h?p+.5+" 0.5":"0.5 "+(p+.5))+")"),r.appendChild(d)}},e.prototype.getRulerGeometry=function(){return"Horizontal"===this.orientation?new wd(this.length,this.element?this.element.getBoundingClientRect().height:0):new wd(this.element?this.element.getBoundingClientRect().width:0,this.length)},e.prototype.getRulerSize=function(){return this.thickness},e.prototype.getRulerSVG=function(e){var t,i,r=this.getRulerSize();if(this.element&&(t=document.getElementById(this.element.id+"_ruler_space"))){var n={id:this.element.id+"_Ruler_svg",width:"Horizontal"===this.orientation?this.length:r+"px",height:"Horizontal"===this.orientation?r:e.height+"px",style:"position:inherit;"};if(i=this.rulerHelper.createSvgElement("svg",n),t.childNodes.length>0)for(var o=t.childNodes.length-1;o>=0;o--)t.childNodes[parseInt(o.toString(),10)].parentNode.removeChild(t.childNodes[parseInt(o.toString(),10)]);t.appendChild(i)}return i},e.prototype.wireEvents=function(){},e.prototype.unWireEvents=function(){},e}(),xd=function(){function e(e,t){this.width=e,this.height=t}return e.prototype.isEmpty=function(){return 0===this.height&&0===this.width},e.prototype.clone=function(){return new e(this.width,this.height)},e}(),Id=function(){function e(){}return e.prototype.hideTabStopSwitch=function(e){this.tabStopStwitch&&this.showHideElement(e,this.tabStopStwitch)},e.prototype.hideRulerBottom=function(e){this.hRulerBottom&&this.showHideElement(e,this.hRulerBottom),this.vRulerBottom&&this.showHideElement(e,this.vRulerBottom)},e.prototype.showHideElement=function(e,t){t.style.display=e?"block":"none"},e.prototype.createHtmlElement=function(e,t){var i=sf.base.createElement(e);return this.setAttributeHtml(i,t),i},e.prototype.createSvgElement=function(e,t){var i=document.createElementNS("http://www.w3.org/2000/svg",e);return this.setAttributeSvg(i,t),i},e.prototype.applyStyleAgainstCsp=function(e,t){for(var i=t.split(";"),r=0;r<i.length;r++){var n=i[parseInt(r.toString(),10)].split(":");2===n.length&&(e.style[n[0].trim()]=n[1].trim())}},e.prototype.setAttributeSvg=function(e,t){for(var i=Object.keys(t),r=0;r<i.length;r++)e&&"style"!==i[parseInt(r.toString(),10)]?e.setAttribute(i[parseInt(r.toString(),10)],t[i[parseInt(r.toString(),10)]]):this.applyStyleAgainstCsp(e,t[i[parseInt(r.toString(),10)]])},e.prototype.setAttributeHtml=function(e,t){for(var i=Object.keys(t),r=0;r<i.length;r++)"style"!==i[parseInt(r.toString(),10)]?e.setAttribute(i[parseInt(r.toString(),10)],t[i[parseInt(r.toString(),10)]]):this.applyStyleAgainstCsp(e,t[i[parseInt(r.toString(),10)]])},e.prototype.renderOverlapElement=function(e){var t=this.getRulerSize(e),i={id:e.element.id+"_overlapRuler",style:"height:"+t.height+"px;width:"+t.width+"px;position:absolute;margin-left:0;margin-top:0;diplay:none",class:"e-ruler-overlap"},r=this.createHtmlElement("div",i),n=e.element.getElementsByClassName("e-de-viewercontainer")[0];return n.insertBefore(r,n.firstChild),r},e.prototype.renderRulerMarkerIndicatorElement=function(e){if(e.enableSelection){var t=this.getRulerSize(e),i={id:e.element.id+"_markIndicator",style:"height:"+t.height+"px;width:"+t.width+"px;position:absolute;margin-left:0;margin-top:0;z-index:5;border:1px solid #ccc;display:"+("Pages"===e.layoutType?"block;":"none;"),class:"e-de-ruler-markIndicator"},r=this.createHtmlElement("div",i);this.tabStopStwitch=r;var n=e.element.getElementsByClassName("e-de-viewercontainer")[0];n.insertBefore(r,n.firstChild);var o=e.element.id,s=document.getElementById(o+"_firstLineIndent").cloneNode(!0),a=document.getElementById(o+"_hangingIndent").cloneNode(!0);s.style.left="1px",s.style.top=t.height/2-3+"px",s.style.display="none",s.classList.add("e-de-ruler-marker"),s.setAttribute("id",o+"_firstLineIndent_-1"),a.style.left="1px",a.style.top=t.height/2-3+"px",a.style.display="none",a.classList.add("e-de-ruler-marker"),a.setAttribute("id",o+"_hangingIndent_-1"),r.appendChild(a),r.appendChild(s);for(var l=["Left","Center","Right","Decimal","Bar"],d=0;d<5;d++){this.renderTab(e,t,void 0,l[parseInt(d.toString(),10)],-1);var h=document.getElementById(e.element.id+"_"+l[parseInt(d.toString(),10)]+"Tab_-1");sf.base.isNullOrUndefined(h)||(h.classList.remove("e-de-ruler-tab"),h.classList.add("e-de-ruler-marker"),h.style.display=0==d?"block":"none",h.style.position="absolute",h.style.margin="4px 3px",r.appendChild(h))}r.addEventListener("click",(function(e){for(var t=document.querySelector(".e-de-ruler-markIndicator"),i=0;i<t.childNodes.length;i++){var r=t.childNodes[parseInt(i.toString(),10)];if("block"===r.style.display){r.style.display="none";var n=(i+1)%t.childNodes.length;t.childNodes[parseInt(n.toString(),10)].style.display="block";break}}}))}},e.prototype.renderRuler=function(e,t){var i=this;if(e.enableSelection){var r=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler")),n=this.getRulerSize(e),o=this.getRulerGeometry(e),s=t?e.selection.end.paragraph.bodyWidget.page.boundingRectangle.x:e.selection.getPageTop(e.selection.end.paragraph.bodyWidget.page),a=t?"margin-left:"+s+"px;":"margin-top:"+s+"px;";if(e.selection.isForward?this.position=e.selection.start:this.position=e.selection.end,!r){var l="height:"+(t?n.height:o.height)+"px;overflow:hidden;width:"+(t?o.width:n.width)+"px;position:absolute;font-size:9px;text-align: left;z-index: 4;user-select:none;"+a,d={id:e.element.id+(t?"_hRuler":"_vRuler"),style:l,class:t?"e-de-hRuler":"e-de-vRuler"};r=this.createHtmlElement("div",d)}r.addEventListener("dblclick",(function(){e.showDialog("PageSetup")}));var h=e.documentHelper.pageContainer,c="height:"+(t?n.height:h.getBoundingClientRect().height)+"px;overflow:hidden;width:"+(t?h.getBoundingClientRect().width:n.width)+"px;position:absolute;z-index: 3;",p={id:e.element.id+(t?"_hRulerBottom":"_vRulerBottom"),style:c,class:t?"e-de-hRuler":"e-de-vRuler"},g=this.createHtmlElement("div",p);t?this.hRulerBottom=g:this.vRulerBottom=g;var f=e.documentHelper.viewerContainer;f.insertBefore(g,f.firstChild);var u=t?document.getElementById(e.element.id+"_hRulerBottom"):document.getElementById(e.element.id+"_vRulerBottom");u.insertBefore(r,u.firstChild),this.renderRulerMargins(e,t,r);var m=new bd(r,this);m.orientation=t?"Horizontal":"Vertical",this.updateMargin(m,e,t),m.length=2*m.zeroPosition,m.appendTo(),t?e.hRuler=m:e.vRuler=m,this.updateRulerPosition(e,t);var y=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler"));t?e.hRuler.element=y:e.vRuler.element=y,y&&(t?y.scrollLeft=m.zeroPosition-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin):y.scrollTop=m.zeroPosition-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.topMargin)),this.locale=new sf.base.L10n("documenteditor",e.defaultLocale),t&&this.renderIndents(e,t,n,o,this.locale);var v,w,b,I,F,C,W,k,S=!1,P=!1,N=void 0,O=!1,T=!1,H=document.getElementById(e.element.id+"_hRuler");if(t)document.addEventListener("mousemove",(function(t){if(!e.isDestroyed&&e.documentEditorSettings.showRuler){var r=H.getBoundingClientRect(),n=e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin*e.zoomFactor,o=x.convertPixelToPoint(r.width)-e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor,s=Math.round(t.clientX-r.left),a=x.convertPixelToPoint(s);if(!P)if(e.isOnIndent)H.style.cursor="default",H.hasAttribute("title")&&H.removeAttribute("title"),S=!1;else if(n-3<=a&&n+3>=a)"Pages"===e.layoutType&&(H.style.cursor="e-resize",H.setAttribute("title",e.localeKeys.DocumentEditor_LeftMargin),S=!0,N=!0);else if(o-3<=a&&o+3>=a)"Pages"===e.layoutType&&(H.style.cursor="e-resize",H.setAttribute("title",e.localeKeys.DocumentEditor_RightMargin),S=!0,N=!1);else if(e.selection.end.paragraph.bodyWidget.sectionFormat.columns.length>0){var l=e.selection.end.paragraph.bodyWidget.sectionFormat.columns;if("Pages"===e.layoutType)for(var d=1;d<=l.length;d++){var h=document.getElementById(e.element.id+"_hRuler_Margin"+d),c=h.getBoundingClientRect().left,p=h.getBoundingClientRect().width;if(c-3<=t.clientX&&c+3>=t.clientX){H.style.cursor="e-resize",v=h,H.setAttribute("title",e.localeKeys.DocumentEditor_LeftMargin),O=!0,S=!0;break}if(c+p-3<=t.clientX&&c+p+3>=t.clientX){H.style.cursor="e-resize",v=h,H.setAttribute("title",e.localeKeys.DocumentEditor_RightMargin),T=!0,S=!0;break}H.style.cursor="default",H.hasAttribute("title")&&H.removeAttribute("title"),O=!1,T=!1,S=!1}}else H.style.cursor="default",H.hasAttribute("title")&&H.removeAttribute("title"),S=!1;if(P){var g=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor,f=e.selection.sectionFormat.pageWidth,u=e.selection.sectionFormat.rightMargin,m=e.selection.paragraphFormat.rightIndent;m=m>0?m:0;var y=e.selection.paragraphFormat.firstLineIndent,w=e.selection.sectionFormat.leftMargin;y=y>=0?y:0;var W=e.selection.paragraphFormat.leftIndent;if(N){var k=g+x.convertPointToPixel(f-u-m-42-y-W)*e.zoomFactor,E=g;s+g>k?(s=k-g,a=x.convertPixelToPoint(s)):s+g<E&&(s=E-g,a=x.convertPixelToPoint(s))}else{var R=g+x.convertPointToPixel(w+W+y+42+m)*e.zoomFactor,U=g+x.convertPointToPixel(f)*e.zoomFactor;s+g>U?(s=U-g,a=x.convertPixelToPoint(s)):s+g<R&&(s=R-g,a=x.convertPixelToPoint(s))}C=a;var B=x.convertPixelToPoint(r.width)-e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor;e.selection.end.paragraph.bodyWidget.sectionFormat.numberOfColumns<=1&&i.resizeRulerMargins(N,b,I,B,H,a,!0,e);var L=document.getElementById(e.element.id+"_rightIndent");if(N){var A=a-b;L.style.left=F-x.convertPointToPixel(A)+"px"}else{A=a-b;L.style.left=F+x.convertPointToPixel(A)+"px"}var M=e.documentHelper.currentPage.boundingRectangle.x+s;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=M+"px"}}})),H.addEventListener("mouseenter",(function(e){sf.base.isNullOrUndefined(i.currentTabStopElement)||(i.currentTabStopElement.style.display="block")})),H.addEventListener("mouseleave",(function(e){sf.base.isNullOrUndefined(i.currentTabStopElement)||(i.currentTabStopElement.style.display="none")})),H.addEventListener("mousedown",(function(t){if(S&&!e.isTableMarkerDragging){P=!0,e.selection.end.paragraph.bodyWidget.sectionFormat.columns.length>0&&(O?w=v.getBoundingClientRect().left:T&&(w=v.getBoundingClientRect().left+v.getBoundingClientRect().width));var r=H.getBoundingClientRect();b=x.convertPixelToPoint(Math.round(t.clientX-r.left)),I=H.scrollLeft;var n=document.getElementById(e.element.id+"_rightIndent");F=x.getNumberFromString(n.style.left);var o=Math.round(t.clientX-r.left),s=e.documentHelper.currentPage.boundingRectangle.x+o,a=document.getElementById(e.element.id+"_hRuler_indicator_svg");a.style.left=s+"px",a.style.display="block"}var l=H.getBoundingClientRect();if(l.y+l.height/2<=t.clientY)if(W=t.clientX-H.getBoundingClientRect().left,"Pages"===e.layoutType){if(W=x.convertPixelToPoint(W-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin)*e.zoomFactor),i.position.paragraph.paragraphFormat.bidi){var d=sf.base.isNullOrUndefined(i.position.paragraph.absoluteXPosition)?i.position.paragraph.width:parseFloat(i.position.paragraph.absoluteXPosition.width.toString());d=x.convertPixelToPoint(d*e.zoomFactor),W=d-W}}else if("Continuous"===e.layoutType)if(i.position.paragraph.paragraphFormat.bidi){W=x.convertPixelToPoint(W-20);d=sf.base.isNullOrUndefined(i.position.paragraph.absoluteXPosition)?i.position.paragraph.width:parseFloat(i.position.paragraph.absoluteXPosition.width.toString());d=x.convertPixelToPoint(d*e.zoomFactor),W=d-W}else W=x.convertPixelToPoint(W-20)})),H.addEventListener("mouseup",(function(t){var r=document.getElementById(e.element.id+"_markIndicator"),n=H.getBoundingClientRect();if(n.y+n.height/2<=t.clientY){if(k=t.clientX-H.getBoundingClientRect().left,"Pages"===e.layoutType){if(k=x.convertPixelToPoint(k-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin)*e.zoomFactor),i.position.paragraph.paragraphFormat.bidi){var o=sf.base.isNullOrUndefined(i.position.paragraph.absoluteXPosition)?i.position.paragraph.width:parseFloat(i.position.paragraph.absoluteXPosition.width.toString());o=x.convertPixelToPoint(o*e.zoomFactor),k=o-k}}else if("Continuous"===e.layoutType)if(i.position.paragraph.paragraphFormat.bidi){k=x.convertPixelToPoint(k-20);o=sf.base.isNullOrUndefined(i.position.paragraph.absoluteXPosition)?i.position.paragraph.width:parseFloat(i.position.paragraph.absoluteXPosition.width.toString());o=x.convertPixelToPoint(o*e.zoomFactor),k=o-k}else k=x.convertPixelToPoint(k-20);var s=document.getElementById(e.element.id+"_rightIndent"),a=x.getNumberFromString(s.style.left);if(k>0&&k<a&&W==k&&!sf.base.isNullOrUndefined(r)){var l=r.querySelector('.e-de-ruler-marker[style*="display: block;"]');if(!sf.base.isNullOrUndefined(l)){k/=e.zoomFactor;var d=l.getAttribute("data-name");if("LeftTab"==d||"CenterTab"==d||"RightTab"==d||"DecimalTab"==d||"BarTab"==d){var h=new fl;h.position=k,h.tabJustification=i.getTabJustification(d),h.deletePosition=0,h.tabLeader="None",e.editor.onApplyParagraphFormat("tabStop",[h],!1,!1)}else if("FirstLineIndent"==d||"HangingIndent"==d){if("HangingIndent"==d){var c=e.selection.paragraphFormat.firstLineIndent,p=k+c,g=e.selection.start.paragraph.paragraphFormat.firstLineIndent;e.editor.onApplyParagraphFormat("firstLineIndent",g-p,!1,!1);var f=e.selection.start.paragraph.paragraphFormat.leftIndent+g;g-=p,e.editor.onApplyParagraphFormat("leftIndent",f-g,!1,!1,!0)}else e.editor.onApplyParagraphFormat("firstLineIndent",W,!1,!1)}}}}})),document.addEventListener("mouseup",(function(t){if(P&&!e.isTableMarkerDragging){H.getBoundingClientRect();var i=C;if(O||T){var r;r=t.clientX-w;for(var n=e.selection.end.paragraph.bodyWidget.sectionFormat.cloneFormat(),s=e.selection.sectionFormat.pageWidth-e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin-e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin,a=O?n.columns[0].space+x.convertPixelToPoint(r):n.columns[0].space-x.convertPixelToPoint(r),l=0;l<n.columns.length;l++){var d=n.columns[parseInt(l.toString(),10)];if(a>=0&&d.width>=36){var h=x.convertPointToPixel((s-x.convertPixelToPoint(a)*(n.numberOfColumns-1))/n.numberOfColumns);d.width=h,l<n.columns.length-1&&(d.space=a)}else d[0].space=d[1].space}e.editorModule.onApplySectionFormat(void 0,n),O=!1,T=!1}else if(N)e.hRuler.startMargin=i/e.zoomFactor,e.selection.sectionFormat.leftMargin=i/e.zoomFactor;else{var c=x.convertPixelToPoint(o.width)-i/e.zoomFactor;e.selection.sectionFormat.rightMargin=c}S=!1,P=!1,N=void 0,document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}}));var E,R,U=document.getElementById(e.element.id+"_vRuler"),B=!1;t||(document.addEventListener("mousemove",(function(t){if(!e.isDestroyed&&e.documentEditorSettings.showRuler){var r=U.getBoundingClientRect(),n=e.selection.end.paragraph.bodyWidget.sectionFormat.topMargin*e.zoomFactor,o=x.convertPixelToPoint(r.height)-e.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin*e.zoomFactor,s=x.convertPixelToPoint(Math.round(t.clientY-r.top)),a=Math.round(t.clientY-r.top);if(P||(n-3<=s&&n+3>=s?(U.style.cursor="n-resize",U.setAttribute("title",e.localeKeys.DocumentEditor_TopMargin),S=!0,B=!0):o-3<=s&&o+3>=s?(U.style.cursor="n-resize",U.setAttribute("title",e.localeKeys.DocumentEditor_BottomMargin),S=!0,B=!1):(U.style.cursor="default",U.hasAttribute("title")&&U.removeAttribute("title"),S=!1)),P){var l=x.convertPixelToPoint(Math.round(t.clientY-r.top)),d=x.convertPointToPixel(1584-e.selection.sectionFormat.topMargin)*e.zoomFactor,h=e.selection.sectionFormat.pageHeight,c=e.selection.sectionFormat.bottomMargin,p=e.selection.sectionFormat.topMargin;if(B){var g=d,f=d+x.convertPointToPixel(h-c-12)*e.zoomFactor;a+d>f?(a=f-d,l=x.convertPixelToPoint(a)):a+d<g&&(a=g-d,l=x.convertPixelToPoint(a))}else{var u=d+x.convertPointToPixel(p+12)*e.zoomFactor,m=d+x.convertPointToPixel(h)*e.zoomFactor;a+d>m?(a=m-d,l=x.convertPixelToPoint(a)):a+d<u&&(a=u-d,l=x.convertPixelToPoint(a))}var y=x.convertPixelToPoint(r.height)-e.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin*e.zoomFactor;i.resizeVRulerMargins(B,E,R,y,U,l,e);var v=e.documentHelper.currentPage.boundingRectangle.y*e.zoomFactor+a;document.getElementById(e.element.id+"_vRuler_indicator_svg").style.top=v+"px"}}})),U.addEventListener("mousedown",(function(t){if(S){P=!0;var i=U.getBoundingClientRect();E=x.convertPixelToPoint(Math.round(t.clientY-i.top)),R=U.scrollTop;var r=Math.round(t.clientY-i.top),n=document.getElementById(e.element.id+"_vRuler_indicator_svg"),o=e.documentHelper.currentPage.boundingRectangle.y*e.zoomFactor+r;n.style.top=o+"px",n.style.display="block"}})),document.addEventListener("mouseup",(function(t){if(P){var i=U.getBoundingClientRect(),r=x.convertPixelToPoint(Math.round(t.clientY-i.top));if(B)e.vRuler.startMargin=r/e.zoomFactor,e.selection.sectionFormat.topMargin=r/e.zoomFactor;else{var n=x.convertPixelToPoint(o.height)-r/e.zoomFactor;e.vRuler.endMargin=n,e.selection.sectionFormat.bottomMargin=n}S=!1,P=!1,document.getElementById(e.element.id+"_vRuler_indicator_svg").style.display="none",B=void 0}})))}},e.prototype.updateRulerPosition=function(e,t){var i=document.getElementById(e.element.id+(t?"_hRuler":"_vRuler"));t?e.hRuler.element=i:e.vRuler.element=i,i&&(i.scrollLeft=2112-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin))},e.prototype.updateIndicatorLines=function(e){var t=document.getElementById(e.element.id+"_hRuler_indicator_svg"),i=document.getElementById(e.element.id+"_hRuler_indicator"),r=document.getElementById(e.element.id+"_vRuler_indicator_svg"),n=document.getElementById(e.element.id+"_vRuler_indicator"),o=e.documentHelper.pageContainer.getBoundingClientRect(),s=o.height,a=o.width;t.style.height=s+"px",i.setAttribute("y2",""+s),r.style.width=a+"px",n.setAttribute("x2",""+a)},e.prototype.createIndicatorLines=function(e){if(e.enableSelection){var t=e.element.getElementsByClassName("e-de-viewercontainer")[0],i=e.documentHelper.pageContainer,r=(t.getBoundingClientRect(),i.getBoundingClientRect()),n=r.height,o=r.width,s=document.getElementById(e.element.id+"_hRuler"),a={id:e.element.id+"_hRuler_indicator_svg",width:"0.5px",height:n+"px",style:"position:absolute;z-index:1;display:none;"},l=this.createSvgElement("svg",a),d={x1:0,y1:s.getBoundingClientRect().height+5,x2:0,y2:n,"stroke-width":.5,stroke:"black"},h=this.createSvgElement("line",d);h.setAttribute("id",e.element.id+"_hRuler_indicator"),l.appendChild(h),t.insertBefore(l,t.firstChild);var c=document.getElementById(e.element.id+"_vRuler"),p={id:e.element.id+"_vRuler_indicator_svg",width:o+"px",height:"0.5px",style:"position:absolute;z-index:1;display:none;"},g=this.createSvgElement("svg",p),f={x1:c.getBoundingClientRect().width+5,y1:0,x2:o,y2:0,"stroke-width":.5,stroke:"black"},u=this.createSvgElement("line",f);u.setAttribute("id",e.element.id+"_vRuler_indicator"),g.appendChild(u),t.insertBefore(g,t.firstChild)}},e.prototype.updateIndentMarkers=function(e){if(!(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.element)||sf.base.isNullOrUndefined(e.element.id)||sf.base.isNullOrUndefined(e.hRuler)||sf.base.isNullOrUndefined(e.hRuler.zeroPosition))){var t=void 0,i=e.element.id,r=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin),n=this.getRulerGeometry(e);if(this.position.paragraph.paragraphFormat.bidi||this.position.paragraph.isInsideTable&&this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi)r-=n.width/e.zoomFactor-x.convertPointToPixel(this.position.paragraph.bodyWidget.sectionFormat.rightMargin+this.position.paragraph.bodyWidget.sectionFormat.leftMargin);var o,s=sf.base.isNullOrUndefined(this.position.paragraph.absoluteXPosition)?this.position.paragraph.x:parseFloat(this.position.paragraph.absoluteXPosition.x.toString()),a=sf.base.isNullOrUndefined(this.position.paragraph.absoluteXPosition)?this.position.paragraph.width:parseFloat(this.position.paragraph.absoluteXPosition.width.toString());this.position.paragraph.paragraphFormat.bidi&&(r=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin)));var l=document.getElementById(e.element.id+"_leftIndent"),d=document.getElementById(e.element.id+"_rightIndent");this.position.paragraph.paragraphFormat.bidi?(l.setAttribute("title",e.localeKeys.DocumentEditor_RightIndent),d.setAttribute("title",e.localeKeys.DocumentEditor_LeftIndent),o=r+s+a):(l.setAttribute("title",e.localeKeys.DocumentEditor_LeftIndent),d.setAttribute("title",e.localeKeys.DocumentEditor_RightIndent),o=r+s);var h=this.position.paragraph.paragraphFormat.firstLineIndent;t=document.getElementById(i+"_leftIndent"),sf.base.isNullOrUndefined(t)||("Pages"===e.layoutType?t.style.left=o*e.zoomFactor-6+"px":"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(o=(r=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width)+s+a,t.style.left=o+"px"):(o=(r=e.hRuler.zeroPosition*e.zoomFactor-20)+s*e.zoomFactor,t.style.left=o+"px"))),t=document.getElementById(i+"_hangingIndent"),sf.base.isNullOrUndefined(t)||("Pages"===e.layoutType?t.style.left=o*e.zoomFactor-6+"px":"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(o=(r=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width)+s+a,t.style.left=o+"px"):(o=(r=e.hRuler.zeroPosition*e.zoomFactor-20)+s*e.zoomFactor,t.style.left=o+"px"))),t=document.getElementById(i+"_firstLineIndent"),"Pages"===e.layoutType?sf.base.isNullOrUndefined(t)||(this.position.paragraph.paragraphFormat.bidi?t.style.left=(o-x.convertPointToPixel(h))*e.zoomFactor-6+"px":t.style.left=(o+x.convertPointToPixel(h))*e.zoomFactor-6+"px"):"Continuous"===e.layoutType&&(o=this.position.paragraph.paragraphFormat.bidi?(r=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width)+s+a-x.convertPointToPixel(h)*e.zoomFactor:(r=e.hRuler.zeroPosition*e.zoomFactor-20)+(s+x.convertPointToPixel(h))*e.zoomFactor,t.style.left=o+"px"),t=document.getElementById(i+"_rightIndent"),"Pages"===e.layoutType?(o=this.position.paragraph.paragraphFormat.bidi?r+s:r+s+a,sf.base.isNullOrUndefined(t)||(t.style.left=o*e.zoomFactor-6+"px")):"Continuous"===e.layoutType&&(this.position.paragraph.paragraphFormat.bidi?(o=(r=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor)+s,t.style.left=o+"px"):(o=(r=e.hRuler.zeroPosition*e.zoomFactor-20)+(s+a)*e.zoomFactor,t.style.left=o+"px"))}},e.prototype.updateTabStopMarkers=function(e){if(!(sf.base.isNullOrUndefined(e)||sf.base.isNullOrUndefined(e.element)||sf.base.isNullOrUndefined(e.element.id)||sf.base.isNullOrUndefined(e.hRuler)||sf.base.isNullOrUndefined(e.hRuler.zeroPosition))){var t=e.element.id;document.getElementById(t+"_markIndicator").style.display="Pages"===e.layoutType?"block":"none";for(var i=this.position.paragraph.paragraphFormat.tabs,r=e.zoomFactor,n=this.getRulerSize(e),o=x.convertNodeListToArray(document.querySelectorAll(".e-de-ruler-tab")),s=0;s<i.length;s++){var a=i[parseInt(s.toString(),10)],l=a.tabJustification,d=e.element.id+"_"+l+"Tab_"+s.toString(),h=document.getElementById(d);if(sf.base.isNullOrUndefined(h))"List"!==l&&this.renderTab(e,n,a,l,s);else{!sf.base.isNullOrUndefined(o)&&o.length>0&&o.splice(o.indexOf(h),1);var c=this.position.paragraph.paragraphFormat.bidi?x.convertPointToPixel(1584-a.position):x.convertPointToPixel(1584+a.position);h.style.left="Center"===l||"Decimal"===l?c*r-4+"px":"Right"===l?c*r-5.5+"px":c*r-1.5+"px"}}if(!sf.base.isNullOrUndefined(o))for(s=0;s<o.length;s++){var p=o[parseInt(s.toString(),10)];sf.base.isNullOrUndefined(p)||p.parentNode.removeChild(p)}}},e.prototype.renderRulerMargins=function(e,t,i){var r,n=this.getRulerSize(e),o=this.getRulerGeometry(e),s=(t?e.selection.end.paragraph.bodyWidget.page.boundingRectangle.x:(e.selection.end.paragraph.bodyWidget.page.boundingRectangle.y,n.height),2112*e.zoomFactor),a=t?"margin-left:"+s+"px;":"margin-top:"+s+"px;",l=t?n.height:o.height-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.topMargin+e.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin)*e.zoomFactor;if(t)for(var d=1;d<=13;d++){if(!(r=document.getElementById(e.element.id+"_hRuler_Margin"+d))){var h="height:"+l+"px;overflow:hidden;width:"+(o.width-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin+e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin)*e.zoomFactor)+"px;position:absolute;font-size:9px;text-align: left;z-index: -1;display: block"+a,c={id:e.element.id+"_hRuler_Margin"+d,style:h,class:"e-de-ruler-margin"};r=this.createHtmlElement("div",c)}i.appendChild(r)}else{if(!r){r=document.getElementById(e.element.id+"_vRuler_Margin");h="height:"+l+"px;overflow:hidden;width:"+n.width+"px;position:absolute;font-size:9px;text-align: left;z-index: -1;"+a,c={id:e.element.id+"_vRuler_Margin",style:h,class:"e-de-ruler-margin"};r=this.createHtmlElement("div",c)}i.appendChild(r)}},e.prototype.updateRulerMargins=function(e){var t=this.getRulerGeometry(e),i=e.hRuler.zeroPosition*e.zoomFactor;this.updateHorizontalRulerMargin(e);var r=document.getElementById(e.element.id+"_vRuler_Margin"),n=t.height-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin*e.zoomFactor+e.selection.end.paragraph.bodyWidget.sectionFormat.topMargin*e.zoomFactor);r.style.marginTop=i+"px",r.style.height=n+"px"},e.prototype.updateHorizontalRulerMargin=function(e){var t=e.selection.end.paragraph.bodyWidget.sectionFormat.columns,i=e.hRuler.zeroPosition*e.zoomFactor,r=!1,n=this.position.paragraph.paragraphFormat.bidi,o=!1,s=x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin-72),a=x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin-72);this.position.paragraph.isInsideTable&&(o=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi);var l=this.getRulerGeometry(e).width-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor+e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin*e.zoomFactor);(n||o)&&(i=e.hRuler.zeroPosition*e.zoomFactor-l);for(var d=0;d<13;d++){var h=document.getElementById(e.element.id+"_hRuler_Margin"+(d+1));if(h)if(0===t.length&&!r||"Continuous"===e.layoutType&&!r){if(n||o){var c=e.hRuler.zeroPosition*e.zoomFactor-l;h.style.marginLeft=c+"px"}else h.style.marginLeft=i+"px";if(h.style.display="block","Continuous"===e.layoutType){var p=sf.base.isNullOrUndefined(this.position.paragraph.absoluteXPosition)?this.position.paragraph.width:parseFloat(this.position.paragraph.absoluteXPosition.width.toString());h.style.width=p*e.zoomFactor+"px"}else h.style.width=l+"px";r=!0}else t.length>=d+1&&"Pages"===e.layoutType?(h.style.marginLeft=i+"px",i-=(s+a)/t.length*e.zoomFactor,i+=(t[parseInt(d.toString(),10)].width+t[parseInt(d.toString(),10)].space)*e.zoomFactor,h.style.display="block",h.style.width=(t[parseInt(d.toString(),10)].width-(s+a)/t.length)*e.zoomFactor+"px"):h.style.display="none"}},e.prototype.resizeVRulerMargins=function(e,t,i,r,n,o,s){var a=document.getElementById(s.element.id+"_vRuler_Margin"),l=this.getRulerGeometry(s);if(e)a.style.height=(l.height-x.convertPointToPixel(s.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin*s.zoomFactor+o)).toString()+"px",n.scrollTop=t<o?i-x.convertPointToPixel(o-t):i+x.convertPointToPixel(t-o);else{var d=x.convertPixelToPoint(l.height)-o;a.style.height=(l.height-x.convertPointToPixel(s.selection.end.paragraph.bodyWidget.sectionFormat.topMargin*s.zoomFactor+d)).toString()+"px"}},e.prototype.resizeRulerMargins=function(e,t,i,r,n,o,s,a){var l=document.getElementById(a.element.id+(s?"_hRuler_Margin1":"_vRuler_Margin")),d=this.getRulerGeometry(a);if(!sf.base.isNullOrUndefined(e)&&e)l.style.width=(d.width-x.convertPointToPixel(a.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin*a.zoomFactor+o)).toString()+"px",n.scrollLeft=t<o?i-x.convertPointToPixel(o-t):i+x.convertPointToPixel(t-o);else{var h=x.convertPixelToPoint(d.width)-o;l.style.width=(d.width-x.convertPointToPixel(a.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin*a.zoomFactor+h)).toString()+"px"}},e.prototype.getRulerOrigin=function(){x.convertPointToPixel(1584)},e.prototype.renderIndents=function(e,t,i,r,n){var o=this,s=document.getElementById(e.element.id+"_hRuler"),a=document.getElementById(e.element.id+"_firstLineIndent");if(!a){var l="left:"+(x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin)-6)*e.zoomFactor+"px;",d="height:"+(i.height-3)/2+"px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;"+l,h={id:e.element.id+"_firstLineIndent",style:d,"data-name":"FirstLineIndent",class:"e-de-ruler-indent"};(a=this.createHtmlElement("div",h)).setAttribute("title",e.localeKeys.DocumentEditor_FirstLineIndent);var c=void 0,p={id:e.element.id+"_firstLineIndent_svg",width:i.width+"px",height:(i.height-3)/2+"px",style:"position:inherit;left:0px"};(c=this.createSvgElement("svg",p)).setAttribute("fill","none");var g={style:"position:inherit;left:0px"};(A=this.createSvgElement("path",g)).setAttribute("class","e-de-ruler-indent-svg"),A.setAttribute("d","M 0.5 0.5 H 11.5 V 2.7128 L 6 5.4211 L 0.5 2.7128 V 0.5 Z"),A.setAttribute("fill","white"),A.setAttribute("stroke","#A1A1A1"),c.appendChild(A),a.appendChild(c),s.append(a),a.addEventListener("dblclick",(function(t){e.showDialog("Paragraph"),t.stopPropagation()}));var f,u=!1,m=x.getNumberFromString(a.style.left);x.getNumberFromString(a.style.left);a.addEventListener("mouseenter",(function(t){e.isOnIndent=!0})),a.addEventListener("mouseleave",(function(t){e.isOnIndent=!1})),a.addEventListener("mousedown",(function(t){u=!0,f=t.clientX-a.getBoundingClientRect().left,m=x.getNumberFromString(a.style.left);var i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor;e.selection.paragraphFormat.bidi&&(i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor),"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20,e.selection.paragraphFormat.bidi&&(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor));var r=i+t.clientX-f-s.getBoundingClientRect().left,n=e.documentHelper.currentPage.boundingRectangle.x,o=(n="Continuous"===e.layoutType?0:n)+(r-i)+6,l=document.getElementById(e.element.id+"_hRuler_indicator_svg");l.style.left=o+"px",l.style.display="block",t.stopPropagation()})),document.addEventListener("mousemove",(function(t){if(u){var i=void 0,r=void 0,n=void 0,l=document.getElementById(e.element.id+"_rightIndent"),d=x.getNumberFromString(l.style.left);"Pages"===e.layoutType?e.selection.paragraphFormat.bidi?(r=(i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor)-6+x.convertPointToPixel(e.selection.sectionFormat.pageWidth)*e.zoomFactor,n=d+x.convertPointToPixel(42)*e.zoomFactor):(n=(i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor)-6,r=d-x.convertPointToPixel(42)*e.zoomFactor):"Continuous"===e.layoutType&&(o.position.paragraph.paragraphFormat.bidi?(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor,r=e.hRuler.zeroPosition*e.zoomFactor-20+40-6,n=d+x.convertPointToPixel(42)*e.zoomFactor):(n=(i=e.hRuler.zeroPosition*e.zoomFactor-20)-6,r=d-x.convertPointToPixel(42)*e.zoomFactor));var h=i+t.clientX-f-s.getBoundingClientRect().left;h<n?h=n:h>r&&(h=r),a.style.left=h+"px";var c=e.documentHelper.currentPage.boundingRectangle.x,p=(c="Continuous"===e.layoutType?0:c)+(h-i)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=p+"px"}})),document.addEventListener("mouseup",(function(){if(u){u=!1;var t=x.getNumberFromString(a.style.left);parseInt(a.style.left.replace("px",""))<0&&(t*=-1),e.selection.paragraphFormat.bidi?e.editor.applyRulerMarkerValues("firstLineIndent",t,m):e.editor.applyRulerMarkerValues("firstLineIndent",m,t),m=t,document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}}))}var y=document.getElementById(e.element.id+"_hangingIndent");if(!y){l="left:"+(x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin)-6)+"px;",d="height:"+i.height/2+"px;top:"+((i.height-3)/2+1)+"px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;"+l,h={id:e.element.id+"_hangingIndent",style:d,"data-name":"HangingIndent",class:"e-de-ruler-indent"};(y=this.createHtmlElement("div",h)).setAttribute("title",e.localeKeys.DocumentEditor_HangingIndent);var v=void 0;p={id:e.element.id+"_hangingIndent_svg",width:i.width+"px",height:(i.height-3)/2+"px",style:"position:inherit;left:0px"};(v=this.createSvgElement("svg",p)).setAttribute("fill","none");g={style:"position:inherit;left:0px"};(A=this.createSvgElement("path",g)).setAttribute("class","e-de-ruler-indent-svg"),A.setAttribute("d","M 0.5 5.3211 H 11.5 V 3.1083 L 6 0.4 L 0.5 3.1083 V 5.3211 Z"),A.setAttribute("fill","white"),A.setAttribute("stroke","#A1A1A1"),v.appendChild(A),y.appendChild(v),s.append(y),y.addEventListener("dblclick",(function(t){e.showDialog("Paragraph"),t.stopPropagation()}));var w,b,I,F,C=!1,W=x.getNumberFromString(y.style.left);x.getNumberFromString(y.style.left);y.addEventListener("mouseenter",(function(t){e.isOnIndent=!0})),y.addEventListener("mouseleave",(function(t){e.isOnIndent=!1})),y.addEventListener("mousedown",(function(t){C=!0,w=t.clientX-y.getBoundingClientRect().left,W=x.getNumberFromString(y.style.left);var i,r=document.getElementById(e.element.id+"_rightIndent"),n=x.getNumberFromString(r.style.left);"Pages"===e.layoutType?e.selection.paragraphFormat.bidi?(i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor,b=n+x.convertPointToPixel(42)*e.zoomFactor,I=i-6+x.convertPointToPixel(e.selection.sectionFormat.pageWidth)*e.zoomFactor):(i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor,b=i-6,I=n-x.convertPointToPixel(42)*e.zoomFactor):"Continuous"===e.layoutType&&(o.position.paragraph.paragraphFormat.bidi?(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor,I=e.hRuler.zeroPosition*e.zoomFactor-20+40-6,b=n+x.convertPointToPixel(42)*e.zoomFactor):(i=e.hRuler.zeroPosition*e.zoomFactor-20,b=i-6,I=n-x.convertPointToPixel(42)*e.zoomFactor)),F=document.getElementById(e.element.id+"_leftIndent");var a=i+t.clientX-w-s.getBoundingClientRect().left,l=e.documentHelper.currentPage.boundingRectangle.x,d=(l="Continuous"===e.layoutType?0:l)+(a-i)+6,h=document.getElementById(e.element.id+"_hRuler_indicator_svg");h.style.left=d+"px",h.style.display="block",t.stopPropagation()})),document.addEventListener("mousemove",(function(t){if(C){var i=void 0;"Pages"===e.layoutType?i=e.selection.paragraphFormat.bidi?x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor:x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor:"Continuous"===e.layoutType&&(i=o.position.paragraph.paragraphFormat.bidi?e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor:e.hRuler.zeroPosition*e.zoomFactor-20);var r=i+t.clientX-w-s.getBoundingClientRect().left;r>I?r=I:r<b&&(r=b),F.style.left=r+"px",y.style.left=r+"px";var n=e.documentHelper.currentPage.boundingRectangle.x,a=(n="Continuous"===e.layoutType?0:n)+(r-i)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=a+"px"}})),document.addEventListener("mouseup",(function(){if(C){C=!1;var t=x.getNumberFromString(y.style.left);parseInt(y.style.left.replace("px",""))<0&&(t*=-1),e.selection.paragraphFormat.bidi?e.editor.applyRulerMarkerValues("hangingIndent",t,W):e.editor.applyRulerMarkerValues("hangingIndent",W,t),W=t,document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}}))}var k=document.getElementById(e.element.id+"_leftIndent");if(!k){d="height:4px;top:11px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 5;"+(l="left:"+(x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin)-6)+"px;"),h={id:e.element.id+"_leftIndent",style:d,class:"e-de-ruler-indent"};(k=this.createHtmlElement("div",h)).setAttribute("title",e.localeKeys.DocumentEditor_LeftIndent);var S=void 0;p={id:e.element.id+"_leftIndent_svg",width:i.width+"px",height:"4px",style:"position:inherit;left:0px"};(S=this.createSvgElement("svg",p)).setAttribute("fill","none");g={style:"position:inherit;left:0px"};(A=this.createSvgElement("path",g)).setAttribute("class","e-de-ruler-indent-svg"),A.setAttribute("d","M 0.5 3.5 H 11.5 V 0.5 H 0.5 V 3.5 Z"),A.setAttribute("fill","white"),A.setAttribute("stroke","#A1A1A1"),S.appendChild(A),k.appendChild(S),s.append(k),k.addEventListener("dblclick",(function(t){e.showDialog("Paragraph"),t.stopPropagation()}));var P,N,O,T,H,E,R=!1,U=x.getNumberFromString(k.style.left);x.getNumberFromString(k.style.left);k.addEventListener("mouseenter",(function(t){e.isOnIndent=!0})),k.addEventListener("mouseleave",(function(t){e.isOnIndent=!1})),k.addEventListener("mousedown",(function(t){var i;R=!0,P=t.clientX-k.getBoundingClientRect().left,U=x.getNumberFromString(k.style.left),N=x.getNumberFromString(a.style.left),O=N-U,a=document.getElementById(e.element.id+"_firstLineIndent");var r=document.getElementById(e.element.id+"_rightIndent"),n=x.getNumberFromString(r.style.left);"Pages"===e.layoutType?e.selection.paragraphFormat.bidi?(i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor,T=n+x.convertPointToPixel(42)*e.zoomFactor,H=i-6+x.convertPointToPixel(e.selection.sectionFormat.pageWidth)*e.zoomFactor,E=x.getNumberFromString(y.style.left)-n<=x.getNumberFromString(a.style.left)-n):(i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor,T=i-6,H=n-x.convertPointToPixel(42)*e.zoomFactor,E=n-x.getNumberFromString(y.style.left)<=n-x.getNumberFromString(a.style.left)):"Continuous"===e.layoutType&&(o.position.paragraph.paragraphFormat.bidi?(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor,H=e.hRuler.zeroPosition*e.zoomFactor-20+40-6,T=n+x.convertPointToPixel(42)*e.zoomFactor,E=x.getNumberFromString(y.style.left)-n<=x.getNumberFromString(a.style.left)-n):(i=e.hRuler.zeroPosition*e.zoomFactor-20,T=i-6,H=n-x.convertPointToPixel(42)*e.zoomFactor,E=n-x.getNumberFromString(y.style.left)<=n-x.getNumberFromString(a.style.left)));var l=i+t.clientX-P-s.getBoundingClientRect().left,d=e.documentHelper.currentPage.boundingRectangle.x,h=(d="Continuous"===e.layoutType?0:d)+(l-i)+6,c=document.getElementById(e.element.id+"_hRuler_indicator_svg");c.style.left=h+"px",c.style.display="block",t.stopPropagation()})),document.addEventListener("mousemove",(function(t){if(R){var i=void 0,r=void 0;e.selection.paragraphFormat.bidi?("Pages"===e.layoutType?i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor:"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor),r=i+t.clientX-P-s.getBoundingClientRect().left,E?r+O>H&&(r=H-O):r>H&&(r=H),E?r<T&&(r=T):r+O<T&&(r=T-O)):("Pages"===e.layoutType?i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor:"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20),r=i+t.clientX-P-s.getBoundingClientRect().left,E?r>H&&(r=H):r+O>H&&(r=H-O),E?r+O<T&&(r=T-O):r<T&&(r=T)),y.style.left=r+"px",k.style.left=r+"px",a.style.left=N+(r-U)+"px";var n=e.documentHelper.currentPage.boundingRectangle.x,o=(n="Continuous"===e.layoutType?0:n)+(r-i)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=o+"px"}})),document.addEventListener("mouseup",(function(){if(R){R=!1;var t=x.getNumberFromString(k.style.left);parseInt(k.style.left.replace("px",""))<0&&(t*=-1),e.selection.paragraphFormat.bidi?e.editor.applyRulerMarkerValues("leftIndent",t,U):e.editor.applyRulerMarkerValues("leftIndent",U,t),U=t,document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}}))}var B=document.getElementById(e.element.id+"_rightIndent");if(!B){d="height:7px;top:8px;overflow:hidden;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+(l="left:"+(e.selection.end.paragraph.bodyWidget.page.boundingRectangle.width-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin)-6)+"px;"),h={id:e.element.id+"_rightIndent",style:d,class:"e-de-ruler-indent"};(B=this.createHtmlElement("div",h)).setAttribute("title",e.localeKeys.DocumentEditor_RightIndent);var L=void 0;p={id:e.element.id+"_rightIndent_svg",width:i.width+"px",height:"7px",style:"position:inherit;left:0px"};(L=this.createSvgElement("svg",p)).setAttribute("fill","none");var A;g={style:"position:inherit;left:0px"};(A=this.createSvgElement("path",g)).setAttribute("class","e-de-ruler-indent-svg"),A.setAttribute("d","M 0.5 6.5 H 11.5 V 4.2872 L 6 1.5789 L 0.5 4.2872 V 6.5 Z"),A.setAttribute("fill","white"),A.setAttribute("stroke","#A1A1A1"),L.appendChild(A),B.appendChild(L),s.append(B),B.addEventListener("dblclick",(function(t){e.showDialog("Paragraph"),t.stopPropagation()}));var M,z=!1,D=x.getNumberFromString(B.style.left);x.getNumberFromString(B.style.left);B.addEventListener("mouseenter",(function(t){e.isOnIndent=!0})),B.addEventListener("mouseleave",(function(t){e.isOnIndent=!1})),B.addEventListener("mousedown",(function(t){z=!0,M=t.clientX-B.getBoundingClientRect().left,D=x.getNumberFromString(B.style.left);var i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor;e.selection.paragraphFormat.bidi&&(i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor),"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20,e.selection.paragraphFormat.bidi&&(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor));var r=i+t.clientX-M-s.getBoundingClientRect().left,n=e.documentHelper.currentPage.boundingRectangle.x,o=(n="Continuous"===e.layoutType?0:n)+(r-i)+6,a=document.getElementById(e.element.id+"_hRuler_indicator_svg");a.style.left=o+"px",a.style.display="block",t.stopPropagation()})),document.addEventListener("mousemove",(function(t){if(z){var i=void 0,r=void 0,n=document.getElementById(e.element.id+"_leftIndent"),o=document.getElementById(e.element.id+"_firstLineIndent"),a=void 0,l=void 0;if(e.selection.paragraphFormat.bidi){"Pages"===e.layoutType?i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin-(e.selection.sectionFormat.pageWidth-e.selection.sectionFormat.leftMargin-e.selection.sectionFormat.rightMargin))*e.zoomFactor:"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor),r=i+t.clientX-M-s.getBoundingClientRect().left;var d=x.getNumberFromString(n.style.left)-r<=x.getNumberFromString(o.style.left)-r?n:o;a=(h=x.getNumberFromString(d.style.left))-x.convertPointToPixel(42)*e.zoomFactor,l=i-6}else{"Pages"===e.layoutType?i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor:"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20);d=(r=i+t.clientX-M-s.getBoundingClientRect().left)-x.getNumberFromString(n.style.left)<=r-x.getNumberFromString(o.style.left)?n:o;var h=x.getNumberFromString(d.style.left);a=i+e.documentHelper.currentPage.boundingRectangle.width*e.zoomFactor-6,l=h+x.convertPointToPixel(42)*e.zoomFactor}r<l?r=l:r>a&&(r=a),B.style.left=r+"px";var c=e.documentHelper.currentPage.boundingRectangle.x,p=(c="Continuous"===e.layoutType?0:c)+(r-i)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=p+"px"}})),document.addEventListener("mouseup",(function(){if(z){z=!1;var t=x.getNumberFromString(B.style.left);e.selection.paragraphFormat.bidi?e.editor.applyRulerMarkerValues("rightIndent",D,t):e.editor.applyRulerMarkerValues("rightIndent",t,D),D=t,document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}}))}this.updateIndentMarkers(e)},e.prototype.updateRuler=function(e,t){if(!(e.rulerHelper&&e.documentEditorSettings&&!e.documentEditorSettings.showRuler||e.isReadOnlyMode)){sf.base.isNullOrUndefined(e.hRuler)&&sf.base.isNullOrUndefined(e.vRuler)||(e.selection.isForward?this.position=e.selection.start:this.position=e.selection.end,this.updateRulerDimension(e,e.hRuler,0,t),this.updateRulerDimension(e,e.vRuler,0,t),this.updateRulerMargins(e),this.updateIndentMarkers(e),this.updateTabStopMarkers(e),this.position.paragraph.isInsideTable?this.updateTableMarkers(e,e.hRuler):this.removeTableMarkers(e,e.hRuler),this.updateIndicatorLines(e))}},e.prototype.removeTableMarkers=function(e,t){var i=x.convertNodeListToArray(document.querySelectorAll(".e-de-ruler-table-marker"));if(!sf.base.isNullOrUndefined(i))for(var r=0;r<i.length;r++){var n=i[parseInt(r.toString(),10)];sf.base.isNullOrUndefined(n)||n.parentNode.removeChild(n)}},e.prototype.updateTableMarkers=function(e,t){var i=x.convertNodeListToArray(document.querySelectorAll(".e-de-ruler-table-marker"));(sf.base.isNullOrUndefined(i)||this.position.paragraph.isInsideTable)&&this.renderTableMarkers(e,t)},e.prototype.renderTableMarkers=function(e,t){var i=this;this.removeTableMarkers(e,e.hRuler);this.position.paragraph.containerWidget.ownerTable;var r,n=this.position.paragraph.associatedCell.ownerRow.clone().childWidgets,o=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi?n.length:0;this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi&&n.reverse();for(var s=document.getElementById(e.element.id+"_hRuler"),a=function(a){var d=document.getElementById(e.element.id+"_tableMarker_"+o),h=void 0;h=0==a?"left:"+((r=(n[parseInt(a.toString(),10)].x-n[parseInt(a.toString(),10)].margin.left)*e.zoomFactor+s.scrollLeft)-4)+"px;":"left:"+((r+=(n[a-1].width+n[a-1].margin.left+n[a-1].margin.right)*e.zoomFactor)-4)+"px;";var c="height:"+t.thickness+"px;overflow:hidden;width:10px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+h,p={id:e.element.id+"_tableMarker_"+o,class:"e-de-ruler-table-marker",style:c};(d=l.createHtmlElement("div",p)).setAttribute("title",e.localeKeys.DocumentEditor_MoveTableColumn);var g={id:e.element.id+"_tableMarker_svg"+a,width:"9px",height:"11px",style:"position:inherit;left:0px;top:3px;"},f=l.createSvgElement("svg",g);f.setAttribute("fill","none");var u,m=l.createSvgElement("path",{style:"position:inherit;left:0px;"});m.setAttribute("class","e-de-ruler-table-svg"),m.setAttribute("d","M1 1V0H2V1H3V0H4V1H5V0H6V1H7V2H6V3H7V4H6V5H7V6H6V7H7V8H0V7H1V6H0V5H1V4H0V3H1V2H0V1H1ZM2 2V3H3V2H2ZM4 2V3H5V2H4ZM5 4H4V5H5V4ZM5 6H4V7H5V6ZM3 7V6H2V7H3ZM2 5H3V4H2V5Z"),m.setAttribute("fill","#A1A1A1"),f.appendChild(m),d.appendChild(f),s.append(d),l.position.paragraph.associatedCell.ownerTable.tableFormat.bidi?o--:o++,d.addEventListener("dblclick",(function(t){e.showDialog("TableProperties"),t.stopPropagation()})),d.addEventListener("mousedown",(function(t){u=t.clientX-d.getBoundingClientRect().left,e.startXPosition=x.convertPixelToPoint(t.clientX),e.isTableMarkerDragging=!0;var i,r=new I(t.clientX,t.clientY),n=e.viewer.findFocusedPage(r,!0,!0);if(t.currentTarget instanceof HTMLElement){var o=t.currentTarget.id.split("_"),a=o[o.length-1];i=parseInt(a)}var l=e.selection.end.paragraph.containerWidget.ownerTable;e.editorModule.tableResize.currentResizingTable=l,e.editorModule.tableResize.resizeNode=0,e.editorModule.tableResize.resizerPosition=i,e.editorModule.tableResize.startingPoint.x=n.x,e.editorModule.tableResize.startingPoint.y=n.y,e.editorHistory.initResizingHistory(n,e.editorModule.tableResize);var h=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor,c=h+t.clientX-u-s.getBoundingClientRect().left,p=e.documentHelper.currentPage.boundingRectangle.x+(c-h)+6,g=document.getElementById(e.element.id+"_hRuler_indicator_svg");g.style.left=p-6+"px",g.style.display="block"})),document.addEventListener("mousemove",(function(t){if(!e.isDestroyed&&e.documentEditorSettings.showRuler&&e.isTableMarkerDragging){var r=document.getElementById(e.element.id+"_hRuler"),n=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor;if(e.selection.end.paragraph.associatedCell.ownerTable.tableFormat.bidi)n-=i.getRulerGeometry(e).width-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor+e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin*e.zoomFactor);var o=n+t.clientX-u-r.getBoundingClientRect().left;d.style.left=o+"px";var s=e.documentHelper.currentPage.boundingRectangle.x+(o-n)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=s-6+"px"}})),document.addEventListener("mouseup",(function(t){if(!e.isDestroyed&&e.documentEditorSettings.showRuler&&e.isTableMarkerDragging){var r=new I(t.clientX,t.clientY),n=i.position.paragraph.associatedCell.ownerTable.tableFormat.bidi?e.startXPosition-x.convertPixelToPoint(t.clientX):x.convertPixelToPoint(t.clientX)-e.startXPosition;e.editorModule.tableResize.handleResizing(r,!0,n/e.zoomFactor),e.editorModule.tableResize.updateResizingHistory(e.viewer.findFocusedPage(r,!0,!0)),e.isTableMarkerDragging=!1,document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none"}}))},l=this,d=0;d<=n.length;d++)a(d)},e.prototype.updateRulerDimension=function(e,t,i,r){var n="Horizontal"===t.orientation,o=(this.getRulerSize(e),this.getRulerGeometry(e));this.updateRulerDiv(e,o,n,t),this.updateRulerSpace(e,o,n,t),this.updateMargin(t,e,n),t.length=e.zoomFactor<1?2*t.zeroPosition/e.zoomFactor:2*t.zeroPosition*e.zoomFactor;var s=t.element;if(n?s.style.marginLeft=("Pages"===e.layoutType?e.selection.end.paragraph.bodyWidget.page.boundingRectangle.x:0)+"px":(s.parentElement.style.display="Pages"===e.layoutType?"block":"none",s.style.marginTop=e.selection.getPageTop(e.selection.end.paragraph.bodyWidget.page)+"px"),r&&(t.offset=i,t.scale=e.zoomFactor,t.length=e.zoomFactor<1?2*t.zeroPosition/e.zoomFactor:2*t.zeroPosition*e.zoomFactor,t.updateRuler()),n)if("Pages"===e.layoutType){var a=this.position.paragraph.paragraphFormat.bidi,l=!1;if(this.position.paragraph.isInsideTable&&(l=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi),a||l){var d=o.width-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin*e.zoomFactor);s.scrollLeft=e.hRuler.zeroPosition*e.zoomFactor-d}else s.scrollLeft=(t.zeroPosition-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin))*e.zoomFactor}else{a=this.position.paragraph.paragraphFormat.bidi,l=!1;this.position.paragraph.isInsideTable&&(l=this.position.paragraph.associatedCell.ownerTable.tableFormat.bidi),s.scrollLeft=a||l?(t.zeroPosition-e.viewer.clientActiveArea.width)*e.zoomFactor-20:t.zeroPosition*e.zoomFactor-20}else s.scrollTop=(t.zeroPosition-x.convertPointToPixel(e.selection.end.paragraph.bodyWidget.sectionFormat.topMargin))*e.zoomFactor},e.prototype.updateRulerSpace=function(e,t,i,r){var n=document.getElementById(e.element.id+(i?"_hRuler_ruler_space":"_vRuler_ruler_space"));n&&e&&t&&(n.style.width=(i?t.width+2*r.segmentWidth:r.thickness)+"px",n.style.height=(i?r.thickness:t.height+2*r.segmentWidth)+"px")},e.prototype.updateRulerDiv=function(e,t,i,r){var n=document.getElementById(e.element.id+(i?"_hRuler":"_vRuler"));if(n&&e&&t&&(n.style.width=(i?"Continuous"===e.layoutType?t.width/e.zoomFactor:t.width:r.thickness)+"px",n.style.height=(i?r.thickness:t.height)+"px",(n=document.getElementById(e.element.id+"_overlapRuler"))&&(i?(n.style.height,r.thickness):(n.style.width,r.thickness))),i&&this.hRulerBottom){var o=e.documentHelper.pageContainer;this.hRulerBottom.style.width=o.getBoundingClientRect().width+"px"}},e.prototype.getRulerGeometry=function(e){this.getRulerSize(e);var t=e.selection.end.paragraph.bodyWidget.page.boundingRectangle.height*e.zoomFactor,i=e.selection.end.paragraph.bodyWidget.page.boundingRectangle.width*e.zoomFactor;return new xd(i,t)},e.prototype.getVerticalHeight=function(e){var t=x.convertPixelToPoint(e.selection.end.paragraph.bodyWidget.page.boundingRectangle.height),i=e.element.getBoundingClientRect().height;return t<i?t:i-e.documentHelper.pages[0].boundingRectangle.y},e.prototype.renderTab=function(e,t,i,r,n){var o=this,s=document.getElementById(e.element.id+"_hRuler"),a=e.documentHelper.zoomFactor;switch(r){case"Left":var l=document.getElementById(e.element.id+"_LeftTab_"+n);if(!l){var d="";if(!sf.base.isNullOrUndefined(i))d="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?x.convertPointToPixel(1584-i.position):x.convertPointToPixel(1584+i.position))-1.5)*a+"px;");var h={id:e.element.id+"_LeftTab_"+n,class:"e-de-ruler-tab e-de-ruler-tab-left",style:d,"data-name":"LeftTab"};(l=this.createHtmlElement("div",h)).setAttribute("title",e.localeKeys.DocumentEditor_LeftTab);var c=void 0,p={id:e.element.id+"_leftTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};(c=this.createSvgElement("svg",p)).setAttribute("fill","none");var g={style:"position:inherit;left:0px"};(y=this.createSvgElement("path",g)).setAttribute("class","e-de-ruler-tab-svg"),y.setAttribute("d","M3 5H7V7H1V1H3V5Z"),y.setAttribute("fill","#605E5C"),y.setAttribute("stroke","#A1A1A1"),c.appendChild(y),l.appendChild(c),s.append(l)}break;case"Center":var f=document.getElementById(e.element.id+"_CenterTab_"+n);if(!f){d="";if(!sf.base.isNullOrUndefined(i))d="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?x.convertPointToPixel(1584-i.position):x.convertPointToPixel(1584+i.position))-4)*a+"px;");h={id:e.element.id+"_CenterTab_"+n,class:"e-de-ruler-tab e-de-ruler-tab-center",style:d,"data-name":"CenterTab"};(f=this.createHtmlElement("div",h)).setAttribute("title",e.localeKeys.DocumentEditor_CenterTab);c=void 0,p={id:e.element.id+"_centerTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};(c=this.createSvgElement("svg",p)).setAttribute("fill","none");g={style:"position:inherit;left:0px"};(y=this.createSvgElement("path",g)).setAttribute("class","e-de-ruler-tab-svg"),y.setAttribute("d","M5 5H8V7H0V5H3V1H5V5Z"),y.setAttribute("fill","#605E5C"),y.setAttribute("stroke","#A1A1A1"),c.appendChild(y),f.appendChild(c),s.append(f)}break;case"Right":var u=document.getElementById(e.element.id+"_RightTab_"+n);if(!u){d="";if(!sf.base.isNullOrUndefined(i))d="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?x.convertPointToPixel(1584-i.position):x.convertPointToPixel(1584+i.position))-5.5)*a+"px;");h={id:e.element.id+"_RightTab_"+n,class:"e-de-ruler-tab e-de-ruler-tab-right",style:d,"data-name":"RightTab"};(u=this.createHtmlElement("div",h)).setAttribute("title",e.localeKeys.DocumentEditor_RightTab);c=void 0,p={id:e.element.id+"_rightTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};(c=this.createSvgElement("svg",p)).setAttribute("fill","none");g={style:"position:inherit;left:0px"};(y=this.createSvgElement("path",g)).setAttribute("class","e-de-ruler-tab-svg"),y.setAttribute("d","M5 5V1H7V7H1V5H5Z"),y.setAttribute("fill","#605E5C"),y.setAttribute("stroke","#A1A1A1"),c.appendChild(y),u.appendChild(c),s.append(u)}break;case"Decimal":var m=document.getElementById(e.element.id+"_DecimalTab_"+n);if(!m){d="";if(!sf.base.isNullOrUndefined(i))d="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?x.convertPointToPixel(1584-i.position):x.convertPointToPixel(1584+i.position))*a-4)+"px;");h={id:e.element.id+"_DecimalTab_"+n,class:"e-de-ruler-tab e-de-ruler-tab-decimal",style:d,"data-name":"DecimalTab"};(m=this.createHtmlElement("div",h)).setAttribute("title",e.localeKeys.DocumentEditor_DecimalTab);c=void 0,p={id:e.element.id+"_decimalTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};(c=this.createSvgElement("svg",p)).setAttribute("fill","none");var y;g={style:"position:inherit;left:0px"};(y=this.createSvgElement("path",g)).setAttribute("class","e-de-ruler-tab-svg"),y.setAttribute("d","M6 0H4V6H0V8H4H6H10V6H6V0Z"),y.setAttribute("fill","#605E5C"),y.setAttribute("clip-rule","evenodd"),y.setAttribute("fill-rule","evenodd"),y.setAttribute("stroke","#A1A1A1"),c.appendChild(y),m.appendChild(c),s.append(m)}break;case"Bar":var v=document.getElementById(e.element.id+"_BarTab_"+n);if(!v){d="";if(!sf.base.isNullOrUndefined(i))d="height:9px;overflow:hidden;top:7px;width:12px;position:absolute;font-size:11px;text-align: left;z-index: 4;"+("left:"+((this.position.paragraph.paragraphFormat.bidi?x.convertPointToPixel(1584-i.position):x.convertPointToPixel(1584+i.position))-1.5)*a+"px;");h={id:e.element.id+"_BarTab_"+n,class:"e-de-ruler-tab e-de-ruler-tab-bar",style:d,"data-name":"BarTab"};(v=this.createHtmlElement("div",h)).setAttribute("title",e.localeKeys.DocumentEditor_BarTab);c=void 0,p={id:e.element.id+"_barTab_svg",width:t.width/2+"px",height:t.height/2+"px",style:"position:inherit;left:0px"};(c=this.createSvgElement("svg",p)).setAttribute("fill","none");var w=this.createSvgElement("rect",{style:"position:inherit;left:0px"});w.setAttribute("width","2"),w.setAttribute("height","8"),w.setAttribute("fill","#605E5C"),w.setAttribute("stroke","#A1A1A1"),c.appendChild(w),v.appendChild(c),s.append(v)}}if(!sf.base.isNullOrUndefined(i)){var b=document.getElementById(e.element.id+"_"+r+"Tab_"+n);sf.base.isNullOrUndefined(i)||b.addEventListener("dblclick",(function(t){e.showDialog("Tab"),t.stopPropagation()}));var I,F=!1,C=(x.getNumberFromString(b.style.left),x.getNumberFromString(b.style.left),b.getAttribute("data-name")),W=this.position.paragraph,k=0,S=void 0;b.addEventListener("mousedown",(function(t){t.stopPropagation(),F=!0,I=t.clientX-b.getBoundingClientRect().left,x.getNumberFromString(b.style.left),k=parseInt(b.id.split("_")[3]),S=W.paragraphFormat.tabs[parseInt(k.toString(),10)],o.currentTabStopElement=b;var i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor;"Continuous"===e.layoutType&&(i=e.hRuler.zeroPosition*e.zoomFactor-20,o.position.paragraph.paragraphFormat.bidi&&(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor));var r=i+t.clientX-I-s.getBoundingClientRect().left,n=e.documentHelper.currentPage.boundingRectangle.x,a=(n="Continuous"===e.layoutType?0:n)+(r-i),l=document.getElementById(e.element.id+"_hRuler_indicator_svg");l.style.left=a+"px",l.style.display="block"})),b.addEventListener("mouseup",(function(){sf.base.isNullOrUndefined(o.currentTabStopElement)||(o.currentTabStopElement=void 0)})),document.addEventListener("mousemove",(function(t){if(F){var i=void 0;"Continuous"===e.layoutType?(i=e.hRuler.zeroPosition*e.zoomFactor-20,o.position.paragraph.paragraphFormat.bidi&&(i=e.hRuler.zeroPosition*e.zoomFactor-20-e.viewer.clientArea.width*e.zoomFactor)):"Pages"===e.layoutType&&(i=x.convertPointToPixel(1584-e.selection.sectionFormat.leftMargin)*e.zoomFactor,o.position.paragraph.bidi&&(i=x.convertPointToPixel(1584+e.selection.sectionFormat.rightMargin-e.selection.sectionFormat.pageWidth)*e.zoomFactor));var r=i+t.clientX-I-s.getBoundingClientRect().left,n=i,a=document.getElementById(e.element.id+"_rightIndent"),l=x.getNumberFromString(a.style.left),d=l,h=document.getElementById(e.element.id+"_leftIndent"),c=x.getNumberFromString(h.style.left);n=c,o.position.paragraph.paragraphFormat.bidi&&(n=l,d=c),d+="CenterTab"===C||"DecimalTab"===C?4:"RightTab"===C?5.5:1.5,r<n?r=n:r>d&&(r=d),b.style.left=r+"px";var p=e.documentHelper.currentPage.boundingRectangle.x,g=(p="Continuous"===e.layoutType?0:p)+(r-i)+6;document.getElementById(e.element.id+"_hRuler_indicator_svg").style.left=g+"px"}})),document.addEventListener("mouseup",(function(){if(F&&!sf.base.isNullOrUndefined(S)){if(sf.base.isNullOrUndefined(o.currentTabStopElement)||"none"!=o.currentTabStopElement.style.display){var t=x.getNumberFromString(b.style.left);t,e.editor.removeTabStops([W],[S]),t=x.convertPixelToPoint(t/e.zoomFactor)-1584,t=W.paragraphFormat.bidi?-1*t:t,S.position=t,e.editor.updateTabStopCollection(W,[S])}else e.editor.removeTabStops([W],[S]),o.currentTabStopElement.parentNode.removeChild(o.currentTabStopElement);o.updateTabStopMarkers(e),F=!1,document.getElementById(e.element.id+"_hRuler_indicator_svg").style.display="none",o.currentTabStopElement=void 0}}))}},e.prototype.updateMargin=function(e,t,i){i?(e.startMargin=t.selection.end.paragraph.bodyWidget.sectionFormat.leftMargin,e.endMargin=t.selection.end.paragraph.bodyWidget.sectionFormat.rightMargin):(e.startMargin=t.selection.end.paragraph.bodyWidget.sectionFormat.topMargin,e.endMargin=t.selection.end.paragraph.bodyWidget.sectionFormat.bottomMargin)},e.prototype.getTabJustification=function(e){switch(e){case"LeftTab":return"Left";case"CenterTab":return"Center";case"RightTab":return"Right";case"DecimalTab":return"Decimal";case"BarTab":return"Bar"}return"Left"},e.prototype.getRulerSize=function(e){return 15,15,new xd(15,15)},e}(),Fd=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new i((function(t){t(e.value)})).then(s,a)}l((r=r.apply(e,t||[])).next())}))},Cd=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},Wd=function(){function e(e,t,i,r,n,o){this.isDestroyed=!1,this.enableHeaderFooterIn=!1,window.sfBlazor=window.sfBlazor,this.isShiftingEnabled=!1,this.isLayoutEnabled=!0,this.isPastingContent=!1,this.parser=void 0,this.isOnIndent=!1,this.isTableMarkerDragging=!1,this.startXPosition=0,this.disableHistoryIn=!1,this.findResultsList=void 0,this.defaultLocale={},this.imageResizerModule=void 0,this.zoomFactor=1,this.enableChunkMessages=!1,this.dotNetRef=i,this.localeKeys=n,this.element=t,this.dataId=e,window.sfBlazor.setCompInstance(this),this.documentHelper=new Ys(this),this.interOpRef=o,sf.base.isNullOrUndefined(r)||(this.options=r,this.updateOptions(r)),"Pages"===this.layoutType?this.viewer=new Qs(this):this.viewer=new $s(this)}return Object.defineProperty(e.prototype,"enableHeaderAndFooter",{get:function(){return this.enableHeaderFooterIn},set:function(e){this.enableHeaderFooterIn=e,!e&&this.selection&&this.selection.isWebLayout&&(this.selection.isWebLayout=!1),this.viewer.updateScrollBars()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageCount",{get:function(){return!this.isDocumentLoaded||sf.base.isNullOrUndefined(this.viewer)||this.viewer instanceof $s?1:this.documentHelper.pages.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editor",{get:function(){return this.editorModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.editorHistoryModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"search",{get:function(){return this.searchModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spellChecker",{get:function(){return this.spellCheckerModule},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerId",{get:function(){return this.element.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDocumentLoaded",{get:function(){return this.isDocumentLoadedIn},set:function(e){this.isDocumentLoadedIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDocumentEmpty",{get:function(){if(1==this.documentHelper.pages.length){var e=this.documentHelper.pages[0],t=e.headerWidget,i=e.footerWidget,r=!0,n=!0;if(sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.firstChild)||t.firstChild instanceof ca&&t.firstChild.isEmpty()||(r=!1),sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.firstChild)||i.firstChild instanceof ca&&i.firstChild.isEmpty()||(n=!1),r&&n){var o=e.bodyWidgets[0];if(sf.base.isNullOrUndefined(o.nextWidget)){var s=o.firstChild;if(s instanceof ca&&s.isEmpty()&&sf.base.isNullOrUndefined(s.nextWidget))return!0}}return!1}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"revisions",{get:function(){return sf.base.isNullOrUndefined(this.revisionsInternal)&&(this.revisionsInternal=new O(this)),this.revisionsInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableHistoryMode",{get:function(){return this.enableEditorHistory&&!sf.base.isNullOrUndefined(this.editorHistoryModule)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentStart",{get:function(){if(!sf.base.isNullOrUndefined(this.selectionModule))return this.selection.getDocumentStart()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentEnd",{get:function(){if(!sf.base.isNullOrUndefined(this.selectionModule))return this.selection.getDocumentEnd()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isReadOnlyMode",{get:function(){return this.isReadOnly||sf.base.isNullOrUndefined(this.editorModule)||sf.base.isNullOrUndefined(this.selectionModule)||!sf.base.isNullOrUndefined(this.editor)&&this.editor.restrictEditing},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSpellCheck",{get:function(){return this.enableSpellCheck&&this.spellChecker.enableSpellCheck},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableImageResizerMode",{get:function(){return this.enableImageResizer&&!sf.base.isNullOrUndefined(this.imageResizerModule)},enumerable:!0,configurable:!0}),e.prototype.updateOptions=function(e){this.acceptTab=e.acceptTab,this.currentUser=e.currentUser,this.documentName=e.documentName,this.enableAutoFocus=e.enableAutoFocus,this.enableBookmarkDialog=e.enableBookmarkDialog,this.enableBordersAndShadingDialog=e.enableBordersAndShadingDialog,this.enableComment=e.enableComment,this.enableContextMenu=e.enableContextMenu,this.enableCursorOnReadOnly=e.enableCursorOnReadOnly,this.enableEditor=e.enableEditor,this.enableEditorHistory=e.enableEditorHistory,this.enableFontDialog=e.enableFontDialog,this.enableFormField=e.enableFormField,this.enableHyperlinkDialog=e.enableHyperlinkDialog,this.enableImageResizer=e.enableImageResizer,this.enableListDialog=e.enableListDialog,this.enableLocalPaste=e.enableLocalPaste,this.enableOptionsPane=e.enableOptionsPane,this.enablePageSetupDialog=e.enablePageSetupDialog,this.enableParagraphDialog=e.enableParagraphDialog,this.enablePrint=e.enablePrint,this.enableSearch=e.enableSearch,this.enableSelection=e.enableSelection,this.enableSfdtExport=e.enableSfdtExport,this.enableSpellCheck=e.enableSpellCheck,this.enableStyleDialog=e.enableStyleDialog,this.enableTableDialog=e.enableTableDialog,this.enableTableOfContentsDialog=e.enableTableOfContentsDialog,this.enableTableOptionsDialog=e.enableTableOptionsDialog,this.enableTextExport=e.enableTextExport,this.enableTrackChanges=e.enableTrackChanges,this.enableWordExport=e.enableWordExport,this.headers=e.headers?e.headers:[],this.height=e.height,this.isReadOnly=e.isReadOnly,this.pageGap=e.pageGap,this.pageOutline=e.pageOutline,this.serviceUrl=e.serviceUrl,this.showComments=e.showComments,this.showRevisions=e.showRevisions,this.useCtrlClickToFollowHyperlink=e.useCtrlClickToFollowHyperlink,this.userColor=e.userColor,this.width=e.width,this.zIndex=e.zIndex,this.zoomFactor=e.zoomFactor,this.layoutType=e.layoutType,this.defaultPasteOption=e.defaultPasteOption,this.documentEditorSettings=e.documentEditorSettings,this.documentSettings=e.documentSettings,this.serverActionSettings=e.serverActionSettings,this.enableChunkMessages=e.enableChunkMessages,this.requiredModules(),sf.base.isNullOrUndefined(this.documentEditorSettings.showRuler)||this.showHideRulers()},e.prototype.setOptions=function(e,t,i){for(var r=this,n=0,o=Object.keys(e);n<o.length;n++){switch(o[n]){case"zoomFactor":t.zoomFactor!=e.zoomFactor&&(this.zoomFactor=e.zoomFactor,this.documentHelper&&(this.documentHelper.zoomFactor=e.zoomFactor)),this.rulerHelper&&this.documentEditorSettings&&this.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!0);break;case"layoutType":if(this.selection&&this.selection.isWebLayout)break;t.layoutType!=e.layoutType&&(this.layoutType=e.layoutType,this.viewer.destroy(),"Pages"===this.layoutType?this.viewer=new Qs(this):(!0===this.enableHeaderAndFooter&&this.selection.closeHeaderFooter(),this.viewer=new $s(this)),this.editor.layoutWholeDocument(),setTimeout((function(){r.fireViewChange()}),200));break;case"locale":break;case"isReadOnly":this.isReadOnly=e.isReadOnly;break;case"currentUser":t.currentUser!=e.currentUser&&(this.currentUser=e.currentUser,this.selection&&this.documentHelper.isDocumentProtected&&this.selection.highlightEditRegion());break;case"userColor":t.userColor!=e.userColor&&(this.userColor=e.userColor,this.selection&&this.documentHelper.isDocumentProtected&&this.selection.highlightEditRegion());break;case"pageGap":t.pageGap!=e.pageGap&&(this.pageGap=e.pageGap,this.viewer.updateScrollBars());break;case"pageOutline":t.pageOutline!=e.pageOutline&&(this.pageOutline=e.pageOutline,this.viewer.updateScrollBars());break;case"zIndex":case"showComments":case"enableRtl":case"enableComment":break;case"showRevisions":this.isReadOnly||this.documentHelper.isDocumentProtected?(this.showRevisions=!1,this.documentHelper.showRevisions(!1)):this.viewer&&this.documentHelper.showRevisions(e.showRevisions);break;case"documentEditorSettings":this.documentEditorSettings=e.documentEditorSettings,sf.base.isNullOrUndefined(e.documentEditorSettings.enableOptimizedTextMeasuring)||(e.documentEditorSettings.enableOptimizedTextMeasuring?this.textMeasureHelper=new yd(this.documentHelper):this.textMeasureHelper=new vd(this.documentHelper),this.viewer.updateScrollBars()),sf.base.isNullOrUndefined(e.documentEditorSettings.showHiddenMarks)||e.documentEditorSettings.showHiddenMarks===this.documentEditorSettings.showHiddenMarks||this.viewer.updateScrollBars(),sf.base.isNullOrUndefined(e.documentEditorSettings.highlightEditableRanges)||this.setHighlightEditableRanges(e.documentEditorSettings.highlightEditableRanges);break;case"documentSettings":var s=this.documentSettings;if(this.documentSettings=e.documentSettings,!sf.base.isNullOrUndefined(e.documentSettings.compatibilityMode)){var a=s.compatibilityMode,l=e.documentSettings.compatibilityMode;("Word2013"==a&&"Word2013"!=l||"Word2013"!=a&&"Word2013"==l)&&this.documentHelper.compatibilityMode!==l&&(this.documentHelper.compatibilityMode=l,this.editor.layoutWholeDocument())}this.viewer.updateScrollBars();break;case"height":if(t.height!=e.height){var d="";d=-1!==this.height.indexOf("%")?window.innerHeight*(parseInt(this.height)/100)+"px":sf.base.formatUnit(this.height),this.height=e.height,this.element.style.height=d,this.resize()}break;case"width":t.width!=e.width&&(this.width=e.width,this.element.style.width=sf.base.formatUnit(this.width),this.resize())}}i&&this.updateOptions(e)},e.prototype.preRender=function(){this.findResultsList=[]},e.prototype.render=function(){if(!sf.base.isNullOrUndefined(this.element)){var e=this.element;e.style.minHeight="200px",e.style.minWidth="200px",this.element.style.height=sf.base.formatUnit(this.height),""!==this.width&&(this.element.style.width=sf.base.formatUnit(this.width))}this.documentHelper.initializeComponents(),this.openBlank(),this.renderRulers()},e.prototype.renderRulers=function(){this.rulerHelper=new Id,this.rulerContainer=this.rulerHelper.renderOverlapElement(this),this.rulerHelper.renderRuler(this,!0),this.rulerHelper.renderRuler(this,!1),this.rulerHelper.renderRulerMarkerIndicatorElement(this),this.rulerHelper.createIndicatorLines(this),this.showHideRulers()},e.prototype.showHideRulers=function(){if(this.rulerHelper&&this.documentEditorSettings&&!sf.base.isNullOrUndefined(!this.documentEditorSettings.showRuler)){var e=this.documentEditorSettings.showRuler&&!this.isReadOnlyMode;this.rulerHelper.hideTabStopSwitch(e),this.rulerHelper.hideRulerBottom(e),this.vRuler&&this.vRuler.showHideRuler(e),this.hRuler&&this.hRuler.showHideRuler(e)}},e.prototype.onPropertyChanged=function(e,t){for(var i=this,r=0,n=Object.keys(e);r<n.length;r++){switch(n[r]){case"zoomFactor":this.viewer&&(this.documentHelper.zoomFactor=e.zoomFactor,this.rulerHelper&&this.documentEditorSettings&&this.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!0));break;case"layoutType":if(this.selection&&this.selection.isWebLayout)break;this.viewer.destroy(),"Pages"===this.layoutType?this.viewer=new Qs(this):(!0===this.enableHeaderAndFooter&&this.selection.closeHeaderFooter(),this.viewer=new $s(this)),this.editor.layoutWholeDocument(),setTimeout((function(){i.fireViewChange()}),200);break;case"locale":break;case"isReadOnly":this.isReadOnly=e.isReadOnly;break;case"currentUser":case"userColor":this.selection&&this.documentHelper.isDocumentProtected&&this.selection.highlightEditRegion();break;case"pageGap":case"pageOutline":this.viewer.updateScrollBars();break;case"zIndex":break;case"showComments":this.viewer&&this.documentHelper.showComments(e.showComments);break;case"enableRtl":break;case"enableComment":this.viewer&&this.showComments&&(this.showComments=!!this.showComments&&this.enableComment,this.documentHelper.showComments(e.enableComment)),this.viewer.updateScrollBars();break;case"showRevisions":this.viewer&&this.documentHelper.showRevisions(e.showRevisions),this.viewer.updateScrollBars();break;case"documentEditorSettings":this.viewer.updateScrollBars(),sf.base.isNullOrUndefined(e.documentEditorSettings.showRuler)||(this.showHideRulers(),e.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!0));break;case"height":this.element.style.height=sf.base.formatUnit(this.height),this.resize();break;case"width":this.element.style.width=sf.base.formatUnit(this.width),this.resize()}}},e.prototype.setDefaultCharacterFormat=function(e){this.characterFormat=e,this.documentHelper.setDefaultDocumentFormat(),sf.base.isNullOrUndefined(this.selection)||this.selection.retrieveCurrentFormatProperties()},e.prototype.setDefaultParagraphFormat=function(e){this.paragraphFormat=e,this.documentHelper.setDefaultDocumentFormat(),sf.base.isNullOrUndefined(this.selection)||this.selection.retrieveCurrentFormatProperties()},e.prototype.setDefaultSectionFormat=function(e){this.sectionFormat=e,this.documentHelper.setDefaultDocumentFormat(),sf.base.isNullOrUndefined(this.selection)||this.selection.retrieveCurrentFormatProperties()},e.prototype.getPersistData=function(){return"documenteditor"},e.prototype.clearPreservedCollectionsInViewer=function(){this.viewer instanceof Zs&&this.documentHelper.clearDocumentItems()},e.prototype.getDocumentEditorElement=function(){return this.element},e.prototype.fireContentChange=function(){var e=this;this.contentChangeTimer&&(clearTimeout(this.contentChangeTimer),this.contentChangeTimer=void 0),this.contentChangeTimer=setTimeout((function(){var t={canUndo:e.editorHistory.canUndo(),canRedo:e.editorHistory.canRedo(),pageCount:e.pageCount};e.dotNetRef.invokeMethodAsync("ContentChangeInternal",t)}),200),this.dotNetRef.invokeMethodAsync("ContentChange")},e.prototype.fireDocumentChange=function(){return Fd(this,void 0,void 0,(function(){var e,t,i,r,n,o=this;return Cd(this,(function(s){switch(s.label){case 0:return this.documentChangeTimer&&(clearTimeout(this.documentChangeTimer),this.documentChangeTimer=void 0),e={enableTrackChanges:this.enableTrackChanges,compatibilityMode:this.documentHelper.compatibilityMode},this.documentChangeTimer=setTimeout((function(){o.fireDocumentChangeInternal(e)}),200),this.isDestroyed?[3,3]:(this.dotNetRef.invokeMethodAsync("DocumentChange",e),t=this.fetchComments(),this.enableChunkMessages?(i=new Blob([t],{type:"text/plain"}),[4,this.interOpRef.docEditFileReaderArrayBuffer(i)]):[3,2]);case 1:return r=s.sent(),n=this.interOpRef.getBlobInfo(r),this.dotNetRef.invokeMethodAsync("UpdateCommentsCollectionChunk",n),[3,3];case 2:this.dotNetRef.invokeMethodAsync("UpdateCommentsCollection",t),s.label=3;case 3:return[2]}}))}))},e.prototype.fireDocumentChangeInternal=function(e){this.isDestroyed||this.dotNetRef.invokeMethodAsync("DocumentChangeInternal",e)},e.prototype.showFormFieldPopup=function(e){this.dotNetRef.invokeMethodAsync("ShowFormFieldPopup",e.type,JSON.stringify(e),!0)},e.prototype.hideFormFieldPopup=function(){this.dotNetRef.invokeMethodAsync("ShowFormFieldPopup","","",!1)},e.prototype.fireSelectionChange=function(){var e=this;if(!this.documentHelper.isCompositionStart&&sf.base.Browser.isDevice&&this.editorModule&&this.editorModule.predictText(),!this.editor||!this.editor.isInsertingTOC){var t={source:sf.base.isBlazor()?null:this,isCompleted:this.documentHelper.isCompleted};sf.base.EventHandler.trigger(this.element,"selectionChange",t),this.selectionTimer&&(clearTimeout(this.selectionTimer),this.selectionTimer=void 0),this.selectionTimer=setTimeout((function(){e.fireSelectionChangeInternal()}),200),this.isDestroyed||this.dotNetRef.invokeMethodAsync("SelectionChange",t),this.documentHelper.isCompleted=!0}},e.prototype.fireSelectionChangeInternal=function(){this.isDestroyed||this.dotNetRef.invokeMethodAsync("SelectionChangeInternal",this.getCurrentContext())},e.prototype.setShowHiddenMarks=function(e){this.isDestroyed||(this.dotNetRef.invokeMethodAsync("SetShowHiddenMarks",e),this.viewer.updateScrollBars())},e.prototype.setHighlightEditableRanges=function(e){this.isDestroyed||(this.dotNetRef.invokeMethodAsync("SetHighlightEditableRanges",e),this.viewer.updateScrollBars())},e.prototype.isContentProtected=function(){var e=this.documentHelper.isDocumentProtected,t=!1,i=!1,r="",n="",o="NoProtection";if(e&&(t=e&&this.documentHelper.restrictFormatting,i=this.editor.restrictEditing,o=this.documentHelper.protectionType,this.documentHelper.selection.checkSelectionIsAtEditRegion())){var s=this.documentHelper.selection.getEditRangeStartElement();s&&(r=s.user,n=s.group)}return{isDocumentProtected:e,allowFormatting:t,isInProtectecRegion:i,isReadOnly:this.isReadOnly,protectionType:o,editUser:r,editGroup:n}},e.prototype.getCurrentContext=function(){var e={};e.characterFormat=this.fetchCharacterFormat(this.selection.characterFormat),e.paragraphFormat=this.fetchParagraphFormat(this.selection.paragraphFormat),e.sectionFormat=this.fetchSectionFormat(this.selection.sectionFormat),this.selection.contextType.indexOf("Table")>=0&&(e.tableFormat=this.fetchTableFormat(this.selection.tableFormat),e.rowFormat=this.fetchRowFormat(this.selection.rowFormat),e.cellFormat=this.fetchCellFormat(this.selection.cellFormat)),this.selection.contextType.indexOf("Image")>=0&&(e.imageFormat=this.fetchImageFormat());var t={},i=this.selection.contextType,r=this.documentHelper.selection,n=!1,o=r.getHyperlinkField();t.isHideComment=this.documentHelper.owner.isReadOnlyMode&&!this.documentHelper.isCommentOnlyMode||this.documentHelper.owner.enableHeaderAndFooter||!this.documentHelper.owner.enableComment,o instanceof va&&r.isReferenceField(o)&&(n=!0,"FormFieldsOnly"!==this.documentHelper.protectionType&&this.documentHelper.owner.isReadOnlyMode||(t.canUpdateField=!0)),t.contextType=i,t.isReadOnly=this.documentHelper.owner.isReadOnlyMode;var s=this.selection.isinFootnote,a=this.selection.isinEndnote,l=this.enableHeaderAndFooter;t.isinEndnote=a,t.isinFootnote=s,t.isHeaderAndFooter=l;var d=this.selection.isEmpty;if(t.isEmpty=d,"TableOfContents"===i)t.isTableOfContents=!0;else{var h=r.start,c=r.end;"List"===r.contextType&&"Bullet"!==r.getListLevel(h.paragraph).listLevelPattern&&(t.isList=!0);var p=h.paragraph.isInsideTable&&(!c.paragraph.isInsideTable||h.paragraph.associatedCell!==c.paragraph.associatedCell||this.documentHelper.selection.isCellSelected(h.paragraph.associatedCell,h,c));if(t.isHyperlinkEnabled=!!p,o instanceof va&&!r.isImageField()&&!n?t.editHyperLink=!0:t.editHyperLink=!1,t.formFieldType="",r.isFormField()){var g=this.documentHelper.selection.getCurrentFormField();g instanceof va&&(g.formFieldData instanceof ba?t.formFieldType="Text":g.formFieldData instanceof xa?t.formFieldType="CheckBox":g.formFieldData instanceof Ia&&(t.formFieldType="DropDown"))}o instanceof va&&n&&(t.canUpdateField=!0)}return this.documentHelper.owner.selection.start.paragraph.isInsideTable&&this.documentHelper.owner.selection.end.paragraph.isInsideTable&&(t.isTable=!0,this.editor.canMergeCells()&&(t.canMergeCells=!0),t.isTableSelected=this.documentHelper.selection.isTableSelected()),t.isFont="Image"!==i,this.enableTrackChanges&&this.documentHelper.selection.hasRevisions()&&(t.canAcceptChange=!0),t.isElementBox=this.isSpellCheck&&this.hasElementBox(),e.selectionContext=t,e.protectionInfo=this.isContentProtected(),e.pasteOption=this.selection.currentPasteAction,e},e.prototype.fetchImageFormat=function(){var e={};return e.width=this.selection.imageFormat.width,e.height=this.selection.imageFormat.height,e.alternateText=this.selection.imageFormat.alternateText,e},e.prototype.fetchCharacterFormat=function(e){var t={};return t.bold=e.bold,t.fontSize=e.fontSize,e instanceof kl?sf.base.isNullOrUndefined(e.renderedFontFamily)||sf.base.isNullOrUndefined(e.fontFamily)?t.fontFamily=e.fontFamily:t.fontFamily=e.renderedFontFamily:t.fontFamily=e.fontFamily,t.italic=e.italic,t.baselineAlignment=e.baselineAlignment,t.underline=e.underline,t.fontColor=e.fontColor,t.highlightColor=e.highlightColor,t.strikethrough=e.strikethrough,t.allCaps=e.allCaps,t.styleName=e.styleName,t},e.prototype.fetchParagraphFormat=function(e){var t={};return t.leftIndent=e.leftIndent,t.rightIndent=e.rightIndent,t.firstLineIndent=e.firstLineIndent,t.lineSpacing=e.lineSpacing,t.lineSpacingType=e.lineSpacingType,t.textAlignment=e.textAlignment,t.outlineLevel=e.outlineLevel,t.beforeSpacing=e.beforeSpacing,t.afterSpacing=e.afterSpacing,t.spaceBeforeAuto=e.spaceBeforeAuto,t.spaceAfterAuto=e.spaceAfterAuto,t.bidi=e.bidi,t.keepWithNext=e.keepWithNext,t.keepLinesTogether=e.keepLinesTogether,t.widowControl=e.widowControl,t.contextualSpacing=e.contextualSpacing,t.styleName=e.styleName,t.borders=this.getParaBorder(),sf.base.isNullOrUndefined(e.listFormat)||(t.listFormat=this.fetchListFormat(e.listFormat)),t},e.prototype.getParaBorder=function(){var e={};if(!sf.base.isNullOrUndefined(this.selection.paragraphFormat)){var t=this.selection.paragraphFormat.borders;e.top=this.copySelectionBorderFormat({},t.top),e.bottom=this.copySelectionBorderFormat({},t.bottom),e.left=this.copySelectionBorderFormat({},t.left),e.right=this.copySelectionBorderFormat({},t.right),e.horizontal=this.copySelectionBorderFormat({},t.horizontal),e.vertical=this.copySelectionBorderFormat({},t.vertical)}return e},e.prototype.copySelectionBorderFormat=function(e,t){return sf.base.isNullOrUndefined(t.lineStyle)||(e.lineStyle=t.lineStyle),sf.base.isNullOrUndefined(t.color)||(e.color=t.color),sf.base.isNullOrUndefined(t.lineWidth)||(e.lineWidth=t.lineWidth),sf.base.isNullOrUndefined(t.shadow)||(e.shadow=t.shadow),sf.base.isNullOrUndefined(t.space)||(e.space=t.space),e},e.prototype.fetchListFormat=function(e){var t={},i=e.getValue("listId");sf.base.isNullOrUndefined(i)||(t.listId=i);var r=e.getValue("listLevelNumber");return sf.base.isNullOrUndefined(r)||(t.listLevelNumber=r),t},e.prototype.fetchTableFormat=function(e){var t={};return t.topMargin=e.topMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.rightMargin=e.rightMargin,t.leftIndent=e.leftIndent,t.background=e.background,t.tableAlignment=e.tableAlignment,t.cellSpacing=e.cellSpacing,t.bidi=e.bidi,t.title=e.title,t.description=e.description,t.preferredWidth=e.preferredWidth,t.preferredWidthType=e.preferredWidthType,t.borders=this.getTableBorder(),t.shading=this.getTableShading(),t},e.prototype.fetchCellFormat=function(e){var t={};return t.topMargin=e.topMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.rightMargin=e.rightMargin,t.verticalAlignment=e.verticalAlignment,t.background=e.background,t.preferredWidth=e.preferredWidth,t.preferredWidthType=e.preferredWidthType,t.canMerge=this.editor.canMergeCells(),t.borders=this.getCellBorder(),t.shading=this.getCellShading(),t},e.prototype.fetchRowFormat=function(e){var t={};return t.allowBreakAcrossPages=e.allowBreakAcrossPages,t.height=e.height,t.heightType=e.heightType,t.isHeader=e.isHeader,t},e.prototype.fetchList=function(e,t){var i={};return i.listId=e.listId,i.sourceListId=e.sourceListId,i.abstractListId=e.abstractListId,i.listLength=this.documentHelper.lists.length,i.abstractLength=this.documentHelper.abstractLists.length,JSON.stringify(i)},e.prototype.hasElementBox=function(){var e=!1;this.errorElementInfo=this.spellChecker.findCurretText(),this.errorElementInfo.element&&(e=!0,this.spellChecker.currentContextInfo=this.errorElementInfo,this.errorElementInfo=this.spellChecker.retriveText(!0));var t=this.spellChecker.manageSpecialCharacters(this.errorElementInfo.text,void 0,!0);return!sf.base.isNullOrUndefined(t)&&this.spellChecker.errorWordCollection.containsKey(t)&&(this.spellChecker.currentContextInfo=this.errorElementInfo,e=!0),e},e.prototype.fetchSectionFormat=function(e){var t={};t.topMargin=e.topMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.rightMargin=e.rightMargin,t.pageHeight=e.pageHeight,t.pageWidth=e.pageWidth,t.footerDistance=e.footerDistance,t.headerDistance=e.headerDistance,t.differentFirstPage=e.differentFirstPage,t.differentOddAndEvenPages=e.differentOddAndEvenPages,t.numberOfColumns=e.numberOfColumns,t.equalWidth=e.equalWidth,t.lineBetweenColumns=e.lineBetweenColumns,t.sectionIndex=this.selection.start.paragraph.bodyWidget.sectionIndex,t.columns=[];for(var i=0,r=e.columns;i<r.length;i++){var n=r[i],o={};o.width=n.width,o.space=n.space,t.columns.push(o)}if(this.selection.start.paragraph.isInHeaderFooter){var s=!0;switch(this.selection.start.paragraph.bodyWidget.headerFooterType){case"EvenHeader":s=e.evenPageHeader.linkToPrevious;break;case"OddHeader":s=e.oddPageHeader.linkToPrevious;break;case"EvenFooter":s=e.evenPageFooter.linkToPrevious;break;case"OddFooter":s=e.oddPageFooter.linkToPrevious;break;case"FirstPageHeader":s=e.firstPageHeader.linkToPrevious;break;case"FirstPageFooter":s=e.firstPageFooter.linkToPrevious}t.linkToPrevious=s}return t},e.prototype.fetchStyleValue=function(e){var t={};return t.name=e.name,t.type=e.type,sf.base.isNullOrUndefined(e.paragraphFormat)||(t.paragraphFormat=this.fetchParagraphFormat(e.paragraphFormat)),t.characterFormat=this.fetchCharacterFormat(e.characterFormat),sf.base.isNullOrUndefined(e.next)||(t.next=e.next.name),sf.base.isNullOrUndefined(e.basedOn)||(t.basedOn=e.basedOn.name),sf.base.isNullOrUndefined(e.link)||(t.link=e.link.name),JSON.stringify(t)},e.prototype.fetchComments=function(){var e=this.getComments();return!sf.base.isNullOrUndefined(e)&&e.length>0?JSON.stringify(e):""},e.prototype.getComments=function(e){var t=[],i=e||this.documentHelper.comments;if(!sf.base.isNullOrUndefined(i)&&i.length>0){for(var r=0;r<i.length;r++){var n={},o=i[r];if(sf.base.isNullOrUndefined(o.commentStart)||sf.base.isNullOrUndefined(o.commentEnd))i.splice(r,1),r--;else{if(n.date=o.date,n.text=o.text,n.isReply=o.isReply,n.isResolved=o.isResolved,n.author=o.author,n.initial=o.initial,n.commentId=o.commentId,n.userColor=this.documentHelper.getAuthorColor(o.author),o.ownerComment&&o.ownerComment.commentId&&(n.ownerCommentId=o.ownerComment.commentId),!e){var s=this.getComments(o.replyComments);s&&s.length>0&&(n.replyComments=s)}t.push(n)}}return t}},e.prototype.getCellBorder=function(){if(!sf.base.isNullOrUndefined(this.selection.start.paragraph.associatedCell)){var e=this.selection.start.paragraph.associatedCell.cellFormat.borders;return this.sfdtExportModule.writeBorders(e)}return{}},e.prototype.getTableBorder=function(){if(!sf.base.isNullOrUndefined(this.selection.tableFormat.table)){var e=this.selection.tableFormat.table.tableFormat.borders;return this.sfdtExportModule.writeBorders(e)}return{}},e.prototype.getCellShading=function(){var e={};if(!sf.base.isNullOrUndefined(this.selection.tableFormat.table)){var t=this.selection.start.paragraph.associatedCell.cellFormat.shading;e.backgroundColor=t.backgroundColor,e.foregroundColor=t.foregroundColor,e.textureStyle=t.textureStyle}return e},e.prototype.getTableShading=function(){var e={};if(!sf.base.isNullOrUndefined(this.selection.start.paragraph.associatedCell)){var t=this.selection.start.paragraph.associatedCell.cellFormat.shading;e.backgroundColor=t.backgroundColor,e.foregroundColor=t.foregroundColor,e.textureStyle=t.textureStyle}return e},e.prototype.applyCellOption=function(e){if(this.documentHelper.owner.editorHistory.initComplexHistory(this.documentHelper.selection,"CellMarginsSelection"),this.documentHelper.owner.editorModule.initHistory("CellOptions"),!sf.base.isNullOrUndefined(this.documentHelper.selection.start.paragraph.associatedCell)){var t=this.documentHelper.selection.start.paragraph.associatedCell.ownerTable;t=t.combineWidget(this.viewer),this.applyCellmarginsValue(this.documentHelper.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.viewer),this.documentHelper.selection.start,this.documentHelper.selection.end,e),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection,!1),sf.base.isNullOrUndefined(this.documentHelper.owner.editorHistory.currentHistoryInfo)||this.documentHelper.owner.editorHistory.updateComplexHistory()}},e.prototype.applyCellmarginsValue=function(e,t,i,r){if(this.applyCellMarginsInternal(e,r),i.paragraph.associatedCell.ownerRow!==e){var n=e.nextWidget;sf.base.isNullOrUndefined(n)||this.applyCellmarginsValue(n,t,i,r)}},e.prototype.applyCellMarginsInternal=function(e,t){if(!sf.base.isNullOrUndefined(this.documentHelper.owner.editorHistory.currentBaseHistoryInfo)){var i=e.childWidgets[0].cellFormat;t=this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.addModifiedCellOptions(i,t,e.ownerTable)}sf.base.isNullOrUndefined(t)||this.applyCellMarginsForCells(e,t)},e.prototype.applyCellMarginsForCells=function(e,t){for(var i=e.childWidgets,r=0;r<i.length;r++)this.applySubCellMargins(i[r].cellFormat,t);this.calculateGridValue(i[0].ownerTable)},e.prototype.applySubCellMargins=function(e,t){e.leftMargin=t.leftMargin,e.topMargin=t.topMargin,e.rightMargin=t.rightMargin,e.bottomMargin=t.bottomMargin},e.prototype.calculateGridValue=function(e){e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.documentHelper.selection.owner.isLayoutEnabled=!0,this.documentHelper.layout.reLayoutTable(e),this.documentHelper.owner.editorModule.reLayout(this.documentHelper.selection),this.documentHelper.owner.editorModule.updateSelectionTextPosition(!0);var t=this.documentHelper.owner.editorHistory;t&&t.currentBaseHistoryInfo&&(t.currentBaseHistoryInfo.modifiedProperties.length>0&&t.currentBaseHistoryInfo.updateSelection(),t.updateHistory()),this.documentHelper.owner.editorModule.fireContentChange()},e.prototype.applyTableOption=function(e){if(this.documentHelper.owner.editorHistory.initComplexHistory(this.documentHelper.selection,"TableMarginsSelection"),this.documentHelper.owner.editorModule.initHistory("TableOptions"),!sf.base.isNullOrUndefined(this.documentHelper.selection.start.currentWidget.paragraph.associatedCell)){var t=this.documentHelper.selection.start.currentWidget.paragraph.associatedCell.ownerTable,i=(t=t.combineWidget(this.viewer)).tableFormat;sf.base.isNullOrUndefined(this.documentHelper.owner.editorHistory.currentBaseHistoryInfo)||this.documentHelper.owner.editorHistory.currentBaseHistoryInfo.addModifiedTableOptions(i),i.cellSpacing=e.cellSpacing,i.leftMargin=e.leftMargin,i.topMargin=e.topMargin,i.rightMargin=e.rightMargin,i.bottomMargin=e.bottomMargin,this.calculateGridValue(t),sf.base.isNullOrUndefined(this.documentHelper.owner.editorHistory.currentHistoryInfo)||this.documentHelper.owner.editorHistory.updateComplexHistory()}},e.prototype.applyTableProperties=function(e,t,i){this.documentHelper.owner.editorModule.initComplexHistory("TableProperties"),this.documentHelper.owner.editorModule.onTableFormat(e),this.documentHelper.owner.editorModule.onRowFormat(t),this.documentHelper.owner.editorModule.onCellFormat(i),this.documentHelper.owner.editorHistory.updateComplexHistory()},e.prototype.enableRepeatHeader=function(){var e=this.documentHelper.selection,t=e.start,i=e.end;e.isForward||(t=e.end,i=e.start);var r=t.paragraph.associatedCell,n=i.paragraph.associatedCell;return 0===r.ownerRow.index&&n.ownerTable.equals(r.ownerTable)},e.prototype.fireZoomFactorChange=function(){this.dotNetRef.invokeMethodAsync("ZoomFactorChange",this.documentHelper.zoomFactor)},e.prototype.fireBeforeFormFieldFill=function(e){return Fd(this,void 0,void 0,(function(){return Cd(this,(function(t){switch(t.label){case 0:return[4,this.dotNetRef.invokeMethodAsync("BeforeFieldFill",JSON.stringify(e))];case 1:return[2,t.sent()]}}))}))},e.prototype.fireAfterFormFieldFill=function(){},e.prototype.fireBeforePaneSwitch=function(e){this.dotNetRef.invokeMethodAsync("BeforePaneSwitch",e)},e.prototype.fireServiceFailure=function(e){},e.prototype.fireViewChange=function(){if(this.viewer&&this.documentHelper.pages.length>0&&this.viewer.visiblePages.length>0){var e=this.viewer.visiblePages,t={startPage:e[0].index+1,endPage:e[e.length-1].index+1};this.dotNetRef.invokeMethodAsync("ViewChange",JSON.stringify(t))}},e.prototype.fireCustomContextMenuSelect=function(e){},e.prototype.fireCustomContextMenuBeforeOpen=function(e){},e.prototype.showParagraphDialog=function(e){},e.prototype.showPageSetupDialog=function(){},e.prototype.showFontDialog=function(e){},e.prototype.showCellOptionsDialog=function(){},e.prototype.showTableOptionsDialog=function(){},e.prototype.showTableDialog=function(){},e.prototype.showTableOfContentsDialog=function(){},e.prototype.showStyleDialog=function(){},e.prototype.showHyperlinkDialog=function(){},e.prototype.showBookmarkDialog=function(){},e.prototype.showStylesDialog=function(){},e.prototype.showListDialog=function(){},e.prototype.showTablePropertiesDialog=function(){},e.prototype.showBordersAndShadingDialog=function(){},e.prototype.fireBeforeAcceptReject=function(e){return Fd(this,void 0,void 0,(function(){return Cd(this,(function(t){switch(t.label){case 0:return[4,this.dotNetRef.invokeMethodAsync("BeforeAcceptReject",JSON.stringify(e))];case 1:return[2,t.sent()]}}))}))},e.prototype.fireKeyDownInternal=function(e){return Fd(this,void 0,void 0,(function(){return Cd(this,(function(t){switch(t.label){case 0:return[4,this.dotNetRef.invokeMethodAsync("KeyDown",JSON.stringify(e))];case 1:return[2,t.sent()]}}))}))},e.prototype.requiredModules=function(){this.parser=new Wl(this.documentHelper),this.enablePrint&&sf.base.isNullOrUndefined(this.printModule)&&(this.printModule=new s),(this.enableSfdtExport||this.enableWordExport||this.enableTextExport||this.enableSelection||this.enableEditor)&&sf.base.isNullOrUndefined(this.sfdtExportModule)&&(this.sfdtExportModule=new md(this.documentHelper)),this.enableWordExport&&sf.base.isNullOrUndefined(this.wordExportModule)&&(this.wordExportModule=new fd),this.enableTextExport&&sf.base.isNullOrUndefined(this.textExportModule)&&(this.textExportModule=new ud),(this.enableSelection||this.enableSearch||this.enableEditor)&&(sf.base.isNullOrUndefined(this.selectionModule)&&(this.selectionModule=new Vl(this)),this.enableContextMenu),this.enableSearch&&(sf.base.isNullOrUndefined(this.searchModule)&&(this.searchModule=new Xl(this)),this.enableOptionsPane&&sf.base.isNullOrUndefined(this.optionsPaneModule)&&(this.optionsPaneModule=new Jl)),sf.base.isNullOrUndefined(this.documentEditorSettings)||(this.documentEditorSettings.enableOptimizedTextMeasuring?this.textMeasureHelper=new yd(this.documentHelper):this.textMeasureHelper=new vd(this.documentHelper)),this.enableEditor&&(sf.base.isNullOrUndefined(this.editorModule)&&(this.editorModule=new hd(this.documentHelper)),this.enableImageResizer&&sf.base.isNullOrUndefined(this.imageResizerModule)&&(this.imageResizerModule=new cd(this,this.documentHelper)),this.enableEditorHistory&&sf.base.isNullOrUndefined(this.editorHistoryModule)&&(this.editorHistoryModule=new sd(this)),this.enableHyperlinkDialog,this.enableTableDialog,this.enableBookmarkDialog,this.enableTableOfContentsDialog,this.enablePageSetupDialog,this.enableStyleDialog,this.enableListDialog,this.enableParagraphDialog,this.enableFontDialog,this.enableTablePropertiesDialog,this.enableBordersAndShadingDialog,this.enableTableOptionsDialog,this.enableSpellCheck,this.enableFormField)},e.prototype.open=function(e){sf.base.isNullOrUndefined(this.viewer)||(this.showComments=!1,this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.lists=[],this.documentHelper.abstractLists=[],this.documentHelper.styles=new xl,this.documentHelper.cachedPages=[],this.showRevisions=!1,this.isSpellCheck&&(this.spellChecker.enableOptimizedSpellCheck||(this.documentHelper.triggerElementsOnLoading=!0,this.documentHelper.triggerSpellCheck=!0)),!sf.base.isNullOrUndefined(e)&&this.viewer&&(this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.onDocumentChanged(this.parser.convertJsonToDocument(e)),this.editorModule&&this.editorModule.intializeDefaultStyles()),this.isSpellCheck&&(this.spellChecker.enableOptimizedSpellCheck||(this.documentHelper.triggerElementsOnLoading=!1,this.documentHelper.triggerSpellCheck=!1)))},e.prototype.scrollToPage=function(e){return!(sf.base.isNullOrUndefined(this.viewer)||e<1||e>this.documentHelper.pages.length)&&(this.viewer.scrollToPage(e-1),!0)},e.prototype.enableAllModules=function(){this.enablePrint=this.enableSfdtExport=this.enableWordExport=this.enableTextExport=this.enableSelection=this.enableContextMenu=this.enableSearch=this.enableOptionsPane=this.enableEditor=this.enableImageResizer=this.enableEditorHistory=this.enableHyperlinkDialog=this.enableTableDialog=this.enableBookmarkDialog=this.enableTableOfContentsDialog=this.enablePageSetupDialog=this.enableStyleDialog=this.enableListDialog=this.enableParagraphDialog=this.enableFontDialog=this.enableTablePropertiesDialog=this.enableBordersAndShadingDialog=this.enableTableOptionsDialog=this.enableComment=this.enableFormField=!0,this.requiredModules()},e.prototype.resize=function(e,t){this.element&&(!sf.base.isNullOrUndefined(e)&&e>200&&(this.element.style.width=e+"px"),!sf.base.isNullOrUndefined(t)&&t>200&&(this.element.style.height=t+"px")),this.documentHelper&&this.documentHelper.updateViewerSize(),this.rulerHelper&&this.documentEditorSettings&&this.documentEditorSettings.showRuler&&this.rulerHelper.updateRuler(this,!1)},e.prototype.getFormFieldNames=function(){for(var e=[],t=this.documentHelper.formFields,i=0;i<t.length;i++)""!==t[i].formFieldData.name&&e.push(t[parseInt(i.toString(),10)].formFieldData.name);return e},e.prototype.exportAsImage=function(e,t){if(sf.base.isNullOrUndefined(this.viewer))throw new Error("Invalid operation.");if(this.printModule){var i="Png"===t?"image/png":"image/jpeg";return this.printModule.exportAsImage(this.documentHelper,e,i)}},e.prototype.exportAsPath=function(e){if(!sf.base.isNullOrUndefined(e)&&e<=this.documentHelper.pages.length&&e>=1){var t=this.documentHelper.pages[e-1];this.documentHelper.render.isExporting=!0,this.documentHelper.render.renderWidgets(t,0,0,0,0);var i=this.documentHelper.render.pageCanvas.toDataURL();return this.documentHelper.render.pageCanvas.getContext("2d").renderedPath="",this.documentHelper.render.isExporting=!1,i}},e.prototype.getFormFieldInfo=function(e){for(var t=this.documentHelper.formFields,i=0;i<t.length;i++)if(t[i].formFieldData.name===e&&""!==t[i].formFieldData.name)return t[parseInt(i.toString(),10)].formFieldData.getFormFieldInfo()},e.prototype.setFormFieldInfo=function(e,t){for(var i=this.documentHelper.formFields,r=0;r<i.length;r++)if(i[parseInt(r.toString(),10)].formFieldData.name===e&&""!==i[parseInt(r.toString(),10)].formFieldData.name){var n=i[parseInt(r.toString(),10)];return void(this.selection&&(this.selection.selectFieldInternal(n),this.editor&&this.editor.setFormField(n,t)))}},e.prototype.resetFormFields=function(e){for(var t=this.documentHelper.formFields,i=0;i<t.length;i++)(sf.base.isNullOrUndefined(e)||e===t[parseInt(i.toString(),10)].formFieldData.name)&&(t[parseInt(i.toString(),10)].formFieldData instanceof ba?this.editor.updateFormField(t[parseInt(i.toString(),10)],t[parseInt(i.toString(),10)].formFieldData.defaultValue,!0):t[parseInt(i.toString(),10)].formFieldData instanceof xa?this.editor.toggleCheckBoxFormField(t[parseInt(i.toString(),10)],!0,t[parseInt(i.toString(),10)].formFieldData.defaultValue):t[parseInt(i.toString(),10)].formFieldData instanceof Ia&&this.editor.updateFormField(t[parseInt(i.toString(),10)],0,!0))},e.prototype.importFormData=function(e){for(var t=this.documentHelper.formFields,i=0;i<e.length;i++)for(var r=e[parseInt(i.toString(),10)],n=r.fieldName,o=0;o<t.length;o++)t[parseInt(o.toString(),10)].formFieldData.name===n&&(t[parseInt(o.toString(),10)].formFieldData instanceof xa?this.editor.toggleCheckBoxFormField(t[parseInt(o.toString(),10)],!0,r.value):(t[parseInt(o.toString(),10)].formFieldData instanceof ba||t[parseInt(o.toString(),10)].formFieldData instanceof Ia)&&this.editor.updateFormField(t[parseInt(o.toString(),10)],r.value))},e.prototype.exportFormData=function(){for(var e=[],t=this.documentHelper.formFields,i=0;i<t.length;i++)if(""!==t[parseInt(i.toString(),10)].formFieldData.name){var r={fieldName:"",value:""};if(r.fieldName=t[parseInt(i.toString(),10)].formFieldData.name,t[parseInt(i.toString(),10)].formFieldData instanceof xa)r.value=t[parseInt(i.toString(),10)].formFieldData.checked;else if(t[parseInt(i.toString(),10)].formFieldData instanceof ba){var n="",o=RegExp(this.documentHelper.textHelper.getEnSpaceCharacter(),"gi");""===n.replace(o,"")&&(n=""),r.value=n}else t[parseInt(i.toString(),10)].formFieldData instanceof Ia&&(r.value=t[parseInt(i.toString(),10)].formFieldData.selectedIndex);e.push(r)}return e},e.prototype.updateFields=function(){for(var e=0;e<this.documentHelper.fields.length;e++){var t=this.documentHelper.fields[parseInt(e.toString(),10)];if(0===this.selection.getFieldCode(t).toLowerCase().trim().indexOf("ref ")){var i=t.line.paragraph;sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(this.selection)||sf.base.isNullOrUndefined(this.selection.getPage(i))||this.selection.updateRefField(t)}}},e.prototype.focusIn=function(){this.viewer&&this.documentHelper.updateFocus()},e.prototype.fitPage=function(e){sf.base.isNullOrUndefined(e)&&(e="None"),this.viewer&&(this.viewer.pageFitType=e)},e.prototype.print=function(e){if(sf.base.isNullOrUndefined(this.viewer))throw new Error("Invalid operation.");if(!this.printModule)throw new Error("Invalid operation. Print is not enabled.");"Continuous"===this.layoutType?(this.documentHelper.isWebPrinting=!0,this.viewer=new Qs(this),this.editor.layoutWholeDocument(),this.printModule.print(this.documentHelper,e),this.viewer=new $s(this),this.editor.layoutWholeDocument(),this.documentHelper.isWebPrinting=!1):this.printModule.print(this.documentHelper,e)},e.prototype.serialize=function(){if(!(this.enableSfdtExport&&this.sfdtExportModule instanceof md))throw new Error("Invalid operation. Sfdt export is not enabled.");return this.sfdtExportModule.serialize()},e.prototype.save=function(e,t){var i=this;if(e=e||"Untitled",sf.base.isNullOrUndefined(this.documentHelper))throw new Error("Invalid operation.");if("Docx"===t||"Dotx"===t&&this.wordExportModule)this.wordExportModule&&(this.documentHelper.owner.sfdtExportModule.isWordExport=!0,this.wordExportModule.save(this.documentHelper,e,t),this.documentHelper.owner.sfdtExportModule.isWordExport=!1);else if("Txt"===t&&this.textExportModule)this.textExportModule.save(this.documentHelper,e);else{if("Sfdt"!==t||!this.enableSfdtExport||!this.sfdtExportModule)throw new Error("Invalid operation. Specified export is not enabled.");if(this.documentEditorSettings.optimizeSfdt){var r=this.serialize(),n=new Blob([r],{type:"application/json"}),o=new sf.compression.ZipArchiveItem(n,"sfdt"),s=new sf.compression.ZipArchive;s.addItem(o),s.saveAsBlob().then((function(t){i.zipArchiveBlobToSfdtFile(t,e)}))}else{r=this.serialize(),n=new Blob([r],{type:"application/json"});sf.fileutils.Save.save(e+".sfdt",n)}}},e.prototype.zipArchiveBlobToSfdtFile=function(e,t){var i=new FileReader;i.readAsDataURL(e),i.onload=function(){var e=i.result.split(",")[1],r={};r.sfdt=e;var n=new Blob([JSON.stringify(r)],{type:"application/json"});sf.fileutils.Save.save(t+".sfdt",n)}},e.prototype.saveAsBlob=function(e){var t=this;if(sf.base.isNullOrUndefined(this.viewer))throw new Error("Invalid operation");return new Promise((function(i,r){"Docx"!==e&&"Dotx"!==e||!t.wordExportModule?"Txt"===e&&t.textExportModule?i(t.textExportModule.saveAsBlob(t.documentHelper)):"Sfdt"===e&&t.enableSfdtExport&&t.sfdtExportModule&&(t.documentEditorSettings.optimizeSfdt?t.sfdtExportModule.saveAsBlob(t.documentHelper).then((function(e){t.getBase64StringFromBlob(e).then((function(e){var t={};t.sfdt=e;var r=new Blob([JSON.stringify(t)],{type:"application/json"});i(r)}))})):i(t.sfdtExportModule.saveAsBlobNonOptimized(t.documentHelper))):i(t.wordExportModule.saveAsBlob(t.documentHelper,e))}))},e.prototype.getBase64StringFromBlob=function(e){return new Promise((function(t,i){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){var e=r.result.split(",")[1];t(e)}}))},e.prototype.openBlank=function(){var e=[];e.push(this.createNewBodyWidget());var t=this.parser.parseHeaderFooter({header:{},footer:{},evenHeader:{},evenFooter:{},firstPageHeader:{},firstPageFooter:{}},void 0);if(this.viewer){if(this.clearPreservedCollectionsInViewer(),this.documentHelper.userCollection.push("Everyone"),this.documentHelper.cachedPages=[],this.documentHelper.setDefaultDocumentFormat(),this.documentHelper.headersFooters.push(t),this.editorModule){this.editorModule.intializeDefaultStyles();for(var i=this.documentHelper.styles.findByName("Normal"),r=0;r<e.length;r++){var n=e[parseInt(r.toString(),10)].childWidgets[0];n.paragraphFormat.baseStyle=i,n.paragraphFormat.listFormat.baseStyle=i}}this.documentHelper.onDocumentChanged(e)}},e.prototype.createNewBodyWidget=function(){var e=new aa;e.index=0,e.sectionFormat=new h(e),this.sectionFormat&&this.parser.parseSectionFormat(0,this.sectionFormat,e.sectionFormat);var t=new ca;return t.index=0,t.paragraphFormat=new ul(t),t.characterFormat=new T(t),e.childWidgets.push(t),t.containerWidget=e,e},e.prototype.getStyleNames=function(e){return this.viewer?this.documentHelper.styles.getStyleNames(e):[]},e.prototype.getStyles=function(e){return this.viewer?this.documentHelper.styles.getStyles(e):[]},e.prototype.getBookmarks=function(){var e=[];return this.viewer&&(e=this.documentHelper.getBookmarks(!0)),e},e.prototype.showDialog=function(e){this.dotNetRef.invokeMethodAsync("ShowDialog",e)},e.prototype.showTabDialog=function(){},e.prototype.showOptionsPane=function(){},e.prototype.showRestrictEditingPane=function(){},e.prototype.destroy=function(){this.destroyDependentModules(),sf.base.isNullOrUndefined(this.documentHelper)||this.documentHelper.destroy(),this.viewer=void 0,this.findResultsList=[],this.findResultsList=void 0},e.prototype.destroyDependentModules=function(){this.printModule&&(this.printModule.destroy(),this.printModule=void 0),this.sfdtExportModule&&(this.sfdtExportModule.destroy(),this.sfdtExportModule=void 0),this.optionsPaneModule&&(this.optionsPaneModule=void 0),this.trackChangesPane&&(this.trackChangesPane.destroy(),this.trackChangesPane=void 0),this.searchModule&&(this.searchModule.destroy(),this.searchModule=void 0),this.editorModule&&(this.editorModule.destroy(),this.editorModule=void 0),this.selectionModule&&(this.selectionModule.destroy(),this.selectionModule=void 0),this.editorHistoryModule&&(this.editorHistoryModule.destroy(),this.editorHistoryModule=void 0),this.textExportModule&&(this.textExportModule.destroy(),this.textExportModule=void 0),this.wordExportModule&&(this.wordExportModule.destroy(),this.wordExportModule=void 0),this.spellCheckerModule&&(this.spellCheckerModule.destroy(),this.spellCheckerModule=void 0)},e}(),kd=function(e,t,i,r){return new(i||(i=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){e.done?n(e.value):new i((function(t){t(e.value)})).then(s,a)}l((r=r.apply(e,t||[])).next())}))},Sd=function(e,t){var i,r,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};return{sendHandler:null,info:null,isSpellChecking:null,elementRef:null,dotnetRef:null,blobInfo:{},initialize:function(e,t,i,r,n){sf.base.enableBlazorMode();var o=new Wd(e,t,r,i,n,this);o.preRender(),o.render(),this.elementRef=t,this.dotnetRef=r,this.sendHandler=M.prototype.send,M.prototype.send=this.docEditRequestHandler.bind(this)},destroy:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||(t.isDestroyed=!0)},updateOptions:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(r.setOptions(t,r.options,!0),r.options=t),r.focusIn()},getClientSizeFromDOM:function(e){var t=e.getBoundingClientRect();return t.width+":"+t.height},checkAndAutoResizeDocumentEditor:function(e,t,i){var r=this.getClientSizeFromDOM(t);if(i!==r&&"0:0"!==r){i=r;var n=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.element)||n.resize()}return i},docEditRequestHandler:function(e){return kd(this,void 0,void 0,(function(){var t,i,r,n,o,s;return Sd(this,(function(a){switch(a.label){case 0:return"string"!=typeof e?[3,1]:(""!==JSON.parse(e).LanguageID&&this.sendHandler.call(e),[3,7]);case 1:return e.action="SystemClipboard",t=window.sfBlazor.getCompInstance(e.dataId),i=void 0,t.enableChunkMessages?[3,3]:[4,this.dotnetRef.invokeMethodAsync("SystemClipboard",e)];case 2:return i=a.sent(),[3,6];case 3:return r=void 0,r=".rtf"===e.type?new Blob([e.content],{type:"application/msword"}):new Blob([e.content],{type:"text/html"}),[4,this.docEditFileReaderArrayBuffer(r)];case 4:return n=a.sent(),(o=this.getBlobInfo(n)).type=e.type,[4,this.dotnetRef.invokeMethodAsync("SystemClipboardAsChunk",o)];case 5:i=a.sent(),a.label=6;case 6:s={data:JSON.parse(i)},t.editor.pasteRequestHandler.successHandler(s),a.label=7;case 7:return[2]}}))}))},getSfdtText:function(e){return kd(this,void 0,void 0,(function(){var t,i,r,n;return Sd(this,(function(o){switch(o.label){case 0:return t=window.sfBlazor.getCompInstance(e),sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)?[3,3]:(i=t.selection.sfdt,sf.base.isNullOrUndefined(i)?[2,{id:null,byteSize:0,length:0}]:[3,1]);case 1:return r=new Blob([i],{type:"text/html"}),[4,this.docEditFileReaderArrayBuffer(r)];case 2:return n=o.sent(),[2,this.getBlobInfo(n)];case 3:return[2]}}))}))},openblank:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.openBlank(),t&&i.focusIn())},loadDocument:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.open(t),i.enableAutoFocus&&i.focusIn())},loadTextDocument:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.documentHelper.openTextFile(t),i.enableAutoFocus&&i.focusIn())},insertTable:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.editor.insertTable(t,i)},goToHeader:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.goToHeader(),t.focusIn()},goToFooter:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.goToFooter(),t.focusIn()},insertPageNumber:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.insertPageNumber()},undo:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editorHistory.undo(),t.focusIn()},redo:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editorHistory.redo(),t.focusIn()},updateFields:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.updateFields()},canUndo:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.editorHistory.canUndo()),t},canRedo:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.editorHistory.canRedo()),t},getBookMarks:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.getBookmarks()),t},getText:function(e,t){var i=void 0,r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.selection.getText(t)),i},sfdt:function(e,t){var i=void 0,r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.selection.sfdt),i},insertHyperlinkInternal:function(e,t,i,r,n){var o=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.element)||o.editor.insertHyperlinkInternal(t,i,r,n)},insertTableOfContents:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertTableOfContents(t),i.focusIn()},insertText:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertText(t)},applyStyle:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.applyStyle(t,!0)},insertRow:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertRow(t)},insertColumn:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertColumn(t)},deleteTable:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.deleteTable()},deleteRow:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.deleteRow(),t.focusIn()},deleteColumn:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.deleteColumn(),t.focusIn()},canMergeCells:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.canMergeCells()},insertPageBreak:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.insertPageBreak(),t.focusIn()},toggleBold:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.toggleBold(),t.focuIn()},toggleItalic:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.toggleItalic(),t.focuIn()},toggleSubscript:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.toggleSubscript(),t.focuIn()},toggleSuperscript:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.toggleSuperscript(),t.focuIn()},toggleUnderline:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.toggleUnderline(t),i.focuIn()},toggleHighlightColor:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.toggleHighlightColor(t)},toggleStrikethrough:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.toggleStrikethrough(t),i.focuIn()},toggleTextAlignment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.toggleTextAlignment(t),i.focuIn()},toggleBaselineAlignment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.toggleBaselineAlignment(t)},applyBullet:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.editor.applyBullet(t,i),r.focusIn()},applyNumbering:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(t="%"+(r.selection.paragraphFormat.listLevelNumber+1)+".",r.editor.applyNumbering(t,i)),r.focusIn()},paste:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.paste(t)},clearFormatting:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.clearFormatting(),t.focuIn()},createStyle:function(e,t){var i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)?null:i.editor.createStyle(i.documentHelper.preDefinedStyles.get(t))},closeHeaderFooter:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.closeHeaderFooter()},selectAll:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectAll()},selectLine:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectLine()},selectCurrentWord:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectCurrentWord()},selectParagraph:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectParagraph()},selectTable:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectTable()},mergeCells:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.mergeCells()},autoFitTable:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.autoFitTable(t)},fitPage:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.fitPage(t)},updateZoomFactor:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.setOptions({zoomFactor:parseInt(t,0)/100},{zoomFactor:i.options.zoomFactor},!1)},goToPage:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.selection.goToPage(t),i.focusIn()},extendToWordStart:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.extendToWordStart()},insertEditingRegion:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.insertEditingRegion()},moveToLineStart:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.moveToLineStart()},insertSectionBreak:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertSectionBreak(t),i.focusIn()},insertColumnBreak:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.insertColumnBreak(),t.focusIn()},enforceProtection:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.element)){var o=[t,i],s={data:JSON.stringify(o)};n.editor.enforceProtectionInternal(s,r)}},stopProtection:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)){var n=[t,i],o={data:JSON.stringify(n)};r.editor.onUnProtectionSuccess(o)}return r.documentHelper.isDocumentProtected},getCurrentSaltValue:function(e){var t=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)?"":t.documentHelper.saltValue},insertEditRangeElement:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.isHighlightEditRegion=!0,i.editor.insertEditRangeElement(t))},removeUserRestrictions:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.removeUserRestrictions(t)},setIsHighlightEditRegion:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.isHighlightEditRegion=t)},navigateNextEditRegion:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.navigateToNextEditingRegion()},showAllEditingRegion:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.showAllEditingRegion()},deleteComment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.deleteCommentInternal(this.getComment(e,t))},getCurrentEditRangeUser:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)&&t.documentHelper.selection.checkSelectionIsAtEditRegion()){var i=t.documentHelper.selection.getEditRangeStartElement();if(i)return i.user}return""},hasEditRange:function(e){var t=window.sfBlazor.getCompInstance(e);return!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)&&t.documentHelper.editRanges.length>0},resolveReOpenComment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t.isResolved?i.editor.resolveComment(this.getComment(e,t)):i.editor.reopenComment(this.getComment(e,t)))},updateCommentText:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(this.getComment(e,t).text=t.text)},addEmptyComment:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectComment(t.editor.insertCommentInternal(""))},addReplyComment:function(e,t,i){var r,n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.element)){var o=this.getComment(e,t);n.editor.replyComment(o,i),r=JSON.stringify(n.editor.getCommentObj(o.replyComments[o.replyComments.length-1]))}return r},selectComment:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=this.getComment(e,t);i.selection.selectComment(r)}},updateCommentPaneHeight:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r,n=i.element.getBoundingClientRect();r=n.height>0?n.height:200;var o=t.getElementsByClassName("e-tab-header")[0].getBoundingClientRect().height,s=t.getElementsByClassName("e-de-cmt-toolbar")[0].getBoundingClientRect().height;t.getElementsByClassName("e-de-cmt-container")[0].style.height=r-o-s+"px"}},setFocusToElement:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||t.focus()},updateTextBoxHeight:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||setTimeout((function(){t.style.height="auto";var e=t.scrollHeight;t.style.height=e+"px"}))},getComment:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element))for(var r=i.documentHelper.comments,n=0;n<r.length;n++)if(t.isReply)for(var o=0;o<r[n].replyComments.length;o++){var s=r[n].replyComments[o];if(s.commentId==t.commentId)return s}else if(r[n].commentId==t.commentId)return r[n]},navigateNextComment:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.navigateNextComment()},navigatePreviousComment:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.navigatePreviousComment()},increaseIndent:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.increaseIndent(),t.focusIn()},decreaseIndent:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.decreaseIndent(),t.focusIn()},insertField:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertField(t)},getIsInField:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.isInField),t},insertHyperlink:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.editor.insertHyperlink(t,i)},removeHyperlink:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.removeHyperlink()},insertBookmark:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertBookmark(t)},clearList:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.clearList()},setRedoLimit:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.editorHistory.redoLimit=t)},getRedoLimit:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.editorHistory.redoLimit),t},setIndex:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||setTimeout((function(){var e=document.activeElement;i.searchModule.searchResults.index=t,e.focus()}),10)},getIndex:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.searchModule.searchResults.index),t},findAll:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);return!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)&&(r.documentHelper.owner.findResultsList=[],r.searchModule.findAll(t,i),r.searchModule.textSearchResults.length>0)?(r.searchModule.addFindResultView(r.searchModule.textSearchResults),r.documentHelper.owner.findResultsList):[]},find:function(e,t,i){var r,n,o=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.element)||(o.documentHelper.owner.findResultsList=[],r=o.searchModule.textSearch.findAll(t,i),sf.base.isNullOrUndefined(r)||(o.searchModule.addFindResultView(r),n=o.documentHelper.owner.findResultsList)),n},navigateNextResult:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.searchModule.find(t,i)},navigatePreviousResult:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.searchModule.find(t,i)},replace:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.element)){var o=n.documentHelper,s=o.owner.searchModule.textSearchResults;if(""!==t&&!sf.base.isNullOrUndefined(t)&&null!=o.owner.selection){var a=o.owner.selection.text;if(o.owner.selection.isEmpty||(o.owner.selection.isForward?o.owner.selection.selectContent(o.owner.selection.start,!0):o.owner.selection.selectContent(o.owner.selection.end,!0)),!sf.base.isNullOrUndefined(s)&&!sf.base.isNullOrUndefined(s.currentSearchResult)){var l=s.currentSearchResult;if(o.owner.searchModule.navigate(l),l.text===a){var d=sf.base.isNullOrUndefined(i)?"":i;o.owner.searchModule.replace(d,l,s)}}}}},replaceAll:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.searchModule.replaceAllInternal(t,i),r.focusIn()},getsearchresults:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.searchModule.searchResults},clear:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.searchModule.searchResults.clear},setBackground:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.background=t)},getBackground:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.background),t},setBottomMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.bottomMargin=t)},getBottomMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.bottomMargin),t},setLeftMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.leftMargin=t)},getLeftMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.leftMargin),t},setPreferredWidth:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.preferredWidth=t)},getPreferredWidth:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.preferredWidth),t},setRightMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.rightMargin=t)},getRightMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.rightMargin),t},setTopMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.topMargin=t)},getTopMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.topMargin),t},setPreferredWidthType:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.preferredWidthType=t)},getPreferredWidthType:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.preferredWidthType),t},setVerticalAlignment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.verticalAlignment=t)},getVerticalAlignment:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.cellFormat.verticalAlignment),t},insertImage:function(e,t,i,r,n){var o=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.element)||o.editor.insertImage(t,i,r,n)},resizeWindow:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||setTimeout((function(){t.resize()}),100)},resize:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||r.selection.imageFormat.resize(t,i)},getImageHeight:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.imageFormat.height},getImageWidth:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.imageFormat.width},getAlternateTextAsync:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.imageFormat.alternateText},setAlternateTextAsync:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.imageFormat.alternateText=t)},applyImageAlternativeText:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.selection.imageFormat.applyImageAlternativeText(t)},setAfterSpacing:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.afterSpacing=t)},getAfterSpacing:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.afterSpacing),t},setBeforeSpacing:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.beforeSpacing=t)},getBeforeSpacing:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.beforeSpacing),t},setBidi:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.bidi=t)},getBidi:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.bidi),t},setContextualSpacing:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.contextualSpacing=t)},getContextualSpacing:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.contextualSpacing),t},setFirstLineIndent:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.firstLineIndent=t)},getFirstLineIndent:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.firstLineIndent),t},setLeftIndent:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.leftIndent=t)},getLeftIndent:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.leftIndent),t},setLineSpacing:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.lineSpacing=t)},getLineSpacing:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.lineSpacing),t},getHeadingData:function(e){var t=[],i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element))for(var r=0;r<i.editorModule.HeadingDataSource.length;r++)t.push(JSON.stringify(i.editorModule.HeadingDataSource[r]));return t},setChangeCase:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.changeCase(t)},setListLevelNumber:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.listLevelNumber=t)},getListLevelNumber:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.listLevelNumber),t},setRightIndent:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.rightIndent=t)},getRightIndent:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.rightIndent),t},getListText:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.paragraphFormat.listText},setLineSpacingType:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.lineSpacingType=t),i.focusIn()},getLineSpacingType:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.lineSpacingType),t},setTextAlignment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.textAlignment=t)},getTextAlignment:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.textAlignment),t},setBaselineAlignment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.baselineAlignment=t)},getBaselineAlignment:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.baselineAlignment),t},setBold:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.bold=t)},getBold:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.bold),t},setItalic:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.italic=t)},getItalic:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.italic),t},setFontColor:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.fontColor=t)},getFontColor:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.fontColor),t},setFontFamily:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.fontFamily=t)},getFontFamily:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.fontFamily),t},setFontSize:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.fontSize=t)},exportAsImage:function(e,t,i){var r,n=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.element)||(r=n.exportAsImage(t,i)),r},getFontSize:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.fontSize),t},setHighlightColor:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.highlightColor=t)},getHighlightColor:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.highlightColor),t},setStrikethrough:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.strikethrough=t)},getStrikethrough:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.strikethrough),t},setUnderline:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.underline=t)},getUnderline:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.underline),t},selectRow:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.selectRow()},setAllowBreakAcrossPages:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.rowFormat.allowBreakAcrossPages=t)},getAllowBreakAcrossPages:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.rowFormat.allowBreakAcrossPages),t},setIsHeader:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.rowFormat.isHeader=t)},getIsHeader:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.rowFormat.isHeader),t},setRowHeight:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.rowFormat.height=t)},getRowHeight:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.rowFormat.height),t},setHeightType:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.rowFormat.heightType=t)},getHeightType:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.rowFormat.heightType),t},setSectionBottomMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.bottomMargin=t)},getSectionBottomMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.bottomMargin),t},setFooterDistance:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.footerDistance=t)},getFooterDistance:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.footerDistance),t},setHeaderDistance:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.headerDistance=t)},getHeaderDistance:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.headerDistance),t},setSectionLeftMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.leftMargin=t)},getSectionLeftMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.leftMargin),t},setPageHeight:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.pageHeight=t)},getPageHeight:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.pageHeight),t},setPageWidth:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.pageWidth=t)},getPageWidth:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.pageWidth),t},setSectionRightMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.rightMargin=t)},getSectionRightMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.rightMargin),t},setSectionTopMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.topMargin=t)},getSectionTopMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.topMargin),t},setDifferentFirstPage:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.differentFirstPage=t)},setLinkToPrevious:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element))switch(i.selection.start.paragraph.containerWidget.headerFooterType){case"OddHeader":i.selection.sectionFormat.oddPageHeader.linkToPrevious=t;break;case"OddFooter":i.selection.sectionFormat.oddPageFooter.linkToPrevious=t;break;case"EvenHeader":i.selection.sectionFormat.evenPageHeader.linkToPrevious=t;break;case"EvenFooter":i.selection.sectionFormat.evenPageFooter.linkToPrevious=t;break;case"FirstPageHeader":i.selection.sectionFormat.firstPageHeader.linkToPrevious=t;break;case"FirstPageFooter":i.selection.sectionFormat.firstPageFooter.linkToPrevious=t}},getDifferentFirstPage:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.differentFirstPage),t},setDifferentOddAndEvenPages:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.sectionFormat.differentOddAndEvenPages=t)},getDifferentOddAndEvenPages:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.sectionFormat.differentOddAndEvenPages),t},setTableBackground:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.background=t)},getTableBackground:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.background),t},setTableBottomMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.bottomMargin=t)},getTableBottomMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.bottomMargin),t},setTableCellSpacing:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.cellSpacing=t)},getTableCellSpacing:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.cellSpacing),t},setTableLeftIndent:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.leftIndent=t)},getTableLeftIndent:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.leftIndent),t},setTableLeftMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.leftMargin=t)},getTableLeftMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.leftMargin),t},setTablePreferredWidth:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.preferredWidth=t)},getTablePreferredWidth:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.preferredWidth),t},setTableRightMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.rightMargin=t)},getTableRightMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.rightMargin),t},setTableTopMargin:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.topMargin=t)},getTableTopMargin:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.topMargin),t},setTableBidi:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.bidi=t)},getTableBidi:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.bidi),t},setTablePreferredWidthType:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.preferredWidthType=t)},getTablePreferredWidthType:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.preferredWidthType),t},setTableAlignment:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.tableAlignment=t)},getTableAlignment:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.tableAlignment),t},setTitle:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.table.title=t)},getTitle:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.table.title),t},setDescription:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.tableFormat.table.description=t)},getDescription:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.tableFormat.table.description),t},getListFormat:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.start.paragraph.paragraphFormat.listFormat),t},getList:function(e){var t={},i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.fetchList(i.documentHelper.lists,i.documentHelper.abstractLists)),t},getListLength:function(e){var t=0,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||this.documentHelper.owner.documentHelper.lists.length>0&&(t=this.documentHelper.owner.documentHelper.lists[this.documentHelper.owner.documentHelper.lists.length-1].listId+1),t},getAbstractListLength:function(e){var t=0;return this.documentHelper.owner.documentHelper.abstractLists.length>0&&(t=this.documentHelper.owner.documentHelper.abstractLists[this.documentHelper.owner.documentHelper.abstractLists.length-1].abstractListId+1),t},getListLevel:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.getListLevel(i.selection.start.paragraph)),t},getListLevelPattern:function(e,t){var i,r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.documentHelper.layout.getListLevelPattern(t)),i},setListLevelPattern:function(e,t){var i=window.sfBlazor.getCompInstance(e);!sf.base.isNullOrUndefined(i)&&sf.base.isNullOrUndefined(i.element)},applyListProperties:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.selection.paragraphFormat.setList(t)},applyPageSetupProperties:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new h;if(!sf.base.isNullOrUndefined(t)){if(r.topMargin=t.topMargin,r.bottomMargin=t.bottomMargin,r.leftMargin=t.leftMargin,r.rightMargin=t.rightMargin,r.pageHeight=t.pageHeight,r.pageWidth=t.pageWidth,r.footerDistance=t.footerDistance,r.headerDistance=t.headerDistance,r.differentFirstPage=t.differentFirstPage,r.differentOddAndEvenPages=t.differentOddAndEvenPages,!sf.base.isNullOrUndefined(t.columns)){r.numberOfColumns=0==t.columns.length?1:t.columns.length;for(var n=[],o=0;o<t.columns.length;o++){var s=new c;s.width=x.convertPointToPixel(t.columns[o].width),s.space=x.convertPointToPixel(t.columns[o].space),n.push(s)}r.columns=n}t.pageHeight===r.pageHeight&&t.pageWidth===r.pageWidth&&(r.breakCode=t.breakCode),r.equalWidth=t.equalWidth,r.lineBetweenColumns=t.lineBetweenColumns}i.editor.onApplySectionFormat(void 0,r)}},applyParagraphFormat:function(e,t){var i=new ul,r=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)){if(!sf.base.isNullOrUndefined(t)){i.leftIndent=t.leftIndent,i.rightIndent=t.rightIndent,i.firstLineIndent=t.firstLineIndent,i.lineSpacing=t.lineSpacing,i.lineSpacingType=t.lineSpacingType,i.textAlignment=t.textAlignment,i.outlineLevel=t.outlineLevel;var n=t.textAlignment;t.bidi&&("Right"===n?n="Left":"Left"===n&&(n="Right")),i.textAlignment=n,i.beforeSpacing=t.beforeSpacing,i.afterSpacing=t.afterSpacing,i.spaceBeforeAuto=t.spaceBeforeAuto,i.spaceAfterAuto=t.spaceAfterAuto,i.bidi=t.bidi,i.keepWithNext=t.keepWithNext,i.keepLinesTogether=t.keepLinesTogether,i.widowControl=t.widowControl,i.contextualSpacing=t.contextualSpacing,i.borders=void 0}r.editor.onParagraphFormat(i)}},getDefaultTabWidth:function(e){var t=0,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.documentHelper)||(t=i.documentHelper.defaultTabWidth),t},setDefaultTabWidth:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.documentHelper)||(i.documentHelper.defaultTabWidth=t)},getTabStops:function(e){var t=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.editorModule)?[]:t.editorModule.getTabsInSelection()},removeTabStops:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.editorModule)||i.editorModule.removeTabStops(i.selection.getParagraphsInSelection(),t)},updateTabStops:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.editorModule)||i.editorModule.onApplyParagraphFormat("tabStop",t,!1,!1)},getStyleName:function(e,t){var i,r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.getStyleNames(t)),i},getStyleNamesList:function(e,t){var i="Character"==t?"Character":"Paragraph",r=[],n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.element))for(var o=n.getStyles(i),s=0;s<o.length;s++){var a=o[s];("Paragraph"==t&&"Paragraph"==a.type||"Character"==t&&"Character"==a.type||"Linked"==t&&"Linked"==a.type)&&r.push(a.name)}return r},getStyles:function(e,t){var i,r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.getStyles(t)),i},findByName:function(e,t){var i={},r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.documentHelper.styles.findByName(t)),i=r.fetchStyleValue(i)},layoutWholeDocument:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.layoutWholeDocument()},shiftingEnableDisable:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.isShiftingEnabled=t)},updateStyleValues:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.documentHelper.styles.push(t)},setCharStyleName:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.characterFormat.styleName=t)},setParaStyleName:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.paragraphFormat.styleName=t)},getCharStyleName:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.characterFormat.styleName),t},getParaStyleName:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.paragraphFormat.styleName),t},gotoBookmark:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.selection.selectBookmark(t)},deleteBookmark:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editorModule.deleteBookmark(t)},applyBorderAndShading:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.element)||("Table"===t?(n.editorModule.applyBordersInternal(n.selection.tableFormat.table.tableFormat.borders,i),n.editorModule.applyShading(n.selection.tableFormat.table.tableFormat.shading,r)):(n.editorModule.applyBordersInternal(n.selection.start.paragraph.associatedCell.cellFormat.borders,i),n.editorModule.applyShading(n.selection.start.paragraph.associatedCell.cellFormat.shading,r)))},applyBorders:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new g;i.parser.parseBorders(0,t,r),i.editorModule.onApplyParagraphFormat("borders",r,!1,!1)}},setIsCellFormatApplied:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.documentHelper)||(i.editorModule.isCellFormatApplied=t)},insertFormField:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.editor.insertFormField(t),i.focusIn()},insertTextFormField:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new ba;r.type=t.type,r.name=t.name,r.enabled=t.enabled,r.helpText=t.helpText,r.statusText=t.statusText,r.maxLength=t.maxLength,r.defaultValue=t.defaultValue,r.format=t.format,i.editorModule.editFormField("Text",r)}},exportAsPath:function(e,t){var i,r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i=r.exportAsPath(t)),i},insertCheckBoxFormField:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new xa;r.name=t.name,r.enabled=t.enabled,r.helpText=t.helpText,r.sizeType=t.sizeType,r.size=t.size,r.defaultValue=t.defaultValue,r.checked=t.checked,i.editorModule.editFormField("CheckBox",r)}},insertDropDownFormField:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new Ia;r.name=t.name,r.enabled=t.enabled,r.helpText=t.helpText,r.statusText=t.statusText,r.dropdownItems=t.dropdownItems.slice(),r.selectedIndex=t.selectedIndex,i.editorModule.editFormField("DropDown",r)}},getCurrentField:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.getCurrentFormField()),JSON.stringify(t.formFieldData)},updateFormFieldValue:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=i.selection.getCurrentFormField();r&&i.editorModule.updateFormField(r,t)}},onCharacterFormat:function(e,t){var i=new T;sf.base.isNullOrUndefined(t)||(i.bold=t.bold,i.fontSize=t.fontSize,i.fontFamily=t.fontFamily,i.italic=t.italic,i.baselineAlignment=t.baselineAlignment,i.underline=t.underline,i.fontColor=t.fontColor,i.highlightColor=t.highlightColor,i.strikethrough=t.strikethrough,i.allCaps=t.allCaps);var r=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)){if(r.editor.initHistory("CharacterFormat"),r.selection.isEmpty)return void(r.selection.start.offset===r.selection.getParagraphLength(r.selection.start.paragraph)&&(r.editor.applyCharFormatValueInternal(r.selection,r.selection.start.paragraph.characterFormat,void 0,i),r.editor.reLayout(r.selection)));r.editor.setOffsetValue(r.selection),r.editor.updateSelectionCharacterFormatting("CharacterFormat",i,!1)}},applyCellOption:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new Cl;sf.base.isNullOrUndefined(t)||(r.topMargin=t.topMargin,r.bottomMargin=t.bottomMargin,r.leftMargin=t.leftMargin,r.rightMargin=t.rightMargin),i.applyCellOption(r)}},applyTableOption:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=new Fl;sf.base.isNullOrUndefined(t)||(r.topMargin=t.topMargin,r.bottomMargin=t.bottomMargin,r.leftMargin=t.leftMargin,r.rightMargin=t.rightMargin),i.applyTableOption(r)}},applyTableProperties:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.element)){if(n.editorModule.initComplexHistory("TableProperties"),t){var o=new Fl;o.cellSpacing=t.cellSpacing,t.leftMargin&&(o.leftMargin=t.leftMargin),t.topMargin&&(o.topMargin=t.topMargin),t.rightMargin&&(o.rightMargin=t.rightMargin),t.bottomMargin&&(o.bottomMargin=t.bottomMargin),t.leftIndent&&(o.leftIndent=t.leftIndent),t.tableAlignment&&(o.tableAlignment=t.tableAlignment),t.preferredWidth&&(o.preferredWidth=t.preferredWidth),t.preferredWidthType&&(o.preferredWidthType=t.preferredWidthType),t.bidi&&(o.bidi=t.bidi),t.title&&(o.title=t.title),t.description&&(o.description=t.description),n.editorModule.onTableFormat(o)}if(i){var s=new k;i.isHeader&&(s.isHeader=i.isHeader),i.allowBreakAcrossPages&&(s.allowBreakAcrossPages=i.allowBreakAcrossPages),i.heightType&&(s.heightType=i.heightType),i.height&&(s.height=i.height),n.editorModule.onRowFormat(s)}if(r){var a=new Cl;r.leftMargin&&(a.leftMargin=r.leftMargin),r.topMargin&&(a.topMargin=r.topMargin),r.bottomMargin&&(a.bottomMargin=r.bottomMargin),r.rightMargin&&(a.rightMargin=r.rightMargin),n.editorModule.onCellFormat(a)}n.editorHistory.updateComplexHistory()}},enableRepeatHeader:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.enableRepeatHeader()),t},RowFormatIsInHeader:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.documentHelper.selection.rowFormat.isHeader),t},applyShading:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(i.selection.cellFormat.background=t)},applyBorder:function(e,t,i,r){var n=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(n)||sf.base.isNullOrUndefined(n.element)||n.editor.applyBorders(this.getBorder(t,i,r))},getBorder:function(e,t,i){return{type:e,borderColor:i,lineWidth:t,borderStyle:0===t?"Cleared":"Single"}},initTrackChangesPane:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||(t.trackChangesPane.initialLoad=!0,t.trackChangesPane.initTrackChangePane())},sortByUser:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.trackChangesPane.onUserSelect(t)},sortByRevision:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.trackChangesPane.onTypeSelect(t)},acceptOrRejectChanges:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.trackChangesPane.onMenuSelect(t)},navigatePreviousRevision:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.navigatePreviousRevision()},navigateNextChanges:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.navigateNextRevision()},getHyperlinkField:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)){var i,r,n=t.selection.getHyperlinkField(),o="";if(!sf.base.isNullOrUndefined(n.fieldSeparator)){o=t.selection.getHyperlinkDisplayText(n.fieldSeparator.line.paragraph,n.fieldSeparator,n.fieldEnd,!1,void 0).displayText}return i=t.selection.getLinkText(n,!0),r=t.selection.getLinkText(n,!1),JSON.stringify({displayText:o,link:i,screenTip:r})}return""},isTableSelected:function(e){var t=window.sfBlazor.getCompInstance(e);return!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)&&t.selection.isTableSelected()},getPageCount:function(e){var t=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)?1:t.pageCount},getIsDocumentEmpty:function(e){var t=window.sfBlazor.getCompInstance(e);return!(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element))||t.isDocumentEmpty},getContextType:function(e){var t="",i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.contextType),t},copy:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.copy()},cut:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editor.cut()},pasteInternal:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.isReadOnlyMode||t.editorModule.pasteInternal(void 0)},updateField:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)){var i=t.isReadOnlyMode;t.selection.isReferenceField()&&(!i||i&&"FormFieldsOnly"===t.documentHelper.protectionType)?t.selection.updateRefField():t.editorModule.updateToc()}},navigateHyperlink:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.navigateHyperlink()},copyHyperlink:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.selection.copyHyperlink()},applyContinueNumbering:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editorModule.applyContinueNumbering()},applyRestartNumbering:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.editorModule.applyRestartNumbering(t.selection)},handleAcceptReject:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.selection.handleAcceptReject(t)},spellCheck:function(e,t,i){var r=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)){var n=r.element.id+t;if(i.substring(0,n.length)===n){var o=i.substring(i.lastIndexOf("_")+1);"Add To Dictionary"===o||("Ignore All"===o?this.spellChecker.handleIgnoreAllItems():this.spellChecker.manageReplace(o))}else r.fireCustomContextMenuSelect(i)}},checkEmpty:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.selection.isEmpty),t},checkReadOnly:function(e){var t,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(t=i.isReadOnlyMode),t},hasRevision:function(e){var t=window.sfBlazor.getCompInstance(e);return!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)&&t.selection.hasRevisions()},isContentProtected:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)){var i=t,r=i.documentHelper.isDocumentProtected,n={isDocumentProtected:r,allowFormatting:r&&i.documentHelper.restrictFormatting,isInProtectecRegion:i.editor.restrictEditing,isReadOnly:i.isReadOnly,protectionType:i.documentHelper.protectionType};return JSON.stringify(n)}return""},clearSelectionHighlight:function(e){var t=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(t)||sf.base.isNullOrUndefined(t.element)||t.documentHelper.clearSelectionHighlight()},onIgnore:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)&&!sf.base.isNullOrUndefined(this.info.element)){var i=t;i.spellChecker.manageReplace("Ignore Once",this.info.element),this.removeErrors(t.element),i.spellChecker.checkForNextError()}},removeErrors:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)){var i=t;if(!sf.base.isNullOrUndefined(this.info.text)&&i.spellChecker.errorWordCollection.containsKey(this.info.text)){var r=i.spellChecker.errorWordCollection.get(this.info.text);r.splice(0,1),0===r.length&&i.spellChecker.errorWordCollection.remove(this.info.text)}i.spellChecker.errorWordCollection.length}},onIgnoreAll:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)){var i=t;if(!sf.base.isNullOrUndefined(this.info.element)){var r=this.info.element.text;i.spellChecker.handleIgnoreAllItems({element:this.info.element,text:r}),i.spellChecker.checkForNextError()}}},addToDictionary:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element)&&!sf.base.isNullOrUndefined(this.info.element)){var i=t;i.spellChecker.handleAddToDictionary({element:this.info.element,text:this.info.element.text}),i.spellChecker.errorWordCollection.containsKey(this.info.text)&&i.spellChecker.errorWordCollection.remove(this.info.text)}},onChange:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)&&!sf.base.isNullOrUndefined(t)){this.isSpellChecking=!0;var r=i;r.spellChecker.manageReplace(t,this.info.element),this.removeErrors(i.element),r.spellChecker.checkForNextError()}},onChangeAll:function(e,t){var i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)&&!sf.base.isNullOrUndefined(t)){r.spellChecker.isChangeAll=!0,this.isSpellChecking=!0;for(var r=i,n=r.spellChecker.errorWordCollection.get(this.info.text),o=0;o<n.length;o++)if(n[o]instanceof ka&&!n[o].ischangeDetected)r.spellChecker.manageReplace(t,n[o]);else if(n[o]instanceof Fa){var s=r.spellChecker.getMatchedResultsFromElement(n[o]),a=s.textResults,l=n[o].ischangeDetected?n[o].start.offset:n[o].line.getOffset(n[o],0);r.searchModule.textSearch.updateMatchedTextLocation(s.matches,a,s.elementInfo,0,n[o],!1,null,l);for(var d=0;d<a.length;d++){var h=r.spellChecker.createErrorElementWithInfo(a.innerList[d],n[o]);r.spellChecker.manageReplace(t,h)}}r.spellChecker.errorWordCollection.containsKey(this.info.text)&&r.spellChecker.errorWordCollection.remove(this.info.text),r.spellChecker.checkForNextError(),r.spellChecker.isChangeAll=!1}},getErrorString:function(e){var t=[],i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||this.info.text&&t.push(this.info.text),t},getSuggestionsString:function(e){var t=[],i=this.info.text;this.isSpellChecking&&(this.isSpellChecking=!1);var r=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||this.info.text&&(i=r.spellChecker.manageSpecialCharacters(i,void 0,!0),t=r.spellChecker.errorSuggestions.containsKey(i)?r.spellChecker.errorSuggestions.get(i):[]),t},hasElementBox:function(e){var t=!1,i=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(i)&&!sf.base.isNullOrUndefined(i.element)){var r=i;this.info=r.spellChecker.retriveText(),this.info.element&&(t=!0,r.spellChecker.currentContextInfo=this.info,this.info=r.spellChecker.retriveText())}return t},updateErrorSuggestions:function(e){var t=!1,i=window.sfBlazor.getCompInstance(e);return sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||(this.info=i.spellChecker.retriveText(),this.info.element&&(t=!0,i.spellChecker.currentContextInfo=this.info,i.spellChecker.updateErrorSuggestions())),t},invokeMethod:function(e,t,r,n){return kd(this,void 0,void 0,(function(){var o,s,a,l;return Sd(this,(function(d){switch(d.label){case 0:return d.trys.push([0,4,,5]),o=window.sfBlazor.getCompInstance(e),s=null,sf.base.isNullOrUndefined(o)||sf.base.isNullOrUndefined(o.element)?[3,3]:(a=o)?(null===r||(a=o,a=this.getChildModule(a,r)),!(s=a[t].apply(a,n))||"object"!==i(s)||s instanceof Promise||(s=this.cleanStringify(s)),"saveAsBlob"==t&&s instanceof Promise?[4,this.promiseHandler(s)]:[3,2]):[3,3];case 1:s=d.sent(),d.label=2;case 2:return[2,s];case 3:return[3,5];case 4:return l=d.sent(),[2,this.throwError(l,a)];case 5:return[2,{}]}}))}))},promiseHandler:function(e){return kd(this,void 0,void 0,(function(){var t;return Sd(this,(function(i){switch(i.label){case 0:return t=this,e instanceof Promise?[4,e.then((function(i){return kd(this,void 0,void 0,(function(){return Sd(this,(function(r){switch(r.label){case 0:return[4,t.docEditFileReader(i).then((function(t){e=JSON.stringify({data:t.substr(t.indexOf(",")+1)})}))];case 1:return r.sent(),[2]}}))}))}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2,e]}}))}))},docEditFileReader:function(e){return kd(this,void 0,void 0,(function(){return Sd(this,(function(t){return[2,new Promise((function(t,i){var r=new FileReader;r.onload=function(){t(r.result)},r.readAsDataURL(e)}))]}))}))},getMethodCall:function(e,t,i){try{var r=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(r)&&!sf.base.isNullOrUndefined(r.element)){var n=r;return null==t||"null"==t?n[i]:(n=this.getChildModule(n,t))[i]}}catch(e){this.throwError(e,n)}},setMethodCall:function(e,t,i,r){try{var n=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(n)&&!sf.base.isNullOrUndefined(n.element)){var o=n;(o=this.getChildModule(o,t))[i]=r[0]}}catch(e){this.throwError(e,o)}},cleanStringify:function(e){try{return JSON.stringify(e)}catch(e){return console.log(e),""}},getChildModule:function(e,t){try{for(var i=t.split(","),r=0;r<i.length;r++)e=e[i[r]];return e}catch(e){}return e},insertNotes:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||("Footnote"===t?i.editor.insertFootnote():i.editor.insertEndnote())},pasteOptions:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||i.selection.pasteOptions(t)},modifyStyle:function(e,t,i,r,n,o,s){var a=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(a)&&!sf.base.isNullOrUndefined(a.element)){var l=a.documentHelper,d=i;if(!(t.length>0))throw new Error("Enter valid Style name");var h,c=l.styles.findByName(t);if(sf.base.isNullOrUndefined(c)){var p="Character"===o?new wl:new vl,g=new T;sf.base.isNullOrUndefined(d.characterFormat)||(g.bold=d.characterFormat.bold,g.fontSize=d.characterFormat.fontSize,g.fontFamily=d.characterFormat.fontFamily,g.italic=d.characterFormat.italic,g.baselineAlignment=d.characterFormat.baselineAlignment,g.underline=d.characterFormat.underline,g.fontColor=d.characterFormat.fontColor,g.highlightColor=d.characterFormat.highlightColor,g.strikethrough=d.characterFormat.strikethrough,g.allCaps=d.characterFormat.allCaps),d.characterFormat=g;var f=new ul;sf.base.isNullOrUndefined(d.paragraphFormat)||(f.leftIndent=d.paragraphFormat.leftIndent,f.rightIndent=d.paragraphFormat.rightIndent,f.firstLineIndent=d.paragraphFormat.firstLineIndent,f.lineSpacing=d.paragraphFormat.lineSpacing,f.lineSpacingType=d.paragraphFormat.lineSpacingType,f.textAlignment=d.paragraphFormat.textAlignment,f.beforeSpacing=d.paragraphFormat.beforeSpacing,f.afterSpacing=d.paragraphFormat.afterSpacing,f.bidi=d.paragraphFormat.bidi,f.contextualSpacing=d.paragraphFormat.contextualSpacing),d.paragraphFormat=f,p.copyStyle(d);var u=l.styles.findByName(r);"Paragraph"!==o&&"Linked(Paragraph and Character)"!==o||(p.next=t===n?p:l.styles.findByName(n)),p.link="Linked(Paragraph and Character)"===o?this.createLinkStyle(t):void 0,p.type="Character"===o?"Character":"Paragraph",p.name=t,p.basedOn=u,l.styles.push(p),h=t,l.owner.editorModule.applyStyle(h,!0)}else c.type="Character"===o?"Character":"Paragraph",c.basedOn=l.styles.findByName(r),"Character"!==d.type&&"Paragraph"!==d.type&&-1===d.type.indexOf("Linked(Paragraph and Character)")||(c.next=l.styles.findByName(d.next),a.parser.parseCharacterFormat(0,d.characterFormat,c.characterFormat,!1),sf.base.isNullOrUndefined(c.paragraphFormat)||a.parser.parseParagraphFormat(0,d.paragraphFormat,c.paragraphFormat),c.link=-1!==o.indexOf("Linked(Paragraph and Character)")?this.createLinkStyle(l,t,c,s):void 0),l.owner.isShiftingEnabled=!0,l.owner.editorModule.layoutWholeDocument(),l.owner.isShiftingEnabled=!1;l.updateFocus(),l.updateFocus()}},createLinkStyle:function(e,t,i,r){var n;return(n=r?e.styles.findByName(t+" Char","Character"):new wl).type="Character",n.name=t+" Char",n.characterFormat=i.characterFormat.cloneFormat(),n.basedOn=i.basedOn,r||e.styles.push(n),e.styles.findByName(n.name,"Character")},updateDialogTabHeight:function(e,t,i){var r=document.getElementById(t.id),n=r.getElementsByClassName("e-dlg-header-content")[0],o=r.getElementsByClassName("e-dlg-content")[0],s=r.getElementsByClassName("e-footer-content")[0],a=getComputedStyle(o),l=getComputedStyle(r),d=parseInt(a.paddingTop),h=parseInt(a.paddingBottom),c=(isNaN(d)?0:d)+(isNaN(h)?0:h),p=parseInt(l.borderTop),g=parseInt(l.borderBottom),f=(isNaN(p)?0:p)+(isNaN(g)?0:g),u=r.offsetHeight-(n.offsetHeight+s.offsetHeight+c+f);i.style.height=u+"px";var m=parseInt(a.paddingLeft),y=parseInt(a.paddingRight),v=(isNaN(m)?0:m)+(isNaN(y)?0:y),w=parseInt(l.borderLeft),b=parseInt(l.borderRight),x=(isNaN(w)?0:w)+(isNaN(b)?0:b);return r.offsetWidth-(v+x)},getDocumentEditorElementHeight:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element))return t.element.offsetHeight},getOptionPaneChildHeight:function(e){var t=window.sfBlazor.getCompInstance(e);if(!sf.base.isNullOrUndefined(t)&&!sf.base.isNullOrUndefined(t.element))return t.element.getElementsByClassName("e-de-op-tab")[0].offsetHeight},getTablePropertiesPaneHeight:function(e){var t=e.getElementsByClassName("e-tab-header")[0];return t?e.offsetHeight-t.offsetHeight+"px":"auto"},onSpacingValueChange:function(e,t){var i=t.getElementsByTagName("input")[0],r=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(r)||sf.base.isNullOrUndefined(r.element)||(i.value=r.localeKeys.DocumentEditor_Auto)},focusIn:function(e,t){var i=window.sfBlazor.getCompInstance(e);sf.base.isNullOrUndefined(i)||sf.base.isNullOrUndefined(i.element)||setTimeout((function(){i.focusIn()}),t)},getDialogLocalStorage:function(e){return JSON.parse(localStorage.getItem("ej_de_hidePasteAlert"))},setDialogLocalStorage:function(e,t){t&&localStorage.setItem("ej_de_hidePasteAlert","true")},isIOSCheck:function(e){return!!window.sfBlazor.getCompInstance(e).documentHelper.isIosDevice},getBlobSize:function(e,t){return kd(this,void 0,void 0,(function(){var i,r,n;return Sd(this,(function(o){switch(o.label){case 0:return i=null,r=window.sfBlazor.getCompInstance(e),n=r.saveAsBlob(t),[4,this.promiseHandlerArray(n)];case 1:return i=o.sent(),[2,this.getBlobInfo(i)]}}))}))},getBlobInfo:function(e){var t="blob"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15),i=e.byteLength,r=this.splitToChunk(new Uint8Array(e));return i>0&&(this.blobInfo[t]={data:r,byteSize:i}),{id:t,byteSize:i,length:r.length}},splitToChunk:function(e){for(var t=[],i=0;i<e.length;i+=2e4)t.push(e.slice(i,i+2e4));return t},getBytes:function(e,t){if(this.blobInfo[e]){var i=this.blobInfo[e].data[t];return t===this.blobInfo[e].data.length-1&&delete this.blobInfo[e],btoa(String.fromCharCode.apply(null,i))}},promiseHandlerArray:function(e){return kd(this,void 0,void 0,(function(){var t;return Sd(this,(function(i){switch(i.label){case 0:return t=this,e instanceof Promise?[4,e.then((function(i){return kd(this,void 0,void 0,(function(){return Sd(this,(function(r){switch(r.label){case 0:return[4,t.docEditFileReaderArrayBuffer(i).then((function(t){e=t}))];case 1:return r.sent(),[2]}}))}))}))]:[3,2];case 1:i.sent(),i.label=2;case 2:return[2,e]}}))}))},docEditFileReaderArrayBuffer:function(e,t){return kd(this,void 0,void 0,(function(){return Sd(this,(function(t){return[2,new Promise((function(t,i){var r=new FileReader;r.onload=function(){t(r.result)},r.readAsArrayBuffer(e)}))]}))}))}}}()}}]);(async()=>{await import(`${document.baseURI}_content/Syncfusion.Blazor/scripts/syncfusion-blazor-base.min.js?v=25.1.undefined`).then(()=>{sfBlazor.loadDependencies('sfdocumenteditor');})})();